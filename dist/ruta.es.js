function t(t,e){const n=Object.create(null),r=t.split(",");for(let o=0;o<r.length;o++)n[r[o]]=!0;return e?t=>!!n[t.toLowerCase()]:t=>!!n[t]}const e=t("itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly");function n(t){return!!t||""===t}function r(t){if(x(t)){const e={};for(let n=0;n<t.length;n++){const o=t[n],i=S(o)?s(o):r(o);if(i)for(const t in i)e[t]=i[t]}return e}return S(t)||N(t)?t:void 0}const o=/;(?![^(]*\))/g,i=/:(.+)/;function s(t){const e={};return t.split(o).forEach((t=>{if(t){const n=t.split(i);n.length>1&&(e[n[0].trim()]=n[1].trim())}})),e}function a(t){let e="";if(S(t))e=t;else if(x(t))for(let n=0;n<t.length;n++){const r=a(t[n]);r&&(e+=r+" ")}else if(N(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const l=t=>S(t)?t:null==t?"":x(t)||N(t)&&(t.toString===A||!k(t.toString))?JSON.stringify(t,c,2):String(t),c=(t,e)=>e&&e.__v_isRef?c(t,e.value):w(e)?{[`Map(${e.size})`]:[...e.entries()].reduce(((t,[e,n])=>(t[`${e} =>`]=n,t)),{})}:I(e)?{[`Set(${e.size})`]:[...e.values()]}:!N(e)||x(e)||O(e)?e:String(e),u={},f=[],d=()=>{},p=()=>!1,h=/^on[^a-z]/,g=t=>h.test(t),v=t=>t.startsWith("onUpdate:"),m=Object.assign,y=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},b=Object.prototype.hasOwnProperty,_=(t,e)=>b.call(t,e),x=Array.isArray,w=t=>"[object Map]"===E(t),I=t=>"[object Set]"===E(t),k=t=>"function"==typeof t,S=t=>"string"==typeof t,D=t=>"symbol"==typeof t,N=t=>null!==t&&"object"==typeof t,C=t=>N(t)&&k(t.then)&&k(t.catch),A=Object.prototype.toString,E=t=>A.call(t),O=t=>"[object Object]"===E(t),T=t=>S(t)&&"NaN"!==t&&"-"!==t[0]&&""+parseInt(t,10)===t,$=t(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),P=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},R=/-(\w)/g,M=P((t=>t.replace(R,((t,e)=>e?e.toUpperCase():"")))),V=/\B([A-Z])/g,j=P((t=>t.replace(V,"-$1").toLowerCase())),L=P((t=>t.charAt(0).toUpperCase()+t.slice(1))),F=P((t=>t?`on${L(t)}`:"")),U=(t,e)=>!Object.is(t,e),K=(t,e)=>{for(let n=0;n<t.length;n++)t[n](e)},B=(t,e,n)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:n})},W=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let H;let X;class q{constructor(t=!1){this.active=!0,this.effects=[],this.cleanups=[],!t&&X&&(this.parent=X,this.index=(X.scopes||(X.scopes=[])).push(this)-1)}run(t){if(this.active)try{return X=this,t()}finally{X=this.parent}}on(){X=this}off(){X=this.parent}stop(t){if(this.active){let e,n;for(e=0,n=this.effects.length;e<n;e++)this.effects[e].stop();for(e=0,n=this.cleanups.length;e<n;e++)this.cleanups[e]();if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].stop(!0);if(this.parent&&!t){const t=this.parent.scopes.pop();t&&t!==this&&(this.parent.scopes[this.index]=t,t.index=this.index)}this.active=!1}}}const z=t=>{const e=new Set(t);return e.w=0,e.n=0,e},Y=t=>(t.w&Q)>0,G=t=>(t.n&Q)>0,J=new WeakMap;let Z=0,Q=1;let tt;const et=Symbol(""),nt=Symbol("");class rt{constructor(t,e=null,n){this.fn=t,this.scheduler=e,this.active=!0,this.deps=[],this.parent=void 0,function(t,e=X){e&&e.active&&e.effects.push(t)}(this,n)}run(){if(!this.active)return this.fn();let t=tt,e=it;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=tt,tt=this,it=!0,Q=1<<++Z,Z<=30?(({deps:t})=>{if(t.length)for(let e=0;e<t.length;e++)t[e].w|=Q})(this):ot(this),this.fn()}finally{Z<=30&&(t=>{const{deps:e}=t;if(e.length){let n=0;for(let r=0;r<e.length;r++){const o=e[r];Y(o)&&!G(o)?o.delete(t):e[n++]=o,o.w&=~Q,o.n&=~Q}e.length=n}})(this),Q=1<<--Z,tt=this.parent,it=e,this.parent=void 0}}stop(){this.active&&(ot(this),this.onStop&&this.onStop(),this.active=!1)}}function ot(t){const{deps:e}=t;if(e.length){for(let n=0;n<e.length;n++)e[n].delete(t);e.length=0}}let it=!0;const st=[];function at(){st.push(it),it=!1}function lt(){const t=st.pop();it=void 0===t||t}function ct(t,e,n){if(it&&tt){let e=J.get(t);e||J.set(t,e=new Map);let r=e.get(n);r||e.set(n,r=z()),ut(r)}}function ut(t,e){let n=!1;Z<=30?G(t)||(t.n|=Q,n=!Y(t)):n=!t.has(tt),n&&(t.add(tt),tt.deps.push(t))}function ft(t,e,n,r,o,i){const s=J.get(t);if(!s)return;let a=[];if("clear"===e)a=[...s.values()];else if("length"===n&&x(t))s.forEach(((t,e)=>{("length"===e||e>=r)&&a.push(t)}));else switch(void 0!==n&&a.push(s.get(n)),e){case"add":x(t)?T(n)&&a.push(s.get("length")):(a.push(s.get(et)),w(t)&&a.push(s.get(nt)));break;case"delete":x(t)||(a.push(s.get(et)),w(t)&&a.push(s.get(nt)));break;case"set":w(t)&&a.push(s.get(et))}if(1===a.length)a[0]&&dt(a[0]);else{const t=[];for(const e of a)e&&t.push(...e);dt(z(t))}}function dt(t,e){for(const n of x(t)?t:[...t])(n!==tt||n.allowRecurse)&&(n.scheduler?n.scheduler():n.run())}const pt=t("__proto__,__v_isRef,__isVue"),ht=new Set(Object.getOwnPropertyNames(Symbol).map((t=>Symbol[t])).filter(D)),gt=_t(),vt=_t(!1,!0),mt=_t(!0),yt=bt();function bt(){const t={};return["includes","indexOf","lastIndexOf"].forEach((e=>{t[e]=function(...t){const n=oe(this);for(let e=0,o=this.length;e<o;e++)ct(n,0,e+"");const r=n[e](...t);return-1===r||!1===r?n[e](...t.map(oe)):r}})),["push","pop","shift","unshift","splice"].forEach((e=>{t[e]=function(...t){at();const n=oe(this)[e].apply(this,t);return lt(),n}})),t}function _t(t=!1,e=!1){return function(n,r,o){if("__v_isReactive"===r)return!t;if("__v_isReadonly"===r)return t;if("__v_isShallow"===r)return e;if("__v_raw"===r&&o===(t?e?Yt:zt:e?qt:Xt).get(n))return n;const i=x(n);if(!t&&i&&_(yt,r))return Reflect.get(yt,r,o);const s=Reflect.get(n,r,o);if(D(r)?ht.has(r):pt(r))return s;if(t||ct(n,0,r),e)return s;if(le(s)){return!i||!T(r)?s.value:s}return N(s)?t?Zt(s):Jt(s):s}}function xt(t=!1){return function(e,n,r,o){let i=e[n];if(ee(i)&&le(i)&&!le(r))return!1;if(!t&&!ee(r)&&(ne(r)||(r=oe(r),i=oe(i)),!x(e)&&le(i)&&!le(r)))return i.value=r,!0;const s=x(e)&&T(n)?Number(n)<e.length:_(e,n),a=Reflect.set(e,n,r,o);return e===oe(o)&&(s?U(r,i)&&ft(e,"set",n,r):ft(e,"add",n,r)),a}}const wt={get:gt,set:xt(),deleteProperty:function(t,e){const n=_(t,e);t[e];const r=Reflect.deleteProperty(t,e);return r&&n&&ft(t,"delete",e,void 0),r},has:function(t,e){const n=Reflect.has(t,e);return D(e)&&ht.has(e)||ct(t,0,e),n},ownKeys:function(t){return ct(t,0,x(t)?"length":et),Reflect.ownKeys(t)}},It={get:mt,set:(t,e)=>!0,deleteProperty:(t,e)=>!0},kt=m({},wt,{get:vt,set:xt(!0)}),St=t=>t,Dt=t=>Reflect.getPrototypeOf(t);function Nt(t,e,n=!1,r=!1){const o=oe(t=t.__v_raw),i=oe(e);e!==i&&!n&&ct(o,0,e),!n&&ct(o,0,i);const{has:s}=Dt(o),a=r?St:n?ae:se;return s.call(o,e)?a(t.get(e)):s.call(o,i)?a(t.get(i)):void(t!==o&&t.get(e))}function Ct(t,e=!1){const n=this.__v_raw,r=oe(n),o=oe(t);return t!==o&&!e&&ct(r,0,t),!e&&ct(r,0,o),t===o?n.has(t):n.has(t)||n.has(o)}function At(t,e=!1){return t=t.__v_raw,!e&&ct(oe(t),0,et),Reflect.get(t,"size",t)}function Et(t){t=oe(t);const e=oe(this);return Dt(e).has.call(e,t)||(e.add(t),ft(e,"add",t,t)),this}function Ot(t,e){e=oe(e);const n=oe(this),{has:r,get:o}=Dt(n);let i=r.call(n,t);i||(t=oe(t),i=r.call(n,t));const s=o.call(n,t);return n.set(t,e),i?U(e,s)&&ft(n,"set",t,e):ft(n,"add",t,e),this}function Tt(t){const e=oe(this),{has:n,get:r}=Dt(e);let o=n.call(e,t);o||(t=oe(t),o=n.call(e,t)),r&&r.call(e,t);const i=e.delete(t);return o&&ft(e,"delete",t,void 0),i}function $t(){const t=oe(this),e=0!==t.size,n=t.clear();return e&&ft(t,"clear",void 0,void 0),n}function Pt(t,e){return function(n,r){const o=this,i=o.__v_raw,s=oe(i),a=e?St:t?ae:se;return!t&&ct(s,0,et),i.forEach(((t,e)=>n.call(r,a(t),a(e),o)))}}function Rt(t,e,n){return function(...r){const o=this.__v_raw,i=oe(o),s=w(i),a="entries"===t||t===Symbol.iterator&&s,l="keys"===t&&s,c=o[t](...r),u=n?St:e?ae:se;return!e&&ct(i,0,l?nt:et),{next(){const{value:t,done:e}=c.next();return e?{value:t,done:e}:{value:a?[u(t[0]),u(t[1])]:u(t),done:e}},[Symbol.iterator](){return this}}}}function Mt(t){return function(...e){return"delete"!==t&&this}}function Vt(){const t={get(t){return Nt(this,t)},get size(){return At(this)},has:Ct,add:Et,set:Ot,delete:Tt,clear:$t,forEach:Pt(!1,!1)},e={get(t){return Nt(this,t,!1,!0)},get size(){return At(this)},has:Ct,add:Et,set:Ot,delete:Tt,clear:$t,forEach:Pt(!1,!0)},n={get(t){return Nt(this,t,!0)},get size(){return At(this,!0)},has(t){return Ct.call(this,t,!0)},add:Mt("add"),set:Mt("set"),delete:Mt("delete"),clear:Mt("clear"),forEach:Pt(!0,!1)},r={get(t){return Nt(this,t,!0,!0)},get size(){return At(this,!0)},has(t){return Ct.call(this,t,!0)},add:Mt("add"),set:Mt("set"),delete:Mt("delete"),clear:Mt("clear"),forEach:Pt(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach((o=>{t[o]=Rt(o,!1,!1),n[o]=Rt(o,!0,!1),e[o]=Rt(o,!1,!0),r[o]=Rt(o,!0,!0)})),[t,n,e,r]}const[jt,Lt,Ft,Ut]=Vt();function Kt(t,e){const n=e?t?Ut:Ft:t?Lt:jt;return(e,r,o)=>"__v_isReactive"===r?!t:"__v_isReadonly"===r?t:"__v_raw"===r?e:Reflect.get(_(n,r)&&r in e?n:e,r,o)}const Bt={get:Kt(!1,!1)},Wt={get:Kt(!1,!0)},Ht={get:Kt(!0,!1)},Xt=new WeakMap,qt=new WeakMap,zt=new WeakMap,Yt=new WeakMap;function Gt(t){return t.__v_skip||!Object.isExtensible(t)?0:function(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}((t=>E(t).slice(8,-1))(t))}function Jt(t){return ee(t)?t:Qt(t,!1,wt,Bt,Xt)}function Zt(t){return Qt(t,!0,It,Ht,zt)}function Qt(t,e,n,r,o){if(!N(t))return t;if(t.__v_raw&&(!e||!t.__v_isReactive))return t;const i=o.get(t);if(i)return i;const s=Gt(t);if(0===s)return t;const a=new Proxy(t,2===s?r:n);return o.set(t,a),a}function te(t){return ee(t)?te(t.__v_raw):!(!t||!t.__v_isReactive)}function ee(t){return!(!t||!t.__v_isReadonly)}function ne(t){return!(!t||!t.__v_isShallow)}function re(t){return te(t)||ee(t)}function oe(t){const e=t&&t.__v_raw;return e?oe(e):t}function ie(t){return B(t,"__v_skip",!0),t}const se=t=>N(t)?Jt(t):t,ae=t=>N(t)?Zt(t):t;function le(t){return!(!t||!0!==t.__v_isRef)}const ce={get:(t,e,n)=>{return le(r=Reflect.get(t,e,n))?r.value:r;var r},set:(t,e,n,r)=>{const o=t[e];return le(o)&&!le(n)?(o.value=n,!0):Reflect.set(t,e,n,r)}};function ue(t){return te(t)?t:new Proxy(t,ce)}class fe{constructor(t,e,n,r){this._setter=e,this.dep=void 0,this.__v_isRef=!0,this._dirty=!0,this.effect=new rt(t,(()=>{var t;this._dirty||(this._dirty=!0,(t=oe(t=this)).dep&&dt(t.dep))})),this.effect.computed=this,this.effect.active=this._cacheable=!r,this.__v_isReadonly=n}get value(){const t=oe(this);var e;return e=t,it&&tt&&ut((e=oe(e)).dep||(e.dep=z())),!t._dirty&&t._cacheable||(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}function de(t,e,n,r){let o;try{o=r?t(...r):t()}catch(i){he(i,e,n)}return o}function pe(t,e,n,r){if(k(t)){const o=de(t,e,n,r);return o&&C(o)&&o.catch((t=>{he(t,e,n)})),o}const o=[];for(let i=0;i<t.length;i++)o.push(pe(t[i],e,n,r));return o}function he(t,e,n,r=!0){e&&e.vnode;if(e){let r=e.parent;const o=e.proxy,i=n;for(;r;){const e=r.ec;if(e)for(let n=0;n<e.length;n++)if(!1===e[n](t,o,i))return;r=r.parent}const s=e.appContext.config.errorHandler;if(s)return void de(s,null,10,[t,o,i])}!function(t,e,n,r=!0){console.error(t)}(t,0,0,r)}Promise.resolve();let ge=!1,ve=!1;const me=[];let ye=0;const be=[];let _e=null,xe=0;const we=[];let Ie=null,ke=0;const Se=Promise.resolve();let De=null,Ne=null;function Ce(t){const e=De||Se;return t?e.then(this?t.bind(this):t):e}function Ae(t){me.length&&me.includes(t,ge&&t.allowRecurse?ye+1:ye)||t===Ne||(null==t.id?me.push(t):me.splice(function(t){let e=ye+1,n=me.length;for(;e<n;){const r=e+n>>>1;Pe(me[r])<t?e=r+1:n=r}return e}(t.id),0,t),Ee())}function Ee(){ge||ve||(ve=!0,De=Se.then(Re))}function Oe(t,e,n,r){x(t)?n.push(...t):e&&e.includes(t,t.allowRecurse?r+1:r)||n.push(t),Ee()}function Te(t,e=null){if(be.length){for(Ne=e,_e=[...new Set(be)],be.length=0,xe=0;xe<_e.length;xe++)_e[xe]();_e=null,xe=0,Ne=null,Te(t,e)}}function $e(t){if(we.length){const t=[...new Set(we)];if(we.length=0,Ie)return void Ie.push(...t);for(Ie=t,Ie.sort(((t,e)=>Pe(t)-Pe(e))),ke=0;ke<Ie.length;ke++)Ie[ke]();Ie=null,ke=0}}const Pe=t=>null==t.id?1/0:t.id;function Re(t){ve=!1,ge=!0,Te(t),me.sort(((t,e)=>Pe(t)-Pe(e)));try{for(ye=0;ye<me.length;ye++){const t=me[ye];t&&!1!==t.active&&de(t,null,14)}}finally{ye=0,me.length=0,$e(),ge=!1,De=null,(me.length||be.length||we.length)&&Re(t)}}function Me(t,e,...n){const r=t.vnode.props||u;let o=n;const i=e.startsWith("update:"),s=i&&e.slice(7);if(s&&s in r){const t=`${"modelValue"===s?"model":s}Modifiers`,{number:e,trim:i}=r[t]||u;i?o=n.map((t=>t.trim())):e&&(o=n.map(W))}let a,l=r[a=F(e)]||r[a=F(M(e))];!l&&i&&(l=r[a=F(j(e))]),l&&pe(l,t,6,o);const c=r[a+"Once"];if(c){if(t.emitted){if(t.emitted[a])return}else t.emitted={};t.emitted[a]=!0,pe(c,t,6,o)}}function Ve(t,e,n=!1){const r=e.emitsCache,o=r.get(t);if(void 0!==o)return o;const i=t.emits;let s={},a=!1;if(!k(t)){const r=t=>{const n=Ve(t,e,!0);n&&(a=!0,m(s,n))};!n&&e.mixins.length&&e.mixins.forEach(r),t.extends&&r(t.extends),t.mixins&&t.mixins.forEach(r)}return i||a?(x(i)?i.forEach((t=>s[t]=null)):m(s,i),r.set(t,s),s):(r.set(t,null),null)}function je(t,e){return!(!t||!g(e))&&(e=e.slice(2).replace(/Once$/,""),_(t,e[0].toLowerCase()+e.slice(1))||_(t,j(e))||_(t,e))}let Le=null,Fe=null;function Ue(t){const e=Le;return Le=t,Fe=t&&t.type.__scopeId||null,e}function Ke(t){const{type:e,vnode:n,proxy:r,withProxy:o,props:i,propsOptions:[s],slots:a,attrs:l,emit:c,render:u,renderCache:f,data:d,setupState:p,ctx:h,inheritAttrs:g}=t;let m,y;const b=Ue(t);try{if(4&n.shapeFlag){const t=o||r;m=wr(u.call(t,t,f,i,p,d,h)),y=l}else{const t=e;0,m=wr(t.length>1?t(i,{attrs:l,slots:a,emit:c}):t(i,null)),y=e.props?l:Be(l)}}catch(x){or.length=0,he(x,t,1),m=yr(nr)}let _=m;if(y&&!1!==g){const t=Object.keys(y),{shapeFlag:e}=_;t.length&&7&e&&(s&&t.some(v)&&(y=We(y,s)),_=br(_,y))}return n.dirs&&(_.dirs=_.dirs?_.dirs.concat(n.dirs):n.dirs),n.transition&&(_.transition=n.transition),m=_,Ue(b),m}const Be=t=>{let e;for(const n in t)("class"===n||"style"===n||g(n))&&((e||(e={}))[n]=t[n]);return e},We=(t,e)=>{const n={};for(const r in t)v(r)&&r.slice(9)in e||(n[r]=t[r]);return n};function He(t,e,n){const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!0;for(let o=0;o<r.length;o++){const i=r[o];if(e[i]!==t[i]&&!je(n,i))return!0}return!1}function Xe(t,e,n=!1){const r=Pr||Le;if(r){const o=null==r.parent?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides;if(o&&t in o)return o[t];if(arguments.length>1)return n&&k(e)?e.call(r.proxy):e}}const qe={};function ze(t,e,n){return Ye(t,e,n)}function Ye(t,e,{immediate:n,deep:r,flush:o,onTrack:i,onTrigger:s}=u){const a=Pr;let l,c,f=!1,p=!1;if(le(t)?(l=()=>t.value,f=ne(t)):te(t)?(l=()=>t,r=!0):x(t)?(p=!0,f=t.some(te),l=()=>t.map((t=>le(t)?t.value:te(t)?Ze(t):k(t)?de(t,a,2):void 0))):l=k(t)?e?()=>de(t,a,2):()=>{if(!a||!a.isUnmounted)return c&&c(),pe(t,a,3,[h])}:d,e&&r){const t=l;l=()=>Ze(t())}let h=t=>{c=b.onStop=()=>{de(t,a,4)}};if(jr)return h=d,e?n&&pe(e,a,3,[l(),p?[]:void 0,h]):l(),d;let g=p?[]:qe;const v=()=>{if(b.active)if(e){const t=b.run();(r||f||(p?t.some(((t,e)=>U(t,g[e]))):U(t,g)))&&(c&&c(),pe(e,a,3,[t,g===qe?void 0:g,h]),g=t)}else b.run()};let m;v.allowRecurse=!!e,m="sync"===o?v:"post"===o?()=>qn(v,a&&a.suspense):()=>{!a||a.isMounted?function(t){Oe(t,_e,be,xe)}(v):v()};const b=new rt(l,m);return e?n?v():g=b.run():"post"===o?qn(b.run.bind(b),a&&a.suspense):b.run(),()=>{b.stop(),a&&a.scope&&y(a.scope.effects,b)}}function Ge(t,e,n){const r=this.proxy,o=S(t)?t.includes(".")?Je(r,t):()=>r[t]:t.bind(r,r);let i;k(e)?i=e:(i=e.handler,n=e);const s=Pr;Rr(this);const a=Ye(o,i.bind(r),n);return s?Rr(s):Mr(),a}function Je(t,e){const n=e.split(".");return()=>{let e=t;for(let t=0;t<n.length&&e;t++)e=e[n[t]];return e}}function Ze(t,e){if(!N(t)||t.__v_skip)return t;if((e=e||new Set).has(t))return t;if(e.add(t),le(t))Ze(t.value,e);else if(x(t))for(let n=0;n<t.length;n++)Ze(t[n],e);else if(I(t)||w(t))t.forEach((t=>{Ze(t,e)}));else if(O(t))for(const n in t)Ze(t[n],e);return t}const Qe=t=>!!t.type.__asyncLoader,tn=t=>t.type.__isKeepAlive;function en(t,e){rn(t,"a",e)}function nn(t,e){rn(t,"da",e)}function rn(t,e,n=Pr){const r=t.__wdc||(t.__wdc=()=>{let e=n;for(;e;){if(e.isDeactivated)return;e=e.parent}return t()});if(sn(e,r,n),n){let t=n.parent;for(;t&&t.parent;)tn(t.parent.vnode)&&on(r,e,n,t),t=t.parent}}function on(t,e,n,r){const o=sn(e,t,r,!0);pn((()=>{y(r[e],o)}),n)}function sn(t,e,n=Pr,r=!1){if(n){const o=n[t]||(n[t]=[]),i=e.__weh||(e.__weh=(...r)=>{if(n.isUnmounted)return;at(),Rr(n);const o=pe(e,n,t,r);return Mr(),lt(),o});return r?o.unshift(i):o.push(i),i}}const an=t=>(e,n=Pr)=>(!jr||"sp"===t)&&sn(t,e,n),ln=an("bm"),cn=an("m"),un=an("bu"),fn=an("u"),dn=an("bum"),pn=an("um"),hn=an("sp"),gn=an("rtg"),vn=an("rtc");function mn(t,e=Pr){sn("ec",t,e)}let yn=!0;function bn(t){const e=wn(t),n=t.proxy,r=t.ctx;yn=!1,e.beforeCreate&&_n(e.beforeCreate,t,"bc");const{data:o,computed:i,methods:s,watch:a,provide:l,inject:c,created:u,beforeMount:f,mounted:p,beforeUpdate:h,updated:g,activated:v,deactivated:m,beforeDestroy:y,beforeUnmount:b,destroyed:_,unmounted:w,render:I,renderTracked:S,renderTriggered:D,errorCaptured:C,serverPrefetch:A,expose:E,inheritAttrs:O,components:T,directives:$,filters:P}=e;if(c&&function(t,e,n=d,r=!1){x(t)&&(t=Dn(t));for(const o in t){const n=t[o];let i;i=N(n)?"default"in n?Xe(n.from||o,n.default,!0):Xe(n.from||o):Xe(n),le(i)&&r?Object.defineProperty(e,o,{enumerable:!0,configurable:!0,get:()=>i.value,set:t=>i.value=t}):e[o]=i}}(c,r,null,t.appContext.config.unwrapInjectedRef),s)for(const d in s){const t=s[d];k(t)&&(r[d]=t.bind(n))}if(o){const e=o.call(n,n);N(e)&&(t.data=Jt(e))}if(yn=!0,i)for(const x in i){const t=i[x],e=k(t)?t.bind(n,n):k(t.get)?t.get.bind(n,n):d,o=!k(t)&&k(t.set)?t.set.bind(n):d,s=Kr({get:e,set:o});Object.defineProperty(r,x,{enumerable:!0,configurable:!0,get:()=>s.value,set:t=>s.value=t})}if(a)for(const d in a)xn(a[d],r,n,d);if(l){const t=k(l)?l.call(n):l;Reflect.ownKeys(t).forEach((e=>{!function(t,e){if(Pr){let n=Pr.provides;const r=Pr.parent&&Pr.parent.provides;r===n&&(n=Pr.provides=Object.create(r)),n[t]=e}}(e,t[e])}))}function R(t,e){x(e)?e.forEach((e=>t(e.bind(n)))):e&&t(e.bind(n))}if(u&&_n(u,t,"c"),R(ln,f),R(cn,p),R(un,h),R(fn,g),R(en,v),R(nn,m),R(mn,C),R(vn,S),R(gn,D),R(dn,b),R(pn,w),R(hn,A),x(E))if(E.length){const e=t.exposed||(t.exposed={});E.forEach((t=>{Object.defineProperty(e,t,{get:()=>n[t],set:e=>n[t]=e})}))}else t.exposed||(t.exposed={});I&&t.render===d&&(t.render=I),null!=O&&(t.inheritAttrs=O),T&&(t.components=T),$&&(t.directives=$)}function _n(t,e,n){pe(x(t)?t.map((t=>t.bind(e.proxy))):t.bind(e.proxy),e,n)}function xn(t,e,n,r){const o=r.includes(".")?Je(n,r):()=>n[r];if(S(t)){const n=e[t];k(n)&&ze(o,n)}else if(k(t))ze(o,t.bind(n));else if(N(t))if(x(t))t.forEach((t=>xn(t,e,n,r)));else{const r=k(t.handler)?t.handler.bind(n):e[t.handler];k(r)&&ze(o,r,t)}}function wn(t){const e=t.type,{mixins:n,extends:r}=e,{mixins:o,optionsCache:i,config:{optionMergeStrategies:s}}=t.appContext,a=i.get(e);let l;return a?l=a:o.length||n||r?(l={},o.length&&o.forEach((t=>In(l,t,s,!0))),In(l,e,s)):l=e,i.set(e,l),l}function In(t,e,n,r=!1){const{mixins:o,extends:i}=e;i&&In(t,i,n,!0),o&&o.forEach((e=>In(t,e,n,!0)));for(const s in e)if(r&&"expose"===s);else{const r=kn[s]||n&&n[s];t[s]=r?r(t[s],e[s]):e[s]}return t}const kn={data:Sn,props:Cn,emits:Cn,methods:Cn,computed:Cn,beforeCreate:Nn,created:Nn,beforeMount:Nn,mounted:Nn,beforeUpdate:Nn,updated:Nn,beforeDestroy:Nn,beforeUnmount:Nn,destroyed:Nn,unmounted:Nn,activated:Nn,deactivated:Nn,errorCaptured:Nn,serverPrefetch:Nn,components:Cn,directives:Cn,watch:function(t,e){if(!t)return e;if(!e)return t;const n=m(Object.create(null),t);for(const r in e)n[r]=Nn(t[r],e[r]);return n},provide:Sn,inject:function(t,e){return Cn(Dn(t),Dn(e))}};function Sn(t,e){return e?t?function(){return m(k(t)?t.call(this,this):t,k(e)?e.call(this,this):e)}:e:t}function Dn(t){if(x(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function Nn(t,e){return t?[...new Set([].concat(t,e))]:e}function Cn(t,e){return t?m(m(Object.create(null),t),e):e}function An(t,e,n,r=!1){const o={},i={};B(i,hr,1),t.propsDefaults=Object.create(null),En(t,e,o,i);for(const s in t.propsOptions[0])s in o||(o[s]=void 0);n?t.props=r?o:Qt(o,!1,kt,Wt,qt):t.type.props?t.props=o:t.props=i,t.attrs=i}function En(t,e,n,r){const[o,i]=t.propsOptions;let s,a=!1;if(e)for(let l in e){if($(l))continue;const c=e[l];let u;o&&_(o,u=M(l))?i&&i.includes(u)?(s||(s={}))[u]=c:n[u]=c:je(t.emitsOptions,l)||l in r&&c===r[l]||(r[l]=c,a=!0)}if(i){const e=oe(n),r=s||u;for(let s=0;s<i.length;s++){const a=i[s];n[a]=On(o,e,a,r[a],t,!_(r,a))}}return a}function On(t,e,n,r,o,i){const s=t[n];if(null!=s){const t=_(s,"default");if(t&&void 0===r){const t=s.default;if(s.type!==Function&&k(t)){const{propsDefaults:i}=o;n in i?r=i[n]:(Rr(o),r=i[n]=t.call(null,e),Mr())}else r=t}s[0]&&(i&&!t?r=!1:!s[1]||""!==r&&r!==j(n)||(r=!0))}return r}function Tn(t,e,n=!1){const r=e.propsCache,o=r.get(t);if(o)return o;const i=t.props,s={},a=[];let l=!1;if(!k(t)){const r=t=>{l=!0;const[n,r]=Tn(t,e,!0);m(s,n),r&&a.push(...r)};!n&&e.mixins.length&&e.mixins.forEach(r),t.extends&&r(t.extends),t.mixins&&t.mixins.forEach(r)}if(!i&&!l)return r.set(t,f),f;if(x(i))for(let f=0;f<i.length;f++){const t=M(i[f]);$n(t)&&(s[t]=u)}else if(i)for(const u in i){const t=M(u);if($n(t)){const e=i[u],n=s[t]=x(e)||k(e)?{type:e}:e;if(n){const e=Mn(Boolean,n.type),r=Mn(String,n.type);n[0]=e>-1,n[1]=r<0||e<r,(e>-1||_(n,"default"))&&a.push(t)}}}const c=[s,a];return r.set(t,c),c}function $n(t){return"$"!==t[0]}function Pn(t){const e=t&&t.toString().match(/^\s*function (\w+)/);return e?e[1]:null===t?"null":""}function Rn(t,e){return Pn(t)===Pn(e)}function Mn(t,e){return x(e)?e.findIndex((e=>Rn(e,t))):k(e)&&Rn(e,t)?0:-1}const Vn=t=>"_"===t[0]||"$stable"===t,jn=t=>x(t)?t.map(wr):[wr(t)],Ln=(t,e,n)=>{const r=function(t,e=Le,n){if(!e)return t;if(t._n)return t;const r=(...n)=>{r._d&&lr(-1);const o=Ue(e),i=t(...n);return Ue(o),r._d&&lr(1),i};return r._n=!0,r._c=!0,r._d=!0,r}(((...t)=>jn(e(...t))),n);return r._c=!1,r},Fn=(t,e,n)=>{const r=t._ctx;for(const o in t){if(Vn(o))continue;const n=t[o];if(k(n))e[o]=Ln(0,n,r);else if(null!=n){const t=jn(n);e[o]=()=>t}}},Un=(t,e)=>{const n=jn(e);t.slots.default=()=>n};function Kn(t,e,n,r){const o=t.dirs,i=e&&e.dirs;for(let s=0;s<o.length;s++){const a=o[s];i&&(a.oldValue=i[s].value);let l=a.dir[r];l&&(at(),pe(l,n,8,[t.el,a,t,e]),lt())}}function Bn(){return{app:null,config:{isNativeTag:p,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Wn=0;function Hn(t,e){return function(n,r=null){null==r||N(r)||(r=null);const o=Bn(),i=new Set;let s=!1;const a=o.app={_uid:Wn++,_component:n,_props:r,_container:null,_context:o,_instance:null,version:Br,get config(){return o.config},set config(t){},use:(t,...e)=>(i.has(t)||(t&&k(t.install)?(i.add(t),t.install(a,...e)):k(t)&&(i.add(t),t(a,...e))),a),mixin:t=>(o.mixins.includes(t)||o.mixins.push(t),a),component:(t,e)=>e?(o.components[t]=e,a):o.components[t],directive:(t,e)=>e?(o.directives[t]=e,a):o.directives[t],mount(i,l,c){if(!s){const u=yr(n,r);return u.appContext=o,l&&e?e(u,i):t(u,i,c),s=!0,a._container=i,i.__vue_app__=a,Ur(u.component)||u.component.proxy}},unmount(){s&&(t(null,a._container),delete a._container.__vue_app__)},provide:(t,e)=>(o.provides[t]=e,a)};return a}}function Xn(t,e,n,r,o=!1){if(x(t))return void t.forEach(((t,i)=>Xn(t,e&&(x(e)?e[i]:e),n,r,o)));if(Qe(r)&&!o)return;const i=4&r.shapeFlag?Ur(r.component)||r.component.proxy:r.el,s=o?null:i,{i:a,r:l}=t,c=e&&e.r,f=a.refs===u?a.refs={}:a.refs,d=a.setupState;if(null!=c&&c!==l&&(S(c)?(f[c]=null,_(d,c)&&(d[c]=null)):le(c)&&(c.value=null)),k(l))de(l,a,12,[s,f]);else{const e=S(l),r=le(l);if(e||r){const r=()=>{if(t.f){const n=e?f[l]:l.value;o?x(n)&&y(n,i):x(n)?n.includes(i)||n.push(i):e?f[l]=[i]:(l.value=[i],t.k&&(f[t.k]=l.value))}else e?(f[l]=s,_(d,l)&&(d[l]=s)):le(l)&&(l.value=s,t.k&&(f[t.k]=s))};s?(r.id=-1,qn(r,n)):r()}}}const qn=function(t,e){e&&e.pendingBranch?x(t)?e.effects.push(...t):e.effects.push(t):Oe(t,Ie,we,ke)};function zn(t){return function(t,e){(H||(H="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})).__VUE__=!0;const{insert:n,remove:r,patchProp:o,createElement:i,createText:s,createComment:a,setText:l,setElementText:c,parentNode:p,nextSibling:h,setScopeId:g=d,cloneNode:v,insertStaticContent:y}=t,b=(t,e,n,r=null,o=null,i=null,s=!1,a=null,l=!!e.dynamicChildren)=>{if(t===e)return;t&&!pr(t,e)&&(r=nt(t),J(t,o,i,!0),t=null),-2===e.patchFlag&&(l=!1,e.dynamicChildren=null);const{type:c,ref:u,shapeFlag:f}=e;switch(c){case er:x(t,e,n,r);break;case nr:w(t,e,n,r);break;case rr:null==t&&I(e,n,r,s);break;case tr:R(t,e,n,r,o,i,s,a,l);break;default:1&f?D(t,e,n,r,o,i,s,a,l):6&f?V(t,e,n,r,o,i,s,a,l):(64&f||128&f)&&c.process(t,e,n,r,o,i,s,a,l,it)}null!=u&&o&&Xn(u,t&&t.ref,i,e||t,!e)},x=(t,e,r,o)=>{if(null==t)n(e.el=s(e.children),r,o);else{const n=e.el=t.el;e.children!==t.children&&l(n,e.children)}},w=(t,e,r,o)=>{null==t?n(e.el=a(e.children||""),r,o):e.el=t.el},I=(t,e,n,r)=>{[t.el,t.anchor]=y(t.children,e,n,r,t.el,t.anchor)},k=({el:t,anchor:e},r,o)=>{let i;for(;t&&t!==e;)i=h(t),n(t,r,o),t=i;n(e,r,o)},S=({el:t,anchor:e})=>{let n;for(;t&&t!==e;)n=h(t),r(t),t=n;r(e)},D=(t,e,n,r,o,i,s,a,l)=>{s=s||"svg"===e.type,null==t?N(e,n,r,o,i,s,a,l):O(t,e,o,i,s,a,l)},N=(t,e,r,s,a,l,u,f)=>{let d,p;const{type:h,props:g,shapeFlag:m,transition:y,patchFlag:b,dirs:_}=t;if(t.el&&void 0!==v&&-1===b)d=t.el=v(t.el);else{if(d=t.el=i(t.type,l,g&&g.is,g),8&m?c(d,t.children):16&m&&E(t.children,d,null,s,a,l&&"foreignObject"!==h,u,f),_&&Kn(t,null,s,"created"),g){for(const e in g)"value"===e||$(e)||o(d,e,null,g[e],l,t.children,s,a,et);"value"in g&&o(d,"value",null,g.value),(p=g.onVnodeBeforeMount)&&Sr(p,s,t)}A(d,t,t.scopeId,u,s)}_&&Kn(t,null,s,"beforeMount");const x=(!a||a&&!a.pendingBranch)&&y&&!y.persisted;x&&y.beforeEnter(d),n(d,e,r),((p=g&&g.onVnodeMounted)||x||_)&&qn((()=>{p&&Sr(p,s,t),x&&y.enter(d),_&&Kn(t,null,s,"mounted")}),a)},A=(t,e,n,r,o)=>{if(n&&g(t,n),r)for(let i=0;i<r.length;i++)g(t,r[i]);if(o){if(e===o.subTree){const e=o.vnode;A(t,e,e.scopeId,e.slotScopeIds,o.parent)}}},E=(t,e,n,r,o,i,s,a,l=0)=>{for(let c=l;c<t.length;c++){const l=t[c]=a?Ir(t[c]):wr(t[c]);b(null,l,e,n,r,o,i,s,a)}},O=(t,e,n,r,i,s,a)=>{const l=e.el=t.el;let{patchFlag:f,dynamicChildren:d,dirs:p}=e;f|=16&t.patchFlag;const h=t.props||u,g=e.props||u;let v;n&&Yn(n,!1),(v=g.onVnodeBeforeUpdate)&&Sr(v,n,e,t),p&&Kn(e,t,n,"beforeUpdate"),n&&Yn(n,!0);const m=i&&"foreignObject"!==e.type;if(d?T(t.dynamicChildren,d,l,n,r,m,s):a||X(t,e,l,null,n,r,m,s,!1),f>0){if(16&f)P(l,e,h,g,n,r,i);else if(2&f&&h.class!==g.class&&o(l,"class",null,g.class,i),4&f&&o(l,"style",h.style,g.style,i),8&f){const s=e.dynamicProps;for(let e=0;e<s.length;e++){const a=s[e],c=h[a],u=g[a];u===c&&"value"!==a||o(l,a,c,u,i,t.children,n,r,et)}}1&f&&t.children!==e.children&&c(l,e.children)}else a||null!=d||P(l,e,h,g,n,r,i);((v=g.onVnodeUpdated)||p)&&qn((()=>{v&&Sr(v,n,e,t),p&&Kn(e,t,n,"updated")}),r)},T=(t,e,n,r,o,i,s)=>{for(let a=0;a<e.length;a++){const l=t[a],c=e[a],u=l.el&&(l.type===tr||!pr(l,c)||70&l.shapeFlag)?p(l.el):n;b(l,c,u,null,r,o,i,s,!0)}},P=(t,e,n,r,i,s,a)=>{if(n!==r){for(const l in r){if($(l))continue;const c=r[l],u=n[l];c!==u&&"value"!==l&&o(t,l,u,c,a,e.children,i,s,et)}if(n!==u)for(const l in n)$(l)||l in r||o(t,l,n[l],null,a,e.children,i,s,et);"value"in r&&o(t,"value",n.value,r.value)}},R=(t,e,r,o,i,a,l,c,u)=>{const f=e.el=t?t.el:s(""),d=e.anchor=t?t.anchor:s("");let{patchFlag:p,dynamicChildren:h,slotScopeIds:g}=e;g&&(c=c?c.concat(g):g),null==t?(n(f,r,o),n(d,r,o),E(e.children,r,d,i,a,l,c,u)):p>0&&64&p&&h&&t.dynamicChildren?(T(t.dynamicChildren,h,r,i,a,l,c),(null!=e.key||i&&e===i.subTree)&&Gn(t,e,!0)):X(t,e,r,d,i,a,l,c,u)},V=(t,e,n,r,o,i,s,a,l)=>{e.slotScopeIds=a,null==t?512&e.shapeFlag?o.ctx.activate(e,n,r,s,l):L(e,n,r,o,i,s,l):F(t,e,l)},L=(t,e,n,r,o,i,s)=>{const a=t.component=function(t,e,n){const r=t.type,o=(e?e.appContext:t.appContext)||Tr,i={uid:$r++,vnode:t,type:r,parent:e,appContext:o,root:null,next:null,subTree:null,effect:null,update:null,scope:new q(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(o.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Tn(r,o),emitsOptions:Ve(r,o),emit:null,emitted:null,propsDefaults:u,inheritAttrs:r.inheritAttrs,ctx:u,data:u,props:u,attrs:u,slots:u,refs:u,setupState:u,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};i.ctx={_:i},i.root=e?e.root:i,i.emit=Me.bind(null,i),t.ce&&t.ce(i);return i}(t,r,o);if(tn(t)&&(a.ctx.renderer=it),function(t,e=!1){jr=e;const{props:n,children:r}=t.vnode,o=Vr(t);An(t,n,o,e),((t,e)=>{if(32&t.vnode.shapeFlag){const n=e._;n?(t.slots=oe(e),B(e,"_",n)):Fn(e,t.slots={})}else t.slots={},e&&Un(t,e);B(t.slots,hr,1)})(t,r);const i=o?function(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=ie(new Proxy(t.ctx,Or));const{setup:r}=n;if(r){const n=t.setupContext=r.length>1?function(t){const e=e=>{t.exposed=e||{}};let n;return{get attrs(){return n||(n=function(t){return new Proxy(t.attrs,{get:(e,n)=>(ct(t,0,"$attrs"),e[n])})}(t))},slots:t.slots,emit:t.emit,expose:e}}(t):null;Rr(t),at();const o=de(r,t,0,[t.props,n]);if(lt(),Mr(),C(o)){if(o.then(Mr,Mr),e)return o.then((n=>{Lr(t,n,e)})).catch((e=>{he(e,t,0)}));t.asyncDep=o}else Lr(t,o,e)}else Fr(t,e)}(t,e):void 0;jr=!1}(a),a.asyncDep){if(o&&o.registerDep(a,U),!t.el){const t=a.subTree=yr(nr);w(null,t,e,n)}}else U(a,t,e,n,o,i,s)},F=(t,e,n)=>{const r=e.component=t.component;if(function(t,e,n){const{props:r,children:o,component:i}=t,{props:s,children:a,patchFlag:l}=e,c=i.emitsOptions;if(e.dirs||e.transition)return!0;if(!(n&&l>=0))return!(!o&&!a||a&&a.$stable)||r!==s&&(r?!s||He(r,s,c):!!s);if(1024&l)return!0;if(16&l)return r?He(r,s,c):!!s;if(8&l){const t=e.dynamicProps;for(let e=0;e<t.length;e++){const n=t[e];if(s[n]!==r[n]&&!je(c,n))return!0}}return!1}(t,e,n)){if(r.asyncDep&&!r.asyncResolved)return void W(r,e,n);r.next=e,function(t){const e=me.indexOf(t);e>ye&&me.splice(e,1)}(r.update),r.update()}else e.component=t.component,e.el=t.el,r.vnode=e},U=(t,e,n,r,o,i,s)=>{const a=()=>{if(t.isMounted){let e,{next:n,bu:r,u:a,parent:l,vnode:c}=t,u=n;Yn(t,!1),n?(n.el=c.el,W(t,n,s)):n=c,r&&K(r),(e=n.props&&n.props.onVnodeBeforeUpdate)&&Sr(e,l,n,c),Yn(t,!0);const f=Ke(t),d=t.subTree;t.subTree=f,b(d,f,p(d.el),nt(d),t,o,i),n.el=f.el,null===u&&function({vnode:t,parent:e},n){for(;e&&e.subTree===t;)(t=e.vnode).el=n,e=e.parent}(t,f.el),a&&qn(a,o),(e=n.props&&n.props.onVnodeUpdated)&&qn((()=>Sr(e,l,n,c)),o)}else{let s;const{el:a,props:l}=e,{bm:c,m:u,parent:f}=t,d=Qe(e);if(Yn(t,!1),c&&K(c),!d&&(s=l&&l.onVnodeBeforeMount)&&Sr(s,f,e),Yn(t,!0),a&&ut){const n=()=>{t.subTree=Ke(t),ut(a,t.subTree,t,o,null)};d?e.type.__asyncLoader().then((()=>!t.isUnmounted&&n())):n()}else{const s=t.subTree=Ke(t);b(null,s,n,r,t,o,i),e.el=s.el}if(u&&qn(u,o),!d&&(s=l&&l.onVnodeMounted)){const t=e;qn((()=>Sr(s,f,t)),o)}256&e.shapeFlag&&t.a&&qn(t.a,o),t.isMounted=!0,e=n=r=null}},l=t.effect=new rt(a,(()=>Ae(t.update)),t.scope),c=t.update=l.run.bind(l);c.id=t.uid,Yn(t,!0),c()},W=(t,e,n)=>{e.component=t;const r=t.vnode.props;t.vnode=e,t.next=null,function(t,e,n,r){const{props:o,attrs:i,vnode:{patchFlag:s}}=t,a=oe(o),[l]=t.propsOptions;let c=!1;if(!(r||s>0)||16&s){let r;En(t,e,o,i)&&(c=!0);for(const i in a)e&&(_(e,i)||(r=j(i))!==i&&_(e,r))||(l?!n||void 0===n[i]&&void 0===n[r]||(o[i]=On(l,a,i,void 0,t,!0)):delete o[i]);if(i!==a)for(const t in i)e&&_(e,t)||(delete i[t],c=!0)}else if(8&s){const n=t.vnode.dynamicProps;for(let r=0;r<n.length;r++){let s=n[r];const u=e[s];if(l)if(_(i,s))u!==i[s]&&(i[s]=u,c=!0);else{const e=M(s);o[e]=On(l,a,e,u,t,!1)}else u!==i[s]&&(i[s]=u,c=!0)}}c&&ft(t,"set","$attrs")}(t,e.props,r,n),((t,e,n)=>{const{vnode:r,slots:o}=t;let i=!0,s=u;if(32&r.shapeFlag){const t=e._;t?n&&1===t?i=!1:(m(o,e),n||1!==t||delete o._):(i=!e.$stable,Fn(e,o)),s=e}else e&&(Un(t,e),s={default:1});if(i)for(const a in o)Vn(a)||a in s||delete o[a]})(t,e.children,n),at(),Te(void 0,t.update),lt()},X=(t,e,n,r,o,i,s,a,l=!1)=>{const u=t&&t.children,f=t?t.shapeFlag:0,d=e.children,{patchFlag:p,shapeFlag:h}=e;if(p>0){if(128&p)return void Y(u,d,n,r,o,i,s,a,l);if(256&p)return void z(u,d,n,r,o,i,s,a,l)}8&h?(16&f&&et(u,o,i),d!==u&&c(n,d)):16&f?16&h?Y(u,d,n,r,o,i,s,a,l):et(u,o,i,!0):(8&f&&c(n,""),16&h&&E(d,n,r,o,i,s,a,l))},z=(t,e,n,r,o,i,s,a,l)=>{e=e||f;const c=(t=t||f).length,u=e.length,d=Math.min(c,u);let p;for(p=0;p<d;p++){const r=e[p]=l?Ir(e[p]):wr(e[p]);b(t[p],r,n,null,o,i,s,a,l)}c>u?et(t,o,i,!0,!1,d):E(e,n,r,o,i,s,a,l,d)},Y=(t,e,n,r,o,i,s,a,l)=>{let c=0;const u=e.length;let d=t.length-1,p=u-1;for(;c<=d&&c<=p;){const r=t[c],u=e[c]=l?Ir(e[c]):wr(e[c]);if(!pr(r,u))break;b(r,u,n,null,o,i,s,a,l),c++}for(;c<=d&&c<=p;){const r=t[d],c=e[p]=l?Ir(e[p]):wr(e[p]);if(!pr(r,c))break;b(r,c,n,null,o,i,s,a,l),d--,p--}if(c>d){if(c<=p){const t=p+1,f=t<u?e[t].el:r;for(;c<=p;)b(null,e[c]=l?Ir(e[c]):wr(e[c]),n,f,o,i,s,a,l),c++}}else if(c>p)for(;c<=d;)J(t[c],o,i,!0),c++;else{const h=c,g=c,v=new Map;for(c=g;c<=p;c++){const t=e[c]=l?Ir(e[c]):wr(e[c]);null!=t.key&&v.set(t.key,c)}let m,y=0;const _=p-g+1;let x=!1,w=0;const I=new Array(_);for(c=0;c<_;c++)I[c]=0;for(c=h;c<=d;c++){const r=t[c];if(y>=_){J(r,o,i,!0);continue}let u;if(null!=r.key)u=v.get(r.key);else for(m=g;m<=p;m++)if(0===I[m-g]&&pr(r,e[m])){u=m;break}void 0===u?J(r,o,i,!0):(I[u-g]=c+1,u>=w?w=u:x=!0,b(r,e[u],n,null,o,i,s,a,l),y++)}const k=x?function(t){const e=t.slice(),n=[0];let r,o,i,s,a;const l=t.length;for(r=0;r<l;r++){const l=t[r];if(0!==l){if(o=n[n.length-1],t[o]<l){e[r]=o,n.push(r);continue}for(i=0,s=n.length-1;i<s;)a=i+s>>1,t[n[a]]<l?i=a+1:s=a;l<t[n[i]]&&(i>0&&(e[r]=n[i-1]),n[i]=r)}}i=n.length,s=n[i-1];for(;i-- >0;)n[i]=s,s=e[s];return n}(I):f;for(m=k.length-1,c=_-1;c>=0;c--){const t=g+c,f=e[t],d=t+1<u?e[t+1].el:r;0===I[c]?b(null,f,n,d,o,i,s,a,l):x&&(m<0||c!==k[m]?G(f,n,d,2):m--)}}},G=(t,e,r,o,i=null)=>{const{el:s,type:a,transition:l,children:c,shapeFlag:u}=t;if(6&u)return void G(t.component.subTree,e,r,o);if(128&u)return void t.suspense.move(e,r,o);if(64&u)return void a.move(t,e,r,it);if(a===tr){n(s,e,r);for(let t=0;t<c.length;t++)G(c[t],e,r,o);return void n(t.anchor,e,r)}if(a===rr)return void k(t,e,r);if(2!==o&&1&u&&l)if(0===o)l.beforeEnter(s),n(s,e,r),qn((()=>l.enter(s)),i);else{const{leave:t,delayLeave:o,afterLeave:i}=l,a=()=>n(s,e,r),c=()=>{t(s,(()=>{a(),i&&i()}))};o?o(s,a,c):c()}else n(s,e,r)},J=(t,e,n,r=!1,o=!1)=>{const{type:i,props:s,ref:a,children:l,dynamicChildren:c,shapeFlag:u,patchFlag:f,dirs:d}=t;if(null!=a&&Xn(a,null,n,t,!0),256&u)return void e.ctx.deactivate(t);const p=1&u&&d,h=!Qe(t);let g;if(h&&(g=s&&s.onVnodeBeforeUnmount)&&Sr(g,e,t),6&u)tt(t.component,n,r);else{if(128&u)return void t.suspense.unmount(n,r);p&&Kn(t,null,e,"beforeUnmount"),64&u?t.type.remove(t,e,n,o,it,r):c&&(i!==tr||f>0&&64&f)?et(c,e,n,!1,!0):(i===tr&&384&f||!o&&16&u)&&et(l,e,n),r&&Z(t)}(h&&(g=s&&s.onVnodeUnmounted)||p)&&qn((()=>{g&&Sr(g,e,t),p&&Kn(t,null,e,"unmounted")}),n)},Z=t=>{const{type:e,el:n,anchor:o,transition:i}=t;if(e===tr)return void Q(n,o);if(e===rr)return void S(t);const s=()=>{r(n),i&&!i.persisted&&i.afterLeave&&i.afterLeave()};if(1&t.shapeFlag&&i&&!i.persisted){const{leave:e,delayLeave:r}=i,o=()=>e(n,s);r?r(t.el,s,o):o()}else s()},Q=(t,e)=>{let n;for(;t!==e;)n=h(t),r(t),t=n;r(e)},tt=(t,e,n)=>{const{bum:r,scope:o,update:i,subTree:s,um:a}=t;r&&K(r),o.stop(),i&&(i.active=!1,J(s,t,e,n)),a&&qn(a,e),qn((()=>{t.isUnmounted=!0}),e),e&&e.pendingBranch&&!e.isUnmounted&&t.asyncDep&&!t.asyncResolved&&t.suspenseId===e.pendingId&&(e.deps--,0===e.deps&&e.resolve())},et=(t,e,n,r=!1,o=!1,i=0)=>{for(let s=i;s<t.length;s++)J(t[s],e,n,r,o)},nt=t=>6&t.shapeFlag?nt(t.component.subTree):128&t.shapeFlag?t.suspense.next():h(t.anchor||t.el),ot=(t,e,n)=>{null==t?e._vnode&&J(e._vnode,null,null,!0):b(e._vnode||null,t,e,null,null,null,n),$e(),e._vnode=t},it={p:b,um:J,m:G,r:Z,mt:L,mc:E,pc:X,pbc:T,n:nt,o:t};let st,ut;e&&([st,ut]=e(it));return{render:ot,hydrate:st,createApp:Hn(ot,st)}}(t)}function Yn({effect:t,update:e},n){t.allowRecurse=e.allowRecurse=n}function Gn(t,e,n=!1){const r=t.children,o=e.children;if(x(r)&&x(o))for(let i=0;i<r.length;i++){const t=r[i];let e=o[i];1&e.shapeFlag&&!e.dynamicChildren&&((e.patchFlag<=0||32===e.patchFlag)&&(e=o[i]=Ir(o[i]),e.el=t.el),n||Gn(t,e))}}function Jn(t,e){return function(t,e,n=!0,r=!1){const o=Le||Pr;if(o){const n=o.type;if("components"===t){const t=function(t){return k(t)&&t.displayName||t.name}(n);if(t&&(t===e||t===M(e)||t===L(M(e))))return n}const i=Qn(o[t]||n[t],e)||Qn(o.appContext[t],e);return!i&&r?n:i}}("components",t,!0,e)||t}const Zn=Symbol();function Qn(t,e){return t&&(t[e]||t[M(e)]||t[L(M(e))])}const tr=Symbol(void 0),er=Symbol(void 0),nr=Symbol(void 0),rr=Symbol(void 0),or=[];let ir=null;function sr(t=!1){or.push(ir=t?null:[])}let ar=1;function lr(t){ar+=t}function cr(t){return t.dynamicChildren=ar>0?ir||f:null,or.pop(),ir=or[or.length-1]||null,ar>0&&ir&&ir.push(t),t}function ur(t,e,n,r,o,i){return cr(mr(t,e,n,r,o,i,!0))}function fr(t,e,n,r,o){return cr(yr(t,e,n,r,o,!0))}function dr(t){return!!t&&!0===t.__v_isVNode}function pr(t,e){return t.type===e.type&&t.key===e.key}const hr="__vInternal",gr=({key:t})=>null!=t?t:null,vr=({ref:t,ref_key:e,ref_for:n})=>null!=t?S(t)||le(t)||k(t)?{i:Le,r:t,k:e,f:!!n}:t:null;function mr(t,e=null,n=null,r=0,o=null,i=(t===tr?0:1),s=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&gr(e),ref:e&&vr(e),scopeId:Fe,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:r,dynamicProps:o,dynamicChildren:null,appContext:null};return a?(kr(l,n),128&i&&t.normalize(l)):n&&(l.shapeFlag|=S(n)?8:16),ar>0&&!s&&ir&&(l.patchFlag>0||6&i)&&32!==l.patchFlag&&ir.push(l),l}const yr=function(t,e=null,n=null,o=0,i=null,s=!1){t&&t!==Zn||(t=nr);if(dr(t)){const r=br(t,e,!0);return n&&kr(r,n),r}l=t,k(l)&&"__vccOpts"in l&&(t=t.__vccOpts);var l;if(e){e=function(t){return t?re(t)||hr in t?m({},t):t:null}(e);let{class:t,style:n}=e;t&&!S(t)&&(e.class=a(t)),N(n)&&(re(n)&&!x(n)&&(n=m({},n)),e.style=r(n))}const c=S(t)?1:(t=>t.__isSuspense)(t)?128:(t=>t.__isTeleport)(t)?64:N(t)?4:k(t)?2:0;return mr(t,e,n,o,i,c,s,!0)};function br(t,e,n=!1){const{props:o,ref:i,patchFlag:s,children:l}=t,c=e?function(...t){const e={};for(let n=0;n<t.length;n++){const o=t[n];for(const t in o)if("class"===t)e.class!==o.class&&(e.class=a([e.class,o.class]));else if("style"===t)e.style=r([e.style,o.style]);else if(g(t)){const n=e[t],r=o[t];!r||n===r||x(n)&&n.includes(r)||(e[t]=n?[].concat(n,r):r)}else""!==t&&(e[t]=o[t])}return e}(o||{},e):o;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:c,key:c&&gr(c),ref:e&&e.ref?n&&i?x(i)?i.concat(vr(e)):[i,vr(e)]:vr(e):i,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:l,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==tr?-1===s?16:16|s:s,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&br(t.ssContent),ssFallback:t.ssFallback&&br(t.ssFallback),el:t.el,anchor:t.anchor}}function _r(t=" ",e=0){return yr(er,null,t,e)}function xr(t="",e=!1){return e?(sr(),fr(nr,null,t)):yr(nr,null,t)}function wr(t){return null==t||"boolean"==typeof t?yr(nr):x(t)?yr(tr,null,t.slice()):"object"==typeof t?Ir(t):yr(er,null,String(t))}function Ir(t){return null===t.el||t.memo?t:br(t)}function kr(t,e){let n=0;const{shapeFlag:r}=t;if(null==e)e=null;else if(x(e))n=16;else if("object"==typeof e){if(65&r){const n=e.default;return void(n&&(n._c&&(n._d=!1),kr(t,n()),n._c&&(n._d=!0)))}{n=32;const r=e._;r||hr in e?3===r&&Le&&(1===Le.slots._?e._=1:(e._=2,t.patchFlag|=1024)):e._ctx=Le}}else k(e)?(e={default:e,_ctx:Le},n=32):(e=String(e),64&r?(n=16,e=[_r(e)]):n=8);t.children=e,t.shapeFlag|=n}function Sr(t,e,n,r=null){pe(t,e,7,[n,r])}function Dr(t,e,n,r){let o;const i=n&&n[r];if(x(t)||S(t)){o=new Array(t.length);for(let n=0,r=t.length;n<r;n++)o[n]=e(t[n],n,void 0,i&&i[n])}else if("number"==typeof t){o=new Array(t);for(let n=0;n<t;n++)o[n]=e(n+1,n,void 0,i&&i[n])}else if(N(t))if(t[Symbol.iterator])o=Array.from(t,((t,n)=>e(t,n,void 0,i&&i[n])));else{const n=Object.keys(t);o=new Array(n.length);for(let r=0,s=n.length;r<s;r++){const s=n[r];o[r]=e(t[s],s,r,i&&i[r])}}else o=[];return n&&(n[r]=o),o}function Nr(t,e,n={},r,o){if(Le.isCE)return yr("slot","default"===e?null:{name:e},r&&r());let i=t[e];i&&i._c&&(i._d=!1),sr();const s=i&&Cr(i(n)),a=fr(tr,{key:n.key||`_${e}`},s||(r?r():[]),s&&1===t._?64:-2);return!o&&a.scopeId&&(a.slotScopeIds=[a.scopeId+"-s"]),i&&i._c&&(i._d=!0),a}function Cr(t){return t.some((t=>!dr(t)||t.type!==nr&&!(t.type===tr&&!Cr(t.children))))?t:null}const Ar=t=>t?Vr(t)?Ur(t)||t.proxy:Ar(t.parent):null,Er=m(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>Ar(t.parent),$root:t=>Ar(t.root),$emit:t=>t.emit,$options:t=>wn(t),$forceUpdate:t=>()=>Ae(t.update),$nextTick:t=>Ce.bind(t.proxy),$watch:t=>Ge.bind(t)}),Or={get({_:t},e){const{ctx:n,setupState:r,data:o,props:i,accessCache:s,type:a,appContext:l}=t;let c;if("$"!==e[0]){const a=s[e];if(void 0!==a)switch(a){case 1:return r[e];case 2:return o[e];case 4:return n[e];case 3:return i[e]}else{if(r!==u&&_(r,e))return s[e]=1,r[e];if(o!==u&&_(o,e))return s[e]=2,o[e];if((c=t.propsOptions[0])&&_(c,e))return s[e]=3,i[e];if(n!==u&&_(n,e))return s[e]=4,n[e];yn&&(s[e]=0)}}const f=Er[e];let d,p;return f?("$attrs"===e&&ct(t,0,e),f(t)):(d=a.__cssModules)&&(d=d[e])?d:n!==u&&_(n,e)?(s[e]=4,n[e]):(p=l.config.globalProperties,_(p,e)?p[e]:void 0)},set({_:t},e,n){const{data:r,setupState:o,ctx:i}=t;return o!==u&&_(o,e)?(o[e]=n,!0):r!==u&&_(r,e)?(r[e]=n,!0):!_(t.props,e)&&(("$"!==e[0]||!(e.slice(1)in t))&&(i[e]=n,!0))},has({_:{data:t,setupState:e,accessCache:n,ctx:r,appContext:o,propsOptions:i}},s){let a;return!!n[s]||t!==u&&_(t,s)||e!==u&&_(e,s)||(a=i[0])&&_(a,s)||_(r,s)||_(Er,s)||_(o.config.globalProperties,s)},defineProperty(t,e,n){return null!=n.get?this.set(t,e,n.get(),null):null!=n.value&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}},Tr=Bn();let $r=0;let Pr=null;const Rr=t=>{Pr=t,t.scope.on()},Mr=()=>{Pr&&Pr.scope.off(),Pr=null};function Vr(t){return 4&t.vnode.shapeFlag}let jr=!1;function Lr(t,e,n){k(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:N(e)&&(t.setupState=ue(e)),Fr(t,n)}function Fr(t,e,n){const r=t.type;t.render||(t.render=r.render||d),Rr(t),at(),bn(t),lt(),Mr()}function Ur(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(ue(ie(t.exposed)),{get:(e,n)=>n in e?e[n]:n in Er?Er[n](t):void 0}))}const Kr=(t,e)=>function(t,e,n=!1){let r,o;const i=k(t);return i?(r=t,o=d):(r=t.get,o=t.set),new fe(r,o,i||!o,n)}(t,0,jr),Br="3.2.31",Wr="undefined"!=typeof document?document:null,Hr=Wr&&Wr.createElement("template"),Xr={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,r)=>{const o=e?Wr.createElementNS("http://www.w3.org/2000/svg",t):Wr.createElement(t,n?{is:n}:void 0);return"select"===t&&r&&null!=r.multiple&&o.setAttribute("multiple",r.multiple),o},createText:t=>Wr.createTextNode(t),createComment:t=>Wr.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Wr.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},cloneNode(t){const e=t.cloneNode(!0);return"_value"in t&&(e._value=t._value),e},insertStaticContent(t,e,n,r,o,i){const s=n?n.previousSibling:e.lastChild;if(o&&(o===i||o.nextSibling))for(;e.insertBefore(o.cloneNode(!0),n),o!==i&&(o=o.nextSibling););else{Hr.innerHTML=r?`<svg>${t}</svg>`:t;const o=Hr.content;if(r){const t=o.firstChild;for(;t.firstChild;)o.appendChild(t.firstChild);o.removeChild(t)}e.insertBefore(o,n)}return[s?s.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}};const qr=/\s*!important$/;function zr(t,e,n){if(x(n))n.forEach((n=>zr(t,e,n)));else if(e.startsWith("--"))t.setProperty(e,n);else{const r=function(t,e){const n=Gr[e];if(n)return n;let r=M(e);if("filter"!==r&&r in t)return Gr[e]=r;r=L(r);for(let o=0;o<Yr.length;o++){const n=Yr[o]+r;if(n in t)return Gr[e]=n}return e}(t,e);qr.test(n)?t.setProperty(j(r),n.replace(qr,""),"important"):t[r]=n}}const Yr=["Webkit","Moz","ms"],Gr={};const Jr="http://www.w3.org/1999/xlink";let Zr=Date.now,Qr=!1;if("undefined"!=typeof window){Zr()>document.createEvent("Event").timeStamp&&(Zr=()=>performance.now());const t=navigator.userAgent.match(/firefox\/(\d+)/i);Qr=!!(t&&Number(t[1])<=53)}let to=0;const eo=Promise.resolve(),no=()=>{to=0};function ro(t,e,n,r,o=null){const i=t._vei||(t._vei={}),s=i[e];if(r&&s)s.value=r;else{const[n,a]=function(t){let e;if(oo.test(t)){let n;for(e={};n=t.match(oo);)t=t.slice(0,t.length-n[0].length),e[n[0].toLowerCase()]=!0}return[j(t.slice(2)),e]}(e);if(r){!function(t,e,n,r){t.addEventListener(e,n,r)}(t,n,i[e]=function(t,e){const n=t=>{const r=t.timeStamp||Zr();(Qr||r>=n.attached-1)&&pe(function(t,e){if(x(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map((t=>e=>!e._stopped&&t&&t(e)))}return e}(t,n.value),e,5,[t])};return n.value=t,n.attached=(()=>to||(eo.then(no),to=Zr()))(),n}(r,o),a)}else s&&(!function(t,e,n,r){t.removeEventListener(e,n,r)}(t,n,s,a),i[e]=void 0)}}const oo=/(?:Once|Passive|Capture)$/;const io=/^on[a-z]/;const so=m({patchProp:(t,r,o,i,s=!1,a,l,c,u)=>{"class"===r?function(t,e,n){const r=t._vtc;r&&(e=(e?[e,...r]:[...r]).join(" ")),null==e?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}(t,i,s):"style"===r?function(t,e,n){const r=t.style,o=S(n);if(n&&!o){for(const t in n)zr(r,t,n[t]);if(e&&!S(e))for(const t in e)null==n[t]&&zr(r,t,"")}else{const i=r.display;o?e!==n&&(r.cssText=n):e&&t.removeAttribute("style"),"_vod"in t&&(r.display=i)}}(t,o,i):g(r)?v(r)||ro(t,r,0,i,l):("."===r[0]?(r=r.slice(1),1):"^"===r[0]?(r=r.slice(1),0):function(t,e,n,r){if(r)return"innerHTML"===e||"textContent"===e||!!(e in t&&io.test(e)&&k(n));if("spellcheck"===e||"draggable"===e)return!1;if("form"===e)return!1;if("list"===e&&"INPUT"===t.tagName)return!1;if("type"===e&&"TEXTAREA"===t.tagName)return!1;if(io.test(e)&&S(n))return!1;return e in t}(t,r,i,s))?function(t,e,r,o,i,s,a){if("innerHTML"===e||"textContent"===e)return o&&a(o,i,s),void(t[e]=null==r?"":r);if("value"===e&&"PROGRESS"!==t.tagName&&!t.tagName.includes("-")){t._value=r;const n=null==r?"":r;return t.value===n&&"OPTION"!==t.tagName||(t.value=n),void(null==r&&t.removeAttribute(e))}if(""===r||null==r){const o=typeof t[e];if("boolean"===o)return void(t[e]=n(r));if(null==r&&"string"===o)return t[e]="",void t.removeAttribute(e);if("number"===o){try{t[e]=0}catch(l){}return void t.removeAttribute(e)}}try{t[e]=r}catch(c){}}(t,r,i,a,l,c,u):("true-value"===r?t._trueValue=i:"false-value"===r&&(t._falseValue=i),function(t,r,o,i,s){if(i&&r.startsWith("xlink:"))null==o?t.removeAttributeNS(Jr,r.slice(6,r.length)):t.setAttributeNS(Jr,r,o);else{const i=e(r);null==o||i&&!n(o)?t.removeAttribute(r):t.setAttribute(r,i?"":o)}}(t,r,i,s))}},Xr);let ao;const lo=(...t)=>{const e=(ao||(ao=zn(so))).createApp(...t),{mount:n}=e;return e.mount=t=>{const r=function(t){if(S(t)){return document.querySelector(t)}return t}(t);if(!r)return;const o=e._component;k(o)||o.render||o.template||(o.template=r.innerHTML),r.innerHTML="";const i=n(r,!1,r instanceof SVGElement);return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),i},e};function co(t){return t[t.length-1]}console.assert=(t,e)=>{t||console.log(new Error(e))};const uo="0987654321abcdefghijklmnoprstuvyz";function fo(t){return function(t=4){const e=uo.length,n=Math.pow(e,t);let r=Math.floor(Math.random()*n);const o=[];for(let i=0;i<t;i+=1)o.push(uo[r%e]),r=Math.floor(r/e);return o.join("")}()}function po(t){if(t||(t=document.getSelection()),!(t instanceof Selection))return t;if(t.isCollapsed){const e={node:t.anchorNode,offset:t.anchorOffset};return{start:e,end:e,backwards:!1,collapsed:!0,selection:t}}const e=function(t){if(t.isCollapsed)return!1;if(t.anchorNode===t.focusNode)return t.anchorOffset>t.focusOffset;const e=[t.anchorNode];let n=t.anchorNode;for(;n&&n!=document.body;)n=n.parentNode,e.push(n);for(n=t.focusNode;n&&n!=document.body;){const t=n;let r;n=n.parentNode;for(const o of e){if(n===o)for(const e of o.childNodes){if(e===r)return!1;if(e===t)return!0}r=o}}}(t);return{start:{node:e?t.focusNode:t.anchorNode,offset:e?t.focusOffset:t.anchorOffset},end:{node:e?t.anchorNode:t.focusNode,offset:e?t.anchorOffset:t.focusOffset},backwards:e,collapsed:!1,selection:t}}function ho(t,e,n=[]){if(t&&t.nodeType==Node.TEXT_NODE&&(t=t.parentNode),t&&t.nodeType==Node.ELEMENT_NODE&&(!e||t.nodeName===e)){const e={};for(const r of n){const n=t.attributes["data-"+r];n&&(e[r]=n.nodeValue)}return{node:t,attrs:e}}return{}}function go(t){return t.nodeType===Node.ELEMENT_NODE?t.childNodes.length>0?t.childNodes[0]:t:t.nodeType===Node.TEXT_NODE?t:void 0}function vo(t,e){const n=e.querySelector(`div[data-id="${t.paragraphID}"]`+(t.spanID?` > span[data-id="${t.spanID}"]`:""));return t.node=n,t}function mo(t,e,n){const r=go(e.node||vo(e,t).node),o=n&&go(n.node||vo(n,t).node),i=document.getSelection();i.empty();const s=new Range;s.setStart(r,e.offset),n?s.setEnd(o,n.offset):s.collapse(!0),i.addRange(s)}function yo(t){return t.spans}function bo(t,e){return t.spans=e}function _o(t=""){return{id:fo(),text:t,format:{}}}function xo(t){return{id:fo(),spans:"number"==typeof t?Array.from(Array(t),(()=>_o())):t||[]}}function wo(t,...e){return Object.assign({},t,{format:Object.assign({},t.format||{})},...e)}function Io(t,e,{newid:n,splitTime:r}={newid:fo,splitTime:!1}){const o={id:n(t.id),text:t.text.substr(0,e),format:Object.assign({},t.format)},i={id:n(t.id),text:t.text.substr(e),format:Object.assign({},t.format)};if(r){const e=t.text.replace(/\s*/g,"").length;t.duration>0&&(o.duration=o.text.replace(/\s*/g,"").length*t.duration/e,i.duration=i.text.replace(/\s*/g,"").length*t.duration/e,t.time>=0&&(o.time=t.time,i.time=t.time+o.duration))}else o.time=t.time,i.time=t.time,o.duration=t.duration,i.duration=t.duration,t.group&&t.group.length>0?(o.group=t.group,i.group=t.group):(o.group=t.id,i.group=t.id);return{left:o,right:i}}function ko(t,e,n){console.assert(void 0!==t,"data not specified"),console.assert(void 0!==e,"paragraphID not specified");const r=t=>-1===t?void 0:t,o=t;console.assert(void 0!==o,"no paragraphs");const i=r(o.findIndex((t=>t.id===e))),s=void 0!==i&&-1!==i&&o[i]||void 0,a=s&&r(yo(s).findIndex((t=>t.id===n)));return{paragraph:s,paragraphIndex:i,span:void 0!==a&&-1!==a&&yo(s)[a]||void 0,spanIndex:a}}function So(t,e,n){const r=e>=0&&t[e]||void 0,o=r&&yo(r);return{paragraph:r,span:o&&void 0!==n&&o[-1===n||n>=o.length?o.length-1:n]||void 0}}function Do(t,e){console.assert(void 0!==t,"data not specified"),console.assert(void 0!==e,"pointer not specified");const{spanAttrs:n,paragraphAttrs:r}=function(t){let e,n,r,o,i=t;for(;i&&!n;){const{node:t,attrs:s}=ho(i,void 0,["id","time","duration","confidence"]);if(!n&&!e&&t&&"SPAN"===t.nodeName&&s.id)e=s,r=t;else if(!n&&t&&"DIV"===t.nodeName&&s.id){n=s,o=t;break}t&&(i=t),i=i.parentNode}return{spanNode:r,spanAttrs:e,paragraphNode:o,paragraphAttrs:n}}(e.node),o=r&&r.id,i=n&&n.id,s=t,{paragraphIndex:a,paragraph:l,spanIndex:c,span:u}=s&&ko(t,o,i)||{};return{node:e.node,spanAttrs:n,paragraphAttrs:r,paragraphID:o,spanID:i,paragraphIndex:a,paragraph:l,spanIndex:c,span:u,offset:e.offset}}function No(t,e){!function(t,e){if(e.spanID&&e.paragraphID)return e.node;if(e.paragraphID){const{node:t}=ho(e.node,"DIV",["id"]);return t}}(t,e);let n,r,o,i,{node:s,offset:a}=e;if(s.nodeType===Node.ELEMENT_NODE){a=0;for(let t=e.offset-1;t>=0&&t<s.childNodes.length;t--)a+=s.childNodes.textContent&&s.childNodes[t].textConent.length||0}for(;s&&s!=t;){if(s.nodeType===Node.ELEMENT_NODE){if("SPAN"===s.nodeName){n=s.attributes["data-id"].nodeValue}if("DIV"===s.nodeName){r=s.attributes["data-id"].nodeValue}}let t=s;for(;t=t.previousSibling;){if(!o&&"SPAN"===t.nodeName){if(o=t.attributes["data-id"].nodeValue,!n&&!r)break}if(!i&&"DIV"===t.nodeName){if(i=t.attributes["data-id"].nodeValue,!n&&!r)break}n||r||t.textConent&&(a+=t.textConent.length)}s=s.parentNode}return e.spanID=n,e.paragraphID=r,e.offset=a,e.leftSpanID=o,e.leftParagraphID=i,e}function Co(t,e){if(console.assert(void 0!==t,"data not specified"),console.assert(void 0!==e,"pointer not specified"),void 0===e.paragraphID&&(void 0===e.paragraphIndex||-1===e.paragraphIndex))return console.assert(void 0!==e.node,"invalid pointer, no paragraph info and no node"),Object.assign(e,Do(t,e));if(void 0===e.paragraphID||void 0!==e.paragraphIndex&&-1!==e.paragraphIndex){if(void 0===e.paragraphID&&(void 0!==e.paragraphIndex||-1!==e.paragraphIndex)){const{paragraph:n,span:r}=So(t,e.paragraphIndex,e.spanIndex);console.assert(n,"paragraph not resolved"),console.assert(void 0!==e.spanIndex&&r||void 0===e.spanIndex||0===yo(t[e.paragraphIndex]).length,"span not resolved, but span index is setZ"),Object.assign(e,{paragraph:n,paragraphID:n.id}),!r||void 0!==e.span&&void 0!==e.spanID||Object.assign(e,{span:r,spanID:r.id})}}else{const{paragraphIndex:n,paragraph:r,spanIndex:o,span:i}=ko(t,e.paragraphID,e.spanID);console.assert(r,"paragraph not resolved"),console.assert(e.spanID&&i||void 0===e.spanID,"span not resolved, but span id is set"),Object.assign(e,{paragraphIndex:n,paragraph:r}),void 0!==e.span&&(e.span=i)}if(void 0===e.spanID&&void 0===e.spanIndex){if(e.node)return Object.assign(e,Do(t,e))}else if(void 0!==e.spanID&&void 0===e.spanIndex)Object.assign(e,ko(t,e.paragraphID,e.spanID)),console.assert(e.paragraph,"paragraph not resolved"),console.assert(void 0!==e.spanIndex&&e.span,"span not resolved, but span id is setY");else if(void 0===e.spanID&&void 0!==e.spanIndex){const{paragraph:n,span:r}=So(t,e.paragraphIndex,e.spanIndex),o=yo(n);e.spanIndex>=o.length&&o.length>0&&(e.spanIndex=o.length-1,e.offset=o[o.length-1].text.length),console.assert(e.paragraph,"paragraph not resolved"),console.assert(r||0===yo(t[e.paragraphIndex]).length,"span not resolved, but span index is set"),Object.assign(e,{paragraph:n,paragraphID:n.id,span:r,spanID:r&&r.id,spanIndex:r&&e.spanIndex})}if(null!=e.paragraphIndex&&-1!=e.paragraphIndex&&null!=e.spanIndex){const n=yo(t[e.paragraphIndex]);n.length>0&&(-1===e.spanIndex&&(e.spanIndex=n.length-1),e.offset<0&&(e.offset=n[e.spanIndex].text.length+1+e.offset))}return e}function Ao(t,e,n){console.assert(void 0!==t,"data not set"),console.assert(e.paragraphIndex>=0,"pointer paragraphIndex missing or invalid");const r=t;let o=e.paragraphIndex,i=e.spanIndex;if(void 0!==i&&-1!==i)if(i<yo(r[o]).length-1)i++;else{if(!(o<r.length-1))return;o++,i=yo(r[o]).length>0?0:void 0}else{if(!(o<r.length-1))return;o++,i=yo(r[o]).length>0?0:void 0}return void 0===n&&(n=0),Co(t,{paragraphIndex:o,spanIndex:i,offset:n})}const Eo=Object.freeze({Remove:1,InPlace:2,Copy:3});function Oo(t,e,n,r,o,i=Eo.Remove){null==e&&(e=0),(null==n||n<0)&&(n=0),(null==r||r>=t.length)&&(r=t.length-1);const s=t[r].text.length;if((void 0===o||o>s)&&(o=s),o<0&&(o=0),n>t[e].text.length&&(n=t[e].text.length),e===r){if(o<n&&(o=n),i===Eo.Remove){const r=t[e],i=r.text.substring(n,o);r.text=r.text.substring(0,n)+r.text.substring(o);const s=[];return i.length>0&&s.push(wo(r,{text:i})),{spans:s,splitIndex:e,splitOffset:n,removedSpanText:i}}if(i===Eo.InPlace){const r=t[e];if(0===n&&o>=r.text.length)return{spans:[r],splitIndex:e,splitOffset:n};if(n===o){if(0===n)return{right:r,spans:[],splitIndex:e,splitOffset:n};if(o>=r.text.length)return{left:r,spans:[],splitIndex:e+1,splitOffset:0};{let{left:o,right:i}=Io(r,n);return t.splice(e,1,...[o,i].filter((t=>t.text.length>0))),{left:o,right:i,spans:[],splitIndex:e+1,splitOffset:0}}}if(0===n){let{left:i,right:s}=Io(r,o);return t.splice(e,1,...[i,s].filter((t=>t.text.length>0))),{right:s,spans:[i],splitIndex:e,splitOffset:n}}if(o>=r.text.length){let{left:o,right:i}=Io(r,n);return t.splice(e,1,...[o,i].filter((t=>t.text.length>0))),{left:o,spans:[i],splitIndex:e+1,splitOffset:n}}let{left:i,right:s}=Io(r,n),{left:a,right:l}=Io(s,o-n);return t.splice(e,1,...[i,a,l].filter((t=>t.text.length>0))),{left:i,right:l,spans:[a],splitIndex:e+1,splitOffset:0}}if(i===Eo.Copy){const r=t[e],i=r.text.substring(n,o),s=[];return i.length>0&&s.push(wo(r,{text:i,group:r.id})),{spans:s,splitIndex:e,splitOffset:n}}}if(r===e+1&&0===o&&n>=t[e].text.length)return{spans:[],splitIndex:e,splitOffset:n};const a=0===n?e:e+1,l=o>=s?r:r-1;if(i===Eo.Remove){const i=t.splice(a,l+1-a);if(e<a){const r=t[e],{left:o,right:s}=Io(r,n);s.text.length>0&&i.unshift(wo(r,s)),Object.assign(r,o)}if(l<r){const e=t[a],{left:n,right:r}=Io(e,o);n.text.length>0&&i.push(wo(e,n)),Object.assign(e,r)}return{spans:i,splitIndex:e,splitOffset:n}}if(i===Eo.InPlace){const i=t.slice(a,l+1);if(l<r){const e=t[r];if(o>0&&o<e.text.length){console.log("end offset middle");const{left:n,right:s}=Io(e,o);t.splice(r,1,...[n,s].filter((t=>t.text.length>0))),i.push(n)}else o>0&&i.push(e)}if(e<a){const r=t[e];if(n>0&&n<r.text.length){console.log("start offset middle");const{left:o,right:s}=Io(r,n);i.unshift(s),t.splice(e,1,...[o,s].filter((t=>t.text.length>0))),e++}else 0===n?i.unshift(r):e++}return{spans:i,splitIndex:e,splitOffset:n}}if(i===Eo.Copy){const i=t.slice(a,l+1);if(e<a){const r=t[e],{left:o,right:s}=Io(r,n);s.text.length>0&&i.unshift(wo(r,s))}if(l<r){const e=t[r],{left:n,right:s}=Io(e,o);n.text.length>0&&i.push(wo(e,n))}return{spans:i,splitIndex:e,splitOffset:n}}}function To(t,e,n,r=Eo.Remove){const o=t,i=[];let s;for(let a=e.paragraphIndex;a<o.length&&a<=n.paragraphIndex;){const t=o[a];if(t.id===e.paragraphID&&(s=t),t.id===e.paragraphID&&t.id===n.paragraphID){if(yo(t).length>0){if(r===Eo.Remove){const o=Oo(yo(t),e.spanIndex,e.offset,n.spanIndex,n.offset,r);o.spans.length>0&&i.push({id:t.id,spans:o.spans,partial:e.spanIndex>0||e.offset>0||n.spanIndex<yo(t).length-1||yo(t).length>0&&n.offset<co(yo(t)).text.length})}else if(r===Eo.Copy){const o=Oo(yo(t),e.spanIndex,e.offset,n.spanIndex,n.offset,r);o.spans.length>0&&i.push({id:t.id,spans:o.spans,partial:e.spanIndex>0||e.offset>0||n.spanIndex<yo(t).length-1||n.offset<co(yo(t)).text.length})}else if(r===Eo.InPlace){const o=Oo(yo(t),e.spanIndex,e.offset,n.spanIndex,n.offset,r);o.spans.length>0&&i.push({id:t.id,spans:o.spans,partial:e.spanIndex>0||e.offset>0||n.spanIndex<yo(t).length-1||n.offset<co(yo(t)).text.length})}}else r===Eo.Remove?(o.splice(a,1),i.push(Object.assign({},t,{partial:!1}))):r===Eo.Copy?i.push(Object.assign({},t,{partial:!1})):r===Eo.InPlace&&(o.splice(a,1),i.push(t));break}if(t.id===e.paragraphID&&yo(t).length>0){const n=Oo(yo(t),e.spanIndex,e.offset,void 0,void 0,r);0===yo(t).length&&r===Eo.Remove?o.splice(a,1):a++,n.spans.length>0&&i.push({id:t.id,spans:n.spans,partial:yo(t).length>0})}else{if(t.id===n.paragraphID&&yo(t).length>0){const e=Oo(yo(t),0,0,n.spanIndex,n.offset,r);e.spans.length>0&&i.push({id:t.id,spans:e.spans,partial:yo(t).length>0}),yo(s).length>0&&r===Eo.Remove&&(yo(s).splice(yo(s).length,0,...yo(t)),o.splice(a,1));break}if(t.id===n.paragraphID){r===Eo.Remove&&o.splice(a,1),i.push(Object.assign({},t,{partial:!1}));break}r===Eo.Remove?o.splice(a,1):a++,i.push(Object.assign({},t,{partial:!1}))}}return i}function $o(t,e,n){const r=t,o=n;if(0===o.length)return;if(0===r.length){r.splice(0,0,...n);const e=co(n);return{start:Co(t,{paragraphIndex:0,spanIndex:0,offset:0}),end:Co(t,{paragraphIndex:n.length-1,spanIndex:e.spans.length-1,offset:co(e.spans).text.length})}}if(1===o.length){const n=yo(o[0]),i=r[e.paragraphIndex];let s,a;if(0===e.offset)yo(i).splice(e.spanIndex,0,...n),s=Co(t,{paragraphID:e.paragraphID,spanIndex:e.spanIndex,offset:0}),a=Co(t,{paragraphID:e.paragraphID,spanIndex:e.spanIndex+n.length-1,offset:-1});else if(e.offset===yo(i)[e.spanIndex].text.length)yo(i).splice(e.spanIndex+1,0,...n),s=Co(t,{paragraphID:e.paragraphID,spanIndex:e.spanIndex+1,offset:0}),a=Co(t,{paragraphID:e.paragraphID,spanIndex:e.spanIndex+1+n.length-1,offset:-1});else{const{left:r,right:o}=Io(yo(i)[e.spanIndex],e.offset);yo(i).splice(e.spanIndex+1,0,wo(yo(i)[e.spanIndex],o)),Object.assign(yo(i)[e.spanIndex],r),yo(i).splice(e.spanIndex+1,0,...n),s=Co(t,{paragraphID:e.paragraphID,spanIndex:e.spanIndex+1,offset:0}),a=Co(t,{paragraphID:e.paragraphID,spanIndex:e.spanIndex+1+n.length-1,offset:-1})}return{start:s,end:a,spans:n}}const i=r[e.paragraphIndex],s=xo();let a,l;if(null!=e.spanIndex&&-1!=e.spanIndex&&yo(i).length>0)if(0===e.offset){bo(s,yo(i).splice(e.spanIndex))}else if(e.offset===yo(i)[e.spanIndex].text.length){bo(s,yo(i).splice(e.spanIndex+1))}else{const t=yo(i).splice(e.spanIndex+1),{left:n,right:r}=Io(yo(i)[e.spanIndex],e.offset);bo(s,t),yo(s).unshift(wo(yo(i)[e.spanIndex],r)),Object.assign(yo(i)[e.spanIndex],n)}yo(o[0]).length>0&&(a={paragraphID:i.id,spanIndex:yo(r[e.paragraphIndex]).length,offset:0}),yo(r[e.paragraphIndex]).splice(yo(r[e.paragraphIndex]).length,0,...yo(o[0]));let c=e.paragraphIndex+1;o.length>2&&(r.splice(c,0,...o.slice(1,o.length-1)),c+=o.length-2),yo(s).splice(0,0,...yo(o[o.length-1])),r.splice(c,0,s),a||(a={paragraphIndex:e.paragraphIndex+1,spanIndex:0,offset:0}),l=Co(t,{paragraphID:s.id,spanIndex:yo(o[o.length-1]).length-1,offset:-1}),a=Co(t,a);return{start:a,end:l,spans:n.reduce(((t,e)=>t.concat(yo(e))),[])}}function Po(t,e){let n=0;for(const r of e)if(n<t.length&&t[n].id===r.id)t[n].text=r.text,n++;else{let e=!1;for(let o=n;o<t.length;o++)if(t[o].id===r.id){t.splice(n,o-n),t[n].text=r.text,n++,e=!0;break}e||(t.splice(n,0,r),n++)}return t.length>n&&t.splice(n),t}function*Ro(t,e,n){let r=void 0===e;for(const o of t)if(r||o.id!==e||(r=!0),r&&(yield o,void 0!==n&&o.id===n))return}const Mo={props:{modelValue:Object,time:Number,editable:{type:Boolean,default:!0},showConfidence:{type:Boolean,default:!1}},data:()=>({paragraphs:[],key:1}),mounted(){const t=function(t,e,n){let r;return{now(e,...o){if(r=null,!n)return t.apply(e,o)},debounced(o,...i){const s=n&&!r;clearTimeout(r),r=setTimeout((()=>{this.now(o,...i)}),e),s&&t.apply(o,i)}}}(this.applyViewChangesNow,200);this.applyViewChangesNow=(...e)=>t.now(this,...e),this.applyViewChanges=(...e)=>t.debounced(this,...e),this.$options.watch.modelValue.call(this,this.modelValue)},watch:{modelValue(t){this.paragraphs=t.paragraphs||[]}},methods:{reset(){console.debug("resetting"),this.key+=1},save(){this.$emit("update:modelValue",Object.assign({},this.modelValue,{paragraphs:this.paragraphs}))},download(t,e,n="text/plain"){let r=document.createElement("a");r.setAttribute("href",`data:${n};charset=utf-8,`+encodeURIComponent(e)),r.setAttribute("download",t),r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r)},asHTML(t){t||(t=this.paragraphs);const e=[];for(const n of t){let t=[];for(const e of n.spans){let n="span";e.format&&(e.format.bold?n="strong":e.format.italic?n="em":e.format.underline?n="u":e.format.subscript?n="sub":e.format.superscript&&(n="sup")),t.push(`<${n}>${e.text}</${n}>`)}t=t.join(""),n.bullet?e.push(`<li>${t}</li>`):e.push(`<p>${t}</p>`)}return e.join("\n")},exportWord(t="document.doc"){const e=`<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns="http://www.w3.org/TR/REC-html40">\n      <head><meta charset='utf-8'><title>RUTA exported document</title></head>\n      <body>${this.asHTML()}</body>\n      </html>`;this.download(t,e,"application/vnd.ms-word")},spanSelected(t,e){document.getSelection().isCollapsed&&this.$emit("update:time",t.time)},selectStart(t){},selectEnd(t){const e=this.paragraphs,n=po();Co(e,n.start);if(Co(e,n.end),n.collapsed)this.$emit("selected");else{const t=n.start.span.time,e=void 0!==n.end.span.time?n.end.span.time+n.end.span.duration||0:void 0;this.$emit("selected",{start:t,end:e})}},getSpanSelection(t){const e=this.paragraphs;return Co(e,(t=po(t)).start),Co(e,t.end),Array.from(function*(t,e,n){const r=t;let o=!1;for(const i of r){if(e||(o=!0),e&&i.id===e.paragraphID&&n&&i.id===n.paragraphID)return void(yield{paragraph:i,spans:Array.from(Ro(i.spans,e.spanID,n.spanID))});if(e&&i.id===e.paragraphID)o=!0,yield{paragraph:i,spans:Array.from(Ro(i.spans,e.spanID))};else{if(n&&i.id===n.paragraphID)return void(o&&(yield{paragraph:i,spans:Array.from(Ro(i.spans,void 0,n.spanID))}));o&&(yield{paragraph:i,spans:Array.from(i.spans)})}}}(this.paragraphs,t.start,t.end))},toggleStyleX(t,e){const n=po();if(!n.collapsed){const r=this.paragraphs;!function(t,e){Co(t,e.start),Co(t,e.end),e.start.offsetLeft=e.start.offset,0===e.start.spanIndex||e.start.spanIndex>0&&(e.start.leftSpanIndex=e.start.spanIndex-1,e.start.leftSpanID=yo(e.start.paragraph)[e.start.spanIndex-1].id),e.end.offsetRight=e.end.span.text.length-e.end.offset,e.end.spanIndex>=yo(e.end.paragraph).length||e.end.spanIndex<yo(e.end.paragraph).length-1&&(e.end.rightSpanIndex=e.end.spanIndex+1,e.end.rightSpanID=yo(e.end.paragraph)[e.end.spanIndex+1].id)}(r,n),this.toggleStyle(t,n),n.start.node=void 0,n.end.node=void 0,function(t,e){if(void 0!==e.start.offsetLeft){let t=0;const n=yo(e.start.paragraph);for(let r=void 0===e.start.leftSpanIndex?0:e.start.leftSpanIndex+1;r<n.length;r++){const o=n[r];if(e.start.offsetLeft>=t&&e.start.offsetLeft<=t+o.text.length){e.start.spanIndex=r,e.start.span=o,e.start.spanID=o.id,e.start.offset=e.start.offsetLeft-t;break}t+=o.text.length}}if(void 0!==e.end.offsetRight){let t=0;const n=yo(e.end.paragraph);if(void 0!==e.end.rightSpanID)for(let r=e.start.leftSpanIndex;r<n.length;r++)if(n[r].id===e.end.rightSpanID){e.end.rightSpanIndex=r;break}for(let r=void 0===e.end.rightSpanIndex?n.length-1:e.end.rightSpanIndex-1;r>=0;r--){const o=n[r];if(e.end.offsetRight>=t&&e.end.offsetRight<=t+o.text.length){e.end.spanIndex=r,e.end.span=o,e.end.spanID=o.id,e.end.offset=o.text.length-(e.end.offsetRight-t);break}t+=o.text.length}}delete e.start.offsetLeft,delete e.start.leftSpanIndex,delete e.start.leftSpanID,delete e.end.offsetRight,delete e.end.rightSpanIndex,delete e.end.rightSpanID}(0,n),this.$nextTick((()=>{e||this.$refs.container.focus(),mo(this.$refs.container,n.start,n.end)}))}},toggleStyle(t,e){const n=this.paragraphs;if(e||(e=po()),e.isCollapsed)return;const r=e.start;Co(n,r);const o=e.end;Co(n,o);const i=To(n,r,o,Eo.InPlace);let s,a,l=!0;for(const c of i)for(const e of c.spans)if(e.format&&e.format[t]){l=!1;break}"subscript"===t?(s="superscript",a=!1):"superscript"===t&&(s="subscript",a=!1);for(const c of i)for(const e of c.spans)Object.assign(e,{format:Object.assign(e.format||{},{[t]:l},s&&{[s]:a}||{}),id:fo()})},toggleBullet(){const t=document.getSelection(),e=this.getSpanSelection(t);let n=!0;for(const r of e)if(r.paragraph.bullet){n=!1;break}for(const r of e)r.paragraph.bullet=n},mapContainerOffsetPointerToData(t,e){if(!e.paragraphID){let n=0;for(const r of t)if(e.leftParagraphID&&r.id===e.leftParagraphID)n=0;else{for(const t of r.spans){if(n<=e.offset&&e.offset<n+t.text.length){e.paragraphID=r.id,e.paragraph=r,e.spanID=t.id,e.span=t,e.offset-=n;break}n+=t.text.length}if(e.offset===n&&r.spans.length>0){e.paragraphID=r.id;const t=r.spans[r.spans.length-1];e.spanID=t.id,e.span=t,e.offset=t.text.length}if(e.paragraphID)break}}if(e.paragraphID&&!e.spanID)for(const n of t){if(n.id!==e.paragraphID)continue;let t=0;for(const r of n.spans)if(e.leftSpanID&&r.id===e.leftSpanID)t=0;else{if(t<=e.offset&&e.offset<t+r.text.length){e.spanID=r.id,e.span=r,e.offset-=t;break}t+=r.text.length}if(e.offset===t&&n.spans.length>0){const t=n.spans[n.spans.length-1];e.spanID=t.id,e.span=t,e.offset=t.text.length}break}return e.node=void 0,Co(t,e),e},parseDOM(t){let e=this.paragraphs;const n=po(),r=Do(e,n.start),o=Do(e,n.end);r.spanID&&r.paragraphID||No(this.$refs.container,r),o.spanID&&o.paragraphID||No(this.$refs.container,o);const i=function(t){const e=(t,e)=>{let n=t;return void 0!==n&&(n=n.nodeValue),void 0!==n&&void 0!==e&&(n=e(n)),n},n=[];let r=!1;for(const o of t.childNodes)if(o.nodeType===Node.ELEMENT_NODE)if("DIV"===o.nodeName&&o.attributes["data-id"]){r=!0;const t=[],i={id:o.attributes["data-id"].nodeValue,spans:t};let s;n.push(i);const a=o;for(const n of a.childNodes)if(n.nodeType===Node.ELEMENT_NODE)if("SPAN"===n.nodeName&&n.attributes["data-id"]){const r=n.attributes["data-id"].nodeValue;let o=n.innerText;s&&s.length>0&&(o=s+o,s=void 0);const i=e(n.attributes["data-time"],parseInt),a=e(n.attributes["data-duration"],parseInt),l=e(n.attributes["data-confidence"],parseFloat);t.push({id:r,text:o,time:i,duration:a,confidence:l})}else n.nodeName;else n.nodeType===Node.TEXT_NODE&&(n.nodeValue.length>0&&(t.length>0?t[t.length-1].text+=n.nodeValue.length:s=n.nodeValue),n.nodeValue="");0===t.length&&s&&s.length>0&&t.push(_o(s))}else"BR"===o.nodeName?(console.log("br",o),r=!1,o.remove()):o.remove();else if(o.nodeType===Node.TEXT_NODE&&o.nodeValue.length>0){let t=n.length>0&&r&&n[n.length-1];t||(t={id:fo(),spans:[]},n.push(t)),t.spans.push({id:fo(),text:o.nodeValue}),o.remove()}return n}(this.$refs.container),s=function(t,e){let n=0;for(const r of e)if(n<t.length&&t[n].id===r.id)Po(yo(t[n]),yo(r)),n++;else{let e=!1;for(let o=n;o<t.length;o++)if(t[o].id===r.id){t.splice(n,o-n),t[n].text=r.text,n++,e=!0;break}e||(t.splice(n,0,r),n++)}return t.length>n&&t.splice(n),t}(this.paragraphs||[],i);return this.paragraphs=s,e=s,this.mapContainerOffsetPointerToData(e,r),this.mapContainerOffsetPointerToData(e,o),t&&this.$nextTick((()=>{mo(this.$refs.container,Co(e,r),n.collapsed?null:Co(e,o))})),{paragraphs:s,start:r,end:o,collapsed:n.collapsed}},applyViewChangesNow(t=!0){const{paragraphs:e,start:n,end:r,collapsed:o}=this.parseDOM(t);return this.save(),{start:n,end:r,collapsed:o}},onInput(t){this.applyViewChanges()},errorCaptured(t,e,n){console.debug("ERROR captured:",t,e,n)},async onKeydown(t){if((t.metaKey||t.ctrlKey)&&t.shiftKey&&t.altKey&&"KeyR"===t.code)return this.reset(),t.stopPropagation(),void t.preventDefault();if((t.metaKey||t.ctrlKey)&&"KeyZ"===t.code)return t.stopPropagation(),void t.preventDefault();if((t.metaKey||t.ctrlKey)&&("KeyC"===t.code||"KeyV"===t.code||"KeyX"===t.code||"KeyR"===t.code||"Meta"===t.key||"Control"===t.key))return;if("Escape"===t.code||"Tab"===t.code)return;if("ArrowLeft"===t.key||"ArrowRight"===t.key||"ArrowUp"===t.key||"ArrowDown"===t.key)return void t.shiftKey;if("Dead"===t.key)return;let e=document.getSelection();if(!e.isCollapsed&&!t.ctrlKey&&!t.metaKey&&"Alt"!=t.key&&"Shift"!=t.key){"Delete"!==t.key&&"Backspace"!==t.key&&"Enter"!==t.key||(t.stopPropagation(),t.preventDefault());const n=this.paragraphs;e=po(e);const r=e.start;Co(n,r);const o=e.end;return Co(n,o),To(n,r,o),"Enter"===t.key?($o(n,r,[xo(),xo()]),void this.$nextTick((()=>{mo(this.$refs.container,vo(Ao(n,r),this.$refs.container))}))):void this.$nextTick((()=>{r.spanID=void 0,r.node=void 0,mo(this.$refs.container,Co(n,r))}))}if("KeyL"===t.code&&(!0===t.metaKey||!0===t.ctrlKey))return this.toggleBullet(),t.stopPropagation(),t.preventDefault(),!1;if(("KeyL"===t.code||"KeyB"===t.code||"KeyI"===t.code||"KeyU"===t.code||"Digit6"===t.code&&!0===t.shiftKey||"Minus"===t.code&&!0===t.shiftKey)&&(!0===t.ctrlKey||!0===t.metaKey)){let e;return"KeyB"===t.code?e="bold":"KeyI"===t.code?e="italic":"KeyU"===t.code?e="underline":"Digit6"===t.code?e="superscript":"Minus"===t.code&&(e="subscript"),this.toggleStyleX(e,!0),t.stopPropagation(),t.preventDefault(),!1}if("Enter"===t.key){if(t.stopPropagation(),t.preventDefault(),this.applyViewChangesNow(),!this.paragraphs)return this.paragraphs=[xo(),xo()],this.applyViewChangesNow(!1),void this.$nextTick((()=>{mo(this.$refs.container,vo(Co(this.paragraphs,{paragraphIndex:1,offset:0}),this.$refs.container))}));this.$nextTick((()=>{const t=this.paragraphs,e=po();e.collapsed&&(Co(t,e.start),$o(t,e.start,[xo(),xo()]),this.$nextTick((()=>{mo(this.$refs.container,vo(Ao(t,e.start),this.$refs.container))})))}))}else if("Backspace"===t.key){const{start:e,end:n,collapsed:r}=this.applyViewChangesNow();if(!r)return void console.debug("warning: range backspace had to be handler elsewhere");if(e.offset>0||e.spanIndex>0)return;t.stopPropagation(),t.preventDefault(),this.$nextTick((()=>{const t=this.paragraphs;this.paragraphs;const e=po().start;Co(t,e);const n=Co(t,{paragraphIndex:e.paragraphIndex,spanIndex:0,offset:0});if(e.paragraphIndex>0){const t=this.paragraphs,r=function(t,e,n){console.assert(void 0!==t,"data not set"),console.assert(e.paragraphIndex>=0,"pointer paragraphIndex missing or invalid");const r=t;let o=e.paragraphIndex,i=e.spanIndex;if(void 0!==i&&-1!==i)if(i>0)i--;else{if(!(o>0))return;o--,i=yo(r[o]).length>0?yo(r[o]).length-1:void 0}else{if(!(o>0))return;o--,i=yo(r[o]).length>0?yo(r[o]).length-1:void 0}return void 0===n&&(n=-1),Co(t,{paragraphIndex:o,spanIndex:i,offset:n})}(t,n),o=To(t,r,e),i=o.length>0&&o[0].id===r.paragraphID?e:r;this.$nextTick((()=>{i.node=void 0,mo(this.$refs.container,i)}))}}))}else if("Delete"===t.key){const{start:e,end:n,collapsed:r}=this.applyViewChangesNow();if(!r)return console.debug("warning: range deletes must be handled elsewhere"),t.stopPropagation(),void t.preventDefault();if(!e||e.spanIndex<e.paragraph.spans.length-1||e.span&&e.offset<e.span.text.length)return;t.stopPropagation(),t.preventDefault(),this.$nextTick((()=>{const t=this.paragraphs,n=this.paragraphs;if(r){const r=n[e.paragraphIndex].spans,o=Co(t,{paragraphIndex:e.paragraphIndex,spanIndex:r.length-1,offset:-1});if(e.paragraphIndex<n.length-1){const t=this.paragraphs;0===e.paragraph.spans.length?(t.splice(e.paragraphIndex,1),e.spanIndex=0,e.paragraphID=0):(To(t,e,Ao(t,o)),void 0===e.spanIndex&&void 0===e.spanID&&(e.spanIndex=0)),this.$nextTick((()=>{e.node=void 0,Co(t,e),mo(this.$refs.container,e)}))}}}))}else if((t.ctrlKey||t.metaKey)&&t.shiftKey&&"KeyH"===t.code){const e=this.getSpanSelection();for(const t of e)for(const e of t.spans)e.highlighted=!1;t.preventDefault(),t.stopPropagation()}else if((t.ctrlKey||t.metaKey)&&"KeyH"===t.code){const e=this.getSpanSelection();for(const t of e)for(const e of t.spans)e.highlighted=!0;t.preventDefault(),t.stopPropagation()}else e.isCollapsed||(console.debug("PREVENT RANGE REPLACE"),t.preventDefault(),t.stopPropagation());return!0},onDragStart(t){t.stopPropagation(),t.preventDefault()},onPaste(t){t.stopPropagation(),t.preventDefault();const{start:e,end:n,collapsed:r}=this.applyViewChangesNow(!1),o=t.clipboardData.getData("application/ruta"),i=t.clipboardData.getData("text/html"),s=t.clipboardData.getData("text/plain");if(0===o.length&&0===i.length&&0===s.length)return;const a=this.paragraphs;if(Co(a,e),r||(Co(a,n),To(a,e,n),e.spanID=void 0,e.node=void 0,Co(a,e),e.node=void 0),o.length>0){console.debug("pasting from RUTA");const t=JSON.parse(o);for(const e of t){e.id=fo();for(const t of e.spans)t.id=fo()}const n=$o(a,e,t);this.$nextTick((()=>{n.end.node=null,mo(this.$refs.container,Co(a,n.end))}))}else if(i.length>0){const t=document.createElement("html");t.innerHTML=i;const n=t.querySelector("head > style");if(n){document.implementation.createHTMLDocument("").body.appendChild(n)}const r=function(t,e){let n=[];if(e)for(const u of e)if(-1===u.selectorText.search(/[#:\[\]>]/g)&&"underline"===u.style.textDecorationLine){const t=u.selectorText.split(",");for(const e of t){const t=e.split(":")[0].split(".");t.shift(),n=t}}const r=[],o=[];let i,s,a={},l=t,c=0;for(;l;){const t=l.childNodes;for(s=t.length;c<s;c++){const e=t[c];if(e.nodeType===Node.TEXT_NODE&&e.nodeValue.length>0){if(0===e.nodeValue.trim().length)continue;i||(i={spans:[],id:fo()},o.push(i)),i.spans.push({text:e.nodeValue,format:Object.assign({},a),id:fo()})}else if(e.nodeType===Node.ELEMENT_NODE){Object.assign({},a);const t=Object.assign({},a);if("B"===e.nodeName||"STRONG"===e.nodeName)a.bold=!0;else if("I"===e.nodeName||"EM"===e.nodeName)a.italic=!0;else if("U"===e.nodeName)a.underline=!0;else if("SUP"===e.nodeName)a.superscript=!0;else if("SUB"===e.nodeName)a.subscript=!0;else if("SPAN"===e.nodeName){for(const r of e.classList)if(-1!==n.indexOf(r)){a.underline=!0;break}}else"P"===e.nodeName?(i={spans:[],id:fo()},o.push(i)):"LI"===e.nodeName&&(i={spans:[],id:fo(),bullet:!0},o.push(i));if(l.childNodes&&l.childNodes.length>0){r.push({node:l,i:c+1,fmt:Object.assign({},t)}),c=0,l=e,s=l.childNodes.length;break}}}if(c>=s){if(!(r.length>0)){l=null;break}{"P"!==l.nodeName&&"LI"!==l.nodeName||(i=void 0);const t=r.pop();c=t.i,l=t.node,a=t.fmt}}}return o}(t.querySelector("body"),n&&n.sheet.cssRules);for(const e of r){e.id=fo();for(const t of e.spans)t.id=fo()}console.debug("pasting formatted text from html source");const o=$o(a,e,r);this.$nextTick((()=>{o.end.node=null,mo(this.$refs.container,Co(a,o.end))}))}else s.length>0&&(console.debug("pasting plaintext"),this.$nextTick((()=>{void 0===e.paragraphIndex&&void 0===e.paragraphID||mo(this.$refs.container,Co(a,e));const t=[],n=s.split("\n");for(const e of n)t.push({id:fo(),spans:[{id:fo(),text:e,format:{}}]});let r;if(0===t.length)a.splice.apply(a,[0,0].concat(t)),r={paragraphID:t[t.length-1].id,spanID:t[t.length-1].spans[0].id,offset:t[t.length-1].spans[0].text.length};else{const n=$o(a,e,t);r=n.end}this.$nextTick((()=>{r.node=null,mo(this.$refs.container,Co(a,r))}))})))},onCut(t){this.onCopy(t);const e=po();if(!e.collapsed){const t=this.paragraphs,n=e.start;Co(t,n);const r=e.end;Co(t,r),To(t,n,r)}},onCopy(t){const e=this.paragraphs,n=po();if(!n.isCollapsed){const r=n.start;Co(e,r);const o=n.end;Co(e,o);const i=To(e,r,o,Eo.Copy);t.clipboardData.setData("application/ruta",JSON.stringify(i));const s=[];for(const t of i){const e=[];for(const n of t.spans)e.push(n.text);s.push(e.join(""))}t.clipboardData.setData("text/plain",s.join("\n")),t.clipboardData.setData("text/html",this.asHTML(i))}t.stopPropagation(),t.preventDefault()}},errorCaptured:(t,e,n)=>(console.debug("EDITOR ERROR CAPTURED",t,e,n),!0)},Vo=["contenteditable"],jo=["data-id","contenteditable"],Lo=["data-first","data-last","contenteditable","data-id","data-time","data-duration","data-confidence","onClick","title"];Mo.render=function(t,e,n,o,i,s){return sr(),ur("div",{style:{border:"1px solid #ccc"},contenteditable:n.editable,spellcheck:"false",key:i.key,onInput:e[0]||(e[0]=(...t)=>s.onInput&&s.onInput(...t)),onKeydown:e[1]||(e[1]=(...t)=>s.onKeydown&&s.onKeydown(...t)),onPaste:e[2]||(e[2]=(...t)=>s.onPaste&&s.onPaste(...t)),onCut:e[3]||(e[3]=(...t)=>s.onCut&&s.onCut(...t)),onCopy:e[4]||(e[4]=(...t)=>s.onCopy&&s.onCopy(...t)),onSelectstart:e[5]||(e[5]=(...t)=>s.selectStart&&s.selectStart(...t)),onMouseup:e[6]||(e[6]=(...t)=>s.selectEnd&&s.selectEnd(...t)),onDragstart:e[7]||(e[7]=(...t)=>s.onDragStart&&s.onDragStart(...t)),ref:"container",class:"transcript"},[(sr(!0),ur(tr,null,Dr(i.paragraphs,((t,e)=>(sr(),ur("div",{"data-id":t.id,key:t.id,contenteditable:n.editable,class:a([{"list-item":t.bullet},"paragraph"])},[(sr(!0),ur(tr,null,Dr(t.spans,((e,o)=>(sr(),ur("span",{key:e.id,"data-first":0==o,"data-last":o>=t.spans.length-1,contenteditable:n.editable,"data-id":e.id,"data-time":e.time,"data-duration":e.duration,"data-confidence":e.confidence,class:a(["span token",{selected:e.time<=n.time&&n.time<e.time+e.duration,past:e.time+e.duration<=n.time,highlighted:e.highlighted,bold:e.format&&e.format.bold,italic:e.format&&e.format.italic,underline:e.format&&e.format.underline,superscript:e.format&&e.format.superscript,subscript:e.format&&e.format.subscript}]),onClick:t=>s.spanSelected(e,t),style:r(n.showConfidence?`opacity: ${Math.pow(e.confidence,.5)/2+.5};`:""),title:n.showConfidence?`Confidence: ${e.confidence}`:""},l(e.text),15,Lo)))),128))],10,jo)))),128))],40,Vo)},Mo.__scopeId="data-v-58f093bb";var Fo={value:()=>{}};function Uo(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new Ko(r)}function Ko(t){this._=t}function Bo(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function Wo(t,e){for(var n,r=0,o=t.length;r<o;++r)if((n=t[r]).name===e)return n.value}function Ho(t,e,n){for(var r=0,o=t.length;r<o;++r)if(t[r].name===e){t[r]=Fo,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}Ko.prototype=Uo.prototype={constructor:Ko,on:function(t,e){var n,r=this._,o=Bo(t+"",r),i=-1,s=o.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++i<s;)if(n=(t=o[i]).type)r[n]=Ho(r[n],t.name,e);else if(null==e)for(n in r)r[n]=Ho(r[n],t.name,null);return this}for(;++i<s;)if((n=(t=o[i]).type)&&(n=Wo(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Ko(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,o=new Array(n),i=0;i<n;++i)o[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=0,n=(r=this._[t]).length;i<n;++i)r[i].value.apply(e,o)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],o=0,i=r.length;o<i;++o)r[o].value.apply(e,n)}};var Xo="http://www.w3.org/1999/xhtml",qo={svg:"http://www.w3.org/2000/svg",xhtml:Xo,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function zo(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),qo.hasOwnProperty(e)?{space:qo[e],local:t}:t}function Yo(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Xo&&e.documentElement.namespaceURI===Xo?e.createElement(t):e.createElementNS(n,t)}}function Go(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Jo(t){var e=zo(t);return(e.local?Go:Yo)(e)}function Zo(){}function Qo(t){return null==t?Zo:function(){return this.querySelector(t)}}function ti(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}function ei(){return[]}function ni(t){return null==t?ei:function(){return this.querySelectorAll(t)}}function ri(t){return function(){return this.matches(t)}}function oi(t){return function(e){return e.matches(t)}}var ii=Array.prototype.find;function si(){return this.firstElementChild}var ai=Array.prototype.filter;function li(){return Array.from(this.children)}function ci(t){return new Array(t.length)}function ui(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function fi(t){return function(){return t}}function di(t,e,n,r,o,i){for(var s,a=0,l=e.length,c=i.length;a<c;++a)(s=e[a])?(s.__data__=i[a],r[a]=s):n[a]=new ui(t,i[a]);for(;a<l;++a)(s=e[a])&&(o[a]=s)}function pi(t,e,n,r,o,i,s){var a,l,c,u=new Map,f=e.length,d=i.length,p=new Array(f);for(a=0;a<f;++a)(l=e[a])&&(p[a]=c=s.call(l,l.__data__,a,e)+"",u.has(c)?o[a]=l:u.set(c,l));for(a=0;a<d;++a)c=s.call(t,i[a],a,i)+"",(l=u.get(c))?(r[a]=l,l.__data__=i[a],u.delete(c)):n[a]=new ui(t,i[a]);for(a=0;a<f;++a)(l=e[a])&&u.get(p[a])===l&&(o[a]=l)}function hi(t){return t.__data__}function gi(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function vi(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function mi(t){return function(){this.removeAttribute(t)}}function yi(t){return function(){this.removeAttributeNS(t.space,t.local)}}function bi(t,e){return function(){this.setAttribute(t,e)}}function _i(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function xi(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function wi(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Ii(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function ki(t){return function(){this.style.removeProperty(t)}}function Si(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Di(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function Ni(t,e){return t.style.getPropertyValue(e)||Ii(t).getComputedStyle(t,null).getPropertyValue(e)}function Ci(t){return function(){delete this[t]}}function Ai(t,e){return function(){this[t]=e}}function Ei(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function Oi(t){return t.trim().split(/^|\s+/)}function Ti(t){return t.classList||new $i(t)}function $i(t){this._node=t,this._names=Oi(t.getAttribute("class")||"")}function Pi(t,e){for(var n=Ti(t),r=-1,o=e.length;++r<o;)n.add(e[r])}function Ri(t,e){for(var n=Ti(t),r=-1,o=e.length;++r<o;)n.remove(e[r])}function Mi(t){return function(){Pi(this,t)}}function Vi(t){return function(){Ri(this,t)}}function ji(t,e){return function(){(e.apply(this,arguments)?Pi:Ri)(this,t)}}function Li(){this.textContent=""}function Fi(t){return function(){this.textContent=t}}function Ui(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function Ki(){this.innerHTML=""}function Bi(t){return function(){this.innerHTML=t}}function Wi(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function Hi(){this.nextSibling&&this.parentNode.appendChild(this)}function Xi(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function qi(){return null}function zi(){var t=this.parentNode;t&&t.removeChild(this)}function Yi(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Gi(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Ji(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function Zi(t){return function(){var e=this.__on;if(e){for(var n,r=0,o=-1,i=e.length;r<i;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++o]=n:this.removeEventListener(n.type,n.listener,n.options);++o?e.length=o:delete this.__on}}}function Qi(t,e,n){return function(){var r,o=this.__on,i=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(o)for(var s=0,a=o.length;s<a;++s)if((r=o[s]).type===t.type&&r.name===t.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=i,r.options=n),void(r.value=e);this.addEventListener(t.type,i,n),r={type:t.type,name:t.name,value:e,listener:i,options:n},o?o.push(r):this.__on=[r]}}function ts(t,e,n){var r=Ii(t),o=r.CustomEvent;"function"==typeof o?o=new o(e,n):(o=r.document.createEvent("Event"),n?(o.initEvent(e,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(e,!1,!1)),t.dispatchEvent(o)}function es(t,e){return function(){return ts(this,t,e)}}function ns(t,e){return function(){return ts(this,t,e.apply(this,arguments))}}ui.prototype={constructor:ui,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}},$i.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var rs=[null];function os(t,e){this._groups=t,this._parents=e}function is(){return new os([[document.documentElement]],rs)}function ss(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function as(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function ls(){}os.prototype=is.prototype={constructor:os,select:function(t){"function"!=typeof t&&(t=Qo(t));for(var e=this._groups,n=e.length,r=new Array(n),o=0;o<n;++o)for(var i,s,a=e[o],l=a.length,c=r[o]=new Array(l),u=0;u<l;++u)(i=a[u])&&(s=t.call(i,i.__data__,u,a))&&("__data__"in i&&(s.__data__=i.__data__),c[u]=s);return new os(r,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return ti(t.apply(this,arguments))}}(t):ni(t);for(var e=this._groups,n=e.length,r=[],o=[],i=0;i<n;++i)for(var s,a=e[i],l=a.length,c=0;c<l;++c)(s=a[c])&&(r.push(t.call(s,s.__data__,c,a)),o.push(s));return new os(r,o)},selectChild:function(t){return this.select(null==t?si:function(t){return function(){return ii.call(this.children,t)}}("function"==typeof t?t:oi(t)))},selectChildren:function(t){return this.selectAll(null==t?li:function(t){return function(){return ai.call(this.children,t)}}("function"==typeof t?t:oi(t)))},filter:function(t){"function"!=typeof t&&(t=ri(t));for(var e=this._groups,n=e.length,r=new Array(n),o=0;o<n;++o)for(var i,s=e[o],a=s.length,l=r[o]=[],c=0;c<a;++c)(i=s[c])&&t.call(i,i.__data__,c,s)&&l.push(i);return new os(r,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,hi);var n=e?pi:di,r=this._parents,o=this._groups;"function"!=typeof t&&(t=fi(t));for(var i=o.length,s=new Array(i),a=new Array(i),l=new Array(i),c=0;c<i;++c){var u=r[c],f=o[c],d=f.length,p=gi(t.call(u,u&&u.__data__,c,r)),h=p.length,g=a[c]=new Array(h),v=s[c]=new Array(h),m=l[c]=new Array(d);n(u,f,g,v,m,p,e);for(var y,b,_=0,x=0;_<h;++_)if(y=g[_]){for(_>=x&&(x=_+1);!(b=v[x])&&++x<h;);y._next=b||null}}return(s=new os(s,r))._enter=a,s._exit=l,s},enter:function(){return new os(this._enter||this._groups.map(ci),this._parents)},exit:function(){return new os(this._exit||this._groups.map(ci),this._parents)},join:function(t,e,n){var r=this.enter(),o=this,i=this.exit();return"function"==typeof t?(r=t(r))&&(r=r.selection()):r=r.append(t+""),null!=e&&(o=e(o))&&(o=o.selection()),null==n?i.remove():n(i),r&&o?r.merge(o).order():o},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,o=n.length,i=r.length,s=Math.min(o,i),a=new Array(o),l=0;l<s;++l)for(var c,u=n[l],f=r[l],d=u.length,p=a[l]=new Array(d),h=0;h<d;++h)(c=u[h]||f[h])&&(p[h]=c);for(;l<o;++l)a[l]=n[l];return new os(a,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,o=t[e],i=o.length-1,s=o[i];--i>=0;)(r=o[i])&&(s&&4^r.compareDocumentPosition(s)&&s.parentNode.insertBefore(r,s),s=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=vi);for(var n=this._groups,r=n.length,o=new Array(r),i=0;i<r;++i){for(var s,a=n[i],l=a.length,c=o[i]=new Array(l),u=0;u<l;++u)(s=a[u])&&(c[u]=s);c.sort(e)}return new os(o,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],o=0,i=r.length;o<i;++o){var s=r[o];if(s)return s}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var o,i=e[n],s=0,a=i.length;s<a;++s)(o=i[s])&&t.call(o,o.__data__,s,i);return this},attr:function(t,e){var n=zo(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?yi:mi:"function"==typeof e?n.local?wi:xi:n.local?_i:bi)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?ki:"function"==typeof e?Di:Si)(t,e,null==n?"":n)):Ni(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?Ci:"function"==typeof e?Ei:Ai)(t,e)):this.node()[t]},classed:function(t,e){var n=Oi(t+"");if(arguments.length<2){for(var r=Ti(this.node()),o=-1,i=n.length;++o<i;)if(!r.contains(n[o]))return!1;return!0}return this.each(("function"==typeof e?ji:e?Mi:Vi)(n,e))},text:function(t){return arguments.length?this.each(null==t?Li:("function"==typeof t?Ui:Fi)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?Ki:("function"==typeof t?Wi:Bi)(t)):this.node().innerHTML},raise:function(){return this.each(Hi)},lower:function(){return this.each(Xi)},append:function(t){var e="function"==typeof t?t:Jo(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:Jo(t),r=null==e?qi:"function"==typeof e?e:Qo(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(zi)},clone:function(t){return this.select(t?Gi:Yi)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,o,i=Ji(t+""),s=i.length;if(!(arguments.length<2)){for(a=e?Qi:Zi,r=0;r<s;++r)this.each(a(i[r],e,n));return this}var a=this.node().__on;if(a)for(var l,c=0,u=a.length;c<u;++c)for(r=0,l=a[c];r<s;++r)if((o=i[r]).type===l.type&&o.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?ns:es)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r,o=t[e],i=0,s=o.length;i<s;++i)(r=o[i])&&(yield r)}};var cs=1/.7,us="\\s*([+-]?\\d+)\\s*",fs="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",ds="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ps=/^#([0-9a-f]{3,8})$/,hs=new RegExp("^rgb\\("+[us,us,us]+"\\)$"),gs=new RegExp("^rgb\\("+[ds,ds,ds]+"\\)$"),vs=new RegExp("^rgba\\("+[us,us,us,fs]+"\\)$"),ms=new RegExp("^rgba\\("+[ds,ds,ds,fs]+"\\)$"),ys=new RegExp("^hsl\\("+[fs,ds,ds]+"\\)$"),bs=new RegExp("^hsla\\("+[fs,ds,ds,fs]+"\\)$"),_s={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function xs(){return this.rgb().formatHex()}function ws(){return this.rgb().formatRgb()}function Is(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=ps.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?ks(e):3===n?new Cs(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?Ss(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?Ss(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=hs.exec(t))?new Cs(e[1],e[2],e[3],1):(e=gs.exec(t))?new Cs(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=vs.exec(t))?Ss(e[1],e[2],e[3],e[4]):(e=ms.exec(t))?Ss(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=ys.exec(t))?Ts(e[1],e[2]/100,e[3]/100,1):(e=bs.exec(t))?Ts(e[1],e[2]/100,e[3]/100,e[4]):_s.hasOwnProperty(t)?ks(_s[t]):"transparent"===t?new Cs(NaN,NaN,NaN,0):null}function ks(t){return new Cs(t>>16&255,t>>8&255,255&t,1)}function Ss(t,e,n,r){return r<=0&&(t=e=n=NaN),new Cs(t,e,n,r)}function Ds(t){return t instanceof ls||(t=Is(t)),t?new Cs((t=t.rgb()).r,t.g,t.b,t.opacity):new Cs}function Ns(t,e,n,r){return 1===arguments.length?Ds(t):new Cs(t,e,n,null==r?1:r)}function Cs(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function As(){return"#"+Os(this.r)+Os(this.g)+Os(this.b)}function Es(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function Os(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function Ts(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Ps(t,e,n,r)}function $s(t){if(t instanceof Ps)return new Ps(t.h,t.s,t.l,t.opacity);if(t instanceof ls||(t=Is(t)),!t)return new Ps;if(t instanceof Ps)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,o=Math.min(e,n,r),i=Math.max(e,n,r),s=NaN,a=i-o,l=(i+o)/2;return a?(s=e===i?(n-r)/a+6*(n<r):n===i?(r-e)/a+2:(e-n)/a+4,a/=l<.5?i+o:2-i-o,s*=60):a=l>0&&l<1?0:s,new Ps(s,a,l,t.opacity)}function Ps(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Rs(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}ss(ls,Is,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:xs,formatHex:xs,formatHsl:function(){return $s(this).formatHsl()},formatRgb:ws,toString:ws}),ss(Cs,Ns,as(ls,{brighter:function(t){return t=null==t?cs:Math.pow(cs,t),new Cs(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Cs(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:As,formatHex:As,formatRgb:Es,toString:Es})),ss(Ps,(function(t,e,n,r){return 1===arguments.length?$s(t):new Ps(t,e,n,null==r?1:r)}),as(ls,{brighter:function(t){return t=null==t?cs:Math.pow(cs,t),new Ps(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Ps(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,o=2*n-r;return new Cs(Rs(t>=240?t-240:t+120,o,r),Rs(t,o,r),Rs(t<120?t+240:t-120,o,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var Ms=t=>()=>t;function Vs(t){return 1==(t=+t)?js:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):Ms(isNaN(e)?n:e)}}function js(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):Ms(isNaN(t)?e:t)}var Ls=function t(e){var n=Vs(e);function r(t,e){var r=n((t=Ns(t)).r,(e=Ns(e)).r),o=n(t.g,e.g),i=n(t.b,e.b),s=js(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=o(e),t.b=i(e),t.opacity=s(e),t+""}}return r.gamma=t,r}(1);function Fs(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var Us=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ks=new RegExp(Us.source,"g");function Bs(t,e){var n,r,o,i=Us.lastIndex=Ks.lastIndex=0,s=-1,a=[],l=[];for(t+="",e+="";(n=Us.exec(t))&&(r=Ks.exec(e));)(o=r.index)>i&&(o=e.slice(i,o),a[s]?a[s]+=o:a[++s]=o),(n=n[0])===(r=r[0])?a[s]?a[s]+=r:a[++s]=r:(a[++s]=null,l.push({i:s,x:Fs(n,r)})),i=Ks.lastIndex;return i<e.length&&(o=e.slice(i),a[s]?a[s]+=o:a[++s]=o),a.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var n,r=0;r<e;++r)a[(n=l[r]).i]=n.x(t);return a.join("")})}var Ws,Hs=180/Math.PI,Xs={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function qs(t,e,n,r,o,i){var s,a,l;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(l=t*n+e*r)&&(n-=t*l,r-=e*l),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,l/=a),t*r<e*n&&(t=-t,e=-e,l=-l,s=-s),{translateX:o,translateY:i,rotate:Math.atan2(e,t)*Hs,skewX:Math.atan(l)*Hs,scaleX:s,scaleY:a}}function zs(t,e,n,r){function o(t){return t.length?t.pop()+" ":""}return function(i,s){var a=[],l=[];return i=t(i),s=t(s),function(t,r,o,i,s,a){if(t!==o||r!==i){var l=s.push("translate(",null,e,null,n);a.push({i:l-4,x:Fs(t,o)},{i:l-2,x:Fs(r,i)})}else(o||i)&&s.push("translate("+o+e+i+n)}(i.translateX,i.translateY,s.translateX,s.translateY,a,l),function(t,e,n,i){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),i.push({i:n.push(o(n)+"rotate(",null,r)-2,x:Fs(t,e)})):e&&n.push(o(n)+"rotate("+e+r)}(i.rotate,s.rotate,a,l),function(t,e,n,i){t!==e?i.push({i:n.push(o(n)+"skewX(",null,r)-2,x:Fs(t,e)}):e&&n.push(o(n)+"skewX("+e+r)}(i.skewX,s.skewX,a,l),function(t,e,n,r,i,s){if(t!==n||e!==r){var a=i.push(o(i)+"scale(",null,",",null,")");s.push({i:a-4,x:Fs(t,n)},{i:a-2,x:Fs(e,r)})}else 1===n&&1===r||i.push(o(i)+"scale("+n+","+r+")")}(i.scaleX,i.scaleY,s.scaleX,s.scaleY,a,l),i=s=null,function(t){for(var e,n=-1,r=l.length;++n<r;)a[(e=l[n]).i]=e.x(t);return a.join("")}}}var Ys,Gs,Js=zs((function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Xs:qs(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),Zs=zs((function(t){return null==t?Xs:(Ws||(Ws=document.createElementNS("http://www.w3.org/2000/svg","g")),Ws.setAttribute("transform",t),(t=Ws.transform.baseVal.consolidate())?qs((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):Xs)}),", ",")",")"),Qs=0,ta=0,ea=0,na=0,ra=0,oa=0,ia="object"==typeof performance&&performance.now?performance:Date,sa="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function aa(){return ra||(sa(la),ra=ia.now()+oa)}function la(){ra=0}function ca(){this._call=this._time=this._next=null}function ua(t,e,n){var r=new ca;return r.restart(t,e,n),r}function fa(){ra=(na=ia.now())+oa,Qs=ta=0;try{!function(){aa(),++Qs;for(var t,e=Ys;e;)(t=ra-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Qs}()}finally{Qs=0,function(){var t,e,n=Ys,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Ys=e);Gs=t,pa(r)}(),ra=0}}function da(){var t=ia.now(),e=t-na;e>1e3&&(oa-=e,na=t)}function pa(t){Qs||(ta&&(ta=clearTimeout(ta)),t-ra>24?(t<1/0&&(ta=setTimeout(fa,t-ia.now()-oa)),ea&&(ea=clearInterval(ea))):(ea||(na=ia.now(),ea=setInterval(da,1e3)),Qs=1,sa(fa)))}function ha(t,e,n){var r=new ca;return e=null==e?0:+e,r.restart((n=>{r.stop(),t(n+e)}),e,n),r}ca.prototype=ua.prototype={constructor:ca,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?aa():+n)+(null==e?0:+e),this._next||Gs===this||(Gs?Gs._next=this:Ys=this,Gs=this),this._call=t,this._time=n,pa()},stop:function(){this._call&&(this._call=null,this._time=1/0,pa())}};var ga=Uo("start","end","cancel","interrupt"),va=[];function ma(t,e,n,r,o,i){var s=t.__transition;if(s){if(n in s)return}else t.__transition={};!function(t,e,n){var r,o=t.__transition;function i(t){n.state=1,n.timer.restart(s,n.delay,n.time),n.delay<=t&&s(t-n.delay)}function s(i){var c,u,f,d;if(1!==n.state)return l();for(c in o)if((d=o[c]).name===n.name){if(3===d.state)return ha(s);4===d.state?(d.state=6,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete o[c]):+c<e&&(d.state=6,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete o[c])}if(ha((function(){3===n.state&&(n.state=4,n.timer.restart(a,n.delay,n.time),a(i))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(f=n.tween.length),c=0,u=-1;c<f;++c)(d=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(r[++u]=d);r.length=u+1}}function a(e){for(var o=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(l),n.state=5,1),i=-1,s=r.length;++i<s;)r[i].call(t,o);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),l())}function l(){for(var r in n.state=6,n.timer.stop(),delete o[e],o)return;delete t.__transition}o[e]=n,n.timer=ua(i,0,n.time)}(t,n,{name:e,index:r,group:o,on:ga,tween:va,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:0})}function ya(t,e){var n=_a(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function ba(t,e){var n=_a(t,e);if(n.state>3)throw new Error("too late; already running");return n}function _a(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function xa(t,e){var n,r;return function(){var o=ba(this,t),i=o.tween;if(i!==n)for(var s=0,a=(r=n=i).length;s<a;++s)if(r[s].name===e){(r=r.slice()).splice(s,1);break}o.tween=r}}function wa(t,e,n){var r,o;if("function"!=typeof n)throw new Error;return function(){var i=ba(this,t),s=i.tween;if(s!==r){o=(r=s).slice();for(var a={name:e,value:n},l=0,c=o.length;l<c;++l)if(o[l].name===e){o[l]=a;break}l===c&&o.push(a)}i.tween=o}}function Ia(t,e,n){var r=t._id;return t.each((function(){var t=ba(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return _a(t,r).value[e]}}function ka(t,e){var n;return("number"==typeof e?Fs:e instanceof Is?Ls:(n=Is(e))?(e=n,Ls):Bs)(t,e)}function Sa(t){return function(){this.removeAttribute(t)}}function Da(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Na(t,e,n){var r,o,i=n+"";return function(){var s=this.getAttribute(t);return s===i?null:s===r?o:o=e(r=s,n)}}function Ca(t,e,n){var r,o,i=n+"";return function(){var s=this.getAttributeNS(t.space,t.local);return s===i?null:s===r?o:o=e(r=s,n)}}function Aa(t,e,n){var r,o,i;return function(){var s,a,l=n(this);if(null!=l)return(s=this.getAttribute(t))===(a=l+"")?null:s===r&&a===o?i:(o=a,i=e(r=s,l));this.removeAttribute(t)}}function Ea(t,e,n){var r,o,i;return function(){var s,a,l=n(this);if(null!=l)return(s=this.getAttributeNS(t.space,t.local))===(a=l+"")?null:s===r&&a===o?i:(o=a,i=e(r=s,l));this.removeAttributeNS(t.space,t.local)}}function Oa(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Ta(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function $a(t,e){var n,r;function o(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&Ta(t,o)),n}return o._value=e,o}function Pa(t,e){var n,r;function o(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&Oa(t,o)),n}return o._value=e,o}function Ra(t,e){return function(){ya(this,t).delay=+e.apply(this,arguments)}}function Ma(t,e){return e=+e,function(){ya(this,t).delay=e}}function Va(t,e){return function(){ba(this,t).duration=+e.apply(this,arguments)}}function ja(t,e){return e=+e,function(){ba(this,t).duration=e}}function La(t,e){if("function"!=typeof e)throw new Error;return function(){ba(this,t).ease=e}}function Fa(t,e,n){var r,o,i=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?ya:ba;return function(){var s=i(this,t),a=s.on;a!==r&&(o=(r=a).copy()).on(e,n),s.on=o}}var Ua=is.prototype.constructor;function Ka(t){return function(){this.style.removeProperty(t)}}function Ba(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function Wa(t,e,n){var r,o;function i(){var i=e.apply(this,arguments);return i!==o&&(r=(o=i)&&Ba(t,i,n)),r}return i._value=e,i}function Ha(t){return function(e){this.textContent=t.call(this,e)}}function Xa(t){var e,n;function r(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&Ha(r)),e}return r._value=t,r}var qa=0;function za(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function Ya(){return++qa}var Ga=is.prototype;za.prototype={constructor:za,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=Qo(t));for(var r=this._groups,o=r.length,i=new Array(o),s=0;s<o;++s)for(var a,l,c=r[s],u=c.length,f=i[s]=new Array(u),d=0;d<u;++d)(a=c[d])&&(l=t.call(a,a.__data__,d,c))&&("__data__"in a&&(l.__data__=a.__data__),f[d]=l,ma(f[d],e,n,d,f,_a(a,n)));return new za(i,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=ni(t));for(var r=this._groups,o=r.length,i=[],s=[],a=0;a<o;++a)for(var l,c=r[a],u=c.length,f=0;f<u;++f)if(l=c[f]){for(var d,p=t.call(l,l.__data__,f,c),h=_a(l,n),g=0,v=p.length;g<v;++g)(d=p[g])&&ma(d,e,n,g,p,h);i.push(p),s.push(l)}return new za(i,s,e,n)},selectChild:Ga.selectChild,selectChildren:Ga.selectChildren,filter:function(t){"function"!=typeof t&&(t=ri(t));for(var e=this._groups,n=e.length,r=new Array(n),o=0;o<n;++o)for(var i,s=e[o],a=s.length,l=r[o]=[],c=0;c<a;++c)(i=s[c])&&t.call(i,i.__data__,c,s)&&l.push(i);return new za(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,o=n.length,i=Math.min(r,o),s=new Array(r),a=0;a<i;++a)for(var l,c=e[a],u=n[a],f=c.length,d=s[a]=new Array(f),p=0;p<f;++p)(l=c[p]||u[p])&&(d[p]=l);for(;a<r;++a)s[a]=e[a];return new za(s,this._parents,this._name,this._id)},selection:function(){return new Ua(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=Ya(),r=this._groups,o=r.length,i=0;i<o;++i)for(var s,a=r[i],l=a.length,c=0;c<l;++c)if(s=a[c]){var u=_a(s,e);ma(s,t,n,c,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new za(r,this._parents,t,n)},call:Ga.call,nodes:Ga.nodes,node:Ga.node,size:Ga.size,empty:Ga.empty,each:Ga.each,on:function(t,e){var n=this._id;return arguments.length<2?_a(this.node(),n).on.on(t):this.each(Fa(n,t,e))},attr:function(t,e){var n=zo(t),r="transform"===n?Zs:ka;return this.attrTween(t,"function"==typeof e?(n.local?Ea:Aa)(n,r,Ia(this,"attr."+t,e)):null==e?(n.local?Da:Sa)(n):(n.local?Ca:Na)(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=zo(t);return this.tween(n,(r.local?$a:Pa)(r,e))},style:function(t,e,n){var r="transform"==(t+="")?Js:ka;return null==e?this.styleTween(t,function(t,e){var n,r,o;return function(){var i=Ni(this,t),s=(this.style.removeProperty(t),Ni(this,t));return i===s?null:i===n&&s===r?o:o=e(n=i,r=s)}}(t,r)).on("end.style."+t,Ka(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var r,o,i;return function(){var s=Ni(this,t),a=n(this),l=a+"";return null==a&&(this.style.removeProperty(t),l=a=Ni(this,t)),s===l?null:s===r&&l===o?i:(o=l,i=e(r=s,a))}}(t,r,Ia(this,"style."+t,e))).each(function(t,e){var n,r,o,i,s="style."+e,a="end."+s;return function(){var l=ba(this,t),c=l.on,u=null==l.value[s]?i||(i=Ka(e)):void 0;c===n&&o===u||(r=(n=c).copy()).on(a,o=u),l.on=r}}(this._id,t)):this.styleTween(t,function(t,e,n){var r,o,i=n+"";return function(){var s=Ni(this,t);return s===i?null:s===r?o:o=e(r=s,n)}}(t,r,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,Wa(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(Ia(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,Xa(t))},remove:function(){return this.on("end.remove",(t=this._id,function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}));var t},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,o=_a(this.node(),n).tween,i=0,s=o.length;i<s;++i)if((r=o[i]).name===t)return r.value;return null}return this.each((null==e?xa:wa)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Ra:Ma)(e,t)):_a(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Va:ja)(e,t)):_a(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(La(e,t)):_a(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw new Error;ba(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,r=n._id,o=n.size();return new Promise((function(i,s){var a={value:s},l={value:function(){0==--o&&i()}};n.each((function(){var n=ba(this,r),o=n.on;o!==t&&((e=(t=o).copy())._.cancel.push(a),e._.interrupt.push(a),e._.end.push(l)),n.on=e})),0===o&&i()}))},[Symbol.iterator]:Ga[Symbol.iterator]};var Ja={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function Za(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}is.prototype.interrupt=function(t){return this.each((function(){!function(t,e){var n,r,o,i=t.__transition,s=!0;if(i){for(o in e=null==e?null:e+"",i)(n=i[o]).name===e?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete i[o]):s=!1;s&&delete t.__transition}}(this,t)}))},is.prototype.transition=function(t){var e,n;t instanceof za?(e=t._id,t=t._name):(e=Ya(),(n=Ja).time=aa(),t=null==t?null:t+"");for(var r=this._groups,o=r.length,i=0;i<o;++i)for(var s,a=r[i],l=a.length,c=0;c<l;++c)(s=a[c])&&ma(s,t,e,c,a,n||Za(s,e));return new za(r,this._parents,t,e)};const Qa={props:{modelValue:[Int16Array,Int32Array,Array],time:Number,duration:Number,selection:Object},data:()=>({waveform:void 0,svg:void 0,data:void 0}),async mounted(){this.$options.watch.modelValue.call(this,this.modelValue),this.resizeCheckInterval=setInterval((()=>{null==this.currentWidth||null==this.currentHeight||!this.$refs.svg||this.currentWidth==this.$refs.svg.clientWidth&&this.currentHeight==this.$refs.svg.clientHeight||this.draw()}),2e3)},watch:{modelValue(t){if(t)if(t instanceof Int16Array){const e=new Float32Array(t);this.data=e.map((t=>t/32768))}else t instanceof Float32Array||t instanceof Array&&t.length>0&&"number"==typeof t[0]&&t[0]>=-1&&t[0]<=1?this.data=t:this.data=void 0;else this.data=void 0;this.draw()},time(t){}},methods:{click(t){const e=t.offsetX/this.$refs.svg.clientWidth*this.duration;this.$emit("update:time",e)},draw(t,e){const n=this.data;t=t||this.$refs.svg.clientWidth,e=e||this.$refs.svg.clientHeight,this.currentWidth=t,this.currentHeight=e;const r="string"==typeof(o=this.$refs.svg)?new os([[document.querySelector(o)]],[document.documentElement]):new os([[o]],rs);var o;if(!n)return void r.selectAll("*").remove();r.attr("height",e).attr("width",t);const i=function(t,e){var n=Math.round(t.length/e),r=[];const o=Math.min(n,1e3);for(var i=0;i<e;i++){for(var s=0,a=0,l=0;l<o&&!(i*n+l>=t.length);l++){var c=t[i*n+l];c>0?s+=c:a+=c}r.push([a/o,s/o])}return r}(n,1200);let s=0;for(const c of i)s+=-c[0]+c[1];s/=2*i.length;const a=.1*e/s,l=t/i.length;r.selectAll("rect").data(i).attr("x",(function(e,n){return n/i.length*t})).attr("y",(function(t,n){return.5*e-a*t[1]})).attr("width",l).attr("height",(function(t){return a*(t[1]-t[0])})).enter().append("rect").style("stroke","#342a40").style("stroke-width","0").style("fill","rgba(0,0,0,0.3)").attr("x",(function(e,n){return n/i.length*t})).attr("y",(function(t,n){return.5*e-a*t[1]})).attr("width",l).attr("height",(function(t){return a*(t[1]-t[0])})).exit().remove()}}},tl={ref:"svg",style:{"-border":"1px solid red",width:"100%",height:"100%"}};Qa.render=function(t,e,n,o,i,s){return sr(),ur("div",{onClick:e[0]||(e[0]=(...t)=>s.click&&s.click(...t))},[(sr(),ur("svg",tl,null,512)),n.selection?(sr(),ur("div",{key:0,style:r([{position:"absolute",top:"0px",height:"100%",left:"0px","background-color":"#fffb","pointer-events":"none","border-left":"1px solid blue","border-right":"1px solid blue"},{left:n.selection.start/n.duration*100+"%",width:(n.selection.end-n.selection.start)/n.duration*100+"%"}])},null,4)):xr("",!0),mr("div",{style:r([{position:"absolute",top:"0px",height:"100%",width:"0px",border:"1px solid red",left:"0px"},{left:n.time/n.duration*100+"%"}]),ref:"head"},null,4)])},Qa.__scopeId="data-v-af4cf048";class el{constructor(t){this.init(t)}init(t){this.close(),this.context=new AudioContext,this.context.onstatechange=t?()=>{t(this)}:()=>{t&&t||this.onstatechange(this)}}close(){this.context&&(this.context.close(),this.context=void 0)}resume(){this.context.resume()}get suspended(){return"suspended"===this.context.state}onstatechange(t){console.log("audio context state changed:",t.context.state)}async decodeAudioFileData(t){const e=await this.decodeAudioFileBuffer(t),n=this.bufferData(e);return{data:this.Float32ArrayToInt16Array(n),sampleRate:e.sampleRate,length:e.length,duration:e.duration,numberOfChannels:e.numberOfChannels}}async fetchAndDecodeAudioFile(t){const e=await this.fetchAudioFileAndDecode(t),n=this.bufferData(e);return{data:this.Float32ArrayToInt16Array(n),sampleRate:e.sampleRate,length:e.length,duration:e.duration,numberOfChannels:e.numberOfChannels}}async fetchAudioFileAndDecode(t){const e=await fetch(t);return await this.decodeAudioFileBuffer(await e.arrayBuffer())}async decodeAudioFileBuffer(t){const e=this.context;return await e.decodeAudioData(t)}Float32ArrayToInt16Array(t){return Int16Array.from(t.map((t=>32768*t)))}bufferData(t,{channel:e=0}={}){return t.getChannelData(e)}}var nl={components:{TranscriptEditor:Mo,Waveform:Qa},props:{transcript:{type:Object,default:{paragraphs:{}}},duration:{type:Number},url:{type:String},name:{},waveform:[Int16Array,Int32Array,Array,String],previewVideo:{type:Boolean,default:!0},onSave:{type:Function,default:async()=>console.log("onSave not implemented")},editable:{type:Boolean,default:!0}},data:()=>({position:0,selected:void 0,playing:!1,loaded:!1,isVideo:!1,_url:void 0,_duration:void 0,_waveform:void 0,pending_waveform:void 0,pending_duration:void 0,video_duration:void 0,saving:!1,version:0,lastSavedVersion:0,autoSave:!1,autoSaveInterval:null,decoderSuspended:!1,decodingAudio:!1,showConfidence:!1}),async mounted(){this.$options.watch.waveform.call(this,this.waveform),this.autoSaveInterval=window.setInterval(this.saveAuto,5e3),window.addEventListener("keydown",this.onGlobalKeydown),this.decoder=new el((t=>{this.decoderSuspended=this.decoder.suspended,this.decoder.suspended&&console.log("audio decoder suspended")})),this.decoderSuspended=this.decoder.suspended},beforeUnmount(){this.autoSaveInterval&&window.clearInterval(this.autoSaveInterval),window.removeEventListener("keydown",this.onGlobalKeydown)},watch:{position(t){},transcript:{handler(t,e){},deep:!0},duration(t){this._duration=t},url(t){this._url=t},async waveform(t){if("string"==typeof t){const{data:e,duration:n}=await this.decodeAudioWaveform(t);this._waveform=e}else if(t instanceof File){const{data:e,duration:n}=await this.decoder.decodeAudioFileData(await t.arrayBuffer());this._waveform=e}else this._waveform=t}},computed:{synced(){return this.lastSavedVersion===this.version}},methods:{msToTime:function(t,{ms:e=!1,hours:n=!0}={}){if(null==t||isNaN(t))return`${n?"--:":""}--:--${e?".---":""}`;function r(t,e){return("00"+t).slice(-(e=e||2))}var o=t%1e3,i=(t=(t-o)/1e3)%60,s=(t=(t-i)/60)%60,a=(t-s)/60;return(a||n?r(a)+":":"")+r(s)+":"+r(i)+(e?"."+r(o,3):"")},toggleAutoSave(){this.autoSave=!this.autoSave},async save(){if(this.onSave&&this.editable){const t=this.version;this.saving=!0,await this.onSave(this.transcript),console.log("saved",this.transcript),this.lastSavedVersion=t,this.saving=!1}},saveAuto(){this.autoSave&&this.save()},async decodeAudioWaveform(t){try{return this.decodingAudio=!0,this.decoder.suspended&&await this.decoder.resume(),t instanceof File?await this.decoder.decodeAudioFileData(await t.arrayBuffer()):await this.decoder.fetchAndDecodeAudioFile(t)}catch(e){throw e}finally{this.decodingAudio=!1}},async load({url:t,waveform:e,duration:n}){"string"==typeof e||e instanceof File?this.pending_waveform=(async()=>{const{data:t,duration:n}=await this.decodeAudioWaveform(e);return t})():null===e?this._waveform=[]:void 0!==e&&(this.pending_waveform=(async()=>e)()),n&&(this.pending_duration=n),void 0!==t?(this._url=t,t&&0!==t.length||(this.video_duration=void 0)):this.pending_waveform&&(this._waveform=await this.pending_waveform,this.pending_waveform=void 0)},waveformLoading(){this._waveform=void 0,this.loaded=!1},onPlay(){this.playing=!0,this.animationFrameID=requestAnimationFrame(this.updatePosition)},onPause(){this.playing=!1,this.animationFrameID&&(cancelAnimationFrame(this.animationFrameID),this.animationFrameID=void 0)},onEnded(){this.onPause()},updatePosition(t){this.position=1e3*this.$refs.video.currentTime,this.animationFrameID=requestAnimationFrame(this.updatePosition)},durationChanged(){const t=this.$refs.video;this._duration=1e3*t.duration,this.video_duration=1e3*t.duration},async onDataLoaded(){const t=this.$refs.video;t&&(this.isVideo=t.videoWidth>0&&t.videoHeight>0),this.pending_duration&&(this.pending_duration=void 0),this.pending_waveform&&(this._waveform=await this.pending_waveform,this.pending_waveform=void 0),this.loaded=!0},onEmpty(){this.loaded=!1,this.isVideo=!1},onGlobalKeydown(t){"s"!==t.key||!0!==t.ctrlKey&&!0!==t.metaKey||(t.preventDefault(),this.save()),("Space"===t.code&&!0===t.ctrlKey||"Escape"==t.code)&&(t.preventDefault(),this.$refs.video.paused?this.$refs.video.play():this.$refs.video.pause())},transcriptUpdated(t){this.version+=1},setPosition(t){void 0!==t&&(this.$refs.video.currentTime=t/1e3,this.$emit("setPosition",t))},timeUpdate(t){this.position=1e3*this.$refs.video.currentTime},toggleShowConfidence(){this.showConfidence=!this.showConfidence}}};const rl=t=>(Fe="data-v-b1db3c7a",t=t(),Fe=null,t),ol={class:"editor-wrapper"},il={key:0,class:"header"},sl={class:"btn-group me-2",role:"group"},al={key:0,class:"spinner-border spinner-border-sm",role:"status"},ll={key:1,class:"bi bi-check-lg",title:"Saglabts"},cl={key:2,class:"bi bi-asterisk",title:"Ir nesaglabtas izmaias"},ul=_r(" Saglabt "),fl=_r(" 5s "),dl={class:"btn-group me-2",role:"group"},pl=[rl((()=>mr("i",{class:"bi bi-type-bold"},null,-1)))],hl=[rl((()=>mr("i",{class:"bi bi-type-italic"},null,-1)))],gl=[rl((()=>mr("i",{class:"bi bi-type-underline"},null,-1)))],vl=[rl((()=>mr("i",{class:"bi"},[_r("x"),mr("sup",null,"2")],-1)))],ml=[rl((()=>mr("i",{class:"bi"},[_r("x"),mr("sub",null,"2")],-1)))],yl=[rl((()=>mr("i",{class:"bi bi-list-ul"},null,-1)))],bl={class:"footer"},_l=["src"],xl={class:"waveform-and-buttons"},wl={key:1,class:"waveform-loading"},Il=[rl((()=>mr("div",{class:"text-center",style:{position:"relative",top:"calc(50% - 1rem)"}},[mr("div",{class:"spinner-grow",role:"status"}),mr("div",{style:{position:"relative",display:"inline-block",top:"-0.5rem",left:"0.5rem"}}," Loading... ")],-1)))],kl={class:"controls"},Sl={key:0,class:"btn-group pe-2",role:"group"},Dl=[rl((()=>mr("i",{class:"bi bi-play-fill"},null,-1)))],Nl=[rl((()=>mr("i",{class:"bi bi-pause-fill"},null,-1)))],Cl={style:{"font-variant-numeric":"tabular-nums"}};async function Al(t){const e=await async function(t){const e=new AudioContext,n=await e.decodeAudioData(t);return e.close(),n}(t),n=function(t,{channel:e=0}={}){return t.getChannelData(e)}(e);return{data:(r=n,Int16Array.from(r.map((t=>32768*t)))),sampleRate:e.sampleRate,length:e.length,duration:e.duration,numberOfChannels:e.numberOfChannels};var r}nl.render=function(t,e,n,r,o,i){const s=Jn("TranscriptEditor"),c=Jn("Waveform");return sr(),ur("div",ol,[Nr(t.$slots,"default",{},void 0,!0),this.editable?(sr(),ur("div",il,[mr("div",sl,[mr("button",{class:"btn btn-outline-primary",onClick:e[0]||(e[0]=t=>i.save())},[o.saving?(sr(),ur("div",al)):i.synced?(sr(),ur("i",ll)):(sr(),ur("i",cl)),ul]),mr("button",{class:a("btn "+(o.autoSave?"btn-primary":"btn-outline-primary")),onClick:e[1]||(e[1]=(...t)=>i.toggleAutoSave&&i.toggleAutoSave(...t)),title:"Automtiski sagalabt katras 5s"},[mr("i",{class:a("bi bi-toggle-"+(o.autoSave?"on":"off"))},null,2),fl],2)]),mr("div",dl,[mr("button",{class:"btn btn-outline-primary",onClick:e[2]||(e[2]=e=>t.$refs.transcript.toggleStyleX("bold"))},pl),mr("button",{class:"btn btn-outline-primary",onClick:e[3]||(e[3]=e=>t.$refs.transcript.toggleStyleX("italic"))},hl),mr("button",{class:"btn btn-outline-primary",onClick:e[4]||(e[4]=e=>t.$refs.transcript.toggleStyleX("underline"))},gl),mr("button",{class:"btn btn-outline-primary",onClick:e[5]||(e[5]=e=>t.$refs.transcript.toggleStyleX("superscript"))},vl),mr("button",{class:"btn btn-outline-primary",onClick:e[6]||(e[6]=e=>t.$refs.transcript.toggleStyleX("subscript"))},ml),mr("button",{class:"btn btn-outline-primary",onClick:e[7]||(e[7]=e=>t.$refs.transcript.toggleBullet())},yl)])])):xr("",!0),yr(s,{class:"main transcript-editor",ref:"transcript",modelValue:n.transcript,"onUpdate:modelValue":[e[8]||(e[8]=t=>n.transcript=t),i.transcriptUpdated],time:o.position,"onUpdate:time":i.setPosition,onSelected:e[9]||(e[9]=t=>o.selected=t),editable:n.editable,"show-confidence":this.showConfidence},null,8,["modelValue","onUpdate:modelValue","time","onUpdate:time","editable","show-confidence"]),mr("div",bl,[mr("div",{class:a(["media-panel",{video:o.isVideo&&n.previewVideo}])},[mr("video",{playsinline:"",src:o._url,ref:"video",onTimeupdate:e[10]||(e[10]=(...t)=>i.timeUpdate&&i.timeUpdate(...t)),onLoadeddata:e[11]||(e[11]=(...t)=>i.onDataLoaded&&i.onDataLoaded(...t)),onLoadstart:e[12]||(e[12]=(...t)=>i.onDataLoaded&&i.onDataLoaded(...t)),onEmptied:e[13]||(e[13]=(...t)=>i.onEmpty&&i.onEmpty(...t)),onDurationchange:e[14]||(e[14]=(...t)=>i.durationChanged&&i.durationChanged(...t)),onPlay:e[15]||(e[15]=(...t)=>i.onPlay&&i.onPlay(...t)),onPause:e[16]||(e[16]=(...t)=>i.onPause&&i.onPause(...t)),onEnded:e[17]||(e[17]=(...t)=>i.onEnded&&i.onEnded(...t))},null,40,_l),mr("div",xl,[mr("div",null,[null!=o._waveform?(sr(),fr(c,{key:0,class:"waveform",modelValue:o._waveform,"onUpdate:modelValue":e[18]||(e[18]=t=>o._waveform=t),time:o.position,"onUpdate:time":[e[19]||(e[19]=t=>o.position=t),i.setPosition],duration:o._duration,selection:o.selected},null,8,["modelValue","time","onUpdate:time","duration","selection"])):(sr(),ur("div",wl,Il))]),mr("div",kl,[o.loaded?(sr(),ur("div",Sl,[o.playing?(sr(),ur("button",{key:1,class:"btn btn-primary",onClick:e[21]||(e[21]=e=>t.$refs.video.pause())},Nl)):(sr(),ur("button",{key:0,class:"btn btn-primary",onClick:e[20]||(e[20]=e=>t.$refs.video.play())},Dl))])):xr("",!0),mr("span",Cl,l(i.msToTime(o.position))+" / "+l(i.msToTime(o.video_duration)),1)])])],2)])])},nl.__scopeId="data-v-b1db3c7a";var El={components:{Editor:nl},props:{},data:()=>({transcript:{},waveform:[],duration:0,url:void 0}),async mounted(){},unmounted(){this.url&&this.url.length>0&&this.url.startsWith("blob:")&&URL.revokeObjectURL(this.url)},watch:{},methods:{async load({audio:t,transcript:e,file:n,waveform:r}){if(null!=r&&r instanceof ArrayBuffer){r=(await Al(r)).data}if("string"==typeof t){this.$refs.editor.waveformLoading(),this.url&&this.url.length>0&&this.url.startsWith("blob:")&&URL.revokeObjectURL(this.url);const e=t;void 0===r&&(r=t),this.$refs.editor.load({url:e,waveform:r})}else if(t instanceof File){this.$refs.editor.waveformLoading(),this.url&&this.url.length>0&&this.url.startsWith("blob:")&&URL.revokeObjectURL(this.url);const e=URL.createObjectURL(t);void 0===r&&(r=t),this.$refs.editor.load({url:e,waveform:r})}else if(t instanceof ArrayBuffer){this.$refs.editor.waveformLoading();const e=URL.createObjectURL(n||new Blob([t])),o=await Al(t);void 0===r&&(r=o.data),this.$refs.editor.load({url:e,waveform:r,duration:1e3*o.duration})}else null===t?(this.url&&this.url.length>0&&this.url.startsWith("blob:")&&URL.revokeObjectURL(this.url),void 0===r&&(r=null),this.$refs.editor.load({url:"",waveform:r,duration:0})):r&&this.$refs.editor.load({waveform:r});if(e)if("string"==typeof e){const t=await fetch(e);this.transcript=await t.json()}else e instanceof File?this.transcript=JSON.parse(await e.text()):this.transcript=e},async onSetPosition(t){console.debug("on set position:",t)},async onSave(t){console.log("on save transcript:",t)},async save(t){console.log("save transcript not implemented, transcript:",t)}}};El.render=function(t,e,n,r,o,i){const s=Jn("Editor");return sr(),fr(s,{class:"",transcript:o.transcript,waveform:o.waveform,duration:o.duration,url:o.url,onSave:i.onSave,onSetPosition:i.onSetPosition,ref:"editor"},null,8,["transcript","waveform","duration","url","onSave","onSetPosition"])};function Ol(t="#app"){return lo(El).mount(t)}export default Ol;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicnV0YS5lcy5qcyIsInNvdXJjZXMiOlsiLi4vLi4vbm9kZV9tb2R1bGVzL0B2dWUvc2hhcmVkL2Rpc3Qvc2hhcmVkLmVzbS1idW5kbGVyLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL0B2dWUvcmVhY3Rpdml0eS9kaXN0L3JlYWN0aXZpdHkuZXNtLWJ1bmRsZXIuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvQHZ1ZS9ydW50aW1lLWNvcmUvZGlzdC9ydW50aW1lLWNvcmUuZXNtLWJ1bmRsZXIuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvQHZ1ZS9ydW50aW1lLWRvbS9kaXN0L3J1bnRpbWUtZG9tLmVzbS1idW5kbGVyLmpzIiwiLi4vLi4vc3JjL2NvbXBvbmVudHMvZWRpdG9yLmpzIiwiLi4vLi4vc3JjL2NvbXBvbmVudHMvVHJhbnNjcmlwdEVkaXRvci52dWUiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtZGlzcGF0Y2gvc3JjL2Rpc3BhdGNoLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvbmFtZXNwYWNlcy5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9kMy1zZWxlY3Rpb24vc3JjL25hbWVzcGFjZS5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9kMy1zZWxlY3Rpb24vc3JjL2NyZWF0b3IuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtc2VsZWN0aW9uL3NyYy9zZWxlY3Rvci5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9kMy1zZWxlY3Rpb24vc3JjL2FycmF5LmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvc2VsZWN0b3JBbGwuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtc2VsZWN0aW9uL3NyYy9tYXRjaGVyLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvc2VsZWN0aW9uL3NlbGVjdENoaWxkLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvc2VsZWN0aW9uL3NlbGVjdENoaWxkcmVuLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvc2VsZWN0aW9uL3NwYXJzZS5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9kMy1zZWxlY3Rpb24vc3JjL3NlbGVjdGlvbi9lbnRlci5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9kMy1zZWxlY3Rpb24vc3JjL2NvbnN0YW50LmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvc2VsZWN0aW9uL2RhdGEuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtc2VsZWN0aW9uL3NyYy9zZWxlY3Rpb24vc29ydC5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9kMy1zZWxlY3Rpb24vc3JjL3NlbGVjdGlvbi9hdHRyLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvd2luZG93LmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvc2VsZWN0aW9uL3N0eWxlLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvc2VsZWN0aW9uL3Byb3BlcnR5LmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvc2VsZWN0aW9uL2NsYXNzZWQuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtc2VsZWN0aW9uL3NyYy9zZWxlY3Rpb24vdGV4dC5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9kMy1zZWxlY3Rpb24vc3JjL3NlbGVjdGlvbi9odG1sLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvc2VsZWN0aW9uL3JhaXNlLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvc2VsZWN0aW9uL2xvd2VyLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvc2VsZWN0aW9uL2luc2VydC5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9kMy1zZWxlY3Rpb24vc3JjL3NlbGVjdGlvbi9yZW1vdmUuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtc2VsZWN0aW9uL3NyYy9zZWxlY3Rpb24vY2xvbmUuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtc2VsZWN0aW9uL3NyYy9zZWxlY3Rpb24vb24uanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtc2VsZWN0aW9uL3NyYy9zZWxlY3Rpb24vZGlzcGF0Y2guanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtc2VsZWN0aW9uL3NyYy9zZWxlY3Rpb24vaW5kZXguanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtY29sb3Ivc3JjL2RlZmluZS5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9kMy1jb2xvci9zcmMvY29sb3IuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtc2VsZWN0aW9uL3NyYy9zZWxlY3Rpb24vc2VsZWN0LmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvc2VsZWN0aW9uL3NlbGVjdEFsbC5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9kMy1zZWxlY3Rpb24vc3JjL3NlbGVjdGlvbi9maWx0ZXIuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtc2VsZWN0aW9uL3NyYy9zZWxlY3Rpb24vZXhpdC5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9kMy1zZWxlY3Rpb24vc3JjL3NlbGVjdGlvbi9qb2luLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvc2VsZWN0aW9uL21lcmdlLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvc2VsZWN0aW9uL29yZGVyLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvc2VsZWN0aW9uL2NhbGwuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtc2VsZWN0aW9uL3NyYy9zZWxlY3Rpb24vbm9kZXMuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtc2VsZWN0aW9uL3NyYy9zZWxlY3Rpb24vbm9kZS5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9kMy1zZWxlY3Rpb24vc3JjL3NlbGVjdGlvbi9zaXplLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvc2VsZWN0aW9uL2VtcHR5LmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvc2VsZWN0aW9uL2VhY2guanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtc2VsZWN0aW9uL3NyYy9zZWxlY3Rpb24vYXBwZW5kLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvc2VsZWN0aW9uL2RhdHVtLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvc2VsZWN0aW9uL2l0ZXJhdG9yLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLWludGVycG9sYXRlL3NyYy9jb25zdGFudC5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9kMy1pbnRlcnBvbGF0ZS9zcmMvY29sb3IuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtaW50ZXJwb2xhdGUvc3JjL3JnYi5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9kMy1pbnRlcnBvbGF0ZS9zcmMvbnVtYmVyLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLWludGVycG9sYXRlL3NyYy9zdHJpbmcuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtaW50ZXJwb2xhdGUvc3JjL3RyYW5zZm9ybS9kZWNvbXBvc2UuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtaW50ZXJwb2xhdGUvc3JjL3RyYW5zZm9ybS9wYXJzZS5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9kMy1pbnRlcnBvbGF0ZS9zcmMvdHJhbnNmb3JtL2luZGV4LmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXRpbWVyL3NyYy90aW1lci5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9kMy10aW1lci9zcmMvdGltZW91dC5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9kMy10cmFuc2l0aW9uL3NyYy90cmFuc2l0aW9uL3NjaGVkdWxlLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXRyYW5zaXRpb24vc3JjL3RyYW5zaXRpb24vdHdlZW4uanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtdHJhbnNpdGlvbi9zcmMvdHJhbnNpdGlvbi9pbnRlcnBvbGF0ZS5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9kMy10cmFuc2l0aW9uL3NyYy90cmFuc2l0aW9uL2F0dHIuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtdHJhbnNpdGlvbi9zcmMvdHJhbnNpdGlvbi9hdHRyVHdlZW4uanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtdHJhbnNpdGlvbi9zcmMvdHJhbnNpdGlvbi9kZWxheS5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9kMy10cmFuc2l0aW9uL3NyYy90cmFuc2l0aW9uL2R1cmF0aW9uLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXRyYW5zaXRpb24vc3JjL3RyYW5zaXRpb24vZWFzZS5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9kMy10cmFuc2l0aW9uL3NyYy90cmFuc2l0aW9uL29uLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXRyYW5zaXRpb24vc3JjL3RyYW5zaXRpb24vc2VsZWN0aW9uLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXRyYW5zaXRpb24vc3JjL3RyYW5zaXRpb24vc3R5bGUuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtdHJhbnNpdGlvbi9zcmMvdHJhbnNpdGlvbi9zdHlsZVR3ZWVuLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXRyYW5zaXRpb24vc3JjL3RyYW5zaXRpb24vdGV4dFR3ZWVuLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXRyYW5zaXRpb24vc3JjL3RyYW5zaXRpb24vaW5kZXguanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtdHJhbnNpdGlvbi9zcmMvdHJhbnNpdGlvbi9zZWxlY3QuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtdHJhbnNpdGlvbi9zcmMvdHJhbnNpdGlvbi9zZWxlY3RBbGwuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtdHJhbnNpdGlvbi9zcmMvdHJhbnNpdGlvbi9maWx0ZXIuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtdHJhbnNpdGlvbi9zcmMvdHJhbnNpdGlvbi9tZXJnZS5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9kMy10cmFuc2l0aW9uL3NyYy90cmFuc2l0aW9uL3RyYW5zaXRpb24uanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtdHJhbnNpdGlvbi9zcmMvdHJhbnNpdGlvbi90ZXh0LmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXRyYW5zaXRpb24vc3JjL3RyYW5zaXRpb24vcmVtb3ZlLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXRyYW5zaXRpb24vc3JjL3RyYW5zaXRpb24vZWFzZVZhcnlpbmcuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtdHJhbnNpdGlvbi9zcmMvdHJhbnNpdGlvbi9lbmQuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtdHJhbnNpdGlvbi9zcmMvc2VsZWN0aW9uL3RyYW5zaXRpb24uanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtZWFzZS9zcmMvY3ViaWMuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtdHJhbnNpdGlvbi9zcmMvc2VsZWN0aW9uL2luZGV4LmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXRyYW5zaXRpb24vc3JjL3NlbGVjdGlvbi9pbnRlcnJ1cHQuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtdHJhbnNpdGlvbi9zcmMvaW50ZXJydXB0LmpzIiwiLi4vLi4vc3JjL2NvbXBvbmVudHMvV2F2ZWZvcm0udnVlIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvc2VsZWN0LmpzIiwiLi4vLi4vc3JjL2NvbXBvbmVudHMvYXVkaW8uanMiLCIuLi8uLi9zcmMvY29tcG9uZW50cy9FZGl0b3IudnVlIiwiLi4vLi4vc3JjL2NvbXBvbmVudHMvdXRpbHMuanMiLCIuLi8uLi9zcmMvYXVkaW8uanMiLCIuLi8uLi9zcmMvRWRpdG9yV2l0aE1lZGlhTG9hZGVyLnZ1ZSIsIi4uLy4uL3NyYy9saWIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIE1ha2UgYSBtYXAgYW5kIHJldHVybiBhIGZ1bmN0aW9uIGZvciBjaGVja2luZyBpZiBhIGtleVxyXG4gKiBpcyBpbiB0aGF0IG1hcC5cclxuICogSU1QT1JUQU5UOiBhbGwgY2FsbHMgb2YgdGhpcyBmdW5jdGlvbiBtdXN0IGJlIHByZWZpeGVkIHdpdGhcclxuICogXFwvXFwqI1xcX1xcX1BVUkVcXF9cXF9cXCpcXC9cclxuICogU28gdGhhdCByb2xsdXAgY2FuIHRyZWUtc2hha2UgdGhlbSBpZiBuZWNlc3NhcnkuXHJcbiAqL1xyXG5mdW5jdGlvbiBtYWtlTWFwKHN0ciwgZXhwZWN0c0xvd2VyQ2FzZSkge1xyXG4gICAgY29uc3QgbWFwID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcclxuICAgIGNvbnN0IGxpc3QgPSBzdHIuc3BsaXQoJywnKTtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIG1hcFtsaXN0W2ldXSA9IHRydWU7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZXhwZWN0c0xvd2VyQ2FzZSA/IHZhbCA9PiAhIW1hcFt2YWwudG9Mb3dlckNhc2UoKV0gOiB2YWwgPT4gISFtYXBbdmFsXTtcclxufVxuXG4vKipcclxuICogZGV2IG9ubHkgZmxhZyAtPiBuYW1lIG1hcHBpbmdcclxuICovXHJcbmNvbnN0IFBhdGNoRmxhZ05hbWVzID0ge1xyXG4gICAgWzEgLyogVEVYVCAqL106IGBURVhUYCxcclxuICAgIFsyIC8qIENMQVNTICovXTogYENMQVNTYCxcclxuICAgIFs0IC8qIFNUWUxFICovXTogYFNUWUxFYCxcclxuICAgIFs4IC8qIFBST1BTICovXTogYFBST1BTYCxcclxuICAgIFsxNiAvKiBGVUxMX1BST1BTICovXTogYEZVTExfUFJPUFNgLFxyXG4gICAgWzMyIC8qIEhZRFJBVEVfRVZFTlRTICovXTogYEhZRFJBVEVfRVZFTlRTYCxcclxuICAgIFs2NCAvKiBTVEFCTEVfRlJBR01FTlQgKi9dOiBgU1RBQkxFX0ZSQUdNRU5UYCxcclxuICAgIFsxMjggLyogS0VZRURfRlJBR01FTlQgKi9dOiBgS0VZRURfRlJBR01FTlRgLFxyXG4gICAgWzI1NiAvKiBVTktFWUVEX0ZSQUdNRU5UICovXTogYFVOS0VZRURfRlJBR01FTlRgLFxyXG4gICAgWzUxMiAvKiBORUVEX1BBVENIICovXTogYE5FRURfUEFUQ0hgLFxyXG4gICAgWzEwMjQgLyogRFlOQU1JQ19TTE9UUyAqL106IGBEWU5BTUlDX1NMT1RTYCxcclxuICAgIFsyMDQ4IC8qIERFVl9ST09UX0ZSQUdNRU5UICovXTogYERFVl9ST09UX0ZSQUdNRU5UYCxcclxuICAgIFstMSAvKiBIT0lTVEVEICovXTogYEhPSVNURURgLFxyXG4gICAgWy0yIC8qIEJBSUwgKi9dOiBgQkFJTGBcclxufTtcblxuLyoqXHJcbiAqIERldiBvbmx5XHJcbiAqL1xyXG5jb25zdCBzbG90RmxhZ3NUZXh0ID0ge1xyXG4gICAgWzEgLyogU1RBQkxFICovXTogJ1NUQUJMRScsXHJcbiAgICBbMiAvKiBEWU5BTUlDICovXTogJ0RZTkFNSUMnLFxyXG4gICAgWzMgLyogRk9SV0FSREVEICovXTogJ0ZPUldBUkRFRCdcclxufTtcblxuY29uc3QgR0xPQkFMU19XSElURV9MSVNURUQgPSAnSW5maW5pdHksdW5kZWZpbmVkLE5hTixpc0Zpbml0ZSxpc05hTixwYXJzZUZsb2F0LHBhcnNlSW50LGRlY29kZVVSSSwnICtcclxuICAgICdkZWNvZGVVUklDb21wb25lbnQsZW5jb2RlVVJJLGVuY29kZVVSSUNvbXBvbmVudCxNYXRoLE51bWJlcixEYXRlLEFycmF5LCcgK1xyXG4gICAgJ09iamVjdCxCb29sZWFuLFN0cmluZyxSZWdFeHAsTWFwLFNldCxKU09OLEludGwsQmlnSW50JztcclxuY29uc3QgaXNHbG9iYWxseVdoaXRlbGlzdGVkID0gLyojX19QVVJFX18qLyBtYWtlTWFwKEdMT0JBTFNfV0hJVEVfTElTVEVEKTtcblxuY29uc3QgcmFuZ2UgPSAyO1xyXG5mdW5jdGlvbiBnZW5lcmF0ZUNvZGVGcmFtZShzb3VyY2UsIHN0YXJ0ID0gMCwgZW5kID0gc291cmNlLmxlbmd0aCkge1xyXG4gICAgLy8gU3BsaXQgdGhlIGNvbnRlbnQgaW50byBpbmRpdmlkdWFsIGxpbmVzIGJ1dCBjYXB0dXJlIHRoZSBuZXdsaW5lIHNlcXVlbmNlXHJcbiAgICAvLyB0aGF0IHNlcGFyYXRlZCBlYWNoIGxpbmUuIFRoaXMgaXMgaW1wb3J0YW50IGJlY2F1c2UgdGhlIGFjdHVhbCBzZXF1ZW5jZSBpc1xyXG4gICAgLy8gbmVlZGVkIHRvIHByb3Blcmx5IHRha2UgaW50byBhY2NvdW50IHRoZSBmdWxsIGxpbmUgbGVuZ3RoIGZvciBvZmZzZXRcclxuICAgIC8vIGNvbXBhcmlzb25cclxuICAgIGxldCBsaW5lcyA9IHNvdXJjZS5zcGxpdCgvKFxccj9cXG4pLyk7XHJcbiAgICAvLyBTZXBhcmF0ZSB0aGUgbGluZXMgYW5kIG5ld2xpbmUgc2VxdWVuY2VzIGludG8gc2VwYXJhdGUgYXJyYXlzIGZvciBlYXNpZXIgcmVmZXJlbmNpbmdcclxuICAgIGNvbnN0IG5ld2xpbmVTZXF1ZW5jZXMgPSBsaW5lcy5maWx0ZXIoKF8sIGlkeCkgPT4gaWR4ICUgMiA9PT0gMSk7XHJcbiAgICBsaW5lcyA9IGxpbmVzLmZpbHRlcigoXywgaWR4KSA9PiBpZHggJSAyID09PSAwKTtcclxuICAgIGxldCBjb3VudCA9IDA7XHJcbiAgICBjb25zdCByZXMgPSBbXTtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBjb3VudCArPVxyXG4gICAgICAgICAgICBsaW5lc1tpXS5sZW5ndGggK1xyXG4gICAgICAgICAgICAgICAgKChuZXdsaW5lU2VxdWVuY2VzW2ldICYmIG5ld2xpbmVTZXF1ZW5jZXNbaV0ubGVuZ3RoKSB8fCAwKTtcclxuICAgICAgICBpZiAoY291bnQgPj0gc3RhcnQpIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgaiA9IGkgLSByYW5nZTsgaiA8PSBpICsgcmFuZ2UgfHwgZW5kID4gY291bnQ7IGorKykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGogPCAwIHx8IGogPj0gbGluZXMubGVuZ3RoKVxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbGluZSA9IGogKyAxO1xyXG4gICAgICAgICAgICAgICAgcmVzLnB1c2goYCR7bGluZX0keycgJy5yZXBlYXQoTWF0aC5tYXgoMyAtIFN0cmluZyhsaW5lKS5sZW5ndGgsIDApKX18ICAke2xpbmVzW2pdfWApO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbGluZUxlbmd0aCA9IGxpbmVzW2pdLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5ld0xpbmVTZXFMZW5ndGggPSAobmV3bGluZVNlcXVlbmNlc1tqXSAmJiBuZXdsaW5lU2VxdWVuY2VzW2pdLmxlbmd0aCkgfHwgMDtcclxuICAgICAgICAgICAgICAgIGlmIChqID09PSBpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gcHVzaCB1bmRlcmxpbmVcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBwYWQgPSBzdGFydCAtIChjb3VudCAtIChsaW5lTGVuZ3RoICsgbmV3TGluZVNlcUxlbmd0aCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGxlbmd0aCA9IE1hdGgubWF4KDEsIGVuZCA+IGNvdW50ID8gbGluZUxlbmd0aCAtIHBhZCA6IGVuZCAtIHN0YXJ0KTtcclxuICAgICAgICAgICAgICAgICAgICByZXMucHVzaChgICAgfCAgYCArICcgJy5yZXBlYXQocGFkKSArICdeJy5yZXBlYXQobGVuZ3RoKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChqID4gaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlbmQgPiBjb3VudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBsZW5ndGggPSBNYXRoLm1heChNYXRoLm1pbihlbmQgLSBjb3VudCwgbGluZUxlbmd0aCksIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXMucHVzaChgICAgfCAgYCArICdeJy5yZXBlYXQobGVuZ3RoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNvdW50ICs9IGxpbmVMZW5ndGggKyBuZXdMaW5lU2VxTGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiByZXMuam9pbignXFxuJyk7XHJcbn1cblxuLyoqXHJcbiAqIE9uIHRoZSBjbGllbnQgd2Ugb25seSBuZWVkIHRvIG9mZmVyIHNwZWNpYWwgY2FzZXMgZm9yIGJvb2xlYW4gYXR0cmlidXRlcyB0aGF0XHJcbiAqIGhhdmUgZGlmZmVyZW50IG5hbWVzIGZyb20gdGhlaXIgY29ycmVzcG9uZGluZyBkb20gcHJvcGVydGllczpcclxuICogLSBpdGVtc2NvcGUgLT4gTi9BXHJcbiAqIC0gYWxsb3dmdWxsc2NyZWVuIC0+IGFsbG93RnVsbHNjcmVlblxyXG4gKiAtIGZvcm1ub3ZhbGlkYXRlIC0+IGZvcm1Ob1ZhbGlkYXRlXHJcbiAqIC0gaXNtYXAgLT4gaXNNYXBcclxuICogLSBub21vZHVsZSAtPiBub01vZHVsZVxyXG4gKiAtIG5vdmFsaWRhdGUgLT4gbm9WYWxpZGF0ZVxyXG4gKiAtIHJlYWRvbmx5IC0+IHJlYWRPbmx5XHJcbiAqL1xyXG5jb25zdCBzcGVjaWFsQm9vbGVhbkF0dHJzID0gYGl0ZW1zY29wZSxhbGxvd2Z1bGxzY3JlZW4sZm9ybW5vdmFsaWRhdGUsaXNtYXAsbm9tb2R1bGUsbm92YWxpZGF0ZSxyZWFkb25seWA7XHJcbmNvbnN0IGlzU3BlY2lhbEJvb2xlYW5BdHRyID0gLyojX19QVVJFX18qLyBtYWtlTWFwKHNwZWNpYWxCb29sZWFuQXR0cnMpO1xyXG4vKipcclxuICogVGhlIGZ1bGwgbGlzdCBpcyBuZWVkZWQgZHVyaW5nIFNTUiB0byBwcm9kdWNlIHRoZSBjb3JyZWN0IGluaXRpYWwgbWFya3VwLlxyXG4gKi9cclxuY29uc3QgaXNCb29sZWFuQXR0ciA9IC8qI19fUFVSRV9fKi8gbWFrZU1hcChzcGVjaWFsQm9vbGVhbkF0dHJzICtcclxuICAgIGAsYXN5bmMsYXV0b2ZvY3VzLGF1dG9wbGF5LGNvbnRyb2xzLGRlZmF1bHQsZGVmZXIsZGlzYWJsZWQsaGlkZGVuLGAgK1xyXG4gICAgYGxvb3Asb3BlbixyZXF1aXJlZCxyZXZlcnNlZCxzY29wZWQsc2VhbWxlc3MsYCArXHJcbiAgICBgY2hlY2tlZCxtdXRlZCxtdWx0aXBsZSxzZWxlY3RlZGApO1xyXG4vKipcclxuICogQm9vbGVhbiBhdHRyaWJ1dGVzIHNob3VsZCBiZSBpbmNsdWRlZCBpZiB0aGUgdmFsdWUgaXMgdHJ1dGh5IG9yICcnLlxyXG4gKiBlLmcuIGA8c2VsZWN0IG11bHRpcGxlPmAgY29tcGlsZXMgdG8gYHsgbXVsdGlwbGU6ICcnIH1gXHJcbiAqL1xyXG5mdW5jdGlvbiBpbmNsdWRlQm9vbGVhbkF0dHIodmFsdWUpIHtcclxuICAgIHJldHVybiAhIXZhbHVlIHx8IHZhbHVlID09PSAnJztcclxufVxyXG5jb25zdCB1bnNhZmVBdHRyQ2hhclJFID0gL1s+Lz1cIidcXHUwMDA5XFx1MDAwYVxcdTAwMGNcXHUwMDIwXS87XHJcbmNvbnN0IGF0dHJWYWxpZGF0aW9uQ2FjaGUgPSB7fTtcclxuZnVuY3Rpb24gaXNTU1JTYWZlQXR0ck5hbWUobmFtZSkge1xyXG4gICAgaWYgKGF0dHJWYWxpZGF0aW9uQ2FjaGUuaGFzT3duUHJvcGVydHkobmFtZSkpIHtcclxuICAgICAgICByZXR1cm4gYXR0clZhbGlkYXRpb25DYWNoZVtuYW1lXTtcclxuICAgIH1cclxuICAgIGNvbnN0IGlzVW5zYWZlID0gdW5zYWZlQXR0ckNoYXJSRS50ZXN0KG5hbWUpO1xyXG4gICAgaWYgKGlzVW5zYWZlKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihgdW5zYWZlIGF0dHJpYnV0ZSBuYW1lOiAke25hbWV9YCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gKGF0dHJWYWxpZGF0aW9uQ2FjaGVbbmFtZV0gPSAhaXNVbnNhZmUpO1xyXG59XHJcbmNvbnN0IHByb3BzVG9BdHRyTWFwID0ge1xyXG4gICAgYWNjZXB0Q2hhcnNldDogJ2FjY2VwdC1jaGFyc2V0JyxcclxuICAgIGNsYXNzTmFtZTogJ2NsYXNzJyxcclxuICAgIGh0bWxGb3I6ICdmb3InLFxyXG4gICAgaHR0cEVxdWl2OiAnaHR0cC1lcXVpdidcclxufTtcclxuLyoqXHJcbiAqIENTUyBwcm9wZXJ0aWVzIHRoYXQgYWNjZXB0IHBsYWluIG51bWJlcnNcclxuICovXHJcbmNvbnN0IGlzTm9Vbml0TnVtZXJpY1N0eWxlUHJvcCA9IC8qI19fUFVSRV9fKi8gbWFrZU1hcChgYW5pbWF0aW9uLWl0ZXJhdGlvbi1jb3VudCxib3JkZXItaW1hZ2Utb3V0c2V0LGJvcmRlci1pbWFnZS1zbGljZSxgICtcclxuICAgIGBib3JkZXItaW1hZ2Utd2lkdGgsYm94LWZsZXgsYm94LWZsZXgtZ3JvdXAsYm94LW9yZGluYWwtZ3JvdXAsY29sdW1uLWNvdW50LGAgK1xyXG4gICAgYGNvbHVtbnMsZmxleCxmbGV4LWdyb3csZmxleC1wb3NpdGl2ZSxmbGV4LXNocmluayxmbGV4LW5lZ2F0aXZlLGZsZXgtb3JkZXIsYCArXHJcbiAgICBgZ3JpZC1yb3csZ3JpZC1yb3ctZW5kLGdyaWQtcm93LXNwYW4sZ3JpZC1yb3ctc3RhcnQsZ3JpZC1jb2x1bW4sYCArXHJcbiAgICBgZ3JpZC1jb2x1bW4tZW5kLGdyaWQtY29sdW1uLXNwYW4sZ3JpZC1jb2x1bW4tc3RhcnQsZm9udC13ZWlnaHQsbGluZS1jbGFtcCxgICtcclxuICAgIGBsaW5lLWhlaWdodCxvcGFjaXR5LG9yZGVyLG9ycGhhbnMsdGFiLXNpemUsd2lkb3dzLHotaW5kZXgsem9vbSxgICtcclxuICAgIC8vIFNWR1xyXG4gICAgYGZpbGwtb3BhY2l0eSxmbG9vZC1vcGFjaXR5LHN0b3Atb3BhY2l0eSxzdHJva2UtZGFzaGFycmF5LHN0cm9rZS1kYXNob2Zmc2V0LGAgK1xyXG4gICAgYHN0cm9rZS1taXRlcmxpbWl0LHN0cm9rZS1vcGFjaXR5LHN0cm9rZS13aWR0aGApO1xyXG4vKipcclxuICogS25vd24gYXR0cmlidXRlcywgdGhpcyBpcyB1c2VkIGZvciBzdHJpbmdpZmljYXRpb24gb2YgcnVudGltZSBzdGF0aWMgbm9kZXNcclxuICogc28gdGhhdCB3ZSBkb24ndCBzdHJpbmdpZnkgYmluZGluZ3MgdGhhdCBjYW5ub3QgYmUgc2V0IGZyb20gSFRNTC5cclxuICogRG9uJ3QgYWxzbyBmb3JnZXQgdG8gYWxsb3cgYGRhdGEtKmAgYW5kIGBhcmlhLSpgIVxyXG4gKiBHZW5lcmF0ZWQgZnJvbSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9IVE1ML0F0dHJpYnV0ZXNcclxuICovXHJcbmNvbnN0IGlzS25vd25IdG1sQXR0ciA9IC8qI19fUFVSRV9fKi8gbWFrZU1hcChgYWNjZXB0LGFjY2VwdC1jaGFyc2V0LGFjY2Vzc2tleSxhY3Rpb24sYWxpZ24sYWxsb3csYWx0LGFzeW5jLGAgK1xyXG4gICAgYGF1dG9jYXBpdGFsaXplLGF1dG9jb21wbGV0ZSxhdXRvZm9jdXMsYXV0b3BsYXksYmFja2dyb3VuZCxiZ2NvbG9yLGAgK1xyXG4gICAgYGJvcmRlcixidWZmZXJlZCxjYXB0dXJlLGNoYWxsZW5nZSxjaGFyc2V0LGNoZWNrZWQsY2l0ZSxjbGFzcyxjb2RlLGAgK1xyXG4gICAgYGNvZGViYXNlLGNvbG9yLGNvbHMsY29sc3Bhbixjb250ZW50LGNvbnRlbnRlZGl0YWJsZSxjb250ZXh0bWVudSxjb250cm9scyxgICtcclxuICAgIGBjb29yZHMsY3Jvc3NvcmlnaW4sY3NwLGRhdGEsZGF0ZXRpbWUsZGVjb2RpbmcsZGVmYXVsdCxkZWZlcixkaXIsZGlybmFtZSxgICtcclxuICAgIGBkaXNhYmxlZCxkb3dubG9hZCxkcmFnZ2FibGUsZHJvcHpvbmUsZW5jdHlwZSxlbnRlcmtleWhpbnQsZm9yLGZvcm0sYCArXHJcbiAgICBgZm9ybWFjdGlvbixmb3JtZW5jdHlwZSxmb3JtbWV0aG9kLGZvcm1ub3ZhbGlkYXRlLGZvcm10YXJnZXQsaGVhZGVycyxgICtcclxuICAgIGBoZWlnaHQsaGlkZGVuLGhpZ2gsaHJlZixocmVmbGFuZyxodHRwLWVxdWl2LGljb24saWQsaW1wb3J0YW5jZSxpbnRlZ3JpdHksYCArXHJcbiAgICBgaXNtYXAsaXRlbXByb3Asa2V5dHlwZSxraW5kLGxhYmVsLGxhbmcsbGFuZ3VhZ2UsbG9hZGluZyxsaXN0LGxvb3AsbG93LGAgK1xyXG4gICAgYG1hbmlmZXN0LG1heCxtYXhsZW5ndGgsbWlubGVuZ3RoLG1lZGlhLG1pbixtdWx0aXBsZSxtdXRlZCxuYW1lLG5vdmFsaWRhdGUsYCArXHJcbiAgICBgb3BlbixvcHRpbXVtLHBhdHRlcm4scGluZyxwbGFjZWhvbGRlcixwb3N0ZXIscHJlbG9hZCxyYWRpb2dyb3VwLHJlYWRvbmx5LGAgK1xyXG4gICAgYHJlZmVycmVycG9saWN5LHJlbCxyZXF1aXJlZCxyZXZlcnNlZCxyb3dzLHJvd3NwYW4sc2FuZGJveCxzY29wZSxzY29wZWQsYCArXHJcbiAgICBgc2VsZWN0ZWQsc2hhcGUsc2l6ZSxzaXplcyxzbG90LHNwYW4sc3BlbGxjaGVjayxzcmMsc3JjZG9jLHNyY2xhbmcsc3Jjc2V0LGAgK1xyXG4gICAgYHN0YXJ0LHN0ZXAsc3R5bGUsc3VtbWFyeSx0YWJpbmRleCx0YXJnZXQsdGl0bGUsdHJhbnNsYXRlLHR5cGUsdXNlbWFwLGAgK1xyXG4gICAgYHZhbHVlLHdpZHRoLHdyYXBgKTtcclxuLyoqXHJcbiAqIEdlbmVyYXRlZCBmcm9tIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL1NWRy9BdHRyaWJ1dGVcclxuICovXHJcbmNvbnN0IGlzS25vd25TdmdBdHRyID0gLyojX19QVVJFX18qLyBtYWtlTWFwKGB4bWxucyxhY2NlbnQtaGVpZ2h0LGFjY3VtdWxhdGUsYWRkaXRpdmUsYWxpZ25tZW50LWJhc2VsaW5lLGFscGhhYmV0aWMsYW1wbGl0dWRlLGAgK1xyXG4gICAgYGFyYWJpYy1mb3JtLGFzY2VudCxhdHRyaWJ1dGVOYW1lLGF0dHJpYnV0ZVR5cGUsYXppbXV0aCxiYXNlRnJlcXVlbmN5LGAgK1xyXG4gICAgYGJhc2VsaW5lLXNoaWZ0LGJhc2VQcm9maWxlLGJib3gsYmVnaW4sYmlhcyxieSxjYWxjTW9kZSxjYXAtaGVpZ2h0LGNsYXNzLGAgK1xyXG4gICAgYGNsaXAsY2xpcFBhdGhVbml0cyxjbGlwLXBhdGgsY2xpcC1ydWxlLGNvbG9yLGNvbG9yLWludGVycG9sYXRpb24sYCArXHJcbiAgICBgY29sb3ItaW50ZXJwb2xhdGlvbi1maWx0ZXJzLGNvbG9yLXByb2ZpbGUsY29sb3ItcmVuZGVyaW5nLGAgK1xyXG4gICAgYGNvbnRlbnRTY3JpcHRUeXBlLGNvbnRlbnRTdHlsZVR5cGUsY3Jvc3NvcmlnaW4sY3Vyc29yLGN4LGN5LGQsZGVjZWxlcmF0ZSxgICtcclxuICAgIGBkZXNjZW50LGRpZmZ1c2VDb25zdGFudCxkaXJlY3Rpb24sZGlzcGxheSxkaXZpc29yLGRvbWluYW50LWJhc2VsaW5lLGR1cixkeCxgICtcclxuICAgIGBkeSxlZGdlTW9kZSxlbGV2YXRpb24sZW5hYmxlLWJhY2tncm91bmQsZW5kLGV4cG9uZW50LGZpbGwsZmlsbC1vcGFjaXR5LGAgK1xyXG4gICAgYGZpbGwtcnVsZSxmaWx0ZXIsZmlsdGVyUmVzLGZpbHRlclVuaXRzLGZsb29kLWNvbG9yLGZsb29kLW9wYWNpdHksYCArXHJcbiAgICBgZm9udC1mYW1pbHksZm9udC1zaXplLGZvbnQtc2l6ZS1hZGp1c3QsZm9udC1zdHJldGNoLGZvbnQtc3R5bGUsYCArXHJcbiAgICBgZm9udC12YXJpYW50LGZvbnQtd2VpZ2h0LGZvcm1hdCxmcm9tLGZyLGZ4LGZ5LGcxLGcyLGdseXBoLW5hbWUsYCArXHJcbiAgICBgZ2x5cGgtb3JpZW50YXRpb24taG9yaXpvbnRhbCxnbHlwaC1vcmllbnRhdGlvbi12ZXJ0aWNhbCxnbHlwaFJlZixgICtcclxuICAgIGBncmFkaWVudFRyYW5zZm9ybSxncmFkaWVudFVuaXRzLGhhbmdpbmcsaGVpZ2h0LGhyZWYsaHJlZmxhbmcsaG9yaXotYWR2LXgsYCArXHJcbiAgICBgaG9yaXotb3JpZ2luLXgsaWQsaWRlb2dyYXBoaWMsaW1hZ2UtcmVuZGVyaW5nLGluLGluMixpbnRlcmNlcHQsayxrMSxrMixrMyxgICtcclxuICAgIGBrNCxrZXJuZWxNYXRyaXgsa2VybmVsVW5pdExlbmd0aCxrZXJuaW5nLGtleVBvaW50cyxrZXlTcGxpbmVzLGtleVRpbWVzLGAgK1xyXG4gICAgYGxhbmcsbGVuZ3RoQWRqdXN0LGxldHRlci1zcGFjaW5nLGxpZ2h0aW5nLWNvbG9yLGxpbWl0aW5nQ29uZUFuZ2xlLGxvY2FsLGAgK1xyXG4gICAgYG1hcmtlci1lbmQsbWFya2VyLW1pZCxtYXJrZXItc3RhcnQsbWFya2VySGVpZ2h0LG1hcmtlclVuaXRzLG1hcmtlcldpZHRoLGAgK1xyXG4gICAgYG1hc2ssbWFza0NvbnRlbnRVbml0cyxtYXNrVW5pdHMsbWF0aGVtYXRpY2FsLG1heCxtZWRpYSxtZXRob2QsbWluLG1vZGUsYCArXHJcbiAgICBgbmFtZSxudW1PY3RhdmVzLG9mZnNldCxvcGFjaXR5LG9wZXJhdG9yLG9yZGVyLG9yaWVudCxvcmllbnRhdGlvbixvcmlnaW4sYCArXHJcbiAgICBgb3ZlcmZsb3csb3ZlcmxpbmUtcG9zaXRpb24sb3ZlcmxpbmUtdGhpY2tuZXNzLHBhbm9zZS0xLHBhaW50LW9yZGVyLHBhdGgsYCArXHJcbiAgICBgcGF0aExlbmd0aCxwYXR0ZXJuQ29udGVudFVuaXRzLHBhdHRlcm5UcmFuc2Zvcm0scGF0dGVyblVuaXRzLHBpbmcsYCArXHJcbiAgICBgcG9pbnRlci1ldmVudHMscG9pbnRzLHBvaW50c0F0WCxwb2ludHNBdFkscG9pbnRzQXRaLHByZXNlcnZlQWxwaGEsYCArXHJcbiAgICBgcHJlc2VydmVBc3BlY3RSYXRpbyxwcmltaXRpdmVVbml0cyxyLHJhZGl1cyxyZWZlcnJlclBvbGljeSxyZWZYLHJlZlkscmVsLGAgK1xyXG4gICAgYHJlbmRlcmluZy1pbnRlbnQscmVwZWF0Q291bnQscmVwZWF0RHVyLHJlcXVpcmVkRXh0ZW5zaW9ucyxyZXF1aXJlZEZlYXR1cmVzLGAgK1xyXG4gICAgYHJlc3RhcnQscmVzdWx0LHJvdGF0ZSxyeCxyeSxzY2FsZSxzZWVkLHNoYXBlLXJlbmRlcmluZyxzbG9wZSxzcGFjaW5nLGAgK1xyXG4gICAgYHNwZWN1bGFyQ29uc3RhbnQsc3BlY3VsYXJFeHBvbmVudCxzcGVlZCxzcHJlYWRNZXRob2Qsc3RhcnRPZmZzZXQsYCArXHJcbiAgICBgc3RkRGV2aWF0aW9uLHN0ZW1oLHN0ZW12LHN0aXRjaFRpbGVzLHN0b3AtY29sb3Isc3RvcC1vcGFjaXR5LGAgK1xyXG4gICAgYHN0cmlrZXRocm91Z2gtcG9zaXRpb24sc3RyaWtldGhyb3VnaC10aGlja25lc3Msc3RyaW5nLHN0cm9rZSxgICtcclxuICAgIGBzdHJva2UtZGFzaGFycmF5LHN0cm9rZS1kYXNob2Zmc2V0LHN0cm9rZS1saW5lY2FwLHN0cm9rZS1saW5lam9pbixgICtcclxuICAgIGBzdHJva2UtbWl0ZXJsaW1pdCxzdHJva2Utb3BhY2l0eSxzdHJva2Utd2lkdGgsc3R5bGUsc3VyZmFjZVNjYWxlLGAgK1xyXG4gICAgYHN5c3RlbUxhbmd1YWdlLHRhYmluZGV4LHRhYmxlVmFsdWVzLHRhcmdldCx0YXJnZXRYLHRhcmdldFksdGV4dC1hbmNob3IsYCArXHJcbiAgICBgdGV4dC1kZWNvcmF0aW9uLHRleHQtcmVuZGVyaW5nLHRleHRMZW5ndGgsdG8sdHJhbnNmb3JtLHRyYW5zZm9ybS1vcmlnaW4sYCArXHJcbiAgICBgdHlwZSx1MSx1Mix1bmRlcmxpbmUtcG9zaXRpb24sdW5kZXJsaW5lLXRoaWNrbmVzcyx1bmljb2RlLHVuaWNvZGUtYmlkaSxgICtcclxuICAgIGB1bmljb2RlLXJhbmdlLHVuaXRzLXBlci1lbSx2LWFscGhhYmV0aWMsdi1oYW5naW5nLHYtaWRlb2dyYXBoaWMsYCArXHJcbiAgICBgdi1tYXRoZW1hdGljYWwsdmFsdWVzLHZlY3Rvci1lZmZlY3QsdmVyc2lvbix2ZXJ0LWFkdi15LHZlcnQtb3JpZ2luLXgsYCArXHJcbiAgICBgdmVydC1vcmlnaW4teSx2aWV3Qm94LHZpZXdUYXJnZXQsdmlzaWJpbGl0eSx3aWR0aCx3aWR0aHMsd29yZC1zcGFjaW5nLGAgK1xyXG4gICAgYHdyaXRpbmctbW9kZSx4LHgtaGVpZ2h0LHgxLHgyLHhDaGFubmVsU2VsZWN0b3IseGxpbms6YWN0dWF0ZSx4bGluazphcmNyb2xlLGAgK1xyXG4gICAgYHhsaW5rOmhyZWYseGxpbms6cm9sZSx4bGluazpzaG93LHhsaW5rOnRpdGxlLHhsaW5rOnR5cGUseG1sOmJhc2UseG1sOmxhbmcsYCArXHJcbiAgICBgeG1sOnNwYWNlLHkseTEseTIseUNoYW5uZWxTZWxlY3Rvcix6LHpvb21BbmRQYW5gKTtcblxuZnVuY3Rpb24gbm9ybWFsaXplU3R5bGUodmFsdWUpIHtcclxuICAgIGlmIChpc0FycmF5KHZhbHVlKSkge1xyXG4gICAgICAgIGNvbnN0IHJlcyA9IHt9O1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdmFsdWUubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgY29uc3QgaXRlbSA9IHZhbHVlW2ldO1xyXG4gICAgICAgICAgICBjb25zdCBub3JtYWxpemVkID0gaXNTdHJpbmcoaXRlbSlcclxuICAgICAgICAgICAgICAgID8gcGFyc2VTdHJpbmdTdHlsZShpdGVtKVxyXG4gICAgICAgICAgICAgICAgOiBub3JtYWxpemVTdHlsZShpdGVtKTtcclxuICAgICAgICAgICAgaWYgKG5vcm1hbGl6ZWQpIHtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IGluIG5vcm1hbGl6ZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXNba2V5XSA9IG5vcm1hbGl6ZWRba2V5XTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoaXNTdHJpbmcodmFsdWUpKSB7XHJcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoaXNPYmplY3QodmFsdWUpKSB7XHJcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgfVxyXG59XHJcbmNvbnN0IGxpc3REZWxpbWl0ZXJSRSA9IC87KD8hW14oXSpcXCkpL2c7XHJcbmNvbnN0IHByb3BlcnR5RGVsaW1pdGVyUkUgPSAvOiguKykvO1xyXG5mdW5jdGlvbiBwYXJzZVN0cmluZ1N0eWxlKGNzc1RleHQpIHtcclxuICAgIGNvbnN0IHJldCA9IHt9O1xyXG4gICAgY3NzVGV4dC5zcGxpdChsaXN0RGVsaW1pdGVyUkUpLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgaWYgKGl0ZW0pIHtcclxuICAgICAgICAgICAgY29uc3QgdG1wID0gaXRlbS5zcGxpdChwcm9wZXJ0eURlbGltaXRlclJFKTtcclxuICAgICAgICAgICAgdG1wLmxlbmd0aCA+IDEgJiYgKHJldFt0bXBbMF0udHJpbSgpXSA9IHRtcFsxXS50cmltKCkpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHJldDtcclxufVxyXG5mdW5jdGlvbiBzdHJpbmdpZnlTdHlsZShzdHlsZXMpIHtcclxuICAgIGxldCByZXQgPSAnJztcclxuICAgIGlmICghc3R5bGVzIHx8IGlzU3RyaW5nKHN0eWxlcykpIHtcclxuICAgICAgICByZXR1cm4gcmV0O1xyXG4gICAgfVxyXG4gICAgZm9yIChjb25zdCBrZXkgaW4gc3R5bGVzKSB7XHJcbiAgICAgICAgY29uc3QgdmFsdWUgPSBzdHlsZXNba2V5XTtcclxuICAgICAgICBjb25zdCBub3JtYWxpemVkS2V5ID0ga2V5LnN0YXJ0c1dpdGgoYC0tYCkgPyBrZXkgOiBoeXBoZW5hdGUoa2V5KTtcclxuICAgICAgICBpZiAoaXNTdHJpbmcodmFsdWUpIHx8XHJcbiAgICAgICAgICAgICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInICYmIGlzTm9Vbml0TnVtZXJpY1N0eWxlUHJvcChub3JtYWxpemVkS2V5KSkpIHtcclxuICAgICAgICAgICAgLy8gb25seSByZW5kZXIgdmFsaWQgdmFsdWVzXHJcbiAgICAgICAgICAgIHJldCArPSBgJHtub3JtYWxpemVkS2V5fToke3ZhbHVlfTtgO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiByZXQ7XHJcbn1cclxuZnVuY3Rpb24gbm9ybWFsaXplQ2xhc3ModmFsdWUpIHtcclxuICAgIGxldCByZXMgPSAnJztcclxuICAgIGlmIChpc1N0cmluZyh2YWx1ZSkpIHtcclxuICAgICAgICByZXMgPSB2YWx1ZTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGlzQXJyYXkodmFsdWUpKSB7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB2YWx1ZS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBjb25zdCBub3JtYWxpemVkID0gbm9ybWFsaXplQ2xhc3ModmFsdWVbaV0pO1xyXG4gICAgICAgICAgICBpZiAobm9ybWFsaXplZCkge1xyXG4gICAgICAgICAgICAgICAgcmVzICs9IG5vcm1hbGl6ZWQgKyAnICc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChpc09iamVjdCh2YWx1ZSkpIHtcclxuICAgICAgICBmb3IgKGNvbnN0IG5hbWUgaW4gdmFsdWUpIHtcclxuICAgICAgICAgICAgaWYgKHZhbHVlW25hbWVdKSB7XHJcbiAgICAgICAgICAgICAgICByZXMgKz0gbmFtZSArICcgJztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiByZXMudHJpbSgpO1xyXG59XHJcbmZ1bmN0aW9uIG5vcm1hbGl6ZVByb3BzKHByb3BzKSB7XHJcbiAgICBpZiAoIXByb3BzKVxyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgbGV0IHsgY2xhc3M6IGtsYXNzLCBzdHlsZSB9ID0gcHJvcHM7XHJcbiAgICBpZiAoa2xhc3MgJiYgIWlzU3RyaW5nKGtsYXNzKSkge1xyXG4gICAgICAgIHByb3BzLmNsYXNzID0gbm9ybWFsaXplQ2xhc3Moa2xhc3MpO1xyXG4gICAgfVxyXG4gICAgaWYgKHN0eWxlKSB7XHJcbiAgICAgICAgcHJvcHMuc3R5bGUgPSBub3JtYWxpemVTdHlsZShzdHlsZSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcHJvcHM7XHJcbn1cblxuLy8gVGhlc2UgdGFnIGNvbmZpZ3MgYXJlIHNoYXJlZCBiZXR3ZWVuIGNvbXBpbGVyLWRvbSBhbmQgcnVudGltZS1kb20sIHNvIHRoZXlcclxuLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSFRNTC9FbGVtZW50XHJcbmNvbnN0IEhUTUxfVEFHUyA9ICdodG1sLGJvZHksYmFzZSxoZWFkLGxpbmssbWV0YSxzdHlsZSx0aXRsZSxhZGRyZXNzLGFydGljbGUsYXNpZGUsZm9vdGVyLCcgK1xyXG4gICAgJ2hlYWRlcixoMSxoMixoMyxoNCxoNSxoNixuYXYsc2VjdGlvbixkaXYsZGQsZGwsZHQsZmlnY2FwdGlvbiwnICtcclxuICAgICdmaWd1cmUscGljdHVyZSxocixpbWcsbGksbWFpbixvbCxwLHByZSx1bCxhLGIsYWJicixiZGksYmRvLGJyLGNpdGUsY29kZSwnICtcclxuICAgICdkYXRhLGRmbixlbSxpLGtiZCxtYXJrLHEscnAscnQscnVieSxzLHNhbXAsc21hbGwsc3BhbixzdHJvbmcsc3ViLHN1cCwnICtcclxuICAgICd0aW1lLHUsdmFyLHdicixhcmVhLGF1ZGlvLG1hcCx0cmFjayx2aWRlbyxlbWJlZCxvYmplY3QscGFyYW0sc291cmNlLCcgK1xyXG4gICAgJ2NhbnZhcyxzY3JpcHQsbm9zY3JpcHQsZGVsLGlucyxjYXB0aW9uLGNvbCxjb2xncm91cCx0YWJsZSx0aGVhZCx0Ym9keSx0ZCwnICtcclxuICAgICd0aCx0cixidXR0b24sZGF0YWxpc3QsZmllbGRzZXQsZm9ybSxpbnB1dCxsYWJlbCxsZWdlbmQsbWV0ZXIsb3B0Z3JvdXAsJyArXHJcbiAgICAnb3B0aW9uLG91dHB1dCxwcm9ncmVzcyxzZWxlY3QsdGV4dGFyZWEsZGV0YWlscyxkaWFsb2csbWVudSwnICtcclxuICAgICdzdW1tYXJ5LHRlbXBsYXRlLGJsb2NrcXVvdGUsaWZyYW1lLHRmb290JztcclxuLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvU1ZHL0VsZW1lbnRcclxuY29uc3QgU1ZHX1RBR1MgPSAnc3ZnLGFuaW1hdGUsYW5pbWF0ZU1vdGlvbixhbmltYXRlVHJhbnNmb3JtLGNpcmNsZSxjbGlwUGF0aCxjb2xvci1wcm9maWxlLCcgK1xyXG4gICAgJ2RlZnMsZGVzYyxkaXNjYXJkLGVsbGlwc2UsZmVCbGVuZCxmZUNvbG9yTWF0cml4LGZlQ29tcG9uZW50VHJhbnNmZXIsJyArXHJcbiAgICAnZmVDb21wb3NpdGUsZmVDb252b2x2ZU1hdHJpeCxmZURpZmZ1c2VMaWdodGluZyxmZURpc3BsYWNlbWVudE1hcCwnICtcclxuICAgICdmZURpc3RhbmNlTGlnaHQsZmVEcm9wU2hhZG93LGZlRmxvb2QsZmVGdW5jQSxmZUZ1bmNCLGZlRnVuY0csZmVGdW5jUiwnICtcclxuICAgICdmZUdhdXNzaWFuQmx1cixmZUltYWdlLGZlTWVyZ2UsZmVNZXJnZU5vZGUsZmVNb3JwaG9sb2d5LGZlT2Zmc2V0LCcgK1xyXG4gICAgJ2ZlUG9pbnRMaWdodCxmZVNwZWN1bGFyTGlnaHRpbmcsZmVTcG90TGlnaHQsZmVUaWxlLGZlVHVyYnVsZW5jZSxmaWx0ZXIsJyArXHJcbiAgICAnZm9yZWlnbk9iamVjdCxnLGhhdGNoLGhhdGNocGF0aCxpbWFnZSxsaW5lLGxpbmVhckdyYWRpZW50LG1hcmtlcixtYXNrLCcgK1xyXG4gICAgJ21lc2gsbWVzaGdyYWRpZW50LG1lc2hwYXRjaCxtZXNocm93LG1ldGFkYXRhLG1wYXRoLHBhdGgscGF0dGVybiwnICtcclxuICAgICdwb2x5Z29uLHBvbHlsaW5lLHJhZGlhbEdyYWRpZW50LHJlY3Qsc2V0LHNvbGlkY29sb3Isc3RvcCxzd2l0Y2gsc3ltYm9sLCcgK1xyXG4gICAgJ3RleHQsdGV4dFBhdGgsdGl0bGUsdHNwYW4sdW5rbm93bix1c2Usdmlldyc7XHJcbmNvbnN0IFZPSURfVEFHUyA9ICdhcmVhLGJhc2UsYnIsY29sLGVtYmVkLGhyLGltZyxpbnB1dCxsaW5rLG1ldGEscGFyYW0sc291cmNlLHRyYWNrLHdicic7XHJcbi8qKlxyXG4gKiBDb21waWxlciBvbmx5LlxyXG4gKiBEbyBOT1QgdXNlIGluIHJ1bnRpbWUgY29kZSBwYXRocyB1bmxlc3MgYmVoaW5kIGAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJylgIGZsYWcuXHJcbiAqL1xyXG5jb25zdCBpc0hUTUxUYWcgPSAvKiNfX1BVUkVfXyovIG1ha2VNYXAoSFRNTF9UQUdTKTtcclxuLyoqXHJcbiAqIENvbXBpbGVyIG9ubHkuXHJcbiAqIERvIE5PVCB1c2UgaW4gcnVudGltZSBjb2RlIHBhdGhzIHVubGVzcyBiZWhpbmQgYChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKWAgZmxhZy5cclxuICovXHJcbmNvbnN0IGlzU1ZHVGFnID0gLyojX19QVVJFX18qLyBtYWtlTWFwKFNWR19UQUdTKTtcclxuLyoqXHJcbiAqIENvbXBpbGVyIG9ubHkuXHJcbiAqIERvIE5PVCB1c2UgaW4gcnVudGltZSBjb2RlIHBhdGhzIHVubGVzcyBiZWhpbmQgYChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKWAgZmxhZy5cclxuICovXHJcbmNvbnN0IGlzVm9pZFRhZyA9IC8qI19fUFVSRV9fKi8gbWFrZU1hcChWT0lEX1RBR1MpO1xuXG5jb25zdCBlc2NhcGVSRSA9IC9bXCInJjw+XS87XHJcbmZ1bmN0aW9uIGVzY2FwZUh0bWwoc3RyaW5nKSB7XHJcbiAgICBjb25zdCBzdHIgPSAnJyArIHN0cmluZztcclxuICAgIGNvbnN0IG1hdGNoID0gZXNjYXBlUkUuZXhlYyhzdHIpO1xyXG4gICAgaWYgKCFtYXRjaCkge1xyXG4gICAgICAgIHJldHVybiBzdHI7XHJcbiAgICB9XHJcbiAgICBsZXQgaHRtbCA9ICcnO1xyXG4gICAgbGV0IGVzY2FwZWQ7XHJcbiAgICBsZXQgaW5kZXg7XHJcbiAgICBsZXQgbGFzdEluZGV4ID0gMDtcclxuICAgIGZvciAoaW5kZXggPSBtYXRjaC5pbmRleDsgaW5kZXggPCBzdHIubGVuZ3RoOyBpbmRleCsrKSB7XHJcbiAgICAgICAgc3dpdGNoIChzdHIuY2hhckNvZGVBdChpbmRleCkpIHtcclxuICAgICAgICAgICAgY2FzZSAzNDogLy8gXCJcclxuICAgICAgICAgICAgICAgIGVzY2FwZWQgPSAnJnF1b3Q7JztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDM4OiAvLyAmXHJcbiAgICAgICAgICAgICAgICBlc2NhcGVkID0gJyZhbXA7JztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDM5OiAvLyAnXHJcbiAgICAgICAgICAgICAgICBlc2NhcGVkID0gJyYjMzk7JztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDYwOiAvLyA8XHJcbiAgICAgICAgICAgICAgICBlc2NhcGVkID0gJyZsdDsnO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgNjI6IC8vID5cclxuICAgICAgICAgICAgICAgIGVzY2FwZWQgPSAnJmd0Oyc7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAobGFzdEluZGV4ICE9PSBpbmRleCkge1xyXG4gICAgICAgICAgICBodG1sICs9IHN0ci5zbGljZShsYXN0SW5kZXgsIGluZGV4KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGFzdEluZGV4ID0gaW5kZXggKyAxO1xyXG4gICAgICAgIGh0bWwgKz0gZXNjYXBlZDtcclxuICAgIH1cclxuICAgIHJldHVybiBsYXN0SW5kZXggIT09IGluZGV4ID8gaHRtbCArIHN0ci5zbGljZShsYXN0SW5kZXgsIGluZGV4KSA6IGh0bWw7XHJcbn1cclxuLy8gaHR0cHM6Ly93d3cudzMub3JnL1RSL2h0bWw1Mi9zeW50YXguaHRtbCNjb21tZW50c1xyXG5jb25zdCBjb21tZW50U3RyaXBSRSA9IC9eLT8+fDwhLS18LS0+fC0tIT58PCEtJC9nO1xyXG5mdW5jdGlvbiBlc2NhcGVIdG1sQ29tbWVudChzcmMpIHtcclxuICAgIHJldHVybiBzcmMucmVwbGFjZShjb21tZW50U3RyaXBSRSwgJycpO1xyXG59XG5cbmZ1bmN0aW9uIGxvb3NlQ29tcGFyZUFycmF5cyhhLCBiKSB7XHJcbiAgICBpZiAoYS5sZW5ndGggIT09IGIubGVuZ3RoKVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIGxldCBlcXVhbCA9IHRydWU7XHJcbiAgICBmb3IgKGxldCBpID0gMDsgZXF1YWwgJiYgaSA8IGEubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBlcXVhbCA9IGxvb3NlRXF1YWwoYVtpXSwgYltpXSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZXF1YWw7XHJcbn1cclxuZnVuY3Rpb24gbG9vc2VFcXVhbChhLCBiKSB7XHJcbiAgICBpZiAoYSA9PT0gYilcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIGxldCBhVmFsaWRUeXBlID0gaXNEYXRlKGEpO1xyXG4gICAgbGV0IGJWYWxpZFR5cGUgPSBpc0RhdGUoYik7XHJcbiAgICBpZiAoYVZhbGlkVHlwZSB8fCBiVmFsaWRUeXBlKSB7XHJcbiAgICAgICAgcmV0dXJuIGFWYWxpZFR5cGUgJiYgYlZhbGlkVHlwZSA/IGEuZ2V0VGltZSgpID09PSBiLmdldFRpbWUoKSA6IGZhbHNlO1xyXG4gICAgfVxyXG4gICAgYVZhbGlkVHlwZSA9IGlzQXJyYXkoYSk7XHJcbiAgICBiVmFsaWRUeXBlID0gaXNBcnJheShiKTtcclxuICAgIGlmIChhVmFsaWRUeXBlIHx8IGJWYWxpZFR5cGUpIHtcclxuICAgICAgICByZXR1cm4gYVZhbGlkVHlwZSAmJiBiVmFsaWRUeXBlID8gbG9vc2VDb21wYXJlQXJyYXlzKGEsIGIpIDogZmFsc2U7XHJcbiAgICB9XHJcbiAgICBhVmFsaWRUeXBlID0gaXNPYmplY3QoYSk7XHJcbiAgICBiVmFsaWRUeXBlID0gaXNPYmplY3QoYik7XHJcbiAgICBpZiAoYVZhbGlkVHlwZSB8fCBiVmFsaWRUeXBlKSB7XHJcbiAgICAgICAgLyogaXN0YW5idWwgaWdub3JlIGlmOiB0aGlzIGlmIHdpbGwgcHJvYmFibHkgbmV2ZXIgYmUgY2FsbGVkICovXHJcbiAgICAgICAgaWYgKCFhVmFsaWRUeXBlIHx8ICFiVmFsaWRUeXBlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgYUtleXNDb3VudCA9IE9iamVjdC5rZXlzKGEpLmxlbmd0aDtcclxuICAgICAgICBjb25zdCBiS2V5c0NvdW50ID0gT2JqZWN0LmtleXMoYikubGVuZ3RoO1xyXG4gICAgICAgIGlmIChhS2V5c0NvdW50ICE9PSBiS2V5c0NvdW50KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gYSkge1xyXG4gICAgICAgICAgICBjb25zdCBhSGFzS2V5ID0gYS5oYXNPd25Qcm9wZXJ0eShrZXkpO1xyXG4gICAgICAgICAgICBjb25zdCBiSGFzS2V5ID0gYi5oYXNPd25Qcm9wZXJ0eShrZXkpO1xyXG4gICAgICAgICAgICBpZiAoKGFIYXNLZXkgJiYgIWJIYXNLZXkpIHx8XHJcbiAgICAgICAgICAgICAgICAoIWFIYXNLZXkgJiYgYkhhc0tleSkgfHxcclxuICAgICAgICAgICAgICAgICFsb29zZUVxdWFsKGFba2V5XSwgYltrZXldKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIFN0cmluZyhhKSA9PT0gU3RyaW5nKGIpO1xyXG59XHJcbmZ1bmN0aW9uIGxvb3NlSW5kZXhPZihhcnIsIHZhbCkge1xyXG4gICAgcmV0dXJuIGFyci5maW5kSW5kZXgoaXRlbSA9PiBsb29zZUVxdWFsKGl0ZW0sIHZhbCkpO1xyXG59XG5cbi8qKlxyXG4gKiBGb3IgY29udmVydGluZyB7eyBpbnRlcnBvbGF0aW9uIH19IHZhbHVlcyB0byBkaXNwbGF5ZWQgc3RyaW5ncy5cclxuICogQHByaXZhdGVcclxuICovXHJcbmNvbnN0IHRvRGlzcGxheVN0cmluZyA9ICh2YWwpID0+IHtcclxuICAgIHJldHVybiBpc1N0cmluZyh2YWwpXHJcbiAgICAgICAgPyB2YWxcclxuICAgICAgICA6IHZhbCA9PSBudWxsXHJcbiAgICAgICAgICAgID8gJydcclxuICAgICAgICAgICAgOiBpc0FycmF5KHZhbCkgfHxcclxuICAgICAgICAgICAgICAgIChpc09iamVjdCh2YWwpICYmXHJcbiAgICAgICAgICAgICAgICAgICAgKHZhbC50b1N0cmluZyA9PT0gb2JqZWN0VG9TdHJpbmcgfHwgIWlzRnVuY3Rpb24odmFsLnRvU3RyaW5nKSkpXHJcbiAgICAgICAgICAgICAgICA/IEpTT04uc3RyaW5naWZ5KHZhbCwgcmVwbGFjZXIsIDIpXHJcbiAgICAgICAgICAgICAgICA6IFN0cmluZyh2YWwpO1xyXG59O1xyXG5jb25zdCByZXBsYWNlciA9IChfa2V5LCB2YWwpID0+IHtcclxuICAgIC8vIGNhbid0IHVzZSBpc1JlZiBoZXJlIHNpbmNlIEB2dWUvc2hhcmVkIGhhcyBubyBkZXBzXHJcbiAgICBpZiAodmFsICYmIHZhbC5fX3ZfaXNSZWYpIHtcclxuICAgICAgICByZXR1cm4gcmVwbGFjZXIoX2tleSwgdmFsLnZhbHVlKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGlzTWFwKHZhbCkpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBbYE1hcCgke3ZhbC5zaXplfSlgXTogWy4uLnZhbC5lbnRyaWVzKCldLnJlZHVjZSgoZW50cmllcywgW2tleSwgdmFsXSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgZW50cmllc1tgJHtrZXl9ID0+YF0gPSB2YWw7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZW50cmllcztcclxuICAgICAgICAgICAgfSwge30pXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGlzU2V0KHZhbCkpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBbYFNldCgke3ZhbC5zaXplfSlgXTogWy4uLnZhbC52YWx1ZXMoKV1cclxuICAgICAgICB9O1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoaXNPYmplY3QodmFsKSAmJiAhaXNBcnJheSh2YWwpICYmICFpc1BsYWluT2JqZWN0KHZhbCkpIHtcclxuICAgICAgICByZXR1cm4gU3RyaW5nKHZhbCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdmFsO1xyXG59O1xuXG5jb25zdCBFTVBUWV9PQkogPSAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJylcclxuICAgID8gT2JqZWN0LmZyZWV6ZSh7fSlcclxuICAgIDoge307XHJcbmNvbnN0IEVNUFRZX0FSUiA9IChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSA/IE9iamVjdC5mcmVlemUoW10pIDogW107XHJcbmNvbnN0IE5PT1AgPSAoKSA9PiB7IH07XHJcbi8qKlxyXG4gKiBBbHdheXMgcmV0dXJuIGZhbHNlLlxyXG4gKi9cclxuY29uc3QgTk8gPSAoKSA9PiBmYWxzZTtcclxuY29uc3Qgb25SRSA9IC9eb25bXmEtel0vO1xyXG5jb25zdCBpc09uID0gKGtleSkgPT4gb25SRS50ZXN0KGtleSk7XHJcbmNvbnN0IGlzTW9kZWxMaXN0ZW5lciA9IChrZXkpID0+IGtleS5zdGFydHNXaXRoKCdvblVwZGF0ZTonKTtcclxuY29uc3QgZXh0ZW5kID0gT2JqZWN0LmFzc2lnbjtcclxuY29uc3QgcmVtb3ZlID0gKGFyciwgZWwpID0+IHtcclxuICAgIGNvbnN0IGkgPSBhcnIuaW5kZXhPZihlbCk7XHJcbiAgICBpZiAoaSA+IC0xKSB7XHJcbiAgICAgICAgYXJyLnNwbGljZShpLCAxKTtcclxuICAgIH1cclxufTtcclxuY29uc3QgaGFzT3duUHJvcGVydHkgPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5O1xyXG5jb25zdCBoYXNPd24gPSAodmFsLCBrZXkpID0+IGhhc093blByb3BlcnR5LmNhbGwodmFsLCBrZXkpO1xyXG5jb25zdCBpc0FycmF5ID0gQXJyYXkuaXNBcnJheTtcclxuY29uc3QgaXNNYXAgPSAodmFsKSA9PiB0b1R5cGVTdHJpbmcodmFsKSA9PT0gJ1tvYmplY3QgTWFwXSc7XHJcbmNvbnN0IGlzU2V0ID0gKHZhbCkgPT4gdG9UeXBlU3RyaW5nKHZhbCkgPT09ICdbb2JqZWN0IFNldF0nO1xyXG5jb25zdCBpc0RhdGUgPSAodmFsKSA9PiB2YWwgaW5zdGFuY2VvZiBEYXRlO1xyXG5jb25zdCBpc0Z1bmN0aW9uID0gKHZhbCkgPT4gdHlwZW9mIHZhbCA9PT0gJ2Z1bmN0aW9uJztcclxuY29uc3QgaXNTdHJpbmcgPSAodmFsKSA9PiB0eXBlb2YgdmFsID09PSAnc3RyaW5nJztcclxuY29uc3QgaXNTeW1ib2wgPSAodmFsKSA9PiB0eXBlb2YgdmFsID09PSAnc3ltYm9sJztcclxuY29uc3QgaXNPYmplY3QgPSAodmFsKSA9PiB2YWwgIT09IG51bGwgJiYgdHlwZW9mIHZhbCA9PT0gJ29iamVjdCc7XHJcbmNvbnN0IGlzUHJvbWlzZSA9ICh2YWwpID0+IHtcclxuICAgIHJldHVybiBpc09iamVjdCh2YWwpICYmIGlzRnVuY3Rpb24odmFsLnRoZW4pICYmIGlzRnVuY3Rpb24odmFsLmNhdGNoKTtcclxufTtcclxuY29uc3Qgb2JqZWN0VG9TdHJpbmcgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO1xyXG5jb25zdCB0b1R5cGVTdHJpbmcgPSAodmFsdWUpID0+IG9iamVjdFRvU3RyaW5nLmNhbGwodmFsdWUpO1xyXG5jb25zdCB0b1Jhd1R5cGUgPSAodmFsdWUpID0+IHtcclxuICAgIC8vIGV4dHJhY3QgXCJSYXdUeXBlXCIgZnJvbSBzdHJpbmdzIGxpa2UgXCJbb2JqZWN0IFJhd1R5cGVdXCJcclxuICAgIHJldHVybiB0b1R5cGVTdHJpbmcodmFsdWUpLnNsaWNlKDgsIC0xKTtcclxufTtcclxuY29uc3QgaXNQbGFpbk9iamVjdCA9ICh2YWwpID0+IHRvVHlwZVN0cmluZyh2YWwpID09PSAnW29iamVjdCBPYmplY3RdJztcclxuY29uc3QgaXNJbnRlZ2VyS2V5ID0gKGtleSkgPT4gaXNTdHJpbmcoa2V5KSAmJlxyXG4gICAga2V5ICE9PSAnTmFOJyAmJlxyXG4gICAga2V5WzBdICE9PSAnLScgJiZcclxuICAgICcnICsgcGFyc2VJbnQoa2V5LCAxMCkgPT09IGtleTtcclxuY29uc3QgaXNSZXNlcnZlZFByb3AgPSAvKiNfX1BVUkVfXyovIG1ha2VNYXAoXHJcbi8vIHRoZSBsZWFkaW5nIGNvbW1hIGlzIGludGVudGlvbmFsIHNvIGVtcHR5IHN0cmluZyBcIlwiIGlzIGFsc28gaW5jbHVkZWRcclxuJyxrZXkscmVmLHJlZl9mb3IscmVmX2tleSwnICtcclxuICAgICdvblZub2RlQmVmb3JlTW91bnQsb25Wbm9kZU1vdW50ZWQsJyArXHJcbiAgICAnb25Wbm9kZUJlZm9yZVVwZGF0ZSxvblZub2RlVXBkYXRlZCwnICtcclxuICAgICdvblZub2RlQmVmb3JlVW5tb3VudCxvblZub2RlVW5tb3VudGVkJyk7XHJcbmNvbnN0IGlzQnVpbHRJbkRpcmVjdGl2ZSA9IC8qI19fUFVSRV9fKi8gbWFrZU1hcCgnYmluZCxjbG9hayxlbHNlLWlmLGVsc2UsZm9yLGh0bWwsaWYsbW9kZWwsb24sb25jZSxwcmUsc2hvdyxzbG90LHRleHQsbWVtbycpO1xyXG5jb25zdCBjYWNoZVN0cmluZ0Z1bmN0aW9uID0gKGZuKSA9PiB7XHJcbiAgICBjb25zdCBjYWNoZSA9IE9iamVjdC5jcmVhdGUobnVsbCk7XHJcbiAgICByZXR1cm4gKChzdHIpID0+IHtcclxuICAgICAgICBjb25zdCBoaXQgPSBjYWNoZVtzdHJdO1xyXG4gICAgICAgIHJldHVybiBoaXQgfHwgKGNhY2hlW3N0cl0gPSBmbihzdHIpKTtcclxuICAgIH0pO1xyXG59O1xyXG5jb25zdCBjYW1lbGl6ZVJFID0gLy0oXFx3KS9nO1xyXG4vKipcclxuICogQHByaXZhdGVcclxuICovXHJcbmNvbnN0IGNhbWVsaXplID0gY2FjaGVTdHJpbmdGdW5jdGlvbigoc3RyKSA9PiB7XHJcbiAgICByZXR1cm4gc3RyLnJlcGxhY2UoY2FtZWxpemVSRSwgKF8sIGMpID0+IChjID8gYy50b1VwcGVyQ2FzZSgpIDogJycpKTtcclxufSk7XHJcbmNvbnN0IGh5cGhlbmF0ZVJFID0gL1xcQihbQS1aXSkvZztcclxuLyoqXHJcbiAqIEBwcml2YXRlXHJcbiAqL1xyXG5jb25zdCBoeXBoZW5hdGUgPSBjYWNoZVN0cmluZ0Z1bmN0aW9uKChzdHIpID0+IHN0ci5yZXBsYWNlKGh5cGhlbmF0ZVJFLCAnLSQxJykudG9Mb3dlckNhc2UoKSk7XHJcbi8qKlxyXG4gKiBAcHJpdmF0ZVxyXG4gKi9cclxuY29uc3QgY2FwaXRhbGl6ZSA9IGNhY2hlU3RyaW5nRnVuY3Rpb24oKHN0cikgPT4gc3RyLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgc3RyLnNsaWNlKDEpKTtcclxuLyoqXHJcbiAqIEBwcml2YXRlXHJcbiAqL1xyXG5jb25zdCB0b0hhbmRsZXJLZXkgPSBjYWNoZVN0cmluZ0Z1bmN0aW9uKChzdHIpID0+IHN0ciA/IGBvbiR7Y2FwaXRhbGl6ZShzdHIpfWAgOiBgYCk7XHJcbi8vIGNvbXBhcmUgd2hldGhlciBhIHZhbHVlIGhhcyBjaGFuZ2VkLCBhY2NvdW50aW5nIGZvciBOYU4uXHJcbmNvbnN0IGhhc0NoYW5nZWQgPSAodmFsdWUsIG9sZFZhbHVlKSA9PiAhT2JqZWN0LmlzKHZhbHVlLCBvbGRWYWx1ZSk7XHJcbmNvbnN0IGludm9rZUFycmF5Rm5zID0gKGZucywgYXJnKSA9PiB7XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGZucy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGZuc1tpXShhcmcpO1xyXG4gICAgfVxyXG59O1xyXG5jb25zdCBkZWYgPSAob2JqLCBrZXksIHZhbHVlKSA9PiB7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHtcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXHJcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICAgICAgdmFsdWVcclxuICAgIH0pO1xyXG59O1xyXG5jb25zdCB0b051bWJlciA9ICh2YWwpID0+IHtcclxuICAgIGNvbnN0IG4gPSBwYXJzZUZsb2F0KHZhbCk7XHJcbiAgICByZXR1cm4gaXNOYU4obikgPyB2YWwgOiBuO1xyXG59O1xyXG5sZXQgX2dsb2JhbFRoaXM7XHJcbmNvbnN0IGdldEdsb2JhbFRoaXMgPSAoKSA9PiB7XHJcbiAgICByZXR1cm4gKF9nbG9iYWxUaGlzIHx8XHJcbiAgICAgICAgKF9nbG9iYWxUaGlzID1cclxuICAgICAgICAgICAgdHlwZW9mIGdsb2JhbFRoaXMgIT09ICd1bmRlZmluZWQnXHJcbiAgICAgICAgICAgICAgICA/IGdsb2JhbFRoaXNcclxuICAgICAgICAgICAgICAgIDogdHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnXHJcbiAgICAgICAgICAgICAgICAgICAgPyBzZWxmXHJcbiAgICAgICAgICAgICAgICAgICAgOiB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICA/IHdpbmRvd1xyXG4gICAgICAgICAgICAgICAgICAgICAgICA6IHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IGdsb2JhbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiB7fSkpO1xyXG59O1xuXG5leHBvcnQgeyBFTVBUWV9BUlIsIEVNUFRZX09CSiwgTk8sIE5PT1AsIFBhdGNoRmxhZ05hbWVzLCBjYW1lbGl6ZSwgY2FwaXRhbGl6ZSwgZGVmLCBlc2NhcGVIdG1sLCBlc2NhcGVIdG1sQ29tbWVudCwgZXh0ZW5kLCBnZW5lcmF0ZUNvZGVGcmFtZSwgZ2V0R2xvYmFsVGhpcywgaGFzQ2hhbmdlZCwgaGFzT3duLCBoeXBoZW5hdGUsIGluY2x1ZGVCb29sZWFuQXR0ciwgaW52b2tlQXJyYXlGbnMsIGlzQXJyYXksIGlzQm9vbGVhbkF0dHIsIGlzQnVpbHRJbkRpcmVjdGl2ZSwgaXNEYXRlLCBpc0Z1bmN0aW9uLCBpc0dsb2JhbGx5V2hpdGVsaXN0ZWQsIGlzSFRNTFRhZywgaXNJbnRlZ2VyS2V5LCBpc0tub3duSHRtbEF0dHIsIGlzS25vd25TdmdBdHRyLCBpc01hcCwgaXNNb2RlbExpc3RlbmVyLCBpc05vVW5pdE51bWVyaWNTdHlsZVByb3AsIGlzT2JqZWN0LCBpc09uLCBpc1BsYWluT2JqZWN0LCBpc1Byb21pc2UsIGlzUmVzZXJ2ZWRQcm9wLCBpc1NTUlNhZmVBdHRyTmFtZSwgaXNTVkdUYWcsIGlzU2V0LCBpc1NwZWNpYWxCb29sZWFuQXR0ciwgaXNTdHJpbmcsIGlzU3ltYm9sLCBpc1ZvaWRUYWcsIGxvb3NlRXF1YWwsIGxvb3NlSW5kZXhPZiwgbWFrZU1hcCwgbm9ybWFsaXplQ2xhc3MsIG5vcm1hbGl6ZVByb3BzLCBub3JtYWxpemVTdHlsZSwgb2JqZWN0VG9TdHJpbmcsIHBhcnNlU3RyaW5nU3R5bGUsIHByb3BzVG9BdHRyTWFwLCByZW1vdmUsIHNsb3RGbGFnc1RleHQsIHN0cmluZ2lmeVN0eWxlLCB0b0Rpc3BsYXlTdHJpbmcsIHRvSGFuZGxlcktleSwgdG9OdW1iZXIsIHRvUmF3VHlwZSwgdG9UeXBlU3RyaW5nIH07XG4iLCJpbXBvcnQgeyBleHRlbmQsIGlzQXJyYXksIGlzTWFwLCBpc0ludGVnZXJLZXksIGlzU3ltYm9sLCBoYXNPd24sIGlzT2JqZWN0LCBoYXNDaGFuZ2VkLCBtYWtlTWFwLCBjYXBpdGFsaXplLCB0b1Jhd1R5cGUsIGRlZiwgaXNGdW5jdGlvbiwgTk9PUCB9IGZyb20gJ0B2dWUvc2hhcmVkJztcblxuZnVuY3Rpb24gd2Fybihtc2csIC4uLmFyZ3MpIHtcclxuICAgIGNvbnNvbGUud2FybihgW1Z1ZSB3YXJuXSAke21zZ31gLCAuLi5hcmdzKTtcclxufVxuXG5sZXQgYWN0aXZlRWZmZWN0U2NvcGU7XHJcbmNsYXNzIEVmZmVjdFNjb3BlIHtcclxuICAgIGNvbnN0cnVjdG9yKGRldGFjaGVkID0gZmFsc2UpIHtcclxuICAgICAgICB0aGlzLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5lZmZlY3RzID0gW107XHJcbiAgICAgICAgdGhpcy5jbGVhbnVwcyA9IFtdO1xyXG4gICAgICAgIGlmICghZGV0YWNoZWQgJiYgYWN0aXZlRWZmZWN0U2NvcGUpIHtcclxuICAgICAgICAgICAgdGhpcy5wYXJlbnQgPSBhY3RpdmVFZmZlY3RTY29wZTtcclxuICAgICAgICAgICAgdGhpcy5pbmRleCA9XHJcbiAgICAgICAgICAgICAgICAoYWN0aXZlRWZmZWN0U2NvcGUuc2NvcGVzIHx8IChhY3RpdmVFZmZlY3RTY29wZS5zY29wZXMgPSBbXSkpLnB1c2godGhpcykgLSAxO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJ1bihmbikge1xyXG4gICAgICAgIGlmICh0aGlzLmFjdGl2ZSkge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgYWN0aXZlRWZmZWN0U2NvcGUgPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZuKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZmluYWxseSB7XHJcbiAgICAgICAgICAgICAgICBhY3RpdmVFZmZlY3RTY29wZSA9IHRoaXMucGFyZW50O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgICAgICB3YXJuKGBjYW5ub3QgcnVuIGFuIGluYWN0aXZlIGVmZmVjdCBzY29wZS5gKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBvbigpIHtcclxuICAgICAgICBhY3RpdmVFZmZlY3RTY29wZSA9IHRoaXM7XHJcbiAgICB9XHJcbiAgICBvZmYoKSB7XHJcbiAgICAgICAgYWN0aXZlRWZmZWN0U2NvcGUgPSB0aGlzLnBhcmVudDtcclxuICAgIH1cclxuICAgIHN0b3AoZnJvbVBhcmVudCkge1xyXG4gICAgICAgIGlmICh0aGlzLmFjdGl2ZSkge1xyXG4gICAgICAgICAgICBsZXQgaSwgbDtcclxuICAgICAgICAgICAgZm9yIChpID0gMCwgbCA9IHRoaXMuZWZmZWN0cy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZWZmZWN0c1tpXS5zdG9wKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZm9yIChpID0gMCwgbCA9IHRoaXMuY2xlYW51cHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNsZWFudXBzW2ldKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRoaXMuc2NvcGVzKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGkgPSAwLCBsID0gdGhpcy5zY29wZXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zY29wZXNbaV0uc3RvcCh0cnVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBuZXN0ZWQgc2NvcGUsIGRlcmVmZXJlbmNlIGZyb20gcGFyZW50IHRvIGF2b2lkIG1lbW9yeSBsZWFrc1xyXG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQgJiYgIWZyb21QYXJlbnQpIHtcclxuICAgICAgICAgICAgICAgIC8vIG9wdGltaXplZCBPKDEpIHJlbW92YWxcclxuICAgICAgICAgICAgICAgIGNvbnN0IGxhc3QgPSB0aGlzLnBhcmVudC5zY29wZXMucG9wKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAobGFzdCAmJiBsYXN0ICE9PSB0aGlzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQuc2NvcGVzW3RoaXMuaW5kZXhdID0gbGFzdDtcclxuICAgICAgICAgICAgICAgICAgICBsYXN0LmluZGV4ID0gdGhpcy5pbmRleDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBlZmZlY3RTY29wZShkZXRhY2hlZCkge1xyXG4gICAgcmV0dXJuIG5ldyBFZmZlY3RTY29wZShkZXRhY2hlZCk7XHJcbn1cclxuZnVuY3Rpb24gcmVjb3JkRWZmZWN0U2NvcGUoZWZmZWN0LCBzY29wZSA9IGFjdGl2ZUVmZmVjdFNjb3BlKSB7XHJcbiAgICBpZiAoc2NvcGUgJiYgc2NvcGUuYWN0aXZlKSB7XHJcbiAgICAgICAgc2NvcGUuZWZmZWN0cy5wdXNoKGVmZmVjdCk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gZ2V0Q3VycmVudFNjb3BlKCkge1xyXG4gICAgcmV0dXJuIGFjdGl2ZUVmZmVjdFNjb3BlO1xyXG59XHJcbmZ1bmN0aW9uIG9uU2NvcGVEaXNwb3NlKGZuKSB7XHJcbiAgICBpZiAoYWN0aXZlRWZmZWN0U2NvcGUpIHtcclxuICAgICAgICBhY3RpdmVFZmZlY3RTY29wZS5jbGVhbnVwcy5wdXNoKGZuKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgIHdhcm4oYG9uU2NvcGVEaXNwb3NlKCkgaXMgY2FsbGVkIHdoZW4gdGhlcmUgaXMgbm8gYWN0aXZlIGVmZmVjdCBzY29wZWAgK1xyXG4gICAgICAgICAgICBgIHRvIGJlIGFzc29jaWF0ZWQgd2l0aC5gKTtcclxuICAgIH1cclxufVxuXG5jb25zdCBjcmVhdGVEZXAgPSAoZWZmZWN0cykgPT4ge1xyXG4gICAgY29uc3QgZGVwID0gbmV3IFNldChlZmZlY3RzKTtcclxuICAgIGRlcC53ID0gMDtcclxuICAgIGRlcC5uID0gMDtcclxuICAgIHJldHVybiBkZXA7XHJcbn07XHJcbmNvbnN0IHdhc1RyYWNrZWQgPSAoZGVwKSA9PiAoZGVwLncgJiB0cmFja09wQml0KSA+IDA7XHJcbmNvbnN0IG5ld1RyYWNrZWQgPSAoZGVwKSA9PiAoZGVwLm4gJiB0cmFja09wQml0KSA+IDA7XHJcbmNvbnN0IGluaXREZXBNYXJrZXJzID0gKHsgZGVwcyB9KSA9PiB7XHJcbiAgICBpZiAoZGVwcy5sZW5ndGgpIHtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRlcHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgZGVwc1tpXS53IHw9IHRyYWNrT3BCaXQ7IC8vIHNldCB3YXMgdHJhY2tlZFxyXG4gICAgICAgIH1cclxuICAgIH1cclxufTtcclxuY29uc3QgZmluYWxpemVEZXBNYXJrZXJzID0gKGVmZmVjdCkgPT4ge1xyXG4gICAgY29uc3QgeyBkZXBzIH0gPSBlZmZlY3Q7XHJcbiAgICBpZiAoZGVwcy5sZW5ndGgpIHtcclxuICAgICAgICBsZXQgcHRyID0gMDtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRlcHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgY29uc3QgZGVwID0gZGVwc1tpXTtcclxuICAgICAgICAgICAgaWYgKHdhc1RyYWNrZWQoZGVwKSAmJiAhbmV3VHJhY2tlZChkZXApKSB7XHJcbiAgICAgICAgICAgICAgICBkZXAuZGVsZXRlKGVmZmVjdCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBkZXBzW3B0cisrXSA9IGRlcDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBjbGVhciBiaXRzXHJcbiAgICAgICAgICAgIGRlcC53ICY9IH50cmFja09wQml0O1xyXG4gICAgICAgICAgICBkZXAubiAmPSB+dHJhY2tPcEJpdDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZGVwcy5sZW5ndGggPSBwdHI7XHJcbiAgICB9XHJcbn07XG5cbmNvbnN0IHRhcmdldE1hcCA9IG5ldyBXZWFrTWFwKCk7XHJcbi8vIFRoZSBudW1iZXIgb2YgZWZmZWN0cyBjdXJyZW50bHkgYmVpbmcgdHJhY2tlZCByZWN1cnNpdmVseS5cclxubGV0IGVmZmVjdFRyYWNrRGVwdGggPSAwO1xyXG5sZXQgdHJhY2tPcEJpdCA9IDE7XHJcbi8qKlxyXG4gKiBUaGUgYml0d2lzZSB0cmFjayBtYXJrZXJzIHN1cHBvcnQgYXQgbW9zdCAzMCBsZXZlbHMgb2YgcmVjdXJzaW9uLlxyXG4gKiBUaGlzIHZhbHVlIGlzIGNob3NlbiB0byBlbmFibGUgbW9kZXJuIEpTIGVuZ2luZXMgdG8gdXNlIGEgU01JIG9uIGFsbCBwbGF0Zm9ybXMuXHJcbiAqIFdoZW4gcmVjdXJzaW9uIGRlcHRoIGlzIGdyZWF0ZXIsIGZhbGwgYmFjayB0byB1c2luZyBhIGZ1bGwgY2xlYW51cC5cclxuICovXHJcbmNvbnN0IG1heE1hcmtlckJpdHMgPSAzMDtcclxubGV0IGFjdGl2ZUVmZmVjdDtcclxuY29uc3QgSVRFUkFURV9LRVkgPSBTeW1ib2woKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpID8gJ2l0ZXJhdGUnIDogJycpO1xyXG5jb25zdCBNQVBfS0VZX0lURVJBVEVfS0VZID0gU3ltYm9sKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSA/ICdNYXAga2V5IGl0ZXJhdGUnIDogJycpO1xyXG5jbGFzcyBSZWFjdGl2ZUVmZmVjdCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihmbiwgc2NoZWR1bGVyID0gbnVsbCwgc2NvcGUpIHtcclxuICAgICAgICB0aGlzLmZuID0gZm47XHJcbiAgICAgICAgdGhpcy5zY2hlZHVsZXIgPSBzY2hlZHVsZXI7XHJcbiAgICAgICAgdGhpcy5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuZGVwcyA9IFtdO1xyXG4gICAgICAgIHRoaXMucGFyZW50ID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIHJlY29yZEVmZmVjdFNjb3BlKHRoaXMsIHNjb3BlKTtcclxuICAgIH1cclxuICAgIHJ1bigpIHtcclxuICAgICAgICBpZiAoIXRoaXMuYWN0aXZlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmZuKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBwYXJlbnQgPSBhY3RpdmVFZmZlY3Q7XHJcbiAgICAgICAgbGV0IGxhc3RTaG91bGRUcmFjayA9IHNob3VsZFRyYWNrO1xyXG4gICAgICAgIHdoaWxlIChwYXJlbnQpIHtcclxuICAgICAgICAgICAgaWYgKHBhcmVudCA9PT0gdGhpcykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHBhcmVudCA9IHBhcmVudC5wYXJlbnQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIHRoaXMucGFyZW50ID0gYWN0aXZlRWZmZWN0O1xyXG4gICAgICAgICAgICBhY3RpdmVFZmZlY3QgPSB0aGlzO1xyXG4gICAgICAgICAgICBzaG91bGRUcmFjayA9IHRydWU7XHJcbiAgICAgICAgICAgIHRyYWNrT3BCaXQgPSAxIDw8ICsrZWZmZWN0VHJhY2tEZXB0aDtcclxuICAgICAgICAgICAgaWYgKGVmZmVjdFRyYWNrRGVwdGggPD0gbWF4TWFya2VyQml0cykge1xyXG4gICAgICAgICAgICAgICAgaW5pdERlcE1hcmtlcnModGhpcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjbGVhbnVwRWZmZWN0KHRoaXMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmZuKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZpbmFsbHkge1xyXG4gICAgICAgICAgICBpZiAoZWZmZWN0VHJhY2tEZXB0aCA8PSBtYXhNYXJrZXJCaXRzKSB7XHJcbiAgICAgICAgICAgICAgICBmaW5hbGl6ZURlcE1hcmtlcnModGhpcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdHJhY2tPcEJpdCA9IDEgPDwgLS1lZmZlY3RUcmFja0RlcHRoO1xyXG4gICAgICAgICAgICBhY3RpdmVFZmZlY3QgPSB0aGlzLnBhcmVudDtcclxuICAgICAgICAgICAgc2hvdWxkVHJhY2sgPSBsYXN0U2hvdWxkVHJhY2s7XHJcbiAgICAgICAgICAgIHRoaXMucGFyZW50ID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHN0b3AoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuYWN0aXZlKSB7XHJcbiAgICAgICAgICAgIGNsZWFudXBFZmZlY3QodGhpcyk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm9uU3RvcCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vblN0b3AoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBjbGVhbnVwRWZmZWN0KGVmZmVjdCkge1xyXG4gICAgY29uc3QgeyBkZXBzIH0gPSBlZmZlY3Q7XHJcbiAgICBpZiAoZGVwcy5sZW5ndGgpIHtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRlcHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgZGVwc1tpXS5kZWxldGUoZWZmZWN0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZGVwcy5sZW5ndGggPSAwO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGVmZmVjdChmbiwgb3B0aW9ucykge1xyXG4gICAgaWYgKGZuLmVmZmVjdCkge1xyXG4gICAgICAgIGZuID0gZm4uZWZmZWN0LmZuO1xyXG4gICAgfVxyXG4gICAgY29uc3QgX2VmZmVjdCA9IG5ldyBSZWFjdGl2ZUVmZmVjdChmbik7XHJcbiAgICBpZiAob3B0aW9ucykge1xyXG4gICAgICAgIGV4dGVuZChfZWZmZWN0LCBvcHRpb25zKTtcclxuICAgICAgICBpZiAob3B0aW9ucy5zY29wZSlcclxuICAgICAgICAgICAgcmVjb3JkRWZmZWN0U2NvcGUoX2VmZmVjdCwgb3B0aW9ucy5zY29wZSk7XHJcbiAgICB9XHJcbiAgICBpZiAoIW9wdGlvbnMgfHwgIW9wdGlvbnMubGF6eSkge1xyXG4gICAgICAgIF9lZmZlY3QucnVuKCk7XHJcbiAgICB9XHJcbiAgICBjb25zdCBydW5uZXIgPSBfZWZmZWN0LnJ1bi5iaW5kKF9lZmZlY3QpO1xyXG4gICAgcnVubmVyLmVmZmVjdCA9IF9lZmZlY3Q7XHJcbiAgICByZXR1cm4gcnVubmVyO1xyXG59XHJcbmZ1bmN0aW9uIHN0b3AocnVubmVyKSB7XHJcbiAgICBydW5uZXIuZWZmZWN0LnN0b3AoKTtcclxufVxyXG5sZXQgc2hvdWxkVHJhY2sgPSB0cnVlO1xyXG5jb25zdCB0cmFja1N0YWNrID0gW107XHJcbmZ1bmN0aW9uIHBhdXNlVHJhY2tpbmcoKSB7XHJcbiAgICB0cmFja1N0YWNrLnB1c2goc2hvdWxkVHJhY2spO1xyXG4gICAgc2hvdWxkVHJhY2sgPSBmYWxzZTtcclxufVxyXG5mdW5jdGlvbiBlbmFibGVUcmFja2luZygpIHtcclxuICAgIHRyYWNrU3RhY2sucHVzaChzaG91bGRUcmFjayk7XHJcbiAgICBzaG91bGRUcmFjayA9IHRydWU7XHJcbn1cclxuZnVuY3Rpb24gcmVzZXRUcmFja2luZygpIHtcclxuICAgIGNvbnN0IGxhc3QgPSB0cmFja1N0YWNrLnBvcCgpO1xyXG4gICAgc2hvdWxkVHJhY2sgPSBsYXN0ID09PSB1bmRlZmluZWQgPyB0cnVlIDogbGFzdDtcclxufVxyXG5mdW5jdGlvbiB0cmFjayh0YXJnZXQsIHR5cGUsIGtleSkge1xyXG4gICAgaWYgKHNob3VsZFRyYWNrICYmIGFjdGl2ZUVmZmVjdCkge1xyXG4gICAgICAgIGxldCBkZXBzTWFwID0gdGFyZ2V0TWFwLmdldCh0YXJnZXQpO1xyXG4gICAgICAgIGlmICghZGVwc01hcCkge1xyXG4gICAgICAgICAgICB0YXJnZXRNYXAuc2V0KHRhcmdldCwgKGRlcHNNYXAgPSBuZXcgTWFwKCkpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGRlcCA9IGRlcHNNYXAuZ2V0KGtleSk7XHJcbiAgICAgICAgaWYgKCFkZXApIHtcclxuICAgICAgICAgICAgZGVwc01hcC5zZXQoa2V5LCAoZGVwID0gY3JlYXRlRGVwKCkpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgZXZlbnRJbmZvID0gKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpXHJcbiAgICAgICAgICAgID8geyBlZmZlY3Q6IGFjdGl2ZUVmZmVjdCwgdGFyZ2V0LCB0eXBlLCBrZXkgfVxyXG4gICAgICAgICAgICA6IHVuZGVmaW5lZDtcclxuICAgICAgICB0cmFja0VmZmVjdHMoZGVwLCBldmVudEluZm8pO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHRyYWNrRWZmZWN0cyhkZXAsIGRlYnVnZ2VyRXZlbnRFeHRyYUluZm8pIHtcclxuICAgIGxldCBzaG91bGRUcmFjayA9IGZhbHNlO1xyXG4gICAgaWYgKGVmZmVjdFRyYWNrRGVwdGggPD0gbWF4TWFya2VyQml0cykge1xyXG4gICAgICAgIGlmICghbmV3VHJhY2tlZChkZXApKSB7XHJcbiAgICAgICAgICAgIGRlcC5uIHw9IHRyYWNrT3BCaXQ7IC8vIHNldCBuZXdseSB0cmFja2VkXHJcbiAgICAgICAgICAgIHNob3VsZFRyYWNrID0gIXdhc1RyYWNrZWQoZGVwKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICAvLyBGdWxsIGNsZWFudXAgbW9kZS5cclxuICAgICAgICBzaG91bGRUcmFjayA9ICFkZXAuaGFzKGFjdGl2ZUVmZmVjdCk7XHJcbiAgICB9XHJcbiAgICBpZiAoc2hvdWxkVHJhY2spIHtcclxuICAgICAgICBkZXAuYWRkKGFjdGl2ZUVmZmVjdCk7XHJcbiAgICAgICAgYWN0aXZlRWZmZWN0LmRlcHMucHVzaChkZXApO1xyXG4gICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiYgYWN0aXZlRWZmZWN0Lm9uVHJhY2spIHtcclxuICAgICAgICAgICAgYWN0aXZlRWZmZWN0Lm9uVHJhY2soT2JqZWN0LmFzc2lnbih7XHJcbiAgICAgICAgICAgICAgICBlZmZlY3Q6IGFjdGl2ZUVmZmVjdFxyXG4gICAgICAgICAgICB9LCBkZWJ1Z2dlckV2ZW50RXh0cmFJbmZvKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHRyaWdnZXIodGFyZ2V0LCB0eXBlLCBrZXksIG5ld1ZhbHVlLCBvbGRWYWx1ZSwgb2xkVGFyZ2V0KSB7XHJcbiAgICBjb25zdCBkZXBzTWFwID0gdGFyZ2V0TWFwLmdldCh0YXJnZXQpO1xyXG4gICAgaWYgKCFkZXBzTWFwKSB7XHJcbiAgICAgICAgLy8gbmV2ZXIgYmVlbiB0cmFja2VkXHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgbGV0IGRlcHMgPSBbXTtcclxuICAgIGlmICh0eXBlID09PSBcImNsZWFyXCIgLyogQ0xFQVIgKi8pIHtcclxuICAgICAgICAvLyBjb2xsZWN0aW9uIGJlaW5nIGNsZWFyZWRcclxuICAgICAgICAvLyB0cmlnZ2VyIGFsbCBlZmZlY3RzIGZvciB0YXJnZXRcclxuICAgICAgICBkZXBzID0gWy4uLmRlcHNNYXAudmFsdWVzKCldO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoa2V5ID09PSAnbGVuZ3RoJyAmJiBpc0FycmF5KHRhcmdldCkpIHtcclxuICAgICAgICBkZXBzTWFwLmZvckVhY2goKGRlcCwga2V5KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChrZXkgPT09ICdsZW5ndGgnIHx8IGtleSA+PSBuZXdWYWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgZGVwcy5wdXNoKGRlcCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIC8vIHNjaGVkdWxlIHJ1bnMgZm9yIFNFVCB8IEFERCB8IERFTEVURVxyXG4gICAgICAgIGlmIChrZXkgIT09IHZvaWQgMCkge1xyXG4gICAgICAgICAgICBkZXBzLnB1c2goZGVwc01hcC5nZXQoa2V5KSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGFsc28gcnVuIGZvciBpdGVyYXRpb24ga2V5IG9uIEFERCB8IERFTEVURSB8IE1hcC5TRVRcclxuICAgICAgICBzd2l0Y2ggKHR5cGUpIHtcclxuICAgICAgICAgICAgY2FzZSBcImFkZFwiIC8qIEFERCAqLzpcclxuICAgICAgICAgICAgICAgIGlmICghaXNBcnJheSh0YXJnZXQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVwcy5wdXNoKGRlcHNNYXAuZ2V0KElURVJBVEVfS0VZKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzTWFwKHRhcmdldCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVwcy5wdXNoKGRlcHNNYXAuZ2V0KE1BUF9LRVlfSVRFUkFURV9LRVkpKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChpc0ludGVnZXJLZXkoa2V5KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIG5ldyBpbmRleCBhZGRlZCB0byBhcnJheSAtPiBsZW5ndGggY2hhbmdlc1xyXG4gICAgICAgICAgICAgICAgICAgIGRlcHMucHVzaChkZXBzTWFwLmdldCgnbGVuZ3RoJykpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgXCJkZWxldGVcIiAvKiBERUxFVEUgKi86XHJcbiAgICAgICAgICAgICAgICBpZiAoIWlzQXJyYXkodGFyZ2V0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRlcHMucHVzaChkZXBzTWFwLmdldChJVEVSQVRFX0tFWSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpc01hcCh0YXJnZXQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlcHMucHVzaChkZXBzTWFwLmdldChNQVBfS0VZX0lURVJBVEVfS0VZKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgXCJzZXRcIiAvKiBTRVQgKi86XHJcbiAgICAgICAgICAgICAgICBpZiAoaXNNYXAodGFyZ2V0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRlcHMucHVzaChkZXBzTWFwLmdldChJVEVSQVRFX0tFWSkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgY29uc3QgZXZlbnRJbmZvID0gKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpXHJcbiAgICAgICAgPyB7IHRhcmdldCwgdHlwZSwga2V5LCBuZXdWYWx1ZSwgb2xkVmFsdWUsIG9sZFRhcmdldCB9XHJcbiAgICAgICAgOiB1bmRlZmluZWQ7XHJcbiAgICBpZiAoZGVwcy5sZW5ndGggPT09IDEpIHtcclxuICAgICAgICBpZiAoZGVwc1swXSkge1xyXG4gICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgICAgICB0cmlnZ2VyRWZmZWN0cyhkZXBzWzBdLCBldmVudEluZm8pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdHJpZ2dlckVmZmVjdHMoZGVwc1swXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBjb25zdCBlZmZlY3RzID0gW107XHJcbiAgICAgICAgZm9yIChjb25zdCBkZXAgb2YgZGVwcykge1xyXG4gICAgICAgICAgICBpZiAoZGVwKSB7XHJcbiAgICAgICAgICAgICAgICBlZmZlY3RzLnB1c2goLi4uZGVwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgIHRyaWdnZXJFZmZlY3RzKGNyZWF0ZURlcChlZmZlY3RzKSwgZXZlbnRJbmZvKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRyaWdnZXJFZmZlY3RzKGNyZWF0ZURlcChlZmZlY3RzKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHRyaWdnZXJFZmZlY3RzKGRlcCwgZGVidWdnZXJFdmVudEV4dHJhSW5mbykge1xyXG4gICAgLy8gc3ByZWFkIGludG8gYXJyYXkgZm9yIHN0YWJpbGl6YXRpb25cclxuICAgIGZvciAoY29uc3QgZWZmZWN0IG9mIGlzQXJyYXkoZGVwKSA/IGRlcCA6IFsuLi5kZXBdKSB7XHJcbiAgICAgICAgaWYgKGVmZmVjdCAhPT0gYWN0aXZlRWZmZWN0IHx8IGVmZmVjdC5hbGxvd1JlY3Vyc2UpIHtcclxuICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiBlZmZlY3Qub25UcmlnZ2VyKSB7XHJcbiAgICAgICAgICAgICAgICBlZmZlY3Qub25UcmlnZ2VyKGV4dGVuZCh7IGVmZmVjdCB9LCBkZWJ1Z2dlckV2ZW50RXh0cmFJbmZvKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGVmZmVjdC5zY2hlZHVsZXIpIHtcclxuICAgICAgICAgICAgICAgIGVmZmVjdC5zY2hlZHVsZXIoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGVmZmVjdC5ydW4oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxuXG5jb25zdCBpc05vblRyYWNrYWJsZUtleXMgPSAvKiNfX1BVUkVfXyovIG1ha2VNYXAoYF9fcHJvdG9fXyxfX3ZfaXNSZWYsX19pc1Z1ZWApO1xyXG5jb25zdCBidWlsdEluU3ltYm9scyA9IG5ldyBTZXQoT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoU3ltYm9sKVxyXG4gICAgLm1hcChrZXkgPT4gU3ltYm9sW2tleV0pXHJcbiAgICAuZmlsdGVyKGlzU3ltYm9sKSk7XHJcbmNvbnN0IGdldCA9IC8qI19fUFVSRV9fKi8gY3JlYXRlR2V0dGVyKCk7XHJcbmNvbnN0IHNoYWxsb3dHZXQgPSAvKiNfX1BVUkVfXyovIGNyZWF0ZUdldHRlcihmYWxzZSwgdHJ1ZSk7XHJcbmNvbnN0IHJlYWRvbmx5R2V0ID0gLyojX19QVVJFX18qLyBjcmVhdGVHZXR0ZXIodHJ1ZSk7XHJcbmNvbnN0IHNoYWxsb3dSZWFkb25seUdldCA9IC8qI19fUFVSRV9fKi8gY3JlYXRlR2V0dGVyKHRydWUsIHRydWUpO1xyXG5jb25zdCBhcnJheUluc3RydW1lbnRhdGlvbnMgPSAvKiNfX1BVUkVfXyovIGNyZWF0ZUFycmF5SW5zdHJ1bWVudGF0aW9ucygpO1xyXG5mdW5jdGlvbiBjcmVhdGVBcnJheUluc3RydW1lbnRhdGlvbnMoKSB7XHJcbiAgICBjb25zdCBpbnN0cnVtZW50YXRpb25zID0ge307XHJcbiAgICBbJ2luY2x1ZGVzJywgJ2luZGV4T2YnLCAnbGFzdEluZGV4T2YnXS5mb3JFYWNoKGtleSA9PiB7XHJcbiAgICAgICAgaW5zdHJ1bWVudGF0aW9uc1trZXldID0gZnVuY3Rpb24gKC4uLmFyZ3MpIHtcclxuICAgICAgICAgICAgY29uc3QgYXJyID0gdG9SYXcodGhpcyk7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwLCBsID0gdGhpcy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHRyYWNrKGFyciwgXCJnZXRcIiAvKiBHRVQgKi8sIGkgKyAnJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gd2UgcnVuIHRoZSBtZXRob2QgdXNpbmcgdGhlIG9yaWdpbmFsIGFyZ3MgZmlyc3QgKHdoaWNoIG1heSBiZSByZWFjdGl2ZSlcclxuICAgICAgICAgICAgY29uc3QgcmVzID0gYXJyW2tleV0oLi4uYXJncyk7XHJcbiAgICAgICAgICAgIGlmIChyZXMgPT09IC0xIHx8IHJlcyA9PT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgICAgIC8vIGlmIHRoYXQgZGlkbid0IHdvcmssIHJ1biBpdCBhZ2FpbiB1c2luZyByYXcgdmFsdWVzLlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGFycltrZXldKC4uLmFyZ3MubWFwKHRvUmF3KSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH0pO1xyXG4gICAgWydwdXNoJywgJ3BvcCcsICdzaGlmdCcsICd1bnNoaWZ0JywgJ3NwbGljZSddLmZvckVhY2goa2V5ID0+IHtcclxuICAgICAgICBpbnN0cnVtZW50YXRpb25zW2tleV0gPSBmdW5jdGlvbiAoLi4uYXJncykge1xyXG4gICAgICAgICAgICBwYXVzZVRyYWNraW5nKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlcyA9IHRvUmF3KHRoaXMpW2tleV0uYXBwbHkodGhpcywgYXJncyk7XHJcbiAgICAgICAgICAgIHJlc2V0VHJhY2tpbmcoKTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcztcclxuICAgICAgICB9O1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gaW5zdHJ1bWVudGF0aW9ucztcclxufVxyXG5mdW5jdGlvbiBjcmVhdGVHZXR0ZXIoaXNSZWFkb25seSA9IGZhbHNlLCBzaGFsbG93ID0gZmFsc2UpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiBnZXQodGFyZ2V0LCBrZXksIHJlY2VpdmVyKSB7XHJcbiAgICAgICAgaWYgKGtleSA9PT0gXCJfX3ZfaXNSZWFjdGl2ZVwiIC8qIElTX1JFQUNUSVZFICovKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAhaXNSZWFkb25seTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoa2V5ID09PSBcIl9fdl9pc1JlYWRvbmx5XCIgLyogSVNfUkVBRE9OTFkgKi8pIHtcclxuICAgICAgICAgICAgcmV0dXJuIGlzUmVhZG9ubHk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGtleSA9PT0gXCJfX3ZfaXNTaGFsbG93XCIgLyogSVNfU0hBTExPVyAqLykge1xyXG4gICAgICAgICAgICByZXR1cm4gc2hhbGxvdztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoa2V5ID09PSBcIl9fdl9yYXdcIiAvKiBSQVcgKi8gJiZcclxuICAgICAgICAgICAgcmVjZWl2ZXIgPT09XHJcbiAgICAgICAgICAgICAgICAoaXNSZWFkb25seVxyXG4gICAgICAgICAgICAgICAgICAgID8gc2hhbGxvd1xyXG4gICAgICAgICAgICAgICAgICAgICAgICA/IHNoYWxsb3dSZWFkb25seU1hcFxyXG4gICAgICAgICAgICAgICAgICAgICAgICA6IHJlYWRvbmx5TWFwXHJcbiAgICAgICAgICAgICAgICAgICAgOiBzaGFsbG93XHJcbiAgICAgICAgICAgICAgICAgICAgICAgID8gc2hhbGxvd1JlYWN0aXZlTWFwXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDogcmVhY3RpdmVNYXApLmdldCh0YXJnZXQpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0YXJnZXQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHRhcmdldElzQXJyYXkgPSBpc0FycmF5KHRhcmdldCk7XHJcbiAgICAgICAgaWYgKCFpc1JlYWRvbmx5ICYmIHRhcmdldElzQXJyYXkgJiYgaGFzT3duKGFycmF5SW5zdHJ1bWVudGF0aW9ucywga2V5KSkge1xyXG4gICAgICAgICAgICByZXR1cm4gUmVmbGVjdC5nZXQoYXJyYXlJbnN0cnVtZW50YXRpb25zLCBrZXksIHJlY2VpdmVyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgcmVzID0gUmVmbGVjdC5nZXQodGFyZ2V0LCBrZXksIHJlY2VpdmVyKTtcclxuICAgICAgICBpZiAoaXNTeW1ib2woa2V5KSA/IGJ1aWx0SW5TeW1ib2xzLmhhcyhrZXkpIDogaXNOb25UcmFja2FibGVLZXlzKGtleSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCFpc1JlYWRvbmx5KSB7XHJcbiAgICAgICAgICAgIHRyYWNrKHRhcmdldCwgXCJnZXRcIiAvKiBHRVQgKi8sIGtleSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChzaGFsbG93KSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChpc1JlZihyZXMpKSB7XHJcbiAgICAgICAgICAgIC8vIHJlZiB1bndyYXBwaW5nIC0gZG9lcyBub3QgYXBwbHkgZm9yIEFycmF5ICsgaW50ZWdlciBrZXkuXHJcbiAgICAgICAgICAgIGNvbnN0IHNob3VsZFVud3JhcCA9ICF0YXJnZXRJc0FycmF5IHx8ICFpc0ludGVnZXJLZXkoa2V5KTtcclxuICAgICAgICAgICAgcmV0dXJuIHNob3VsZFVud3JhcCA/IHJlcy52YWx1ZSA6IHJlcztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGlzT2JqZWN0KHJlcykpIHtcclxuICAgICAgICAgICAgLy8gQ29udmVydCByZXR1cm5lZCB2YWx1ZSBpbnRvIGEgcHJveHkgYXMgd2VsbC4gd2UgZG8gdGhlIGlzT2JqZWN0IGNoZWNrXHJcbiAgICAgICAgICAgIC8vIGhlcmUgdG8gYXZvaWQgaW52YWxpZCB2YWx1ZSB3YXJuaW5nLiBBbHNvIG5lZWQgdG8gbGF6eSBhY2Nlc3MgcmVhZG9ubHlcclxuICAgICAgICAgICAgLy8gYW5kIHJlYWN0aXZlIGhlcmUgdG8gYXZvaWQgY2lyY3VsYXIgZGVwZW5kZW5jeS5cclxuICAgICAgICAgICAgcmV0dXJuIGlzUmVhZG9ubHkgPyByZWFkb25seShyZXMpIDogcmVhY3RpdmUocmVzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlcztcclxuICAgIH07XHJcbn1cclxuY29uc3Qgc2V0ID0gLyojX19QVVJFX18qLyBjcmVhdGVTZXR0ZXIoKTtcclxuY29uc3Qgc2hhbGxvd1NldCA9IC8qI19fUFVSRV9fKi8gY3JlYXRlU2V0dGVyKHRydWUpO1xyXG5mdW5jdGlvbiBjcmVhdGVTZXR0ZXIoc2hhbGxvdyA9IGZhbHNlKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gc2V0KHRhcmdldCwga2V5LCB2YWx1ZSwgcmVjZWl2ZXIpIHtcclxuICAgICAgICBsZXQgb2xkVmFsdWUgPSB0YXJnZXRba2V5XTtcclxuICAgICAgICBpZiAoaXNSZWFkb25seShvbGRWYWx1ZSkgJiYgaXNSZWYob2xkVmFsdWUpICYmICFpc1JlZih2YWx1ZSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXNoYWxsb3cgJiYgIWlzUmVhZG9ubHkodmFsdWUpKSB7XHJcbiAgICAgICAgICAgIGlmICghaXNTaGFsbG93KHZhbHVlKSkge1xyXG4gICAgICAgICAgICAgICAgdmFsdWUgPSB0b1Jhdyh2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICBvbGRWYWx1ZSA9IHRvUmF3KG9sZFZhbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoIWlzQXJyYXkodGFyZ2V0KSAmJiBpc1JlZihvbGRWYWx1ZSkgJiYgIWlzUmVmKHZhbHVlKSkge1xyXG4gICAgICAgICAgICAgICAgb2xkVmFsdWUudmFsdWUgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGhhZEtleSA9IGlzQXJyYXkodGFyZ2V0KSAmJiBpc0ludGVnZXJLZXkoa2V5KVxyXG4gICAgICAgICAgICA/IE51bWJlcihrZXkpIDwgdGFyZ2V0Lmxlbmd0aFxyXG4gICAgICAgICAgICA6IGhhc093bih0YXJnZXQsIGtleSk7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gUmVmbGVjdC5zZXQodGFyZ2V0LCBrZXksIHZhbHVlLCByZWNlaXZlcik7XHJcbiAgICAgICAgLy8gZG9uJ3QgdHJpZ2dlciBpZiB0YXJnZXQgaXMgc29tZXRoaW5nIHVwIGluIHRoZSBwcm90b3R5cGUgY2hhaW4gb2Ygb3JpZ2luYWxcclxuICAgICAgICBpZiAodGFyZ2V0ID09PSB0b1JhdyhyZWNlaXZlcikpIHtcclxuICAgICAgICAgICAgaWYgKCFoYWRLZXkpIHtcclxuICAgICAgICAgICAgICAgIHRyaWdnZXIodGFyZ2V0LCBcImFkZFwiIC8qIEFERCAqLywga2V5LCB2YWx1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoaGFzQ2hhbmdlZCh2YWx1ZSwgb2xkVmFsdWUpKSB7XHJcbiAgICAgICAgICAgICAgICB0cmlnZ2VyKHRhcmdldCwgXCJzZXRcIiAvKiBTRVQgKi8sIGtleSwgdmFsdWUsIG9sZFZhbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfTtcclxufVxyXG5mdW5jdGlvbiBkZWxldGVQcm9wZXJ0eSh0YXJnZXQsIGtleSkge1xyXG4gICAgY29uc3QgaGFkS2V5ID0gaGFzT3duKHRhcmdldCwga2V5KTtcclxuICAgIGNvbnN0IG9sZFZhbHVlID0gdGFyZ2V0W2tleV07XHJcbiAgICBjb25zdCByZXN1bHQgPSBSZWZsZWN0LmRlbGV0ZVByb3BlcnR5KHRhcmdldCwga2V5KTtcclxuICAgIGlmIChyZXN1bHQgJiYgaGFkS2V5KSB7XHJcbiAgICAgICAgdHJpZ2dlcih0YXJnZXQsIFwiZGVsZXRlXCIgLyogREVMRVRFICovLCBrZXksIHVuZGVmaW5lZCwgb2xkVmFsdWUpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG5mdW5jdGlvbiBoYXModGFyZ2V0LCBrZXkpIHtcclxuICAgIGNvbnN0IHJlc3VsdCA9IFJlZmxlY3QuaGFzKHRhcmdldCwga2V5KTtcclxuICAgIGlmICghaXNTeW1ib2woa2V5KSB8fCAhYnVpbHRJblN5bWJvbHMuaGFzKGtleSkpIHtcclxuICAgICAgICB0cmFjayh0YXJnZXQsIFwiaGFzXCIgLyogSEFTICovLCBrZXkpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG5mdW5jdGlvbiBvd25LZXlzKHRhcmdldCkge1xyXG4gICAgdHJhY2sodGFyZ2V0LCBcIml0ZXJhdGVcIiAvKiBJVEVSQVRFICovLCBpc0FycmF5KHRhcmdldCkgPyAnbGVuZ3RoJyA6IElURVJBVEVfS0VZKTtcclxuICAgIHJldHVybiBSZWZsZWN0Lm93bktleXModGFyZ2V0KTtcclxufVxyXG5jb25zdCBtdXRhYmxlSGFuZGxlcnMgPSB7XHJcbiAgICBnZXQsXHJcbiAgICBzZXQsXHJcbiAgICBkZWxldGVQcm9wZXJ0eSxcclxuICAgIGhhcyxcclxuICAgIG93bktleXNcclxufTtcclxuY29uc3QgcmVhZG9ubHlIYW5kbGVycyA9IHtcclxuICAgIGdldDogcmVhZG9ubHlHZXQsXHJcbiAgICBzZXQodGFyZ2V0LCBrZXkpIHtcclxuICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihgU2V0IG9wZXJhdGlvbiBvbiBrZXkgXCIke1N0cmluZyhrZXkpfVwiIGZhaWxlZDogdGFyZ2V0IGlzIHJlYWRvbmx5LmAsIHRhcmdldCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfSxcclxuICAgIGRlbGV0ZVByb3BlcnR5KHRhcmdldCwga2V5KSB7XHJcbiAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLndhcm4oYERlbGV0ZSBvcGVyYXRpb24gb24ga2V5IFwiJHtTdHJpbmcoa2V5KX1cIiBmYWlsZWQ6IHRhcmdldCBpcyByZWFkb25seS5gLCB0YXJnZXQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxufTtcclxuY29uc3Qgc2hhbGxvd1JlYWN0aXZlSGFuZGxlcnMgPSAvKiNfX1BVUkVfXyovIGV4dGVuZCh7fSwgbXV0YWJsZUhhbmRsZXJzLCB7XHJcbiAgICBnZXQ6IHNoYWxsb3dHZXQsXHJcbiAgICBzZXQ6IHNoYWxsb3dTZXRcclxufSk7XHJcbi8vIFByb3BzIGhhbmRsZXJzIGFyZSBzcGVjaWFsIGluIHRoZSBzZW5zZSB0aGF0IGl0IHNob3VsZCBub3QgdW53cmFwIHRvcC1sZXZlbFxyXG4vLyByZWZzIChpbiBvcmRlciB0byBhbGxvdyByZWZzIHRvIGJlIGV4cGxpY2l0bHkgcGFzc2VkIGRvd24pLCBidXQgc2hvdWxkXHJcbi8vIHJldGFpbiB0aGUgcmVhY3Rpdml0eSBvZiB0aGUgbm9ybWFsIHJlYWRvbmx5IG9iamVjdC5cclxuY29uc3Qgc2hhbGxvd1JlYWRvbmx5SGFuZGxlcnMgPSAvKiNfX1BVUkVfXyovIGV4dGVuZCh7fSwgcmVhZG9ubHlIYW5kbGVycywge1xyXG4gICAgZ2V0OiBzaGFsbG93UmVhZG9ubHlHZXRcclxufSk7XG5cbmNvbnN0IHRvU2hhbGxvdyA9ICh2YWx1ZSkgPT4gdmFsdWU7XHJcbmNvbnN0IGdldFByb3RvID0gKHYpID0+IFJlZmxlY3QuZ2V0UHJvdG90eXBlT2Yodik7XHJcbmZ1bmN0aW9uIGdldCQxKHRhcmdldCwga2V5LCBpc1JlYWRvbmx5ID0gZmFsc2UsIGlzU2hhbGxvdyA9IGZhbHNlKSB7XHJcbiAgICAvLyAjMTc3MjogcmVhZG9ubHkocmVhY3RpdmUoTWFwKSkgc2hvdWxkIHJldHVybiByZWFkb25seSArIHJlYWN0aXZlIHZlcnNpb25cclxuICAgIC8vIG9mIHRoZSB2YWx1ZVxyXG4gICAgdGFyZ2V0ID0gdGFyZ2V0W1wiX192X3Jhd1wiIC8qIFJBVyAqL107XHJcbiAgICBjb25zdCByYXdUYXJnZXQgPSB0b1Jhdyh0YXJnZXQpO1xyXG4gICAgY29uc3QgcmF3S2V5ID0gdG9SYXcoa2V5KTtcclxuICAgIGlmIChrZXkgIT09IHJhd0tleSkge1xyXG4gICAgICAgICFpc1JlYWRvbmx5ICYmIHRyYWNrKHJhd1RhcmdldCwgXCJnZXRcIiAvKiBHRVQgKi8sIGtleSk7XHJcbiAgICB9XHJcbiAgICAhaXNSZWFkb25seSAmJiB0cmFjayhyYXdUYXJnZXQsIFwiZ2V0XCIgLyogR0VUICovLCByYXdLZXkpO1xyXG4gICAgY29uc3QgeyBoYXMgfSA9IGdldFByb3RvKHJhd1RhcmdldCk7XHJcbiAgICBjb25zdCB3cmFwID0gaXNTaGFsbG93ID8gdG9TaGFsbG93IDogaXNSZWFkb25seSA/IHRvUmVhZG9ubHkgOiB0b1JlYWN0aXZlO1xyXG4gICAgaWYgKGhhcy5jYWxsKHJhd1RhcmdldCwga2V5KSkge1xyXG4gICAgICAgIHJldHVybiB3cmFwKHRhcmdldC5nZXQoa2V5KSk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChoYXMuY2FsbChyYXdUYXJnZXQsIHJhd0tleSkpIHtcclxuICAgICAgICByZXR1cm4gd3JhcCh0YXJnZXQuZ2V0KHJhd0tleSkpO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAodGFyZ2V0ICE9PSByYXdUYXJnZXQpIHtcclxuICAgICAgICAvLyAjMzYwMiByZWFkb25seShyZWFjdGl2ZShNYXApKVxyXG4gICAgICAgIC8vIGVuc3VyZSB0aGF0IHRoZSBuZXN0ZWQgcmVhY3RpdmUgYE1hcGAgY2FuIGRvIHRyYWNraW5nIGZvciBpdHNlbGZcclxuICAgICAgICB0YXJnZXQuZ2V0KGtleSk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gaGFzJDEoa2V5LCBpc1JlYWRvbmx5ID0gZmFsc2UpIHtcclxuICAgIGNvbnN0IHRhcmdldCA9IHRoaXNbXCJfX3ZfcmF3XCIgLyogUkFXICovXTtcclxuICAgIGNvbnN0IHJhd1RhcmdldCA9IHRvUmF3KHRhcmdldCk7XHJcbiAgICBjb25zdCByYXdLZXkgPSB0b1JhdyhrZXkpO1xyXG4gICAgaWYgKGtleSAhPT0gcmF3S2V5KSB7XHJcbiAgICAgICAgIWlzUmVhZG9ubHkgJiYgdHJhY2socmF3VGFyZ2V0LCBcImhhc1wiIC8qIEhBUyAqLywga2V5KTtcclxuICAgIH1cclxuICAgICFpc1JlYWRvbmx5ICYmIHRyYWNrKHJhd1RhcmdldCwgXCJoYXNcIiAvKiBIQVMgKi8sIHJhd0tleSk7XHJcbiAgICByZXR1cm4ga2V5ID09PSByYXdLZXlcclxuICAgICAgICA/IHRhcmdldC5oYXMoa2V5KVxyXG4gICAgICAgIDogdGFyZ2V0LmhhcyhrZXkpIHx8IHRhcmdldC5oYXMocmF3S2V5KTtcclxufVxyXG5mdW5jdGlvbiBzaXplKHRhcmdldCwgaXNSZWFkb25seSA9IGZhbHNlKSB7XHJcbiAgICB0YXJnZXQgPSB0YXJnZXRbXCJfX3ZfcmF3XCIgLyogUkFXICovXTtcclxuICAgICFpc1JlYWRvbmx5ICYmIHRyYWNrKHRvUmF3KHRhcmdldCksIFwiaXRlcmF0ZVwiIC8qIElURVJBVEUgKi8sIElURVJBVEVfS0VZKTtcclxuICAgIHJldHVybiBSZWZsZWN0LmdldCh0YXJnZXQsICdzaXplJywgdGFyZ2V0KTtcclxufVxyXG5mdW5jdGlvbiBhZGQodmFsdWUpIHtcclxuICAgIHZhbHVlID0gdG9SYXcodmFsdWUpO1xyXG4gICAgY29uc3QgdGFyZ2V0ID0gdG9SYXcodGhpcyk7XHJcbiAgICBjb25zdCBwcm90byA9IGdldFByb3RvKHRhcmdldCk7XHJcbiAgICBjb25zdCBoYWRLZXkgPSBwcm90by5oYXMuY2FsbCh0YXJnZXQsIHZhbHVlKTtcclxuICAgIGlmICghaGFkS2V5KSB7XHJcbiAgICAgICAgdGFyZ2V0LmFkZCh2YWx1ZSk7XHJcbiAgICAgICAgdHJpZ2dlcih0YXJnZXQsIFwiYWRkXCIgLyogQUREICovLCB2YWx1ZSwgdmFsdWUpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRoaXM7XHJcbn1cclxuZnVuY3Rpb24gc2V0JDEoa2V5LCB2YWx1ZSkge1xyXG4gICAgdmFsdWUgPSB0b1Jhdyh2YWx1ZSk7XHJcbiAgICBjb25zdCB0YXJnZXQgPSB0b1Jhdyh0aGlzKTtcclxuICAgIGNvbnN0IHsgaGFzLCBnZXQgfSA9IGdldFByb3RvKHRhcmdldCk7XHJcbiAgICBsZXQgaGFkS2V5ID0gaGFzLmNhbGwodGFyZ2V0LCBrZXkpO1xyXG4gICAgaWYgKCFoYWRLZXkpIHtcclxuICAgICAgICBrZXkgPSB0b1JhdyhrZXkpO1xyXG4gICAgICAgIGhhZEtleSA9IGhhcy5jYWxsKHRhcmdldCwga2V5KTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgIGNoZWNrSWRlbnRpdHlLZXlzKHRhcmdldCwgaGFzLCBrZXkpO1xyXG4gICAgfVxyXG4gICAgY29uc3Qgb2xkVmFsdWUgPSBnZXQuY2FsbCh0YXJnZXQsIGtleSk7XHJcbiAgICB0YXJnZXQuc2V0KGtleSwgdmFsdWUpO1xyXG4gICAgaWYgKCFoYWRLZXkpIHtcclxuICAgICAgICB0cmlnZ2VyKHRhcmdldCwgXCJhZGRcIiAvKiBBREQgKi8sIGtleSwgdmFsdWUpO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoaGFzQ2hhbmdlZCh2YWx1ZSwgb2xkVmFsdWUpKSB7XHJcbiAgICAgICAgdHJpZ2dlcih0YXJnZXQsIFwic2V0XCIgLyogU0VUICovLCBrZXksIHZhbHVlLCBvbGRWYWx1ZSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGhpcztcclxufVxyXG5mdW5jdGlvbiBkZWxldGVFbnRyeShrZXkpIHtcclxuICAgIGNvbnN0IHRhcmdldCA9IHRvUmF3KHRoaXMpO1xyXG4gICAgY29uc3QgeyBoYXMsIGdldCB9ID0gZ2V0UHJvdG8odGFyZ2V0KTtcclxuICAgIGxldCBoYWRLZXkgPSBoYXMuY2FsbCh0YXJnZXQsIGtleSk7XHJcbiAgICBpZiAoIWhhZEtleSkge1xyXG4gICAgICAgIGtleSA9IHRvUmF3KGtleSk7XHJcbiAgICAgICAgaGFkS2V5ID0gaGFzLmNhbGwodGFyZ2V0LCBrZXkpO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgY2hlY2tJZGVudGl0eUtleXModGFyZ2V0LCBoYXMsIGtleSk7XHJcbiAgICB9XHJcbiAgICBjb25zdCBvbGRWYWx1ZSA9IGdldCA/IGdldC5jYWxsKHRhcmdldCwga2V5KSA6IHVuZGVmaW5lZDtcclxuICAgIC8vIGZvcndhcmQgdGhlIG9wZXJhdGlvbiBiZWZvcmUgcXVldWVpbmcgcmVhY3Rpb25zXHJcbiAgICBjb25zdCByZXN1bHQgPSB0YXJnZXQuZGVsZXRlKGtleSk7XHJcbiAgICBpZiAoaGFkS2V5KSB7XHJcbiAgICAgICAgdHJpZ2dlcih0YXJnZXQsIFwiZGVsZXRlXCIgLyogREVMRVRFICovLCBrZXksIHVuZGVmaW5lZCwgb2xkVmFsdWUpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG5mdW5jdGlvbiBjbGVhcigpIHtcclxuICAgIGNvbnN0IHRhcmdldCA9IHRvUmF3KHRoaXMpO1xyXG4gICAgY29uc3QgaGFkSXRlbXMgPSB0YXJnZXQuc2l6ZSAhPT0gMDtcclxuICAgIGNvbnN0IG9sZFRhcmdldCA9IChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKVxyXG4gICAgICAgID8gaXNNYXAodGFyZ2V0KVxyXG4gICAgICAgICAgICA/IG5ldyBNYXAodGFyZ2V0KVxyXG4gICAgICAgICAgICA6IG5ldyBTZXQodGFyZ2V0KVxyXG4gICAgICAgIDogdW5kZWZpbmVkO1xyXG4gICAgLy8gZm9yd2FyZCB0aGUgb3BlcmF0aW9uIGJlZm9yZSBxdWV1ZWluZyByZWFjdGlvbnNcclxuICAgIGNvbnN0IHJlc3VsdCA9IHRhcmdldC5jbGVhcigpO1xyXG4gICAgaWYgKGhhZEl0ZW1zKSB7XHJcbiAgICAgICAgdHJpZ2dlcih0YXJnZXQsIFwiY2xlYXJcIiAvKiBDTEVBUiAqLywgdW5kZWZpbmVkLCB1bmRlZmluZWQsIG9sZFRhcmdldCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcbmZ1bmN0aW9uIGNyZWF0ZUZvckVhY2goaXNSZWFkb25seSwgaXNTaGFsbG93KSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gZm9yRWFjaChjYWxsYmFjaywgdGhpc0FyZykge1xyXG4gICAgICAgIGNvbnN0IG9ic2VydmVkID0gdGhpcztcclxuICAgICAgICBjb25zdCB0YXJnZXQgPSBvYnNlcnZlZFtcIl9fdl9yYXdcIiAvKiBSQVcgKi9dO1xyXG4gICAgICAgIGNvbnN0IHJhd1RhcmdldCA9IHRvUmF3KHRhcmdldCk7XHJcbiAgICAgICAgY29uc3Qgd3JhcCA9IGlzU2hhbGxvdyA/IHRvU2hhbGxvdyA6IGlzUmVhZG9ubHkgPyB0b1JlYWRvbmx5IDogdG9SZWFjdGl2ZTtcclxuICAgICAgICAhaXNSZWFkb25seSAmJiB0cmFjayhyYXdUYXJnZXQsIFwiaXRlcmF0ZVwiIC8qIElURVJBVEUgKi8sIElURVJBVEVfS0VZKTtcclxuICAgICAgICByZXR1cm4gdGFyZ2V0LmZvckVhY2goKHZhbHVlLCBrZXkpID0+IHtcclxuICAgICAgICAgICAgLy8gaW1wb3J0YW50OiBtYWtlIHN1cmUgdGhlIGNhbGxiYWNrIGlzXHJcbiAgICAgICAgICAgIC8vIDEuIGludm9rZWQgd2l0aCB0aGUgcmVhY3RpdmUgbWFwIGFzIGB0aGlzYCBhbmQgM3JkIGFyZ1xyXG4gICAgICAgICAgICAvLyAyLiB0aGUgdmFsdWUgcmVjZWl2ZWQgc2hvdWxkIGJlIGEgY29ycmVzcG9uZGluZyByZWFjdGl2ZS9yZWFkb25seS5cclxuICAgICAgICAgICAgcmV0dXJuIGNhbGxiYWNrLmNhbGwodGhpc0FyZywgd3JhcCh2YWx1ZSksIHdyYXAoa2V5KSwgb2JzZXJ2ZWQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxufVxyXG5mdW5jdGlvbiBjcmVhdGVJdGVyYWJsZU1ldGhvZChtZXRob2QsIGlzUmVhZG9ubHksIGlzU2hhbGxvdykge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uICguLi5hcmdzKSB7XHJcbiAgICAgICAgY29uc3QgdGFyZ2V0ID0gdGhpc1tcIl9fdl9yYXdcIiAvKiBSQVcgKi9dO1xyXG4gICAgICAgIGNvbnN0IHJhd1RhcmdldCA9IHRvUmF3KHRhcmdldCk7XHJcbiAgICAgICAgY29uc3QgdGFyZ2V0SXNNYXAgPSBpc01hcChyYXdUYXJnZXQpO1xyXG4gICAgICAgIGNvbnN0IGlzUGFpciA9IG1ldGhvZCA9PT0gJ2VudHJpZXMnIHx8IChtZXRob2QgPT09IFN5bWJvbC5pdGVyYXRvciAmJiB0YXJnZXRJc01hcCk7XHJcbiAgICAgICAgY29uc3QgaXNLZXlPbmx5ID0gbWV0aG9kID09PSAna2V5cycgJiYgdGFyZ2V0SXNNYXA7XHJcbiAgICAgICAgY29uc3QgaW5uZXJJdGVyYXRvciA9IHRhcmdldFttZXRob2RdKC4uLmFyZ3MpO1xyXG4gICAgICAgIGNvbnN0IHdyYXAgPSBpc1NoYWxsb3cgPyB0b1NoYWxsb3cgOiBpc1JlYWRvbmx5ID8gdG9SZWFkb25seSA6IHRvUmVhY3RpdmU7XHJcbiAgICAgICAgIWlzUmVhZG9ubHkgJiZcclxuICAgICAgICAgICAgdHJhY2socmF3VGFyZ2V0LCBcIml0ZXJhdGVcIiAvKiBJVEVSQVRFICovLCBpc0tleU9ubHkgPyBNQVBfS0VZX0lURVJBVEVfS0VZIDogSVRFUkFURV9LRVkpO1xyXG4gICAgICAgIC8vIHJldHVybiBhIHdyYXBwZWQgaXRlcmF0b3Igd2hpY2ggcmV0dXJucyBvYnNlcnZlZCB2ZXJzaW9ucyBvZiB0aGVcclxuICAgICAgICAvLyB2YWx1ZXMgZW1pdHRlZCBmcm9tIHRoZSByZWFsIGl0ZXJhdG9yXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgLy8gaXRlcmF0b3IgcHJvdG9jb2xcclxuICAgICAgICAgICAgbmV4dCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHsgdmFsdWUsIGRvbmUgfSA9IGlubmVySXRlcmF0b3IubmV4dCgpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRvbmVcclxuICAgICAgICAgICAgICAgICAgICA/IHsgdmFsdWUsIGRvbmUgfVxyXG4gICAgICAgICAgICAgICAgICAgIDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogaXNQYWlyID8gW3dyYXAodmFsdWVbMF0pLCB3cmFwKHZhbHVlWzFdKV0gOiB3cmFwKHZhbHVlKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZG9uZVxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIC8vIGl0ZXJhYmxlIHByb3RvY29sXHJcbiAgICAgICAgICAgIFtTeW1ib2wuaXRlcmF0b3JdKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfTtcclxufVxyXG5mdW5jdGlvbiBjcmVhdGVSZWFkb25seU1ldGhvZCh0eXBlKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKC4uLmFyZ3MpIHtcclxuICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGtleSA9IGFyZ3NbMF0gPyBgb24ga2V5IFwiJHthcmdzWzBdfVwiIGAgOiBgYDtcclxuICAgICAgICAgICAgY29uc29sZS53YXJuKGAke2NhcGl0YWxpemUodHlwZSl9IG9wZXJhdGlvbiAke2tleX1mYWlsZWQ6IHRhcmdldCBpcyByZWFkb25seS5gLCB0b1Jhdyh0aGlzKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0eXBlID09PSBcImRlbGV0ZVwiIC8qIERFTEVURSAqLyA/IGZhbHNlIDogdGhpcztcclxuICAgIH07XHJcbn1cclxuZnVuY3Rpb24gY3JlYXRlSW5zdHJ1bWVudGF0aW9ucygpIHtcclxuICAgIGNvbnN0IG11dGFibGVJbnN0cnVtZW50YXRpb25zID0ge1xyXG4gICAgICAgIGdldChrZXkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGdldCQxKHRoaXMsIGtleSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBnZXQgc2l6ZSgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHNpemUodGhpcyk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBoYXM6IGhhcyQxLFxyXG4gICAgICAgIGFkZCxcclxuICAgICAgICBzZXQ6IHNldCQxLFxyXG4gICAgICAgIGRlbGV0ZTogZGVsZXRlRW50cnksXHJcbiAgICAgICAgY2xlYXIsXHJcbiAgICAgICAgZm9yRWFjaDogY3JlYXRlRm9yRWFjaChmYWxzZSwgZmFsc2UpXHJcbiAgICB9O1xyXG4gICAgY29uc3Qgc2hhbGxvd0luc3RydW1lbnRhdGlvbnMgPSB7XHJcbiAgICAgICAgZ2V0KGtleSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZ2V0JDEodGhpcywga2V5LCBmYWxzZSwgdHJ1ZSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBnZXQgc2l6ZSgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHNpemUodGhpcyk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBoYXM6IGhhcyQxLFxyXG4gICAgICAgIGFkZCxcclxuICAgICAgICBzZXQ6IHNldCQxLFxyXG4gICAgICAgIGRlbGV0ZTogZGVsZXRlRW50cnksXHJcbiAgICAgICAgY2xlYXIsXHJcbiAgICAgICAgZm9yRWFjaDogY3JlYXRlRm9yRWFjaChmYWxzZSwgdHJ1ZSlcclxuICAgIH07XHJcbiAgICBjb25zdCByZWFkb25seUluc3RydW1lbnRhdGlvbnMgPSB7XHJcbiAgICAgICAgZ2V0KGtleSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZ2V0JDEodGhpcywga2V5LCB0cnVlKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGdldCBzaXplKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gc2l6ZSh0aGlzLCB0cnVlKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGhhcyhrZXkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGhhcyQxLmNhbGwodGhpcywga2V5LCB0cnVlKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGFkZDogY3JlYXRlUmVhZG9ubHlNZXRob2QoXCJhZGRcIiAvKiBBREQgKi8pLFxyXG4gICAgICAgIHNldDogY3JlYXRlUmVhZG9ubHlNZXRob2QoXCJzZXRcIiAvKiBTRVQgKi8pLFxyXG4gICAgICAgIGRlbGV0ZTogY3JlYXRlUmVhZG9ubHlNZXRob2QoXCJkZWxldGVcIiAvKiBERUxFVEUgKi8pLFxyXG4gICAgICAgIGNsZWFyOiBjcmVhdGVSZWFkb25seU1ldGhvZChcImNsZWFyXCIgLyogQ0xFQVIgKi8pLFxyXG4gICAgICAgIGZvckVhY2g6IGNyZWF0ZUZvckVhY2godHJ1ZSwgZmFsc2UpXHJcbiAgICB9O1xyXG4gICAgY29uc3Qgc2hhbGxvd1JlYWRvbmx5SW5zdHJ1bWVudGF0aW9ucyA9IHtcclxuICAgICAgICBnZXQoa2V5KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBnZXQkMSh0aGlzLCBrZXksIHRydWUsIHRydWUpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZ2V0IHNpemUoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBzaXplKHRoaXMsIHRydWUpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgaGFzKGtleSkge1xyXG4gICAgICAgICAgICByZXR1cm4gaGFzJDEuY2FsbCh0aGlzLCBrZXksIHRydWUpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgYWRkOiBjcmVhdGVSZWFkb25seU1ldGhvZChcImFkZFwiIC8qIEFERCAqLyksXHJcbiAgICAgICAgc2V0OiBjcmVhdGVSZWFkb25seU1ldGhvZChcInNldFwiIC8qIFNFVCAqLyksXHJcbiAgICAgICAgZGVsZXRlOiBjcmVhdGVSZWFkb25seU1ldGhvZChcImRlbGV0ZVwiIC8qIERFTEVURSAqLyksXHJcbiAgICAgICAgY2xlYXI6IGNyZWF0ZVJlYWRvbmx5TWV0aG9kKFwiY2xlYXJcIiAvKiBDTEVBUiAqLyksXHJcbiAgICAgICAgZm9yRWFjaDogY3JlYXRlRm9yRWFjaCh0cnVlLCB0cnVlKVxyXG4gICAgfTtcclxuICAgIGNvbnN0IGl0ZXJhdG9yTWV0aG9kcyA9IFsna2V5cycsICd2YWx1ZXMnLCAnZW50cmllcycsIFN5bWJvbC5pdGVyYXRvcl07XHJcbiAgICBpdGVyYXRvck1ldGhvZHMuZm9yRWFjaChtZXRob2QgPT4ge1xyXG4gICAgICAgIG11dGFibGVJbnN0cnVtZW50YXRpb25zW21ldGhvZF0gPSBjcmVhdGVJdGVyYWJsZU1ldGhvZChtZXRob2QsIGZhbHNlLCBmYWxzZSk7XHJcbiAgICAgICAgcmVhZG9ubHlJbnN0cnVtZW50YXRpb25zW21ldGhvZF0gPSBjcmVhdGVJdGVyYWJsZU1ldGhvZChtZXRob2QsIHRydWUsIGZhbHNlKTtcclxuICAgICAgICBzaGFsbG93SW5zdHJ1bWVudGF0aW9uc1ttZXRob2RdID0gY3JlYXRlSXRlcmFibGVNZXRob2QobWV0aG9kLCBmYWxzZSwgdHJ1ZSk7XHJcbiAgICAgICAgc2hhbGxvd1JlYWRvbmx5SW5zdHJ1bWVudGF0aW9uc1ttZXRob2RdID0gY3JlYXRlSXRlcmFibGVNZXRob2QobWV0aG9kLCB0cnVlLCB0cnVlKTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIFtcclxuICAgICAgICBtdXRhYmxlSW5zdHJ1bWVudGF0aW9ucyxcclxuICAgICAgICByZWFkb25seUluc3RydW1lbnRhdGlvbnMsXHJcbiAgICAgICAgc2hhbGxvd0luc3RydW1lbnRhdGlvbnMsXHJcbiAgICAgICAgc2hhbGxvd1JlYWRvbmx5SW5zdHJ1bWVudGF0aW9uc1xyXG4gICAgXTtcclxufVxyXG5jb25zdCBbbXV0YWJsZUluc3RydW1lbnRhdGlvbnMsIHJlYWRvbmx5SW5zdHJ1bWVudGF0aW9ucywgc2hhbGxvd0luc3RydW1lbnRhdGlvbnMsIHNoYWxsb3dSZWFkb25seUluc3RydW1lbnRhdGlvbnNdID0gLyogI19fUFVSRV9fKi8gY3JlYXRlSW5zdHJ1bWVudGF0aW9ucygpO1xyXG5mdW5jdGlvbiBjcmVhdGVJbnN0cnVtZW50YXRpb25HZXR0ZXIoaXNSZWFkb25seSwgc2hhbGxvdykge1xyXG4gICAgY29uc3QgaW5zdHJ1bWVudGF0aW9ucyA9IHNoYWxsb3dcclxuICAgICAgICA/IGlzUmVhZG9ubHlcclxuICAgICAgICAgICAgPyBzaGFsbG93UmVhZG9ubHlJbnN0cnVtZW50YXRpb25zXHJcbiAgICAgICAgICAgIDogc2hhbGxvd0luc3RydW1lbnRhdGlvbnNcclxuICAgICAgICA6IGlzUmVhZG9ubHlcclxuICAgICAgICAgICAgPyByZWFkb25seUluc3RydW1lbnRhdGlvbnNcclxuICAgICAgICAgICAgOiBtdXRhYmxlSW5zdHJ1bWVudGF0aW9ucztcclxuICAgIHJldHVybiAodGFyZ2V0LCBrZXksIHJlY2VpdmVyKSA9PiB7XHJcbiAgICAgICAgaWYgKGtleSA9PT0gXCJfX3ZfaXNSZWFjdGl2ZVwiIC8qIElTX1JFQUNUSVZFICovKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAhaXNSZWFkb25seTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoa2V5ID09PSBcIl9fdl9pc1JlYWRvbmx5XCIgLyogSVNfUkVBRE9OTFkgKi8pIHtcclxuICAgICAgICAgICAgcmV0dXJuIGlzUmVhZG9ubHk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGtleSA9PT0gXCJfX3ZfcmF3XCIgLyogUkFXICovKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0YXJnZXQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBSZWZsZWN0LmdldChoYXNPd24oaW5zdHJ1bWVudGF0aW9ucywga2V5KSAmJiBrZXkgaW4gdGFyZ2V0XHJcbiAgICAgICAgICAgID8gaW5zdHJ1bWVudGF0aW9uc1xyXG4gICAgICAgICAgICA6IHRhcmdldCwga2V5LCByZWNlaXZlcik7XHJcbiAgICB9O1xyXG59XHJcbmNvbnN0IG11dGFibGVDb2xsZWN0aW9uSGFuZGxlcnMgPSB7XHJcbiAgICBnZXQ6IC8qI19fUFVSRV9fKi8gY3JlYXRlSW5zdHJ1bWVudGF0aW9uR2V0dGVyKGZhbHNlLCBmYWxzZSlcclxufTtcclxuY29uc3Qgc2hhbGxvd0NvbGxlY3Rpb25IYW5kbGVycyA9IHtcclxuICAgIGdldDogLyojX19QVVJFX18qLyBjcmVhdGVJbnN0cnVtZW50YXRpb25HZXR0ZXIoZmFsc2UsIHRydWUpXHJcbn07XHJcbmNvbnN0IHJlYWRvbmx5Q29sbGVjdGlvbkhhbmRsZXJzID0ge1xyXG4gICAgZ2V0OiAvKiNfX1BVUkVfXyovIGNyZWF0ZUluc3RydW1lbnRhdGlvbkdldHRlcih0cnVlLCBmYWxzZSlcclxufTtcclxuY29uc3Qgc2hhbGxvd1JlYWRvbmx5Q29sbGVjdGlvbkhhbmRsZXJzID0ge1xyXG4gICAgZ2V0OiAvKiNfX1BVUkVfXyovIGNyZWF0ZUluc3RydW1lbnRhdGlvbkdldHRlcih0cnVlLCB0cnVlKVxyXG59O1xyXG5mdW5jdGlvbiBjaGVja0lkZW50aXR5S2V5cyh0YXJnZXQsIGhhcywga2V5KSB7XHJcbiAgICBjb25zdCByYXdLZXkgPSB0b1JhdyhrZXkpO1xyXG4gICAgaWYgKHJhd0tleSAhPT0ga2V5ICYmIGhhcy5jYWxsKHRhcmdldCwgcmF3S2V5KSkge1xyXG4gICAgICAgIGNvbnN0IHR5cGUgPSB0b1Jhd1R5cGUodGFyZ2V0KTtcclxuICAgICAgICBjb25zb2xlLndhcm4oYFJlYWN0aXZlICR7dHlwZX0gY29udGFpbnMgYm90aCB0aGUgcmF3IGFuZCByZWFjdGl2ZSBgICtcclxuICAgICAgICAgICAgYHZlcnNpb25zIG9mIHRoZSBzYW1lIG9iamVjdCR7dHlwZSA9PT0gYE1hcGAgPyBgIGFzIGtleXNgIDogYGB9LCBgICtcclxuICAgICAgICAgICAgYHdoaWNoIGNhbiBsZWFkIHRvIGluY29uc2lzdGVuY2llcy4gYCArXHJcbiAgICAgICAgICAgIGBBdm9pZCBkaWZmZXJlbnRpYXRpbmcgYmV0d2VlbiB0aGUgcmF3IGFuZCByZWFjdGl2ZSB2ZXJzaW9ucyBgICtcclxuICAgICAgICAgICAgYG9mIGFuIG9iamVjdCBhbmQgb25seSB1c2UgdGhlIHJlYWN0aXZlIHZlcnNpb24gaWYgcG9zc2libGUuYCk7XHJcbiAgICB9XHJcbn1cblxuY29uc3QgcmVhY3RpdmVNYXAgPSBuZXcgV2Vha01hcCgpO1xyXG5jb25zdCBzaGFsbG93UmVhY3RpdmVNYXAgPSBuZXcgV2Vha01hcCgpO1xyXG5jb25zdCByZWFkb25seU1hcCA9IG5ldyBXZWFrTWFwKCk7XHJcbmNvbnN0IHNoYWxsb3dSZWFkb25seU1hcCA9IG5ldyBXZWFrTWFwKCk7XHJcbmZ1bmN0aW9uIHRhcmdldFR5cGVNYXAocmF3VHlwZSkge1xyXG4gICAgc3dpdGNoIChyYXdUeXBlKSB7XHJcbiAgICAgICAgY2FzZSAnT2JqZWN0JzpcclxuICAgICAgICBjYXNlICdBcnJheSc6XHJcbiAgICAgICAgICAgIHJldHVybiAxIC8qIENPTU1PTiAqLztcclxuICAgICAgICBjYXNlICdNYXAnOlxyXG4gICAgICAgIGNhc2UgJ1NldCc6XHJcbiAgICAgICAgY2FzZSAnV2Vha01hcCc6XHJcbiAgICAgICAgY2FzZSAnV2Vha1NldCc6XHJcbiAgICAgICAgICAgIHJldHVybiAyIC8qIENPTExFQ1RJT04gKi87XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgcmV0dXJuIDAgLyogSU5WQUxJRCAqLztcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBnZXRUYXJnZXRUeXBlKHZhbHVlKSB7XHJcbiAgICByZXR1cm4gdmFsdWVbXCJfX3Zfc2tpcFwiIC8qIFNLSVAgKi9dIHx8ICFPYmplY3QuaXNFeHRlbnNpYmxlKHZhbHVlKVxyXG4gICAgICAgID8gMCAvKiBJTlZBTElEICovXHJcbiAgICAgICAgOiB0YXJnZXRUeXBlTWFwKHRvUmF3VHlwZSh2YWx1ZSkpO1xyXG59XHJcbmZ1bmN0aW9uIHJlYWN0aXZlKHRhcmdldCkge1xyXG4gICAgLy8gaWYgdHJ5aW5nIHRvIG9ic2VydmUgYSByZWFkb25seSBwcm94eSwgcmV0dXJuIHRoZSByZWFkb25seSB2ZXJzaW9uLlxyXG4gICAgaWYgKGlzUmVhZG9ubHkodGFyZ2V0KSkge1xyXG4gICAgICAgIHJldHVybiB0YXJnZXQ7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gY3JlYXRlUmVhY3RpdmVPYmplY3QodGFyZ2V0LCBmYWxzZSwgbXV0YWJsZUhhbmRsZXJzLCBtdXRhYmxlQ29sbGVjdGlvbkhhbmRsZXJzLCByZWFjdGl2ZU1hcCk7XHJcbn1cclxuLyoqXHJcbiAqIFJldHVybiBhIHNoYWxsb3dseS1yZWFjdGl2ZSBjb3B5IG9mIHRoZSBvcmlnaW5hbCBvYmplY3QsIHdoZXJlIG9ubHkgdGhlIHJvb3RcclxuICogbGV2ZWwgcHJvcGVydGllcyBhcmUgcmVhY3RpdmUuIEl0IGFsc28gZG9lcyBub3QgYXV0by11bndyYXAgcmVmcyAoZXZlbiBhdCB0aGVcclxuICogcm9vdCBsZXZlbCkuXHJcbiAqL1xyXG5mdW5jdGlvbiBzaGFsbG93UmVhY3RpdmUodGFyZ2V0KSB7XHJcbiAgICByZXR1cm4gY3JlYXRlUmVhY3RpdmVPYmplY3QodGFyZ2V0LCBmYWxzZSwgc2hhbGxvd1JlYWN0aXZlSGFuZGxlcnMsIHNoYWxsb3dDb2xsZWN0aW9uSGFuZGxlcnMsIHNoYWxsb3dSZWFjdGl2ZU1hcCk7XHJcbn1cclxuLyoqXHJcbiAqIENyZWF0ZXMgYSByZWFkb25seSBjb3B5IG9mIHRoZSBvcmlnaW5hbCBvYmplY3QuIE5vdGUgdGhlIHJldHVybmVkIGNvcHkgaXMgbm90XHJcbiAqIG1hZGUgcmVhY3RpdmUsIGJ1dCBgcmVhZG9ubHlgIGNhbiBiZSBjYWxsZWQgb24gYW4gYWxyZWFkeSByZWFjdGl2ZSBvYmplY3QuXHJcbiAqL1xyXG5mdW5jdGlvbiByZWFkb25seSh0YXJnZXQpIHtcclxuICAgIHJldHVybiBjcmVhdGVSZWFjdGl2ZU9iamVjdCh0YXJnZXQsIHRydWUsIHJlYWRvbmx5SGFuZGxlcnMsIHJlYWRvbmx5Q29sbGVjdGlvbkhhbmRsZXJzLCByZWFkb25seU1hcCk7XHJcbn1cclxuLyoqXHJcbiAqIFJldHVybnMgYSByZWFjdGl2ZS1jb3B5IG9mIHRoZSBvcmlnaW5hbCBvYmplY3QsIHdoZXJlIG9ubHkgdGhlIHJvb3QgbGV2ZWxcclxuICogcHJvcGVydGllcyBhcmUgcmVhZG9ubHksIGFuZCBkb2VzIE5PVCB1bndyYXAgcmVmcyBub3IgcmVjdXJzaXZlbHkgY29udmVydFxyXG4gKiByZXR1cm5lZCBwcm9wZXJ0aWVzLlxyXG4gKiBUaGlzIGlzIHVzZWQgZm9yIGNyZWF0aW5nIHRoZSBwcm9wcyBwcm94eSBvYmplY3QgZm9yIHN0YXRlZnVsIGNvbXBvbmVudHMuXHJcbiAqL1xyXG5mdW5jdGlvbiBzaGFsbG93UmVhZG9ubHkodGFyZ2V0KSB7XHJcbiAgICByZXR1cm4gY3JlYXRlUmVhY3RpdmVPYmplY3QodGFyZ2V0LCB0cnVlLCBzaGFsbG93UmVhZG9ubHlIYW5kbGVycywgc2hhbGxvd1JlYWRvbmx5Q29sbGVjdGlvbkhhbmRsZXJzLCBzaGFsbG93UmVhZG9ubHlNYXApO1xyXG59XHJcbmZ1bmN0aW9uIGNyZWF0ZVJlYWN0aXZlT2JqZWN0KHRhcmdldCwgaXNSZWFkb25seSwgYmFzZUhhbmRsZXJzLCBjb2xsZWN0aW9uSGFuZGxlcnMsIHByb3h5TWFwKSB7XHJcbiAgICBpZiAoIWlzT2JqZWN0KHRhcmdldCkpIHtcclxuICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihgdmFsdWUgY2Fubm90IGJlIG1hZGUgcmVhY3RpdmU6ICR7U3RyaW5nKHRhcmdldCl9YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0YXJnZXQ7XHJcbiAgICB9XHJcbiAgICAvLyB0YXJnZXQgaXMgYWxyZWFkeSBhIFByb3h5LCByZXR1cm4gaXQuXHJcbiAgICAvLyBleGNlcHRpb246IGNhbGxpbmcgcmVhZG9ubHkoKSBvbiBhIHJlYWN0aXZlIG9iamVjdFxyXG4gICAgaWYgKHRhcmdldFtcIl9fdl9yYXdcIiAvKiBSQVcgKi9dICYmXHJcbiAgICAgICAgIShpc1JlYWRvbmx5ICYmIHRhcmdldFtcIl9fdl9pc1JlYWN0aXZlXCIgLyogSVNfUkVBQ1RJVkUgKi9dKSkge1xyXG4gICAgICAgIHJldHVybiB0YXJnZXQ7XHJcbiAgICB9XHJcbiAgICAvLyB0YXJnZXQgYWxyZWFkeSBoYXMgY29ycmVzcG9uZGluZyBQcm94eVxyXG4gICAgY29uc3QgZXhpc3RpbmdQcm94eSA9IHByb3h5TWFwLmdldCh0YXJnZXQpO1xyXG4gICAgaWYgKGV4aXN0aW5nUHJveHkpIHtcclxuICAgICAgICByZXR1cm4gZXhpc3RpbmdQcm94eTtcclxuICAgIH1cclxuICAgIC8vIG9ubHkgYSB3aGl0ZWxpc3Qgb2YgdmFsdWUgdHlwZXMgY2FuIGJlIG9ic2VydmVkLlxyXG4gICAgY29uc3QgdGFyZ2V0VHlwZSA9IGdldFRhcmdldFR5cGUodGFyZ2V0KTtcclxuICAgIGlmICh0YXJnZXRUeXBlID09PSAwIC8qIElOVkFMSUQgKi8pIHtcclxuICAgICAgICByZXR1cm4gdGFyZ2V0O1xyXG4gICAgfVxyXG4gICAgY29uc3QgcHJveHkgPSBuZXcgUHJveHkodGFyZ2V0LCB0YXJnZXRUeXBlID09PSAyIC8qIENPTExFQ1RJT04gKi8gPyBjb2xsZWN0aW9uSGFuZGxlcnMgOiBiYXNlSGFuZGxlcnMpO1xyXG4gICAgcHJveHlNYXAuc2V0KHRhcmdldCwgcHJveHkpO1xyXG4gICAgcmV0dXJuIHByb3h5O1xyXG59XHJcbmZ1bmN0aW9uIGlzUmVhY3RpdmUodmFsdWUpIHtcclxuICAgIGlmIChpc1JlYWRvbmx5KHZhbHVlKSkge1xyXG4gICAgICAgIHJldHVybiBpc1JlYWN0aXZlKHZhbHVlW1wiX192X3Jhd1wiIC8qIFJBVyAqL10pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuICEhKHZhbHVlICYmIHZhbHVlW1wiX192X2lzUmVhY3RpdmVcIiAvKiBJU19SRUFDVElWRSAqL10pO1xyXG59XHJcbmZ1bmN0aW9uIGlzUmVhZG9ubHkodmFsdWUpIHtcclxuICAgIHJldHVybiAhISh2YWx1ZSAmJiB2YWx1ZVtcIl9fdl9pc1JlYWRvbmx5XCIgLyogSVNfUkVBRE9OTFkgKi9dKTtcclxufVxyXG5mdW5jdGlvbiBpc1NoYWxsb3codmFsdWUpIHtcclxuICAgIHJldHVybiAhISh2YWx1ZSAmJiB2YWx1ZVtcIl9fdl9pc1NoYWxsb3dcIiAvKiBJU19TSEFMTE9XICovXSk7XHJcbn1cclxuZnVuY3Rpb24gaXNQcm94eSh2YWx1ZSkge1xyXG4gICAgcmV0dXJuIGlzUmVhY3RpdmUodmFsdWUpIHx8IGlzUmVhZG9ubHkodmFsdWUpO1xyXG59XHJcbmZ1bmN0aW9uIHRvUmF3KG9ic2VydmVkKSB7XHJcbiAgICBjb25zdCByYXcgPSBvYnNlcnZlZCAmJiBvYnNlcnZlZFtcIl9fdl9yYXdcIiAvKiBSQVcgKi9dO1xyXG4gICAgcmV0dXJuIHJhdyA/IHRvUmF3KHJhdykgOiBvYnNlcnZlZDtcclxufVxyXG5mdW5jdGlvbiBtYXJrUmF3KHZhbHVlKSB7XHJcbiAgICBkZWYodmFsdWUsIFwiX192X3NraXBcIiAvKiBTS0lQICovLCB0cnVlKTtcclxuICAgIHJldHVybiB2YWx1ZTtcclxufVxyXG5jb25zdCB0b1JlYWN0aXZlID0gKHZhbHVlKSA9PiBpc09iamVjdCh2YWx1ZSkgPyByZWFjdGl2ZSh2YWx1ZSkgOiB2YWx1ZTtcclxuY29uc3QgdG9SZWFkb25seSA9ICh2YWx1ZSkgPT4gaXNPYmplY3QodmFsdWUpID8gcmVhZG9ubHkodmFsdWUpIDogdmFsdWU7XG5cbmZ1bmN0aW9uIHRyYWNrUmVmVmFsdWUocmVmKSB7XHJcbiAgICBpZiAoc2hvdWxkVHJhY2sgJiYgYWN0aXZlRWZmZWN0KSB7XHJcbiAgICAgICAgcmVmID0gdG9SYXcocmVmKTtcclxuICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgIHRyYWNrRWZmZWN0cyhyZWYuZGVwIHx8IChyZWYuZGVwID0gY3JlYXRlRGVwKCkpLCB7XHJcbiAgICAgICAgICAgICAgICB0YXJnZXQ6IHJlZixcclxuICAgICAgICAgICAgICAgIHR5cGU6IFwiZ2V0XCIgLyogR0VUICovLFxyXG4gICAgICAgICAgICAgICAga2V5OiAndmFsdWUnXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdHJhY2tFZmZlY3RzKHJlZi5kZXAgfHwgKHJlZi5kZXAgPSBjcmVhdGVEZXAoKSkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiB0cmlnZ2VyUmVmVmFsdWUocmVmLCBuZXdWYWwpIHtcclxuICAgIHJlZiA9IHRvUmF3KHJlZik7XHJcbiAgICBpZiAocmVmLmRlcCkge1xyXG4gICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgdHJpZ2dlckVmZmVjdHMocmVmLmRlcCwge1xyXG4gICAgICAgICAgICAgICAgdGFyZ2V0OiByZWYsXHJcbiAgICAgICAgICAgICAgICB0eXBlOiBcInNldFwiIC8qIFNFVCAqLyxcclxuICAgICAgICAgICAgICAgIGtleTogJ3ZhbHVlJyxcclxuICAgICAgICAgICAgICAgIG5ld1ZhbHVlOiBuZXdWYWxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0cmlnZ2VyRWZmZWN0cyhyZWYuZGVwKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gaXNSZWYocikge1xyXG4gICAgcmV0dXJuICEhKHIgJiYgci5fX3ZfaXNSZWYgPT09IHRydWUpO1xyXG59XHJcbmZ1bmN0aW9uIHJlZih2YWx1ZSkge1xyXG4gICAgcmV0dXJuIGNyZWF0ZVJlZih2YWx1ZSwgZmFsc2UpO1xyXG59XHJcbmZ1bmN0aW9uIHNoYWxsb3dSZWYodmFsdWUpIHtcclxuICAgIHJldHVybiBjcmVhdGVSZWYodmFsdWUsIHRydWUpO1xyXG59XHJcbmZ1bmN0aW9uIGNyZWF0ZVJlZihyYXdWYWx1ZSwgc2hhbGxvdykge1xyXG4gICAgaWYgKGlzUmVmKHJhd1ZhbHVlKSkge1xyXG4gICAgICAgIHJldHVybiByYXdWYWx1ZTtcclxuICAgIH1cclxuICAgIHJldHVybiBuZXcgUmVmSW1wbChyYXdWYWx1ZSwgc2hhbGxvdyk7XHJcbn1cclxuY2xhc3MgUmVmSW1wbCB7XHJcbiAgICBjb25zdHJ1Y3Rvcih2YWx1ZSwgX192X2lzU2hhbGxvdykge1xyXG4gICAgICAgIHRoaXMuX192X2lzU2hhbGxvdyA9IF9fdl9pc1NoYWxsb3c7XHJcbiAgICAgICAgdGhpcy5kZXAgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgdGhpcy5fX3ZfaXNSZWYgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuX3Jhd1ZhbHVlID0gX192X2lzU2hhbGxvdyA/IHZhbHVlIDogdG9SYXcodmFsdWUpO1xyXG4gICAgICAgIHRoaXMuX3ZhbHVlID0gX192X2lzU2hhbGxvdyA/IHZhbHVlIDogdG9SZWFjdGl2ZSh2YWx1ZSk7XHJcbiAgICB9XHJcbiAgICBnZXQgdmFsdWUoKSB7XHJcbiAgICAgICAgdHJhY2tSZWZWYWx1ZSh0aGlzKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5fdmFsdWU7XHJcbiAgICB9XHJcbiAgICBzZXQgdmFsdWUobmV3VmFsKSB7XHJcbiAgICAgICAgbmV3VmFsID0gdGhpcy5fX3ZfaXNTaGFsbG93ID8gbmV3VmFsIDogdG9SYXcobmV3VmFsKTtcclxuICAgICAgICBpZiAoaGFzQ2hhbmdlZChuZXdWYWwsIHRoaXMuX3Jhd1ZhbHVlKSkge1xyXG4gICAgICAgICAgICB0aGlzLl9yYXdWYWx1ZSA9IG5ld1ZhbDtcclxuICAgICAgICAgICAgdGhpcy5fdmFsdWUgPSB0aGlzLl9fdl9pc1NoYWxsb3cgPyBuZXdWYWwgOiB0b1JlYWN0aXZlKG5ld1ZhbCk7XHJcbiAgICAgICAgICAgIHRyaWdnZXJSZWZWYWx1ZSh0aGlzLCBuZXdWYWwpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiB0cmlnZ2VyUmVmKHJlZikge1xyXG4gICAgdHJpZ2dlclJlZlZhbHVlKHJlZiwgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpID8gcmVmLnZhbHVlIDogdm9pZCAwKTtcclxufVxyXG5mdW5jdGlvbiB1bnJlZihyZWYpIHtcclxuICAgIHJldHVybiBpc1JlZihyZWYpID8gcmVmLnZhbHVlIDogcmVmO1xyXG59XHJcbmNvbnN0IHNoYWxsb3dVbndyYXBIYW5kbGVycyA9IHtcclxuICAgIGdldDogKHRhcmdldCwga2V5LCByZWNlaXZlcikgPT4gdW5yZWYoUmVmbGVjdC5nZXQodGFyZ2V0LCBrZXksIHJlY2VpdmVyKSksXHJcbiAgICBzZXQ6ICh0YXJnZXQsIGtleSwgdmFsdWUsIHJlY2VpdmVyKSA9PiB7XHJcbiAgICAgICAgY29uc3Qgb2xkVmFsdWUgPSB0YXJnZXRba2V5XTtcclxuICAgICAgICBpZiAoaXNSZWYob2xkVmFsdWUpICYmICFpc1JlZih2YWx1ZSkpIHtcclxuICAgICAgICAgICAgb2xkVmFsdWUudmFsdWUgPSB2YWx1ZTtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gUmVmbGVjdC5zZXQodGFyZ2V0LCBrZXksIHZhbHVlLCByZWNlaXZlcik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG5mdW5jdGlvbiBwcm94eVJlZnMob2JqZWN0V2l0aFJlZnMpIHtcclxuICAgIHJldHVybiBpc1JlYWN0aXZlKG9iamVjdFdpdGhSZWZzKVxyXG4gICAgICAgID8gb2JqZWN0V2l0aFJlZnNcclxuICAgICAgICA6IG5ldyBQcm94eShvYmplY3RXaXRoUmVmcywgc2hhbGxvd1Vud3JhcEhhbmRsZXJzKTtcclxufVxyXG5jbGFzcyBDdXN0b21SZWZJbXBsIHtcclxuICAgIGNvbnN0cnVjdG9yKGZhY3RvcnkpIHtcclxuICAgICAgICB0aGlzLmRlcCA9IHVuZGVmaW5lZDtcclxuICAgICAgICB0aGlzLl9fdl9pc1JlZiA9IHRydWU7XHJcbiAgICAgICAgY29uc3QgeyBnZXQsIHNldCB9ID0gZmFjdG9yeSgoKSA9PiB0cmFja1JlZlZhbHVlKHRoaXMpLCAoKSA9PiB0cmlnZ2VyUmVmVmFsdWUodGhpcykpO1xyXG4gICAgICAgIHRoaXMuX2dldCA9IGdldDtcclxuICAgICAgICB0aGlzLl9zZXQgPSBzZXQ7XHJcbiAgICB9XHJcbiAgICBnZXQgdmFsdWUoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2dldCgpO1xyXG4gICAgfVxyXG4gICAgc2V0IHZhbHVlKG5ld1ZhbCkge1xyXG4gICAgICAgIHRoaXMuX3NldChuZXdWYWwpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGN1c3RvbVJlZihmYWN0b3J5KSB7XHJcbiAgICByZXR1cm4gbmV3IEN1c3RvbVJlZkltcGwoZmFjdG9yeSk7XHJcbn1cclxuZnVuY3Rpb24gdG9SZWZzKG9iamVjdCkge1xyXG4gICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiAhaXNQcm94eShvYmplY3QpKSB7XHJcbiAgICAgICAgY29uc29sZS53YXJuKGB0b1JlZnMoKSBleHBlY3RzIGEgcmVhY3RpdmUgb2JqZWN0IGJ1dCByZWNlaXZlZCBhIHBsYWluIG9uZS5gKTtcclxuICAgIH1cclxuICAgIGNvbnN0IHJldCA9IGlzQXJyYXkob2JqZWN0KSA/IG5ldyBBcnJheShvYmplY3QubGVuZ3RoKSA6IHt9O1xyXG4gICAgZm9yIChjb25zdCBrZXkgaW4gb2JqZWN0KSB7XHJcbiAgICAgICAgcmV0W2tleV0gPSB0b1JlZihvYmplY3QsIGtleSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmV0O1xyXG59XHJcbmNsYXNzIE9iamVjdFJlZkltcGwge1xyXG4gICAgY29uc3RydWN0b3IoX29iamVjdCwgX2tleSwgX2RlZmF1bHRWYWx1ZSkge1xyXG4gICAgICAgIHRoaXMuX29iamVjdCA9IF9vYmplY3Q7XHJcbiAgICAgICAgdGhpcy5fa2V5ID0gX2tleTtcclxuICAgICAgICB0aGlzLl9kZWZhdWx0VmFsdWUgPSBfZGVmYXVsdFZhbHVlO1xyXG4gICAgICAgIHRoaXMuX192X2lzUmVmID0gdHJ1ZTtcclxuICAgIH1cclxuICAgIGdldCB2YWx1ZSgpIHtcclxuICAgICAgICBjb25zdCB2YWwgPSB0aGlzLl9vYmplY3RbdGhpcy5fa2V5XTtcclxuICAgICAgICByZXR1cm4gdmFsID09PSB1bmRlZmluZWQgPyB0aGlzLl9kZWZhdWx0VmFsdWUgOiB2YWw7XHJcbiAgICB9XHJcbiAgICBzZXQgdmFsdWUobmV3VmFsKSB7XHJcbiAgICAgICAgdGhpcy5fb2JqZWN0W3RoaXMuX2tleV0gPSBuZXdWYWw7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gdG9SZWYob2JqZWN0LCBrZXksIGRlZmF1bHRWYWx1ZSkge1xyXG4gICAgY29uc3QgdmFsID0gb2JqZWN0W2tleV07XHJcbiAgICByZXR1cm4gaXNSZWYodmFsKVxyXG4gICAgICAgID8gdmFsXHJcbiAgICAgICAgOiBuZXcgT2JqZWN0UmVmSW1wbChvYmplY3QsIGtleSwgZGVmYXVsdFZhbHVlKTtcclxufVxuXG5jbGFzcyBDb21wdXRlZFJlZkltcGwge1xyXG4gICAgY29uc3RydWN0b3IoZ2V0dGVyLCBfc2V0dGVyLCBpc1JlYWRvbmx5LCBpc1NTUikge1xyXG4gICAgICAgIHRoaXMuX3NldHRlciA9IF9zZXR0ZXI7XHJcbiAgICAgICAgdGhpcy5kZXAgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgdGhpcy5fX3ZfaXNSZWYgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuX2RpcnR5ID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLmVmZmVjdCA9IG5ldyBSZWFjdGl2ZUVmZmVjdChnZXR0ZXIsICgpID0+IHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLl9kaXJ0eSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZGlydHkgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdHJpZ2dlclJlZlZhbHVlKHRoaXMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5lZmZlY3QuY29tcHV0ZWQgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuZWZmZWN0LmFjdGl2ZSA9IHRoaXMuX2NhY2hlYWJsZSA9ICFpc1NTUjtcclxuICAgICAgICB0aGlzW1wiX192X2lzUmVhZG9ubHlcIiAvKiBJU19SRUFET05MWSAqL10gPSBpc1JlYWRvbmx5O1xyXG4gICAgfVxyXG4gICAgZ2V0IHZhbHVlKCkge1xyXG4gICAgICAgIC8vIHRoZSBjb21wdXRlZCByZWYgbWF5IGdldCB3cmFwcGVkIGJ5IG90aGVyIHByb3hpZXMgZS5nLiByZWFkb25seSgpICMzMzc2XHJcbiAgICAgICAgY29uc3Qgc2VsZiA9IHRvUmF3KHRoaXMpO1xyXG4gICAgICAgIHRyYWNrUmVmVmFsdWUoc2VsZik7XHJcbiAgICAgICAgaWYgKHNlbGYuX2RpcnR5IHx8ICFzZWxmLl9jYWNoZWFibGUpIHtcclxuICAgICAgICAgICAgc2VsZi5fZGlydHkgPSBmYWxzZTtcclxuICAgICAgICAgICAgc2VsZi5fdmFsdWUgPSBzZWxmLmVmZmVjdC5ydW4oKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHNlbGYuX3ZhbHVlO1xyXG4gICAgfVxyXG4gICAgc2V0IHZhbHVlKG5ld1ZhbHVlKSB7XHJcbiAgICAgICAgdGhpcy5fc2V0dGVyKG5ld1ZhbHVlKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBjb21wdXRlZChnZXR0ZXJPck9wdGlvbnMsIGRlYnVnT3B0aW9ucywgaXNTU1IgPSBmYWxzZSkge1xyXG4gICAgbGV0IGdldHRlcjtcclxuICAgIGxldCBzZXR0ZXI7XHJcbiAgICBjb25zdCBvbmx5R2V0dGVyID0gaXNGdW5jdGlvbihnZXR0ZXJPck9wdGlvbnMpO1xyXG4gICAgaWYgKG9ubHlHZXR0ZXIpIHtcclxuICAgICAgICBnZXR0ZXIgPSBnZXR0ZXJPck9wdGlvbnM7XHJcbiAgICAgICAgc2V0dGVyID0gKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpXHJcbiAgICAgICAgICAgID8gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCdXcml0ZSBvcGVyYXRpb24gZmFpbGVkOiBjb21wdXRlZCB2YWx1ZSBpcyByZWFkb25seScpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIDogTk9PUDtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIGdldHRlciA9IGdldHRlck9yT3B0aW9ucy5nZXQ7XHJcbiAgICAgICAgc2V0dGVyID0gZ2V0dGVyT3JPcHRpb25zLnNldDtcclxuICAgIH1cclxuICAgIGNvbnN0IGNSZWYgPSBuZXcgQ29tcHV0ZWRSZWZJbXBsKGdldHRlciwgc2V0dGVyLCBvbmx5R2V0dGVyIHx8ICFzZXR0ZXIsIGlzU1NSKTtcclxuICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiYgZGVidWdPcHRpb25zICYmICFpc1NTUikge1xyXG4gICAgICAgIGNSZWYuZWZmZWN0Lm9uVHJhY2sgPSBkZWJ1Z09wdGlvbnMub25UcmFjaztcclxuICAgICAgICBjUmVmLmVmZmVjdC5vblRyaWdnZXIgPSBkZWJ1Z09wdGlvbnMub25UcmlnZ2VyO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGNSZWY7XHJcbn1cblxudmFyIF9hO1xyXG5jb25zdCB0aWNrID0gUHJvbWlzZS5yZXNvbHZlKCk7XHJcbmNvbnN0IHF1ZXVlID0gW107XHJcbmxldCBxdWV1ZWQgPSBmYWxzZTtcclxuY29uc3Qgc2NoZWR1bGVyID0gKGZuKSA9PiB7XHJcbiAgICBxdWV1ZS5wdXNoKGZuKTtcclxuICAgIGlmICghcXVldWVkKSB7XHJcbiAgICAgICAgcXVldWVkID0gdHJ1ZTtcclxuICAgICAgICB0aWNrLnRoZW4oZmx1c2gpO1xyXG4gICAgfVxyXG59O1xyXG5jb25zdCBmbHVzaCA9ICgpID0+IHtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcXVldWUubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBxdWV1ZVtpXSgpO1xyXG4gICAgfVxyXG4gICAgcXVldWUubGVuZ3RoID0gMDtcclxuICAgIHF1ZXVlZCA9IGZhbHNlO1xyXG59O1xyXG5jbGFzcyBEZWZlcnJlZENvbXB1dGVkUmVmSW1wbCB7XHJcbiAgICBjb25zdHJ1Y3RvcihnZXR0ZXIpIHtcclxuICAgICAgICB0aGlzLmRlcCA9IHVuZGVmaW5lZDtcclxuICAgICAgICB0aGlzLl9kaXJ0eSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5fX3ZfaXNSZWYgPSB0cnVlO1xyXG4gICAgICAgIHRoaXNbX2FdID0gdHJ1ZTtcclxuICAgICAgICBsZXQgY29tcGFyZVRhcmdldDtcclxuICAgICAgICBsZXQgaGFzQ29tcGFyZVRhcmdldCA9IGZhbHNlO1xyXG4gICAgICAgIGxldCBzY2hlZHVsZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmVmZmVjdCA9IG5ldyBSZWFjdGl2ZUVmZmVjdChnZXR0ZXIsIChjb21wdXRlZFRyaWdnZXIpID0+IHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZGVwKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY29tcHV0ZWRUcmlnZ2VyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29tcGFyZVRhcmdldCA9IHRoaXMuX3ZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGhhc0NvbXBhcmVUYXJnZXQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoIXNjaGVkdWxlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlVG9Db21wYXJlID0gaGFzQ29tcGFyZVRhcmdldCA/IGNvbXBhcmVUYXJnZXQgOiB0aGlzLl92YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICBzY2hlZHVsZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGhhc0NvbXBhcmVUYXJnZXQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBzY2hlZHVsZXIoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5lZmZlY3QuYWN0aXZlICYmIHRoaXMuX2dldCgpICE9PSB2YWx1ZVRvQ29tcGFyZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJpZ2dlclJlZlZhbHVlKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjaGVkdWxlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gY2hhaW5lZCB1cHN0cmVhbSBjb21wdXRlZHMgYXJlIG5vdGlmaWVkIHN5bmNocm9ub3VzbHkgdG8gZW5zdXJlXHJcbiAgICAgICAgICAgICAgICAvLyB2YWx1ZSBpbnZhbGlkYXRpb24gaW4gY2FzZSBvZiBzeW5jIGFjY2Vzczsgbm9ybWFsIGVmZmVjdHMgYXJlXHJcbiAgICAgICAgICAgICAgICAvLyBkZWZlcnJlZCB0byBiZSB0cmlnZ2VyZWQgaW4gc2NoZWR1bGVyLlxyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHRoaXMuZGVwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUuY29tcHV0ZWQgaW5zdGFuY2VvZiBEZWZlcnJlZENvbXB1dGVkUmVmSW1wbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLnNjaGVkdWxlcih0cnVlIC8qIGNvbXB1dGVkVHJpZ2dlciAqLyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuX2RpcnR5ID0gdHJ1ZTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmVmZmVjdC5jb21wdXRlZCA9IHRoaXM7XHJcbiAgICB9XHJcbiAgICBfZ2V0KCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9kaXJ0eSkge1xyXG4gICAgICAgICAgICB0aGlzLl9kaXJ0eSA9IGZhbHNlO1xyXG4gICAgICAgICAgICByZXR1cm4gKHRoaXMuX3ZhbHVlID0gdGhpcy5lZmZlY3QucnVuKCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5fdmFsdWU7XHJcbiAgICB9XHJcbiAgICBnZXQgdmFsdWUoKSB7XHJcbiAgICAgICAgdHJhY2tSZWZWYWx1ZSh0aGlzKTtcclxuICAgICAgICAvLyB0aGUgY29tcHV0ZWQgcmVmIG1heSBnZXQgd3JhcHBlZCBieSBvdGhlciBwcm94aWVzIGUuZy4gcmVhZG9ubHkoKSAjMzM3NlxyXG4gICAgICAgIHJldHVybiB0b1Jhdyh0aGlzKS5fZ2V0KCk7XHJcbiAgICB9XHJcbn1cclxuX2EgPSBcIl9fdl9pc1JlYWRvbmx5XCIgLyogSVNfUkVBRE9OTFkgKi87XHJcbmZ1bmN0aW9uIGRlZmVycmVkQ29tcHV0ZWQoZ2V0dGVyKSB7XHJcbiAgICByZXR1cm4gbmV3IERlZmVycmVkQ29tcHV0ZWRSZWZJbXBsKGdldHRlcik7XHJcbn1cblxuZXhwb3J0IHsgRWZmZWN0U2NvcGUsIElURVJBVEVfS0VZLCBSZWFjdGl2ZUVmZmVjdCwgY29tcHV0ZWQsIGN1c3RvbVJlZiwgZGVmZXJyZWRDb21wdXRlZCwgZWZmZWN0LCBlZmZlY3RTY29wZSwgZW5hYmxlVHJhY2tpbmcsIGdldEN1cnJlbnRTY29wZSwgaXNQcm94eSwgaXNSZWFjdGl2ZSwgaXNSZWFkb25seSwgaXNSZWYsIGlzU2hhbGxvdywgbWFya1Jhdywgb25TY29wZURpc3Bvc2UsIHBhdXNlVHJhY2tpbmcsIHByb3h5UmVmcywgcmVhY3RpdmUsIHJlYWRvbmx5LCByZWYsIHJlc2V0VHJhY2tpbmcsIHNoYWxsb3dSZWFjdGl2ZSwgc2hhbGxvd1JlYWRvbmx5LCBzaGFsbG93UmVmLCBzdG9wLCB0b1JhdywgdG9SZWYsIHRvUmVmcywgdHJhY2ssIHRyaWdnZXIsIHRyaWdnZXJSZWYsIHVucmVmIH07XG4iLCJpbXBvcnQgeyBwYXVzZVRyYWNraW5nLCByZXNldFRyYWNraW5nLCBpc1JlZiwgdG9SYXcsIGlzU2hhbGxvdyBhcyBpc1NoYWxsb3ckMSwgaXNSZWFjdGl2ZSwgUmVhY3RpdmVFZmZlY3QsIHJlZiwgcmVhY3RpdmUsIHNoYWxsb3dSZWFjdGl2ZSwgdHJpZ2dlciwgaXNQcm94eSwgc2hhbGxvd1JlYWRvbmx5LCB0cmFjaywgRWZmZWN0U2NvcGUsIG1hcmtSYXcsIHByb3h5UmVmcywgY29tcHV0ZWQgYXMgY29tcHV0ZWQkMSwgaXNSZWFkb25seSB9IGZyb20gJ0B2dWUvcmVhY3Rpdml0eSc7XG5leHBvcnQgeyBFZmZlY3RTY29wZSwgUmVhY3RpdmVFZmZlY3QsIGN1c3RvbVJlZiwgZWZmZWN0LCBlZmZlY3RTY29wZSwgZ2V0Q3VycmVudFNjb3BlLCBpc1Byb3h5LCBpc1JlYWN0aXZlLCBpc1JlYWRvbmx5LCBpc1JlZiwgaXNTaGFsbG93LCBtYXJrUmF3LCBvblNjb3BlRGlzcG9zZSwgcHJveHlSZWZzLCByZWFjdGl2ZSwgcmVhZG9ubHksIHJlZiwgc2hhbGxvd1JlYWN0aXZlLCBzaGFsbG93UmVhZG9ubHksIHNoYWxsb3dSZWYsIHN0b3AsIHRvUmF3LCB0b1JlZiwgdG9SZWZzLCB0cmlnZ2VyUmVmLCB1bnJlZiB9IGZyb20gJ0B2dWUvcmVhY3Rpdml0eSc7XG5pbXBvcnQgeyBpc1N0cmluZywgaXNGdW5jdGlvbiwgaXNQcm9taXNlLCBpc0FycmF5LCBOT09QLCBnZXRHbG9iYWxUaGlzLCBleHRlbmQsIEVNUFRZX09CSiwgdG9IYW5kbGVyS2V5LCB0b051bWJlciwgaHlwaGVuYXRlLCBjYW1lbGl6ZSwgaXNPbiwgaGFzT3duLCBpc01vZGVsTGlzdGVuZXIsIGhhc0NoYW5nZWQsIHJlbW92ZSwgaXNPYmplY3QsIGlzU2V0LCBpc01hcCwgaXNQbGFpbk9iamVjdCwgaW52b2tlQXJyYXlGbnMsIGRlZiwgaXNSZXNlcnZlZFByb3AsIEVNUFRZX0FSUiwgY2FwaXRhbGl6ZSwgdG9SYXdUeXBlLCBtYWtlTWFwLCBpc0J1aWx0SW5EaXJlY3RpdmUsIE5PLCBub3JtYWxpemVDbGFzcywgbm9ybWFsaXplU3R5bGUsIGlzR2xvYmFsbHlXaGl0ZWxpc3RlZCB9IGZyb20gJ0B2dWUvc2hhcmVkJztcbmV4cG9ydCB7IGNhbWVsaXplLCBjYXBpdGFsaXplLCBub3JtYWxpemVDbGFzcywgbm9ybWFsaXplUHJvcHMsIG5vcm1hbGl6ZVN0eWxlLCB0b0Rpc3BsYXlTdHJpbmcsIHRvSGFuZGxlcktleSB9IGZyb20gJ0B2dWUvc2hhcmVkJztcblxuY29uc3Qgc3RhY2sgPSBbXTtcclxuZnVuY3Rpb24gcHVzaFdhcm5pbmdDb250ZXh0KHZub2RlKSB7XHJcbiAgICBzdGFjay5wdXNoKHZub2RlKTtcclxufVxyXG5mdW5jdGlvbiBwb3BXYXJuaW5nQ29udGV4dCgpIHtcclxuICAgIHN0YWNrLnBvcCgpO1xyXG59XHJcbmZ1bmN0aW9uIHdhcm4obXNnLCAuLi5hcmdzKSB7XHJcbiAgICAvLyBhdm9pZCBwcm9wcyBmb3JtYXR0aW5nIG9yIHdhcm4gaGFuZGxlciB0cmFja2luZyBkZXBzIHRoYXQgbWlnaHQgYmUgbXV0YXRlZFxyXG4gICAgLy8gZHVyaW5nIHBhdGNoLCBsZWFkaW5nIHRvIGluZmluaXRlIHJlY3Vyc2lvbi5cclxuICAgIHBhdXNlVHJhY2tpbmcoKTtcclxuICAgIGNvbnN0IGluc3RhbmNlID0gc3RhY2subGVuZ3RoID8gc3RhY2tbc3RhY2subGVuZ3RoIC0gMV0uY29tcG9uZW50IDogbnVsbDtcclxuICAgIGNvbnN0IGFwcFdhcm5IYW5kbGVyID0gaW5zdGFuY2UgJiYgaW5zdGFuY2UuYXBwQ29udGV4dC5jb25maWcud2FybkhhbmRsZXI7XHJcbiAgICBjb25zdCB0cmFjZSA9IGdldENvbXBvbmVudFRyYWNlKCk7XHJcbiAgICBpZiAoYXBwV2FybkhhbmRsZXIpIHtcclxuICAgICAgICBjYWxsV2l0aEVycm9ySGFuZGxpbmcoYXBwV2FybkhhbmRsZXIsIGluc3RhbmNlLCAxMSAvKiBBUFBfV0FSTl9IQU5ETEVSICovLCBbXHJcbiAgICAgICAgICAgIG1zZyArIGFyZ3Muam9pbignJyksXHJcbiAgICAgICAgICAgIGluc3RhbmNlICYmIGluc3RhbmNlLnByb3h5LFxyXG4gICAgICAgICAgICB0cmFjZVxyXG4gICAgICAgICAgICAgICAgLm1hcCgoeyB2bm9kZSB9KSA9PiBgYXQgPCR7Zm9ybWF0Q29tcG9uZW50TmFtZShpbnN0YW5jZSwgdm5vZGUudHlwZSl9PmApXHJcbiAgICAgICAgICAgICAgICAuam9pbignXFxuJyksXHJcbiAgICAgICAgICAgIHRyYWNlXHJcbiAgICAgICAgXSk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBjb25zdCB3YXJuQXJncyA9IFtgW1Z1ZSB3YXJuXTogJHttc2d9YCwgLi4uYXJnc107XHJcbiAgICAgICAgLyogaXN0YW5idWwgaWdub3JlIGlmICovXHJcbiAgICAgICAgaWYgKHRyYWNlLmxlbmd0aCAmJlxyXG4gICAgICAgICAgICAvLyBhdm9pZCBzcGFtbWluZyBjb25zb2xlIGR1cmluZyB0ZXN0c1xyXG4gICAgICAgICAgICAhZmFsc2UpIHtcclxuICAgICAgICAgICAgd2FybkFyZ3MucHVzaChgXFxuYCwgLi4uZm9ybWF0VHJhY2UodHJhY2UpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc29sZS53YXJuKC4uLndhcm5BcmdzKTtcclxuICAgIH1cclxuICAgIHJlc2V0VHJhY2tpbmcoKTtcclxufVxyXG5mdW5jdGlvbiBnZXRDb21wb25lbnRUcmFjZSgpIHtcclxuICAgIGxldCBjdXJyZW50Vk5vZGUgPSBzdGFja1tzdGFjay5sZW5ndGggLSAxXTtcclxuICAgIGlmICghY3VycmVudFZOb2RlKSB7XHJcbiAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgfVxyXG4gICAgLy8gd2UgY2FuJ3QganVzdCB1c2UgdGhlIHN0YWNrIGJlY2F1c2UgaXQgd2lsbCBiZSBpbmNvbXBsZXRlIGR1cmluZyB1cGRhdGVzXHJcbiAgICAvLyB0aGF0IGRpZCBub3Qgc3RhcnQgZnJvbSB0aGUgcm9vdC4gUmUtY29uc3RydWN0IHRoZSBwYXJlbnQgY2hhaW4gdXNpbmdcclxuICAgIC8vIGluc3RhbmNlIHBhcmVudCBwb2ludGVycy5cclxuICAgIGNvbnN0IG5vcm1hbGl6ZWRTdGFjayA9IFtdO1xyXG4gICAgd2hpbGUgKGN1cnJlbnRWTm9kZSkge1xyXG4gICAgICAgIGNvbnN0IGxhc3QgPSBub3JtYWxpemVkU3RhY2tbMF07XHJcbiAgICAgICAgaWYgKGxhc3QgJiYgbGFzdC52bm9kZSA9PT0gY3VycmVudFZOb2RlKSB7XHJcbiAgICAgICAgICAgIGxhc3QucmVjdXJzZUNvdW50Kys7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBub3JtYWxpemVkU3RhY2sucHVzaCh7XHJcbiAgICAgICAgICAgICAgICB2bm9kZTogY3VycmVudFZOb2RlLFxyXG4gICAgICAgICAgICAgICAgcmVjdXJzZUNvdW50OiAwXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBwYXJlbnRJbnN0YW5jZSA9IGN1cnJlbnRWTm9kZS5jb21wb25lbnQgJiYgY3VycmVudFZOb2RlLmNvbXBvbmVudC5wYXJlbnQ7XHJcbiAgICAgICAgY3VycmVudFZOb2RlID0gcGFyZW50SW5zdGFuY2UgJiYgcGFyZW50SW5zdGFuY2Uudm5vZGU7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbm9ybWFsaXplZFN0YWNrO1xyXG59XHJcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXHJcbmZ1bmN0aW9uIGZvcm1hdFRyYWNlKHRyYWNlKSB7XHJcbiAgICBjb25zdCBsb2dzID0gW107XHJcbiAgICB0cmFjZS5mb3JFYWNoKChlbnRyeSwgaSkgPT4ge1xyXG4gICAgICAgIGxvZ3MucHVzaCguLi4oaSA9PT0gMCA/IFtdIDogW2BcXG5gXSksIC4uLmZvcm1hdFRyYWNlRW50cnkoZW50cnkpKTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIGxvZ3M7XHJcbn1cclxuZnVuY3Rpb24gZm9ybWF0VHJhY2VFbnRyeSh7IHZub2RlLCByZWN1cnNlQ291bnQgfSkge1xyXG4gICAgY29uc3QgcG9zdGZpeCA9IHJlY3Vyc2VDb3VudCA+IDAgPyBgLi4uICgke3JlY3Vyc2VDb3VudH0gcmVjdXJzaXZlIGNhbGxzKWAgOiBgYDtcclxuICAgIGNvbnN0IGlzUm9vdCA9IHZub2RlLmNvbXBvbmVudCA/IHZub2RlLmNvbXBvbmVudC5wYXJlbnQgPT0gbnVsbCA6IGZhbHNlO1xyXG4gICAgY29uc3Qgb3BlbiA9IGAgYXQgPCR7Zm9ybWF0Q29tcG9uZW50TmFtZSh2bm9kZS5jb21wb25lbnQsIHZub2RlLnR5cGUsIGlzUm9vdCl9YDtcclxuICAgIGNvbnN0IGNsb3NlID0gYD5gICsgcG9zdGZpeDtcclxuICAgIHJldHVybiB2bm9kZS5wcm9wc1xyXG4gICAgICAgID8gW29wZW4sIC4uLmZvcm1hdFByb3BzKHZub2RlLnByb3BzKSwgY2xvc2VdXHJcbiAgICAgICAgOiBbb3BlbiArIGNsb3NlXTtcclxufVxyXG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xyXG5mdW5jdGlvbiBmb3JtYXRQcm9wcyhwcm9wcykge1xyXG4gICAgY29uc3QgcmVzID0gW107XHJcbiAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXMocHJvcHMpO1xyXG4gICAga2V5cy5zbGljZSgwLCAzKS5mb3JFYWNoKGtleSA9PiB7XHJcbiAgICAgICAgcmVzLnB1c2goLi4uZm9ybWF0UHJvcChrZXksIHByb3BzW2tleV0pKTtcclxuICAgIH0pO1xyXG4gICAgaWYgKGtleXMubGVuZ3RoID4gMykge1xyXG4gICAgICAgIHJlcy5wdXNoKGAgLi4uYCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzO1xyXG59XHJcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXHJcbmZ1bmN0aW9uIGZvcm1hdFByb3Aoa2V5LCB2YWx1ZSwgcmF3KSB7XHJcbiAgICBpZiAoaXNTdHJpbmcodmFsdWUpKSB7XHJcbiAgICAgICAgdmFsdWUgPSBKU09OLnN0cmluZ2lmeSh2YWx1ZSk7XHJcbiAgICAgICAgcmV0dXJuIHJhdyA/IHZhbHVlIDogW2Ake2tleX09JHt2YWx1ZX1gXTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicgfHxcclxuICAgICAgICB0eXBlb2YgdmFsdWUgPT09ICdib29sZWFuJyB8fFxyXG4gICAgICAgIHZhbHVlID09IG51bGwpIHtcclxuICAgICAgICByZXR1cm4gcmF3ID8gdmFsdWUgOiBbYCR7a2V5fT0ke3ZhbHVlfWBdO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoaXNSZWYodmFsdWUpKSB7XHJcbiAgICAgICAgdmFsdWUgPSBmb3JtYXRQcm9wKGtleSwgdG9SYXcodmFsdWUudmFsdWUpLCB0cnVlKTtcclxuICAgICAgICByZXR1cm4gcmF3ID8gdmFsdWUgOiBbYCR7a2V5fT1SZWY8YCwgdmFsdWUsIGA+YF07XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChpc0Z1bmN0aW9uKHZhbHVlKSkge1xyXG4gICAgICAgIHJldHVybiBbYCR7a2V5fT1mbiR7dmFsdWUubmFtZSA/IGA8JHt2YWx1ZS5uYW1lfT5gIDogYGB9YF07XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICB2YWx1ZSA9IHRvUmF3KHZhbHVlKTtcclxuICAgICAgICByZXR1cm4gcmF3ID8gdmFsdWUgOiBbYCR7a2V5fT1gLCB2YWx1ZV07XHJcbiAgICB9XHJcbn1cblxuY29uc3QgRXJyb3JUeXBlU3RyaW5ncyA9IHtcclxuICAgIFtcInNwXCIgLyogU0VSVkVSX1BSRUZFVENIICovXTogJ3NlcnZlclByZWZldGNoIGhvb2snLFxyXG4gICAgW1wiYmNcIiAvKiBCRUZPUkVfQ1JFQVRFICovXTogJ2JlZm9yZUNyZWF0ZSBob29rJyxcclxuICAgIFtcImNcIiAvKiBDUkVBVEVEICovXTogJ2NyZWF0ZWQgaG9vaycsXHJcbiAgICBbXCJibVwiIC8qIEJFRk9SRV9NT1VOVCAqL106ICdiZWZvcmVNb3VudCBob29rJyxcclxuICAgIFtcIm1cIiAvKiBNT1VOVEVEICovXTogJ21vdW50ZWQgaG9vaycsXHJcbiAgICBbXCJidVwiIC8qIEJFRk9SRV9VUERBVEUgKi9dOiAnYmVmb3JlVXBkYXRlIGhvb2snLFxyXG4gICAgW1widVwiIC8qIFVQREFURUQgKi9dOiAndXBkYXRlZCcsXHJcbiAgICBbXCJidW1cIiAvKiBCRUZPUkVfVU5NT1VOVCAqL106ICdiZWZvcmVVbm1vdW50IGhvb2snLFxyXG4gICAgW1widW1cIiAvKiBVTk1PVU5URUQgKi9dOiAndW5tb3VudGVkIGhvb2snLFxyXG4gICAgW1wiYVwiIC8qIEFDVElWQVRFRCAqL106ICdhY3RpdmF0ZWQgaG9vaycsXHJcbiAgICBbXCJkYVwiIC8qIERFQUNUSVZBVEVEICovXTogJ2RlYWN0aXZhdGVkIGhvb2snLFxyXG4gICAgW1wiZWNcIiAvKiBFUlJPUl9DQVBUVVJFRCAqL106ICdlcnJvckNhcHR1cmVkIGhvb2snLFxyXG4gICAgW1wicnRjXCIgLyogUkVOREVSX1RSQUNLRUQgKi9dOiAncmVuZGVyVHJhY2tlZCBob29rJyxcclxuICAgIFtcInJ0Z1wiIC8qIFJFTkRFUl9UUklHR0VSRUQgKi9dOiAncmVuZGVyVHJpZ2dlcmVkIGhvb2snLFxyXG4gICAgWzAgLyogU0VUVVBfRlVOQ1RJT04gKi9dOiAnc2V0dXAgZnVuY3Rpb24nLFxyXG4gICAgWzEgLyogUkVOREVSX0ZVTkNUSU9OICovXTogJ3JlbmRlciBmdW5jdGlvbicsXHJcbiAgICBbMiAvKiBXQVRDSF9HRVRURVIgKi9dOiAnd2F0Y2hlciBnZXR0ZXInLFxyXG4gICAgWzMgLyogV0FUQ0hfQ0FMTEJBQ0sgKi9dOiAnd2F0Y2hlciBjYWxsYmFjaycsXHJcbiAgICBbNCAvKiBXQVRDSF9DTEVBTlVQICovXTogJ3dhdGNoZXIgY2xlYW51cCBmdW5jdGlvbicsXHJcbiAgICBbNSAvKiBOQVRJVkVfRVZFTlRfSEFORExFUiAqL106ICduYXRpdmUgZXZlbnQgaGFuZGxlcicsXHJcbiAgICBbNiAvKiBDT01QT05FTlRfRVZFTlRfSEFORExFUiAqL106ICdjb21wb25lbnQgZXZlbnQgaGFuZGxlcicsXHJcbiAgICBbNyAvKiBWTk9ERV9IT09LICovXTogJ3Zub2RlIGhvb2snLFxyXG4gICAgWzggLyogRElSRUNUSVZFX0hPT0sgKi9dOiAnZGlyZWN0aXZlIGhvb2snLFxyXG4gICAgWzkgLyogVFJBTlNJVElPTl9IT09LICovXTogJ3RyYW5zaXRpb24gaG9vaycsXHJcbiAgICBbMTAgLyogQVBQX0VSUk9SX0hBTkRMRVIgKi9dOiAnYXBwIGVycm9ySGFuZGxlcicsXHJcbiAgICBbMTEgLyogQVBQX1dBUk5fSEFORExFUiAqL106ICdhcHAgd2FybkhhbmRsZXInLFxyXG4gICAgWzEyIC8qIEZVTkNUSU9OX1JFRiAqL106ICdyZWYgZnVuY3Rpb24nLFxyXG4gICAgWzEzIC8qIEFTWU5DX0NPTVBPTkVOVF9MT0FERVIgKi9dOiAnYXN5bmMgY29tcG9uZW50IGxvYWRlcicsXHJcbiAgICBbMTQgLyogU0NIRURVTEVSICovXTogJ3NjaGVkdWxlciBmbHVzaC4gVGhpcyBpcyBsaWtlbHkgYSBWdWUgaW50ZXJuYWxzIGJ1Zy4gJyArXHJcbiAgICAgICAgJ1BsZWFzZSBvcGVuIGFuIGlzc3VlIGF0IGh0dHBzOi8vbmV3LWlzc3VlLnZ1ZWpzLm9yZy8/cmVwbz12dWVqcy9jb3JlJ1xyXG59O1xyXG5mdW5jdGlvbiBjYWxsV2l0aEVycm9ySGFuZGxpbmcoZm4sIGluc3RhbmNlLCB0eXBlLCBhcmdzKSB7XHJcbiAgICBsZXQgcmVzO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICByZXMgPSBhcmdzID8gZm4oLi4uYXJncykgOiBmbigpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGVycikge1xyXG4gICAgICAgIGhhbmRsZUVycm9yKGVyciwgaW5zdGFuY2UsIHR5cGUpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlcztcclxufVxyXG5mdW5jdGlvbiBjYWxsV2l0aEFzeW5jRXJyb3JIYW5kbGluZyhmbiwgaW5zdGFuY2UsIHR5cGUsIGFyZ3MpIHtcclxuICAgIGlmIChpc0Z1bmN0aW9uKGZuKSkge1xyXG4gICAgICAgIGNvbnN0IHJlcyA9IGNhbGxXaXRoRXJyb3JIYW5kbGluZyhmbiwgaW5zdGFuY2UsIHR5cGUsIGFyZ3MpO1xyXG4gICAgICAgIGlmIChyZXMgJiYgaXNQcm9taXNlKHJlcykpIHtcclxuICAgICAgICAgICAgcmVzLmNhdGNoKGVyciA9PiB7XHJcbiAgICAgICAgICAgICAgICBoYW5kbGVFcnJvcihlcnIsIGluc3RhbmNlLCB0eXBlKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXM7XHJcbiAgICB9XHJcbiAgICBjb25zdCB2YWx1ZXMgPSBbXTtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZm4ubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICB2YWx1ZXMucHVzaChjYWxsV2l0aEFzeW5jRXJyb3JIYW5kbGluZyhmbltpXSwgaW5zdGFuY2UsIHR5cGUsIGFyZ3MpKTtcclxuICAgIH1cclxuICAgIHJldHVybiB2YWx1ZXM7XHJcbn1cclxuZnVuY3Rpb24gaGFuZGxlRXJyb3IoZXJyLCBpbnN0YW5jZSwgdHlwZSwgdGhyb3dJbkRldiA9IHRydWUpIHtcclxuICAgIGNvbnN0IGNvbnRleHRWTm9kZSA9IGluc3RhbmNlID8gaW5zdGFuY2Uudm5vZGUgOiBudWxsO1xyXG4gICAgaWYgKGluc3RhbmNlKSB7XHJcbiAgICAgICAgbGV0IGN1ciA9IGluc3RhbmNlLnBhcmVudDtcclxuICAgICAgICAvLyB0aGUgZXhwb3NlZCBpbnN0YW5jZSBpcyB0aGUgcmVuZGVyIHByb3h5IHRvIGtlZXAgaXQgY29uc2lzdGVudCB3aXRoIDIueFxyXG4gICAgICAgIGNvbnN0IGV4cG9zZWRJbnN0YW5jZSA9IGluc3RhbmNlLnByb3h5O1xyXG4gICAgICAgIC8vIGluIHByb2R1Y3Rpb24gdGhlIGhvb2sgcmVjZWl2ZXMgb25seSB0aGUgZXJyb3IgY29kZVxyXG4gICAgICAgIGNvbnN0IGVycm9ySW5mbyA9IChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSA/IEVycm9yVHlwZVN0cmluZ3NbdHlwZV0gOiB0eXBlO1xyXG4gICAgICAgIHdoaWxlIChjdXIpIHtcclxuICAgICAgICAgICAgY29uc3QgZXJyb3JDYXB0dXJlZEhvb2tzID0gY3VyLmVjO1xyXG4gICAgICAgICAgICBpZiAoZXJyb3JDYXB0dXJlZEhvb2tzKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGVycm9yQ2FwdHVyZWRIb29rcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlcnJvckNhcHR1cmVkSG9va3NbaV0oZXJyLCBleHBvc2VkSW5zdGFuY2UsIGVycm9ySW5mbykgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY3VyID0gY3VyLnBhcmVudDtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gYXBwLWxldmVsIGhhbmRsaW5nXHJcbiAgICAgICAgY29uc3QgYXBwRXJyb3JIYW5kbGVyID0gaW5zdGFuY2UuYXBwQ29udGV4dC5jb25maWcuZXJyb3JIYW5kbGVyO1xyXG4gICAgICAgIGlmIChhcHBFcnJvckhhbmRsZXIpIHtcclxuICAgICAgICAgICAgY2FsbFdpdGhFcnJvckhhbmRsaW5nKGFwcEVycm9ySGFuZGxlciwgbnVsbCwgMTAgLyogQVBQX0VSUk9SX0hBTkRMRVIgKi8sIFtlcnIsIGV4cG9zZWRJbnN0YW5jZSwgZXJyb3JJbmZvXSk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBsb2dFcnJvcihlcnIsIHR5cGUsIGNvbnRleHRWTm9kZSwgdGhyb3dJbkRldik7XHJcbn1cclxuZnVuY3Rpb24gbG9nRXJyb3IoZXJyLCB0eXBlLCBjb250ZXh0Vk5vZGUsIHRocm93SW5EZXYgPSB0cnVlKSB7XHJcbiAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgY29uc3QgaW5mbyA9IEVycm9yVHlwZVN0cmluZ3NbdHlwZV07XHJcbiAgICAgICAgaWYgKGNvbnRleHRWTm9kZSkge1xyXG4gICAgICAgICAgICBwdXNoV2FybmluZ0NvbnRleHQoY29udGV4dFZOb2RlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgd2FybihgVW5oYW5kbGVkIGVycm9yJHtpbmZvID8gYCBkdXJpbmcgZXhlY3V0aW9uIG9mICR7aW5mb31gIDogYGB9YCk7XHJcbiAgICAgICAgaWYgKGNvbnRleHRWTm9kZSkge1xyXG4gICAgICAgICAgICBwb3BXYXJuaW5nQ29udGV4dCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBjcmFzaCBpbiBkZXYgYnkgZGVmYXVsdCBzbyBpdCdzIG1vcmUgbm90aWNlYWJsZVxyXG4gICAgICAgIGlmICh0aHJvd0luRGV2KSB7XHJcbiAgICAgICAgICAgIHRocm93IGVycjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICAvLyByZWNvdmVyIGluIHByb2QgdG8gcmVkdWNlIHRoZSBpbXBhY3Qgb24gZW5kLXVzZXJcclxuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbiAgICB9XHJcbn1cblxubGV0IGlzRmx1c2hpbmcgPSBmYWxzZTtcclxubGV0IGlzRmx1c2hQZW5kaW5nID0gZmFsc2U7XHJcbmNvbnN0IHF1ZXVlID0gW107XHJcbmxldCBmbHVzaEluZGV4ID0gMDtcclxuY29uc3QgcGVuZGluZ1ByZUZsdXNoQ2JzID0gW107XHJcbmxldCBhY3RpdmVQcmVGbHVzaENicyA9IG51bGw7XHJcbmxldCBwcmVGbHVzaEluZGV4ID0gMDtcclxuY29uc3QgcGVuZGluZ1Bvc3RGbHVzaENicyA9IFtdO1xyXG5sZXQgYWN0aXZlUG9zdEZsdXNoQ2JzID0gbnVsbDtcclxubGV0IHBvc3RGbHVzaEluZGV4ID0gMDtcclxuY29uc3QgcmVzb2x2ZWRQcm9taXNlID0gUHJvbWlzZS5yZXNvbHZlKCk7XHJcbmxldCBjdXJyZW50Rmx1c2hQcm9taXNlID0gbnVsbDtcclxubGV0IGN1cnJlbnRQcmVGbHVzaFBhcmVudEpvYiA9IG51bGw7XHJcbmNvbnN0IFJFQ1VSU0lPTl9MSU1JVCA9IDEwMDtcclxuZnVuY3Rpb24gbmV4dFRpY2soZm4pIHtcclxuICAgIGNvbnN0IHAgPSBjdXJyZW50Rmx1c2hQcm9taXNlIHx8IHJlc29sdmVkUHJvbWlzZTtcclxuICAgIHJldHVybiBmbiA/IHAudGhlbih0aGlzID8gZm4uYmluZCh0aGlzKSA6IGZuKSA6IHA7XHJcbn1cclxuLy8gIzI3NjhcclxuLy8gVXNlIGJpbmFyeS1zZWFyY2ggdG8gZmluZCBhIHN1aXRhYmxlIHBvc2l0aW9uIGluIHRoZSBxdWV1ZSxcclxuLy8gc28gdGhhdCB0aGUgcXVldWUgbWFpbnRhaW5zIHRoZSBpbmNyZWFzaW5nIG9yZGVyIG9mIGpvYidzIGlkLFxyXG4vLyB3aGljaCBjYW4gcHJldmVudCB0aGUgam9iIGZyb20gYmVpbmcgc2tpcHBlZCBhbmQgYWxzbyBjYW4gYXZvaWQgcmVwZWF0ZWQgcGF0Y2hpbmcuXHJcbmZ1bmN0aW9uIGZpbmRJbnNlcnRpb25JbmRleChpZCkge1xyXG4gICAgLy8gdGhlIHN0YXJ0IGluZGV4IHNob3VsZCBiZSBgZmx1c2hJbmRleCArIDFgXHJcbiAgICBsZXQgc3RhcnQgPSBmbHVzaEluZGV4ICsgMTtcclxuICAgIGxldCBlbmQgPSBxdWV1ZS5sZW5ndGg7XHJcbiAgICB3aGlsZSAoc3RhcnQgPCBlbmQpIHtcclxuICAgICAgICBjb25zdCBtaWRkbGUgPSAoc3RhcnQgKyBlbmQpID4+PiAxO1xyXG4gICAgICAgIGNvbnN0IG1pZGRsZUpvYklkID0gZ2V0SWQocXVldWVbbWlkZGxlXSk7XHJcbiAgICAgICAgbWlkZGxlSm9iSWQgPCBpZCA/IChzdGFydCA9IG1pZGRsZSArIDEpIDogKGVuZCA9IG1pZGRsZSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gc3RhcnQ7XHJcbn1cclxuZnVuY3Rpb24gcXVldWVKb2Ioam9iKSB7XHJcbiAgICAvLyB0aGUgZGVkdXBlIHNlYXJjaCB1c2VzIHRoZSBzdGFydEluZGV4IGFyZ3VtZW50IG9mIEFycmF5LmluY2x1ZGVzKClcclxuICAgIC8vIGJ5IGRlZmF1bHQgdGhlIHNlYXJjaCBpbmRleCBpbmNsdWRlcyB0aGUgY3VycmVudCBqb2IgdGhhdCBpcyBiZWluZyBydW5cclxuICAgIC8vIHNvIGl0IGNhbm5vdCByZWN1cnNpdmVseSB0cmlnZ2VyIGl0c2VsZiBhZ2Fpbi5cclxuICAgIC8vIGlmIHRoZSBqb2IgaXMgYSB3YXRjaCgpIGNhbGxiYWNrLCB0aGUgc2VhcmNoIHdpbGwgc3RhcnQgd2l0aCBhICsxIGluZGV4IHRvXHJcbiAgICAvLyBhbGxvdyBpdCByZWN1cnNpdmVseSB0cmlnZ2VyIGl0c2VsZiAtIGl0IGlzIHRoZSB1c2VyJ3MgcmVzcG9uc2liaWxpdHkgdG9cclxuICAgIC8vIGVuc3VyZSBpdCBkb2Vzbid0IGVuZCB1cCBpbiBhbiBpbmZpbml0ZSBsb29wLlxyXG4gICAgaWYgKCghcXVldWUubGVuZ3RoIHx8XHJcbiAgICAgICAgIXF1ZXVlLmluY2x1ZGVzKGpvYiwgaXNGbHVzaGluZyAmJiBqb2IuYWxsb3dSZWN1cnNlID8gZmx1c2hJbmRleCArIDEgOiBmbHVzaEluZGV4KSkgJiZcclxuICAgICAgICBqb2IgIT09IGN1cnJlbnRQcmVGbHVzaFBhcmVudEpvYikge1xyXG4gICAgICAgIGlmIChqb2IuaWQgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBxdWV1ZS5wdXNoKGpvYik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBxdWV1ZS5zcGxpY2UoZmluZEluc2VydGlvbkluZGV4KGpvYi5pZCksIDAsIGpvYik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHF1ZXVlRmx1c2goKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBxdWV1ZUZsdXNoKCkge1xyXG4gICAgaWYgKCFpc0ZsdXNoaW5nICYmICFpc0ZsdXNoUGVuZGluZykge1xyXG4gICAgICAgIGlzRmx1c2hQZW5kaW5nID0gdHJ1ZTtcclxuICAgICAgICBjdXJyZW50Rmx1c2hQcm9taXNlID0gcmVzb2x2ZWRQcm9taXNlLnRoZW4oZmx1c2hKb2JzKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBpbnZhbGlkYXRlSm9iKGpvYikge1xyXG4gICAgY29uc3QgaSA9IHF1ZXVlLmluZGV4T2Yoam9iKTtcclxuICAgIGlmIChpID4gZmx1c2hJbmRleCkge1xyXG4gICAgICAgIHF1ZXVlLnNwbGljZShpLCAxKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBxdWV1ZUNiKGNiLCBhY3RpdmVRdWV1ZSwgcGVuZGluZ1F1ZXVlLCBpbmRleCkge1xyXG4gICAgaWYgKCFpc0FycmF5KGNiKSkge1xyXG4gICAgICAgIGlmICghYWN0aXZlUXVldWUgfHxcclxuICAgICAgICAgICAgIWFjdGl2ZVF1ZXVlLmluY2x1ZGVzKGNiLCBjYi5hbGxvd1JlY3Vyc2UgPyBpbmRleCArIDEgOiBpbmRleCkpIHtcclxuICAgICAgICAgICAgcGVuZGluZ1F1ZXVlLnB1c2goY2IpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIC8vIGlmIGNiIGlzIGFuIGFycmF5LCBpdCBpcyBhIGNvbXBvbmVudCBsaWZlY3ljbGUgaG9vayB3aGljaCBjYW4gb25seSBiZVxyXG4gICAgICAgIC8vIHRyaWdnZXJlZCBieSBhIGpvYiwgd2hpY2ggaXMgYWxyZWFkeSBkZWR1cGVkIGluIHRoZSBtYWluIHF1ZXVlLCBzb1xyXG4gICAgICAgIC8vIHdlIGNhbiBza2lwIGR1cGxpY2F0ZSBjaGVjayBoZXJlIHRvIGltcHJvdmUgcGVyZlxyXG4gICAgICAgIHBlbmRpbmdRdWV1ZS5wdXNoKC4uLmNiKTtcclxuICAgIH1cclxuICAgIHF1ZXVlRmx1c2goKTtcclxufVxyXG5mdW5jdGlvbiBxdWV1ZVByZUZsdXNoQ2IoY2IpIHtcclxuICAgIHF1ZXVlQ2IoY2IsIGFjdGl2ZVByZUZsdXNoQ2JzLCBwZW5kaW5nUHJlRmx1c2hDYnMsIHByZUZsdXNoSW5kZXgpO1xyXG59XHJcbmZ1bmN0aW9uIHF1ZXVlUG9zdEZsdXNoQ2IoY2IpIHtcclxuICAgIHF1ZXVlQ2IoY2IsIGFjdGl2ZVBvc3RGbHVzaENicywgcGVuZGluZ1Bvc3RGbHVzaENicywgcG9zdEZsdXNoSW5kZXgpO1xyXG59XHJcbmZ1bmN0aW9uIGZsdXNoUHJlRmx1c2hDYnMoc2VlbiwgcGFyZW50Sm9iID0gbnVsbCkge1xyXG4gICAgaWYgKHBlbmRpbmdQcmVGbHVzaENicy5sZW5ndGgpIHtcclxuICAgICAgICBjdXJyZW50UHJlRmx1c2hQYXJlbnRKb2IgPSBwYXJlbnRKb2I7XHJcbiAgICAgICAgYWN0aXZlUHJlRmx1c2hDYnMgPSBbLi4ubmV3IFNldChwZW5kaW5nUHJlRmx1c2hDYnMpXTtcclxuICAgICAgICBwZW5kaW5nUHJlRmx1c2hDYnMubGVuZ3RoID0gMDtcclxuICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgIHNlZW4gPSBzZWVuIHx8IG5ldyBNYXAoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yIChwcmVGbHVzaEluZGV4ID0gMDsgcHJlRmx1c2hJbmRleCA8IGFjdGl2ZVByZUZsdXNoQ2JzLmxlbmd0aDsgcHJlRmx1c2hJbmRleCsrKSB7XHJcbiAgICAgICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiZcclxuICAgICAgICAgICAgICAgIGNoZWNrUmVjdXJzaXZlVXBkYXRlcyhzZWVuLCBhY3RpdmVQcmVGbHVzaENic1twcmVGbHVzaEluZGV4XSkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGFjdGl2ZVByZUZsdXNoQ2JzW3ByZUZsdXNoSW5kZXhdKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGFjdGl2ZVByZUZsdXNoQ2JzID0gbnVsbDtcclxuICAgICAgICBwcmVGbHVzaEluZGV4ID0gMDtcclxuICAgICAgICBjdXJyZW50UHJlRmx1c2hQYXJlbnRKb2IgPSBudWxsO1xyXG4gICAgICAgIC8vIHJlY3Vyc2l2ZWx5IGZsdXNoIHVudGlsIGl0IGRyYWluc1xyXG4gICAgICAgIGZsdXNoUHJlRmx1c2hDYnMoc2VlbiwgcGFyZW50Sm9iKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBmbHVzaFBvc3RGbHVzaENicyhzZWVuKSB7XHJcbiAgICBpZiAocGVuZGluZ1Bvc3RGbHVzaENicy5sZW5ndGgpIHtcclxuICAgICAgICBjb25zdCBkZWR1cGVkID0gWy4uLm5ldyBTZXQocGVuZGluZ1Bvc3RGbHVzaENicyldO1xyXG4gICAgICAgIHBlbmRpbmdQb3N0Rmx1c2hDYnMubGVuZ3RoID0gMDtcclxuICAgICAgICAvLyAjMTk0NyBhbHJlYWR5IGhhcyBhY3RpdmUgcXVldWUsIG5lc3RlZCBmbHVzaFBvc3RGbHVzaENicyBjYWxsXHJcbiAgICAgICAgaWYgKGFjdGl2ZVBvc3RGbHVzaENicykge1xyXG4gICAgICAgICAgICBhY3RpdmVQb3N0Rmx1c2hDYnMucHVzaCguLi5kZWR1cGVkKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBhY3RpdmVQb3N0Rmx1c2hDYnMgPSBkZWR1cGVkO1xyXG4gICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgc2VlbiA9IHNlZW4gfHwgbmV3IE1hcCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBhY3RpdmVQb3N0Rmx1c2hDYnMuc29ydCgoYSwgYikgPT4gZ2V0SWQoYSkgLSBnZXRJZChiKSk7XHJcbiAgICAgICAgZm9yIChwb3N0Rmx1c2hJbmRleCA9IDA7IHBvc3RGbHVzaEluZGV4IDwgYWN0aXZlUG9zdEZsdXNoQ2JzLmxlbmd0aDsgcG9zdEZsdXNoSW5kZXgrKykge1xyXG4gICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmXHJcbiAgICAgICAgICAgICAgICBjaGVja1JlY3Vyc2l2ZVVwZGF0ZXMoc2VlbiwgYWN0aXZlUG9zdEZsdXNoQ2JzW3Bvc3RGbHVzaEluZGV4XSkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGFjdGl2ZVBvc3RGbHVzaENic1twb3N0Rmx1c2hJbmRleF0oKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgYWN0aXZlUG9zdEZsdXNoQ2JzID0gbnVsbDtcclxuICAgICAgICBwb3N0Rmx1c2hJbmRleCA9IDA7XHJcbiAgICB9XHJcbn1cclxuY29uc3QgZ2V0SWQgPSAoam9iKSA9PiBqb2IuaWQgPT0gbnVsbCA/IEluZmluaXR5IDogam9iLmlkO1xyXG5mdW5jdGlvbiBmbHVzaEpvYnMoc2Vlbikge1xyXG4gICAgaXNGbHVzaFBlbmRpbmcgPSBmYWxzZTtcclxuICAgIGlzRmx1c2hpbmcgPSB0cnVlO1xyXG4gICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgIHNlZW4gPSBzZWVuIHx8IG5ldyBNYXAoKTtcclxuICAgIH1cclxuICAgIGZsdXNoUHJlRmx1c2hDYnMoc2Vlbik7XHJcbiAgICAvLyBTb3J0IHF1ZXVlIGJlZm9yZSBmbHVzaC5cclxuICAgIC8vIFRoaXMgZW5zdXJlcyB0aGF0OlxyXG4gICAgLy8gMS4gQ29tcG9uZW50cyBhcmUgdXBkYXRlZCBmcm9tIHBhcmVudCB0byBjaGlsZC4gKGJlY2F1c2UgcGFyZW50IGlzIGFsd2F5c1xyXG4gICAgLy8gICAgY3JlYXRlZCBiZWZvcmUgdGhlIGNoaWxkIHNvIGl0cyByZW5kZXIgZWZmZWN0IHdpbGwgaGF2ZSBzbWFsbGVyXHJcbiAgICAvLyAgICBwcmlvcml0eSBudW1iZXIpXHJcbiAgICAvLyAyLiBJZiBhIGNvbXBvbmVudCBpcyB1bm1vdW50ZWQgZHVyaW5nIGEgcGFyZW50IGNvbXBvbmVudCdzIHVwZGF0ZSxcclxuICAgIC8vICAgIGl0cyB1cGRhdGUgY2FuIGJlIHNraXBwZWQuXHJcbiAgICBxdWV1ZS5zb3J0KChhLCBiKSA9PiBnZXRJZChhKSAtIGdldElkKGIpKTtcclxuICAgIC8vIGNvbmRpdGlvbmFsIHVzYWdlIG9mIGNoZWNrUmVjdXJzaXZlVXBkYXRlIG11c3QgYmUgZGV0ZXJtaW5lZCBvdXQgb2ZcclxuICAgIC8vIHRyeSAuLi4gY2F0Y2ggYmxvY2sgc2luY2UgUm9sbHVwIGJ5IGRlZmF1bHQgZGUtb3B0aW1pemVzIHRyZWVzaGFraW5nXHJcbiAgICAvLyBpbnNpZGUgdHJ5LWNhdGNoLiBUaGlzIGNhbiBsZWF2ZSBhbGwgd2FybmluZyBjb2RlIHVuc2hha2VkLiBBbHRob3VnaFxyXG4gICAgLy8gdGhleSB3b3VsZCBnZXQgZXZlbnR1YWxseSBzaGFrZW4gYnkgYSBtaW5pZmllciBsaWtlIHRlcnNlciwgc29tZSBtaW5pZmllcnNcclxuICAgIC8vIHdvdWxkIGZhaWwgdG8gZG8gdGhhdCAoZS5nLiBodHRwczovL2dpdGh1Yi5jb20vZXZhbncvZXNidWlsZC9pc3N1ZXMvMTYxMClcclxuICAgIGNvbnN0IGNoZWNrID0gKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpXHJcbiAgICAgICAgPyAoam9iKSA9PiBjaGVja1JlY3Vyc2l2ZVVwZGF0ZXMoc2Vlbiwgam9iKVxyXG4gICAgICAgIDogTk9PUDtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgZm9yIChmbHVzaEluZGV4ID0gMDsgZmx1c2hJbmRleCA8IHF1ZXVlLmxlbmd0aDsgZmx1c2hJbmRleCsrKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGpvYiA9IHF1ZXVlW2ZsdXNoSW5kZXhdO1xyXG4gICAgICAgICAgICBpZiAoam9iICYmIGpvYi5hY3RpdmUgIT09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmIGNoZWNrKGpvYikpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGBydW5uaW5nOmAsIGpvYi5pZClcclxuICAgICAgICAgICAgICAgIGNhbGxXaXRoRXJyb3JIYW5kbGluZyhqb2IsIG51bGwsIDE0IC8qIFNDSEVEVUxFUiAqLyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBmaW5hbGx5IHtcclxuICAgICAgICBmbHVzaEluZGV4ID0gMDtcclxuICAgICAgICBxdWV1ZS5sZW5ndGggPSAwO1xyXG4gICAgICAgIGZsdXNoUG9zdEZsdXNoQ2JzKHNlZW4pO1xyXG4gICAgICAgIGlzRmx1c2hpbmcgPSBmYWxzZTtcclxuICAgICAgICBjdXJyZW50Rmx1c2hQcm9taXNlID0gbnVsbDtcclxuICAgICAgICAvLyBzb21lIHBvc3RGbHVzaENiIHF1ZXVlZCBqb2JzIVxyXG4gICAgICAgIC8vIGtlZXAgZmx1c2hpbmcgdW50aWwgaXQgZHJhaW5zLlxyXG4gICAgICAgIGlmIChxdWV1ZS5sZW5ndGggfHxcclxuICAgICAgICAgICAgcGVuZGluZ1ByZUZsdXNoQ2JzLmxlbmd0aCB8fFxyXG4gICAgICAgICAgICBwZW5kaW5nUG9zdEZsdXNoQ2JzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBmbHVzaEpvYnMoc2Vlbik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGNoZWNrUmVjdXJzaXZlVXBkYXRlcyhzZWVuLCBmbikge1xyXG4gICAgaWYgKCFzZWVuLmhhcyhmbikpIHtcclxuICAgICAgICBzZWVuLnNldChmbiwgMSk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBjb25zdCBjb3VudCA9IHNlZW4uZ2V0KGZuKTtcclxuICAgICAgICBpZiAoY291bnQgPiBSRUNVUlNJT05fTElNSVQpIHtcclxuICAgICAgICAgICAgY29uc3QgaW5zdGFuY2UgPSBmbi5vd25lckluc3RhbmNlO1xyXG4gICAgICAgICAgICBjb25zdCBjb21wb25lbnROYW1lID0gaW5zdGFuY2UgJiYgZ2V0Q29tcG9uZW50TmFtZShpbnN0YW5jZS50eXBlKTtcclxuICAgICAgICAgICAgd2FybihgTWF4aW11bSByZWN1cnNpdmUgdXBkYXRlcyBleGNlZWRlZCR7Y29tcG9uZW50TmFtZSA/IGAgaW4gY29tcG9uZW50IDwke2NvbXBvbmVudE5hbWV9PmAgOiBgYH0uIGAgK1xyXG4gICAgICAgICAgICAgICAgYFRoaXMgbWVhbnMgeW91IGhhdmUgYSByZWFjdGl2ZSBlZmZlY3QgdGhhdCBpcyBtdXRhdGluZyBpdHMgb3duIGAgK1xyXG4gICAgICAgICAgICAgICAgYGRlcGVuZGVuY2llcyBhbmQgdGh1cyByZWN1cnNpdmVseSB0cmlnZ2VyaW5nIGl0c2VsZi4gUG9zc2libGUgc291cmNlcyBgICtcclxuICAgICAgICAgICAgICAgIGBpbmNsdWRlIGNvbXBvbmVudCB0ZW1wbGF0ZSwgcmVuZGVyIGZ1bmN0aW9uLCB1cGRhdGVkIGhvb2sgb3IgYCArXHJcbiAgICAgICAgICAgICAgICBgd2F0Y2hlciBzb3VyY2UgZnVuY3Rpb24uYCk7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgc2Vlbi5zZXQoZm4sIGNvdW50ICsgMSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XG5cbi8qIGVzbGludC1kaXNhYmxlIG5vLXJlc3RyaWN0ZWQtZ2xvYmFscyAqL1xyXG5sZXQgaXNIbXJVcGRhdGluZyA9IGZhbHNlO1xyXG5jb25zdCBobXJEaXJ0eUNvbXBvbmVudHMgPSBuZXcgU2V0KCk7XHJcbi8vIEV4cG9zZSB0aGUgSE1SIHJ1bnRpbWUgb24gdGhlIGdsb2JhbCBvYmplY3RcclxuLy8gVGhpcyBtYWtlcyBpdCBlbnRpcmVseSB0cmVlLXNoYWthYmxlIHdpdGhvdXQgcG9sbHV0aW5nIHRoZSBleHBvcnRzIGFuZCBtYWtlc1xyXG4vLyBpdCBlYXNpZXIgdG8gYmUgdXNlZCBpbiB0b29saW5ncyBsaWtlIHZ1ZS1sb2FkZXJcclxuLy8gTm90ZTogZm9yIGEgY29tcG9uZW50IHRvIGJlIGVsaWdpYmxlIGZvciBITVIgaXQgYWxzbyBuZWVkcyB0aGUgX19obXJJZCBvcHRpb25cclxuLy8gdG8gYmUgc2V0IHNvIHRoYXQgaXRzIGluc3RhbmNlcyBjYW4gYmUgcmVnaXN0ZXJlZCAvIHJlbW92ZWQuXHJcbmlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgIGdldEdsb2JhbFRoaXMoKS5fX1ZVRV9ITVJfUlVOVElNRV9fID0ge1xyXG4gICAgICAgIGNyZWF0ZVJlY29yZDogdHJ5V3JhcChjcmVhdGVSZWNvcmQpLFxyXG4gICAgICAgIHJlcmVuZGVyOiB0cnlXcmFwKHJlcmVuZGVyKSxcclxuICAgICAgICByZWxvYWQ6IHRyeVdyYXAocmVsb2FkKVxyXG4gICAgfTtcclxufVxyXG5jb25zdCBtYXAgPSBuZXcgTWFwKCk7XHJcbmZ1bmN0aW9uIHJlZ2lzdGVySE1SKGluc3RhbmNlKSB7XHJcbiAgICBjb25zdCBpZCA9IGluc3RhbmNlLnR5cGUuX19obXJJZDtcclxuICAgIGxldCByZWNvcmQgPSBtYXAuZ2V0KGlkKTtcclxuICAgIGlmICghcmVjb3JkKSB7XHJcbiAgICAgICAgY3JlYXRlUmVjb3JkKGlkLCBpbnN0YW5jZS50eXBlKTtcclxuICAgICAgICByZWNvcmQgPSBtYXAuZ2V0KGlkKTtcclxuICAgIH1cclxuICAgIHJlY29yZC5pbnN0YW5jZXMuYWRkKGluc3RhbmNlKTtcclxufVxyXG5mdW5jdGlvbiB1bnJlZ2lzdGVySE1SKGluc3RhbmNlKSB7XHJcbiAgICBtYXAuZ2V0KGluc3RhbmNlLnR5cGUuX19obXJJZCkuaW5zdGFuY2VzLmRlbGV0ZShpbnN0YW5jZSk7XHJcbn1cclxuZnVuY3Rpb24gY3JlYXRlUmVjb3JkKGlkLCBpbml0aWFsRGVmKSB7XHJcbiAgICBpZiAobWFwLmhhcyhpZCkpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBtYXAuc2V0KGlkLCB7XHJcbiAgICAgICAgaW5pdGlhbERlZjogbm9ybWFsaXplQ2xhc3NDb21wb25lbnQoaW5pdGlhbERlZiksXHJcbiAgICAgICAgaW5zdGFuY2VzOiBuZXcgU2V0KClcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHRydWU7XHJcbn1cclxuZnVuY3Rpb24gbm9ybWFsaXplQ2xhc3NDb21wb25lbnQoY29tcG9uZW50KSB7XHJcbiAgICByZXR1cm4gaXNDbGFzc0NvbXBvbmVudChjb21wb25lbnQpID8gY29tcG9uZW50Ll9fdmNjT3B0cyA6IGNvbXBvbmVudDtcclxufVxyXG5mdW5jdGlvbiByZXJlbmRlcihpZCwgbmV3UmVuZGVyKSB7XHJcbiAgICBjb25zdCByZWNvcmQgPSBtYXAuZ2V0KGlkKTtcclxuICAgIGlmICghcmVjb3JkKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgLy8gdXBkYXRlIGluaXRpYWwgcmVjb3JkIChmb3Igbm90LXlldC1yZW5kZXJlZCBjb21wb25lbnQpXHJcbiAgICByZWNvcmQuaW5pdGlhbERlZi5yZW5kZXIgPSBuZXdSZW5kZXI7XHJcbiAgICBbLi4ucmVjb3JkLmluc3RhbmNlc10uZm9yRWFjaChpbnN0YW5jZSA9PiB7XHJcbiAgICAgICAgaWYgKG5ld1JlbmRlcikge1xyXG4gICAgICAgICAgICBpbnN0YW5jZS5yZW5kZXIgPSBuZXdSZW5kZXI7XHJcbiAgICAgICAgICAgIG5vcm1hbGl6ZUNsYXNzQ29tcG9uZW50KGluc3RhbmNlLnR5cGUpLnJlbmRlciA9IG5ld1JlbmRlcjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaW5zdGFuY2UucmVuZGVyQ2FjaGUgPSBbXTtcclxuICAgICAgICAvLyB0aGlzIGZsYWcgZm9yY2VzIGNoaWxkIGNvbXBvbmVudHMgd2l0aCBzbG90IGNvbnRlbnQgdG8gdXBkYXRlXHJcbiAgICAgICAgaXNIbXJVcGRhdGluZyA9IHRydWU7XHJcbiAgICAgICAgaW5zdGFuY2UudXBkYXRlKCk7XHJcbiAgICAgICAgaXNIbXJVcGRhdGluZyA9IGZhbHNlO1xyXG4gICAgfSk7XHJcbn1cclxuZnVuY3Rpb24gcmVsb2FkKGlkLCBuZXdDb21wKSB7XHJcbiAgICBjb25zdCByZWNvcmQgPSBtYXAuZ2V0KGlkKTtcclxuICAgIGlmICghcmVjb3JkKVxyXG4gICAgICAgIHJldHVybjtcclxuICAgIG5ld0NvbXAgPSBub3JtYWxpemVDbGFzc0NvbXBvbmVudChuZXdDb21wKTtcclxuICAgIC8vIHVwZGF0ZSBpbml0aWFsIGRlZiAoZm9yIG5vdC15ZXQtcmVuZGVyZWQgY29tcG9uZW50cylcclxuICAgIHVwZGF0ZUNvbXBvbmVudERlZihyZWNvcmQuaW5pdGlhbERlZiwgbmV3Q29tcCk7XHJcbiAgICAvLyBjcmVhdGUgYSBzbmFwc2hvdCB3aGljaCBhdm9pZHMgdGhlIHNldCBiZWluZyBtdXRhdGVkIGR1cmluZyB1cGRhdGVzXHJcbiAgICBjb25zdCBpbnN0YW5jZXMgPSBbLi4ucmVjb3JkLmluc3RhbmNlc107XHJcbiAgICBmb3IgKGNvbnN0IGluc3RhbmNlIG9mIGluc3RhbmNlcykge1xyXG4gICAgICAgIGNvbnN0IG9sZENvbXAgPSBub3JtYWxpemVDbGFzc0NvbXBvbmVudChpbnN0YW5jZS50eXBlKTtcclxuICAgICAgICBpZiAoIWhtckRpcnR5Q29tcG9uZW50cy5oYXMob2xkQ29tcCkpIHtcclxuICAgICAgICAgICAgLy8gMS4gVXBkYXRlIGV4aXN0aW5nIGNvbXAgZGVmaW5pdGlvbiB0byBtYXRjaCBuZXcgb25lXHJcbiAgICAgICAgICAgIGlmIChvbGRDb21wICE9PSByZWNvcmQuaW5pdGlhbERlZikge1xyXG4gICAgICAgICAgICAgICAgdXBkYXRlQ29tcG9uZW50RGVmKG9sZENvbXAsIG5ld0NvbXApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIDIuIG1hcmsgZGVmaW5pdGlvbiBkaXJ0eS4gVGhpcyBmb3JjZXMgdGhlIHJlbmRlcmVyIHRvIHJlcGxhY2UgdGhlXHJcbiAgICAgICAgICAgIC8vIGNvbXBvbmVudCBvbiBwYXRjaC5cclxuICAgICAgICAgICAgaG1yRGlydHlDb21wb25lbnRzLmFkZChvbGRDb21wKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gMy4gaW52YWxpZGF0ZSBvcHRpb25zIHJlc29sdXRpb24gY2FjaGVcclxuICAgICAgICBpbnN0YW5jZS5hcHBDb250ZXh0Lm9wdGlvbnNDYWNoZS5kZWxldGUoaW5zdGFuY2UudHlwZSk7XHJcbiAgICAgICAgLy8gNC4gYWN0dWFsbHkgdXBkYXRlXHJcbiAgICAgICAgaWYgKGluc3RhbmNlLmNlUmVsb2FkKSB7XHJcbiAgICAgICAgICAgIC8vIGN1c3RvbSBlbGVtZW50XHJcbiAgICAgICAgICAgIGhtckRpcnR5Q29tcG9uZW50cy5hZGQob2xkQ29tcCk7XHJcbiAgICAgICAgICAgIGluc3RhbmNlLmNlUmVsb2FkKG5ld0NvbXAuc3R5bGVzKTtcclxuICAgICAgICAgICAgaG1yRGlydHlDb21wb25lbnRzLmRlbGV0ZShvbGRDb21wKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoaW5zdGFuY2UucGFyZW50KSB7XHJcbiAgICAgICAgICAgIC8vIDQuIEZvcmNlIHRoZSBwYXJlbnQgaW5zdGFuY2UgdG8gcmUtcmVuZGVyLiBUaGlzIHdpbGwgY2F1c2UgYWxsIHVwZGF0ZWRcclxuICAgICAgICAgICAgLy8gY29tcG9uZW50cyB0byBiZSB1bm1vdW50ZWQgYW5kIHJlLW1vdW50ZWQuIFF1ZXVlIHRoZSB1cGRhdGUgc28gdGhhdCB3ZVxyXG4gICAgICAgICAgICAvLyBkb24ndCBlbmQgdXAgZm9yY2luZyB0aGUgc2FtZSBwYXJlbnQgdG8gcmUtcmVuZGVyIG11bHRpcGxlIHRpbWVzLlxyXG4gICAgICAgICAgICBxdWV1ZUpvYihpbnN0YW5jZS5wYXJlbnQudXBkYXRlKTtcclxuICAgICAgICAgICAgLy8gaW5zdGFuY2UgaXMgdGhlIGlubmVyIGNvbXBvbmVudCBvZiBhbiBhc3luYyBjdXN0b20gZWxlbWVudFxyXG4gICAgICAgICAgICAvLyBpbnZva2UgdG8gcmVzZXQgc3R5bGVzXHJcbiAgICAgICAgICAgIGlmIChpbnN0YW5jZS5wYXJlbnQudHlwZS5fX2FzeW5jTG9hZGVyICYmXHJcbiAgICAgICAgICAgICAgICBpbnN0YW5jZS5wYXJlbnQuY2VSZWxvYWQpIHtcclxuICAgICAgICAgICAgICAgIGluc3RhbmNlLnBhcmVudC5jZVJlbG9hZChuZXdDb21wLnN0eWxlcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoaW5zdGFuY2UuYXBwQ29udGV4dC5yZWxvYWQpIHtcclxuICAgICAgICAgICAgLy8gcm9vdCBpbnN0YW5jZSBtb3VudGVkIHZpYSBjcmVhdGVBcHAoKSBoYXMgYSByZWxvYWQgbWV0aG9kXHJcbiAgICAgICAgICAgIGluc3RhbmNlLmFwcENvbnRleHQucmVsb2FkKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgICAgIC8vIHJvb3QgaW5zdGFuY2UgaW5zaWRlIHRyZWUgY3JlYXRlZCB2aWEgcmF3IHJlbmRlcigpLiBGb3JjZSByZWxvYWQuXHJcbiAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUud2FybignW0hNUl0gUm9vdCBvciBtYW51YWxseSBtb3VudGVkIGluc3RhbmNlIG1vZGlmaWVkLiBGdWxsIHJlbG9hZCByZXF1aXJlZC4nKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyA1LiBtYWtlIHN1cmUgdG8gY2xlYW51cCBkaXJ0eSBobXIgY29tcG9uZW50cyBhZnRlciB1cGRhdGVcclxuICAgIHF1ZXVlUG9zdEZsdXNoQ2IoKCkgPT4ge1xyXG4gICAgICAgIGZvciAoY29uc3QgaW5zdGFuY2Ugb2YgaW5zdGFuY2VzKSB7XHJcbiAgICAgICAgICAgIGhtckRpcnR5Q29tcG9uZW50cy5kZWxldGUobm9ybWFsaXplQ2xhc3NDb21wb25lbnQoaW5zdGFuY2UudHlwZSkpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59XHJcbmZ1bmN0aW9uIHVwZGF0ZUNvbXBvbmVudERlZihvbGRDb21wLCBuZXdDb21wKSB7XHJcbiAgICBleHRlbmQob2xkQ29tcCwgbmV3Q29tcCk7XHJcbiAgICBmb3IgKGNvbnN0IGtleSBpbiBvbGRDb21wKSB7XHJcbiAgICAgICAgaWYgKGtleSAhPT0gJ19fZmlsZScgJiYgIShrZXkgaW4gbmV3Q29tcCkpIHtcclxuICAgICAgICAgICAgZGVsZXRlIG9sZENvbXBba2V5XTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gdHJ5V3JhcChmbikge1xyXG4gICAgcmV0dXJuIChpZCwgYXJnKSA9PiB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgcmV0dXJuIGZuKGlkLCBhcmcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGUpO1xyXG4gICAgICAgICAgICBjb25zb2xlLndhcm4oYFtITVJdIFNvbWV0aGluZyB3ZW50IHdyb25nIGR1cmluZyBWdWUgY29tcG9uZW50IGhvdC1yZWxvYWQuIGAgK1xyXG4gICAgICAgICAgICAgICAgYEZ1bGwgcmVsb2FkIHJlcXVpcmVkLmApO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn1cblxubGV0IGRldnRvb2xzO1xyXG5sZXQgYnVmZmVyID0gW107XHJcbmxldCBkZXZ0b29sc05vdEluc3RhbGxlZCA9IGZhbHNlO1xyXG5mdW5jdGlvbiBlbWl0KGV2ZW50LCAuLi5hcmdzKSB7XHJcbiAgICBpZiAoZGV2dG9vbHMpIHtcclxuICAgICAgICBkZXZ0b29scy5lbWl0KGV2ZW50LCAuLi5hcmdzKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKCFkZXZ0b29sc05vdEluc3RhbGxlZCkge1xyXG4gICAgICAgIGJ1ZmZlci5wdXNoKHsgZXZlbnQsIGFyZ3MgfSk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gc2V0RGV2dG9vbHNIb29rKGhvb2ssIHRhcmdldCkge1xyXG4gICAgdmFyIF9hLCBfYjtcclxuICAgIGRldnRvb2xzID0gaG9vaztcclxuICAgIGlmIChkZXZ0b29scykge1xyXG4gICAgICAgIGRldnRvb2xzLmVuYWJsZWQgPSB0cnVlO1xyXG4gICAgICAgIGJ1ZmZlci5mb3JFYWNoKCh7IGV2ZW50LCBhcmdzIH0pID0+IGRldnRvb2xzLmVtaXQoZXZlbnQsIC4uLmFyZ3MpKTtcclxuICAgICAgICBidWZmZXIgPSBbXTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKFxyXG4gICAgLy8gaGFuZGxlIGxhdGUgZGV2dG9vbHMgaW5qZWN0aW9uIC0gb25seSBkbyB0aGlzIGlmIHdlIGFyZSBpbiBhbiBhY3R1YWxcclxuICAgIC8vIGJyb3dzZXIgZW52aXJvbm1lbnQgdG8gYXZvaWQgdGhlIHRpbWVyIGhhbmRsZSBzdGFsbGluZyB0ZXN0IHJ1bm5lciBleGl0XHJcbiAgICAvLyAoIzQ4MTUpXHJcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcmVzdHJpY3RlZC1nbG9iYWxzXHJcbiAgICB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJlxyXG4gICAgICAgIC8vIHNvbWUgZW52cyBtb2NrIHdpbmRvdyBidXQgbm90IGZ1bGx5XHJcbiAgICAgICAgd2luZG93LkhUTUxFbGVtZW50ICYmXHJcbiAgICAgICAgLy8gYWxzbyBleGNsdWRlIGpzZG9tXHJcbiAgICAgICAgISgoX2IgPSAoX2EgPSB3aW5kb3cubmF2aWdhdG9yKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EudXNlckFnZW50KSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IuaW5jbHVkZXMoJ2pzZG9tJykpKSB7XHJcbiAgICAgICAgY29uc3QgcmVwbGF5ID0gKHRhcmdldC5fX1ZVRV9ERVZUT09MU19IT09LX1JFUExBWV9fID1cclxuICAgICAgICAgICAgdGFyZ2V0Ll9fVlVFX0RFVlRPT0xTX0hPT0tfUkVQTEFZX18gfHwgW10pO1xyXG4gICAgICAgIHJlcGxheS5wdXNoKChuZXdIb29rKSA9PiB7XHJcbiAgICAgICAgICAgIHNldERldnRvb2xzSG9vayhuZXdIb29rLCB0YXJnZXQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8vIGNsZWFyIGJ1ZmZlciBhZnRlciAzcyAtIHRoZSB1c2VyIHByb2JhYmx5IGRvZXNuJ3QgaGF2ZSBkZXZ0b29scyBpbnN0YWxsZWRcclxuICAgICAgICAvLyBhdCBhbGwsIGFuZCBrZWVwaW5nIHRoZSBidWZmZXIgd2lsbCBjYXVzZSBtZW1vcnkgbGVha3MgKCM0NzM4KVxyXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoIWRldnRvb2xzKSB7XHJcbiAgICAgICAgICAgICAgICB0YXJnZXQuX19WVUVfREVWVE9PTFNfSE9PS19SRVBMQVlfXyA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBkZXZ0b29sc05vdEluc3RhbGxlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBidWZmZXIgPSBbXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIDMwMDApO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgLy8gbm9uLWJyb3dzZXIgZW52LCBhc3N1bWUgbm90IGluc3RhbGxlZFxyXG4gICAgICAgIGRldnRvb2xzTm90SW5zdGFsbGVkID0gdHJ1ZTtcclxuICAgICAgICBidWZmZXIgPSBbXTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBkZXZ0b29sc0luaXRBcHAoYXBwLCB2ZXJzaW9uKSB7XHJcbiAgICBlbWl0KFwiYXBwOmluaXRcIiAvKiBBUFBfSU5JVCAqLywgYXBwLCB2ZXJzaW9uLCB7XHJcbiAgICAgICAgRnJhZ21lbnQsXHJcbiAgICAgICAgVGV4dCxcclxuICAgICAgICBDb21tZW50LFxyXG4gICAgICAgIFN0YXRpY1xyXG4gICAgfSk7XHJcbn1cclxuZnVuY3Rpb24gZGV2dG9vbHNVbm1vdW50QXBwKGFwcCkge1xyXG4gICAgZW1pdChcImFwcDp1bm1vdW50XCIgLyogQVBQX1VOTU9VTlQgKi8sIGFwcCk7XHJcbn1cclxuY29uc3QgZGV2dG9vbHNDb21wb25lbnRBZGRlZCA9IC8qI19fUFVSRV9fKi8gY3JlYXRlRGV2dG9vbHNDb21wb25lbnRIb29rKFwiY29tcG9uZW50OmFkZGVkXCIgLyogQ09NUE9ORU5UX0FEREVEICovKTtcclxuY29uc3QgZGV2dG9vbHNDb21wb25lbnRVcGRhdGVkID0gXHJcbi8qI19fUFVSRV9fKi8gY3JlYXRlRGV2dG9vbHNDb21wb25lbnRIb29rKFwiY29tcG9uZW50OnVwZGF0ZWRcIiAvKiBDT01QT05FTlRfVVBEQVRFRCAqLyk7XHJcbmNvbnN0IGRldnRvb2xzQ29tcG9uZW50UmVtb3ZlZCA9IFxyXG4vKiNfX1BVUkVfXyovIGNyZWF0ZURldnRvb2xzQ29tcG9uZW50SG9vayhcImNvbXBvbmVudDpyZW1vdmVkXCIgLyogQ09NUE9ORU5UX1JFTU9WRUQgKi8pO1xyXG5mdW5jdGlvbiBjcmVhdGVEZXZ0b29sc0NvbXBvbmVudEhvb2soaG9vaykge1xyXG4gICAgcmV0dXJuIChjb21wb25lbnQpID0+IHtcclxuICAgICAgICBlbWl0KGhvb2ssIGNvbXBvbmVudC5hcHBDb250ZXh0LmFwcCwgY29tcG9uZW50LnVpZCwgY29tcG9uZW50LnBhcmVudCA/IGNvbXBvbmVudC5wYXJlbnQudWlkIDogdW5kZWZpbmVkLCBjb21wb25lbnQpO1xyXG4gICAgfTtcclxufVxyXG5jb25zdCBkZXZ0b29sc1BlcmZTdGFydCA9IC8qI19fUFVSRV9fKi8gY3JlYXRlRGV2dG9vbHNQZXJmb3JtYW5jZUhvb2soXCJwZXJmOnN0YXJ0XCIgLyogUEVSRk9STUFOQ0VfU1RBUlQgKi8pO1xyXG5jb25zdCBkZXZ0b29sc1BlcmZFbmQgPSAvKiNfX1BVUkVfXyovIGNyZWF0ZURldnRvb2xzUGVyZm9ybWFuY2VIb29rKFwicGVyZjplbmRcIiAvKiBQRVJGT1JNQU5DRV9FTkQgKi8pO1xyXG5mdW5jdGlvbiBjcmVhdGVEZXZ0b29sc1BlcmZvcm1hbmNlSG9vayhob29rKSB7XHJcbiAgICByZXR1cm4gKGNvbXBvbmVudCwgdHlwZSwgdGltZSkgPT4ge1xyXG4gICAgICAgIGVtaXQoaG9vaywgY29tcG9uZW50LmFwcENvbnRleHQuYXBwLCBjb21wb25lbnQudWlkLCBjb21wb25lbnQsIHR5cGUsIHRpbWUpO1xyXG4gICAgfTtcclxufVxyXG5mdW5jdGlvbiBkZXZ0b29sc0NvbXBvbmVudEVtaXQoY29tcG9uZW50LCBldmVudCwgcGFyYW1zKSB7XHJcbiAgICBlbWl0KFwiY29tcG9uZW50OmVtaXRcIiAvKiBDT01QT05FTlRfRU1JVCAqLywgY29tcG9uZW50LmFwcENvbnRleHQuYXBwLCBjb21wb25lbnQsIGV2ZW50LCBwYXJhbXMpO1xyXG59XG5cbmZ1bmN0aW9uIGVtaXQkMShpbnN0YW5jZSwgZXZlbnQsIC4uLnJhd0FyZ3MpIHtcclxuICAgIGNvbnN0IHByb3BzID0gaW5zdGFuY2Uudm5vZGUucHJvcHMgfHwgRU1QVFlfT0JKO1xyXG4gICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgIGNvbnN0IHsgZW1pdHNPcHRpb25zLCBwcm9wc09wdGlvbnM6IFtwcm9wc09wdGlvbnNdIH0gPSBpbnN0YW5jZTtcclxuICAgICAgICBpZiAoZW1pdHNPcHRpb25zKSB7XHJcbiAgICAgICAgICAgIGlmICghKGV2ZW50IGluIGVtaXRzT3B0aW9ucykgJiZcclxuICAgICAgICAgICAgICAgICEoZmFsc2UgKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFwcm9wc09wdGlvbnMgfHwgISh0b0hhbmRsZXJLZXkoZXZlbnQpIGluIHByb3BzT3B0aW9ucykpIHtcclxuICAgICAgICAgICAgICAgICAgICB3YXJuKGBDb21wb25lbnQgZW1pdHRlZCBldmVudCBcIiR7ZXZlbnR9XCIgYnV0IGl0IGlzIG5laXRoZXIgZGVjbGFyZWQgaW4gYCArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGB0aGUgZW1pdHMgb3B0aW9uIG5vciBhcyBhbiBcIiR7dG9IYW5kbGVyS2V5KGV2ZW50KX1cIiBwcm9wLmApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdmFsaWRhdG9yID0gZW1pdHNPcHRpb25zW2V2ZW50XTtcclxuICAgICAgICAgICAgICAgIGlmIChpc0Z1bmN0aW9uKHZhbGlkYXRvcikpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpc1ZhbGlkID0gdmFsaWRhdG9yKC4uLnJhd0FyZ3MpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghaXNWYWxpZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3YXJuKGBJbnZhbGlkIGV2ZW50IGFyZ3VtZW50czogZXZlbnQgdmFsaWRhdGlvbiBmYWlsZWQgZm9yIGV2ZW50IFwiJHtldmVudH1cIi5gKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBsZXQgYXJncyA9IHJhd0FyZ3M7XHJcbiAgICBjb25zdCBpc01vZGVsTGlzdGVuZXIgPSBldmVudC5zdGFydHNXaXRoKCd1cGRhdGU6Jyk7XHJcbiAgICAvLyBmb3Igdi1tb2RlbCB1cGRhdGU6eHh4IGV2ZW50cywgYXBwbHkgbW9kaWZpZXJzIG9uIGFyZ3NcclxuICAgIGNvbnN0IG1vZGVsQXJnID0gaXNNb2RlbExpc3RlbmVyICYmIGV2ZW50LnNsaWNlKDcpO1xyXG4gICAgaWYgKG1vZGVsQXJnICYmIG1vZGVsQXJnIGluIHByb3BzKSB7XHJcbiAgICAgICAgY29uc3QgbW9kaWZpZXJzS2V5ID0gYCR7bW9kZWxBcmcgPT09ICdtb2RlbFZhbHVlJyA/ICdtb2RlbCcgOiBtb2RlbEFyZ31Nb2RpZmllcnNgO1xyXG4gICAgICAgIGNvbnN0IHsgbnVtYmVyLCB0cmltIH0gPSBwcm9wc1ttb2RpZmllcnNLZXldIHx8IEVNUFRZX09CSjtcclxuICAgICAgICBpZiAodHJpbSkge1xyXG4gICAgICAgICAgICBhcmdzID0gcmF3QXJncy5tYXAoYSA9PiBhLnRyaW0oKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKG51bWJlcikge1xyXG4gICAgICAgICAgICBhcmdzID0gcmF3QXJncy5tYXAodG9OdW1iZXIpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgfHwgX19WVUVfUFJPRF9ERVZUT09MU19fKSB7XHJcbiAgICAgICAgZGV2dG9vbHNDb21wb25lbnRFbWl0KGluc3RhbmNlLCBldmVudCwgYXJncyk7XHJcbiAgICB9XHJcbiAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgY29uc3QgbG93ZXJDYXNlRXZlbnQgPSBldmVudC50b0xvd2VyQ2FzZSgpO1xyXG4gICAgICAgIGlmIChsb3dlckNhc2VFdmVudCAhPT0gZXZlbnQgJiYgcHJvcHNbdG9IYW5kbGVyS2V5KGxvd2VyQ2FzZUV2ZW50KV0pIHtcclxuICAgICAgICAgICAgd2FybihgRXZlbnQgXCIke2xvd2VyQ2FzZUV2ZW50fVwiIGlzIGVtaXR0ZWQgaW4gY29tcG9uZW50IGAgK1xyXG4gICAgICAgICAgICAgICAgYCR7Zm9ybWF0Q29tcG9uZW50TmFtZShpbnN0YW5jZSwgaW5zdGFuY2UudHlwZSl9IGJ1dCB0aGUgaGFuZGxlciBpcyByZWdpc3RlcmVkIGZvciBcIiR7ZXZlbnR9XCIuIGAgK1xyXG4gICAgICAgICAgICAgICAgYE5vdGUgdGhhdCBIVE1MIGF0dHJpYnV0ZXMgYXJlIGNhc2UtaW5zZW5zaXRpdmUgYW5kIHlvdSBjYW5ub3QgdXNlIGAgK1xyXG4gICAgICAgICAgICAgICAgYHYtb24gdG8gbGlzdGVuIHRvIGNhbWVsQ2FzZSBldmVudHMgd2hlbiB1c2luZyBpbi1ET00gdGVtcGxhdGVzLiBgICtcclxuICAgICAgICAgICAgICAgIGBZb3Ugc2hvdWxkIHByb2JhYmx5IHVzZSBcIiR7aHlwaGVuYXRlKGV2ZW50KX1cIiBpbnN0ZWFkIG9mIFwiJHtldmVudH1cIi5gKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBsZXQgaGFuZGxlck5hbWU7XHJcbiAgICBsZXQgaGFuZGxlciA9IHByb3BzWyhoYW5kbGVyTmFtZSA9IHRvSGFuZGxlcktleShldmVudCkpXSB8fFxyXG4gICAgICAgIC8vIGFsc28gdHJ5IGNhbWVsQ2FzZSBldmVudCBoYW5kbGVyICgjMjI0OSlcclxuICAgICAgICBwcm9wc1soaGFuZGxlck5hbWUgPSB0b0hhbmRsZXJLZXkoY2FtZWxpemUoZXZlbnQpKSldO1xyXG4gICAgLy8gZm9yIHYtbW9kZWwgdXBkYXRlOnh4eCBldmVudHMsIGFsc28gdHJpZ2dlciBrZWJhYi1jYXNlIGVxdWl2YWxlbnRcclxuICAgIC8vIGZvciBwcm9wcyBwYXNzZWQgdmlhIGtlYmFiLWNhc2VcclxuICAgIGlmICghaGFuZGxlciAmJiBpc01vZGVsTGlzdGVuZXIpIHtcclxuICAgICAgICBoYW5kbGVyID0gcHJvcHNbKGhhbmRsZXJOYW1lID0gdG9IYW5kbGVyS2V5KGh5cGhlbmF0ZShldmVudCkpKV07XHJcbiAgICB9XHJcbiAgICBpZiAoaGFuZGxlcikge1xyXG4gICAgICAgIGNhbGxXaXRoQXN5bmNFcnJvckhhbmRsaW5nKGhhbmRsZXIsIGluc3RhbmNlLCA2IC8qIENPTVBPTkVOVF9FVkVOVF9IQU5ETEVSICovLCBhcmdzKTtcclxuICAgIH1cclxuICAgIGNvbnN0IG9uY2VIYW5kbGVyID0gcHJvcHNbaGFuZGxlck5hbWUgKyBgT25jZWBdO1xyXG4gICAgaWYgKG9uY2VIYW5kbGVyKSB7XHJcbiAgICAgICAgaWYgKCFpbnN0YW5jZS5lbWl0dGVkKSB7XHJcbiAgICAgICAgICAgIGluc3RhbmNlLmVtaXR0ZWQgPSB7fTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoaW5zdGFuY2UuZW1pdHRlZFtoYW5kbGVyTmFtZV0pIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpbnN0YW5jZS5lbWl0dGVkW2hhbmRsZXJOYW1lXSA9IHRydWU7XHJcbiAgICAgICAgY2FsbFdpdGhBc3luY0Vycm9ySGFuZGxpbmcob25jZUhhbmRsZXIsIGluc3RhbmNlLCA2IC8qIENPTVBPTkVOVF9FVkVOVF9IQU5ETEVSICovLCBhcmdzKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBub3JtYWxpemVFbWl0c09wdGlvbnMoY29tcCwgYXBwQ29udGV4dCwgYXNNaXhpbiA9IGZhbHNlKSB7XHJcbiAgICBjb25zdCBjYWNoZSA9IGFwcENvbnRleHQuZW1pdHNDYWNoZTtcclxuICAgIGNvbnN0IGNhY2hlZCA9IGNhY2hlLmdldChjb21wKTtcclxuICAgIGlmIChjYWNoZWQgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHJldHVybiBjYWNoZWQ7XHJcbiAgICB9XHJcbiAgICBjb25zdCByYXcgPSBjb21wLmVtaXRzO1xyXG4gICAgbGV0IG5vcm1hbGl6ZWQgPSB7fTtcclxuICAgIC8vIGFwcGx5IG1peGluL2V4dGVuZHMgcHJvcHNcclxuICAgIGxldCBoYXNFeHRlbmRzID0gZmFsc2U7XHJcbiAgICBpZiAoX19WVUVfT1BUSU9OU19BUElfXyAmJiAhaXNGdW5jdGlvbihjb21wKSkge1xyXG4gICAgICAgIGNvbnN0IGV4dGVuZEVtaXRzID0gKHJhdykgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBub3JtYWxpemVkRnJvbUV4dGVuZCA9IG5vcm1hbGl6ZUVtaXRzT3B0aW9ucyhyYXcsIGFwcENvbnRleHQsIHRydWUpO1xyXG4gICAgICAgICAgICBpZiAobm9ybWFsaXplZEZyb21FeHRlbmQpIHtcclxuICAgICAgICAgICAgICAgIGhhc0V4dGVuZHMgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgZXh0ZW5kKG5vcm1hbGl6ZWQsIG5vcm1hbGl6ZWRGcm9tRXh0ZW5kKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgaWYgKCFhc01peGluICYmIGFwcENvbnRleHQubWl4aW5zLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBhcHBDb250ZXh0Lm1peGlucy5mb3JFYWNoKGV4dGVuZEVtaXRzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGNvbXAuZXh0ZW5kcykge1xyXG4gICAgICAgICAgICBleHRlbmRFbWl0cyhjb21wLmV4dGVuZHMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY29tcC5taXhpbnMpIHtcclxuICAgICAgICAgICAgY29tcC5taXhpbnMuZm9yRWFjaChleHRlbmRFbWl0cyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYgKCFyYXcgJiYgIWhhc0V4dGVuZHMpIHtcclxuICAgICAgICBjYWNoZS5zZXQoY29tcCwgbnVsbCk7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgICBpZiAoaXNBcnJheShyYXcpKSB7XHJcbiAgICAgICAgcmF3LmZvckVhY2goa2V5ID0+IChub3JtYWxpemVkW2tleV0gPSBudWxsKSk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBleHRlbmQobm9ybWFsaXplZCwgcmF3KTtcclxuICAgIH1cclxuICAgIGNhY2hlLnNldChjb21wLCBub3JtYWxpemVkKTtcclxuICAgIHJldHVybiBub3JtYWxpemVkO1xyXG59XHJcbi8vIENoZWNrIGlmIGFuIGluY29taW5nIHByb3Aga2V5IGlzIGEgZGVjbGFyZWQgZW1pdCBldmVudCBsaXN0ZW5lci5cclxuLy8gZS5nLiBXaXRoIGBlbWl0czogeyBjbGljazogbnVsbCB9YCwgcHJvcHMgbmFtZWQgYG9uQ2xpY2tgIGFuZCBgb25jbGlja2AgYXJlXHJcbi8vIGJvdGggY29uc2lkZXJlZCBtYXRjaGVkIGxpc3RlbmVycy5cclxuZnVuY3Rpb24gaXNFbWl0TGlzdGVuZXIob3B0aW9ucywga2V5KSB7XHJcbiAgICBpZiAoIW9wdGlvbnMgfHwgIWlzT24oa2V5KSkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIGtleSA9IGtleS5zbGljZSgyKS5yZXBsYWNlKC9PbmNlJC8sICcnKTtcclxuICAgIHJldHVybiAoaGFzT3duKG9wdGlvbnMsIGtleVswXS50b0xvd2VyQ2FzZSgpICsga2V5LnNsaWNlKDEpKSB8fFxyXG4gICAgICAgIGhhc093bihvcHRpb25zLCBoeXBoZW5hdGUoa2V5KSkgfHxcclxuICAgICAgICBoYXNPd24ob3B0aW9ucywga2V5KSk7XHJcbn1cblxuLyoqXHJcbiAqIG1hcmsgdGhlIGN1cnJlbnQgcmVuZGVyaW5nIGluc3RhbmNlIGZvciBhc3NldCByZXNvbHV0aW9uIChlLmcuXHJcbiAqIHJlc29sdmVDb21wb25lbnQsIHJlc29sdmVEaXJlY3RpdmUpIGR1cmluZyByZW5kZXJcclxuICovXHJcbmxldCBjdXJyZW50UmVuZGVyaW5nSW5zdGFuY2UgPSBudWxsO1xyXG5sZXQgY3VycmVudFNjb3BlSWQgPSBudWxsO1xyXG4vKipcclxuICogTm90ZTogcmVuZGVyaW5nIGNhbGxzIG1heWJlIG5lc3RlZC4gVGhlIGZ1bmN0aW9uIHJldHVybnMgdGhlIHBhcmVudCByZW5kZXJpbmdcclxuICogaW5zdGFuY2UgaWYgcHJlc2VudCwgd2hpY2ggc2hvdWxkIGJlIHJlc3RvcmVkIGFmdGVyIHRoZSByZW5kZXIgaXMgZG9uZTpcclxuICpcclxuICogYGBganNcclxuICogY29uc3QgcHJldiA9IHNldEN1cnJlbnRSZW5kZXJpbmdJbnN0YW5jZShpKVxyXG4gKiAvLyAuLi5yZW5kZXJcclxuICogc2V0Q3VycmVudFJlbmRlcmluZ0luc3RhbmNlKHByZXYpXHJcbiAqIGBgYFxyXG4gKi9cclxuZnVuY3Rpb24gc2V0Q3VycmVudFJlbmRlcmluZ0luc3RhbmNlKGluc3RhbmNlKSB7XHJcbiAgICBjb25zdCBwcmV2ID0gY3VycmVudFJlbmRlcmluZ0luc3RhbmNlO1xyXG4gICAgY3VycmVudFJlbmRlcmluZ0luc3RhbmNlID0gaW5zdGFuY2U7XHJcbiAgICBjdXJyZW50U2NvcGVJZCA9IChpbnN0YW5jZSAmJiBpbnN0YW5jZS50eXBlLl9fc2NvcGVJZCkgfHwgbnVsbDtcclxuICAgIHJldHVybiBwcmV2O1xyXG59XHJcbi8qKlxyXG4gKiBTZXQgc2NvcGUgaWQgd2hlbiBjcmVhdGluZyBob2lzdGVkIHZub2Rlcy5cclxuICogQHByaXZhdGUgY29tcGlsZXIgaGVscGVyXHJcbiAqL1xyXG5mdW5jdGlvbiBwdXNoU2NvcGVJZChpZCkge1xyXG4gICAgY3VycmVudFNjb3BlSWQgPSBpZDtcclxufVxyXG4vKipcclxuICogVGVjaG5pY2FsbHkgd2Ugbm8gbG9uZ2VyIG5lZWQgdGhpcyBhZnRlciAzLjAuOCBidXQgd2UgbmVlZCB0byBrZWVwIHRoZSBzYW1lXHJcbiAqIEFQSSBmb3IgYmFja3dhcmRzIGNvbXBhdCB3LyBjb2RlIGdlbmVyYXRlZCBieSBjb21waWxlcnMuXHJcbiAqIEBwcml2YXRlXHJcbiAqL1xyXG5mdW5jdGlvbiBwb3BTY29wZUlkKCkge1xyXG4gICAgY3VycmVudFNjb3BlSWQgPSBudWxsO1xyXG59XHJcbi8qKlxyXG4gKiBPbmx5IGZvciBiYWNrd2FyZHMgY29tcGF0XHJcbiAqIEBwcml2YXRlXHJcbiAqL1xyXG5jb25zdCB3aXRoU2NvcGVJZCA9IChfaWQpID0+IHdpdGhDdHg7XHJcbi8qKlxyXG4gKiBXcmFwIGEgc2xvdCBmdW5jdGlvbiB0byBtZW1vaXplIGN1cnJlbnQgcmVuZGVyaW5nIGluc3RhbmNlXHJcbiAqIEBwcml2YXRlIGNvbXBpbGVyIGhlbHBlclxyXG4gKi9cclxuZnVuY3Rpb24gd2l0aEN0eChmbiwgY3R4ID0gY3VycmVudFJlbmRlcmluZ0luc3RhbmNlLCBpc05vblNjb3BlZFNsb3QgLy8gZmFsc2Ugb25seVxyXG4pIHtcclxuICAgIGlmICghY3R4KVxyXG4gICAgICAgIHJldHVybiBmbjtcclxuICAgIC8vIGFscmVhZHkgbm9ybWFsaXplZFxyXG4gICAgaWYgKGZuLl9uKSB7XHJcbiAgICAgICAgcmV0dXJuIGZuO1xyXG4gICAgfVxyXG4gICAgY29uc3QgcmVuZGVyRm5XaXRoQ29udGV4dCA9ICguLi5hcmdzKSA9PiB7XHJcbiAgICAgICAgLy8gSWYgYSB1c2VyIGNhbGxzIGEgY29tcGlsZWQgc2xvdCBpbnNpZGUgYSB0ZW1wbGF0ZSBleHByZXNzaW9uICgjMTc0NSksIGl0XHJcbiAgICAgICAgLy8gY2FuIG1lc3MgdXAgYmxvY2sgdHJhY2tpbmcsIHNvIGJ5IGRlZmF1bHQgd2UgZGlzYWJsZSBibG9jayB0cmFja2luZyBhbmRcclxuICAgICAgICAvLyBmb3JjZSBiYWlsIG91dCB3aGVuIGludm9raW5nIGEgY29tcGlsZWQgc2xvdCAoaW5kaWNhdGVkIGJ5IHRoZSAuX2QgZmxhZykuXHJcbiAgICAgICAgLy8gVGhpcyBpc24ndCBuZWNlc3NhcnkgaWYgcmVuZGVyaW5nIGEgY29tcGlsZWQgYDxzbG90PmAsIHNvIHdlIGZsaXAgdGhlXHJcbiAgICAgICAgLy8gLl9kIGZsYWcgb2ZmIHdoZW4gaW52b2tpbmcgdGhlIHdyYXBwZWQgZm4gaW5zaWRlIGByZW5kZXJTbG90YC5cclxuICAgICAgICBpZiAocmVuZGVyRm5XaXRoQ29udGV4dC5fZCkge1xyXG4gICAgICAgICAgICBzZXRCbG9ja1RyYWNraW5nKC0xKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgcHJldkluc3RhbmNlID0gc2V0Q3VycmVudFJlbmRlcmluZ0luc3RhbmNlKGN0eCk7XHJcbiAgICAgICAgY29uc3QgcmVzID0gZm4oLi4uYXJncyk7XHJcbiAgICAgICAgc2V0Q3VycmVudFJlbmRlcmluZ0luc3RhbmNlKHByZXZJbnN0YW5jZSk7XHJcbiAgICAgICAgaWYgKHJlbmRlckZuV2l0aENvbnRleHQuX2QpIHtcclxuICAgICAgICAgICAgc2V0QmxvY2tUcmFja2luZygxKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB8fCBfX1ZVRV9QUk9EX0RFVlRPT0xTX18pIHtcclxuICAgICAgICAgICAgZGV2dG9vbHNDb21wb25lbnRVcGRhdGVkKGN0eCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXM7XHJcbiAgICB9O1xyXG4gICAgLy8gbWFyayBub3JtYWxpemVkIHRvIGF2b2lkIGR1cGxpY2F0ZWQgd3JhcHBpbmdcclxuICAgIHJlbmRlckZuV2l0aENvbnRleHQuX24gPSB0cnVlO1xyXG4gICAgLy8gbWFyayB0aGlzIGFzIGNvbXBpbGVkIGJ5IGRlZmF1bHRcclxuICAgIC8vIHRoaXMgaXMgdXNlZCBpbiB2bm9kZS50cyAtPiBub3JtYWxpemVDaGlsZHJlbigpIHRvIHNldCB0aGUgc2xvdFxyXG4gICAgLy8gcmVuZGVyaW5nIGZsYWcuXHJcbiAgICByZW5kZXJGbldpdGhDb250ZXh0Ll9jID0gdHJ1ZTtcclxuICAgIC8vIGRpc2FibGUgYmxvY2sgdHJhY2tpbmcgYnkgZGVmYXVsdFxyXG4gICAgcmVuZGVyRm5XaXRoQ29udGV4dC5fZCA9IHRydWU7XHJcbiAgICByZXR1cm4gcmVuZGVyRm5XaXRoQ29udGV4dDtcclxufVxuXG4vKipcclxuICogZGV2IG9ubHkgZmxhZyB0byB0cmFjayB3aGV0aGVyICRhdHRycyB3YXMgdXNlZCBkdXJpbmcgcmVuZGVyLlxyXG4gKiBJZiAkYXR0cnMgd2FzIHVzZWQgZHVyaW5nIHJlbmRlciB0aGVuIHRoZSB3YXJuaW5nIGZvciBmYWlsZWQgYXR0cnNcclxuICogZmFsbHRocm91Z2ggY2FuIGJlIHN1cHByZXNzZWQuXHJcbiAqL1xyXG5sZXQgYWNjZXNzZWRBdHRycyA9IGZhbHNlO1xyXG5mdW5jdGlvbiBtYXJrQXR0cnNBY2Nlc3NlZCgpIHtcclxuICAgIGFjY2Vzc2VkQXR0cnMgPSB0cnVlO1xyXG59XHJcbmZ1bmN0aW9uIHJlbmRlckNvbXBvbmVudFJvb3QoaW5zdGFuY2UpIHtcclxuICAgIGNvbnN0IHsgdHlwZTogQ29tcG9uZW50LCB2bm9kZSwgcHJveHksIHdpdGhQcm94eSwgcHJvcHMsIHByb3BzT3B0aW9uczogW3Byb3BzT3B0aW9uc10sIHNsb3RzLCBhdHRycywgZW1pdCwgcmVuZGVyLCByZW5kZXJDYWNoZSwgZGF0YSwgc2V0dXBTdGF0ZSwgY3R4LCBpbmhlcml0QXR0cnMgfSA9IGluc3RhbmNlO1xyXG4gICAgbGV0IHJlc3VsdDtcclxuICAgIGxldCBmYWxsdGhyb3VnaEF0dHJzO1xyXG4gICAgY29uc3QgcHJldiA9IHNldEN1cnJlbnRSZW5kZXJpbmdJbnN0YW5jZShpbnN0YW5jZSk7XHJcbiAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgYWNjZXNzZWRBdHRycyA9IGZhbHNlO1xyXG4gICAgfVxyXG4gICAgdHJ5IHtcclxuICAgICAgICBpZiAodm5vZGUuc2hhcGVGbGFnICYgNCAvKiBTVEFURUZVTF9DT01QT05FTlQgKi8pIHtcclxuICAgICAgICAgICAgLy8gd2l0aFByb3h5IGlzIGEgcHJveHkgd2l0aCBhIGRpZmZlcmVudCBgaGFzYCB0cmFwIG9ubHkgZm9yXHJcbiAgICAgICAgICAgIC8vIHJ1bnRpbWUtY29tcGlsZWQgcmVuZGVyIGZ1bmN0aW9ucyB1c2luZyBgd2l0aGAgYmxvY2suXHJcbiAgICAgICAgICAgIGNvbnN0IHByb3h5VG9Vc2UgPSB3aXRoUHJveHkgfHwgcHJveHk7XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IG5vcm1hbGl6ZVZOb2RlKHJlbmRlci5jYWxsKHByb3h5VG9Vc2UsIHByb3h5VG9Vc2UsIHJlbmRlckNhY2hlLCBwcm9wcywgc2V0dXBTdGF0ZSwgZGF0YSwgY3R4KSk7XHJcbiAgICAgICAgICAgIGZhbGx0aHJvdWdoQXR0cnMgPSBhdHRycztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIGZ1bmN0aW9uYWxcclxuICAgICAgICAgICAgY29uc3QgcmVuZGVyID0gQ29tcG9uZW50O1xyXG4gICAgICAgICAgICAvLyBpbiBkZXYsIG1hcmsgYXR0cnMgYWNjZXNzZWQgaWYgb3B0aW9uYWwgcHJvcHMgKGF0dHJzID09PSBwcm9wcylcclxuICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiBhdHRycyA9PT0gcHJvcHMpIHtcclxuICAgICAgICAgICAgICAgIG1hcmtBdHRyc0FjY2Vzc2VkKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmVzdWx0ID0gbm9ybWFsaXplVk5vZGUocmVuZGVyLmxlbmd0aCA+IDFcclxuICAgICAgICAgICAgICAgID8gcmVuZGVyKHByb3BzLCAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJylcclxuICAgICAgICAgICAgICAgICAgICA/IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZ2V0IGF0dHJzKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFya0F0dHJzQWNjZXNzZWQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhdHRycztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2xvdHMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVtaXRcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgOiB7IGF0dHJzLCBzbG90cywgZW1pdCB9KVxyXG4gICAgICAgICAgICAgICAgOiByZW5kZXIocHJvcHMsIG51bGwgLyogd2Uga25vdyBpdCBkb2Vzbid0IG5lZWQgaXQgKi8pKTtcclxuICAgICAgICAgICAgZmFsbHRocm91Z2hBdHRycyA9IENvbXBvbmVudC5wcm9wc1xyXG4gICAgICAgICAgICAgICAgPyBhdHRyc1xyXG4gICAgICAgICAgICAgICAgOiBnZXRGdW5jdGlvbmFsRmFsbHRocm91Z2goYXR0cnMpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGNhdGNoIChlcnIpIHtcclxuICAgICAgICBibG9ja1N0YWNrLmxlbmd0aCA9IDA7XHJcbiAgICAgICAgaGFuZGxlRXJyb3IoZXJyLCBpbnN0YW5jZSwgMSAvKiBSRU5ERVJfRlVOQ1RJT04gKi8pO1xyXG4gICAgICAgIHJlc3VsdCA9IGNyZWF0ZVZOb2RlKENvbW1lbnQpO1xyXG4gICAgfVxyXG4gICAgLy8gYXR0ciBtZXJnaW5nXHJcbiAgICAvLyBpbiBkZXYgbW9kZSwgY29tbWVudHMgYXJlIHByZXNlcnZlZCwgYW5kIGl0J3MgcG9zc2libGUgZm9yIGEgdGVtcGxhdGVcclxuICAgIC8vIHRvIGhhdmUgY29tbWVudHMgYWxvbmcgc2lkZSB0aGUgcm9vdCBlbGVtZW50IHdoaWNoIG1ha2VzIGl0IGEgZnJhZ21lbnRcclxuICAgIGxldCByb290ID0gcmVzdWx0O1xyXG4gICAgbGV0IHNldFJvb3QgPSB1bmRlZmluZWQ7XHJcbiAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmXHJcbiAgICAgICAgcmVzdWx0LnBhdGNoRmxhZyA+IDAgJiZcclxuICAgICAgICByZXN1bHQucGF0Y2hGbGFnICYgMjA0OCAvKiBERVZfUk9PVF9GUkFHTUVOVCAqLykge1xyXG4gICAgICAgIFtyb290LCBzZXRSb290XSA9IGdldENoaWxkUm9vdChyZXN1bHQpO1xyXG4gICAgfVxyXG4gICAgaWYgKGZhbGx0aHJvdWdoQXR0cnMgJiYgaW5oZXJpdEF0dHJzICE9PSBmYWxzZSkge1xyXG4gICAgICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhmYWxsdGhyb3VnaEF0dHJzKTtcclxuICAgICAgICBjb25zdCB7IHNoYXBlRmxhZyB9ID0gcm9vdDtcclxuICAgICAgICBpZiAoa2V5cy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgaWYgKHNoYXBlRmxhZyAmICgxIC8qIEVMRU1FTlQgKi8gfCA2IC8qIENPTVBPTkVOVCAqLykpIHtcclxuICAgICAgICAgICAgICAgIGlmIChwcm9wc09wdGlvbnMgJiYga2V5cy5zb21lKGlzTW9kZWxMaXN0ZW5lcikpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBJZiBhIHYtbW9kZWwgbGlzdGVuZXIgKG9uVXBkYXRlOnh4eCkgaGFzIGEgY29ycmVzcG9uZGluZyBkZWNsYXJlZFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHByb3AsIGl0IGluZGljYXRlcyB0aGlzIGNvbXBvbmVudCBleHBlY3RzIHRvIGhhbmRsZSB2LW1vZGVsIGFuZFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGl0IHNob3VsZCBub3QgZmFsbHRocm91Z2guXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gcmVsYXRlZDogIzE1NDMsICMxNjQzLCAjMTk4OVxyXG4gICAgICAgICAgICAgICAgICAgIGZhbGx0aHJvdWdoQXR0cnMgPSBmaWx0ZXJNb2RlbExpc3RlbmVycyhmYWxsdGhyb3VnaEF0dHJzLCBwcm9wc09wdGlvbnMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcm9vdCA9IGNsb25lVk5vZGUocm9vdCwgZmFsbHRocm91Z2hBdHRycyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmICFhY2Nlc3NlZEF0dHJzICYmIHJvb3QudHlwZSAhPT0gQ29tbWVudCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgYWxsQXR0cnMgPSBPYmplY3Qua2V5cyhhdHRycyk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBldmVudEF0dHJzID0gW107XHJcbiAgICAgICAgICAgICAgICBjb25zdCBleHRyYUF0dHJzID0gW107XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMCwgbCA9IGFsbEF0dHJzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGtleSA9IGFsbEF0dHJzW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpc09uKGtleSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWdub3JlIHYtbW9kZWwgaGFuZGxlcnMgd2hlbiB0aGV5IGZhaWwgdG8gZmFsbHRocm91Z2hcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc01vZGVsTGlzdGVuZXIoa2V5KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVtb3ZlIGBvbmAsIGxvd2VyY2FzZSBmaXJzdCBsZXR0ZXIgdG8gcmVmbGVjdCBldmVudCBjYXNpbmdcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFjY3VyYXRlbHlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50QXR0cnMucHVzaChrZXlbMl0udG9Mb3dlckNhc2UoKSArIGtleS5zbGljZSgzKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4dHJhQXR0cnMucHVzaChrZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChleHRyYUF0dHJzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHdhcm4oYEV4dHJhbmVvdXMgbm9uLXByb3BzIGF0dHJpYnV0ZXMgKGAgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBgJHtleHRyYUF0dHJzLmpvaW4oJywgJyl9KSBgICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYHdlcmUgcGFzc2VkIHRvIGNvbXBvbmVudCBidXQgY291bGQgbm90IGJlIGF1dG9tYXRpY2FsbHkgaW5oZXJpdGVkIGAgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBgYmVjYXVzZSBjb21wb25lbnQgcmVuZGVycyBmcmFnbWVudCBvciB0ZXh0IHJvb3Qgbm9kZXMuYCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoZXZlbnRBdHRycy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICB3YXJuKGBFeHRyYW5lb3VzIG5vbi1lbWl0cyBldmVudCBsaXN0ZW5lcnMgKGAgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBgJHtldmVudEF0dHJzLmpvaW4oJywgJyl9KSBgICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYHdlcmUgcGFzc2VkIHRvIGNvbXBvbmVudCBidXQgY291bGQgbm90IGJlIGF1dG9tYXRpY2FsbHkgaW5oZXJpdGVkIGAgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBgYmVjYXVzZSBjb21wb25lbnQgcmVuZGVycyBmcmFnbWVudCBvciB0ZXh0IHJvb3Qgbm9kZXMuIGAgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBgSWYgdGhlIGxpc3RlbmVyIGlzIGludGVuZGVkIHRvIGJlIGEgY29tcG9uZW50IGN1c3RvbSBldmVudCBsaXN0ZW5lciBvbmx5LCBgICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYGRlY2xhcmUgaXQgdXNpbmcgdGhlIFwiZW1pdHNcIiBvcHRpb24uYCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyBpbmhlcml0IGRpcmVjdGl2ZXNcclxuICAgIGlmICh2bm9kZS5kaXJzKSB7XHJcbiAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiAhaXNFbGVtZW50Um9vdChyb290KSkge1xyXG4gICAgICAgICAgICB3YXJuKGBSdW50aW1lIGRpcmVjdGl2ZSB1c2VkIG9uIGNvbXBvbmVudCB3aXRoIG5vbi1lbGVtZW50IHJvb3Qgbm9kZS4gYCArXHJcbiAgICAgICAgICAgICAgICBgVGhlIGRpcmVjdGl2ZXMgd2lsbCBub3QgZnVuY3Rpb24gYXMgaW50ZW5kZWQuYCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJvb3QuZGlycyA9IHJvb3QuZGlycyA/IHJvb3QuZGlycy5jb25jYXQodm5vZGUuZGlycykgOiB2bm9kZS5kaXJzO1xyXG4gICAgfVxyXG4gICAgLy8gaW5oZXJpdCB0cmFuc2l0aW9uIGRhdGFcclxuICAgIGlmICh2bm9kZS50cmFuc2l0aW9uKSB7XHJcbiAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiAhaXNFbGVtZW50Um9vdChyb290KSkge1xyXG4gICAgICAgICAgICB3YXJuKGBDb21wb25lbnQgaW5zaWRlIDxUcmFuc2l0aW9uPiByZW5kZXJzIG5vbi1lbGVtZW50IHJvb3Qgbm9kZSBgICtcclxuICAgICAgICAgICAgICAgIGB0aGF0IGNhbm5vdCBiZSBhbmltYXRlZC5gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcm9vdC50cmFuc2l0aW9uID0gdm5vZGUudHJhbnNpdGlvbjtcclxuICAgIH1cclxuICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiYgc2V0Um9vdCkge1xyXG4gICAgICAgIHNldFJvb3Qocm9vdCk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICByZXN1bHQgPSByb290O1xyXG4gICAgfVxyXG4gICAgc2V0Q3VycmVudFJlbmRlcmluZ0luc3RhbmNlKHByZXYpO1xyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG4vKipcclxuICogZGV2IG9ubHlcclxuICogSW4gZGV2IG1vZGUsIHRlbXBsYXRlIHJvb3QgbGV2ZWwgY29tbWVudHMgYXJlIHJlbmRlcmVkLCB3aGljaCB0dXJucyB0aGVcclxuICogdGVtcGxhdGUgaW50byBhIGZyYWdtZW50IHJvb3QsIGJ1dCB3ZSBuZWVkIHRvIGxvY2F0ZSB0aGUgc2luZ2xlIGVsZW1lbnRcclxuICogcm9vdCBmb3IgYXR0cnMgYW5kIHNjb3BlIGlkIHByb2Nlc3NpbmcuXHJcbiAqL1xyXG5jb25zdCBnZXRDaGlsZFJvb3QgPSAodm5vZGUpID0+IHtcclxuICAgIGNvbnN0IHJhd0NoaWxkcmVuID0gdm5vZGUuY2hpbGRyZW47XHJcbiAgICBjb25zdCBkeW5hbWljQ2hpbGRyZW4gPSB2bm9kZS5keW5hbWljQ2hpbGRyZW47XHJcbiAgICBjb25zdCBjaGlsZFJvb3QgPSBmaWx0ZXJTaW5nbGVSb290KHJhd0NoaWxkcmVuKTtcclxuICAgIGlmICghY2hpbGRSb290KSB7XHJcbiAgICAgICAgcmV0dXJuIFt2bm9kZSwgdW5kZWZpbmVkXTtcclxuICAgIH1cclxuICAgIGNvbnN0IGluZGV4ID0gcmF3Q2hpbGRyZW4uaW5kZXhPZihjaGlsZFJvb3QpO1xyXG4gICAgY29uc3QgZHluYW1pY0luZGV4ID0gZHluYW1pY0NoaWxkcmVuID8gZHluYW1pY0NoaWxkcmVuLmluZGV4T2YoY2hpbGRSb290KSA6IC0xO1xyXG4gICAgY29uc3Qgc2V0Um9vdCA9ICh1cGRhdGVkUm9vdCkgPT4ge1xyXG4gICAgICAgIHJhd0NoaWxkcmVuW2luZGV4XSA9IHVwZGF0ZWRSb290O1xyXG4gICAgICAgIGlmIChkeW5hbWljQ2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgaWYgKGR5bmFtaWNJbmRleCA+IC0xKSB7XHJcbiAgICAgICAgICAgICAgICBkeW5hbWljQ2hpbGRyZW5bZHluYW1pY0luZGV4XSA9IHVwZGF0ZWRSb290O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHVwZGF0ZWRSb290LnBhdGNoRmxhZyA+IDApIHtcclxuICAgICAgICAgICAgICAgIHZub2RlLmR5bmFtaWNDaGlsZHJlbiA9IFsuLi5keW5hbWljQ2hpbGRyZW4sIHVwZGF0ZWRSb290XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICByZXR1cm4gW25vcm1hbGl6ZVZOb2RlKGNoaWxkUm9vdCksIHNldFJvb3RdO1xyXG59O1xyXG5mdW5jdGlvbiBmaWx0ZXJTaW5nbGVSb290KGNoaWxkcmVuKSB7XHJcbiAgICBsZXQgc2luZ2xlUm9vdDtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBjb25zdCBjaGlsZCA9IGNoaWxkcmVuW2ldO1xyXG4gICAgICAgIGlmIChpc1ZOb2RlKGNoaWxkKSkge1xyXG4gICAgICAgICAgICAvLyBpZ25vcmUgdXNlciBjb21tZW50XHJcbiAgICAgICAgICAgIGlmIChjaGlsZC50eXBlICE9PSBDb21tZW50IHx8IGNoaWxkLmNoaWxkcmVuID09PSAndi1pZicpIHtcclxuICAgICAgICAgICAgICAgIGlmIChzaW5nbGVSb290KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gaGFzIG1vcmUgdGhhbiAxIG5vbi1jb21tZW50IGNoaWxkLCByZXR1cm4gbm93XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2luZ2xlUm9vdCA9IGNoaWxkO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHNpbmdsZVJvb3Q7XHJcbn1cclxuY29uc3QgZ2V0RnVuY3Rpb25hbEZhbGx0aHJvdWdoID0gKGF0dHJzKSA9PiB7XHJcbiAgICBsZXQgcmVzO1xyXG4gICAgZm9yIChjb25zdCBrZXkgaW4gYXR0cnMpIHtcclxuICAgICAgICBpZiAoa2V5ID09PSAnY2xhc3MnIHx8IGtleSA9PT0gJ3N0eWxlJyB8fCBpc09uKGtleSkpIHtcclxuICAgICAgICAgICAgKHJlcyB8fCAocmVzID0ge30pKVtrZXldID0gYXR0cnNba2V5XTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzO1xyXG59O1xyXG5jb25zdCBmaWx0ZXJNb2RlbExpc3RlbmVycyA9IChhdHRycywgcHJvcHMpID0+IHtcclxuICAgIGNvbnN0IHJlcyA9IHt9O1xyXG4gICAgZm9yIChjb25zdCBrZXkgaW4gYXR0cnMpIHtcclxuICAgICAgICBpZiAoIWlzTW9kZWxMaXN0ZW5lcihrZXkpIHx8ICEoa2V5LnNsaWNlKDkpIGluIHByb3BzKSkge1xyXG4gICAgICAgICAgICByZXNba2V5XSA9IGF0dHJzW2tleV07XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlcztcclxufTtcclxuY29uc3QgaXNFbGVtZW50Um9vdCA9ICh2bm9kZSkgPT4ge1xyXG4gICAgcmV0dXJuICh2bm9kZS5zaGFwZUZsYWcgJiAoNiAvKiBDT01QT05FTlQgKi8gfCAxIC8qIEVMRU1FTlQgKi8pIHx8XHJcbiAgICAgICAgdm5vZGUudHlwZSA9PT0gQ29tbWVudCAvLyBwb3RlbnRpYWwgdi1pZiBicmFuY2ggc3dpdGNoXHJcbiAgICApO1xyXG59O1xyXG5mdW5jdGlvbiBzaG91bGRVcGRhdGVDb21wb25lbnQocHJldlZOb2RlLCBuZXh0Vk5vZGUsIG9wdGltaXplZCkge1xyXG4gICAgY29uc3QgeyBwcm9wczogcHJldlByb3BzLCBjaGlsZHJlbjogcHJldkNoaWxkcmVuLCBjb21wb25lbnQgfSA9IHByZXZWTm9kZTtcclxuICAgIGNvbnN0IHsgcHJvcHM6IG5leHRQcm9wcywgY2hpbGRyZW46IG5leHRDaGlsZHJlbiwgcGF0Y2hGbGFnIH0gPSBuZXh0Vk5vZGU7XHJcbiAgICBjb25zdCBlbWl0cyA9IGNvbXBvbmVudC5lbWl0c09wdGlvbnM7XHJcbiAgICAvLyBQYXJlbnQgY29tcG9uZW50J3MgcmVuZGVyIGZ1bmN0aW9uIHdhcyBob3QtdXBkYXRlZC4gU2luY2UgdGhpcyBtYXkgaGF2ZVxyXG4gICAgLy8gY2F1c2VkIHRoZSBjaGlsZCBjb21wb25lbnQncyBzbG90cyBjb250ZW50IHRvIGhhdmUgY2hhbmdlZCwgd2UgbmVlZCB0b1xyXG4gICAgLy8gZm9yY2UgdGhlIGNoaWxkIHRvIHVwZGF0ZSBhcyB3ZWxsLlxyXG4gICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiAocHJldkNoaWxkcmVuIHx8IG5leHRDaGlsZHJlbikgJiYgaXNIbXJVcGRhdGluZykge1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgLy8gZm9yY2UgY2hpbGQgdXBkYXRlIGZvciBydW50aW1lIGRpcmVjdGl2ZSBvciB0cmFuc2l0aW9uIG9uIGNvbXBvbmVudCB2bm9kZS5cclxuICAgIGlmIChuZXh0Vk5vZGUuZGlycyB8fCBuZXh0Vk5vZGUudHJhbnNpdGlvbikge1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgaWYgKG9wdGltaXplZCAmJiBwYXRjaEZsYWcgPj0gMCkge1xyXG4gICAgICAgIGlmIChwYXRjaEZsYWcgJiAxMDI0IC8qIERZTkFNSUNfU0xPVFMgKi8pIHtcclxuICAgICAgICAgICAgLy8gc2xvdCBjb250ZW50IHRoYXQgcmVmZXJlbmNlcyB2YWx1ZXMgdGhhdCBtaWdodCBoYXZlIGNoYW5nZWQsXHJcbiAgICAgICAgICAgIC8vIGUuZy4gaW4gYSB2LWZvclxyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHBhdGNoRmxhZyAmIDE2IC8qIEZVTExfUFJPUFMgKi8pIHtcclxuICAgICAgICAgICAgaWYgKCFwcmV2UHJvcHMpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAhIW5leHRQcm9wcztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBwcmVzZW5jZSBvZiB0aGlzIGZsYWcgaW5kaWNhdGVzIHByb3BzIGFyZSBhbHdheXMgbm9uLW51bGxcclxuICAgICAgICAgICAgcmV0dXJuIGhhc1Byb3BzQ2hhbmdlZChwcmV2UHJvcHMsIG5leHRQcm9wcywgZW1pdHMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChwYXRjaEZsYWcgJiA4IC8qIFBST1BTICovKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGR5bmFtaWNQcm9wcyA9IG5leHRWTm9kZS5keW5hbWljUHJvcHM7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZHluYW1pY1Byb3BzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBrZXkgPSBkeW5hbWljUHJvcHNbaV07XHJcbiAgICAgICAgICAgICAgICBpZiAobmV4dFByb3BzW2tleV0gIT09IHByZXZQcm9wc1trZXldICYmXHJcbiAgICAgICAgICAgICAgICAgICAgIWlzRW1pdExpc3RlbmVyKGVtaXRzLCBrZXkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICAvLyB0aGlzIHBhdGggaXMgb25seSB0YWtlbiBieSBtYW51YWxseSB3cml0dGVuIHJlbmRlciBmdW5jdGlvbnNcclxuICAgICAgICAvLyBzbyBwcmVzZW5jZSBvZiBhbnkgY2hpbGRyZW4gbGVhZHMgdG8gYSBmb3JjZWQgdXBkYXRlXHJcbiAgICAgICAgaWYgKHByZXZDaGlsZHJlbiB8fCBuZXh0Q2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgaWYgKCFuZXh0Q2hpbGRyZW4gfHwgIW5leHRDaGlsZHJlbi4kc3RhYmxlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocHJldlByb3BzID09PSBuZXh0UHJvcHMpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXByZXZQcm9wcykge1xyXG4gICAgICAgICAgICByZXR1cm4gISFuZXh0UHJvcHM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghbmV4dFByb3BzKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gaGFzUHJvcHNDaGFuZ2VkKHByZXZQcm9wcywgbmV4dFByb3BzLCBlbWl0cyk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbn1cclxuZnVuY3Rpb24gaGFzUHJvcHNDaGFuZ2VkKHByZXZQcm9wcywgbmV4dFByb3BzLCBlbWl0c09wdGlvbnMpIHtcclxuICAgIGNvbnN0IG5leHRLZXlzID0gT2JqZWN0LmtleXMobmV4dFByb3BzKTtcclxuICAgIGlmIChuZXh0S2V5cy5sZW5ndGggIT09IE9iamVjdC5rZXlzKHByZXZQcm9wcykubGVuZ3RoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5leHRLZXlzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgY29uc3Qga2V5ID0gbmV4dEtleXNbaV07XHJcbiAgICAgICAgaWYgKG5leHRQcm9wc1trZXldICE9PSBwcmV2UHJvcHNba2V5XSAmJlxyXG4gICAgICAgICAgICAhaXNFbWl0TGlzdGVuZXIoZW1pdHNPcHRpb25zLCBrZXkpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBmYWxzZTtcclxufVxyXG5mdW5jdGlvbiB1cGRhdGVIT0NIb3N0RWwoeyB2bm9kZSwgcGFyZW50IH0sIGVsIC8vIEhvc3ROb2RlXHJcbikge1xyXG4gICAgd2hpbGUgKHBhcmVudCAmJiBwYXJlbnQuc3ViVHJlZSA9PT0gdm5vZGUpIHtcclxuICAgICAgICAodm5vZGUgPSBwYXJlbnQudm5vZGUpLmVsID0gZWw7XHJcbiAgICAgICAgcGFyZW50ID0gcGFyZW50LnBhcmVudDtcclxuICAgIH1cclxufVxuXG5jb25zdCBpc1N1c3BlbnNlID0gKHR5cGUpID0+IHR5cGUuX19pc1N1c3BlbnNlO1xyXG4vLyBTdXNwZW5zZSBleHBvc2VzIGEgY29tcG9uZW50LWxpa2UgQVBJLCBhbmQgaXMgdHJlYXRlZCBsaWtlIGEgY29tcG9uZW50XHJcbi8vIGluIHRoZSBjb21waWxlciwgYnV0IGludGVybmFsbHkgaXQncyBhIHNwZWNpYWwgYnVpbHQtaW4gdHlwZSB0aGF0IGhvb2tzXHJcbi8vIGRpcmVjdGx5IGludG8gdGhlIHJlbmRlcmVyLlxyXG5jb25zdCBTdXNwZW5zZUltcGwgPSB7XHJcbiAgICBuYW1lOiAnU3VzcGVuc2UnLFxyXG4gICAgLy8gSW4gb3JkZXIgdG8gbWFrZSBTdXNwZW5zZSB0cmVlLXNoYWthYmxlLCB3ZSBuZWVkIHRvIGF2b2lkIGltcG9ydGluZyBpdFxyXG4gICAgLy8gZGlyZWN0bHkgaW4gdGhlIHJlbmRlcmVyLiBUaGUgcmVuZGVyZXIgY2hlY2tzIGZvciB0aGUgX19pc1N1c3BlbnNlIGZsYWdcclxuICAgIC8vIG9uIGEgdm5vZGUncyB0eXBlIGFuZCBjYWxscyB0aGUgYHByb2Nlc3NgIG1ldGhvZCwgcGFzc2luZyBpbiByZW5kZXJlclxyXG4gICAgLy8gaW50ZXJuYWxzLlxyXG4gICAgX19pc1N1c3BlbnNlOiB0cnVlLFxyXG4gICAgcHJvY2VzcyhuMSwgbjIsIGNvbnRhaW5lciwgYW5jaG9yLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCBpc1NWRywgc2xvdFNjb3BlSWRzLCBvcHRpbWl6ZWQsIFxyXG4gICAgLy8gcGxhdGZvcm0tc3BlY2lmaWMgaW1wbCBwYXNzZWQgZnJvbSByZW5kZXJlclxyXG4gICAgcmVuZGVyZXJJbnRlcm5hbHMpIHtcclxuICAgICAgICBpZiAobjEgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBtb3VudFN1c3BlbnNlKG4yLCBjb250YWluZXIsIGFuY2hvciwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkLCByZW5kZXJlckludGVybmFscyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBwYXRjaFN1c3BlbnNlKG4xLCBuMiwgY29udGFpbmVyLCBhbmNob3IsIHBhcmVudENvbXBvbmVudCwgaXNTVkcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkLCByZW5kZXJlckludGVybmFscyk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGh5ZHJhdGU6IGh5ZHJhdGVTdXNwZW5zZSxcclxuICAgIGNyZWF0ZTogY3JlYXRlU3VzcGVuc2VCb3VuZGFyeSxcclxuICAgIG5vcm1hbGl6ZTogbm9ybWFsaXplU3VzcGVuc2VDaGlsZHJlblxyXG59O1xyXG4vLyBGb3JjZS1jYXN0ZWQgcHVibGljIHR5cGluZyBmb3IgaCBhbmQgVFNYIHByb3BzIGluZmVyZW5jZVxyXG5jb25zdCBTdXNwZW5zZSA9IChTdXNwZW5zZUltcGwgKTtcclxuZnVuY3Rpb24gdHJpZ2dlckV2ZW50KHZub2RlLCBuYW1lKSB7XHJcbiAgICBjb25zdCBldmVudExpc3RlbmVyID0gdm5vZGUucHJvcHMgJiYgdm5vZGUucHJvcHNbbmFtZV07XHJcbiAgICBpZiAoaXNGdW5jdGlvbihldmVudExpc3RlbmVyKSkge1xyXG4gICAgICAgIGV2ZW50TGlzdGVuZXIoKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBtb3VudFN1c3BlbnNlKHZub2RlLCBjb250YWluZXIsIGFuY2hvciwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkLCByZW5kZXJlckludGVybmFscykge1xyXG4gICAgY29uc3QgeyBwOiBwYXRjaCwgbzogeyBjcmVhdGVFbGVtZW50IH0gfSA9IHJlbmRlcmVySW50ZXJuYWxzO1xyXG4gICAgY29uc3QgaGlkZGVuQ29udGFpbmVyID0gY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICBjb25zdCBzdXNwZW5zZSA9ICh2bm9kZS5zdXNwZW5zZSA9IGNyZWF0ZVN1c3BlbnNlQm91bmRhcnkodm5vZGUsIHBhcmVudFN1c3BlbnNlLCBwYXJlbnRDb21wb25lbnQsIGNvbnRhaW5lciwgaGlkZGVuQ29udGFpbmVyLCBhbmNob3IsIGlzU1ZHLCBzbG90U2NvcGVJZHMsIG9wdGltaXplZCwgcmVuZGVyZXJJbnRlcm5hbHMpKTtcclxuICAgIC8vIHN0YXJ0IG1vdW50aW5nIHRoZSBjb250ZW50IHN1YnRyZWUgaW4gYW4gb2ZmLWRvbSBjb250YWluZXJcclxuICAgIHBhdGNoKG51bGwsIChzdXNwZW5zZS5wZW5kaW5nQnJhbmNoID0gdm5vZGUuc3NDb250ZW50KSwgaGlkZGVuQ29udGFpbmVyLCBudWxsLCBwYXJlbnRDb21wb25lbnQsIHN1c3BlbnNlLCBpc1NWRywgc2xvdFNjb3BlSWRzKTtcclxuICAgIC8vIG5vdyBjaGVjayBpZiB3ZSBoYXZlIGVuY291bnRlcmVkIGFueSBhc3luYyBkZXBzXHJcbiAgICBpZiAoc3VzcGVuc2UuZGVwcyA+IDApIHtcclxuICAgICAgICAvLyBoYXMgYXN5bmNcclxuICAgICAgICAvLyBpbnZva2UgQGZhbGxiYWNrIGV2ZW50XHJcbiAgICAgICAgdHJpZ2dlckV2ZW50KHZub2RlLCAnb25QZW5kaW5nJyk7XHJcbiAgICAgICAgdHJpZ2dlckV2ZW50KHZub2RlLCAnb25GYWxsYmFjaycpO1xyXG4gICAgICAgIC8vIG1vdW50IHRoZSBmYWxsYmFjayB0cmVlXHJcbiAgICAgICAgcGF0Y2gobnVsbCwgdm5vZGUuc3NGYWxsYmFjaywgY29udGFpbmVyLCBhbmNob3IsIHBhcmVudENvbXBvbmVudCwgbnVsbCwgLy8gZmFsbGJhY2sgdHJlZSB3aWxsIG5vdCBoYXZlIHN1c3BlbnNlIGNvbnRleHRcclxuICAgICAgICBpc1NWRywgc2xvdFNjb3BlSWRzKTtcclxuICAgICAgICBzZXRBY3RpdmVCcmFuY2goc3VzcGVuc2UsIHZub2RlLnNzRmFsbGJhY2spO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgLy8gU3VzcGVuc2UgaGFzIG5vIGFzeW5jIGRlcHMuIEp1c3QgcmVzb2x2ZS5cclxuICAgICAgICBzdXNwZW5zZS5yZXNvbHZlKCk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gcGF0Y2hTdXNwZW5zZShuMSwgbjIsIGNvbnRhaW5lciwgYW5jaG9yLCBwYXJlbnRDb21wb25lbnQsIGlzU1ZHLCBzbG90U2NvcGVJZHMsIG9wdGltaXplZCwgeyBwOiBwYXRjaCwgdW06IHVubW91bnQsIG86IHsgY3JlYXRlRWxlbWVudCB9IH0pIHtcclxuICAgIGNvbnN0IHN1c3BlbnNlID0gKG4yLnN1c3BlbnNlID0gbjEuc3VzcGVuc2UpO1xyXG4gICAgc3VzcGVuc2Uudm5vZGUgPSBuMjtcclxuICAgIG4yLmVsID0gbjEuZWw7XHJcbiAgICBjb25zdCBuZXdCcmFuY2ggPSBuMi5zc0NvbnRlbnQ7XHJcbiAgICBjb25zdCBuZXdGYWxsYmFjayA9IG4yLnNzRmFsbGJhY2s7XHJcbiAgICBjb25zdCB7IGFjdGl2ZUJyYW5jaCwgcGVuZGluZ0JyYW5jaCwgaXNJbkZhbGxiYWNrLCBpc0h5ZHJhdGluZyB9ID0gc3VzcGVuc2U7XHJcbiAgICBpZiAocGVuZGluZ0JyYW5jaCkge1xyXG4gICAgICAgIHN1c3BlbnNlLnBlbmRpbmdCcmFuY2ggPSBuZXdCcmFuY2g7XHJcbiAgICAgICAgaWYgKGlzU2FtZVZOb2RlVHlwZShuZXdCcmFuY2gsIHBlbmRpbmdCcmFuY2gpKSB7XHJcbiAgICAgICAgICAgIC8vIHNhbWUgcm9vdCB0eXBlIGJ1dCBjb250ZW50IG1heSBoYXZlIGNoYW5nZWQuXHJcbiAgICAgICAgICAgIHBhdGNoKHBlbmRpbmdCcmFuY2gsIG5ld0JyYW5jaCwgc3VzcGVuc2UuaGlkZGVuQ29udGFpbmVyLCBudWxsLCBwYXJlbnRDb21wb25lbnQsIHN1c3BlbnNlLCBpc1NWRywgc2xvdFNjb3BlSWRzLCBvcHRpbWl6ZWQpO1xyXG4gICAgICAgICAgICBpZiAoc3VzcGVuc2UuZGVwcyA8PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBzdXNwZW5zZS5yZXNvbHZlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoaXNJbkZhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgICAgICBwYXRjaChhY3RpdmVCcmFuY2gsIG5ld0ZhbGxiYWNrLCBjb250YWluZXIsIGFuY2hvciwgcGFyZW50Q29tcG9uZW50LCBudWxsLCAvLyBmYWxsYmFjayB0cmVlIHdpbGwgbm90IGhhdmUgc3VzcGVuc2UgY29udGV4dFxyXG4gICAgICAgICAgICAgICAgaXNTVkcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKTtcclxuICAgICAgICAgICAgICAgIHNldEFjdGl2ZUJyYW5jaChzdXNwZW5zZSwgbmV3RmFsbGJhY2spO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyB0b2dnbGVkIGJlZm9yZSBwZW5kaW5nIHRyZWUgaXMgcmVzb2x2ZWRcclxuICAgICAgICAgICAgc3VzcGVuc2UucGVuZGluZ0lkKys7XHJcbiAgICAgICAgICAgIGlmIChpc0h5ZHJhdGluZykge1xyXG4gICAgICAgICAgICAgICAgLy8gaWYgdG9nZ2xlZCBiZWZvcmUgaHlkcmF0aW9uIGlzIGZpbmlzaGVkLCB0aGUgY3VycmVudCBET00gdHJlZSBpc1xyXG4gICAgICAgICAgICAgICAgLy8gbm8gbG9uZ2VyIHZhbGlkLiBzZXQgaXQgYXMgdGhlIGFjdGl2ZSBicmFuY2ggc28gaXQgd2lsbCBiZSB1bm1vdW50ZWRcclxuICAgICAgICAgICAgICAgIC8vIHdoZW4gcmVzb2x2ZWRcclxuICAgICAgICAgICAgICAgIHN1c3BlbnNlLmlzSHlkcmF0aW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBzdXNwZW5zZS5hY3RpdmVCcmFuY2ggPSBwZW5kaW5nQnJhbmNoO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdW5tb3VudChwZW5kaW5nQnJhbmNoLCBwYXJlbnRDb21wb25lbnQsIHN1c3BlbnNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBpbmNyZW1lbnQgcGVuZGluZyBJRC4gdGhpcyBpcyB1c2VkIHRvIGludmFsaWRhdGUgYXN5bmMgY2FsbGJhY2tzXHJcbiAgICAgICAgICAgIC8vIHJlc2V0IHN1c3BlbnNlIHN0YXRlXHJcbiAgICAgICAgICAgIHN1c3BlbnNlLmRlcHMgPSAwO1xyXG4gICAgICAgICAgICAvLyBkaXNjYXJkIGVmZmVjdHMgZnJvbSBwZW5kaW5nIGJyYW5jaFxyXG4gICAgICAgICAgICBzdXNwZW5zZS5lZmZlY3RzLmxlbmd0aCA9IDA7XHJcbiAgICAgICAgICAgIC8vIGRpc2NhcmQgcHJldmlvdXMgY29udGFpbmVyXHJcbiAgICAgICAgICAgIHN1c3BlbnNlLmhpZGRlbkNvbnRhaW5lciA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgICBpZiAoaXNJbkZhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBhbHJlYWR5IGluIGZhbGxiYWNrIHN0YXRlXHJcbiAgICAgICAgICAgICAgICBwYXRjaChudWxsLCBuZXdCcmFuY2gsIHN1c3BlbnNlLmhpZGRlbkNvbnRhaW5lciwgbnVsbCwgcGFyZW50Q29tcG9uZW50LCBzdXNwZW5zZSwgaXNTVkcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKTtcclxuICAgICAgICAgICAgICAgIGlmIChzdXNwZW5zZS5kZXBzIDw9IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBzdXNwZW5zZS5yZXNvbHZlKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBwYXRjaChhY3RpdmVCcmFuY2gsIG5ld0ZhbGxiYWNrLCBjb250YWluZXIsIGFuY2hvciwgcGFyZW50Q29tcG9uZW50LCBudWxsLCAvLyBmYWxsYmFjayB0cmVlIHdpbGwgbm90IGhhdmUgc3VzcGVuc2UgY29udGV4dFxyXG4gICAgICAgICAgICAgICAgICAgIGlzU1ZHLCBzbG90U2NvcGVJZHMsIG9wdGltaXplZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0QWN0aXZlQnJhbmNoKHN1c3BlbnNlLCBuZXdGYWxsYmFjayk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoYWN0aXZlQnJhbmNoICYmIGlzU2FtZVZOb2RlVHlwZShuZXdCcmFuY2gsIGFjdGl2ZUJyYW5jaCkpIHtcclxuICAgICAgICAgICAgICAgIC8vIHRvZ2dsZWQgXCJiYWNrXCIgdG8gY3VycmVudCBhY3RpdmUgYnJhbmNoXHJcbiAgICAgICAgICAgICAgICBwYXRjaChhY3RpdmVCcmFuY2gsIG5ld0JyYW5jaCwgY29udGFpbmVyLCBhbmNob3IsIHBhcmVudENvbXBvbmVudCwgc3VzcGVuc2UsIGlzU1ZHLCBzbG90U2NvcGVJZHMsIG9wdGltaXplZCk7XHJcbiAgICAgICAgICAgICAgICAvLyBmb3JjZSByZXNvbHZlXHJcbiAgICAgICAgICAgICAgICBzdXNwZW5zZS5yZXNvbHZlKHRydWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gc3dpdGNoZWQgdG8gYSAzcmQgYnJhbmNoXHJcbiAgICAgICAgICAgICAgICBwYXRjaChudWxsLCBuZXdCcmFuY2gsIHN1c3BlbnNlLmhpZGRlbkNvbnRhaW5lciwgbnVsbCwgcGFyZW50Q29tcG9uZW50LCBzdXNwZW5zZSwgaXNTVkcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKTtcclxuICAgICAgICAgICAgICAgIGlmIChzdXNwZW5zZS5kZXBzIDw9IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBzdXNwZW5zZS5yZXNvbHZlKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBpZiAoYWN0aXZlQnJhbmNoICYmIGlzU2FtZVZOb2RlVHlwZShuZXdCcmFuY2gsIGFjdGl2ZUJyYW5jaCkpIHtcclxuICAgICAgICAgICAgLy8gcm9vdCBkaWQgbm90IGNoYW5nZSwganVzdCBub3JtYWwgcGF0Y2hcclxuICAgICAgICAgICAgcGF0Y2goYWN0aXZlQnJhbmNoLCBuZXdCcmFuY2gsIGNvbnRhaW5lciwgYW5jaG9yLCBwYXJlbnRDb21wb25lbnQsIHN1c3BlbnNlLCBpc1NWRywgc2xvdFNjb3BlSWRzLCBvcHRpbWl6ZWQpO1xyXG4gICAgICAgICAgICBzZXRBY3RpdmVCcmFuY2goc3VzcGVuc2UsIG5ld0JyYW5jaCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyByb290IG5vZGUgdG9nZ2xlZFxyXG4gICAgICAgICAgICAvLyBpbnZva2UgQHBlbmRpbmcgZXZlbnRcclxuICAgICAgICAgICAgdHJpZ2dlckV2ZW50KG4yLCAnb25QZW5kaW5nJyk7XHJcbiAgICAgICAgICAgIC8vIG1vdW50IHBlbmRpbmcgYnJhbmNoIGluIG9mZi1kb20gY29udGFpbmVyXHJcbiAgICAgICAgICAgIHN1c3BlbnNlLnBlbmRpbmdCcmFuY2ggPSBuZXdCcmFuY2g7XHJcbiAgICAgICAgICAgIHN1c3BlbnNlLnBlbmRpbmdJZCsrO1xyXG4gICAgICAgICAgICBwYXRjaChudWxsLCBuZXdCcmFuY2gsIHN1c3BlbnNlLmhpZGRlbkNvbnRhaW5lciwgbnVsbCwgcGFyZW50Q29tcG9uZW50LCBzdXNwZW5zZSwgaXNTVkcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKTtcclxuICAgICAgICAgICAgaWYgKHN1c3BlbnNlLmRlcHMgPD0gMCkge1xyXG4gICAgICAgICAgICAgICAgLy8gaW5jb21pbmcgYnJhbmNoIGhhcyBubyBhc3luYyBkZXBzLCByZXNvbHZlIG5vdy5cclxuICAgICAgICAgICAgICAgIHN1c3BlbnNlLnJlc29sdmUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHsgdGltZW91dCwgcGVuZGluZ0lkIH0gPSBzdXNwZW5zZTtcclxuICAgICAgICAgICAgICAgIGlmICh0aW1lb3V0ID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3VzcGVuc2UucGVuZGluZ0lkID09PSBwZW5kaW5nSWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1c3BlbnNlLmZhbGxiYWNrKG5ld0ZhbGxiYWNrKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sIHRpbWVvdXQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodGltZW91dCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHN1c3BlbnNlLmZhbGxiYWNrKG5ld0ZhbGxiYWNrKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5sZXQgaGFzV2FybmVkID0gZmFsc2U7XHJcbmZ1bmN0aW9uIGNyZWF0ZVN1c3BlbnNlQm91bmRhcnkodm5vZGUsIHBhcmVudCwgcGFyZW50Q29tcG9uZW50LCBjb250YWluZXIsIGhpZGRlbkNvbnRhaW5lciwgYW5jaG9yLCBpc1NWRywgc2xvdFNjb3BlSWRzLCBvcHRpbWl6ZWQsIHJlbmRlcmVySW50ZXJuYWxzLCBpc0h5ZHJhdGluZyA9IGZhbHNlKSB7XHJcbiAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgaWYgKi9cclxuICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiYgIWZhbHNlICYmICFoYXNXYXJuZWQpIHtcclxuICAgICAgICBoYXNXYXJuZWQgPSB0cnVlO1xyXG4gICAgICAgIC8vIEB0cy1pZ25vcmUgYGNvbnNvbGUuaW5mb2AgY2Fubm90IGJlIG51bGwgZXJyb3JcclxuICAgICAgICBjb25zb2xlW2NvbnNvbGUuaW5mbyA/ICdpbmZvJyA6ICdsb2cnXShgPFN1c3BlbnNlPiBpcyBhbiBleHBlcmltZW50YWwgZmVhdHVyZSBhbmQgaXRzIEFQSSB3aWxsIGxpa2VseSBjaGFuZ2UuYCk7XHJcbiAgICB9XHJcbiAgICBjb25zdCB7IHA6IHBhdGNoLCBtOiBtb3ZlLCB1bTogdW5tb3VudCwgbjogbmV4dCwgbzogeyBwYXJlbnROb2RlLCByZW1vdmUgfSB9ID0gcmVuZGVyZXJJbnRlcm5hbHM7XHJcbiAgICBjb25zdCB0aW1lb3V0ID0gdG9OdW1iZXIodm5vZGUucHJvcHMgJiYgdm5vZGUucHJvcHMudGltZW91dCk7XHJcbiAgICBjb25zdCBzdXNwZW5zZSA9IHtcclxuICAgICAgICB2bm9kZSxcclxuICAgICAgICBwYXJlbnQsXHJcbiAgICAgICAgcGFyZW50Q29tcG9uZW50LFxyXG4gICAgICAgIGlzU1ZHLFxyXG4gICAgICAgIGNvbnRhaW5lcixcclxuICAgICAgICBoaWRkZW5Db250YWluZXIsXHJcbiAgICAgICAgYW5jaG9yLFxyXG4gICAgICAgIGRlcHM6IDAsXHJcbiAgICAgICAgcGVuZGluZ0lkOiAwLFxyXG4gICAgICAgIHRpbWVvdXQ6IHR5cGVvZiB0aW1lb3V0ID09PSAnbnVtYmVyJyA/IHRpbWVvdXQgOiAtMSxcclxuICAgICAgICBhY3RpdmVCcmFuY2g6IG51bGwsXHJcbiAgICAgICAgcGVuZGluZ0JyYW5jaDogbnVsbCxcclxuICAgICAgICBpc0luRmFsbGJhY2s6IHRydWUsXHJcbiAgICAgICAgaXNIeWRyYXRpbmcsXHJcbiAgICAgICAgaXNVbm1vdW50ZWQ6IGZhbHNlLFxyXG4gICAgICAgIGVmZmVjdHM6IFtdLFxyXG4gICAgICAgIHJlc29sdmUocmVzdW1lID0gZmFsc2UpIHtcclxuICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFyZXN1bWUgJiYgIXN1c3BlbnNlLnBlbmRpbmdCcmFuY2gpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYHN1c3BlbnNlLnJlc29sdmUoKSBpcyBjYWxsZWQgd2l0aG91dCBhIHBlbmRpbmcgYnJhbmNoLmApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHN1c3BlbnNlLmlzVW5tb3VudGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBzdXNwZW5zZS5yZXNvbHZlKCkgaXMgY2FsbGVkIG9uIGFuIGFscmVhZHkgdW5tb3VudGVkIHN1c3BlbnNlIGJvdW5kYXJ5LmApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IHsgdm5vZGUsIGFjdGl2ZUJyYW5jaCwgcGVuZGluZ0JyYW5jaCwgcGVuZGluZ0lkLCBlZmZlY3RzLCBwYXJlbnRDb21wb25lbnQsIGNvbnRhaW5lciB9ID0gc3VzcGVuc2U7XHJcbiAgICAgICAgICAgIGlmIChzdXNwZW5zZS5pc0h5ZHJhdGluZykge1xyXG4gICAgICAgICAgICAgICAgc3VzcGVuc2UuaXNIeWRyYXRpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmICghcmVzdW1lKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBkZWxheUVudGVyID0gYWN0aXZlQnJhbmNoICYmXHJcbiAgICAgICAgICAgICAgICAgICAgcGVuZGluZ0JyYW5jaC50cmFuc2l0aW9uICYmXHJcbiAgICAgICAgICAgICAgICAgICAgcGVuZGluZ0JyYW5jaC50cmFuc2l0aW9uLm1vZGUgPT09ICdvdXQtaW4nO1xyXG4gICAgICAgICAgICAgICAgaWYgKGRlbGF5RW50ZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICBhY3RpdmVCcmFuY2gudHJhbnNpdGlvbi5hZnRlckxlYXZlID0gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocGVuZGluZ0lkID09PSBzdXNwZW5zZS5wZW5kaW5nSWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vdmUocGVuZGluZ0JyYW5jaCwgY29udGFpbmVyLCBhbmNob3IsIDAgLyogRU5URVIgKi8pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIHRoaXMgaXMgaW5pdGlhbCBhbmNob3Igb24gbW91bnRcclxuICAgICAgICAgICAgICAgIGxldCB7IGFuY2hvciB9ID0gc3VzcGVuc2U7XHJcbiAgICAgICAgICAgICAgICAvLyB1bm1vdW50IGN1cnJlbnQgYWN0aXZlIHRyZWVcclxuICAgICAgICAgICAgICAgIGlmIChhY3RpdmVCcmFuY2gpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBpZiB0aGUgZmFsbGJhY2sgdHJlZSB3YXMgbW91bnRlZCwgaXQgbWF5IGhhdmUgYmVlbiBtb3ZlZFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGFzIHBhcnQgb2YgYSBwYXJlbnQgc3VzcGVuc2UuIGdldCB0aGUgbGF0ZXN0IGFuY2hvciBmb3IgaW5zZXJ0aW9uXHJcbiAgICAgICAgICAgICAgICAgICAgYW5jaG9yID0gbmV4dChhY3RpdmVCcmFuY2gpO1xyXG4gICAgICAgICAgICAgICAgICAgIHVubW91bnQoYWN0aXZlQnJhbmNoLCBwYXJlbnRDb21wb25lbnQsIHN1c3BlbnNlLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICghZGVsYXlFbnRlcikge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIG1vdmUgY29udGVudCBmcm9tIG9mZi1kb20gY29udGFpbmVyIHRvIGFjdHVhbCBjb250YWluZXJcclxuICAgICAgICAgICAgICAgICAgICBtb3ZlKHBlbmRpbmdCcmFuY2gsIGNvbnRhaW5lciwgYW5jaG9yLCAwIC8qIEVOVEVSICovKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzZXRBY3RpdmVCcmFuY2goc3VzcGVuc2UsIHBlbmRpbmdCcmFuY2gpO1xyXG4gICAgICAgICAgICBzdXNwZW5zZS5wZW5kaW5nQnJhbmNoID0gbnVsbDtcclxuICAgICAgICAgICAgc3VzcGVuc2UuaXNJbkZhbGxiYWNrID0gZmFsc2U7XHJcbiAgICAgICAgICAgIC8vIGZsdXNoIGJ1ZmZlcmVkIGVmZmVjdHNcclxuICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlcmUgaXMgYSBwZW5kaW5nIHBhcmVudCBzdXNwZW5zZVxyXG4gICAgICAgICAgICBsZXQgcGFyZW50ID0gc3VzcGVuc2UucGFyZW50O1xyXG4gICAgICAgICAgICBsZXQgaGFzVW5yZXNvbHZlZEFuY2VzdG9yID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHdoaWxlIChwYXJlbnQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChwYXJlbnQucGVuZGluZ0JyYW5jaCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGZvdW5kIGEgcGVuZGluZyBwYXJlbnQgc3VzcGVuc2UsIG1lcmdlIGJ1ZmZlcmVkIHBvc3Qgam9ic1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGludG8gdGhhdCBwYXJlbnRcclxuICAgICAgICAgICAgICAgICAgICBwYXJlbnQuZWZmZWN0cy5wdXNoKC4uLmVmZmVjdHMpO1xyXG4gICAgICAgICAgICAgICAgICAgIGhhc1VucmVzb2x2ZWRBbmNlc3RvciA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBwYXJlbnQgPSBwYXJlbnQucGFyZW50O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIG5vIHBlbmRpbmcgcGFyZW50IHN1c3BlbnNlLCBmbHVzaCBhbGwgam9ic1xyXG4gICAgICAgICAgICBpZiAoIWhhc1VucmVzb2x2ZWRBbmNlc3Rvcikge1xyXG4gICAgICAgICAgICAgICAgcXVldWVQb3N0Rmx1c2hDYihlZmZlY3RzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzdXNwZW5zZS5lZmZlY3RzID0gW107XHJcbiAgICAgICAgICAgIC8vIGludm9rZSBAcmVzb2x2ZSBldmVudFxyXG4gICAgICAgICAgICB0cmlnZ2VyRXZlbnQodm5vZGUsICdvblJlc29sdmUnKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGZhbGxiYWNrKGZhbGxiYWNrVk5vZGUpIHtcclxuICAgICAgICAgICAgaWYgKCFzdXNwZW5zZS5wZW5kaW5nQnJhbmNoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgeyB2bm9kZSwgYWN0aXZlQnJhbmNoLCBwYXJlbnRDb21wb25lbnQsIGNvbnRhaW5lciwgaXNTVkcgfSA9IHN1c3BlbnNlO1xyXG4gICAgICAgICAgICAvLyBpbnZva2UgQGZhbGxiYWNrIGV2ZW50XHJcbiAgICAgICAgICAgIHRyaWdnZXJFdmVudCh2bm9kZSwgJ29uRmFsbGJhY2snKTtcclxuICAgICAgICAgICAgY29uc3QgYW5jaG9yID0gbmV4dChhY3RpdmVCcmFuY2gpO1xyXG4gICAgICAgICAgICBjb25zdCBtb3VudEZhbGxiYWNrID0gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFzdXNwZW5zZS5pc0luRmFsbGJhY2spIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyBtb3VudCB0aGUgZmFsbGJhY2sgdHJlZVxyXG4gICAgICAgICAgICAgICAgcGF0Y2gobnVsbCwgZmFsbGJhY2tWTm9kZSwgY29udGFpbmVyLCBhbmNob3IsIHBhcmVudENvbXBvbmVudCwgbnVsbCwgLy8gZmFsbGJhY2sgdHJlZSB3aWxsIG5vdCBoYXZlIHN1c3BlbnNlIGNvbnRleHRcclxuICAgICAgICAgICAgICAgIGlzU1ZHLCBzbG90U2NvcGVJZHMsIG9wdGltaXplZCk7XHJcbiAgICAgICAgICAgICAgICBzZXRBY3RpdmVCcmFuY2goc3VzcGVuc2UsIGZhbGxiYWNrVk5vZGUpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBjb25zdCBkZWxheUVudGVyID0gZmFsbGJhY2tWTm9kZS50cmFuc2l0aW9uICYmIGZhbGxiYWNrVk5vZGUudHJhbnNpdGlvbi5tb2RlID09PSAnb3V0LWluJztcclxuICAgICAgICAgICAgaWYgKGRlbGF5RW50ZXIpIHtcclxuICAgICAgICAgICAgICAgIGFjdGl2ZUJyYW5jaC50cmFuc2l0aW9uLmFmdGVyTGVhdmUgPSBtb3VudEZhbGxiYWNrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHN1c3BlbnNlLmlzSW5GYWxsYmFjayA9IHRydWU7XHJcbiAgICAgICAgICAgIC8vIHVubW91bnQgY3VycmVudCBhY3RpdmUgYnJhbmNoXHJcbiAgICAgICAgICAgIHVubW91bnQoYWN0aXZlQnJhbmNoLCBwYXJlbnRDb21wb25lbnQsIG51bGwsIC8vIG5vIHN1c3BlbnNlIHNvIHVubW91bnQgaG9va3MgZmlyZSBub3dcclxuICAgICAgICAgICAgdHJ1ZSAvLyBzaG91bGRSZW1vdmVcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgaWYgKCFkZWxheUVudGVyKSB7XHJcbiAgICAgICAgICAgICAgICBtb3VudEZhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIG1vdmUoY29udGFpbmVyLCBhbmNob3IsIHR5cGUpIHtcclxuICAgICAgICAgICAgc3VzcGVuc2UuYWN0aXZlQnJhbmNoICYmXHJcbiAgICAgICAgICAgICAgICBtb3ZlKHN1c3BlbnNlLmFjdGl2ZUJyYW5jaCwgY29udGFpbmVyLCBhbmNob3IsIHR5cGUpO1xyXG4gICAgICAgICAgICBzdXNwZW5zZS5jb250YWluZXIgPSBjb250YWluZXI7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBuZXh0KCkge1xyXG4gICAgICAgICAgICByZXR1cm4gc3VzcGVuc2UuYWN0aXZlQnJhbmNoICYmIG5leHQoc3VzcGVuc2UuYWN0aXZlQnJhbmNoKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHJlZ2lzdGVyRGVwKGluc3RhbmNlLCBzZXR1cFJlbmRlckVmZmVjdCkge1xyXG4gICAgICAgICAgICBjb25zdCBpc0luUGVuZGluZ1N1c3BlbnNlID0gISFzdXNwZW5zZS5wZW5kaW5nQnJhbmNoO1xyXG4gICAgICAgICAgICBpZiAoaXNJblBlbmRpbmdTdXNwZW5zZSkge1xyXG4gICAgICAgICAgICAgICAgc3VzcGVuc2UuZGVwcysrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IGh5ZHJhdGVkRWwgPSBpbnN0YW5jZS52bm9kZS5lbDtcclxuICAgICAgICAgICAgaW5zdGFuY2VcclxuICAgICAgICAgICAgICAgIC5hc3luY0RlcC5jYXRjaChlcnIgPT4ge1xyXG4gICAgICAgICAgICAgICAgaGFuZGxlRXJyb3IoZXJyLCBpbnN0YW5jZSwgMCAvKiBTRVRVUF9GVU5DVElPTiAqLyk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAudGhlbihhc3luY1NldHVwUmVzdWx0ID0+IHtcclxuICAgICAgICAgICAgICAgIC8vIHJldHJ5IHdoZW4gdGhlIHNldHVwKCkgcHJvbWlzZSByZXNvbHZlcy5cclxuICAgICAgICAgICAgICAgIC8vIGNvbXBvbmVudCBtYXkgaGF2ZSBiZWVuIHVubW91bnRlZCBiZWZvcmUgcmVzb2x2ZS5cclxuICAgICAgICAgICAgICAgIGlmIChpbnN0YW5jZS5pc1VubW91bnRlZCB8fFxyXG4gICAgICAgICAgICAgICAgICAgIHN1c3BlbnNlLmlzVW5tb3VudGVkIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgc3VzcGVuc2UucGVuZGluZ0lkICE9PSBpbnN0YW5jZS5zdXNwZW5zZUlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gcmV0cnkgZnJvbSB0aGlzIGNvbXBvbmVudFxyXG4gICAgICAgICAgICAgICAgaW5zdGFuY2UuYXN5bmNSZXNvbHZlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB7IHZub2RlIH0gPSBpbnN0YW5jZTtcclxuICAgICAgICAgICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgICAgICBwdXNoV2FybmluZ0NvbnRleHQodm5vZGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaGFuZGxlU2V0dXBSZXN1bHQoaW5zdGFuY2UsIGFzeW5jU2V0dXBSZXN1bHQsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIGlmIChoeWRyYXRlZEVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gdm5vZGUgbWF5IGhhdmUgYmVlbiByZXBsYWNlZCBpZiBhbiB1cGRhdGUgaGFwcGVuZWQgYmVmb3JlIHRoZVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGFzeW5jIGRlcCBpcyByZXNvbHZlZC5cclxuICAgICAgICAgICAgICAgICAgICB2bm9kZS5lbCA9IGh5ZHJhdGVkRWw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBwbGFjZWhvbGRlciA9ICFoeWRyYXRlZEVsICYmIGluc3RhbmNlLnN1YlRyZWUuZWw7XHJcbiAgICAgICAgICAgICAgICBzZXR1cFJlbmRlckVmZmVjdChpbnN0YW5jZSwgdm5vZGUsIFxyXG4gICAgICAgICAgICAgICAgLy8gY29tcG9uZW50IG1heSBoYXZlIGJlZW4gbW92ZWQgYmVmb3JlIHJlc29sdmUuXHJcbiAgICAgICAgICAgICAgICAvLyBpZiB0aGlzIGlzIG5vdCBhIGh5ZHJhdGlvbiwgaW5zdGFuY2Uuc3ViVHJlZSB3aWxsIGJlIHRoZSBjb21tZW50XHJcbiAgICAgICAgICAgICAgICAvLyBwbGFjZWhvbGRlci5cclxuICAgICAgICAgICAgICAgIHBhcmVudE5vZGUoaHlkcmF0ZWRFbCB8fCBpbnN0YW5jZS5zdWJUcmVlLmVsKSwgXHJcbiAgICAgICAgICAgICAgICAvLyBhbmNob3Igd2lsbCBub3QgYmUgdXNlZCBpZiB0aGlzIGlzIGh5ZHJhdGlvbiwgc28gb25seSBuZWVkIHRvXHJcbiAgICAgICAgICAgICAgICAvLyBjb25zaWRlciB0aGUgY29tbWVudCBwbGFjZWhvbGRlciBjYXNlLlxyXG4gICAgICAgICAgICAgICAgaHlkcmF0ZWRFbCA/IG51bGwgOiBuZXh0KGluc3RhbmNlLnN1YlRyZWUpLCBzdXNwZW5zZSwgaXNTVkcsIG9wdGltaXplZCk7XHJcbiAgICAgICAgICAgICAgICBpZiAocGxhY2Vob2xkZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZW1vdmUocGxhY2Vob2xkZXIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdXBkYXRlSE9DSG9zdEVsKGluc3RhbmNlLCB2bm9kZS5lbCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcG9wV2FybmluZ0NvbnRleHQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIG9ubHkgZGVjcmVhc2UgZGVwcyBjb3VudCBpZiBzdXNwZW5zZSBpcyBub3QgYWxyZWFkeSByZXNvbHZlZFxyXG4gICAgICAgICAgICAgICAgaWYgKGlzSW5QZW5kaW5nU3VzcGVuc2UgJiYgLS1zdXNwZW5zZS5kZXBzID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3VzcGVuc2UucmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHVubW91bnQocGFyZW50U3VzcGVuc2UsIGRvUmVtb3ZlKSB7XHJcbiAgICAgICAgICAgIHN1c3BlbnNlLmlzVW5tb3VudGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgaWYgKHN1c3BlbnNlLmFjdGl2ZUJyYW5jaCkge1xyXG4gICAgICAgICAgICAgICAgdW5tb3VudChzdXNwZW5zZS5hY3RpdmVCcmFuY2gsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIGRvUmVtb3ZlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoc3VzcGVuc2UucGVuZGluZ0JyYW5jaCkge1xyXG4gICAgICAgICAgICAgICAgdW5tb3VudChzdXNwZW5zZS5wZW5kaW5nQnJhbmNoLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCBkb1JlbW92ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIHN1c3BlbnNlO1xyXG59XHJcbmZ1bmN0aW9uIGh5ZHJhdGVTdXNwZW5zZShub2RlLCB2bm9kZSwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkLCByZW5kZXJlckludGVybmFscywgaHlkcmF0ZU5vZGUpIHtcclxuICAgIC8qIGVzbGludC1kaXNhYmxlIG5vLXJlc3RyaWN0ZWQtZ2xvYmFscyAqL1xyXG4gICAgY29uc3Qgc3VzcGVuc2UgPSAodm5vZGUuc3VzcGVuc2UgPSBjcmVhdGVTdXNwZW5zZUJvdW5kYXJ5KHZub2RlLCBwYXJlbnRTdXNwZW5zZSwgcGFyZW50Q29tcG9uZW50LCBub2RlLnBhcmVudE5vZGUsIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpLCBudWxsLCBpc1NWRywgc2xvdFNjb3BlSWRzLCBvcHRpbWl6ZWQsIHJlbmRlcmVySW50ZXJuYWxzLCB0cnVlIC8qIGh5ZHJhdGluZyAqLykpO1xyXG4gICAgLy8gdGhlcmUgYXJlIHR3byBwb3NzaWJsZSBzY2VuYXJpb3MgZm9yIHNlcnZlci1yZW5kZXJlZCBzdXNwZW5zZTpcclxuICAgIC8vIC0gc3VjY2Vzczogc3NyIGNvbnRlbnQgc2hvdWxkIGJlIGZ1bGx5IHJlc29sdmVkXHJcbiAgICAvLyAtIGZhaWx1cmU6IHNzciBjb250ZW50IHNob3VsZCBiZSB0aGUgZmFsbGJhY2sgYnJhbmNoLlxyXG4gICAgLy8gaG93ZXZlciwgb24gdGhlIGNsaWVudCB3ZSBkb24ndCByZWFsbHkga25vdyBpZiBpdCBoYXMgZmFpbGVkIG9yIG5vdFxyXG4gICAgLy8gYXR0ZW1wdCB0byBoeWRyYXRlIHRoZSBET00gYXNzdW1pbmcgaXQgaGFzIHN1Y2NlZWRlZCwgYnV0IHdlIHN0aWxsXHJcbiAgICAvLyBuZWVkIHRvIGNvbnN0cnVjdCBhIHN1c3BlbnNlIGJvdW5kYXJ5IGZpcnN0XHJcbiAgICBjb25zdCByZXN1bHQgPSBoeWRyYXRlTm9kZShub2RlLCAoc3VzcGVuc2UucGVuZGluZ0JyYW5jaCA9IHZub2RlLnNzQ29udGVudCksIHBhcmVudENvbXBvbmVudCwgc3VzcGVuc2UsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKTtcclxuICAgIGlmIChzdXNwZW5zZS5kZXBzID09PSAwKSB7XHJcbiAgICAgICAgc3VzcGVuc2UucmVzb2x2ZSgpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIC8qIGVzbGludC1lbmFibGUgbm8tcmVzdHJpY3RlZC1nbG9iYWxzICovXHJcbn1cclxuZnVuY3Rpb24gbm9ybWFsaXplU3VzcGVuc2VDaGlsZHJlbih2bm9kZSkge1xyXG4gICAgY29uc3QgeyBzaGFwZUZsYWcsIGNoaWxkcmVuIH0gPSB2bm9kZTtcclxuICAgIGNvbnN0IGlzU2xvdENoaWxkcmVuID0gc2hhcGVGbGFnICYgMzIgLyogU0xPVFNfQ0hJTERSRU4gKi87XHJcbiAgICB2bm9kZS5zc0NvbnRlbnQgPSBub3JtYWxpemVTdXNwZW5zZVNsb3QoaXNTbG90Q2hpbGRyZW4gPyBjaGlsZHJlbi5kZWZhdWx0IDogY2hpbGRyZW4pO1xyXG4gICAgdm5vZGUuc3NGYWxsYmFjayA9IGlzU2xvdENoaWxkcmVuXHJcbiAgICAgICAgPyBub3JtYWxpemVTdXNwZW5zZVNsb3QoY2hpbGRyZW4uZmFsbGJhY2spXHJcbiAgICAgICAgOiBjcmVhdGVWTm9kZShDb21tZW50KTtcclxufVxyXG5mdW5jdGlvbiBub3JtYWxpemVTdXNwZW5zZVNsb3Qocykge1xyXG4gICAgbGV0IGJsb2NrO1xyXG4gICAgaWYgKGlzRnVuY3Rpb24ocykpIHtcclxuICAgICAgICBjb25zdCB0cmFja0Jsb2NrID0gaXNCbG9ja1RyZWVFbmFibGVkICYmIHMuX2M7XHJcbiAgICAgICAgaWYgKHRyYWNrQmxvY2spIHtcclxuICAgICAgICAgICAgLy8gZGlzYWJsZVRyYWNraW5nOiBmYWxzZVxyXG4gICAgICAgICAgICAvLyBhbGxvdyBibG9jayB0cmFja2luZyBmb3IgY29tcGlsZWQgc2xvdHNcclxuICAgICAgICAgICAgLy8gKHNlZSAuL2NvbXBvbmVudFJlbmRlckNvbnRleHQudHMpXHJcbiAgICAgICAgICAgIHMuX2QgPSBmYWxzZTtcclxuICAgICAgICAgICAgb3BlbkJsb2NrKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHMgPSBzKCk7XHJcbiAgICAgICAgaWYgKHRyYWNrQmxvY2spIHtcclxuICAgICAgICAgICAgcy5fZCA9IHRydWU7XHJcbiAgICAgICAgICAgIGJsb2NrID0gY3VycmVudEJsb2NrO1xyXG4gICAgICAgICAgICBjbG9zZUJsb2NrKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYgKGlzQXJyYXkocykpIHtcclxuICAgICAgICBjb25zdCBzaW5nbGVDaGlsZCA9IGZpbHRlclNpbmdsZVJvb3Qocyk7XHJcbiAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiAhc2luZ2xlQ2hpbGQpIHtcclxuICAgICAgICAgICAgd2FybihgPFN1c3BlbnNlPiBzbG90cyBleHBlY3QgYSBzaW5nbGUgcm9vdCBub2RlLmApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBzID0gc2luZ2xlQ2hpbGQ7XHJcbiAgICB9XHJcbiAgICBzID0gbm9ybWFsaXplVk5vZGUocyk7XHJcbiAgICBpZiAoYmxvY2sgJiYgIXMuZHluYW1pY0NoaWxkcmVuKSB7XHJcbiAgICAgICAgcy5keW5hbWljQ2hpbGRyZW4gPSBibG9jay5maWx0ZXIoYyA9PiBjICE9PSBzKTtcclxuICAgIH1cclxuICAgIHJldHVybiBzO1xyXG59XHJcbmZ1bmN0aW9uIHF1ZXVlRWZmZWN0V2l0aFN1c3BlbnNlKGZuLCBzdXNwZW5zZSkge1xyXG4gICAgaWYgKHN1c3BlbnNlICYmIHN1c3BlbnNlLnBlbmRpbmdCcmFuY2gpIHtcclxuICAgICAgICBpZiAoaXNBcnJheShmbikpIHtcclxuICAgICAgICAgICAgc3VzcGVuc2UuZWZmZWN0cy5wdXNoKC4uLmZuKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHN1c3BlbnNlLmVmZmVjdHMucHVzaChmbik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgcXVldWVQb3N0Rmx1c2hDYihmbik7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gc2V0QWN0aXZlQnJhbmNoKHN1c3BlbnNlLCBicmFuY2gpIHtcclxuICAgIHN1c3BlbnNlLmFjdGl2ZUJyYW5jaCA9IGJyYW5jaDtcclxuICAgIGNvbnN0IHsgdm5vZGUsIHBhcmVudENvbXBvbmVudCB9ID0gc3VzcGVuc2U7XHJcbiAgICBjb25zdCBlbCA9ICh2bm9kZS5lbCA9IGJyYW5jaC5lbCk7XHJcbiAgICAvLyBpbiBjYXNlIHN1c3BlbnNlIGlzIHRoZSByb290IG5vZGUgb2YgYSBjb21wb25lbnQsXHJcbiAgICAvLyByZWN1cnNpdmVseSB1cGRhdGUgdGhlIEhPQyBlbFxyXG4gICAgaWYgKHBhcmVudENvbXBvbmVudCAmJiBwYXJlbnRDb21wb25lbnQuc3ViVHJlZSA9PT0gdm5vZGUpIHtcclxuICAgICAgICBwYXJlbnRDb21wb25lbnQudm5vZGUuZWwgPSBlbDtcclxuICAgICAgICB1cGRhdGVIT0NIb3N0RWwocGFyZW50Q29tcG9uZW50LCBlbCk7XHJcbiAgICB9XHJcbn1cblxuZnVuY3Rpb24gcHJvdmlkZShrZXksIHZhbHVlKSB7XHJcbiAgICBpZiAoIWN1cnJlbnRJbnN0YW5jZSkge1xyXG4gICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgd2FybihgcHJvdmlkZSgpIGNhbiBvbmx5IGJlIHVzZWQgaW5zaWRlIHNldHVwKCkuYCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgbGV0IHByb3ZpZGVzID0gY3VycmVudEluc3RhbmNlLnByb3ZpZGVzO1xyXG4gICAgICAgIC8vIGJ5IGRlZmF1bHQgYW4gaW5zdGFuY2UgaW5oZXJpdHMgaXRzIHBhcmVudCdzIHByb3ZpZGVzIG9iamVjdFxyXG4gICAgICAgIC8vIGJ1dCB3aGVuIGl0IG5lZWRzIHRvIHByb3ZpZGUgdmFsdWVzIG9mIGl0cyBvd24sIGl0IGNyZWF0ZXMgaXRzXHJcbiAgICAgICAgLy8gb3duIHByb3ZpZGVzIG9iamVjdCB1c2luZyBwYXJlbnQgcHJvdmlkZXMgb2JqZWN0IGFzIHByb3RvdHlwZS5cclxuICAgICAgICAvLyB0aGlzIHdheSBpbiBgaW5qZWN0YCB3ZSBjYW4gc2ltcGx5IGxvb2sgdXAgaW5qZWN0aW9ucyBmcm9tIGRpcmVjdFxyXG4gICAgICAgIC8vIHBhcmVudCBhbmQgbGV0IHRoZSBwcm90b3R5cGUgY2hhaW4gZG8gdGhlIHdvcmsuXHJcbiAgICAgICAgY29uc3QgcGFyZW50UHJvdmlkZXMgPSBjdXJyZW50SW5zdGFuY2UucGFyZW50ICYmIGN1cnJlbnRJbnN0YW5jZS5wYXJlbnQucHJvdmlkZXM7XHJcbiAgICAgICAgaWYgKHBhcmVudFByb3ZpZGVzID09PSBwcm92aWRlcykge1xyXG4gICAgICAgICAgICBwcm92aWRlcyA9IGN1cnJlbnRJbnN0YW5jZS5wcm92aWRlcyA9IE9iamVjdC5jcmVhdGUocGFyZW50UHJvdmlkZXMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBUUyBkb2Vzbid0IGFsbG93IHN5bWJvbCBhcyBpbmRleCB0eXBlXHJcbiAgICAgICAgcHJvdmlkZXNba2V5XSA9IHZhbHVlO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGluamVjdChrZXksIGRlZmF1bHRWYWx1ZSwgdHJlYXREZWZhdWx0QXNGYWN0b3J5ID0gZmFsc2UpIHtcclxuICAgIC8vIGZhbGxiYWNrIHRvIGBjdXJyZW50UmVuZGVyaW5nSW5zdGFuY2VgIHNvIHRoYXQgdGhpcyBjYW4gYmUgY2FsbGVkIGluXHJcbiAgICAvLyBhIGZ1bmN0aW9uYWwgY29tcG9uZW50XHJcbiAgICBjb25zdCBpbnN0YW5jZSA9IGN1cnJlbnRJbnN0YW5jZSB8fCBjdXJyZW50UmVuZGVyaW5nSW5zdGFuY2U7XHJcbiAgICBpZiAoaW5zdGFuY2UpIHtcclxuICAgICAgICAvLyAjMjQwMFxyXG4gICAgICAgIC8vIHRvIHN1cHBvcnQgYGFwcC51c2VgIHBsdWdpbnMsXHJcbiAgICAgICAgLy8gZmFsbGJhY2sgdG8gYXBwQ29udGV4dCdzIGBwcm92aWRlc2AgaWYgdGhlIGluc3RhbmNlIGlzIGF0IHJvb3RcclxuICAgICAgICBjb25zdCBwcm92aWRlcyA9IGluc3RhbmNlLnBhcmVudCA9PSBudWxsXHJcbiAgICAgICAgICAgID8gaW5zdGFuY2Uudm5vZGUuYXBwQ29udGV4dCAmJiBpbnN0YW5jZS52bm9kZS5hcHBDb250ZXh0LnByb3ZpZGVzXHJcbiAgICAgICAgICAgIDogaW5zdGFuY2UucGFyZW50LnByb3ZpZGVzO1xyXG4gICAgICAgIGlmIChwcm92aWRlcyAmJiBrZXkgaW4gcHJvdmlkZXMpIHtcclxuICAgICAgICAgICAgLy8gVFMgZG9lc24ndCBhbGxvdyBzeW1ib2wgYXMgaW5kZXggdHlwZVxyXG4gICAgICAgICAgICByZXR1cm4gcHJvdmlkZXNba2V5XTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRyZWF0RGVmYXVsdEFzRmFjdG9yeSAmJiBpc0Z1bmN0aW9uKGRlZmF1bHRWYWx1ZSlcclxuICAgICAgICAgICAgICAgID8gZGVmYXVsdFZhbHVlLmNhbGwoaW5zdGFuY2UucHJveHkpXHJcbiAgICAgICAgICAgICAgICA6IGRlZmF1bHRWYWx1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgIHdhcm4oYGluamVjdGlvbiBcIiR7U3RyaW5nKGtleSl9XCIgbm90IGZvdW5kLmApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2UgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgIHdhcm4oYGluamVjdCgpIGNhbiBvbmx5IGJlIHVzZWQgaW5zaWRlIHNldHVwKCkgb3IgZnVuY3Rpb25hbCBjb21wb25lbnRzLmApO1xyXG4gICAgfVxyXG59XG5cbi8vIFNpbXBsZSBlZmZlY3QuXHJcbmZ1bmN0aW9uIHdhdGNoRWZmZWN0KGVmZmVjdCwgb3B0aW9ucykge1xyXG4gICAgcmV0dXJuIGRvV2F0Y2goZWZmZWN0LCBudWxsLCBvcHRpb25zKTtcclxufVxyXG5mdW5jdGlvbiB3YXRjaFBvc3RFZmZlY3QoZWZmZWN0LCBvcHRpb25zKSB7XHJcbiAgICByZXR1cm4gZG9XYXRjaChlZmZlY3QsIG51bGwsICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJylcclxuICAgICAgICA/IE9iamVjdC5hc3NpZ24ob3B0aW9ucyB8fCB7fSwgeyBmbHVzaDogJ3Bvc3QnIH0pXHJcbiAgICAgICAgOiB7IGZsdXNoOiAncG9zdCcgfSkpO1xyXG59XHJcbmZ1bmN0aW9uIHdhdGNoU3luY0VmZmVjdChlZmZlY3QsIG9wdGlvbnMpIHtcclxuICAgIHJldHVybiBkb1dhdGNoKGVmZmVjdCwgbnVsbCwgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKVxyXG4gICAgICAgID8gT2JqZWN0LmFzc2lnbihvcHRpb25zIHx8IHt9LCB7IGZsdXNoOiAnc3luYycgfSlcclxuICAgICAgICA6IHsgZmx1c2g6ICdzeW5jJyB9KSk7XHJcbn1cclxuLy8gaW5pdGlhbCB2YWx1ZSBmb3Igd2F0Y2hlcnMgdG8gdHJpZ2dlciBvbiB1bmRlZmluZWQgaW5pdGlhbCB2YWx1ZXNcclxuY29uc3QgSU5JVElBTF9XQVRDSEVSX1ZBTFVFID0ge307XHJcbi8vIGltcGxlbWVudGF0aW9uXHJcbmZ1bmN0aW9uIHdhdGNoKHNvdXJjZSwgY2IsIG9wdGlvbnMpIHtcclxuICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiYgIWlzRnVuY3Rpb24oY2IpKSB7XHJcbiAgICAgICAgd2FybihgXFxgd2F0Y2goZm4sIG9wdGlvbnM/KVxcYCBzaWduYXR1cmUgaGFzIGJlZW4gbW92ZWQgdG8gYSBzZXBhcmF0ZSBBUEkuIGAgK1xyXG4gICAgICAgICAgICBgVXNlIFxcYHdhdGNoRWZmZWN0KGZuLCBvcHRpb25zPylcXGAgaW5zdGVhZC4gXFxgd2F0Y2hcXGAgbm93IG9ubHkgYCArXHJcbiAgICAgICAgICAgIGBzdXBwb3J0cyBcXGB3YXRjaChzb3VyY2UsIGNiLCBvcHRpb25zPykgc2lnbmF0dXJlLmApO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGRvV2F0Y2goc291cmNlLCBjYiwgb3B0aW9ucyk7XHJcbn1cclxuZnVuY3Rpb24gZG9XYXRjaChzb3VyY2UsIGNiLCB7IGltbWVkaWF0ZSwgZGVlcCwgZmx1c2gsIG9uVHJhY2ssIG9uVHJpZ2dlciB9ID0gRU1QVFlfT0JKKSB7XHJcbiAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmICFjYikge1xyXG4gICAgICAgIGlmIChpbW1lZGlhdGUgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICB3YXJuKGB3YXRjaCgpIFwiaW1tZWRpYXRlXCIgb3B0aW9uIGlzIG9ubHkgcmVzcGVjdGVkIHdoZW4gdXNpbmcgdGhlIGAgK1xyXG4gICAgICAgICAgICAgICAgYHdhdGNoKHNvdXJjZSwgY2FsbGJhY2ssIG9wdGlvbnM/KSBzaWduYXR1cmUuYCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChkZWVwICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgd2Fybihgd2F0Y2goKSBcImRlZXBcIiBvcHRpb24gaXMgb25seSByZXNwZWN0ZWQgd2hlbiB1c2luZyB0aGUgYCArXHJcbiAgICAgICAgICAgICAgICBgd2F0Y2goc291cmNlLCBjYWxsYmFjaywgb3B0aW9ucz8pIHNpZ25hdHVyZS5gKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBjb25zdCB3YXJuSW52YWxpZFNvdXJjZSA9IChzKSA9PiB7XHJcbiAgICAgICAgd2FybihgSW52YWxpZCB3YXRjaCBzb3VyY2U6IGAsIHMsIGBBIHdhdGNoIHNvdXJjZSBjYW4gb25seSBiZSBhIGdldHRlci9lZmZlY3QgZnVuY3Rpb24sIGEgcmVmLCBgICtcclxuICAgICAgICAgICAgYGEgcmVhY3RpdmUgb2JqZWN0LCBvciBhbiBhcnJheSBvZiB0aGVzZSB0eXBlcy5gKTtcclxuICAgIH07XHJcbiAgICBjb25zdCBpbnN0YW5jZSA9IGN1cnJlbnRJbnN0YW5jZTtcclxuICAgIGxldCBnZXR0ZXI7XHJcbiAgICBsZXQgZm9yY2VUcmlnZ2VyID0gZmFsc2U7XHJcbiAgICBsZXQgaXNNdWx0aVNvdXJjZSA9IGZhbHNlO1xyXG4gICAgaWYgKGlzUmVmKHNvdXJjZSkpIHtcclxuICAgICAgICBnZXR0ZXIgPSAoKSA9PiBzb3VyY2UudmFsdWU7XHJcbiAgICAgICAgZm9yY2VUcmlnZ2VyID0gaXNTaGFsbG93JDEoc291cmNlKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGlzUmVhY3RpdmUoc291cmNlKSkge1xyXG4gICAgICAgIGdldHRlciA9ICgpID0+IHNvdXJjZTtcclxuICAgICAgICBkZWVwID0gdHJ1ZTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGlzQXJyYXkoc291cmNlKSkge1xyXG4gICAgICAgIGlzTXVsdGlTb3VyY2UgPSB0cnVlO1xyXG4gICAgICAgIGZvcmNlVHJpZ2dlciA9IHNvdXJjZS5zb21lKGlzUmVhY3RpdmUpO1xyXG4gICAgICAgIGdldHRlciA9ICgpID0+IHNvdXJjZS5tYXAocyA9PiB7XHJcbiAgICAgICAgICAgIGlmIChpc1JlZihzKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHMudmFsdWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoaXNSZWFjdGl2ZShzKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRyYXZlcnNlKHMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGlzRnVuY3Rpb24ocykpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjYWxsV2l0aEVycm9ySGFuZGxpbmcocywgaW5zdGFuY2UsIDIgLyogV0FUQ0hfR0VUVEVSICovKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiB3YXJuSW52YWxpZFNvdXJjZShzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoaXNGdW5jdGlvbihzb3VyY2UpKSB7XHJcbiAgICAgICAgaWYgKGNiKSB7XHJcbiAgICAgICAgICAgIC8vIGdldHRlciB3aXRoIGNiXHJcbiAgICAgICAgICAgIGdldHRlciA9ICgpID0+IGNhbGxXaXRoRXJyb3JIYW5kbGluZyhzb3VyY2UsIGluc3RhbmNlLCAyIC8qIFdBVENIX0dFVFRFUiAqLyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBubyBjYiAtPiBzaW1wbGUgZWZmZWN0XHJcbiAgICAgICAgICAgIGdldHRlciA9ICgpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChpbnN0YW5jZSAmJiBpbnN0YW5jZS5pc1VubW91bnRlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChjbGVhbnVwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2xlYW51cCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNhbGxXaXRoQXN5bmNFcnJvckhhbmRsaW5nKHNvdXJjZSwgaW5zdGFuY2UsIDMgLyogV0FUQ0hfQ0FMTEJBQ0sgKi8sIFtvbkNsZWFudXBdKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBnZXR0ZXIgPSBOT09QO1xyXG4gICAgICAgIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiB3YXJuSW52YWxpZFNvdXJjZShzb3VyY2UpO1xyXG4gICAgfVxyXG4gICAgaWYgKGNiICYmIGRlZXApIHtcclxuICAgICAgICBjb25zdCBiYXNlR2V0dGVyID0gZ2V0dGVyO1xyXG4gICAgICAgIGdldHRlciA9ICgpID0+IHRyYXZlcnNlKGJhc2VHZXR0ZXIoKSk7XHJcbiAgICB9XHJcbiAgICBsZXQgY2xlYW51cDtcclxuICAgIGxldCBvbkNsZWFudXAgPSAoZm4pID0+IHtcclxuICAgICAgICBjbGVhbnVwID0gZWZmZWN0Lm9uU3RvcCA9ICgpID0+IHtcclxuICAgICAgICAgICAgY2FsbFdpdGhFcnJvckhhbmRsaW5nKGZuLCBpbnN0YW5jZSwgNCAvKiBXQVRDSF9DTEVBTlVQICovKTtcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuICAgIC8vIGluIFNTUiB0aGVyZSBpcyBubyBuZWVkIHRvIHNldHVwIGFuIGFjdHVhbCBlZmZlY3QsIGFuZCBpdCBzaG91bGQgYmUgbm9vcFxyXG4gICAgLy8gdW5sZXNzIGl0J3MgZWFnZXJcclxuICAgIGlmIChpc0luU1NSQ29tcG9uZW50U2V0dXApIHtcclxuICAgICAgICAvLyB3ZSB3aWxsIGFsc28gbm90IGNhbGwgdGhlIGludmFsaWRhdGUgY2FsbGJhY2sgKCsgcnVubmVyIGlzIG5vdCBzZXQgdXApXHJcbiAgICAgICAgb25DbGVhbnVwID0gTk9PUDtcclxuICAgICAgICBpZiAoIWNiKSB7XHJcbiAgICAgICAgICAgIGdldHRlcigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChpbW1lZGlhdGUpIHtcclxuICAgICAgICAgICAgY2FsbFdpdGhBc3luY0Vycm9ySGFuZGxpbmcoY2IsIGluc3RhbmNlLCAzIC8qIFdBVENIX0NBTExCQUNLICovLCBbXHJcbiAgICAgICAgICAgICAgICBnZXR0ZXIoKSxcclxuICAgICAgICAgICAgICAgIGlzTXVsdGlTb3VyY2UgPyBbXSA6IHVuZGVmaW5lZCxcclxuICAgICAgICAgICAgICAgIG9uQ2xlYW51cFxyXG4gICAgICAgICAgICBdKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIE5PT1A7XHJcbiAgICB9XHJcbiAgICBsZXQgb2xkVmFsdWUgPSBpc011bHRpU291cmNlID8gW10gOiBJTklUSUFMX1dBVENIRVJfVkFMVUU7XHJcbiAgICBjb25zdCBqb2IgPSAoKSA9PiB7XHJcbiAgICAgICAgaWYgKCFlZmZlY3QuYWN0aXZlKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGNiKSB7XHJcbiAgICAgICAgICAgIC8vIHdhdGNoKHNvdXJjZSwgY2IpXHJcbiAgICAgICAgICAgIGNvbnN0IG5ld1ZhbHVlID0gZWZmZWN0LnJ1bigpO1xyXG4gICAgICAgICAgICBpZiAoZGVlcCB8fFxyXG4gICAgICAgICAgICAgICAgZm9yY2VUcmlnZ2VyIHx8XHJcbiAgICAgICAgICAgICAgICAoaXNNdWx0aVNvdXJjZVxyXG4gICAgICAgICAgICAgICAgICAgID8gbmV3VmFsdWUuc29tZSgodiwgaSkgPT4gaGFzQ2hhbmdlZCh2LCBvbGRWYWx1ZVtpXSkpXHJcbiAgICAgICAgICAgICAgICAgICAgOiBoYXNDaGFuZ2VkKG5ld1ZhbHVlLCBvbGRWYWx1ZSkpIHx8XHJcbiAgICAgICAgICAgICAgICAoZmFsc2UgICkpIHtcclxuICAgICAgICAgICAgICAgIC8vIGNsZWFudXAgYmVmb3JlIHJ1bm5pbmcgY2IgYWdhaW5cclxuICAgICAgICAgICAgICAgIGlmIChjbGVhbnVwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2xlYW51cCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY2FsbFdpdGhBc3luY0Vycm9ySGFuZGxpbmcoY2IsIGluc3RhbmNlLCAzIC8qIFdBVENIX0NBTExCQUNLICovLCBbXHJcbiAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWUsXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gcGFzcyB1bmRlZmluZWQgYXMgdGhlIG9sZCB2YWx1ZSB3aGVuIGl0J3MgY2hhbmdlZCBmb3IgdGhlIGZpcnN0IHRpbWVcclxuICAgICAgICAgICAgICAgICAgICBvbGRWYWx1ZSA9PT0gSU5JVElBTF9XQVRDSEVSX1ZBTFVFID8gdW5kZWZpbmVkIDogb2xkVmFsdWUsXHJcbiAgICAgICAgICAgICAgICAgICAgb25DbGVhbnVwXHJcbiAgICAgICAgICAgICAgICBdKTtcclxuICAgICAgICAgICAgICAgIG9sZFZhbHVlID0gbmV3VmFsdWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIHdhdGNoRWZmZWN0XHJcbiAgICAgICAgICAgIGVmZmVjdC5ydW4oKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLy8gaW1wb3J0YW50OiBtYXJrIHRoZSBqb2IgYXMgYSB3YXRjaGVyIGNhbGxiYWNrIHNvIHRoYXQgc2NoZWR1bGVyIGtub3dzXHJcbiAgICAvLyBpdCBpcyBhbGxvd2VkIHRvIHNlbGYtdHJpZ2dlciAoIzE3MjcpXHJcbiAgICBqb2IuYWxsb3dSZWN1cnNlID0gISFjYjtcclxuICAgIGxldCBzY2hlZHVsZXI7XHJcbiAgICBpZiAoZmx1c2ggPT09ICdzeW5jJykge1xyXG4gICAgICAgIHNjaGVkdWxlciA9IGpvYjsgLy8gdGhlIHNjaGVkdWxlciBmdW5jdGlvbiBnZXRzIGNhbGxlZCBkaXJlY3RseVxyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoZmx1c2ggPT09ICdwb3N0Jykge1xyXG4gICAgICAgIHNjaGVkdWxlciA9ICgpID0+IHF1ZXVlUG9zdFJlbmRlckVmZmVjdChqb2IsIGluc3RhbmNlICYmIGluc3RhbmNlLnN1c3BlbnNlKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIC8vIGRlZmF1bHQ6ICdwcmUnXHJcbiAgICAgICAgc2NoZWR1bGVyID0gKCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoIWluc3RhbmNlIHx8IGluc3RhbmNlLmlzTW91bnRlZCkge1xyXG4gICAgICAgICAgICAgICAgcXVldWVQcmVGbHVzaENiKGpvYik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyB3aXRoICdwcmUnIG9wdGlvbiwgdGhlIGZpcnN0IGNhbGwgbXVzdCBoYXBwZW4gYmVmb3JlXHJcbiAgICAgICAgICAgICAgICAvLyB0aGUgY29tcG9uZW50IGlzIG1vdW50ZWQgc28gaXQgaXMgY2FsbGVkIHN5bmNocm9ub3VzbHkuXHJcbiAgICAgICAgICAgICAgICBqb2IoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbiAgICBjb25zdCBlZmZlY3QgPSBuZXcgUmVhY3RpdmVFZmZlY3QoZ2V0dGVyLCBzY2hlZHVsZXIpO1xyXG4gICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgIGVmZmVjdC5vblRyYWNrID0gb25UcmFjaztcclxuICAgICAgICBlZmZlY3Qub25UcmlnZ2VyID0gb25UcmlnZ2VyO1xyXG4gICAgfVxyXG4gICAgLy8gaW5pdGlhbCBydW5cclxuICAgIGlmIChjYikge1xyXG4gICAgICAgIGlmIChpbW1lZGlhdGUpIHtcclxuICAgICAgICAgICAgam9iKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBvbGRWYWx1ZSA9IGVmZmVjdC5ydW4oKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChmbHVzaCA9PT0gJ3Bvc3QnKSB7XHJcbiAgICAgICAgcXVldWVQb3N0UmVuZGVyRWZmZWN0KGVmZmVjdC5ydW4uYmluZChlZmZlY3QpLCBpbnN0YW5jZSAmJiBpbnN0YW5jZS5zdXNwZW5zZSk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBlZmZlY3QucnVuKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gKCkgPT4ge1xyXG4gICAgICAgIGVmZmVjdC5zdG9wKCk7XHJcbiAgICAgICAgaWYgKGluc3RhbmNlICYmIGluc3RhbmNlLnNjb3BlKSB7XHJcbiAgICAgICAgICAgIHJlbW92ZShpbnN0YW5jZS5zY29wZS5lZmZlY3RzLCBlZmZlY3QpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn1cclxuLy8gdGhpcy4kd2F0Y2hcclxuZnVuY3Rpb24gaW5zdGFuY2VXYXRjaChzb3VyY2UsIHZhbHVlLCBvcHRpb25zKSB7XHJcbiAgICBjb25zdCBwdWJsaWNUaGlzID0gdGhpcy5wcm94eTtcclxuICAgIGNvbnN0IGdldHRlciA9IGlzU3RyaW5nKHNvdXJjZSlcclxuICAgICAgICA/IHNvdXJjZS5pbmNsdWRlcygnLicpXHJcbiAgICAgICAgICAgID8gY3JlYXRlUGF0aEdldHRlcihwdWJsaWNUaGlzLCBzb3VyY2UpXHJcbiAgICAgICAgICAgIDogKCkgPT4gcHVibGljVGhpc1tzb3VyY2VdXHJcbiAgICAgICAgOiBzb3VyY2UuYmluZChwdWJsaWNUaGlzLCBwdWJsaWNUaGlzKTtcclxuICAgIGxldCBjYjtcclxuICAgIGlmIChpc0Z1bmN0aW9uKHZhbHVlKSkge1xyXG4gICAgICAgIGNiID0gdmFsdWU7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBjYiA9IHZhbHVlLmhhbmRsZXI7XHJcbiAgICAgICAgb3B0aW9ucyA9IHZhbHVlO1xyXG4gICAgfVxyXG4gICAgY29uc3QgY3VyID0gY3VycmVudEluc3RhbmNlO1xyXG4gICAgc2V0Q3VycmVudEluc3RhbmNlKHRoaXMpO1xyXG4gICAgY29uc3QgcmVzID0gZG9XYXRjaChnZXR0ZXIsIGNiLmJpbmQocHVibGljVGhpcyksIG9wdGlvbnMpO1xyXG4gICAgaWYgKGN1cikge1xyXG4gICAgICAgIHNldEN1cnJlbnRJbnN0YW5jZShjdXIpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgdW5zZXRDdXJyZW50SW5zdGFuY2UoKTtcclxuICAgIH1cclxuICAgIHJldHVybiByZXM7XHJcbn1cclxuZnVuY3Rpb24gY3JlYXRlUGF0aEdldHRlcihjdHgsIHBhdGgpIHtcclxuICAgIGNvbnN0IHNlZ21lbnRzID0gcGF0aC5zcGxpdCgnLicpO1xyXG4gICAgcmV0dXJuICgpID0+IHtcclxuICAgICAgICBsZXQgY3VyID0gY3R4O1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2VnbWVudHMubGVuZ3RoICYmIGN1cjsgaSsrKSB7XHJcbiAgICAgICAgICAgIGN1ciA9IGN1cltzZWdtZW50c1tpXV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBjdXI7XHJcbiAgICB9O1xyXG59XHJcbmZ1bmN0aW9uIHRyYXZlcnNlKHZhbHVlLCBzZWVuKSB7XHJcbiAgICBpZiAoIWlzT2JqZWN0KHZhbHVlKSB8fCB2YWx1ZVtcIl9fdl9za2lwXCIgLyogU0tJUCAqL10pIHtcclxuICAgICAgICByZXR1cm4gdmFsdWU7XHJcbiAgICB9XHJcbiAgICBzZWVuID0gc2VlbiB8fCBuZXcgU2V0KCk7XHJcbiAgICBpZiAoc2Vlbi5oYXModmFsdWUpKSB7XHJcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgfVxyXG4gICAgc2Vlbi5hZGQodmFsdWUpO1xyXG4gICAgaWYgKGlzUmVmKHZhbHVlKSkge1xyXG4gICAgICAgIHRyYXZlcnNlKHZhbHVlLnZhbHVlLCBzZWVuKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGlzQXJyYXkodmFsdWUpKSB7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB2YWx1ZS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB0cmF2ZXJzZSh2YWx1ZVtpXSwgc2Vlbik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoaXNTZXQodmFsdWUpIHx8IGlzTWFwKHZhbHVlKSkge1xyXG4gICAgICAgIHZhbHVlLmZvckVhY2goKHYpID0+IHtcclxuICAgICAgICAgICAgdHJhdmVyc2Uodiwgc2Vlbik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChpc1BsYWluT2JqZWN0KHZhbHVlKSkge1xyXG4gICAgICAgIGZvciAoY29uc3Qga2V5IGluIHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHRyYXZlcnNlKHZhbHVlW2tleV0sIHNlZW4pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiB2YWx1ZTtcclxufVxuXG5mdW5jdGlvbiB1c2VUcmFuc2l0aW9uU3RhdGUoKSB7XHJcbiAgICBjb25zdCBzdGF0ZSA9IHtcclxuICAgICAgICBpc01vdW50ZWQ6IGZhbHNlLFxyXG4gICAgICAgIGlzTGVhdmluZzogZmFsc2UsXHJcbiAgICAgICAgaXNVbm1vdW50aW5nOiBmYWxzZSxcclxuICAgICAgICBsZWF2aW5nVk5vZGVzOiBuZXcgTWFwKClcclxuICAgIH07XHJcbiAgICBvbk1vdW50ZWQoKCkgPT4ge1xyXG4gICAgICAgIHN0YXRlLmlzTW91bnRlZCA9IHRydWU7XHJcbiAgICB9KTtcclxuICAgIG9uQmVmb3JlVW5tb3VudCgoKSA9PiB7XHJcbiAgICAgICAgc3RhdGUuaXNVbm1vdW50aW5nID0gdHJ1ZTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHN0YXRlO1xyXG59XHJcbmNvbnN0IFRyYW5zaXRpb25Ib29rVmFsaWRhdG9yID0gW0Z1bmN0aW9uLCBBcnJheV07XHJcbmNvbnN0IEJhc2VUcmFuc2l0aW9uSW1wbCA9IHtcclxuICAgIG5hbWU6IGBCYXNlVHJhbnNpdGlvbmAsXHJcbiAgICBwcm9wczoge1xyXG4gICAgICAgIG1vZGU6IFN0cmluZyxcclxuICAgICAgICBhcHBlYXI6IEJvb2xlYW4sXHJcbiAgICAgICAgcGVyc2lzdGVkOiBCb29sZWFuLFxyXG4gICAgICAgIC8vIGVudGVyXHJcbiAgICAgICAgb25CZWZvcmVFbnRlcjogVHJhbnNpdGlvbkhvb2tWYWxpZGF0b3IsXHJcbiAgICAgICAgb25FbnRlcjogVHJhbnNpdGlvbkhvb2tWYWxpZGF0b3IsXHJcbiAgICAgICAgb25BZnRlckVudGVyOiBUcmFuc2l0aW9uSG9va1ZhbGlkYXRvcixcclxuICAgICAgICBvbkVudGVyQ2FuY2VsbGVkOiBUcmFuc2l0aW9uSG9va1ZhbGlkYXRvcixcclxuICAgICAgICAvLyBsZWF2ZVxyXG4gICAgICAgIG9uQmVmb3JlTGVhdmU6IFRyYW5zaXRpb25Ib29rVmFsaWRhdG9yLFxyXG4gICAgICAgIG9uTGVhdmU6IFRyYW5zaXRpb25Ib29rVmFsaWRhdG9yLFxyXG4gICAgICAgIG9uQWZ0ZXJMZWF2ZTogVHJhbnNpdGlvbkhvb2tWYWxpZGF0b3IsXHJcbiAgICAgICAgb25MZWF2ZUNhbmNlbGxlZDogVHJhbnNpdGlvbkhvb2tWYWxpZGF0b3IsXHJcbiAgICAgICAgLy8gYXBwZWFyXHJcbiAgICAgICAgb25CZWZvcmVBcHBlYXI6IFRyYW5zaXRpb25Ib29rVmFsaWRhdG9yLFxyXG4gICAgICAgIG9uQXBwZWFyOiBUcmFuc2l0aW9uSG9va1ZhbGlkYXRvcixcclxuICAgICAgICBvbkFmdGVyQXBwZWFyOiBUcmFuc2l0aW9uSG9va1ZhbGlkYXRvcixcclxuICAgICAgICBvbkFwcGVhckNhbmNlbGxlZDogVHJhbnNpdGlvbkhvb2tWYWxpZGF0b3JcclxuICAgIH0sXHJcbiAgICBzZXR1cChwcm9wcywgeyBzbG90cyB9KSB7XHJcbiAgICAgICAgY29uc3QgaW5zdGFuY2UgPSBnZXRDdXJyZW50SW5zdGFuY2UoKTtcclxuICAgICAgICBjb25zdCBzdGF0ZSA9IHVzZVRyYW5zaXRpb25TdGF0ZSgpO1xyXG4gICAgICAgIGxldCBwcmV2VHJhbnNpdGlvbktleTtcclxuICAgICAgICByZXR1cm4gKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjaGlsZHJlbiA9IHNsb3RzLmRlZmF1bHQgJiYgZ2V0VHJhbnNpdGlvblJhd0NoaWxkcmVuKHNsb3RzLmRlZmF1bHQoKSwgdHJ1ZSk7XHJcbiAgICAgICAgICAgIGlmICghY2hpbGRyZW4gfHwgIWNoaWxkcmVuLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIHdhcm4gbXVsdGlwbGUgZWxlbWVudHNcclxuICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiBjaGlsZHJlbi5sZW5ndGggPiAxKSB7XHJcbiAgICAgICAgICAgICAgICB3YXJuKCc8dHJhbnNpdGlvbj4gY2FuIG9ubHkgYmUgdXNlZCBvbiBhIHNpbmdsZSBlbGVtZW50IG9yIGNvbXBvbmVudC4gVXNlICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8dHJhbnNpdGlvbi1ncm91cD4gZm9yIGxpc3RzLicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIHRoZXJlJ3Mgbm8gbmVlZCB0byB0cmFjayByZWFjdGl2aXR5IGZvciB0aGVzZSBwcm9wcyBzbyB1c2UgdGhlIHJhd1xyXG4gICAgICAgICAgICAvLyBwcm9wcyBmb3IgYSBiaXQgYmV0dGVyIHBlcmZcclxuICAgICAgICAgICAgY29uc3QgcmF3UHJvcHMgPSB0b1Jhdyhwcm9wcyk7XHJcbiAgICAgICAgICAgIGNvbnN0IHsgbW9kZSB9ID0gcmF3UHJvcHM7XHJcbiAgICAgICAgICAgIC8vIGNoZWNrIG1vZGVcclxuICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJlxyXG4gICAgICAgICAgICAgICAgbW9kZSAmJlxyXG4gICAgICAgICAgICAgICAgbW9kZSAhPT0gJ2luLW91dCcgJiYgbW9kZSAhPT0gJ291dC1pbicgJiYgbW9kZSAhPT0gJ2RlZmF1bHQnKSB7XHJcbiAgICAgICAgICAgICAgICB3YXJuKGBpbnZhbGlkIDx0cmFuc2l0aW9uPiBtb2RlOiAke21vZGV9YCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gYXQgdGhpcyBwb2ludCBjaGlsZHJlbiBoYXMgYSBndWFyYW50ZWVkIGxlbmd0aCBvZiAxLlxyXG4gICAgICAgICAgICBjb25zdCBjaGlsZCA9IGNoaWxkcmVuWzBdO1xyXG4gICAgICAgICAgICBpZiAoc3RhdGUuaXNMZWF2aW5nKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZW1wdHlQbGFjZWhvbGRlcihjaGlsZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gaW4gdGhlIGNhc2Ugb2YgPHRyYW5zaXRpb24+PGtlZXAtYWxpdmUvPjwvdHJhbnNpdGlvbj4sIHdlIG5lZWQgdG9cclxuICAgICAgICAgICAgLy8gY29tcGFyZSB0aGUgdHlwZSBvZiB0aGUga2VwdC1hbGl2ZSBjaGlsZHJlbi5cclxuICAgICAgICAgICAgY29uc3QgaW5uZXJDaGlsZCA9IGdldEtlZXBBbGl2ZUNoaWxkKGNoaWxkKTtcclxuICAgICAgICAgICAgaWYgKCFpbm5lckNoaWxkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZW1wdHlQbGFjZWhvbGRlcihjaGlsZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgZW50ZXJIb29rcyA9IHJlc29sdmVUcmFuc2l0aW9uSG9va3MoaW5uZXJDaGlsZCwgcmF3UHJvcHMsIHN0YXRlLCBpbnN0YW5jZSk7XHJcbiAgICAgICAgICAgIHNldFRyYW5zaXRpb25Ib29rcyhpbm5lckNoaWxkLCBlbnRlckhvb2tzKTtcclxuICAgICAgICAgICAgY29uc3Qgb2xkQ2hpbGQgPSBpbnN0YW5jZS5zdWJUcmVlO1xyXG4gICAgICAgICAgICBjb25zdCBvbGRJbm5lckNoaWxkID0gb2xkQ2hpbGQgJiYgZ2V0S2VlcEFsaXZlQ2hpbGQob2xkQ2hpbGQpO1xyXG4gICAgICAgICAgICBsZXQgdHJhbnNpdGlvbktleUNoYW5nZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgY29uc3QgeyBnZXRUcmFuc2l0aW9uS2V5IH0gPSBpbm5lckNoaWxkLnR5cGU7XHJcbiAgICAgICAgICAgIGlmIChnZXRUcmFuc2l0aW9uS2V5KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBrZXkgPSBnZXRUcmFuc2l0aW9uS2V5KCk7XHJcbiAgICAgICAgICAgICAgICBpZiAocHJldlRyYW5zaXRpb25LZXkgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHByZXZUcmFuc2l0aW9uS2V5ID0ga2V5O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoa2V5ICE9PSBwcmV2VHJhbnNpdGlvbktleSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHByZXZUcmFuc2l0aW9uS2V5ID0ga2V5O1xyXG4gICAgICAgICAgICAgICAgICAgIHRyYW5zaXRpb25LZXlDaGFuZ2VkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBoYW5kbGUgbW9kZVxyXG4gICAgICAgICAgICBpZiAob2xkSW5uZXJDaGlsZCAmJlxyXG4gICAgICAgICAgICAgICAgb2xkSW5uZXJDaGlsZC50eXBlICE9PSBDb21tZW50ICYmXHJcbiAgICAgICAgICAgICAgICAoIWlzU2FtZVZOb2RlVHlwZShpbm5lckNoaWxkLCBvbGRJbm5lckNoaWxkKSB8fCB0cmFuc2l0aW9uS2V5Q2hhbmdlZCkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGxlYXZpbmdIb29rcyA9IHJlc29sdmVUcmFuc2l0aW9uSG9va3Mob2xkSW5uZXJDaGlsZCwgcmF3UHJvcHMsIHN0YXRlLCBpbnN0YW5jZSk7XHJcbiAgICAgICAgICAgICAgICAvLyB1cGRhdGUgb2xkIHRyZWUncyBob29rcyBpbiBjYXNlIG9mIGR5bmFtaWMgdHJhbnNpdGlvblxyXG4gICAgICAgICAgICAgICAgc2V0VHJhbnNpdGlvbkhvb2tzKG9sZElubmVyQ2hpbGQsIGxlYXZpbmdIb29rcyk7XHJcbiAgICAgICAgICAgICAgICAvLyBzd2l0Y2hpbmcgYmV0d2VlbiBkaWZmZXJlbnQgdmlld3NcclxuICAgICAgICAgICAgICAgIGlmIChtb2RlID09PSAnb3V0LWluJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmlzTGVhdmluZyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gcmV0dXJuIHBsYWNlaG9sZGVyIG5vZGUgYW5kIHF1ZXVlIHVwZGF0ZSB3aGVuIGxlYXZlIGZpbmlzaGVzXHJcbiAgICAgICAgICAgICAgICAgICAgbGVhdmluZ0hvb2tzLmFmdGVyTGVhdmUgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlLmlzTGVhdmluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZS51cGRhdGUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBlbXB0eVBsYWNlaG9sZGVyKGNoaWxkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKG1vZGUgPT09ICdpbi1vdXQnICYmIGlubmVyQ2hpbGQudHlwZSAhPT0gQ29tbWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxlYXZpbmdIb29rcy5kZWxheUxlYXZlID0gKGVsLCBlYXJseVJlbW92ZSwgZGVsYXllZExlYXZlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGxlYXZpbmdWTm9kZXNDYWNoZSA9IGdldExlYXZpbmdOb2Rlc0ZvclR5cGUoc3RhdGUsIG9sZElubmVyQ2hpbGQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZWF2aW5nVk5vZGVzQ2FjaGVbU3RyaW5nKG9sZElubmVyQ2hpbGQua2V5KV0gPSBvbGRJbm5lckNoaWxkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBlYXJseSByZW1vdmFsIGNhbGxiYWNrXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsLl9sZWF2ZUNiID0gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWFybHlSZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsLl9sZWF2ZUNiID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGVudGVySG9va3MuZGVsYXllZExlYXZlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbnRlckhvb2tzLmRlbGF5ZWRMZWF2ZSA9IGRlbGF5ZWRMZWF2ZTtcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBjaGlsZDtcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG59O1xyXG4vLyBleHBvcnQgdGhlIHB1YmxpYyB0eXBlIGZvciBoL3RzeCBpbmZlcmVuY2VcclxuLy8gYWxzbyB0byBhdm9pZCBpbmxpbmUgaW1wb3J0KCkgaW4gZ2VuZXJhdGVkIGQudHMgZmlsZXNcclxuY29uc3QgQmFzZVRyYW5zaXRpb24gPSBCYXNlVHJhbnNpdGlvbkltcGw7XHJcbmZ1bmN0aW9uIGdldExlYXZpbmdOb2Rlc0ZvclR5cGUoc3RhdGUsIHZub2RlKSB7XHJcbiAgICBjb25zdCB7IGxlYXZpbmdWTm9kZXMgfSA9IHN0YXRlO1xyXG4gICAgbGV0IGxlYXZpbmdWTm9kZXNDYWNoZSA9IGxlYXZpbmdWTm9kZXMuZ2V0KHZub2RlLnR5cGUpO1xyXG4gICAgaWYgKCFsZWF2aW5nVk5vZGVzQ2FjaGUpIHtcclxuICAgICAgICBsZWF2aW5nVk5vZGVzQ2FjaGUgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xyXG4gICAgICAgIGxlYXZpbmdWTm9kZXMuc2V0KHZub2RlLnR5cGUsIGxlYXZpbmdWTm9kZXNDYWNoZSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbGVhdmluZ1ZOb2Rlc0NhY2hlO1xyXG59XHJcbi8vIFRoZSB0cmFuc2l0aW9uIGhvb2tzIGFyZSBhdHRhY2hlZCB0byB0aGUgdm5vZGUgYXMgdm5vZGUudHJhbnNpdGlvblxyXG4vLyBhbmQgd2lsbCBiZSBjYWxsZWQgYXQgYXBwcm9wcmlhdGUgdGltaW5nIGluIHRoZSByZW5kZXJlci5cclxuZnVuY3Rpb24gcmVzb2x2ZVRyYW5zaXRpb25Ib29rcyh2bm9kZSwgcHJvcHMsIHN0YXRlLCBpbnN0YW5jZSkge1xyXG4gICAgY29uc3QgeyBhcHBlYXIsIG1vZGUsIHBlcnNpc3RlZCA9IGZhbHNlLCBvbkJlZm9yZUVudGVyLCBvbkVudGVyLCBvbkFmdGVyRW50ZXIsIG9uRW50ZXJDYW5jZWxsZWQsIG9uQmVmb3JlTGVhdmUsIG9uTGVhdmUsIG9uQWZ0ZXJMZWF2ZSwgb25MZWF2ZUNhbmNlbGxlZCwgb25CZWZvcmVBcHBlYXIsIG9uQXBwZWFyLCBvbkFmdGVyQXBwZWFyLCBvbkFwcGVhckNhbmNlbGxlZCB9ID0gcHJvcHM7XHJcbiAgICBjb25zdCBrZXkgPSBTdHJpbmcodm5vZGUua2V5KTtcclxuICAgIGNvbnN0IGxlYXZpbmdWTm9kZXNDYWNoZSA9IGdldExlYXZpbmdOb2Rlc0ZvclR5cGUoc3RhdGUsIHZub2RlKTtcclxuICAgIGNvbnN0IGNhbGxIb29rID0gKGhvb2ssIGFyZ3MpID0+IHtcclxuICAgICAgICBob29rICYmXHJcbiAgICAgICAgICAgIGNhbGxXaXRoQXN5bmNFcnJvckhhbmRsaW5nKGhvb2ssIGluc3RhbmNlLCA5IC8qIFRSQU5TSVRJT05fSE9PSyAqLywgYXJncyk7XHJcbiAgICB9O1xyXG4gICAgY29uc3QgaG9va3MgPSB7XHJcbiAgICAgICAgbW9kZSxcclxuICAgICAgICBwZXJzaXN0ZWQsXHJcbiAgICAgICAgYmVmb3JlRW50ZXIoZWwpIHtcclxuICAgICAgICAgICAgbGV0IGhvb2sgPSBvbkJlZm9yZUVudGVyO1xyXG4gICAgICAgICAgICBpZiAoIXN0YXRlLmlzTW91bnRlZCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGFwcGVhcikge1xyXG4gICAgICAgICAgICAgICAgICAgIGhvb2sgPSBvbkJlZm9yZUFwcGVhciB8fCBvbkJlZm9yZUVudGVyO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIGZvciBzYW1lIGVsZW1lbnQgKHYtc2hvdylcclxuICAgICAgICAgICAgaWYgKGVsLl9sZWF2ZUNiKSB7XHJcbiAgICAgICAgICAgICAgICBlbC5fbGVhdmVDYih0cnVlIC8qIGNhbmNlbGxlZCAqLyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gZm9yIHRvZ2dsZWQgZWxlbWVudCB3aXRoIHNhbWUga2V5ICh2LWlmKVxyXG4gICAgICAgICAgICBjb25zdCBsZWF2aW5nVk5vZGUgPSBsZWF2aW5nVk5vZGVzQ2FjaGVba2V5XTtcclxuICAgICAgICAgICAgaWYgKGxlYXZpbmdWTm9kZSAmJlxyXG4gICAgICAgICAgICAgICAgaXNTYW1lVk5vZGVUeXBlKHZub2RlLCBsZWF2aW5nVk5vZGUpICYmXHJcbiAgICAgICAgICAgICAgICBsZWF2aW5nVk5vZGUuZWwuX2xlYXZlQ2IpIHtcclxuICAgICAgICAgICAgICAgIC8vIGZvcmNlIGVhcmx5IHJlbW92YWwgKG5vdCBjYW5jZWxsZWQpXHJcbiAgICAgICAgICAgICAgICBsZWF2aW5nVk5vZGUuZWwuX2xlYXZlQ2IoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYWxsSG9vayhob29rLCBbZWxdKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudGVyKGVsKSB7XHJcbiAgICAgICAgICAgIGxldCBob29rID0gb25FbnRlcjtcclxuICAgICAgICAgICAgbGV0IGFmdGVySG9vayA9IG9uQWZ0ZXJFbnRlcjtcclxuICAgICAgICAgICAgbGV0IGNhbmNlbEhvb2sgPSBvbkVudGVyQ2FuY2VsbGVkO1xyXG4gICAgICAgICAgICBpZiAoIXN0YXRlLmlzTW91bnRlZCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGFwcGVhcikge1xyXG4gICAgICAgICAgICAgICAgICAgIGhvb2sgPSBvbkFwcGVhciB8fCBvbkVudGVyO1xyXG4gICAgICAgICAgICAgICAgICAgIGFmdGVySG9vayA9IG9uQWZ0ZXJBcHBlYXIgfHwgb25BZnRlckVudGVyO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbmNlbEhvb2sgPSBvbkFwcGVhckNhbmNlbGxlZCB8fCBvbkVudGVyQ2FuY2VsbGVkO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGxldCBjYWxsZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgY29uc3QgZG9uZSA9IChlbC5fZW50ZXJDYiA9IChjYW5jZWxsZWQpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChjYWxsZWQpXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgY2FsbGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGlmIChjYW5jZWxsZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYWxsSG9vayhjYW5jZWxIb29rLCBbZWxdKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxIb29rKGFmdGVySG9vaywgW2VsXSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoaG9va3MuZGVsYXllZExlYXZlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaG9va3MuZGVsYXllZExlYXZlKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbC5fZW50ZXJDYiA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGlmIChob29rKSB7XHJcbiAgICAgICAgICAgICAgICBob29rKGVsLCBkb25lKTtcclxuICAgICAgICAgICAgICAgIGlmIChob29rLmxlbmd0aCA8PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZG9uZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZG9uZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBsZWF2ZShlbCwgcmVtb3ZlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGtleSA9IFN0cmluZyh2bm9kZS5rZXkpO1xyXG4gICAgICAgICAgICBpZiAoZWwuX2VudGVyQ2IpIHtcclxuICAgICAgICAgICAgICAgIGVsLl9lbnRlckNiKHRydWUgLyogY2FuY2VsbGVkICovKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoc3RhdGUuaXNVbm1vdW50aW5nKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVtb3ZlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2FsbEhvb2sob25CZWZvcmVMZWF2ZSwgW2VsXSk7XHJcbiAgICAgICAgICAgIGxldCBjYWxsZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgY29uc3QgZG9uZSA9IChlbC5fbGVhdmVDYiA9IChjYW5jZWxsZWQpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChjYWxsZWQpXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgY2FsbGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGNhbmNlbGxlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxIb29rKG9uTGVhdmVDYW5jZWxsZWQsIFtlbF0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FsbEhvb2sob25BZnRlckxlYXZlLCBbZWxdKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsLl9sZWF2ZUNiID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgaWYgKGxlYXZpbmdWTm9kZXNDYWNoZVtrZXldID09PSB2bm9kZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBsZWF2aW5nVk5vZGVzQ2FjaGVba2V5XTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGxlYXZpbmdWTm9kZXNDYWNoZVtrZXldID0gdm5vZGU7XHJcbiAgICAgICAgICAgIGlmIChvbkxlYXZlKSB7XHJcbiAgICAgICAgICAgICAgICBvbkxlYXZlKGVsLCBkb25lKTtcclxuICAgICAgICAgICAgICAgIGlmIChvbkxlYXZlLmxlbmd0aCA8PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZG9uZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZG9uZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBjbG9uZSh2bm9kZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzb2x2ZVRyYW5zaXRpb25Ib29rcyh2bm9kZSwgcHJvcHMsIHN0YXRlLCBpbnN0YW5jZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBob29rcztcclxufVxyXG4vLyB0aGUgcGxhY2Vob2xkZXIgcmVhbGx5IG9ubHkgaGFuZGxlcyBvbmUgc3BlY2lhbCBjYXNlOiBLZWVwQWxpdmVcclxuLy8gaW4gdGhlIGNhc2Ugb2YgYSBLZWVwQWxpdmUgaW4gYSBsZWF2ZSBwaGFzZSB3ZSBuZWVkIHRvIHJldHVybiBhIEtlZXBBbGl2ZVxyXG4vLyBwbGFjZWhvbGRlciB3aXRoIGVtcHR5IGNvbnRlbnQgdG8gYXZvaWQgdGhlIEtlZXBBbGl2ZSBpbnN0YW5jZSBmcm9tIGJlaW5nXHJcbi8vIHVubW91bnRlZC5cclxuZnVuY3Rpb24gZW1wdHlQbGFjZWhvbGRlcih2bm9kZSkge1xyXG4gICAgaWYgKGlzS2VlcEFsaXZlKHZub2RlKSkge1xyXG4gICAgICAgIHZub2RlID0gY2xvbmVWTm9kZSh2bm9kZSk7XHJcbiAgICAgICAgdm5vZGUuY2hpbGRyZW4gPSBudWxsO1xyXG4gICAgICAgIHJldHVybiB2bm9kZTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBnZXRLZWVwQWxpdmVDaGlsZCh2bm9kZSkge1xyXG4gICAgcmV0dXJuIGlzS2VlcEFsaXZlKHZub2RlKVxyXG4gICAgICAgID8gdm5vZGUuY2hpbGRyZW5cclxuICAgICAgICAgICAgPyB2bm9kZS5jaGlsZHJlblswXVxyXG4gICAgICAgICAgICA6IHVuZGVmaW5lZFxyXG4gICAgICAgIDogdm5vZGU7XHJcbn1cclxuZnVuY3Rpb24gc2V0VHJhbnNpdGlvbkhvb2tzKHZub2RlLCBob29rcykge1xyXG4gICAgaWYgKHZub2RlLnNoYXBlRmxhZyAmIDYgLyogQ09NUE9ORU5UICovICYmIHZub2RlLmNvbXBvbmVudCkge1xyXG4gICAgICAgIHNldFRyYW5zaXRpb25Ib29rcyh2bm9kZS5jb21wb25lbnQuc3ViVHJlZSwgaG9va3MpO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAodm5vZGUuc2hhcGVGbGFnICYgMTI4IC8qIFNVU1BFTlNFICovKSB7XHJcbiAgICAgICAgdm5vZGUuc3NDb250ZW50LnRyYW5zaXRpb24gPSBob29rcy5jbG9uZSh2bm9kZS5zc0NvbnRlbnQpO1xyXG4gICAgICAgIHZub2RlLnNzRmFsbGJhY2sudHJhbnNpdGlvbiA9IGhvb2tzLmNsb25lKHZub2RlLnNzRmFsbGJhY2spO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgdm5vZGUudHJhbnNpdGlvbiA9IGhvb2tzO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGdldFRyYW5zaXRpb25SYXdDaGlsZHJlbihjaGlsZHJlbiwga2VlcENvbW1lbnQgPSBmYWxzZSkge1xyXG4gICAgbGV0IHJldCA9IFtdO1xyXG4gICAgbGV0IGtleWVkRnJhZ21lbnRDb3VudCA9IDA7XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgY29uc3QgY2hpbGQgPSBjaGlsZHJlbltpXTtcclxuICAgICAgICAvLyBoYW5kbGUgZnJhZ21lbnQgY2hpbGRyZW4gY2FzZSwgZS5nLiB2LWZvclxyXG4gICAgICAgIGlmIChjaGlsZC50eXBlID09PSBGcmFnbWVudCkge1xyXG4gICAgICAgICAgICBpZiAoY2hpbGQucGF0Y2hGbGFnICYgMTI4IC8qIEtFWUVEX0ZSQUdNRU5UICovKVxyXG4gICAgICAgICAgICAgICAga2V5ZWRGcmFnbWVudENvdW50Kys7XHJcbiAgICAgICAgICAgIHJldCA9IHJldC5jb25jYXQoZ2V0VHJhbnNpdGlvblJhd0NoaWxkcmVuKGNoaWxkLmNoaWxkcmVuLCBrZWVwQ29tbWVudCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBjb21tZW50IHBsYWNlaG9sZGVycyBzaG91bGQgYmUgc2tpcHBlZCwgZS5nLiB2LWlmXHJcbiAgICAgICAgZWxzZSBpZiAoa2VlcENvbW1lbnQgfHwgY2hpbGQudHlwZSAhPT0gQ29tbWVudCkge1xyXG4gICAgICAgICAgICByZXQucHVzaChjaGlsZCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8gIzExMjYgaWYgYSB0cmFuc2l0aW9uIGNoaWxkcmVuIGxpc3QgY29udGFpbnMgbXVsdGlwbGUgc3ViIGZyYWdtZW50cywgdGhlc2VcclxuICAgIC8vIGZyYWdtZW50cyB3aWxsIGJlIG1lcmdlZCBpbnRvIGEgZmxhdCBjaGlsZHJlbiBhcnJheS4gU2luY2UgZWFjaCB2LWZvclxyXG4gICAgLy8gZnJhZ21lbnQgbWF5IGNvbnRhaW4gZGlmZmVyZW50IHN0YXRpYyBiaW5kaW5ncyBpbnNpZGUsIHdlIG5lZWQgdG8gZGUtb3BcclxuICAgIC8vIHRoZXNlIGNoaWxkcmVuIHRvIGZvcmNlIGZ1bGwgZGlmZnMgdG8gZW5zdXJlIGNvcnJlY3QgYmVoYXZpb3IuXHJcbiAgICBpZiAoa2V5ZWRGcmFnbWVudENvdW50ID4gMSkge1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmV0Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHJldFtpXS5wYXRjaEZsYWcgPSAtMiAvKiBCQUlMICovO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiByZXQ7XHJcbn1cblxuLy8gaW1wbGVtZW50YXRpb24sIGNsb3NlIHRvIG5vLW9wXHJcbmZ1bmN0aW9uIGRlZmluZUNvbXBvbmVudChvcHRpb25zKSB7XHJcbiAgICByZXR1cm4gaXNGdW5jdGlvbihvcHRpb25zKSA/IHsgc2V0dXA6IG9wdGlvbnMsIG5hbWU6IG9wdGlvbnMubmFtZSB9IDogb3B0aW9ucztcclxufVxuXG5jb25zdCBpc0FzeW5jV3JhcHBlciA9IChpKSA9PiAhIWkudHlwZS5fX2FzeW5jTG9hZGVyO1xyXG5mdW5jdGlvbiBkZWZpbmVBc3luY0NvbXBvbmVudChzb3VyY2UpIHtcclxuICAgIGlmIChpc0Z1bmN0aW9uKHNvdXJjZSkpIHtcclxuICAgICAgICBzb3VyY2UgPSB7IGxvYWRlcjogc291cmNlIH07XHJcbiAgICB9XHJcbiAgICBjb25zdCB7IGxvYWRlciwgbG9hZGluZ0NvbXBvbmVudCwgZXJyb3JDb21wb25lbnQsIGRlbGF5ID0gMjAwLCB0aW1lb3V0LCAvLyB1bmRlZmluZWQgPSBuZXZlciB0aW1lcyBvdXRcclxuICAgIHN1c3BlbnNpYmxlID0gdHJ1ZSwgb25FcnJvcjogdXNlck9uRXJyb3IgfSA9IHNvdXJjZTtcclxuICAgIGxldCBwZW5kaW5nUmVxdWVzdCA9IG51bGw7XHJcbiAgICBsZXQgcmVzb2x2ZWRDb21wO1xyXG4gICAgbGV0IHJldHJpZXMgPSAwO1xyXG4gICAgY29uc3QgcmV0cnkgPSAoKSA9PiB7XHJcbiAgICAgICAgcmV0cmllcysrO1xyXG4gICAgICAgIHBlbmRpbmdSZXF1ZXN0ID0gbnVsbDtcclxuICAgICAgICByZXR1cm4gbG9hZCgpO1xyXG4gICAgfTtcclxuICAgIGNvbnN0IGxvYWQgPSAoKSA9PiB7XHJcbiAgICAgICAgbGV0IHRoaXNSZXF1ZXN0O1xyXG4gICAgICAgIHJldHVybiAocGVuZGluZ1JlcXVlc3QgfHxcclxuICAgICAgICAgICAgKHRoaXNSZXF1ZXN0ID0gcGVuZGluZ1JlcXVlc3QgPVxyXG4gICAgICAgICAgICAgICAgbG9hZGVyKClcclxuICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZXJyID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBlcnIgPSBlcnIgaW5zdGFuY2VvZiBFcnJvciA/IGVyciA6IG5ldyBFcnJvcihTdHJpbmcoZXJyKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHVzZXJPbkVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB1c2VyUmV0cnkgPSAoKSA9PiByZXNvbHZlKHJldHJ5KCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdXNlckZhaWwgPSAoKSA9PiByZWplY3QoZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJPbkVycm9yKGVyciwgdXNlclJldHJ5LCB1c2VyRmFpbCwgcmV0cmllcyArIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IGVycjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKChjb21wKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXNSZXF1ZXN0ICE9PSBwZW5kaW5nUmVxdWVzdCAmJiBwZW5kaW5nUmVxdWVzdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGVuZGluZ1JlcXVlc3Q7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiYgIWNvbXApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2FybihgQXN5bmMgY29tcG9uZW50IGxvYWRlciByZXNvbHZlZCB0byB1bmRlZmluZWQuIGAgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYElmIHlvdSBhcmUgdXNpbmcgcmV0cnkoKSwgbWFrZSBzdXJlIHRvIHJldHVybiBpdHMgcmV0dXJuIHZhbHVlLmApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAvLyBpbnRlcm9wIG1vZHVsZSBkZWZhdWx0XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbXAgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgKGNvbXAuX19lc01vZHVsZSB8fCBjb21wW1N5bWJvbC50b1N0cmluZ1RhZ10gPT09ICdNb2R1bGUnKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb21wID0gY29tcC5kZWZhdWx0O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmIGNvbXAgJiYgIWlzT2JqZWN0KGNvbXApICYmICFpc0Z1bmN0aW9uKGNvbXApKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBhc3luYyBjb21wb25lbnQgbG9hZCByZXN1bHQ6ICR7Y29tcH1gKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZWRDb21wID0gY29tcDtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29tcDtcclxuICAgICAgICAgICAgICAgIH0pKSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIGRlZmluZUNvbXBvbmVudCh7XHJcbiAgICAgICAgbmFtZTogJ0FzeW5jQ29tcG9uZW50V3JhcHBlcicsXHJcbiAgICAgICAgX19hc3luY0xvYWRlcjogbG9hZCxcclxuICAgICAgICBnZXQgX19hc3luY1Jlc29sdmVkKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzb2x2ZWRDb21wO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2V0dXAoKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGluc3RhbmNlID0gY3VycmVudEluc3RhbmNlO1xyXG4gICAgICAgICAgICAvLyBhbHJlYWR5IHJlc29sdmVkXHJcbiAgICAgICAgICAgIGlmIChyZXNvbHZlZENvbXApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAoKSA9PiBjcmVhdGVJbm5lckNvbXAocmVzb2x2ZWRDb21wLCBpbnN0YW5jZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3Qgb25FcnJvciA9IChlcnIpID0+IHtcclxuICAgICAgICAgICAgICAgIHBlbmRpbmdSZXF1ZXN0ID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGhhbmRsZUVycm9yKGVyciwgaW5zdGFuY2UsIDEzIC8qIEFTWU5DX0NPTVBPTkVOVF9MT0FERVIgKi8sICFlcnJvckNvbXBvbmVudCAvKiBkbyBub3QgdGhyb3cgaW4gZGV2IGlmIHVzZXIgcHJvdmlkZWQgZXJyb3IgY29tcG9uZW50ICovKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgLy8gc3VzcGVuc2UtY29udHJvbGxlZCBvciBTU1IuXHJcbiAgICAgICAgICAgIGlmICgoc3VzcGVuc2libGUgJiYgaW5zdGFuY2Uuc3VzcGVuc2UpIHx8XHJcbiAgICAgICAgICAgICAgICAoaXNJblNTUkNvbXBvbmVudFNldHVwKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGxvYWQoKVxyXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGNvbXAgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoKSA9PiBjcmVhdGVJbm5lckNvbXAoY29tcCwgaW5zdGFuY2UpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZXJyID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBvbkVycm9yKGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICgpID0+IGVycm9yQ29tcG9uZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgID8gY3JlYXRlVk5vZGUoZXJyb3JDb21wb25lbnQsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiBlcnJcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgOiBudWxsO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgbG9hZGVkID0gcmVmKGZhbHNlKTtcclxuICAgICAgICAgICAgY29uc3QgZXJyb3IgPSByZWYoKTtcclxuICAgICAgICAgICAgY29uc3QgZGVsYXllZCA9IHJlZighIWRlbGF5KTtcclxuICAgICAgICAgICAgaWYgKGRlbGF5KSB7XHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBkZWxheWVkLnZhbHVlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9LCBkZWxheSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRpbWVvdXQgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFsb2FkZWQudmFsdWUgJiYgIWVycm9yLnZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVyciA9IG5ldyBFcnJvcihgQXN5bmMgY29tcG9uZW50IHRpbWVkIG91dCBhZnRlciAke3RpbWVvdXR9bXMuYCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uRXJyb3IoZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IudmFsdWUgPSBlcnI7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSwgdGltZW91dCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbG9hZCgpXHJcbiAgICAgICAgICAgICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBsb2FkZWQudmFsdWUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgaWYgKGluc3RhbmNlLnBhcmVudCAmJiBpc0tlZXBBbGl2ZShpbnN0YW5jZS5wYXJlbnQudm5vZGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gcGFyZW50IGlzIGtlZXAtYWxpdmUsIGZvcmNlIHVwZGF0ZSBzbyB0aGUgbG9hZGVkIGNvbXBvbmVudCdzXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gbmFtZSBpcyB0YWtlbiBpbnRvIGFjY291bnRcclxuICAgICAgICAgICAgICAgICAgICBxdWV1ZUpvYihpbnN0YW5jZS5wYXJlbnQudXBkYXRlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5jYXRjaChlcnIgPT4ge1xyXG4gICAgICAgICAgICAgICAgb25FcnJvcihlcnIpO1xyXG4gICAgICAgICAgICAgICAgZXJyb3IudmFsdWUgPSBlcnI7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGxvYWRlZC52YWx1ZSAmJiByZXNvbHZlZENvbXApIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY3JlYXRlSW5uZXJDb21wKHJlc29sdmVkQ29tcCwgaW5zdGFuY2UpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoZXJyb3IudmFsdWUgJiYgZXJyb3JDb21wb25lbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY3JlYXRlVk5vZGUoZXJyb3JDb21wb25lbnQsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yLnZhbHVlXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChsb2FkaW5nQ29tcG9uZW50ICYmICFkZWxheWVkLnZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNyZWF0ZVZOb2RlKGxvYWRpbmdDb21wb25lbnQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59XHJcbmZ1bmN0aW9uIGNyZWF0ZUlubmVyQ29tcChjb21wLCB7IHZub2RlOiB7IHJlZiwgcHJvcHMsIGNoaWxkcmVuIH0gfSkge1xyXG4gICAgY29uc3Qgdm5vZGUgPSBjcmVhdGVWTm9kZShjb21wLCBwcm9wcywgY2hpbGRyZW4pO1xyXG4gICAgLy8gZW5zdXJlIGlubmVyIGNvbXBvbmVudCBpbmhlcml0cyB0aGUgYXN5bmMgd3JhcHBlcidzIHJlZiBvd25lclxyXG4gICAgdm5vZGUucmVmID0gcmVmO1xyXG4gICAgcmV0dXJuIHZub2RlO1xyXG59XG5cbmNvbnN0IGlzS2VlcEFsaXZlID0gKHZub2RlKSA9PiB2bm9kZS50eXBlLl9faXNLZWVwQWxpdmU7XHJcbmNvbnN0IEtlZXBBbGl2ZUltcGwgPSB7XHJcbiAgICBuYW1lOiBgS2VlcEFsaXZlYCxcclxuICAgIC8vIE1hcmtlciBmb3Igc3BlY2lhbCBoYW5kbGluZyBpbnNpZGUgdGhlIHJlbmRlcmVyLiBXZSBhcmUgbm90IHVzaW5nIGEgPT09XHJcbiAgICAvLyBjaGVjayBkaXJlY3RseSBvbiBLZWVwQWxpdmUgaW4gdGhlIHJlbmRlcmVyLCBiZWNhdXNlIGltcG9ydGluZyBpdCBkaXJlY3RseVxyXG4gICAgLy8gd291bGQgcHJldmVudCBpdCBmcm9tIGJlaW5nIHRyZWUtc2hha2VuLlxyXG4gICAgX19pc0tlZXBBbGl2ZTogdHJ1ZSxcclxuICAgIHByb3BzOiB7XHJcbiAgICAgICAgaW5jbHVkZTogW1N0cmluZywgUmVnRXhwLCBBcnJheV0sXHJcbiAgICAgICAgZXhjbHVkZTogW1N0cmluZywgUmVnRXhwLCBBcnJheV0sXHJcbiAgICAgICAgbWF4OiBbU3RyaW5nLCBOdW1iZXJdXHJcbiAgICB9LFxyXG4gICAgc2V0dXAocHJvcHMsIHsgc2xvdHMgfSkge1xyXG4gICAgICAgIGNvbnN0IGluc3RhbmNlID0gZ2V0Q3VycmVudEluc3RhbmNlKCk7XHJcbiAgICAgICAgLy8gS2VlcEFsaXZlIGNvbW11bmljYXRlcyB3aXRoIHRoZSBpbnN0YW50aWF0ZWQgcmVuZGVyZXIgdmlhIHRoZVxyXG4gICAgICAgIC8vIGN0eCB3aGVyZSB0aGUgcmVuZGVyZXIgcGFzc2VzIGluIGl0cyBpbnRlcm5hbHMsXHJcbiAgICAgICAgLy8gYW5kIHRoZSBLZWVwQWxpdmUgaW5zdGFuY2UgZXhwb3NlcyBhY3RpdmF0ZS9kZWFjdGl2YXRlIGltcGxlbWVudGF0aW9ucy5cclxuICAgICAgICAvLyBUaGUgd2hvbGUgcG9pbnQgb2YgdGhpcyBpcyB0byBhdm9pZCBpbXBvcnRpbmcgS2VlcEFsaXZlIGRpcmVjdGx5IGluIHRoZVxyXG4gICAgICAgIC8vIHJlbmRlcmVyIHRvIGZhY2lsaXRhdGUgdHJlZS1zaGFraW5nLlxyXG4gICAgICAgIGNvbnN0IHNoYXJlZENvbnRleHQgPSBpbnN0YW5jZS5jdHg7XHJcbiAgICAgICAgLy8gaWYgdGhlIGludGVybmFsIHJlbmRlcmVyIGlzIG5vdCByZWdpc3RlcmVkLCBpdCBpbmRpY2F0ZXMgdGhhdCB0aGlzIGlzIHNlcnZlci1zaWRlIHJlbmRlcmluZyxcclxuICAgICAgICAvLyBmb3IgS2VlcEFsaXZlLCB3ZSBqdXN0IG5lZWQgdG8gcmVuZGVyIGl0cyBjaGlsZHJlblxyXG4gICAgICAgIGlmICghc2hhcmVkQ29udGV4dC5yZW5kZXJlcikge1xyXG4gICAgICAgICAgICByZXR1cm4gc2xvdHMuZGVmYXVsdDtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgY2FjaGUgPSBuZXcgTWFwKCk7XHJcbiAgICAgICAgY29uc3Qga2V5cyA9IG5ldyBTZXQoKTtcclxuICAgICAgICBsZXQgY3VycmVudCA9IG51bGw7XHJcbiAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB8fCBfX1ZVRV9QUk9EX0RFVlRPT0xTX18pIHtcclxuICAgICAgICAgICAgaW5zdGFuY2UuX192X2NhY2hlID0gY2FjaGU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHBhcmVudFN1c3BlbnNlID0gaW5zdGFuY2Uuc3VzcGVuc2U7XHJcbiAgICAgICAgY29uc3QgeyByZW5kZXJlcjogeyBwOiBwYXRjaCwgbTogbW92ZSwgdW06IF91bm1vdW50LCBvOiB7IGNyZWF0ZUVsZW1lbnQgfSB9IH0gPSBzaGFyZWRDb250ZXh0O1xyXG4gICAgICAgIGNvbnN0IHN0b3JhZ2VDb250YWluZXIgPSBjcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICBzaGFyZWRDb250ZXh0LmFjdGl2YXRlID0gKHZub2RlLCBjb250YWluZXIsIGFuY2hvciwgaXNTVkcsIG9wdGltaXplZCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBpbnN0YW5jZSA9IHZub2RlLmNvbXBvbmVudDtcclxuICAgICAgICAgICAgbW92ZSh2bm9kZSwgY29udGFpbmVyLCBhbmNob3IsIDAgLyogRU5URVIgKi8sIHBhcmVudFN1c3BlbnNlKTtcclxuICAgICAgICAgICAgLy8gaW4gY2FzZSBwcm9wcyBoYXZlIGNoYW5nZWRcclxuICAgICAgICAgICAgcGF0Y2goaW5zdGFuY2Uudm5vZGUsIHZub2RlLCBjb250YWluZXIsIGFuY2hvciwgaW5zdGFuY2UsIHBhcmVudFN1c3BlbnNlLCBpc1NWRywgdm5vZGUuc2xvdFNjb3BlSWRzLCBvcHRpbWl6ZWQpO1xyXG4gICAgICAgICAgICBxdWV1ZVBvc3RSZW5kZXJFZmZlY3QoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaW5zdGFuY2UuaXNEZWFjdGl2YXRlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgaWYgKGluc3RhbmNlLmEpIHtcclxuICAgICAgICAgICAgICAgICAgICBpbnZva2VBcnJheUZucyhpbnN0YW5jZS5hKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IHZub2RlSG9vayA9IHZub2RlLnByb3BzICYmIHZub2RlLnByb3BzLm9uVm5vZGVNb3VudGVkO1xyXG4gICAgICAgICAgICAgICAgaWYgKHZub2RlSG9vaykge1xyXG4gICAgICAgICAgICAgICAgICAgIGludm9rZVZOb2RlSG9vayh2bm9kZUhvb2ssIGluc3RhbmNlLnBhcmVudCwgdm5vZGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCBwYXJlbnRTdXNwZW5zZSk7XHJcbiAgICAgICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgfHwgX19WVUVfUFJPRF9ERVZUT09MU19fKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgY29tcG9uZW50cyB0cmVlXHJcbiAgICAgICAgICAgICAgICBkZXZ0b29sc0NvbXBvbmVudEFkZGVkKGluc3RhbmNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgc2hhcmVkQ29udGV4dC5kZWFjdGl2YXRlID0gKHZub2RlKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGluc3RhbmNlID0gdm5vZGUuY29tcG9uZW50O1xyXG4gICAgICAgICAgICBtb3ZlKHZub2RlLCBzdG9yYWdlQ29udGFpbmVyLCBudWxsLCAxIC8qIExFQVZFICovLCBwYXJlbnRTdXNwZW5zZSk7XHJcbiAgICAgICAgICAgIHF1ZXVlUG9zdFJlbmRlckVmZmVjdCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaW5zdGFuY2UuZGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBpbnZva2VBcnJheUZucyhpbnN0YW5jZS5kYSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCB2bm9kZUhvb2sgPSB2bm9kZS5wcm9wcyAmJiB2bm9kZS5wcm9wcy5vblZub2RlVW5tb3VudGVkO1xyXG4gICAgICAgICAgICAgICAgaWYgKHZub2RlSG9vaykge1xyXG4gICAgICAgICAgICAgICAgICAgIGludm9rZVZOb2RlSG9vayh2bm9kZUhvb2ssIGluc3RhbmNlLnBhcmVudCwgdm5vZGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaW5zdGFuY2UuaXNEZWFjdGl2YXRlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIH0sIHBhcmVudFN1c3BlbnNlKTtcclxuICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB8fCBfX1ZVRV9QUk9EX0RFVlRPT0xTX18pIHtcclxuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBjb21wb25lbnRzIHRyZWVcclxuICAgICAgICAgICAgICAgIGRldnRvb2xzQ29tcG9uZW50QWRkZWQoaW5zdGFuY2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICBmdW5jdGlvbiB1bm1vdW50KHZub2RlKSB7XHJcbiAgICAgICAgICAgIC8vIHJlc2V0IHRoZSBzaGFwZUZsYWcgc28gaXQgY2FuIGJlIHByb3Blcmx5IHVubW91bnRlZFxyXG4gICAgICAgICAgICByZXNldFNoYXBlRmxhZyh2bm9kZSk7XHJcbiAgICAgICAgICAgIF91bm1vdW50KHZub2RlLCBpbnN0YW5jZSwgcGFyZW50U3VzcGVuc2UsIHRydWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBwcnVuZUNhY2hlKGZpbHRlcikge1xyXG4gICAgICAgICAgICBjYWNoZS5mb3JFYWNoKCh2bm9kZSwga2V5KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuYW1lID0gZ2V0Q29tcG9uZW50TmFtZSh2bm9kZS50eXBlKTtcclxuICAgICAgICAgICAgICAgIGlmIChuYW1lICYmICghZmlsdGVyIHx8ICFmaWx0ZXIobmFtZSkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJ1bmVDYWNoZUVudHJ5KGtleSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBwcnVuZUNhY2hlRW50cnkoa2V5KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNhY2hlZCA9IGNhY2hlLmdldChrZXkpO1xyXG4gICAgICAgICAgICBpZiAoIWN1cnJlbnQgfHwgY2FjaGVkLnR5cGUgIT09IGN1cnJlbnQudHlwZSkge1xyXG4gICAgICAgICAgICAgICAgdW5tb3VudChjYWNoZWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGN1cnJlbnQpIHtcclxuICAgICAgICAgICAgICAgIC8vIGN1cnJlbnQgYWN0aXZlIGluc3RhbmNlIHNob3VsZCBubyBsb25nZXIgYmUga2VwdC1hbGl2ZS5cclxuICAgICAgICAgICAgICAgIC8vIHdlIGNhbid0IHVubW91bnQgaXQgbm93IGJ1dCBpdCBtaWdodCBiZSBsYXRlciwgc28gcmVzZXQgaXRzIGZsYWcgbm93LlxyXG4gICAgICAgICAgICAgICAgcmVzZXRTaGFwZUZsYWcoY3VycmVudCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2FjaGUuZGVsZXRlKGtleSk7XHJcbiAgICAgICAgICAgIGtleXMuZGVsZXRlKGtleSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIHBydW5lIGNhY2hlIG9uIGluY2x1ZGUvZXhjbHVkZSBwcm9wIGNoYW5nZVxyXG4gICAgICAgIHdhdGNoKCgpID0+IFtwcm9wcy5pbmNsdWRlLCBwcm9wcy5leGNsdWRlXSwgKFtpbmNsdWRlLCBleGNsdWRlXSkgPT4ge1xyXG4gICAgICAgICAgICBpbmNsdWRlICYmIHBydW5lQ2FjaGUobmFtZSA9PiBtYXRjaGVzKGluY2x1ZGUsIG5hbWUpKTtcclxuICAgICAgICAgICAgZXhjbHVkZSAmJiBwcnVuZUNhY2hlKG5hbWUgPT4gIW1hdGNoZXMoZXhjbHVkZSwgbmFtZSkpO1xyXG4gICAgICAgIH0sIFxyXG4gICAgICAgIC8vIHBydW5lIHBvc3QtcmVuZGVyIGFmdGVyIGBjdXJyZW50YCBoYXMgYmVlbiB1cGRhdGVkXHJcbiAgICAgICAgeyBmbHVzaDogJ3Bvc3QnLCBkZWVwOiB0cnVlIH0pO1xyXG4gICAgICAgIC8vIGNhY2hlIHN1YiB0cmVlIGFmdGVyIHJlbmRlclxyXG4gICAgICAgIGxldCBwZW5kaW5nQ2FjaGVLZXkgPSBudWxsO1xyXG4gICAgICAgIGNvbnN0IGNhY2hlU3VidHJlZSA9ICgpID0+IHtcclxuICAgICAgICAgICAgLy8gZml4ICMxNjIxLCB0aGUgcGVuZGluZ0NhY2hlS2V5IGNvdWxkIGJlIDBcclxuICAgICAgICAgICAgaWYgKHBlbmRpbmdDYWNoZUtleSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBjYWNoZS5zZXQocGVuZGluZ0NhY2hlS2V5LCBnZXRJbm5lckNoaWxkKGluc3RhbmNlLnN1YlRyZWUpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgb25Nb3VudGVkKGNhY2hlU3VidHJlZSk7XHJcbiAgICAgICAgb25VcGRhdGVkKGNhY2hlU3VidHJlZSk7XHJcbiAgICAgICAgb25CZWZvcmVVbm1vdW50KCgpID0+IHtcclxuICAgICAgICAgICAgY2FjaGUuZm9yRWFjaChjYWNoZWQgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgeyBzdWJUcmVlLCBzdXNwZW5zZSB9ID0gaW5zdGFuY2U7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB2bm9kZSA9IGdldElubmVyQ2hpbGQoc3ViVHJlZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2FjaGVkLnR5cGUgPT09IHZub2RlLnR5cGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBjdXJyZW50IGluc3RhbmNlIHdpbGwgYmUgdW5tb3VudGVkIGFzIHBhcnQgb2Yga2VlcC1hbGl2ZSdzIHVubW91bnRcclxuICAgICAgICAgICAgICAgICAgICByZXNldFNoYXBlRmxhZyh2bm9kZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gYnV0IGludm9rZSBpdHMgZGVhY3RpdmF0ZWQgaG9vayBoZXJlXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGEgPSB2bm9kZS5jb21wb25lbnQuZGE7XHJcbiAgICAgICAgICAgICAgICAgICAgZGEgJiYgcXVldWVQb3N0UmVuZGVyRWZmZWN0KGRhLCBzdXNwZW5zZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdW5tb3VudChjYWNoZWQpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gKCkgPT4ge1xyXG4gICAgICAgICAgICBwZW5kaW5nQ2FjaGVLZXkgPSBudWxsO1xyXG4gICAgICAgICAgICBpZiAoIXNsb3RzLmRlZmF1bHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IGNoaWxkcmVuID0gc2xvdHMuZGVmYXVsdCgpO1xyXG4gICAgICAgICAgICBjb25zdCByYXdWTm9kZSA9IGNoaWxkcmVuWzBdO1xyXG4gICAgICAgICAgICBpZiAoY2hpbGRyZW4ubGVuZ3RoID4gMSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHdhcm4oYEtlZXBBbGl2ZSBzaG91bGQgY29udGFpbiBleGFjdGx5IG9uZSBjb21wb25lbnQgY2hpbGQuYCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjdXJyZW50ID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjaGlsZHJlbjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmICghaXNWTm9kZShyYXdWTm9kZSkgfHxcclxuICAgICAgICAgICAgICAgICghKHJhd1ZOb2RlLnNoYXBlRmxhZyAmIDQgLyogU1RBVEVGVUxfQ09NUE9ORU5UICovKSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICEocmF3Vk5vZGUuc2hhcGVGbGFnICYgMTI4IC8qIFNVU1BFTlNFICovKSkpIHtcclxuICAgICAgICAgICAgICAgIGN1cnJlbnQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJhd1ZOb2RlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGxldCB2bm9kZSA9IGdldElubmVyQ2hpbGQocmF3Vk5vZGUpO1xyXG4gICAgICAgICAgICBjb25zdCBjb21wID0gdm5vZGUudHlwZTtcclxuICAgICAgICAgICAgLy8gZm9yIGFzeW5jIGNvbXBvbmVudHMsIG5hbWUgY2hlY2sgc2hvdWxkIGJlIGJhc2VkIGluIGl0cyBsb2FkZWRcclxuICAgICAgICAgICAgLy8gaW5uZXIgY29tcG9uZW50IGlmIGF2YWlsYWJsZVxyXG4gICAgICAgICAgICBjb25zdCBuYW1lID0gZ2V0Q29tcG9uZW50TmFtZShpc0FzeW5jV3JhcHBlcih2bm9kZSlcclxuICAgICAgICAgICAgICAgID8gdm5vZGUudHlwZS5fX2FzeW5jUmVzb2x2ZWQgfHwge31cclxuICAgICAgICAgICAgICAgIDogY29tcCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHsgaW5jbHVkZSwgZXhjbHVkZSwgbWF4IH0gPSBwcm9wcztcclxuICAgICAgICAgICAgaWYgKChpbmNsdWRlICYmICghbmFtZSB8fCAhbWF0Y2hlcyhpbmNsdWRlLCBuYW1lKSkpIHx8XHJcbiAgICAgICAgICAgICAgICAoZXhjbHVkZSAmJiBuYW1lICYmIG1hdGNoZXMoZXhjbHVkZSwgbmFtZSkpKSB7XHJcbiAgICAgICAgICAgICAgICBjdXJyZW50ID0gdm5vZGU7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmF3Vk5vZGU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3Qga2V5ID0gdm5vZGUua2V5ID09IG51bGwgPyBjb21wIDogdm5vZGUua2V5O1xyXG4gICAgICAgICAgICBjb25zdCBjYWNoZWRWTm9kZSA9IGNhY2hlLmdldChrZXkpO1xyXG4gICAgICAgICAgICAvLyBjbG9uZSB2bm9kZSBpZiBpdCdzIHJldXNlZCBiZWNhdXNlIHdlIGFyZSBnb2luZyB0byBtdXRhdGUgaXRcclxuICAgICAgICAgICAgaWYgKHZub2RlLmVsKSB7XHJcbiAgICAgICAgICAgICAgICB2bm9kZSA9IGNsb25lVk5vZGUodm5vZGUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHJhd1ZOb2RlLnNoYXBlRmxhZyAmIDEyOCAvKiBTVVNQRU5TRSAqLykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJhd1ZOb2RlLnNzQ29udGVudCA9IHZub2RlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vICMxNTEzIGl0J3MgcG9zc2libGUgZm9yIHRoZSByZXR1cm5lZCB2bm9kZSB0byBiZSBjbG9uZWQgZHVlIHRvIGF0dHJcclxuICAgICAgICAgICAgLy8gZmFsbHRocm91Z2ggb3Igc2NvcGVJZCwgc28gdGhlIHZub2RlIGhlcmUgbWF5IG5vdCBiZSB0aGUgZmluYWwgdm5vZGVcclxuICAgICAgICAgICAgLy8gdGhhdCBpcyBtb3VudGVkLiBJbnN0ZWFkIG9mIGNhY2hpbmcgaXQgZGlyZWN0bHksIHdlIHN0b3JlIHRoZSBwZW5kaW5nXHJcbiAgICAgICAgICAgIC8vIGtleSBhbmQgY2FjaGUgYGluc3RhbmNlLnN1YlRyZWVgICh0aGUgbm9ybWFsaXplZCB2bm9kZSkgaW5cclxuICAgICAgICAgICAgLy8gYmVmb3JlTW91bnQvYmVmb3JlVXBkYXRlIGhvb2tzLlxyXG4gICAgICAgICAgICBwZW5kaW5nQ2FjaGVLZXkgPSBrZXk7XHJcbiAgICAgICAgICAgIGlmIChjYWNoZWRWTm9kZSkge1xyXG4gICAgICAgICAgICAgICAgLy8gY29weSBvdmVyIG1vdW50ZWQgc3RhdGVcclxuICAgICAgICAgICAgICAgIHZub2RlLmVsID0gY2FjaGVkVk5vZGUuZWw7XHJcbiAgICAgICAgICAgICAgICB2bm9kZS5jb21wb25lbnQgPSBjYWNoZWRWTm9kZS5jb21wb25lbnQ7XHJcbiAgICAgICAgICAgICAgICBpZiAodm5vZGUudHJhbnNpdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHJlY3Vyc2l2ZWx5IHVwZGF0ZSB0cmFuc2l0aW9uIGhvb2tzIG9uIHN1YlRyZWVcclxuICAgICAgICAgICAgICAgICAgICBzZXRUcmFuc2l0aW9uSG9va3Modm5vZGUsIHZub2RlLnRyYW5zaXRpb24pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gYXZvaWQgdm5vZGUgYmVpbmcgbW91bnRlZCBhcyBmcmVzaFxyXG4gICAgICAgICAgICAgICAgdm5vZGUuc2hhcGVGbGFnIHw9IDUxMiAvKiBDT01QT05FTlRfS0VQVF9BTElWRSAqLztcclxuICAgICAgICAgICAgICAgIC8vIG1ha2UgdGhpcyBrZXkgdGhlIGZyZXNoZXN0XHJcbiAgICAgICAgICAgICAgICBrZXlzLmRlbGV0ZShrZXkpO1xyXG4gICAgICAgICAgICAgICAga2V5cy5hZGQoa2V5KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGtleXMuYWRkKGtleSk7XHJcbiAgICAgICAgICAgICAgICAvLyBwcnVuZSBvbGRlc3QgZW50cnlcclxuICAgICAgICAgICAgICAgIGlmIChtYXggJiYga2V5cy5zaXplID4gcGFyc2VJbnQobWF4LCAxMCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBwcnVuZUNhY2hlRW50cnkoa2V5cy52YWx1ZXMoKS5uZXh0KCkudmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIGF2b2lkIHZub2RlIGJlaW5nIHVubW91bnRlZFxyXG4gICAgICAgICAgICB2bm9kZS5zaGFwZUZsYWcgfD0gMjU2IC8qIENPTVBPTkVOVF9TSE9VTERfS0VFUF9BTElWRSAqLztcclxuICAgICAgICAgICAgY3VycmVudCA9IHZub2RlO1xyXG4gICAgICAgICAgICByZXR1cm4gcmF3Vk5vZGU7XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxufTtcclxuLy8gZXhwb3J0IHRoZSBwdWJsaWMgdHlwZSBmb3IgaC90c3ggaW5mZXJlbmNlXHJcbi8vIGFsc28gdG8gYXZvaWQgaW5saW5lIGltcG9ydCgpIGluIGdlbmVyYXRlZCBkLnRzIGZpbGVzXHJcbmNvbnN0IEtlZXBBbGl2ZSA9IEtlZXBBbGl2ZUltcGw7XHJcbmZ1bmN0aW9uIG1hdGNoZXMocGF0dGVybiwgbmFtZSkge1xyXG4gICAgaWYgKGlzQXJyYXkocGF0dGVybikpIHtcclxuICAgICAgICByZXR1cm4gcGF0dGVybi5zb21lKChwKSA9PiBtYXRjaGVzKHAsIG5hbWUpKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGlzU3RyaW5nKHBhdHRlcm4pKSB7XHJcbiAgICAgICAgcmV0dXJuIHBhdHRlcm4uc3BsaXQoJywnKS5pbmNsdWRlcyhuYW1lKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKHBhdHRlcm4udGVzdCkge1xyXG4gICAgICAgIHJldHVybiBwYXR0ZXJuLnRlc3QobmFtZSk7XHJcbiAgICB9XHJcbiAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG59XHJcbmZ1bmN0aW9uIG9uQWN0aXZhdGVkKGhvb2ssIHRhcmdldCkge1xyXG4gICAgcmVnaXN0ZXJLZWVwQWxpdmVIb29rKGhvb2ssIFwiYVwiIC8qIEFDVElWQVRFRCAqLywgdGFyZ2V0KTtcclxufVxyXG5mdW5jdGlvbiBvbkRlYWN0aXZhdGVkKGhvb2ssIHRhcmdldCkge1xyXG4gICAgcmVnaXN0ZXJLZWVwQWxpdmVIb29rKGhvb2ssIFwiZGFcIiAvKiBERUFDVElWQVRFRCAqLywgdGFyZ2V0KTtcclxufVxyXG5mdW5jdGlvbiByZWdpc3RlcktlZXBBbGl2ZUhvb2soaG9vaywgdHlwZSwgdGFyZ2V0ID0gY3VycmVudEluc3RhbmNlKSB7XHJcbiAgICAvLyBjYWNoZSB0aGUgZGVhY3RpdmF0ZSBicmFuY2ggY2hlY2sgd3JhcHBlciBmb3IgaW5qZWN0ZWQgaG9va3Mgc28gdGhlIHNhbWVcclxuICAgIC8vIGhvb2sgY2FuIGJlIHByb3Blcmx5IGRlZHVwZWQgYnkgdGhlIHNjaGVkdWxlci4gXCJfX3dkY1wiIHN0YW5kcyBmb3IgXCJ3aXRoXHJcbiAgICAvLyBkZWFjdGl2YXRpb24gY2hlY2tcIi5cclxuICAgIGNvbnN0IHdyYXBwZWRIb29rID0gaG9vay5fX3dkYyB8fFxyXG4gICAgICAgIChob29rLl9fd2RjID0gKCkgPT4ge1xyXG4gICAgICAgICAgICAvLyBvbmx5IGZpcmUgdGhlIGhvb2sgaWYgdGhlIHRhcmdldCBpbnN0YW5jZSBpcyBOT1QgaW4gYSBkZWFjdGl2YXRlZCBicmFuY2guXHJcbiAgICAgICAgICAgIGxldCBjdXJyZW50ID0gdGFyZ2V0O1xyXG4gICAgICAgICAgICB3aGlsZSAoY3VycmVudCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnQuaXNEZWFjdGl2YXRlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGN1cnJlbnQgPSBjdXJyZW50LnBhcmVudDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gaG9vaygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgaW5qZWN0SG9vayh0eXBlLCB3cmFwcGVkSG9vaywgdGFyZ2V0KTtcclxuICAgIC8vIEluIGFkZGl0aW9uIHRvIHJlZ2lzdGVyaW5nIGl0IG9uIHRoZSB0YXJnZXQgaW5zdGFuY2UsIHdlIHdhbGsgdXAgdGhlIHBhcmVudFxyXG4gICAgLy8gY2hhaW4gYW5kIHJlZ2lzdGVyIGl0IG9uIGFsbCBhbmNlc3RvciBpbnN0YW5jZXMgdGhhdCBhcmUga2VlcC1hbGl2ZSByb290cy5cclxuICAgIC8vIFRoaXMgYXZvaWRzIHRoZSBuZWVkIHRvIHdhbGsgdGhlIGVudGlyZSBjb21wb25lbnQgdHJlZSB3aGVuIGludm9raW5nIHRoZXNlXHJcbiAgICAvLyBob29rcywgYW5kIG1vcmUgaW1wb3J0YW50bHksIGF2b2lkcyB0aGUgbmVlZCB0byB0cmFjayBjaGlsZCBjb21wb25lbnRzIGluXHJcbiAgICAvLyBhcnJheXMuXHJcbiAgICBpZiAodGFyZ2V0KSB7XHJcbiAgICAgICAgbGV0IGN1cnJlbnQgPSB0YXJnZXQucGFyZW50O1xyXG4gICAgICAgIHdoaWxlIChjdXJyZW50ICYmIGN1cnJlbnQucGFyZW50KSB7XHJcbiAgICAgICAgICAgIGlmIChpc0tlZXBBbGl2ZShjdXJyZW50LnBhcmVudC52bm9kZSkpIHtcclxuICAgICAgICAgICAgICAgIGluamVjdFRvS2VlcEFsaXZlUm9vdCh3cmFwcGVkSG9vaywgdHlwZSwgdGFyZ2V0LCBjdXJyZW50KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjdXJyZW50ID0gY3VycmVudC5wYXJlbnQ7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGluamVjdFRvS2VlcEFsaXZlUm9vdChob29rLCB0eXBlLCB0YXJnZXQsIGtlZXBBbGl2ZVJvb3QpIHtcclxuICAgIC8vIGluamVjdEhvb2sgd3JhcHMgdGhlIG9yaWdpbmFsIGZvciBlcnJvciBoYW5kbGluZywgc28gbWFrZSBzdXJlIHRvIHJlbW92ZVxyXG4gICAgLy8gdGhlIHdyYXBwZWQgdmVyc2lvbi5cclxuICAgIGNvbnN0IGluamVjdGVkID0gaW5qZWN0SG9vayh0eXBlLCBob29rLCBrZWVwQWxpdmVSb290LCB0cnVlIC8qIHByZXBlbmQgKi8pO1xyXG4gICAgb25Vbm1vdW50ZWQoKCkgPT4ge1xyXG4gICAgICAgIHJlbW92ZShrZWVwQWxpdmVSb290W3R5cGVdLCBpbmplY3RlZCk7XHJcbiAgICB9LCB0YXJnZXQpO1xyXG59XHJcbmZ1bmN0aW9uIHJlc2V0U2hhcGVGbGFnKHZub2RlKSB7XHJcbiAgICBsZXQgc2hhcGVGbGFnID0gdm5vZGUuc2hhcGVGbGFnO1xyXG4gICAgaWYgKHNoYXBlRmxhZyAmIDI1NiAvKiBDT01QT05FTlRfU0hPVUxEX0tFRVBfQUxJVkUgKi8pIHtcclxuICAgICAgICBzaGFwZUZsYWcgLT0gMjU2IC8qIENPTVBPTkVOVF9TSE9VTERfS0VFUF9BTElWRSAqLztcclxuICAgIH1cclxuICAgIGlmIChzaGFwZUZsYWcgJiA1MTIgLyogQ09NUE9ORU5UX0tFUFRfQUxJVkUgKi8pIHtcclxuICAgICAgICBzaGFwZUZsYWcgLT0gNTEyIC8qIENPTVBPTkVOVF9LRVBUX0FMSVZFICovO1xyXG4gICAgfVxyXG4gICAgdm5vZGUuc2hhcGVGbGFnID0gc2hhcGVGbGFnO1xyXG59XHJcbmZ1bmN0aW9uIGdldElubmVyQ2hpbGQodm5vZGUpIHtcclxuICAgIHJldHVybiB2bm9kZS5zaGFwZUZsYWcgJiAxMjggLyogU1VTUEVOU0UgKi8gPyB2bm9kZS5zc0NvbnRlbnQgOiB2bm9kZTtcclxufVxuXG5mdW5jdGlvbiBpbmplY3RIb29rKHR5cGUsIGhvb2ssIHRhcmdldCA9IGN1cnJlbnRJbnN0YW5jZSwgcHJlcGVuZCA9IGZhbHNlKSB7XHJcbiAgICBpZiAodGFyZ2V0KSB7XHJcbiAgICAgICAgY29uc3QgaG9va3MgPSB0YXJnZXRbdHlwZV0gfHwgKHRhcmdldFt0eXBlXSA9IFtdKTtcclxuICAgICAgICAvLyBjYWNoZSB0aGUgZXJyb3IgaGFuZGxpbmcgd3JhcHBlciBmb3IgaW5qZWN0ZWQgaG9va3Mgc28gdGhlIHNhbWUgaG9va1xyXG4gICAgICAgIC8vIGNhbiBiZSBwcm9wZXJseSBkZWR1cGVkIGJ5IHRoZSBzY2hlZHVsZXIuIFwiX193ZWhcIiBzdGFuZHMgZm9yIFwid2l0aCBlcnJvclxyXG4gICAgICAgIC8vIGhhbmRsaW5nXCIuXHJcbiAgICAgICAgY29uc3Qgd3JhcHBlZEhvb2sgPSBob29rLl9fd2VoIHx8XHJcbiAgICAgICAgICAgIChob29rLl9fd2VoID0gKC4uLmFyZ3MpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmICh0YXJnZXQuaXNVbm1vdW50ZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyBkaXNhYmxlIHRyYWNraW5nIGluc2lkZSBhbGwgbGlmZWN5Y2xlIGhvb2tzXHJcbiAgICAgICAgICAgICAgICAvLyBzaW5jZSB0aGV5IGNhbiBwb3RlbnRpYWxseSBiZSBjYWxsZWQgaW5zaWRlIGVmZmVjdHMuXHJcbiAgICAgICAgICAgICAgICBwYXVzZVRyYWNraW5nKCk7XHJcbiAgICAgICAgICAgICAgICAvLyBTZXQgY3VycmVudEluc3RhbmNlIGR1cmluZyBob29rIGludm9jYXRpb24uXHJcbiAgICAgICAgICAgICAgICAvLyBUaGlzIGFzc3VtZXMgdGhlIGhvb2sgZG9lcyBub3Qgc3luY2hyb25vdXNseSB0cmlnZ2VyIG90aGVyIGhvb2tzLCB3aGljaFxyXG4gICAgICAgICAgICAgICAgLy8gY2FuIG9ubHkgYmUgZmFsc2Ugd2hlbiB0aGUgdXNlciBkb2VzIHNvbWV0aGluZyByZWFsbHkgZnVua3kuXHJcbiAgICAgICAgICAgICAgICBzZXRDdXJyZW50SW5zdGFuY2UodGFyZ2V0KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHJlcyA9IGNhbGxXaXRoQXN5bmNFcnJvckhhbmRsaW5nKGhvb2ssIHRhcmdldCwgdHlwZSwgYXJncyk7XHJcbiAgICAgICAgICAgICAgICB1bnNldEN1cnJlbnRJbnN0YW5jZSgpO1xyXG4gICAgICAgICAgICAgICAgcmVzZXRUcmFja2luZygpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcztcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgaWYgKHByZXBlbmQpIHtcclxuICAgICAgICAgICAgaG9va3MudW5zaGlmdCh3cmFwcGVkSG9vayk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBob29rcy5wdXNoKHdyYXBwZWRIb29rKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHdyYXBwZWRIb29rO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgY29uc3QgYXBpTmFtZSA9IHRvSGFuZGxlcktleShFcnJvclR5cGVTdHJpbmdzW3R5cGVdLnJlcGxhY2UoLyBob29rJC8sICcnKSk7XHJcbiAgICAgICAgd2FybihgJHthcGlOYW1lfSBpcyBjYWxsZWQgd2hlbiB0aGVyZSBpcyBubyBhY3RpdmUgY29tcG9uZW50IGluc3RhbmNlIHRvIGJlIGAgK1xyXG4gICAgICAgICAgICBgYXNzb2NpYXRlZCB3aXRoLiBgICtcclxuICAgICAgICAgICAgYExpZmVjeWNsZSBpbmplY3Rpb24gQVBJcyBjYW4gb25seSBiZSB1c2VkIGR1cmluZyBleGVjdXRpb24gb2Ygc2V0dXAoKS5gICtcclxuICAgICAgICAgICAgKGAgSWYgeW91IGFyZSB1c2luZyBhc3luYyBzZXR1cCgpLCBtYWtlIHN1cmUgdG8gcmVnaXN0ZXIgbGlmZWN5Y2xlIGAgK1xyXG4gICAgICAgICAgICAgICAgICAgIGBob29rcyBiZWZvcmUgdGhlIGZpcnN0IGF3YWl0IHN0YXRlbWVudC5gXHJcbiAgICAgICAgICAgICAgICApKTtcclxuICAgIH1cclxufVxyXG5jb25zdCBjcmVhdGVIb29rID0gKGxpZmVjeWNsZSkgPT4gKGhvb2ssIHRhcmdldCA9IGN1cnJlbnRJbnN0YW5jZSkgPT4gXHJcbi8vIHBvc3QtY3JlYXRlIGxpZmVjeWNsZSByZWdpc3RyYXRpb25zIGFyZSBub29wcyBkdXJpbmcgU1NSIChleGNlcHQgZm9yIHNlcnZlclByZWZldGNoKVxyXG4oIWlzSW5TU1JDb21wb25lbnRTZXR1cCB8fCBsaWZlY3ljbGUgPT09IFwic3BcIiAvKiBTRVJWRVJfUFJFRkVUQ0ggKi8pICYmXHJcbiAgICBpbmplY3RIb29rKGxpZmVjeWNsZSwgaG9vaywgdGFyZ2V0KTtcclxuY29uc3Qgb25CZWZvcmVNb3VudCA9IGNyZWF0ZUhvb2soXCJibVwiIC8qIEJFRk9SRV9NT1VOVCAqLyk7XHJcbmNvbnN0IG9uTW91bnRlZCA9IGNyZWF0ZUhvb2soXCJtXCIgLyogTU9VTlRFRCAqLyk7XHJcbmNvbnN0IG9uQmVmb3JlVXBkYXRlID0gY3JlYXRlSG9vayhcImJ1XCIgLyogQkVGT1JFX1VQREFURSAqLyk7XHJcbmNvbnN0IG9uVXBkYXRlZCA9IGNyZWF0ZUhvb2soXCJ1XCIgLyogVVBEQVRFRCAqLyk7XHJcbmNvbnN0IG9uQmVmb3JlVW5tb3VudCA9IGNyZWF0ZUhvb2soXCJidW1cIiAvKiBCRUZPUkVfVU5NT1VOVCAqLyk7XHJcbmNvbnN0IG9uVW5tb3VudGVkID0gY3JlYXRlSG9vayhcInVtXCIgLyogVU5NT1VOVEVEICovKTtcclxuY29uc3Qgb25TZXJ2ZXJQcmVmZXRjaCA9IGNyZWF0ZUhvb2soXCJzcFwiIC8qIFNFUlZFUl9QUkVGRVRDSCAqLyk7XHJcbmNvbnN0IG9uUmVuZGVyVHJpZ2dlcmVkID0gY3JlYXRlSG9vayhcInJ0Z1wiIC8qIFJFTkRFUl9UUklHR0VSRUQgKi8pO1xyXG5jb25zdCBvblJlbmRlclRyYWNrZWQgPSBjcmVhdGVIb29rKFwicnRjXCIgLyogUkVOREVSX1RSQUNLRUQgKi8pO1xyXG5mdW5jdGlvbiBvbkVycm9yQ2FwdHVyZWQoaG9vaywgdGFyZ2V0ID0gY3VycmVudEluc3RhbmNlKSB7XHJcbiAgICBpbmplY3RIb29rKFwiZWNcIiAvKiBFUlJPUl9DQVBUVVJFRCAqLywgaG9vaywgdGFyZ2V0KTtcclxufVxuXG5mdW5jdGlvbiBjcmVhdGVEdXBsaWNhdGVDaGVja2VyKCkge1xyXG4gICAgY29uc3QgY2FjaGUgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xyXG4gICAgcmV0dXJuICh0eXBlLCBrZXkpID0+IHtcclxuICAgICAgICBpZiAoY2FjaGVba2V5XSkge1xyXG4gICAgICAgICAgICB3YXJuKGAke3R5cGV9IHByb3BlcnR5IFwiJHtrZXl9XCIgaXMgYWxyZWFkeSBkZWZpbmVkIGluICR7Y2FjaGVba2V5XX0uYCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBjYWNoZVtrZXldID0gdHlwZTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59XHJcbmxldCBzaG91bGRDYWNoZUFjY2VzcyA9IHRydWU7XHJcbmZ1bmN0aW9uIGFwcGx5T3B0aW9ucyhpbnN0YW5jZSkge1xyXG4gICAgY29uc3Qgb3B0aW9ucyA9IHJlc29sdmVNZXJnZWRPcHRpb25zKGluc3RhbmNlKTtcclxuICAgIGNvbnN0IHB1YmxpY1RoaXMgPSBpbnN0YW5jZS5wcm94eTtcclxuICAgIGNvbnN0IGN0eCA9IGluc3RhbmNlLmN0eDtcclxuICAgIC8vIGRvIG5vdCBjYWNoZSBwcm9wZXJ0eSBhY2Nlc3Mgb24gcHVibGljIHByb3h5IGR1cmluZyBzdGF0ZSBpbml0aWFsaXphdGlvblxyXG4gICAgc2hvdWxkQ2FjaGVBY2Nlc3MgPSBmYWxzZTtcclxuICAgIC8vIGNhbGwgYmVmb3JlQ3JlYXRlIGZpcnN0IGJlZm9yZSBhY2Nlc3Npbmcgb3RoZXIgb3B0aW9ucyBzaW5jZVxyXG4gICAgLy8gdGhlIGhvb2sgbWF5IG11dGF0ZSByZXNvbHZlZCBvcHRpb25zICgjMjc5MSlcclxuICAgIGlmIChvcHRpb25zLmJlZm9yZUNyZWF0ZSkge1xyXG4gICAgICAgIGNhbGxIb29rKG9wdGlvbnMuYmVmb3JlQ3JlYXRlLCBpbnN0YW5jZSwgXCJiY1wiIC8qIEJFRk9SRV9DUkVBVEUgKi8pO1xyXG4gICAgfVxyXG4gICAgY29uc3QgeyBcclxuICAgIC8vIHN0YXRlXHJcbiAgICBkYXRhOiBkYXRhT3B0aW9ucywgY29tcHV0ZWQ6IGNvbXB1dGVkT3B0aW9ucywgbWV0aG9kcywgd2F0Y2g6IHdhdGNoT3B0aW9ucywgcHJvdmlkZTogcHJvdmlkZU9wdGlvbnMsIGluamVjdDogaW5qZWN0T3B0aW9ucywgXHJcbiAgICAvLyBsaWZlY3ljbGVcclxuICAgIGNyZWF0ZWQsIGJlZm9yZU1vdW50LCBtb3VudGVkLCBiZWZvcmVVcGRhdGUsIHVwZGF0ZWQsIGFjdGl2YXRlZCwgZGVhY3RpdmF0ZWQsIGJlZm9yZURlc3Ryb3ksIGJlZm9yZVVubW91bnQsIGRlc3Ryb3llZCwgdW5tb3VudGVkLCByZW5kZXIsIHJlbmRlclRyYWNrZWQsIHJlbmRlclRyaWdnZXJlZCwgZXJyb3JDYXB0dXJlZCwgc2VydmVyUHJlZmV0Y2gsIFxyXG4gICAgLy8gcHVibGljIEFQSVxyXG4gICAgZXhwb3NlLCBpbmhlcml0QXR0cnMsIFxyXG4gICAgLy8gYXNzZXRzXHJcbiAgICBjb21wb25lbnRzLCBkaXJlY3RpdmVzLCBmaWx0ZXJzIH0gPSBvcHRpb25zO1xyXG4gICAgY29uc3QgY2hlY2tEdXBsaWNhdGVQcm9wZXJ0aWVzID0gKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpID8gY3JlYXRlRHVwbGljYXRlQ2hlY2tlcigpIDogbnVsbDtcclxuICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICBjb25zdCBbcHJvcHNPcHRpb25zXSA9IGluc3RhbmNlLnByb3BzT3B0aW9ucztcclxuICAgICAgICBpZiAocHJvcHNPcHRpb25zKSB7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IGluIHByb3BzT3B0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgY2hlY2tEdXBsaWNhdGVQcm9wZXJ0aWVzKFwiUHJvcHNcIiAvKiBQUk9QUyAqLywga2V5KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8vIG9wdGlvbnMgaW5pdGlhbGl6YXRpb24gb3JkZXIgKHRvIGJlIGNvbnNpc3RlbnQgd2l0aCBWdWUgMik6XHJcbiAgICAvLyAtIHByb3BzIChhbHJlYWR5IGRvbmUgb3V0c2lkZSBvZiB0aGlzIGZ1bmN0aW9uKVxyXG4gICAgLy8gLSBpbmplY3RcclxuICAgIC8vIC0gbWV0aG9kc1xyXG4gICAgLy8gLSBkYXRhIChkZWZlcnJlZCBzaW5jZSBpdCByZWxpZXMgb24gYHRoaXNgIGFjY2VzcylcclxuICAgIC8vIC0gY29tcHV0ZWRcclxuICAgIC8vIC0gd2F0Y2ggKGRlZmVycmVkIHNpbmNlIGl0IHJlbGllcyBvbiBgdGhpc2AgYWNjZXNzKVxyXG4gICAgaWYgKGluamVjdE9wdGlvbnMpIHtcclxuICAgICAgICByZXNvbHZlSW5qZWN0aW9ucyhpbmplY3RPcHRpb25zLCBjdHgsIGNoZWNrRHVwbGljYXRlUHJvcGVydGllcywgaW5zdGFuY2UuYXBwQ29udGV4dC5jb25maWcudW53cmFwSW5qZWN0ZWRSZWYpO1xyXG4gICAgfVxyXG4gICAgaWYgKG1ldGhvZHMpIHtcclxuICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBtZXRob2RzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1ldGhvZEhhbmRsZXIgPSBtZXRob2RzW2tleV07XHJcbiAgICAgICAgICAgIGlmIChpc0Z1bmN0aW9uKG1ldGhvZEhhbmRsZXIpKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBJbiBkZXYgbW9kZSwgd2UgdXNlIHRoZSBgY3JlYXRlUmVuZGVyQ29udGV4dGAgZnVuY3Rpb24gdG8gZGVmaW5lXHJcbiAgICAgICAgICAgICAgICAvLyBtZXRob2RzIHRvIHRoZSBwcm94eSB0YXJnZXQsIGFuZCB0aG9zZSBhcmUgcmVhZC1vbmx5IGJ1dFxyXG4gICAgICAgICAgICAgICAgLy8gcmVjb25maWd1cmFibGUsIHNvIGl0IG5lZWRzIHRvIGJlIHJlZGVmaW5lZCBoZXJlXHJcbiAgICAgICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGN0eCwga2V5LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBtZXRob2RIYW5kbGVyLmJpbmQocHVibGljVGhpcyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgd3JpdGFibGU6IHRydWVcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGN0eFtrZXldID0gbWV0aG9kSGFuZGxlci5iaW5kKHB1YmxpY1RoaXMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoZWNrRHVwbGljYXRlUHJvcGVydGllcyhcIk1ldGhvZHNcIiAvKiBNRVRIT0RTICovLCBrZXkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgICAgICAgICAgd2FybihgTWV0aG9kIFwiJHtrZXl9XCIgaGFzIHR5cGUgXCIke3R5cGVvZiBtZXRob2RIYW5kbGVyfVwiIGluIHRoZSBjb21wb25lbnQgZGVmaW5pdGlvbi4gYCArXHJcbiAgICAgICAgICAgICAgICAgICAgYERpZCB5b3UgcmVmZXJlbmNlIHRoZSBmdW5jdGlvbiBjb3JyZWN0bHk/YCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAoZGF0YU9wdGlvbnMpIHtcclxuICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmICFpc0Z1bmN0aW9uKGRhdGFPcHRpb25zKSkge1xyXG4gICAgICAgICAgICB3YXJuKGBUaGUgZGF0YSBvcHRpb24gbXVzdCBiZSBhIGZ1bmN0aW9uLiBgICtcclxuICAgICAgICAgICAgICAgIGBQbGFpbiBvYmplY3QgdXNhZ2UgaXMgbm8gbG9uZ2VyIHN1cHBvcnRlZC5gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgZGF0YSA9IGRhdGFPcHRpb25zLmNhbGwocHVibGljVGhpcywgcHVibGljVGhpcyk7XHJcbiAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiBpc1Byb21pc2UoZGF0YSkpIHtcclxuICAgICAgICAgICAgd2FybihgZGF0YSgpIHJldHVybmVkIGEgUHJvbWlzZSAtIG5vdGUgZGF0YSgpIGNhbm5vdCBiZSBhc3luYzsgSWYgeW91IGAgK1xyXG4gICAgICAgICAgICAgICAgYGludGVuZCB0byBwZXJmb3JtIGRhdGEgZmV0Y2hpbmcgYmVmb3JlIGNvbXBvbmVudCByZW5kZXJzLCB1c2UgYCArXHJcbiAgICAgICAgICAgICAgICBgYXN5bmMgc2V0dXAoKSArIDxTdXNwZW5zZT4uYCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghaXNPYmplY3QoZGF0YSkpIHtcclxuICAgICAgICAgICAgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmIHdhcm4oYGRhdGEoKSBzaG91bGQgcmV0dXJuIGFuIG9iamVjdC5gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGluc3RhbmNlLmRhdGEgPSByZWFjdGl2ZShkYXRhKTtcclxuICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoZWNrRHVwbGljYXRlUHJvcGVydGllcyhcIkRhdGFcIiAvKiBEQVRBICovLCBrZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGV4cG9zZSBkYXRhIG9uIGN0eCBkdXJpbmcgZGV2XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGtleVswXSAhPT0gJyQnICYmIGtleVswXSAhPT0gJ18nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjdHgsIGtleSwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldDogKCkgPT4gZGF0YVtrZXldLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0OiBOT09QXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8vIHN0YXRlIGluaXRpYWxpemF0aW9uIGNvbXBsZXRlIGF0IHRoaXMgcG9pbnQgLSBzdGFydCBjYWNoaW5nIGFjY2Vzc1xyXG4gICAgc2hvdWxkQ2FjaGVBY2Nlc3MgPSB0cnVlO1xyXG4gICAgaWYgKGNvbXB1dGVkT3B0aW9ucykge1xyXG4gICAgICAgIGZvciAoY29uc3Qga2V5IGluIGNvbXB1dGVkT3B0aW9ucykge1xyXG4gICAgICAgICAgICBjb25zdCBvcHQgPSBjb21wdXRlZE9wdGlvbnNba2V5XTtcclxuICAgICAgICAgICAgY29uc3QgZ2V0ID0gaXNGdW5jdGlvbihvcHQpXHJcbiAgICAgICAgICAgICAgICA/IG9wdC5iaW5kKHB1YmxpY1RoaXMsIHB1YmxpY1RoaXMpXHJcbiAgICAgICAgICAgICAgICA6IGlzRnVuY3Rpb24ob3B0LmdldClcclxuICAgICAgICAgICAgICAgICAgICA/IG9wdC5nZXQuYmluZChwdWJsaWNUaGlzLCBwdWJsaWNUaGlzKVxyXG4gICAgICAgICAgICAgICAgICAgIDogTk9PUDtcclxuICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiBnZXQgPT09IE5PT1ApIHtcclxuICAgICAgICAgICAgICAgIHdhcm4oYENvbXB1dGVkIHByb3BlcnR5IFwiJHtrZXl9XCIgaGFzIG5vIGdldHRlci5gKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCBzZXQgPSAhaXNGdW5jdGlvbihvcHQpICYmIGlzRnVuY3Rpb24ob3B0LnNldClcclxuICAgICAgICAgICAgICAgID8gb3B0LnNldC5iaW5kKHB1YmxpY1RoaXMpXHJcbiAgICAgICAgICAgICAgICA6IChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKVxyXG4gICAgICAgICAgICAgICAgICAgID8gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3YXJuKGBXcml0ZSBvcGVyYXRpb24gZmFpbGVkOiBjb21wdXRlZCBwcm9wZXJ0eSBcIiR7a2V5fVwiIGlzIHJlYWRvbmx5LmApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICA6IE5PT1A7XHJcbiAgICAgICAgICAgIGNvbnN0IGMgPSBjb21wdXRlZCh7XHJcbiAgICAgICAgICAgICAgICBnZXQsXHJcbiAgICAgICAgICAgICAgICBzZXRcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjdHgsIGtleSwge1xyXG4gICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGdldDogKCkgPT4gYy52YWx1ZSxcclxuICAgICAgICAgICAgICAgIHNldDogdiA9PiAoYy52YWx1ZSA9IHYpXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgICAgICBjaGVja0R1cGxpY2F0ZVByb3BlcnRpZXMoXCJDb21wdXRlZFwiIC8qIENPTVBVVEVEICovLCBrZXkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYgKHdhdGNoT3B0aW9ucykge1xyXG4gICAgICAgIGZvciAoY29uc3Qga2V5IGluIHdhdGNoT3B0aW9ucykge1xyXG4gICAgICAgICAgICBjcmVhdGVXYXRjaGVyKHdhdGNoT3B0aW9uc1trZXldLCBjdHgsIHB1YmxpY1RoaXMsIGtleSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYgKHByb3ZpZGVPcHRpb25zKSB7XHJcbiAgICAgICAgY29uc3QgcHJvdmlkZXMgPSBpc0Z1bmN0aW9uKHByb3ZpZGVPcHRpb25zKVxyXG4gICAgICAgICAgICA/IHByb3ZpZGVPcHRpb25zLmNhbGwocHVibGljVGhpcylcclxuICAgICAgICAgICAgOiBwcm92aWRlT3B0aW9ucztcclxuICAgICAgICBSZWZsZWN0Lm93bktleXMocHJvdmlkZXMpLmZvckVhY2goa2V5ID0+IHtcclxuICAgICAgICAgICAgcHJvdmlkZShrZXksIHByb3ZpZGVzW2tleV0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgaWYgKGNyZWF0ZWQpIHtcclxuICAgICAgICBjYWxsSG9vayhjcmVhdGVkLCBpbnN0YW5jZSwgXCJjXCIgLyogQ1JFQVRFRCAqLyk7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiByZWdpc3RlckxpZmVjeWNsZUhvb2socmVnaXN0ZXIsIGhvb2spIHtcclxuICAgICAgICBpZiAoaXNBcnJheShob29rKSkge1xyXG4gICAgICAgICAgICBob29rLmZvckVhY2goX2hvb2sgPT4gcmVnaXN0ZXIoX2hvb2suYmluZChwdWJsaWNUaGlzKSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChob29rKSB7XHJcbiAgICAgICAgICAgIHJlZ2lzdGVyKGhvb2suYmluZChwdWJsaWNUaGlzKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmVnaXN0ZXJMaWZlY3ljbGVIb29rKG9uQmVmb3JlTW91bnQsIGJlZm9yZU1vdW50KTtcclxuICAgIHJlZ2lzdGVyTGlmZWN5Y2xlSG9vayhvbk1vdW50ZWQsIG1vdW50ZWQpO1xyXG4gICAgcmVnaXN0ZXJMaWZlY3ljbGVIb29rKG9uQmVmb3JlVXBkYXRlLCBiZWZvcmVVcGRhdGUpO1xyXG4gICAgcmVnaXN0ZXJMaWZlY3ljbGVIb29rKG9uVXBkYXRlZCwgdXBkYXRlZCk7XHJcbiAgICByZWdpc3RlckxpZmVjeWNsZUhvb2sob25BY3RpdmF0ZWQsIGFjdGl2YXRlZCk7XHJcbiAgICByZWdpc3RlckxpZmVjeWNsZUhvb2sob25EZWFjdGl2YXRlZCwgZGVhY3RpdmF0ZWQpO1xyXG4gICAgcmVnaXN0ZXJMaWZlY3ljbGVIb29rKG9uRXJyb3JDYXB0dXJlZCwgZXJyb3JDYXB0dXJlZCk7XHJcbiAgICByZWdpc3RlckxpZmVjeWNsZUhvb2sob25SZW5kZXJUcmFja2VkLCByZW5kZXJUcmFja2VkKTtcclxuICAgIHJlZ2lzdGVyTGlmZWN5Y2xlSG9vayhvblJlbmRlclRyaWdnZXJlZCwgcmVuZGVyVHJpZ2dlcmVkKTtcclxuICAgIHJlZ2lzdGVyTGlmZWN5Y2xlSG9vayhvbkJlZm9yZVVubW91bnQsIGJlZm9yZVVubW91bnQpO1xyXG4gICAgcmVnaXN0ZXJMaWZlY3ljbGVIb29rKG9uVW5tb3VudGVkLCB1bm1vdW50ZWQpO1xyXG4gICAgcmVnaXN0ZXJMaWZlY3ljbGVIb29rKG9uU2VydmVyUHJlZmV0Y2gsIHNlcnZlclByZWZldGNoKTtcclxuICAgIGlmIChpc0FycmF5KGV4cG9zZSkpIHtcclxuICAgICAgICBpZiAoZXhwb3NlLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBjb25zdCBleHBvc2VkID0gaW5zdGFuY2UuZXhwb3NlZCB8fCAoaW5zdGFuY2UuZXhwb3NlZCA9IHt9KTtcclxuICAgICAgICAgICAgZXhwb3NlLmZvckVhY2goa2V5ID0+IHtcclxuICAgICAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvc2VkLCBrZXksIHtcclxuICAgICAgICAgICAgICAgICAgICBnZXQ6ICgpID0+IHB1YmxpY1RoaXNba2V5XSxcclxuICAgICAgICAgICAgICAgICAgICBzZXQ6IHZhbCA9PiAocHVibGljVGhpc1trZXldID0gdmFsKVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICghaW5zdGFuY2UuZXhwb3NlZCkge1xyXG4gICAgICAgICAgICBpbnN0YW5jZS5leHBvc2VkID0ge307XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8gb3B0aW9ucyB0aGF0IGFyZSBoYW5kbGVkIHdoZW4gY3JlYXRpbmcgdGhlIGluc3RhbmNlIGJ1dCBhbHNvIG5lZWQgdG8gYmVcclxuICAgIC8vIGFwcGxpZWQgZnJvbSBtaXhpbnNcclxuICAgIGlmIChyZW5kZXIgJiYgaW5zdGFuY2UucmVuZGVyID09PSBOT09QKSB7XHJcbiAgICAgICAgaW5zdGFuY2UucmVuZGVyID0gcmVuZGVyO1xyXG4gICAgfVxyXG4gICAgaWYgKGluaGVyaXRBdHRycyAhPSBudWxsKSB7XHJcbiAgICAgICAgaW5zdGFuY2UuaW5oZXJpdEF0dHJzID0gaW5oZXJpdEF0dHJzO1xyXG4gICAgfVxyXG4gICAgLy8gYXNzZXQgb3B0aW9ucy5cclxuICAgIGlmIChjb21wb25lbnRzKVxyXG4gICAgICAgIGluc3RhbmNlLmNvbXBvbmVudHMgPSBjb21wb25lbnRzO1xyXG4gICAgaWYgKGRpcmVjdGl2ZXMpXHJcbiAgICAgICAgaW5zdGFuY2UuZGlyZWN0aXZlcyA9IGRpcmVjdGl2ZXM7XHJcbn1cclxuZnVuY3Rpb24gcmVzb2x2ZUluamVjdGlvbnMoaW5qZWN0T3B0aW9ucywgY3R4LCBjaGVja0R1cGxpY2F0ZVByb3BlcnRpZXMgPSBOT09QLCB1bndyYXBSZWYgPSBmYWxzZSkge1xyXG4gICAgaWYgKGlzQXJyYXkoaW5qZWN0T3B0aW9ucykpIHtcclxuICAgICAgICBpbmplY3RPcHRpb25zID0gbm9ybWFsaXplSW5qZWN0KGluamVjdE9wdGlvbnMpO1xyXG4gICAgfVxyXG4gICAgZm9yIChjb25zdCBrZXkgaW4gaW5qZWN0T3B0aW9ucykge1xyXG4gICAgICAgIGNvbnN0IG9wdCA9IGluamVjdE9wdGlvbnNba2V5XTtcclxuICAgICAgICBsZXQgaW5qZWN0ZWQ7XHJcbiAgICAgICAgaWYgKGlzT2JqZWN0KG9wdCkpIHtcclxuICAgICAgICAgICAgaWYgKCdkZWZhdWx0JyBpbiBvcHQpIHtcclxuICAgICAgICAgICAgICAgIGluamVjdGVkID0gaW5qZWN0KG9wdC5mcm9tIHx8IGtleSwgb3B0LmRlZmF1bHQsIHRydWUgLyogdHJlYXQgZGVmYXVsdCBmdW5jdGlvbiBhcyBmYWN0b3J5ICovKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGluamVjdGVkID0gaW5qZWN0KG9wdC5mcm9tIHx8IGtleSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGluamVjdGVkID0gaW5qZWN0KG9wdCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChpc1JlZihpbmplY3RlZCkpIHtcclxuICAgICAgICAgICAgLy8gVE9ETyByZW1vdmUgdGhlIGNoZWNrIGluIDMuM1xyXG4gICAgICAgICAgICBpZiAodW53cmFwUmVmKSB7XHJcbiAgICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoY3R4LCBrZXksIHtcclxuICAgICAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBnZXQ6ICgpID0+IGluamVjdGVkLnZhbHVlLFxyXG4gICAgICAgICAgICAgICAgICAgIHNldDogdiA9PiAoaW5qZWN0ZWQudmFsdWUgPSB2KVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgd2FybihgaW5qZWN0ZWQgcHJvcGVydHkgXCIke2tleX1cIiBpcyBhIHJlZiBhbmQgd2lsbCBiZSBhdXRvLXVud3JhcHBlZCBgICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYGFuZCBubyBsb25nZXIgbmVlZHMgXFxgLnZhbHVlXFxgIGluIHRoZSBuZXh0IG1pbm9yIHJlbGVhc2UuIGAgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBgVG8gb3B0LWluIHRvIHRoZSBuZXcgYmVoYXZpb3Igbm93LCBgICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYHNldCBcXGBhcHAuY29uZmlnLnVud3JhcEluamVjdGVkUmVmID0gdHJ1ZVxcYCAodGhpcyBjb25maWcgaXMgYCArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGB0ZW1wb3JhcnkgYW5kIHdpbGwgbm90IGJlIG5lZWRlZCBpbiB0aGUgZnV0dXJlLilgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGN0eFtrZXldID0gaW5qZWN0ZWQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGN0eFtrZXldID0gaW5qZWN0ZWQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgY2hlY2tEdXBsaWNhdGVQcm9wZXJ0aWVzKFwiSW5qZWN0XCIgLyogSU5KRUNUICovLCBrZXkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBjYWxsSG9vayhob29rLCBpbnN0YW5jZSwgdHlwZSkge1xyXG4gICAgY2FsbFdpdGhBc3luY0Vycm9ySGFuZGxpbmcoaXNBcnJheShob29rKVxyXG4gICAgICAgID8gaG9vay5tYXAoaCA9PiBoLmJpbmQoaW5zdGFuY2UucHJveHkpKVxyXG4gICAgICAgIDogaG9vay5iaW5kKGluc3RhbmNlLnByb3h5KSwgaW5zdGFuY2UsIHR5cGUpO1xyXG59XHJcbmZ1bmN0aW9uIGNyZWF0ZVdhdGNoZXIocmF3LCBjdHgsIHB1YmxpY1RoaXMsIGtleSkge1xyXG4gICAgY29uc3QgZ2V0dGVyID0ga2V5LmluY2x1ZGVzKCcuJylcclxuICAgICAgICA/IGNyZWF0ZVBhdGhHZXR0ZXIocHVibGljVGhpcywga2V5KVxyXG4gICAgICAgIDogKCkgPT4gcHVibGljVGhpc1trZXldO1xyXG4gICAgaWYgKGlzU3RyaW5nKHJhdykpIHtcclxuICAgICAgICBjb25zdCBoYW5kbGVyID0gY3R4W3Jhd107XHJcbiAgICAgICAgaWYgKGlzRnVuY3Rpb24oaGFuZGxlcikpIHtcclxuICAgICAgICAgICAgd2F0Y2goZ2V0dGVyLCBoYW5kbGVyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgIHdhcm4oYEludmFsaWQgd2F0Y2ggaGFuZGxlciBzcGVjaWZpZWQgYnkga2V5IFwiJHtyYXd9XCJgLCBoYW5kbGVyKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChpc0Z1bmN0aW9uKHJhdykpIHtcclxuICAgICAgICB3YXRjaChnZXR0ZXIsIHJhdy5iaW5kKHB1YmxpY1RoaXMpKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGlzT2JqZWN0KHJhdykpIHtcclxuICAgICAgICBpZiAoaXNBcnJheShyYXcpKSB7XHJcbiAgICAgICAgICAgIHJhdy5mb3JFYWNoKHIgPT4gY3JlYXRlV2F0Y2hlcihyLCBjdHgsIHB1YmxpY1RoaXMsIGtleSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgY29uc3QgaGFuZGxlciA9IGlzRnVuY3Rpb24ocmF3LmhhbmRsZXIpXHJcbiAgICAgICAgICAgICAgICA/IHJhdy5oYW5kbGVyLmJpbmQocHVibGljVGhpcylcclxuICAgICAgICAgICAgICAgIDogY3R4W3Jhdy5oYW5kbGVyXTtcclxuICAgICAgICAgICAgaWYgKGlzRnVuY3Rpb24oaGFuZGxlcikpIHtcclxuICAgICAgICAgICAgICAgIHdhdGNoKGdldHRlciwgaGFuZGxlciwgcmF3KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgIHdhcm4oYEludmFsaWQgd2F0Y2ggaGFuZGxlciBzcGVjaWZpZWQgYnkga2V5IFwiJHtyYXcuaGFuZGxlcn1cImAsIGhhbmRsZXIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgd2FybihgSW52YWxpZCB3YXRjaCBvcHRpb246IFwiJHtrZXl9XCJgLCByYXcpO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBSZXNvbHZlIG1lcmdlZCBvcHRpb25zIGFuZCBjYWNoZSBpdCBvbiB0aGUgY29tcG9uZW50LlxyXG4gKiBUaGlzIGlzIGRvbmUgb25seSBvbmNlIHBlci1jb21wb25lbnQgc2luY2UgdGhlIG1lcmdpbmcgZG9lcyBub3QgaW52b2x2ZVxyXG4gKiBpbnN0YW5jZXMuXHJcbiAqL1xyXG5mdW5jdGlvbiByZXNvbHZlTWVyZ2VkT3B0aW9ucyhpbnN0YW5jZSkge1xyXG4gICAgY29uc3QgYmFzZSA9IGluc3RhbmNlLnR5cGU7XHJcbiAgICBjb25zdCB7IG1peGlucywgZXh0ZW5kczogZXh0ZW5kc09wdGlvbnMgfSA9IGJhc2U7XHJcbiAgICBjb25zdCB7IG1peGluczogZ2xvYmFsTWl4aW5zLCBvcHRpb25zQ2FjaGU6IGNhY2hlLCBjb25maWc6IHsgb3B0aW9uTWVyZ2VTdHJhdGVnaWVzIH0gfSA9IGluc3RhbmNlLmFwcENvbnRleHQ7XHJcbiAgICBjb25zdCBjYWNoZWQgPSBjYWNoZS5nZXQoYmFzZSk7XHJcbiAgICBsZXQgcmVzb2x2ZWQ7XHJcbiAgICBpZiAoY2FjaGVkKSB7XHJcbiAgICAgICAgcmVzb2x2ZWQgPSBjYWNoZWQ7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICghZ2xvYmFsTWl4aW5zLmxlbmd0aCAmJiAhbWl4aW5zICYmICFleHRlbmRzT3B0aW9ucykge1xyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcmVzb2x2ZWQgPSBiYXNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHJlc29sdmVkID0ge307XHJcbiAgICAgICAgaWYgKGdsb2JhbE1peGlucy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgZ2xvYmFsTWl4aW5zLmZvckVhY2gobSA9PiBtZXJnZU9wdGlvbnMocmVzb2x2ZWQsIG0sIG9wdGlvbk1lcmdlU3RyYXRlZ2llcywgdHJ1ZSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBtZXJnZU9wdGlvbnMocmVzb2x2ZWQsIGJhc2UsIG9wdGlvbk1lcmdlU3RyYXRlZ2llcyk7XHJcbiAgICB9XHJcbiAgICBjYWNoZS5zZXQoYmFzZSwgcmVzb2x2ZWQpO1xyXG4gICAgcmV0dXJuIHJlc29sdmVkO1xyXG59XHJcbmZ1bmN0aW9uIG1lcmdlT3B0aW9ucyh0bywgZnJvbSwgc3RyYXRzLCBhc01peGluID0gZmFsc2UpIHtcclxuICAgIGNvbnN0IHsgbWl4aW5zLCBleHRlbmRzOiBleHRlbmRzT3B0aW9ucyB9ID0gZnJvbTtcclxuICAgIGlmIChleHRlbmRzT3B0aW9ucykge1xyXG4gICAgICAgIG1lcmdlT3B0aW9ucyh0bywgZXh0ZW5kc09wdGlvbnMsIHN0cmF0cywgdHJ1ZSk7XHJcbiAgICB9XHJcbiAgICBpZiAobWl4aW5zKSB7XHJcbiAgICAgICAgbWl4aW5zLmZvckVhY2goKG0pID0+IG1lcmdlT3B0aW9ucyh0bywgbSwgc3RyYXRzLCB0cnVlKSk7XHJcbiAgICB9XHJcbiAgICBmb3IgKGNvbnN0IGtleSBpbiBmcm9tKSB7XHJcbiAgICAgICAgaWYgKGFzTWl4aW4gJiYga2V5ID09PSAnZXhwb3NlJykge1xyXG4gICAgICAgICAgICAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiZcclxuICAgICAgICAgICAgICAgIHdhcm4oYFwiZXhwb3NlXCIgb3B0aW9uIGlzIGlnbm9yZWQgd2hlbiBkZWNsYXJlZCBpbiBtaXhpbnMgb3IgZXh0ZW5kcy4gYCArXHJcbiAgICAgICAgICAgICAgICAgICAgYEl0IHNob3VsZCBvbmx5IGJlIGRlY2xhcmVkIGluIHRoZSBiYXNlIGNvbXBvbmVudCBpdHNlbGYuYCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zdCBzdHJhdCA9IGludGVybmFsT3B0aW9uTWVyZ2VTdHJhdHNba2V5XSB8fCAoc3RyYXRzICYmIHN0cmF0c1trZXldKTtcclxuICAgICAgICAgICAgdG9ba2V5XSA9IHN0cmF0ID8gc3RyYXQodG9ba2V5XSwgZnJvbVtrZXldKSA6IGZyb21ba2V5XTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdG87XHJcbn1cclxuY29uc3QgaW50ZXJuYWxPcHRpb25NZXJnZVN0cmF0cyA9IHtcclxuICAgIGRhdGE6IG1lcmdlRGF0YUZuLFxyXG4gICAgcHJvcHM6IG1lcmdlT2JqZWN0T3B0aW9ucyxcclxuICAgIGVtaXRzOiBtZXJnZU9iamVjdE9wdGlvbnMsXHJcbiAgICAvLyBvYmplY3RzXHJcbiAgICBtZXRob2RzOiBtZXJnZU9iamVjdE9wdGlvbnMsXHJcbiAgICBjb21wdXRlZDogbWVyZ2VPYmplY3RPcHRpb25zLFxyXG4gICAgLy8gbGlmZWN5Y2xlXHJcbiAgICBiZWZvcmVDcmVhdGU6IG1lcmdlQXNBcnJheSxcclxuICAgIGNyZWF0ZWQ6IG1lcmdlQXNBcnJheSxcclxuICAgIGJlZm9yZU1vdW50OiBtZXJnZUFzQXJyYXksXHJcbiAgICBtb3VudGVkOiBtZXJnZUFzQXJyYXksXHJcbiAgICBiZWZvcmVVcGRhdGU6IG1lcmdlQXNBcnJheSxcclxuICAgIHVwZGF0ZWQ6IG1lcmdlQXNBcnJheSxcclxuICAgIGJlZm9yZURlc3Ryb3k6IG1lcmdlQXNBcnJheSxcclxuICAgIGJlZm9yZVVubW91bnQ6IG1lcmdlQXNBcnJheSxcclxuICAgIGRlc3Ryb3llZDogbWVyZ2VBc0FycmF5LFxyXG4gICAgdW5tb3VudGVkOiBtZXJnZUFzQXJyYXksXHJcbiAgICBhY3RpdmF0ZWQ6IG1lcmdlQXNBcnJheSxcclxuICAgIGRlYWN0aXZhdGVkOiBtZXJnZUFzQXJyYXksXHJcbiAgICBlcnJvckNhcHR1cmVkOiBtZXJnZUFzQXJyYXksXHJcbiAgICBzZXJ2ZXJQcmVmZXRjaDogbWVyZ2VBc0FycmF5LFxyXG4gICAgLy8gYXNzZXRzXHJcbiAgICBjb21wb25lbnRzOiBtZXJnZU9iamVjdE9wdGlvbnMsXHJcbiAgICBkaXJlY3RpdmVzOiBtZXJnZU9iamVjdE9wdGlvbnMsXHJcbiAgICAvLyB3YXRjaFxyXG4gICAgd2F0Y2g6IG1lcmdlV2F0Y2hPcHRpb25zLFxyXG4gICAgLy8gcHJvdmlkZSAvIGluamVjdFxyXG4gICAgcHJvdmlkZTogbWVyZ2VEYXRhRm4sXHJcbiAgICBpbmplY3Q6IG1lcmdlSW5qZWN0XHJcbn07XHJcbmZ1bmN0aW9uIG1lcmdlRGF0YUZuKHRvLCBmcm9tKSB7XHJcbiAgICBpZiAoIWZyb20pIHtcclxuICAgICAgICByZXR1cm4gdG87XHJcbiAgICB9XHJcbiAgICBpZiAoIXRvKSB7XHJcbiAgICAgICAgcmV0dXJuIGZyb207XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gbWVyZ2VkRGF0YUZuKCkge1xyXG4gICAgICAgIHJldHVybiAoZXh0ZW5kKShpc0Z1bmN0aW9uKHRvKSA/IHRvLmNhbGwodGhpcywgdGhpcykgOiB0bywgaXNGdW5jdGlvbihmcm9tKSA/IGZyb20uY2FsbCh0aGlzLCB0aGlzKSA6IGZyb20pO1xyXG4gICAgfTtcclxufVxyXG5mdW5jdGlvbiBtZXJnZUluamVjdCh0bywgZnJvbSkge1xyXG4gICAgcmV0dXJuIG1lcmdlT2JqZWN0T3B0aW9ucyhub3JtYWxpemVJbmplY3QodG8pLCBub3JtYWxpemVJbmplY3QoZnJvbSkpO1xyXG59XHJcbmZ1bmN0aW9uIG5vcm1hbGl6ZUluamVjdChyYXcpIHtcclxuICAgIGlmIChpc0FycmF5KHJhdykpIHtcclxuICAgICAgICBjb25zdCByZXMgPSB7fTtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJhdy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICByZXNbcmF3W2ldXSA9IHJhd1tpXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlcztcclxuICAgIH1cclxuICAgIHJldHVybiByYXc7XHJcbn1cclxuZnVuY3Rpb24gbWVyZ2VBc0FycmF5KHRvLCBmcm9tKSB7XHJcbiAgICByZXR1cm4gdG8gPyBbLi4ubmV3IFNldChbXS5jb25jYXQodG8sIGZyb20pKV0gOiBmcm9tO1xyXG59XHJcbmZ1bmN0aW9uIG1lcmdlT2JqZWN0T3B0aW9ucyh0bywgZnJvbSkge1xyXG4gICAgcmV0dXJuIHRvID8gZXh0ZW5kKGV4dGVuZChPYmplY3QuY3JlYXRlKG51bGwpLCB0byksIGZyb20pIDogZnJvbTtcclxufVxyXG5mdW5jdGlvbiBtZXJnZVdhdGNoT3B0aW9ucyh0bywgZnJvbSkge1xyXG4gICAgaWYgKCF0bylcclxuICAgICAgICByZXR1cm4gZnJvbTtcclxuICAgIGlmICghZnJvbSlcclxuICAgICAgICByZXR1cm4gdG87XHJcbiAgICBjb25zdCBtZXJnZWQgPSBleHRlbmQoT2JqZWN0LmNyZWF0ZShudWxsKSwgdG8pO1xyXG4gICAgZm9yIChjb25zdCBrZXkgaW4gZnJvbSkge1xyXG4gICAgICAgIG1lcmdlZFtrZXldID0gbWVyZ2VBc0FycmF5KHRvW2tleV0sIGZyb21ba2V5XSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbWVyZ2VkO1xyXG59XG5cbmZ1bmN0aW9uIGluaXRQcm9wcyhpbnN0YW5jZSwgcmF3UHJvcHMsIGlzU3RhdGVmdWwsIC8vIHJlc3VsdCBvZiBiaXR3aXNlIGZsYWcgY29tcGFyaXNvblxyXG5pc1NTUiA9IGZhbHNlKSB7XHJcbiAgICBjb25zdCBwcm9wcyA9IHt9O1xyXG4gICAgY29uc3QgYXR0cnMgPSB7fTtcclxuICAgIGRlZihhdHRycywgSW50ZXJuYWxPYmplY3RLZXksIDEpO1xyXG4gICAgaW5zdGFuY2UucHJvcHNEZWZhdWx0cyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XHJcbiAgICBzZXRGdWxsUHJvcHMoaW5zdGFuY2UsIHJhd1Byb3BzLCBwcm9wcywgYXR0cnMpO1xyXG4gICAgLy8gZW5zdXJlIGFsbCBkZWNsYXJlZCBwcm9wIGtleXMgYXJlIHByZXNlbnRcclxuICAgIGZvciAoY29uc3Qga2V5IGluIGluc3RhbmNlLnByb3BzT3B0aW9uc1swXSkge1xyXG4gICAgICAgIGlmICghKGtleSBpbiBwcm9wcykpIHtcclxuICAgICAgICAgICAgcHJvcHNba2V5XSA9IHVuZGVmaW5lZDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyB2YWxpZGF0aW9uXHJcbiAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgdmFsaWRhdGVQcm9wcyhyYXdQcm9wcyB8fCB7fSwgcHJvcHMsIGluc3RhbmNlKTtcclxuICAgIH1cclxuICAgIGlmIChpc1N0YXRlZnVsKSB7XHJcbiAgICAgICAgLy8gc3RhdGVmdWxcclxuICAgICAgICBpbnN0YW5jZS5wcm9wcyA9IGlzU1NSID8gcHJvcHMgOiBzaGFsbG93UmVhY3RpdmUocHJvcHMpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgaWYgKCFpbnN0YW5jZS50eXBlLnByb3BzKSB7XHJcbiAgICAgICAgICAgIC8vIGZ1bmN0aW9uYWwgdy8gb3B0aW9uYWwgcHJvcHMsIHByb3BzID09PSBhdHRyc1xyXG4gICAgICAgICAgICBpbnN0YW5jZS5wcm9wcyA9IGF0dHJzO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8gZnVuY3Rpb25hbCB3LyBkZWNsYXJlZCBwcm9wc1xyXG4gICAgICAgICAgICBpbnN0YW5jZS5wcm9wcyA9IHByb3BzO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGluc3RhbmNlLmF0dHJzID0gYXR0cnM7XHJcbn1cclxuZnVuY3Rpb24gdXBkYXRlUHJvcHMoaW5zdGFuY2UsIHJhd1Byb3BzLCByYXdQcmV2UHJvcHMsIG9wdGltaXplZCkge1xyXG4gICAgY29uc3QgeyBwcm9wcywgYXR0cnMsIHZub2RlOiB7IHBhdGNoRmxhZyB9IH0gPSBpbnN0YW5jZTtcclxuICAgIGNvbnN0IHJhd0N1cnJlbnRQcm9wcyA9IHRvUmF3KHByb3BzKTtcclxuICAgIGNvbnN0IFtvcHRpb25zXSA9IGluc3RhbmNlLnByb3BzT3B0aW9ucztcclxuICAgIGxldCBoYXNBdHRyc0NoYW5nZWQgPSBmYWxzZTtcclxuICAgIGlmIChcclxuICAgIC8vIGFsd2F5cyBmb3JjZSBmdWxsIGRpZmYgaW4gZGV2XHJcbiAgICAvLyAtICMxOTQyIGlmIGhtciBpcyBlbmFibGVkIHdpdGggc2ZjIGNvbXBvbmVudFxyXG4gICAgLy8gLSB2aXRlIzg3MiBub24tc2ZjIGNvbXBvbmVudCB1c2VkIGJ5IHNmYyBjb21wb25lbnRcclxuICAgICEoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmXHJcbiAgICAgICAgKGluc3RhbmNlLnR5cGUuX19obXJJZCB8fFxyXG4gICAgICAgICAgICAoaW5zdGFuY2UucGFyZW50ICYmIGluc3RhbmNlLnBhcmVudC50eXBlLl9faG1ySWQpKSkgJiZcclxuICAgICAgICAob3B0aW1pemVkIHx8IHBhdGNoRmxhZyA+IDApICYmXHJcbiAgICAgICAgIShwYXRjaEZsYWcgJiAxNiAvKiBGVUxMX1BST1BTICovKSkge1xyXG4gICAgICAgIGlmIChwYXRjaEZsYWcgJiA4IC8qIFBST1BTICovKSB7XHJcbiAgICAgICAgICAgIC8vIENvbXBpbGVyLWdlbmVyYXRlZCBwcm9wcyAmIG5vIGtleXMgY2hhbmdlLCBqdXN0IHNldCB0aGUgdXBkYXRlZFxyXG4gICAgICAgICAgICAvLyB0aGUgcHJvcHMuXHJcbiAgICAgICAgICAgIGNvbnN0IHByb3BzVG9VcGRhdGUgPSBpbnN0YW5jZS52bm9kZS5keW5hbWljUHJvcHM7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcHJvcHNUb1VwZGF0ZS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgbGV0IGtleSA9IHByb3BzVG9VcGRhdGVbaV07XHJcbiAgICAgICAgICAgICAgICAvLyBQUk9QUyBmbGFnIGd1YXJhbnRlZXMgcmF3UHJvcHMgdG8gYmUgbm9uLW51bGxcclxuICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gcmF3UHJvcHNba2V5XTtcclxuICAgICAgICAgICAgICAgIGlmIChvcHRpb25zKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gYXR0ciAvIHByb3BzIHNlcGFyYXRpb24gd2FzIGRvbmUgb24gaW5pdCBhbmQgd2lsbCBiZSBjb25zaXN0ZW50XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gaW4gdGhpcyBjb2RlIHBhdGgsIHNvIGp1c3QgY2hlY2sgaWYgYXR0cnMgaGF2ZSBpdC5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoaGFzT3duKGF0dHJzLCBrZXkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gYXR0cnNba2V5XSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cnNba2V5XSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzQXR0cnNDaGFuZ2VkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2FtZWxpemVkS2V5ID0gY2FtZWxpemUoa2V5KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcHNbY2FtZWxpemVkS2V5XSA9IHJlc29sdmVQcm9wVmFsdWUob3B0aW9ucywgcmF3Q3VycmVudFByb3BzLCBjYW1lbGl6ZWRLZXksIHZhbHVlLCBpbnN0YW5jZSwgZmFsc2UgLyogaXNBYnNlbnQgKi8pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gYXR0cnNba2V5XSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhdHRyc1trZXldID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhc0F0dHJzQ2hhbmdlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgLy8gZnVsbCBwcm9wcyB1cGRhdGUuXHJcbiAgICAgICAgaWYgKHNldEZ1bGxQcm9wcyhpbnN0YW5jZSwgcmF3UHJvcHMsIHByb3BzLCBhdHRycykpIHtcclxuICAgICAgICAgICAgaGFzQXR0cnNDaGFuZ2VkID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gaW4gY2FzZSBvZiBkeW5hbWljIHByb3BzLCBjaGVjayBpZiB3ZSBuZWVkIHRvIGRlbGV0ZSBrZXlzIGZyb21cclxuICAgICAgICAvLyB0aGUgcHJvcHMgb2JqZWN0XHJcbiAgICAgICAgbGV0IGtlYmFiS2V5O1xyXG4gICAgICAgIGZvciAoY29uc3Qga2V5IGluIHJhd0N1cnJlbnRQcm9wcykge1xyXG4gICAgICAgICAgICBpZiAoIXJhd1Byb3BzIHx8XHJcbiAgICAgICAgICAgICAgICAvLyBmb3IgY2FtZWxDYXNlXHJcbiAgICAgICAgICAgICAgICAoIWhhc093bihyYXdQcm9wcywga2V5KSAmJlxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGl0J3MgcG9zc2libGUgdGhlIG9yaWdpbmFsIHByb3BzIHdhcyBwYXNzZWQgaW4gYXMga2ViYWItY2FzZVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGFuZCBjb252ZXJ0ZWQgdG8gY2FtZWxDYXNlICgjOTU1KVxyXG4gICAgICAgICAgICAgICAgICAgICgoa2ViYWJLZXkgPSBoeXBoZW5hdGUoa2V5KSkgPT09IGtleSB8fCAhaGFzT3duKHJhd1Byb3BzLCBrZWJhYktleSkpKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocmF3UHJldlByb3BzICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGZvciBjYW1lbENhc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgKHJhd1ByZXZQcm9wc1trZXldICE9PSB1bmRlZmluZWQgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGZvciBrZWJhYi1jYXNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYXdQcmV2UHJvcHNba2ViYWJLZXldICE9PSB1bmRlZmluZWQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BzW2tleV0gPSByZXNvbHZlUHJvcFZhbHVlKG9wdGlvbnMsIHJhd0N1cnJlbnRQcm9wcywga2V5LCB1bmRlZmluZWQsIGluc3RhbmNlLCB0cnVlIC8qIGlzQWJzZW50ICovKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBkZWxldGUgcHJvcHNba2V5XTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBpbiB0aGUgY2FzZSBvZiBmdW5jdGlvbmFsIGNvbXBvbmVudCB3L28gcHJvcHMgZGVjbGFyYXRpb24sIHByb3BzIGFuZFxyXG4gICAgICAgIC8vIGF0dHJzIHBvaW50IHRvIHRoZSBzYW1lIG9iamVjdCBzbyBpdCBzaG91bGQgYWxyZWFkeSBoYXZlIGJlZW4gdXBkYXRlZC5cclxuICAgICAgICBpZiAoYXR0cnMgIT09IHJhd0N1cnJlbnRQcm9wcykge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBhdHRycykge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFyYXdQcm9wcyB8fFxyXG4gICAgICAgICAgICAgICAgICAgICghaGFzT3duKHJhd1Byb3BzLCBrZXkpICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICghZmFsc2UgKSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBkZWxldGUgYXR0cnNba2V5XTtcclxuICAgICAgICAgICAgICAgICAgICBoYXNBdHRyc0NoYW5nZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8gdHJpZ2dlciB1cGRhdGVzIGZvciAkYXR0cnMgaW4gY2FzZSBpdCdzIHVzZWQgaW4gY29tcG9uZW50IHNsb3RzXHJcbiAgICBpZiAoaGFzQXR0cnNDaGFuZ2VkKSB7XHJcbiAgICAgICAgdHJpZ2dlcihpbnN0YW5jZSwgXCJzZXRcIiAvKiBTRVQgKi8sICckYXR0cnMnKTtcclxuICAgIH1cclxuICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICB2YWxpZGF0ZVByb3BzKHJhd1Byb3BzIHx8IHt9LCBwcm9wcywgaW5zdGFuY2UpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHNldEZ1bGxQcm9wcyhpbnN0YW5jZSwgcmF3UHJvcHMsIHByb3BzLCBhdHRycykge1xyXG4gICAgY29uc3QgW29wdGlvbnMsIG5lZWRDYXN0S2V5c10gPSBpbnN0YW5jZS5wcm9wc09wdGlvbnM7XHJcbiAgICBsZXQgaGFzQXR0cnNDaGFuZ2VkID0gZmFsc2U7XHJcbiAgICBsZXQgcmF3Q2FzdFZhbHVlcztcclxuICAgIGlmIChyYXdQcm9wcykge1xyXG4gICAgICAgIGZvciAobGV0IGtleSBpbiByYXdQcm9wcykge1xyXG4gICAgICAgICAgICAvLyBrZXksIHJlZiBhcmUgcmVzZXJ2ZWQgYW5kIG5ldmVyIHBhc3NlZCBkb3duXHJcbiAgICAgICAgICAgIGlmIChpc1Jlc2VydmVkUHJvcChrZXkpKSB7XHJcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHJhd1Byb3BzW2tleV07XHJcbiAgICAgICAgICAgIC8vIHByb3Agb3B0aW9uIG5hbWVzIGFyZSBjYW1lbGl6ZWQgZHVyaW5nIG5vcm1hbGl6YXRpb24sIHNvIHRvIHN1cHBvcnRcclxuICAgICAgICAgICAgLy8ga2ViYWIgLT4gY2FtZWwgY29udmVyc2lvbiBoZXJlIHdlIG5lZWQgdG8gY2FtZWxpemUgdGhlIGtleS5cclxuICAgICAgICAgICAgbGV0IGNhbWVsS2V5O1xyXG4gICAgICAgICAgICBpZiAob3B0aW9ucyAmJiBoYXNPd24ob3B0aW9ucywgKGNhbWVsS2V5ID0gY2FtZWxpemUoa2V5KSkpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIW5lZWRDYXN0S2V5cyB8fCAhbmVlZENhc3RLZXlzLmluY2x1ZGVzKGNhbWVsS2V5KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHByb3BzW2NhbWVsS2V5XSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgKHJhd0Nhc3RWYWx1ZXMgfHwgKHJhd0Nhc3RWYWx1ZXMgPSB7fSkpW2NhbWVsS2V5XSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKCFpc0VtaXRMaXN0ZW5lcihpbnN0YW5jZS5lbWl0c09wdGlvbnMsIGtleSkpIHtcclxuICAgICAgICAgICAgICAgIGlmICghKGtleSBpbiBhdHRycykgfHwgdmFsdWUgIT09IGF0dHJzW2tleV0pIHtcclxuICAgICAgICAgICAgICAgICAgICBhdHRyc1trZXldID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgaGFzQXR0cnNDaGFuZ2VkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGlmIChuZWVkQ2FzdEtleXMpIHtcclxuICAgICAgICBjb25zdCByYXdDdXJyZW50UHJvcHMgPSB0b1Jhdyhwcm9wcyk7XHJcbiAgICAgICAgY29uc3QgY2FzdFZhbHVlcyA9IHJhd0Nhc3RWYWx1ZXMgfHwgRU1QVFlfT0JKO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbmVlZENhc3RLZXlzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGtleSA9IG5lZWRDYXN0S2V5c1tpXTtcclxuICAgICAgICAgICAgcHJvcHNba2V5XSA9IHJlc29sdmVQcm9wVmFsdWUob3B0aW9ucywgcmF3Q3VycmVudFByb3BzLCBrZXksIGNhc3RWYWx1ZXNba2V5XSwgaW5zdGFuY2UsICFoYXNPd24oY2FzdFZhbHVlcywga2V5KSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGhhc0F0dHJzQ2hhbmdlZDtcclxufVxyXG5mdW5jdGlvbiByZXNvbHZlUHJvcFZhbHVlKG9wdGlvbnMsIHByb3BzLCBrZXksIHZhbHVlLCBpbnN0YW5jZSwgaXNBYnNlbnQpIHtcclxuICAgIGNvbnN0IG9wdCA9IG9wdGlvbnNba2V5XTtcclxuICAgIGlmIChvcHQgIT0gbnVsbCkge1xyXG4gICAgICAgIGNvbnN0IGhhc0RlZmF1bHQgPSBoYXNPd24ob3B0LCAnZGVmYXVsdCcpO1xyXG4gICAgICAgIC8vIGRlZmF1bHQgdmFsdWVzXHJcbiAgICAgICAgaWYgKGhhc0RlZmF1bHQgJiYgdmFsdWUgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBjb25zdCBkZWZhdWx0VmFsdWUgPSBvcHQuZGVmYXVsdDtcclxuICAgICAgICAgICAgaWYgKG9wdC50eXBlICE9PSBGdW5jdGlvbiAmJiBpc0Z1bmN0aW9uKGRlZmF1bHRWYWx1ZSkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHsgcHJvcHNEZWZhdWx0cyB9ID0gaW5zdGFuY2U7XHJcbiAgICAgICAgICAgICAgICBpZiAoa2V5IGluIHByb3BzRGVmYXVsdHMpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHByb3BzRGVmYXVsdHNba2V5XTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHNldEN1cnJlbnRJbnN0YW5jZShpbnN0YW5jZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBwcm9wc0RlZmF1bHRzW2tleV0gPSBkZWZhdWx0VmFsdWUuY2FsbChudWxsLCBwcm9wcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdW5zZXRDdXJyZW50SW5zdGFuY2UoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHZhbHVlID0gZGVmYXVsdFZhbHVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGJvb2xlYW4gY2FzdGluZ1xyXG4gICAgICAgIGlmIChvcHRbMCAvKiBzaG91bGRDYXN0ICovXSkge1xyXG4gICAgICAgICAgICBpZiAoaXNBYnNlbnQgJiYgIWhhc0RlZmF1bHQpIHtcclxuICAgICAgICAgICAgICAgIHZhbHVlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAob3B0WzEgLyogc2hvdWxkQ2FzdFRydWUgKi9dICYmXHJcbiAgICAgICAgICAgICAgICAodmFsdWUgPT09ICcnIHx8IHZhbHVlID09PSBoeXBoZW5hdGUoa2V5KSkpIHtcclxuICAgICAgICAgICAgICAgIHZhbHVlID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiB2YWx1ZTtcclxufVxyXG5mdW5jdGlvbiBub3JtYWxpemVQcm9wc09wdGlvbnMoY29tcCwgYXBwQ29udGV4dCwgYXNNaXhpbiA9IGZhbHNlKSB7XHJcbiAgICBjb25zdCBjYWNoZSA9IGFwcENvbnRleHQucHJvcHNDYWNoZTtcclxuICAgIGNvbnN0IGNhY2hlZCA9IGNhY2hlLmdldChjb21wKTtcclxuICAgIGlmIChjYWNoZWQpIHtcclxuICAgICAgICByZXR1cm4gY2FjaGVkO1xyXG4gICAgfVxyXG4gICAgY29uc3QgcmF3ID0gY29tcC5wcm9wcztcclxuICAgIGNvbnN0IG5vcm1hbGl6ZWQgPSB7fTtcclxuICAgIGNvbnN0IG5lZWRDYXN0S2V5cyA9IFtdO1xyXG4gICAgLy8gYXBwbHkgbWl4aW4vZXh0ZW5kcyBwcm9wc1xyXG4gICAgbGV0IGhhc0V4dGVuZHMgPSBmYWxzZTtcclxuICAgIGlmIChfX1ZVRV9PUFRJT05TX0FQSV9fICYmICFpc0Z1bmN0aW9uKGNvbXApKSB7XHJcbiAgICAgICAgY29uc3QgZXh0ZW5kUHJvcHMgPSAocmF3KSA9PiB7XHJcbiAgICAgICAgICAgIGhhc0V4dGVuZHMgPSB0cnVlO1xyXG4gICAgICAgICAgICBjb25zdCBbcHJvcHMsIGtleXNdID0gbm9ybWFsaXplUHJvcHNPcHRpb25zKHJhdywgYXBwQ29udGV4dCwgdHJ1ZSk7XHJcbiAgICAgICAgICAgIGV4dGVuZChub3JtYWxpemVkLCBwcm9wcyk7XHJcbiAgICAgICAgICAgIGlmIChrZXlzKVxyXG4gICAgICAgICAgICAgICAgbmVlZENhc3RLZXlzLnB1c2goLi4ua2V5cyk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBpZiAoIWFzTWl4aW4gJiYgYXBwQ29udGV4dC5taXhpbnMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGFwcENvbnRleHQubWl4aW5zLmZvckVhY2goZXh0ZW5kUHJvcHMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY29tcC5leHRlbmRzKSB7XHJcbiAgICAgICAgICAgIGV4dGVuZFByb3BzKGNvbXAuZXh0ZW5kcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChjb21wLm1peGlucykge1xyXG4gICAgICAgICAgICBjb21wLm1peGlucy5mb3JFYWNoKGV4dGVuZFByb3BzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAoIXJhdyAmJiAhaGFzRXh0ZW5kcykge1xyXG4gICAgICAgIGNhY2hlLnNldChjb21wLCBFTVBUWV9BUlIpO1xyXG4gICAgICAgIHJldHVybiBFTVBUWV9BUlI7XHJcbiAgICB9XHJcbiAgICBpZiAoaXNBcnJheShyYXcpKSB7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByYXcubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiAhaXNTdHJpbmcocmF3W2ldKSkge1xyXG4gICAgICAgICAgICAgICAgd2FybihgcHJvcHMgbXVzdCBiZSBzdHJpbmdzIHdoZW4gdXNpbmcgYXJyYXkgc3ludGF4LmAsIHJhd1tpXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3Qgbm9ybWFsaXplZEtleSA9IGNhbWVsaXplKHJhd1tpXSk7XHJcbiAgICAgICAgICAgIGlmICh2YWxpZGF0ZVByb3BOYW1lKG5vcm1hbGl6ZWRLZXkpKSB7XHJcbiAgICAgICAgICAgICAgICBub3JtYWxpemVkW25vcm1hbGl6ZWRLZXldID0gRU1QVFlfT0JKO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAocmF3KSB7XHJcbiAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiAhaXNPYmplY3QocmF3KSkge1xyXG4gICAgICAgICAgICB3YXJuKGBpbnZhbGlkIHByb3BzIG9wdGlvbnNgLCByYXcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiByYXcpIHtcclxuICAgICAgICAgICAgY29uc3Qgbm9ybWFsaXplZEtleSA9IGNhbWVsaXplKGtleSk7XHJcbiAgICAgICAgICAgIGlmICh2YWxpZGF0ZVByb3BOYW1lKG5vcm1hbGl6ZWRLZXkpKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvcHQgPSByYXdba2V5XTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHByb3AgPSAobm9ybWFsaXplZFtub3JtYWxpemVkS2V5XSA9XHJcbiAgICAgICAgICAgICAgICAgICAgaXNBcnJheShvcHQpIHx8IGlzRnVuY3Rpb24ob3B0KSA/IHsgdHlwZTogb3B0IH0gOiBvcHQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHByb3ApIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBib29sZWFuSW5kZXggPSBnZXRUeXBlSW5kZXgoQm9vbGVhbiwgcHJvcC50eXBlKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJpbmdJbmRleCA9IGdldFR5cGVJbmRleChTdHJpbmcsIHByb3AudHlwZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJvcFswIC8qIHNob3VsZENhc3QgKi9dID0gYm9vbGVhbkluZGV4ID4gLTE7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJvcFsxIC8qIHNob3VsZENhc3RUcnVlICovXSA9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0cmluZ0luZGV4IDwgMCB8fCBib29sZWFuSW5kZXggPCBzdHJpbmdJbmRleDtcclxuICAgICAgICAgICAgICAgICAgICAvLyBpZiB0aGUgcHJvcCBuZWVkcyBib29sZWFuIGNhc3Rpbmcgb3IgZGVmYXVsdCB2YWx1ZVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChib29sZWFuSW5kZXggPiAtMSB8fCBoYXNPd24ocHJvcCwgJ2RlZmF1bHQnKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZWVkQ2FzdEtleXMucHVzaChub3JtYWxpemVkS2V5KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBjb25zdCByZXMgPSBbbm9ybWFsaXplZCwgbmVlZENhc3RLZXlzXTtcclxuICAgIGNhY2hlLnNldChjb21wLCByZXMpO1xyXG4gICAgcmV0dXJuIHJlcztcclxufVxyXG5mdW5jdGlvbiB2YWxpZGF0ZVByb3BOYW1lKGtleSkge1xyXG4gICAgaWYgKGtleVswXSAhPT0gJyQnKSB7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICB3YXJuKGBJbnZhbGlkIHByb3AgbmFtZTogXCIke2tleX1cIiBpcyBhIHJlc2VydmVkIHByb3BlcnR5LmApO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG59XHJcbi8vIHVzZSBmdW5jdGlvbiBzdHJpbmcgbmFtZSB0byBjaGVjayB0eXBlIGNvbnN0cnVjdG9yc1xyXG4vLyBzbyB0aGF0IGl0IHdvcmtzIGFjcm9zcyB2bXMgLyBpZnJhbWVzLlxyXG5mdW5jdGlvbiBnZXRUeXBlKGN0b3IpIHtcclxuICAgIGNvbnN0IG1hdGNoID0gY3RvciAmJiBjdG9yLnRvU3RyaW5nKCkubWF0Y2goL15cXHMqZnVuY3Rpb24gKFxcdyspLyk7XHJcbiAgICByZXR1cm4gbWF0Y2ggPyBtYXRjaFsxXSA6IGN0b3IgPT09IG51bGwgPyAnbnVsbCcgOiAnJztcclxufVxyXG5mdW5jdGlvbiBpc1NhbWVUeXBlKGEsIGIpIHtcclxuICAgIHJldHVybiBnZXRUeXBlKGEpID09PSBnZXRUeXBlKGIpO1xyXG59XHJcbmZ1bmN0aW9uIGdldFR5cGVJbmRleCh0eXBlLCBleHBlY3RlZFR5cGVzKSB7XHJcbiAgICBpZiAoaXNBcnJheShleHBlY3RlZFR5cGVzKSkge1xyXG4gICAgICAgIHJldHVybiBleHBlY3RlZFR5cGVzLmZpbmRJbmRleCh0ID0+IGlzU2FtZVR5cGUodCwgdHlwZSkpO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoaXNGdW5jdGlvbihleHBlY3RlZFR5cGVzKSkge1xyXG4gICAgICAgIHJldHVybiBpc1NhbWVUeXBlKGV4cGVjdGVkVHlwZXMsIHR5cGUpID8gMCA6IC0xO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIC0xO1xyXG59XHJcbi8qKlxyXG4gKiBkZXYgb25seVxyXG4gKi9cclxuZnVuY3Rpb24gdmFsaWRhdGVQcm9wcyhyYXdQcm9wcywgcHJvcHMsIGluc3RhbmNlKSB7XHJcbiAgICBjb25zdCByZXNvbHZlZFZhbHVlcyA9IHRvUmF3KHByb3BzKTtcclxuICAgIGNvbnN0IG9wdGlvbnMgPSBpbnN0YW5jZS5wcm9wc09wdGlvbnNbMF07XHJcbiAgICBmb3IgKGNvbnN0IGtleSBpbiBvcHRpb25zKSB7XHJcbiAgICAgICAgbGV0IG9wdCA9IG9wdGlvbnNba2V5XTtcclxuICAgICAgICBpZiAob3B0ID09IG51bGwpXHJcbiAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgIHZhbGlkYXRlUHJvcChrZXksIHJlc29sdmVkVmFsdWVzW2tleV0sIG9wdCwgIWhhc093bihyYXdQcm9wcywga2V5KSAmJiAhaGFzT3duKHJhd1Byb3BzLCBoeXBoZW5hdGUoa2V5KSkpO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBkZXYgb25seVxyXG4gKi9cclxuZnVuY3Rpb24gdmFsaWRhdGVQcm9wKG5hbWUsIHZhbHVlLCBwcm9wLCBpc0Fic2VudCkge1xyXG4gICAgY29uc3QgeyB0eXBlLCByZXF1aXJlZCwgdmFsaWRhdG9yIH0gPSBwcm9wO1xyXG4gICAgLy8gcmVxdWlyZWQhXHJcbiAgICBpZiAocmVxdWlyZWQgJiYgaXNBYnNlbnQpIHtcclxuICAgICAgICB3YXJuKCdNaXNzaW5nIHJlcXVpcmVkIHByb3A6IFwiJyArIG5hbWUgKyAnXCInKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICAvLyBtaXNzaW5nIGJ1dCBvcHRpb25hbFxyXG4gICAgaWYgKHZhbHVlID09IG51bGwgJiYgIXByb3AucmVxdWlyZWQpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICAvLyB0eXBlIGNoZWNrXHJcbiAgICBpZiAodHlwZSAhPSBudWxsICYmIHR5cGUgIT09IHRydWUpIHtcclxuICAgICAgICBsZXQgaXNWYWxpZCA9IGZhbHNlO1xyXG4gICAgICAgIGNvbnN0IHR5cGVzID0gaXNBcnJheSh0eXBlKSA/IHR5cGUgOiBbdHlwZV07XHJcbiAgICAgICAgY29uc3QgZXhwZWN0ZWRUeXBlcyA9IFtdO1xyXG4gICAgICAgIC8vIHZhbHVlIGlzIHZhbGlkIGFzIGxvbmcgYXMgb25lIG9mIHRoZSBzcGVjaWZpZWQgdHlwZXMgbWF0Y2hcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHR5cGVzLmxlbmd0aCAmJiAhaXNWYWxpZDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHsgdmFsaWQsIGV4cGVjdGVkVHlwZSB9ID0gYXNzZXJ0VHlwZSh2YWx1ZSwgdHlwZXNbaV0pO1xyXG4gICAgICAgICAgICBleHBlY3RlZFR5cGVzLnB1c2goZXhwZWN0ZWRUeXBlIHx8ICcnKTtcclxuICAgICAgICAgICAgaXNWYWxpZCA9IHZhbGlkO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIWlzVmFsaWQpIHtcclxuICAgICAgICAgICAgd2FybihnZXRJbnZhbGlkVHlwZU1lc3NhZ2UobmFtZSwgdmFsdWUsIGV4cGVjdGVkVHlwZXMpKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8vIGN1c3RvbSB2YWxpZGF0b3JcclxuICAgIGlmICh2YWxpZGF0b3IgJiYgIXZhbGlkYXRvcih2YWx1ZSkpIHtcclxuICAgICAgICB3YXJuKCdJbnZhbGlkIHByb3A6IGN1c3RvbSB2YWxpZGF0b3IgY2hlY2sgZmFpbGVkIGZvciBwcm9wIFwiJyArIG5hbWUgKyAnXCIuJyk7XHJcbiAgICB9XHJcbn1cclxuY29uc3QgaXNTaW1wbGVUeXBlID0gLyojX19QVVJFX18qLyBtYWtlTWFwKCdTdHJpbmcsTnVtYmVyLEJvb2xlYW4sRnVuY3Rpb24sU3ltYm9sLEJpZ0ludCcpO1xyXG4vKipcclxuICogZGV2IG9ubHlcclxuICovXHJcbmZ1bmN0aW9uIGFzc2VydFR5cGUodmFsdWUsIHR5cGUpIHtcclxuICAgIGxldCB2YWxpZDtcclxuICAgIGNvbnN0IGV4cGVjdGVkVHlwZSA9IGdldFR5cGUodHlwZSk7XHJcbiAgICBpZiAoaXNTaW1wbGVUeXBlKGV4cGVjdGVkVHlwZSkpIHtcclxuICAgICAgICBjb25zdCB0ID0gdHlwZW9mIHZhbHVlO1xyXG4gICAgICAgIHZhbGlkID0gdCA9PT0gZXhwZWN0ZWRUeXBlLnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgICAgLy8gZm9yIHByaW1pdGl2ZSB3cmFwcGVyIG9iamVjdHNcclxuICAgICAgICBpZiAoIXZhbGlkICYmIHQgPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgICAgIHZhbGlkID0gdmFsdWUgaW5zdGFuY2VvZiB0eXBlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGV4cGVjdGVkVHlwZSA9PT0gJ09iamVjdCcpIHtcclxuICAgICAgICB2YWxpZCA9IGlzT2JqZWN0KHZhbHVlKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGV4cGVjdGVkVHlwZSA9PT0gJ0FycmF5Jykge1xyXG4gICAgICAgIHZhbGlkID0gaXNBcnJheSh2YWx1ZSk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChleHBlY3RlZFR5cGUgPT09ICdudWxsJykge1xyXG4gICAgICAgIHZhbGlkID0gdmFsdWUgPT09IG51bGw7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICB2YWxpZCA9IHZhbHVlIGluc3RhbmNlb2YgdHlwZTtcclxuICAgIH1cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgdmFsaWQsXHJcbiAgICAgICAgZXhwZWN0ZWRUeXBlXHJcbiAgICB9O1xyXG59XHJcbi8qKlxyXG4gKiBkZXYgb25seVxyXG4gKi9cclxuZnVuY3Rpb24gZ2V0SW52YWxpZFR5cGVNZXNzYWdlKG5hbWUsIHZhbHVlLCBleHBlY3RlZFR5cGVzKSB7XHJcbiAgICBsZXQgbWVzc2FnZSA9IGBJbnZhbGlkIHByb3A6IHR5cGUgY2hlY2sgZmFpbGVkIGZvciBwcm9wIFwiJHtuYW1lfVwiLmAgK1xyXG4gICAgICAgIGAgRXhwZWN0ZWQgJHtleHBlY3RlZFR5cGVzLm1hcChjYXBpdGFsaXplKS5qb2luKCcgfCAnKX1gO1xyXG4gICAgY29uc3QgZXhwZWN0ZWRUeXBlID0gZXhwZWN0ZWRUeXBlc1swXTtcclxuICAgIGNvbnN0IHJlY2VpdmVkVHlwZSA9IHRvUmF3VHlwZSh2YWx1ZSk7XHJcbiAgICBjb25zdCBleHBlY3RlZFZhbHVlID0gc3R5bGVWYWx1ZSh2YWx1ZSwgZXhwZWN0ZWRUeXBlKTtcclxuICAgIGNvbnN0IHJlY2VpdmVkVmFsdWUgPSBzdHlsZVZhbHVlKHZhbHVlLCByZWNlaXZlZFR5cGUpO1xyXG4gICAgLy8gY2hlY2sgaWYgd2UgbmVlZCB0byBzcGVjaWZ5IGV4cGVjdGVkIHZhbHVlXHJcbiAgICBpZiAoZXhwZWN0ZWRUeXBlcy5sZW5ndGggPT09IDEgJiZcclxuICAgICAgICBpc0V4cGxpY2FibGUoZXhwZWN0ZWRUeXBlKSAmJlxyXG4gICAgICAgICFpc0Jvb2xlYW4oZXhwZWN0ZWRUeXBlLCByZWNlaXZlZFR5cGUpKSB7XHJcbiAgICAgICAgbWVzc2FnZSArPSBgIHdpdGggdmFsdWUgJHtleHBlY3RlZFZhbHVlfWA7XHJcbiAgICB9XHJcbiAgICBtZXNzYWdlICs9IGAsIGdvdCAke3JlY2VpdmVkVHlwZX0gYDtcclxuICAgIC8vIGNoZWNrIGlmIHdlIG5lZWQgdG8gc3BlY2lmeSByZWNlaXZlZCB2YWx1ZVxyXG4gICAgaWYgKGlzRXhwbGljYWJsZShyZWNlaXZlZFR5cGUpKSB7XHJcbiAgICAgICAgbWVzc2FnZSArPSBgd2l0aCB2YWx1ZSAke3JlY2VpdmVkVmFsdWV9LmA7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbWVzc2FnZTtcclxufVxyXG4vKipcclxuICogZGV2IG9ubHlcclxuICovXHJcbmZ1bmN0aW9uIHN0eWxlVmFsdWUodmFsdWUsIHR5cGUpIHtcclxuICAgIGlmICh0eXBlID09PSAnU3RyaW5nJykge1xyXG4gICAgICAgIHJldHVybiBgXCIke3ZhbHVlfVwiYDtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKHR5cGUgPT09ICdOdW1iZXInKSB7XHJcbiAgICAgICAgcmV0dXJuIGAke051bWJlcih2YWx1ZSl9YDtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBgJHt2YWx1ZX1gO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBkZXYgb25seVxyXG4gKi9cclxuZnVuY3Rpb24gaXNFeHBsaWNhYmxlKHR5cGUpIHtcclxuICAgIGNvbnN0IGV4cGxpY2l0VHlwZXMgPSBbJ3N0cmluZycsICdudW1iZXInLCAnYm9vbGVhbiddO1xyXG4gICAgcmV0dXJuIGV4cGxpY2l0VHlwZXMuc29tZShlbGVtID0+IHR5cGUudG9Mb3dlckNhc2UoKSA9PT0gZWxlbSk7XHJcbn1cclxuLyoqXHJcbiAqIGRldiBvbmx5XHJcbiAqL1xyXG5mdW5jdGlvbiBpc0Jvb2xlYW4oLi4uYXJncykge1xyXG4gICAgcmV0dXJuIGFyZ3Muc29tZShlbGVtID0+IGVsZW0udG9Mb3dlckNhc2UoKSA9PT0gJ2Jvb2xlYW4nKTtcclxufVxuXG5jb25zdCBpc0ludGVybmFsS2V5ID0gKGtleSkgPT4ga2V5WzBdID09PSAnXycgfHwga2V5ID09PSAnJHN0YWJsZSc7XHJcbmNvbnN0IG5vcm1hbGl6ZVNsb3RWYWx1ZSA9ICh2YWx1ZSkgPT4gaXNBcnJheSh2YWx1ZSlcclxuICAgID8gdmFsdWUubWFwKG5vcm1hbGl6ZVZOb2RlKVxyXG4gICAgOiBbbm9ybWFsaXplVk5vZGUodmFsdWUpXTtcclxuY29uc3Qgbm9ybWFsaXplU2xvdCA9IChrZXksIHJhd1Nsb3QsIGN0eCkgPT4ge1xyXG4gICAgY29uc3Qgbm9ybWFsaXplZCA9IHdpdGhDdHgoKC4uLmFyZ3MpID0+IHtcclxuICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmIGN1cnJlbnRJbnN0YW5jZSkge1xyXG4gICAgICAgICAgICB3YXJuKGBTbG90IFwiJHtrZXl9XCIgaW52b2tlZCBvdXRzaWRlIG9mIHRoZSByZW5kZXIgZnVuY3Rpb246IGAgK1xyXG4gICAgICAgICAgICAgICAgYHRoaXMgd2lsbCBub3QgdHJhY2sgZGVwZW5kZW5jaWVzIHVzZWQgaW4gdGhlIHNsb3QuIGAgK1xyXG4gICAgICAgICAgICAgICAgYEludm9rZSB0aGUgc2xvdCBmdW5jdGlvbiBpbnNpZGUgdGhlIHJlbmRlciBmdW5jdGlvbiBpbnN0ZWFkLmApO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbm9ybWFsaXplU2xvdFZhbHVlKHJhd1Nsb3QoLi4uYXJncykpO1xyXG4gICAgfSwgY3R4KTtcclxuICAgIG5vcm1hbGl6ZWQuX2MgPSBmYWxzZTtcclxuICAgIHJldHVybiBub3JtYWxpemVkO1xyXG59O1xyXG5jb25zdCBub3JtYWxpemVPYmplY3RTbG90cyA9IChyYXdTbG90cywgc2xvdHMsIGluc3RhbmNlKSA9PiB7XHJcbiAgICBjb25zdCBjdHggPSByYXdTbG90cy5fY3R4O1xyXG4gICAgZm9yIChjb25zdCBrZXkgaW4gcmF3U2xvdHMpIHtcclxuICAgICAgICBpZiAoaXNJbnRlcm5hbEtleShrZXkpKVxyXG4gICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICBjb25zdCB2YWx1ZSA9IHJhd1Nsb3RzW2tleV07XHJcbiAgICAgICAgaWYgKGlzRnVuY3Rpb24odmFsdWUpKSB7XHJcbiAgICAgICAgICAgIHNsb3RzW2tleV0gPSBub3JtYWxpemVTbG90KGtleSwgdmFsdWUsIGN0eCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHZhbHVlICE9IG51bGwpIHtcclxuICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJlxyXG4gICAgICAgICAgICAgICAgIShmYWxzZSApKSB7XHJcbiAgICAgICAgICAgICAgICB3YXJuKGBOb24tZnVuY3Rpb24gdmFsdWUgZW5jb3VudGVyZWQgZm9yIHNsb3QgXCIke2tleX1cIi4gYCArXHJcbiAgICAgICAgICAgICAgICAgICAgYFByZWZlciBmdW5jdGlvbiBzbG90cyBmb3IgYmV0dGVyIHBlcmZvcm1hbmNlLmApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IG5vcm1hbGl6ZWQgPSBub3JtYWxpemVTbG90VmFsdWUodmFsdWUpO1xyXG4gICAgICAgICAgICBzbG90c1trZXldID0gKCkgPT4gbm9ybWFsaXplZDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn07XHJcbmNvbnN0IG5vcm1hbGl6ZVZOb2RlU2xvdHMgPSAoaW5zdGFuY2UsIGNoaWxkcmVuKSA9PiB7XHJcbiAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmXHJcbiAgICAgICAgIWlzS2VlcEFsaXZlKGluc3RhbmNlLnZub2RlKSAmJlxyXG4gICAgICAgICEoZmFsc2UgKSkge1xyXG4gICAgICAgIHdhcm4oYE5vbi1mdW5jdGlvbiB2YWx1ZSBlbmNvdW50ZXJlZCBmb3IgZGVmYXVsdCBzbG90LiBgICtcclxuICAgICAgICAgICAgYFByZWZlciBmdW5jdGlvbiBzbG90cyBmb3IgYmV0dGVyIHBlcmZvcm1hbmNlLmApO1xyXG4gICAgfVxyXG4gICAgY29uc3Qgbm9ybWFsaXplZCA9IG5vcm1hbGl6ZVNsb3RWYWx1ZShjaGlsZHJlbik7XHJcbiAgICBpbnN0YW5jZS5zbG90cy5kZWZhdWx0ID0gKCkgPT4gbm9ybWFsaXplZDtcclxufTtcclxuY29uc3QgaW5pdFNsb3RzID0gKGluc3RhbmNlLCBjaGlsZHJlbikgPT4ge1xyXG4gICAgaWYgKGluc3RhbmNlLnZub2RlLnNoYXBlRmxhZyAmIDMyIC8qIFNMT1RTX0NISUxEUkVOICovKSB7XHJcbiAgICAgICAgY29uc3QgdHlwZSA9IGNoaWxkcmVuLl87XHJcbiAgICAgICAgaWYgKHR5cGUpIHtcclxuICAgICAgICAgICAgLy8gdXNlcnMgY2FuIGdldCB0aGUgc2hhbGxvdyByZWFkb25seSB2ZXJzaW9uIG9mIHRoZSBzbG90cyBvYmplY3QgdGhyb3VnaCBgdGhpcy4kc2xvdHNgLFxyXG4gICAgICAgICAgICAvLyB3ZSBzaG91bGQgYXZvaWQgdGhlIHByb3h5IG9iamVjdCBwb2xsdXRpbmcgdGhlIHNsb3RzIG9mIHRoZSBpbnRlcm5hbCBpbnN0YW5jZVxyXG4gICAgICAgICAgICBpbnN0YW5jZS5zbG90cyA9IHRvUmF3KGNoaWxkcmVuKTtcclxuICAgICAgICAgICAgLy8gbWFrZSBjb21waWxlciBtYXJrZXIgbm9uLWVudW1lcmFibGVcclxuICAgICAgICAgICAgZGVmKGNoaWxkcmVuLCAnXycsIHR5cGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgbm9ybWFsaXplT2JqZWN0U2xvdHMoY2hpbGRyZW4sIChpbnN0YW5jZS5zbG90cyA9IHt9KSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgaW5zdGFuY2Uuc2xvdHMgPSB7fTtcclxuICAgICAgICBpZiAoY2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgbm9ybWFsaXplVk5vZGVTbG90cyhpbnN0YW5jZSwgY2hpbGRyZW4pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGRlZihpbnN0YW5jZS5zbG90cywgSW50ZXJuYWxPYmplY3RLZXksIDEpO1xyXG59O1xyXG5jb25zdCB1cGRhdGVTbG90cyA9IChpbnN0YW5jZSwgY2hpbGRyZW4sIG9wdGltaXplZCkgPT4ge1xyXG4gICAgY29uc3QgeyB2bm9kZSwgc2xvdHMgfSA9IGluc3RhbmNlO1xyXG4gICAgbGV0IG5lZWREZWxldGlvbkNoZWNrID0gdHJ1ZTtcclxuICAgIGxldCBkZWxldGlvbkNvbXBhcmlzb25UYXJnZXQgPSBFTVBUWV9PQko7XHJcbiAgICBpZiAodm5vZGUuc2hhcGVGbGFnICYgMzIgLyogU0xPVFNfQ0hJTERSRU4gKi8pIHtcclxuICAgICAgICBjb25zdCB0eXBlID0gY2hpbGRyZW4uXztcclxuICAgICAgICBpZiAodHlwZSkge1xyXG4gICAgICAgICAgICAvLyBjb21waWxlZCBzbG90cy5cclxuICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiBpc0htclVwZGF0aW5nKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBQYXJlbnQgd2FzIEhNUiB1cGRhdGVkIHNvIHNsb3QgY29udGVudCBtYXkgaGF2ZSBjaGFuZ2VkLlxyXG4gICAgICAgICAgICAgICAgLy8gZm9yY2UgdXBkYXRlIHNsb3RzIGFuZCBtYXJrIGluc3RhbmNlIGZvciBobXIgYXMgd2VsbFxyXG4gICAgICAgICAgICAgICAgZXh0ZW5kKHNsb3RzLCBjaGlsZHJlbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAob3B0aW1pemVkICYmIHR5cGUgPT09IDEgLyogU1RBQkxFICovKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBjb21waWxlZCBBTkQgc3RhYmxlLlxyXG4gICAgICAgICAgICAgICAgLy8gbm8gbmVlZCB0byB1cGRhdGUsIGFuZCBza2lwIHN0YWxlIHNsb3RzIHJlbW92YWwuXHJcbiAgICAgICAgICAgICAgICBuZWVkRGVsZXRpb25DaGVjayA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gY29tcGlsZWQgYnV0IGR5bmFtaWMgKHYtaWYvdi1mb3Igb24gc2xvdHMpIC0gdXBkYXRlIHNsb3RzLCBidXQgc2tpcFxyXG4gICAgICAgICAgICAgICAgLy8gbm9ybWFsaXphdGlvbi5cclxuICAgICAgICAgICAgICAgIGV4dGVuZChzbG90cywgY2hpbGRyZW4pO1xyXG4gICAgICAgICAgICAgICAgLy8gIzI4OTNcclxuICAgICAgICAgICAgICAgIC8vIHdoZW4gcmVuZGVyaW5nIHRoZSBvcHRpbWl6ZWQgc2xvdHMgYnkgbWFudWFsbHkgd3JpdHRlbiByZW5kZXIgZnVuY3Rpb24sXHJcbiAgICAgICAgICAgICAgICAvLyB3ZSBuZWVkIHRvIGRlbGV0ZSB0aGUgYHNsb3RzLl9gIGZsYWcgaWYgbmVjZXNzYXJ5IHRvIG1ha2Ugc3Vic2VxdWVudCB1cGRhdGVzIHJlbGlhYmxlLFxyXG4gICAgICAgICAgICAgICAgLy8gaS5lLiBsZXQgdGhlIGByZW5kZXJTbG90YCBjcmVhdGUgdGhlIGJhaWxlZCBGcmFnbWVudFxyXG4gICAgICAgICAgICAgICAgaWYgKCFvcHRpbWl6ZWQgJiYgdHlwZSA9PT0gMSAvKiBTVEFCTEUgKi8pIHtcclxuICAgICAgICAgICAgICAgICAgICBkZWxldGUgc2xvdHMuXztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgbmVlZERlbGV0aW9uQ2hlY2sgPSAhY2hpbGRyZW4uJHN0YWJsZTtcclxuICAgICAgICAgICAgbm9ybWFsaXplT2JqZWN0U2xvdHMoY2hpbGRyZW4sIHNsb3RzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZGVsZXRpb25Db21wYXJpc29uVGFyZ2V0ID0gY2hpbGRyZW47XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChjaGlsZHJlbikge1xyXG4gICAgICAgIC8vIG5vbiBzbG90IG9iamVjdCBjaGlsZHJlbiAoZGlyZWN0IHZhbHVlKSBwYXNzZWQgdG8gYSBjb21wb25lbnRcclxuICAgICAgICBub3JtYWxpemVWTm9kZVNsb3RzKGluc3RhbmNlLCBjaGlsZHJlbik7XHJcbiAgICAgICAgZGVsZXRpb25Db21wYXJpc29uVGFyZ2V0ID0geyBkZWZhdWx0OiAxIH07XHJcbiAgICB9XHJcbiAgICAvLyBkZWxldGUgc3RhbGUgc2xvdHNcclxuICAgIGlmIChuZWVkRGVsZXRpb25DaGVjaykge1xyXG4gICAgICAgIGZvciAoY29uc3Qga2V5IGluIHNsb3RzKSB7XHJcbiAgICAgICAgICAgIGlmICghaXNJbnRlcm5hbEtleShrZXkpICYmICEoa2V5IGluIGRlbGV0aW9uQ29tcGFyaXNvblRhcmdldCkpIHtcclxuICAgICAgICAgICAgICAgIGRlbGV0ZSBzbG90c1trZXldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xuXG4vKipcclxuUnVudGltZSBoZWxwZXIgZm9yIGFwcGx5aW5nIGRpcmVjdGl2ZXMgdG8gYSB2bm9kZS4gRXhhbXBsZSB1c2FnZTpcclxuXG5jb25zdCBjb21wID0gcmVzb2x2ZUNvbXBvbmVudCgnY29tcCcpXHJcbmNvbnN0IGZvbyA9IHJlc29sdmVEaXJlY3RpdmUoJ2ZvbycpXHJcbmNvbnN0IGJhciA9IHJlc29sdmVEaXJlY3RpdmUoJ2JhcicpXHJcblxucmV0dXJuIHdpdGhEaXJlY3RpdmVzKGgoY29tcCksIFtcclxuICBbZm9vLCB0aGlzLnhdLFxyXG4gIFtiYXIsIHRoaXMueV1cclxuXSlcclxuKi9cclxuZnVuY3Rpb24gdmFsaWRhdGVEaXJlY3RpdmVOYW1lKG5hbWUpIHtcclxuICAgIGlmIChpc0J1aWx0SW5EaXJlY3RpdmUobmFtZSkpIHtcclxuICAgICAgICB3YXJuKCdEbyBub3QgdXNlIGJ1aWx0LWluIGRpcmVjdGl2ZSBpZHMgYXMgY3VzdG9tIGRpcmVjdGl2ZSBpZDogJyArIG5hbWUpO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBBZGRzIGRpcmVjdGl2ZXMgdG8gYSBWTm9kZS5cclxuICovXHJcbmZ1bmN0aW9uIHdpdGhEaXJlY3RpdmVzKHZub2RlLCBkaXJlY3RpdmVzKSB7XHJcbiAgICBjb25zdCBpbnRlcm5hbEluc3RhbmNlID0gY3VycmVudFJlbmRlcmluZ0luc3RhbmNlO1xyXG4gICAgaWYgKGludGVybmFsSW5zdGFuY2UgPT09IG51bGwpIHtcclxuICAgICAgICAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiYgd2Fybihgd2l0aERpcmVjdGl2ZXMgY2FuIG9ubHkgYmUgdXNlZCBpbnNpZGUgcmVuZGVyIGZ1bmN0aW9ucy5gKTtcclxuICAgICAgICByZXR1cm4gdm5vZGU7XHJcbiAgICB9XHJcbiAgICBjb25zdCBpbnN0YW5jZSA9IGludGVybmFsSW5zdGFuY2UucHJveHk7XHJcbiAgICBjb25zdCBiaW5kaW5ncyA9IHZub2RlLmRpcnMgfHwgKHZub2RlLmRpcnMgPSBbXSk7XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRpcmVjdGl2ZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBsZXQgW2RpciwgdmFsdWUsIGFyZywgbW9kaWZpZXJzID0gRU1QVFlfT0JKXSA9IGRpcmVjdGl2ZXNbaV07XHJcbiAgICAgICAgaWYgKGlzRnVuY3Rpb24oZGlyKSkge1xyXG4gICAgICAgICAgICBkaXIgPSB7XHJcbiAgICAgICAgICAgICAgICBtb3VudGVkOiBkaXIsXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkOiBkaXJcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGRpci5kZWVwKSB7XHJcbiAgICAgICAgICAgIHRyYXZlcnNlKHZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgYmluZGluZ3MucHVzaCh7XHJcbiAgICAgICAgICAgIGRpcixcclxuICAgICAgICAgICAgaW5zdGFuY2UsXHJcbiAgICAgICAgICAgIHZhbHVlLFxyXG4gICAgICAgICAgICBvbGRWYWx1ZTogdm9pZCAwLFxyXG4gICAgICAgICAgICBhcmcsXHJcbiAgICAgICAgICAgIG1vZGlmaWVyc1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHZub2RlO1xyXG59XHJcbmZ1bmN0aW9uIGludm9rZURpcmVjdGl2ZUhvb2sodm5vZGUsIHByZXZWTm9kZSwgaW5zdGFuY2UsIG5hbWUpIHtcclxuICAgIGNvbnN0IGJpbmRpbmdzID0gdm5vZGUuZGlycztcclxuICAgIGNvbnN0IG9sZEJpbmRpbmdzID0gcHJldlZOb2RlICYmIHByZXZWTm9kZS5kaXJzO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBiaW5kaW5ncy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGNvbnN0IGJpbmRpbmcgPSBiaW5kaW5nc1tpXTtcclxuICAgICAgICBpZiAob2xkQmluZGluZ3MpIHtcclxuICAgICAgICAgICAgYmluZGluZy5vbGRWYWx1ZSA9IG9sZEJpbmRpbmdzW2ldLnZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgaG9vayA9IGJpbmRpbmcuZGlyW25hbWVdO1xyXG4gICAgICAgIGlmIChob29rKSB7XHJcbiAgICAgICAgICAgIC8vIGRpc2FibGUgdHJhY2tpbmcgaW5zaWRlIGFsbCBsaWZlY3ljbGUgaG9va3NcclxuICAgICAgICAgICAgLy8gc2luY2UgdGhleSBjYW4gcG90ZW50aWFsbHkgYmUgY2FsbGVkIGluc2lkZSBlZmZlY3RzLlxyXG4gICAgICAgICAgICBwYXVzZVRyYWNraW5nKCk7XHJcbiAgICAgICAgICAgIGNhbGxXaXRoQXN5bmNFcnJvckhhbmRsaW5nKGhvb2ssIGluc3RhbmNlLCA4IC8qIERJUkVDVElWRV9IT09LICovLCBbXHJcbiAgICAgICAgICAgICAgICB2bm9kZS5lbCxcclxuICAgICAgICAgICAgICAgIGJpbmRpbmcsXHJcbiAgICAgICAgICAgICAgICB2bm9kZSxcclxuICAgICAgICAgICAgICAgIHByZXZWTm9kZVxyXG4gICAgICAgICAgICBdKTtcclxuICAgICAgICAgICAgcmVzZXRUcmFja2luZygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxuXG5mdW5jdGlvbiBjcmVhdGVBcHBDb250ZXh0KCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBhcHA6IG51bGwsXHJcbiAgICAgICAgY29uZmlnOiB7XHJcbiAgICAgICAgICAgIGlzTmF0aXZlVGFnOiBOTyxcclxuICAgICAgICAgICAgcGVyZm9ybWFuY2U6IGZhbHNlLFxyXG4gICAgICAgICAgICBnbG9iYWxQcm9wZXJ0aWVzOiB7fSxcclxuICAgICAgICAgICAgb3B0aW9uTWVyZ2VTdHJhdGVnaWVzOiB7fSxcclxuICAgICAgICAgICAgZXJyb3JIYW5kbGVyOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICAgIHdhcm5IYW5kbGVyOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICAgIGNvbXBpbGVyT3B0aW9uczoge31cclxuICAgICAgICB9LFxyXG4gICAgICAgIG1peGluczogW10sXHJcbiAgICAgICAgY29tcG9uZW50czoge30sXHJcbiAgICAgICAgZGlyZWN0aXZlczoge30sXHJcbiAgICAgICAgcHJvdmlkZXM6IE9iamVjdC5jcmVhdGUobnVsbCksXHJcbiAgICAgICAgb3B0aW9uc0NhY2hlOiBuZXcgV2Vha01hcCgpLFxyXG4gICAgICAgIHByb3BzQ2FjaGU6IG5ldyBXZWFrTWFwKCksXHJcbiAgICAgICAgZW1pdHNDYWNoZTogbmV3IFdlYWtNYXAoKVxyXG4gICAgfTtcclxufVxyXG5sZXQgdWlkID0gMDtcclxuZnVuY3Rpb24gY3JlYXRlQXBwQVBJKHJlbmRlciwgaHlkcmF0ZSkge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIGNyZWF0ZUFwcChyb290Q29tcG9uZW50LCByb290UHJvcHMgPSBudWxsKSB7XHJcbiAgICAgICAgaWYgKHJvb3RQcm9wcyAhPSBudWxsICYmICFpc09iamVjdChyb290UHJvcHMpKSB7XHJcbiAgICAgICAgICAgIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiB3YXJuKGByb290IHByb3BzIHBhc3NlZCB0byBhcHAubW91bnQoKSBtdXN0IGJlIGFuIG9iamVjdC5gKTtcclxuICAgICAgICAgICAgcm9vdFByb3BzID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgY29udGV4dCA9IGNyZWF0ZUFwcENvbnRleHQoKTtcclxuICAgICAgICBjb25zdCBpbnN0YWxsZWRQbHVnaW5zID0gbmV3IFNldCgpO1xyXG4gICAgICAgIGxldCBpc01vdW50ZWQgPSBmYWxzZTtcclxuICAgICAgICBjb25zdCBhcHAgPSAoY29udGV4dC5hcHAgPSB7XHJcbiAgICAgICAgICAgIF91aWQ6IHVpZCsrLFxyXG4gICAgICAgICAgICBfY29tcG9uZW50OiByb290Q29tcG9uZW50LFxyXG4gICAgICAgICAgICBfcHJvcHM6IHJvb3RQcm9wcyxcclxuICAgICAgICAgICAgX2NvbnRhaW5lcjogbnVsbCxcclxuICAgICAgICAgICAgX2NvbnRleHQ6IGNvbnRleHQsXHJcbiAgICAgICAgICAgIF9pbnN0YW5jZTogbnVsbCxcclxuICAgICAgICAgICAgdmVyc2lvbixcclxuICAgICAgICAgICAgZ2V0IGNvbmZpZygpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjb250ZXh0LmNvbmZpZztcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgc2V0IGNvbmZpZyh2KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgd2FybihgYXBwLmNvbmZpZyBjYW5ub3QgYmUgcmVwbGFjZWQuIE1vZGlmeSBpbmRpdmlkdWFsIG9wdGlvbnMgaW5zdGVhZC5gKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgdXNlKHBsdWdpbiwgLi4ub3B0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGluc3RhbGxlZFBsdWdpbnMuaGFzKHBsdWdpbikpIHtcclxuICAgICAgICAgICAgICAgICAgICAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiYgd2FybihgUGx1Z2luIGhhcyBhbHJlYWR5IGJlZW4gYXBwbGllZCB0byB0YXJnZXQgYXBwLmApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAocGx1Z2luICYmIGlzRnVuY3Rpb24ocGx1Z2luLmluc3RhbGwpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5zdGFsbGVkUGx1Z2lucy5hZGQocGx1Z2luKTtcclxuICAgICAgICAgICAgICAgICAgICBwbHVnaW4uaW5zdGFsbChhcHAsIC4uLm9wdGlvbnMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoaXNGdW5jdGlvbihwbHVnaW4pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5zdGFsbGVkUGx1Z2lucy5hZGQocGx1Z2luKTtcclxuICAgICAgICAgICAgICAgICAgICBwbHVnaW4oYXBwLCAuLi5vcHRpb25zKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHdhcm4oYEEgcGx1Z2luIG11c3QgZWl0aGVyIGJlIGEgZnVuY3Rpb24gb3IgYW4gb2JqZWN0IHdpdGggYW4gXCJpbnN0YWxsXCIgYCArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGBmdW5jdGlvbi5gKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBhcHA7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIG1peGluKG1peGluKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoX19WVUVfT1BUSU9OU19BUElfXykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghY29udGV4dC5taXhpbnMuaW5jbHVkZXMobWl4aW4pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQubWl4aW5zLnB1c2gobWl4aW4pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2FybignTWl4aW4gaGFzIGFscmVhZHkgYmVlbiBhcHBsaWVkIHRvIHRhcmdldCBhcHAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChtaXhpbi5uYW1lID8gYDogJHttaXhpbi5uYW1lfWAgOiAnJykpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHdhcm4oJ01peGlucyBhcmUgb25seSBhdmFpbGFibGUgaW4gYnVpbGRzIHN1cHBvcnRpbmcgT3B0aW9ucyBBUEknKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBhcHA7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGNvbXBvbmVudChuYW1lLCBjb21wb25lbnQpIHtcclxuICAgICAgICAgICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YWxpZGF0ZUNvbXBvbmVudE5hbWUobmFtZSwgY29udGV4dC5jb25maWcpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCFjb21wb25lbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29udGV4dC5jb21wb25lbnRzW25hbWVdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiBjb250ZXh0LmNvbXBvbmVudHNbbmFtZV0pIHtcclxuICAgICAgICAgICAgICAgICAgICB3YXJuKGBDb21wb25lbnQgXCIke25hbWV9XCIgaGFzIGFscmVhZHkgYmVlbiByZWdpc3RlcmVkIGluIHRhcmdldCBhcHAuYCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmNvbXBvbmVudHNbbmFtZV0gPSBjb21wb25lbnQ7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYXBwO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBkaXJlY3RpdmUobmFtZSwgZGlyZWN0aXZlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFsaWRhdGVEaXJlY3RpdmVOYW1lKG5hbWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCFkaXJlY3RpdmUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29udGV4dC5kaXJlY3RpdmVzW25hbWVdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiBjb250ZXh0LmRpcmVjdGl2ZXNbbmFtZV0pIHtcclxuICAgICAgICAgICAgICAgICAgICB3YXJuKGBEaXJlY3RpdmUgXCIke25hbWV9XCIgaGFzIGFscmVhZHkgYmVlbiByZWdpc3RlcmVkIGluIHRhcmdldCBhcHAuYCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmRpcmVjdGl2ZXNbbmFtZV0gPSBkaXJlY3RpdmU7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYXBwO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBtb3VudChyb290Q29udGFpbmVyLCBpc0h5ZHJhdGUsIGlzU1ZHKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWlzTW91bnRlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHZub2RlID0gY3JlYXRlVk5vZGUocm9vdENvbXBvbmVudCwgcm9vdFByb3BzKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyBzdG9yZSBhcHAgY29udGV4dCBvbiB0aGUgcm9vdCBWTm9kZS5cclxuICAgICAgICAgICAgICAgICAgICAvLyB0aGlzIHdpbGwgYmUgc2V0IG9uIHRoZSByb290IGluc3RhbmNlIG9uIGluaXRpYWwgbW91bnQuXHJcbiAgICAgICAgICAgICAgICAgICAgdm5vZGUuYXBwQ29udGV4dCA9IGNvbnRleHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gSE1SIHJvb3QgcmVsb2FkXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0LnJlbG9hZCA9ICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbmRlcihjbG9uZVZOb2RlKHZub2RlKSwgcm9vdENvbnRhaW5lciwgaXNTVkcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNIeWRyYXRlICYmIGh5ZHJhdGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaHlkcmF0ZSh2bm9kZSwgcm9vdENvbnRhaW5lcik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZW5kZXIodm5vZGUsIHJvb3RDb250YWluZXIsIGlzU1ZHKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaXNNb3VudGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBhcHAuX2NvbnRhaW5lciA9IHJvb3RDb250YWluZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgcm9vdENvbnRhaW5lci5fX3Z1ZV9hcHBfXyA9IGFwcDtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHx8IF9fVlVFX1BST0RfREVWVE9PTFNfXykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhcHAuX2luc3RhbmNlID0gdm5vZGUuY29tcG9uZW50O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXZ0b29sc0luaXRBcHAoYXBwLCB2ZXJzaW9uKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldEV4cG9zZVByb3h5KHZub2RlLmNvbXBvbmVudCkgfHwgdm5vZGUuY29tcG9uZW50LnByb3h5O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgd2FybihgQXBwIGhhcyBhbHJlYWR5IGJlZW4gbW91bnRlZC5cXG5gICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYElmIHlvdSB3YW50IHRvIHJlbW91bnQgdGhlIHNhbWUgYXBwLCBtb3ZlIHlvdXIgYXBwIGNyZWF0aW9uIGxvZ2ljIGAgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBgaW50byBhIGZhY3RvcnkgZnVuY3Rpb24gYW5kIGNyZWF0ZSBmcmVzaCBhcHAgaW5zdGFuY2VzIGZvciBlYWNoIGAgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBgbW91bnQgLSBlLmcuIFxcYGNvbnN0IGNyZWF0ZU15QXBwID0gKCkgPT4gY3JlYXRlQXBwKEFwcClcXGBgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgdW5tb3VudCgpIHtcclxuICAgICAgICAgICAgICAgIGlmIChpc01vdW50ZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZW5kZXIobnVsbCwgYXBwLl9jb250YWluZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgfHwgX19WVUVfUFJPRF9ERVZUT09MU19fKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFwcC5faW5zdGFuY2UgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXZ0b29sc1VubW91bnRBcHAoYXBwKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGFwcC5fY29udGFpbmVyLl9fdnVlX2FwcF9fO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgd2FybihgQ2Fubm90IHVubW91bnQgYW4gYXBwIHRoYXQgaXMgbm90IG1vdW50ZWQuYCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHByb3ZpZGUoa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiBrZXkgaW4gY29udGV4dC5wcm92aWRlcykge1xyXG4gICAgICAgICAgICAgICAgICAgIHdhcm4oYEFwcCBhbHJlYWR5IHByb3ZpZGVzIHByb3BlcnR5IHdpdGgga2V5IFwiJHtTdHJpbmcoa2V5KX1cIi4gYCArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGBJdCB3aWxsIGJlIG92ZXJ3cml0dGVuIHdpdGggdGhlIG5ldyB2YWx1ZS5gKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIFR5cGVTY3JpcHQgZG9lc24ndCBhbGxvdyBzeW1ib2xzIGFzIGluZGV4IHR5cGVcclxuICAgICAgICAgICAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9NaWNyb3NvZnQvVHlwZVNjcmlwdC9pc3N1ZXMvMjQ1ODdcclxuICAgICAgICAgICAgICAgIGNvbnRleHQucHJvdmlkZXNba2V5XSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGFwcDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBhcHA7XHJcbiAgICB9O1xyXG59XG5cbi8qKlxyXG4gKiBGdW5jdGlvbiBmb3IgaGFuZGxpbmcgYSB0ZW1wbGF0ZSByZWZcclxuICovXHJcbmZ1bmN0aW9uIHNldFJlZihyYXdSZWYsIG9sZFJhd1JlZiwgcGFyZW50U3VzcGVuc2UsIHZub2RlLCBpc1VubW91bnQgPSBmYWxzZSkge1xyXG4gICAgaWYgKGlzQXJyYXkocmF3UmVmKSkge1xyXG4gICAgICAgIHJhd1JlZi5mb3JFYWNoKChyLCBpKSA9PiBzZXRSZWYociwgb2xkUmF3UmVmICYmIChpc0FycmF5KG9sZFJhd1JlZikgPyBvbGRSYXdSZWZbaV0gOiBvbGRSYXdSZWYpLCBwYXJlbnRTdXNwZW5zZSwgdm5vZGUsIGlzVW5tb3VudCkpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGlmIChpc0FzeW5jV3JhcHBlcih2bm9kZSkgJiYgIWlzVW5tb3VudCkge1xyXG4gICAgICAgIC8vIHdoZW4gbW91bnRpbmcgYXN5bmMgY29tcG9uZW50cywgbm90aGluZyBuZWVkcyB0byBiZSBkb25lLFxyXG4gICAgICAgIC8vIGJlY2F1c2UgdGhlIHRlbXBsYXRlIHJlZiBpcyBmb3J3YXJkZWQgdG8gaW5uZXIgY29tcG9uZW50XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgY29uc3QgcmVmVmFsdWUgPSB2bm9kZS5zaGFwZUZsYWcgJiA0IC8qIFNUQVRFRlVMX0NPTVBPTkVOVCAqL1xyXG4gICAgICAgID8gZ2V0RXhwb3NlUHJveHkodm5vZGUuY29tcG9uZW50KSB8fCB2bm9kZS5jb21wb25lbnQucHJveHlcclxuICAgICAgICA6IHZub2RlLmVsO1xyXG4gICAgY29uc3QgdmFsdWUgPSBpc1VubW91bnQgPyBudWxsIDogcmVmVmFsdWU7XHJcbiAgICBjb25zdCB7IGk6IG93bmVyLCByOiByZWYgfSA9IHJhd1JlZjtcclxuICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiYgIW93bmVyKSB7XHJcbiAgICAgICAgd2FybihgTWlzc2luZyByZWYgb3duZXIgY29udGV4dC4gcmVmIGNhbm5vdCBiZSB1c2VkIG9uIGhvaXN0ZWQgdm5vZGVzLiBgICtcclxuICAgICAgICAgICAgYEEgdm5vZGUgd2l0aCByZWYgbXVzdCBiZSBjcmVhdGVkIGluc2lkZSB0aGUgcmVuZGVyIGZ1bmN0aW9uLmApO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IG9sZFJlZiA9IG9sZFJhd1JlZiAmJiBvbGRSYXdSZWYucjtcclxuICAgIGNvbnN0IHJlZnMgPSBvd25lci5yZWZzID09PSBFTVBUWV9PQkogPyAob3duZXIucmVmcyA9IHt9KSA6IG93bmVyLnJlZnM7XHJcbiAgICBjb25zdCBzZXR1cFN0YXRlID0gb3duZXIuc2V0dXBTdGF0ZTtcclxuICAgIC8vIGR5bmFtaWMgcmVmIGNoYW5nZWQuIHVuc2V0IG9sZCByZWZcclxuICAgIGlmIChvbGRSZWYgIT0gbnVsbCAmJiBvbGRSZWYgIT09IHJlZikge1xyXG4gICAgICAgIGlmIChpc1N0cmluZyhvbGRSZWYpKSB7XHJcbiAgICAgICAgICAgIHJlZnNbb2xkUmVmXSA9IG51bGw7XHJcbiAgICAgICAgICAgIGlmIChoYXNPd24oc2V0dXBTdGF0ZSwgb2xkUmVmKSkge1xyXG4gICAgICAgICAgICAgICAgc2V0dXBTdGF0ZVtvbGRSZWZdID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChpc1JlZihvbGRSZWYpKSB7XHJcbiAgICAgICAgICAgIG9sZFJlZi52YWx1ZSA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYgKGlzRnVuY3Rpb24ocmVmKSkge1xyXG4gICAgICAgIGNhbGxXaXRoRXJyb3JIYW5kbGluZyhyZWYsIG93bmVyLCAxMiAvKiBGVU5DVElPTl9SRUYgKi8sIFt2YWx1ZSwgcmVmc10pO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgY29uc3QgX2lzU3RyaW5nID0gaXNTdHJpbmcocmVmKTtcclxuICAgICAgICBjb25zdCBfaXNSZWYgPSBpc1JlZihyZWYpO1xyXG4gICAgICAgIGlmIChfaXNTdHJpbmcgfHwgX2lzUmVmKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGRvU2V0ID0gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJhd1JlZi5mKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZXhpc3RpbmcgPSBfaXNTdHJpbmcgPyByZWZzW3JlZl0gOiByZWYudmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzVW5tb3VudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpc0FycmF5KGV4aXN0aW5nKSAmJiByZW1vdmUoZXhpc3RpbmcsIHJlZlZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNBcnJheShleGlzdGluZykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfaXNTdHJpbmcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWZzW3JlZl0gPSBbcmVmVmFsdWVdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmLnZhbHVlID0gW3JlZlZhbHVlXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmF3UmVmLmspXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZnNbcmF3UmVmLmtdID0gcmVmLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKCFleGlzdGluZy5pbmNsdWRlcyhyZWZWYWx1ZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4aXN0aW5nLnB1c2gocmVmVmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoX2lzU3RyaW5nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVmc1tyZWZdID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGhhc093bihzZXR1cFN0YXRlLCByZWYpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldHVwU3RhdGVbcmVmXSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGlzUmVmKHJlZikpIHtcclxuICAgICAgICAgICAgICAgICAgICByZWYudmFsdWUgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocmF3UmVmLmspXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZnNbcmF3UmVmLmtdID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgICAgICB3YXJuKCdJbnZhbGlkIHRlbXBsYXRlIHJlZiB0eXBlOicsIHJlZiwgYCgke3R5cGVvZiByZWZ9KWApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBpZiAodmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIGRvU2V0LmlkID0gLTE7XHJcbiAgICAgICAgICAgICAgICBxdWV1ZVBvc3RSZW5kZXJFZmZlY3QoZG9TZXQsIHBhcmVudFN1c3BlbnNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGRvU2V0KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgIHdhcm4oJ0ludmFsaWQgdGVtcGxhdGUgcmVmIHR5cGU6JywgcmVmLCBgKCR7dHlwZW9mIHJlZn0pYCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XG5cbmxldCBoYXNNaXNtYXRjaCA9IGZhbHNlO1xyXG5jb25zdCBpc1NWR0NvbnRhaW5lciA9IChjb250YWluZXIpID0+IC9zdmcvLnRlc3QoY29udGFpbmVyLm5hbWVzcGFjZVVSSSkgJiYgY29udGFpbmVyLnRhZ05hbWUgIT09ICdmb3JlaWduT2JqZWN0JztcclxuY29uc3QgaXNDb21tZW50ID0gKG5vZGUpID0+IG5vZGUubm9kZVR5cGUgPT09IDggLyogQ09NTUVOVCAqLztcclxuLy8gTm90ZTogaHlkcmF0aW9uIGlzIERPTS1zcGVjaWZpY1xyXG4vLyBCdXQgd2UgaGF2ZSB0byBwbGFjZSBpdCBpbiBjb3JlIGR1ZSB0byB0aWdodCBjb3VwbGluZyB3aXRoIGNvcmUgLSBzcGxpdHRpbmdcclxuLy8gaXQgb3V0IGNyZWF0ZXMgYSB0b24gb2YgdW5uZWNlc3NhcnkgY29tcGxleGl0eS5cclxuLy8gSHlkcmF0aW9uIGFsc28gZGVwZW5kcyBvbiBzb21lIHJlbmRlcmVyIGludGVybmFsIGxvZ2ljIHdoaWNoIG5lZWRzIHRvIGJlXHJcbi8vIHBhc3NlZCBpbiB2aWEgYXJndW1lbnRzLlxyXG5mdW5jdGlvbiBjcmVhdGVIeWRyYXRpb25GdW5jdGlvbnMocmVuZGVyZXJJbnRlcm5hbHMpIHtcclxuICAgIGNvbnN0IHsgbXQ6IG1vdW50Q29tcG9uZW50LCBwOiBwYXRjaCwgbzogeyBwYXRjaFByb3AsIG5leHRTaWJsaW5nLCBwYXJlbnROb2RlLCByZW1vdmUsIGluc2VydCwgY3JlYXRlQ29tbWVudCB9IH0gPSByZW5kZXJlckludGVybmFscztcclxuICAgIGNvbnN0IGh5ZHJhdGUgPSAodm5vZGUsIGNvbnRhaW5lcikgPT4ge1xyXG4gICAgICAgIGlmICghY29udGFpbmVyLmhhc0NoaWxkTm9kZXMoKSkge1xyXG4gICAgICAgICAgICAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiZcclxuICAgICAgICAgICAgICAgIHdhcm4oYEF0dGVtcHRpbmcgdG8gaHlkcmF0ZSBleGlzdGluZyBtYXJrdXAgYnV0IGNvbnRhaW5lciBpcyBlbXB0eS4gYCArXHJcbiAgICAgICAgICAgICAgICAgICAgYFBlcmZvcm1pbmcgZnVsbCBtb3VudCBpbnN0ZWFkLmApO1xyXG4gICAgICAgICAgICBwYXRjaChudWxsLCB2bm9kZSwgY29udGFpbmVyKTtcclxuICAgICAgICAgICAgZmx1c2hQb3N0Rmx1c2hDYnMoKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBoYXNNaXNtYXRjaCA9IGZhbHNlO1xyXG4gICAgICAgIGh5ZHJhdGVOb2RlKGNvbnRhaW5lci5maXJzdENoaWxkLCB2bm9kZSwgbnVsbCwgbnVsbCwgbnVsbCk7XHJcbiAgICAgICAgZmx1c2hQb3N0Rmx1c2hDYnMoKTtcclxuICAgICAgICBpZiAoaGFzTWlzbWF0Y2ggJiYgIWZhbHNlKSB7XHJcbiAgICAgICAgICAgIC8vIHRoaXMgZXJyb3Igc2hvdWxkIHNob3cgdXAgaW4gcHJvZHVjdGlvblxyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGBIeWRyYXRpb24gY29tcGxldGVkIGJ1dCBjb250YWlucyBtaXNtYXRjaGVzLmApO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBjb25zdCBoeWRyYXRlTm9kZSA9IChub2RlLCB2bm9kZSwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgc2xvdFNjb3BlSWRzLCBvcHRpbWl6ZWQgPSBmYWxzZSkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGlzRnJhZ21lbnRTdGFydCA9IGlzQ29tbWVudChub2RlKSAmJiBub2RlLmRhdGEgPT09ICdbJztcclxuICAgICAgICBjb25zdCBvbk1pc21hdGNoID0gKCkgPT4gaGFuZGxlTWlzbWF0Y2gobm9kZSwgdm5vZGUsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIHNsb3RTY29wZUlkcywgaXNGcmFnbWVudFN0YXJ0KTtcclxuICAgICAgICBjb25zdCB7IHR5cGUsIHJlZiwgc2hhcGVGbGFnIH0gPSB2bm9kZTtcclxuICAgICAgICBjb25zdCBkb21UeXBlID0gbm9kZS5ub2RlVHlwZTtcclxuICAgICAgICB2bm9kZS5lbCA9IG5vZGU7XHJcbiAgICAgICAgbGV0IG5leHROb2RlID0gbnVsbDtcclxuICAgICAgICBzd2l0Y2ggKHR5cGUpIHtcclxuICAgICAgICAgICAgY2FzZSBUZXh0OlxyXG4gICAgICAgICAgICAgICAgaWYgKGRvbVR5cGUgIT09IDMgLyogVEVYVCAqLykge1xyXG4gICAgICAgICAgICAgICAgICAgIG5leHROb2RlID0gb25NaXNtYXRjaCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUuZGF0YSAhPT0gdm5vZGUuY2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaGFzTWlzbWF0Y2ggPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdhcm4oYEh5ZHJhdGlvbiB0ZXh0IG1pc21hdGNoOmAgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGBcXG4tIENsaWVudDogJHtKU09OLnN0cmluZ2lmeShub2RlLmRhdGEpfWAgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGBcXG4tIFNlcnZlcjogJHtKU09OLnN0cmluZ2lmeSh2bm9kZS5jaGlsZHJlbil9YCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuZGF0YSA9IHZub2RlLmNoaWxkcmVuO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBuZXh0Tm9kZSA9IG5leHRTaWJsaW5nKG5vZGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgQ29tbWVudDpcclxuICAgICAgICAgICAgICAgIGlmIChkb21UeXBlICE9PSA4IC8qIENPTU1FTlQgKi8gfHwgaXNGcmFnbWVudFN0YXJ0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmV4dE5vZGUgPSBvbk1pc21hdGNoKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBuZXh0Tm9kZSA9IG5leHRTaWJsaW5nKG5vZGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgU3RhdGljOlxyXG4gICAgICAgICAgICAgICAgaWYgKGRvbVR5cGUgIT09IDEgLyogRUxFTUVOVCAqLykge1xyXG4gICAgICAgICAgICAgICAgICAgIG5leHROb2RlID0gb25NaXNtYXRjaCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gZGV0ZXJtaW5lIGFuY2hvciwgYWRvcHQgY29udGVudFxyXG4gICAgICAgICAgICAgICAgICAgIG5leHROb2RlID0gbm9kZTtcclxuICAgICAgICAgICAgICAgICAgICAvLyBpZiB0aGUgc3RhdGljIHZub2RlIGhhcyBpdHMgY29udGVudCBzdHJpcHBlZCBkdXJpbmcgYnVpbGQsXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gYWRvcHQgaXQgZnJvbSB0aGUgc2VydmVyLXJlbmRlcmVkIEhUTUwuXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmVlZFRvQWRvcHRDb250ZW50ID0gIXZub2RlLmNoaWxkcmVuLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHZub2RlLnN0YXRpY0NvdW50OyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5lZWRUb0Fkb3B0Q29udGVudClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZub2RlLmNoaWxkcmVuICs9IG5leHROb2RlLm91dGVySFRNTDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkgPT09IHZub2RlLnN0YXRpY0NvdW50IC0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdm5vZGUuYW5jaG9yID0gbmV4dE5vZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV4dE5vZGUgPSBuZXh0U2libGluZyhuZXh0Tm9kZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXh0Tm9kZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIEZyYWdtZW50OlxyXG4gICAgICAgICAgICAgICAgaWYgKCFpc0ZyYWdtZW50U3RhcnQpIHtcclxuICAgICAgICAgICAgICAgICAgICBuZXh0Tm9kZSA9IG9uTWlzbWF0Y2goKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIG5leHROb2RlID0gaHlkcmF0ZUZyYWdtZW50KG5vZGUsIHZub2RlLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCBzbG90U2NvcGVJZHMsIG9wdGltaXplZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIGlmIChzaGFwZUZsYWcgJiAxIC8qIEVMRU1FTlQgKi8pIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZG9tVHlwZSAhPT0gMSAvKiBFTEVNRU5UICovIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZub2RlLnR5cGUudG9Mb3dlckNhc2UoKSAhPT1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUudGFnTmFtZS50b0xvd2VyQ2FzZSgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5leHROb2RlID0gb25NaXNtYXRjaCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV4dE5vZGUgPSBoeWRyYXRlRWxlbWVudChub2RlLCB2bm9kZSwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgc2xvdFNjb3BlSWRzLCBvcHRpbWl6ZWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHNoYXBlRmxhZyAmIDYgLyogQ09NUE9ORU5UICovKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gd2hlbiBzZXR0aW5nIHVwIHRoZSByZW5kZXIgZWZmZWN0LCBpZiB0aGUgaW5pdGlhbCB2bm9kZSBhbHJlYWR5XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gaGFzIC5lbCBzZXQsIHRoZSBjb21wb25lbnQgd2lsbCBwZXJmb3JtIGh5ZHJhdGlvbiBpbnN0ZWFkIG9mIG1vdW50XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gb24gaXRzIHN1Yi10cmVlLlxyXG4gICAgICAgICAgICAgICAgICAgIHZub2RlLnNsb3RTY29wZUlkcyA9IHNsb3RTY29wZUlkcztcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBwYXJlbnROb2RlKG5vZGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIG1vdW50Q29tcG9uZW50KHZub2RlLCBjb250YWluZXIsIG51bGwsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIGlzU1ZHQ29udGFpbmVyKGNvbnRhaW5lciksIG9wdGltaXplZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gY29tcG9uZW50IG1heSBiZSBhc3luYywgc28gaW4gdGhlIGNhc2Ugb2YgZnJhZ21lbnRzIHdlIGNhbm5vdCByZWx5XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gb24gY29tcG9uZW50J3MgcmVuZGVyZWQgb3V0cHV0IHRvIGRldGVybWluZSB0aGUgZW5kIG9mIHRoZSBmcmFnbWVudFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGluc3RlYWQsIHdlIGRvIGEgbG9va2FoZWFkIHRvIGZpbmQgdGhlIGVuZCBhbmNob3Igbm9kZS5cclxuICAgICAgICAgICAgICAgICAgICBuZXh0Tm9kZSA9IGlzRnJhZ21lbnRTdGFydFxyXG4gICAgICAgICAgICAgICAgICAgICAgICA/IGxvY2F0ZUNsb3NpbmdBc3luY0FuY2hvcihub2RlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA6IG5leHRTaWJsaW5nKG5vZGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICMzNzg3XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgY29tcG9uZW50IGlzIGFzeW5jLCBpdCBtYXkgZ2V0IG1vdmVkIC8gdW5tb3VudGVkIGJlZm9yZSBpdHNcclxuICAgICAgICAgICAgICAgICAgICAvLyBpbm5lciBjb21wb25lbnQgaXMgbG9hZGVkLCBzbyB3ZSBuZWVkIHRvIGdpdmUgaXQgYSBwbGFjZWhvbGRlclxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHZub2RlIHRoYXQgbWF0Y2hlcyBpdHMgYWRvcHRlZCBET00uXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzQXN5bmNXcmFwcGVyKHZub2RlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgc3ViVHJlZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzRnJhZ21lbnRTdGFydCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ViVHJlZSA9IGNyZWF0ZVZOb2RlKEZyYWdtZW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YlRyZWUuYW5jaG9yID0gbmV4dE5vZGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IG5leHROb2RlLnByZXZpb3VzU2libGluZ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogY29udGFpbmVyLmxhc3RDaGlsZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YlRyZWUgPVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUubm9kZVR5cGUgPT09IDMgPyBjcmVhdGVUZXh0Vk5vZGUoJycpIDogY3JlYXRlVk5vZGUoJ2RpdicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1YlRyZWUuZWwgPSBub2RlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2bm9kZS5jb21wb25lbnQuc3ViVHJlZSA9IHN1YlRyZWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoc2hhcGVGbGFnICYgNjQgLyogVEVMRVBPUlQgKi8pIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZG9tVHlwZSAhPT0gOCAvKiBDT01NRU5UICovKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5leHROb2RlID0gb25NaXNtYXRjaCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV4dE5vZGUgPSB2bm9kZS50eXBlLmh5ZHJhdGUobm9kZSwgdm5vZGUsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkLCByZW5kZXJlckludGVybmFscywgaHlkcmF0ZUNoaWxkcmVuKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChzaGFwZUZsYWcgJiAxMjggLyogU1VTUEVOU0UgKi8pIHtcclxuICAgICAgICAgICAgICAgICAgICBuZXh0Tm9kZSA9IHZub2RlLnR5cGUuaHlkcmF0ZShub2RlLCB2bm9kZSwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgaXNTVkdDb250YWluZXIocGFyZW50Tm9kZShub2RlKSksIHNsb3RTY29wZUlkcywgb3B0aW1pemVkLCByZW5kZXJlckludGVybmFscywgaHlkcmF0ZU5vZGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgd2FybignSW52YWxpZCBIb3N0Vk5vZGUgdHlwZTonLCB0eXBlLCBgKCR7dHlwZW9mIHR5cGV9KWApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocmVmICE9IG51bGwpIHtcclxuICAgICAgICAgICAgc2V0UmVmKHJlZiwgbnVsbCwgcGFyZW50U3VzcGVuc2UsIHZub2RlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5leHROb2RlO1xyXG4gICAgfTtcclxuICAgIGNvbnN0IGh5ZHJhdGVFbGVtZW50ID0gKGVsLCB2bm9kZSwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgc2xvdFNjb3BlSWRzLCBvcHRpbWl6ZWQpID0+IHtcclxuICAgICAgICBvcHRpbWl6ZWQgPSBvcHRpbWl6ZWQgfHwgISF2bm9kZS5keW5hbWljQ2hpbGRyZW47XHJcbiAgICAgICAgY29uc3QgeyB0eXBlLCBwcm9wcywgcGF0Y2hGbGFnLCBzaGFwZUZsYWcsIGRpcnMgfSA9IHZub2RlO1xyXG4gICAgICAgIC8vICM0MDA2IGZvciBmb3JtIGVsZW1lbnRzIHdpdGggbm9uLXN0cmluZyB2LW1vZGVsIHZhbHVlIGJpbmRpbmdzXHJcbiAgICAgICAgLy8gZS5nLiA8b3B0aW9uIDp2YWx1ZT1cIm9ialwiPiwgPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIDp0cnVlLXZhbHVlPVwiMVwiPlxyXG4gICAgICAgIGNvbnN0IGZvcmNlUGF0Y2hWYWx1ZSA9ICh0eXBlID09PSAnaW5wdXQnICYmIGRpcnMpIHx8IHR5cGUgPT09ICdvcHRpb24nO1xyXG4gICAgICAgIC8vIHNraXAgcHJvcHMgJiBjaGlsZHJlbiBpZiB0aGlzIGlzIGhvaXN0ZWQgc3RhdGljIG5vZGVzXHJcbiAgICAgICAgLy8gIzU0MDUgaW4gZGV2LCBhbHdheXMgaHlkcmF0ZSBjaGlsZHJlbiBmb3IgSE1SXHJcbiAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB8fCBmb3JjZVBhdGNoVmFsdWUgfHwgcGF0Y2hGbGFnICE9PSAtMSAvKiBIT0lTVEVEICovKSB7XHJcbiAgICAgICAgICAgIGlmIChkaXJzKSB7XHJcbiAgICAgICAgICAgICAgICBpbnZva2VEaXJlY3RpdmVIb29rKHZub2RlLCBudWxsLCBwYXJlbnRDb21wb25lbnQsICdjcmVhdGVkJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gcHJvcHNcclxuICAgICAgICAgICAgaWYgKHByb3BzKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZm9yY2VQYXRjaFZhbHVlIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgIW9wdGltaXplZCB8fFxyXG4gICAgICAgICAgICAgICAgICAgIHBhdGNoRmxhZyAmICgxNiAvKiBGVUxMX1BST1BTICovIHwgMzIgLyogSFlEUkFURV9FVkVOVFMgKi8pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gcHJvcHMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKChmb3JjZVBhdGNoVmFsdWUgJiYga2V5LmVuZHNXaXRoKCd2YWx1ZScpKSB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKGlzT24oa2V5KSAmJiAhaXNSZXNlcnZlZFByb3Aoa2V5KSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGNoUHJvcChlbCwga2V5LCBudWxsLCBwcm9wc1trZXldLCBmYWxzZSwgdW5kZWZpbmVkLCBwYXJlbnRDb21wb25lbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAocHJvcHMub25DbGljaykge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIEZhc3QgcGF0aCBmb3IgY2xpY2sgbGlzdGVuZXJzICh3aGljaCBpcyBtb3N0IG9mdGVuKSB0byBhdm9pZFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGl0ZXJhdGluZyB0aHJvdWdoIHByb3BzLlxyXG4gICAgICAgICAgICAgICAgICAgIHBhdGNoUHJvcChlbCwgJ29uQ2xpY2snLCBudWxsLCBwcm9wcy5vbkNsaWNrLCBmYWxzZSwgdW5kZWZpbmVkLCBwYXJlbnRDb21wb25lbnQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIHZub2RlIC8gZGlyZWN0aXZlIGhvb2tzXHJcbiAgICAgICAgICAgIGxldCB2bm9kZUhvb2tzO1xyXG4gICAgICAgICAgICBpZiAoKHZub2RlSG9va3MgPSBwcm9wcyAmJiBwcm9wcy5vblZub2RlQmVmb3JlTW91bnQpKSB7XHJcbiAgICAgICAgICAgICAgICBpbnZva2VWTm9kZUhvb2sodm5vZGVIb29rcywgcGFyZW50Q29tcG9uZW50LCB2bm9kZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGRpcnMpIHtcclxuICAgICAgICAgICAgICAgIGludm9rZURpcmVjdGl2ZUhvb2sodm5vZGUsIG51bGwsIHBhcmVudENvbXBvbmVudCwgJ2JlZm9yZU1vdW50Jyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCh2bm9kZUhvb2tzID0gcHJvcHMgJiYgcHJvcHMub25Wbm9kZU1vdW50ZWQpIHx8IGRpcnMpIHtcclxuICAgICAgICAgICAgICAgIHF1ZXVlRWZmZWN0V2l0aFN1c3BlbnNlKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB2bm9kZUhvb2tzICYmIGludm9rZVZOb2RlSG9vayh2bm9kZUhvb2tzLCBwYXJlbnRDb21wb25lbnQsIHZub2RlKTtcclxuICAgICAgICAgICAgICAgICAgICBkaXJzICYmIGludm9rZURpcmVjdGl2ZUhvb2sodm5vZGUsIG51bGwsIHBhcmVudENvbXBvbmVudCwgJ21vdW50ZWQnKTtcclxuICAgICAgICAgICAgICAgIH0sIHBhcmVudFN1c3BlbnNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBjaGlsZHJlblxyXG4gICAgICAgICAgICBpZiAoc2hhcGVGbGFnICYgMTYgLyogQVJSQVlfQ0hJTERSRU4gKi8gJiZcclxuICAgICAgICAgICAgICAgIC8vIHNraXAgaWYgZWxlbWVudCBoYXMgaW5uZXJIVE1MIC8gdGV4dENvbnRlbnRcclxuICAgICAgICAgICAgICAgICEocHJvcHMgJiYgKHByb3BzLmlubmVySFRNTCB8fCBwcm9wcy50ZXh0Q29udGVudCkpKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgbmV4dCA9IGh5ZHJhdGVDaGlsZHJlbihlbC5maXJzdENoaWxkLCB2bm9kZSwgZWwsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKTtcclxuICAgICAgICAgICAgICAgIGxldCBoYXNXYXJuZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHdoaWxlIChuZXh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaGFzTWlzbWF0Y2ggPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiYgIWhhc1dhcm5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3YXJuKGBIeWRyYXRpb24gY2hpbGRyZW4gbWlzbWF0Y2ggaW4gPCR7dm5vZGUudHlwZX0+OiBgICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGBzZXJ2ZXIgcmVuZGVyZWQgZWxlbWVudCBjb250YWlucyBtb3JlIGNoaWxkIG5vZGVzIHRoYW4gY2xpZW50IHZkb20uYCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhc1dhcm5lZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIFRoZSBTU1JlZCBET00gY29udGFpbnMgbW9yZSBub2RlcyB0aGFuIGl0IHNob3VsZC4gUmVtb3ZlIHRoZW0uXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VyID0gbmV4dDtcclxuICAgICAgICAgICAgICAgICAgICBuZXh0ID0gbmV4dC5uZXh0U2libGluZztcclxuICAgICAgICAgICAgICAgICAgICByZW1vdmUoY3VyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChzaGFwZUZsYWcgJiA4IC8qIFRFWFRfQ0hJTERSRU4gKi8pIHtcclxuICAgICAgICAgICAgICAgIGlmIChlbC50ZXh0Q29udGVudCAhPT0gdm5vZGUuY2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgICAgICAgICBoYXNNaXNtYXRjaCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdhcm4oYEh5ZHJhdGlvbiB0ZXh0IGNvbnRlbnQgbWlzbWF0Y2ggaW4gPCR7dm5vZGUudHlwZX0+OlxcbmAgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYC0gQ2xpZW50OiAke2VsLnRleHRDb250ZW50fVxcbmAgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYC0gU2VydmVyOiAke3Zub2RlLmNoaWxkcmVufWApO1xyXG4gICAgICAgICAgICAgICAgICAgIGVsLnRleHRDb250ZW50ID0gdm5vZGUuY2hpbGRyZW47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGVsLm5leHRTaWJsaW5nO1xyXG4gICAgfTtcclxuICAgIGNvbnN0IGh5ZHJhdGVDaGlsZHJlbiA9IChub2RlLCBwYXJlbnRWTm9kZSwgY29udGFpbmVyLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCBzbG90U2NvcGVJZHMsIG9wdGltaXplZCkgPT4ge1xyXG4gICAgICAgIG9wdGltaXplZCA9IG9wdGltaXplZCB8fCAhIXBhcmVudFZOb2RlLmR5bmFtaWNDaGlsZHJlbjtcclxuICAgICAgICBjb25zdCBjaGlsZHJlbiA9IHBhcmVudFZOb2RlLmNoaWxkcmVuO1xyXG4gICAgICAgIGNvbnN0IGwgPSBjaGlsZHJlbi5sZW5ndGg7XHJcbiAgICAgICAgbGV0IGhhc1dhcm5lZCA9IGZhbHNlO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHZub2RlID0gb3B0aW1pemVkXHJcbiAgICAgICAgICAgICAgICA/IGNoaWxkcmVuW2ldXHJcbiAgICAgICAgICAgICAgICA6IChjaGlsZHJlbltpXSA9IG5vcm1hbGl6ZVZOb2RlKGNoaWxkcmVuW2ldKSk7XHJcbiAgICAgICAgICAgIGlmIChub2RlKSB7XHJcbiAgICAgICAgICAgICAgICBub2RlID0gaHlkcmF0ZU5vZGUobm9kZSwgdm5vZGUsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmICh2bm9kZS50eXBlID09PSBUZXh0ICYmICF2bm9kZS5jaGlsZHJlbikge1xyXG4gICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBoYXNNaXNtYXRjaCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmICFoYXNXYXJuZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICB3YXJuKGBIeWRyYXRpb24gY2hpbGRyZW4gbWlzbWF0Y2ggaW4gPCR7Y29udGFpbmVyLnRhZ05hbWUudG9Mb3dlckNhc2UoKX0+OiBgICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYHNlcnZlciByZW5kZXJlZCBlbGVtZW50IGNvbnRhaW5zIGZld2VyIGNoaWxkIG5vZGVzIHRoYW4gY2xpZW50IHZkb20uYCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaGFzV2FybmVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIHRoZSBTU1JlZCBET00gZGlkbid0IGNvbnRhaW4gZW5vdWdoIG5vZGVzLiBNb3VudCB0aGUgbWlzc2luZyBvbmVzLlxyXG4gICAgICAgICAgICAgICAgcGF0Y2gobnVsbCwgdm5vZGUsIGNvbnRhaW5lciwgbnVsbCwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgaXNTVkdDb250YWluZXIoY29udGFpbmVyKSwgc2xvdFNjb3BlSWRzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbm9kZTtcclxuICAgIH07XHJcbiAgICBjb25zdCBoeWRyYXRlRnJhZ21lbnQgPSAobm9kZSwgdm5vZGUsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKSA9PiB7XHJcbiAgICAgICAgY29uc3QgeyBzbG90U2NvcGVJZHM6IGZyYWdtZW50U2xvdFNjb3BlSWRzIH0gPSB2bm9kZTtcclxuICAgICAgICBpZiAoZnJhZ21lbnRTbG90U2NvcGVJZHMpIHtcclxuICAgICAgICAgICAgc2xvdFNjb3BlSWRzID0gc2xvdFNjb3BlSWRzXHJcbiAgICAgICAgICAgICAgICA/IHNsb3RTY29wZUlkcy5jb25jYXQoZnJhZ21lbnRTbG90U2NvcGVJZHMpXHJcbiAgICAgICAgICAgICAgICA6IGZyYWdtZW50U2xvdFNjb3BlSWRzO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBjb250YWluZXIgPSBwYXJlbnROb2RlKG5vZGUpO1xyXG4gICAgICAgIGNvbnN0IG5leHQgPSBoeWRyYXRlQ2hpbGRyZW4obmV4dFNpYmxpbmcobm9kZSksIHZub2RlLCBjb250YWluZXIsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKTtcclxuICAgICAgICBpZiAobmV4dCAmJiBpc0NvbW1lbnQobmV4dCkgJiYgbmV4dC5kYXRhID09PSAnXScpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5leHRTaWJsaW5nKCh2bm9kZS5hbmNob3IgPSBuZXh0KSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBmcmFnbWVudCBkaWRuJ3QgaHlkcmF0ZSBzdWNjZXNzZnVsbHksIHNpbmNlIHdlIGRpZG4ndCBnZXQgYSBlbmQgYW5jaG9yXHJcbiAgICAgICAgICAgIC8vIGJhY2suIFRoaXMgc2hvdWxkIGhhdmUgbGVkIHRvIG5vZGUvY2hpbGRyZW4gbWlzbWF0Y2ggd2FybmluZ3MuXHJcbiAgICAgICAgICAgIGhhc01pc21hdGNoID0gdHJ1ZTtcclxuICAgICAgICAgICAgLy8gc2luY2UgdGhlIGFuY2hvciBpcyBtaXNzaW5nLCB3ZSBuZWVkIHRvIGNyZWF0ZSBvbmUgYW5kIGluc2VydCBpdFxyXG4gICAgICAgICAgICBpbnNlcnQoKHZub2RlLmFuY2hvciA9IGNyZWF0ZUNvbW1lbnQoYF1gKSksIGNvbnRhaW5lciwgbmV4dCk7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXh0O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBjb25zdCBoYW5kbGVNaXNtYXRjaCA9IChub2RlLCB2bm9kZSwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgc2xvdFNjb3BlSWRzLCBpc0ZyYWdtZW50KSA9PiB7XHJcbiAgICAgICAgaGFzTWlzbWF0Y2ggPSB0cnVlO1xyXG4gICAgICAgIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJlxyXG4gICAgICAgICAgICB3YXJuKGBIeWRyYXRpb24gbm9kZSBtaXNtYXRjaDpcXG4tIENsaWVudCB2bm9kZTpgLCB2bm9kZS50eXBlLCBgXFxuLSBTZXJ2ZXIgcmVuZGVyZWQgRE9NOmAsIG5vZGUsIG5vZGUubm9kZVR5cGUgPT09IDMgLyogVEVYVCAqL1xyXG4gICAgICAgICAgICAgICAgPyBgKHRleHQpYFxyXG4gICAgICAgICAgICAgICAgOiBpc0NvbW1lbnQobm9kZSkgJiYgbm9kZS5kYXRhID09PSAnWydcclxuICAgICAgICAgICAgICAgICAgICA/IGAoc3RhcnQgb2YgZnJhZ21lbnQpYFxyXG4gICAgICAgICAgICAgICAgICAgIDogYGApO1xyXG4gICAgICAgIHZub2RlLmVsID0gbnVsbDtcclxuICAgICAgICBpZiAoaXNGcmFnbWVudCkge1xyXG4gICAgICAgICAgICAvLyByZW1vdmUgZXhjZXNzaXZlIGZyYWdtZW50IG5vZGVzXHJcbiAgICAgICAgICAgIGNvbnN0IGVuZCA9IGxvY2F0ZUNsb3NpbmdBc3luY0FuY2hvcihub2RlKTtcclxuICAgICAgICAgICAgd2hpbGUgKHRydWUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5leHQgPSBuZXh0U2libGluZyhub2RlKTtcclxuICAgICAgICAgICAgICAgIGlmIChuZXh0ICYmIG5leHQgIT09IGVuZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlbW92ZShuZXh0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IG5leHQgPSBuZXh0U2libGluZyhub2RlKTtcclxuICAgICAgICBjb25zdCBjb250YWluZXIgPSBwYXJlbnROb2RlKG5vZGUpO1xyXG4gICAgICAgIHJlbW92ZShub2RlKTtcclxuICAgICAgICBwYXRjaChudWxsLCB2bm9kZSwgY29udGFpbmVyLCBuZXh0LCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCBpc1NWR0NvbnRhaW5lcihjb250YWluZXIpLCBzbG90U2NvcGVJZHMpO1xyXG4gICAgICAgIHJldHVybiBuZXh0O1xyXG4gICAgfTtcclxuICAgIGNvbnN0IGxvY2F0ZUNsb3NpbmdBc3luY0FuY2hvciA9IChub2RlKSA9PiB7XHJcbiAgICAgICAgbGV0IG1hdGNoID0gMDtcclxuICAgICAgICB3aGlsZSAobm9kZSkge1xyXG4gICAgICAgICAgICBub2RlID0gbmV4dFNpYmxpbmcobm9kZSk7XHJcbiAgICAgICAgICAgIGlmIChub2RlICYmIGlzQ29tbWVudChub2RlKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG5vZGUuZGF0YSA9PT0gJ1snKVxyXG4gICAgICAgICAgICAgICAgICAgIG1hdGNoKys7XHJcbiAgICAgICAgICAgICAgICBpZiAobm9kZS5kYXRhID09PSAnXScpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobWF0Y2ggPT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5leHRTaWJsaW5nKG5vZGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2gtLTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5vZGU7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFtoeWRyYXRlLCBoeWRyYXRlTm9kZV07XHJcbn1cblxuLyogZXNsaW50LWRpc2FibGUgbm8tcmVzdHJpY3RlZC1nbG9iYWxzICovXHJcbmxldCBzdXBwb3J0ZWQ7XHJcbmxldCBwZXJmO1xyXG5mdW5jdGlvbiBzdGFydE1lYXN1cmUoaW5zdGFuY2UsIHR5cGUpIHtcclxuICAgIGlmIChpbnN0YW5jZS5hcHBDb250ZXh0LmNvbmZpZy5wZXJmb3JtYW5jZSAmJiBpc1N1cHBvcnRlZCgpKSB7XHJcbiAgICAgICAgcGVyZi5tYXJrKGB2dWUtJHt0eXBlfS0ke2luc3RhbmNlLnVpZH1gKTtcclxuICAgIH1cclxuICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgfHwgX19WVUVfUFJPRF9ERVZUT09MU19fKSB7XHJcbiAgICAgICAgZGV2dG9vbHNQZXJmU3RhcnQoaW5zdGFuY2UsIHR5cGUsIHN1cHBvcnRlZCA/IHBlcmYubm93KCkgOiBEYXRlLm5vdygpKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBlbmRNZWFzdXJlKGluc3RhbmNlLCB0eXBlKSB7XHJcbiAgICBpZiAoaW5zdGFuY2UuYXBwQ29udGV4dC5jb25maWcucGVyZm9ybWFuY2UgJiYgaXNTdXBwb3J0ZWQoKSkge1xyXG4gICAgICAgIGNvbnN0IHN0YXJ0VGFnID0gYHZ1ZS0ke3R5cGV9LSR7aW5zdGFuY2UudWlkfWA7XHJcbiAgICAgICAgY29uc3QgZW5kVGFnID0gc3RhcnRUYWcgKyBgOmVuZGA7XHJcbiAgICAgICAgcGVyZi5tYXJrKGVuZFRhZyk7XHJcbiAgICAgICAgcGVyZi5tZWFzdXJlKGA8JHtmb3JtYXRDb21wb25lbnROYW1lKGluc3RhbmNlLCBpbnN0YW5jZS50eXBlKX0+ICR7dHlwZX1gLCBzdGFydFRhZywgZW5kVGFnKTtcclxuICAgICAgICBwZXJmLmNsZWFyTWFya3Moc3RhcnRUYWcpO1xyXG4gICAgICAgIHBlcmYuY2xlYXJNYXJrcyhlbmRUYWcpO1xyXG4gICAgfVxyXG4gICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB8fCBfX1ZVRV9QUk9EX0RFVlRPT0xTX18pIHtcclxuICAgICAgICBkZXZ0b29sc1BlcmZFbmQoaW5zdGFuY2UsIHR5cGUsIHN1cHBvcnRlZCA/IHBlcmYubm93KCkgOiBEYXRlLm5vdygpKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBpc1N1cHBvcnRlZCgpIHtcclxuICAgIGlmIChzdXBwb3J0ZWQgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHJldHVybiBzdXBwb3J0ZWQ7XHJcbiAgICB9XHJcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgd2luZG93LnBlcmZvcm1hbmNlKSB7XHJcbiAgICAgICAgc3VwcG9ydGVkID0gdHJ1ZTtcclxuICAgICAgICBwZXJmID0gd2luZG93LnBlcmZvcm1hbmNlO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgc3VwcG9ydGVkID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gc3VwcG9ydGVkO1xyXG59XG5cbi8qKlxyXG4gKiBUaGlzIGlzIG9ubHkgY2FsbGVkIGluIGVzbS1idW5kbGVyIGJ1aWxkcy5cclxuICogSXQgaXMgY2FsbGVkIHdoZW4gYSByZW5kZXJlciBpcyBjcmVhdGVkLCBpbiBgYmFzZUNyZWF0ZVJlbmRlcmVyYCBzbyB0aGF0XHJcbiAqIGltcG9ydGluZyBydW50aW1lLWNvcmUgaXMgc2lkZS1lZmZlY3RzIGZyZWUuXHJcbiAqXHJcbiAqIGlzdGFuYnVsLWlnbm9yZS1uZXh0XHJcbiAqL1xyXG5mdW5jdGlvbiBpbml0RmVhdHVyZUZsYWdzKCkge1xyXG4gICAgY29uc3QgbmVlZFdhcm4gPSBbXTtcclxuICAgIGlmICh0eXBlb2YgX19WVUVfT1BUSU9OU19BUElfXyAhPT0gJ2Jvb2xlYW4nKSB7XHJcbiAgICAgICAgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmIG5lZWRXYXJuLnB1c2goYF9fVlVFX09QVElPTlNfQVBJX19gKTtcclxuICAgICAgICBnZXRHbG9iYWxUaGlzKCkuX19WVUVfT1BUSU9OU19BUElfXyA9IHRydWU7XHJcbiAgICB9XHJcbiAgICBpZiAodHlwZW9mIF9fVlVFX1BST0RfREVWVE9PTFNfXyAhPT0gJ2Jvb2xlYW4nKSB7XHJcbiAgICAgICAgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmIG5lZWRXYXJuLnB1c2goYF9fVlVFX1BST0RfREVWVE9PTFNfX2ApO1xyXG4gICAgICAgIGdldEdsb2JhbFRoaXMoKS5fX1ZVRV9QUk9EX0RFVlRPT0xTX18gPSBmYWxzZTtcclxuICAgIH1cclxuICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiYgbmVlZFdhcm4ubGVuZ3RoKSB7XHJcbiAgICAgICAgY29uc3QgbXVsdGkgPSBuZWVkV2Fybi5sZW5ndGggPiAxO1xyXG4gICAgICAgIGNvbnNvbGUud2FybihgRmVhdHVyZSBmbGFnJHttdWx0aSA/IGBzYCA6IGBgfSAke25lZWRXYXJuLmpvaW4oJywgJyl9ICR7bXVsdGkgPyBgYXJlYCA6IGBpc2B9IG5vdCBleHBsaWNpdGx5IGRlZmluZWQuIFlvdSBhcmUgcnVubmluZyB0aGUgZXNtLWJ1bmRsZXIgYnVpbGQgb2YgVnVlLCBgICtcclxuICAgICAgICAgICAgYHdoaWNoIGV4cGVjdHMgdGhlc2UgY29tcGlsZS10aW1lIGZlYXR1cmUgZmxhZ3MgdG8gYmUgZ2xvYmFsbHkgaW5qZWN0ZWQgYCArXHJcbiAgICAgICAgICAgIGB2aWEgdGhlIGJ1bmRsZXIgY29uZmlnIGluIG9yZGVyIHRvIGdldCBiZXR0ZXIgdHJlZS1zaGFraW5nIGluIHRoZSBgICtcclxuICAgICAgICAgICAgYHByb2R1Y3Rpb24gYnVuZGxlLlxcblxcbmAgK1xyXG4gICAgICAgICAgICBgRm9yIG1vcmUgZGV0YWlscywgc2VlIGh0dHBzOi8vbGluay52dWVqcy5vcmcvZmVhdHVyZS1mbGFncy5gKTtcclxuICAgIH1cclxufVxuXG5jb25zdCBxdWV1ZVBvc3RSZW5kZXJFZmZlY3QgPSBxdWV1ZUVmZmVjdFdpdGhTdXNwZW5zZVxyXG4gICAgO1xyXG4vKipcclxuICogVGhlIGNyZWF0ZVJlbmRlcmVyIGZ1bmN0aW9uIGFjY2VwdHMgdHdvIGdlbmVyaWMgYXJndW1lbnRzOlxyXG4gKiBIb3N0Tm9kZSBhbmQgSG9zdEVsZW1lbnQsIGNvcnJlc3BvbmRpbmcgdG8gTm9kZSBhbmQgRWxlbWVudCB0eXBlcyBpbiB0aGVcclxuICogaG9zdCBlbnZpcm9ubWVudC4gRm9yIGV4YW1wbGUsIGZvciBydW50aW1lLWRvbSwgSG9zdE5vZGUgd291bGQgYmUgdGhlIERPTVxyXG4gKiBgTm9kZWAgaW50ZXJmYWNlIGFuZCBIb3N0RWxlbWVudCB3b3VsZCBiZSB0aGUgRE9NIGBFbGVtZW50YCBpbnRlcmZhY2UuXHJcbiAqXHJcbiAqIEN1c3RvbSByZW5kZXJlcnMgY2FuIHBhc3MgaW4gdGhlIHBsYXRmb3JtIHNwZWNpZmljIHR5cGVzIGxpa2UgdGhpczpcclxuICpcclxuICogYGBgIGpzXHJcbiAqIGNvbnN0IHsgcmVuZGVyLCBjcmVhdGVBcHAgfSA9IGNyZWF0ZVJlbmRlcmVyPE5vZGUsIEVsZW1lbnQ+KHtcclxuICogICBwYXRjaFByb3AsXHJcbiAqICAgLi4ubm9kZU9wc1xyXG4gKiB9KVxyXG4gKiBgYGBcclxuICovXHJcbmZ1bmN0aW9uIGNyZWF0ZVJlbmRlcmVyKG9wdGlvbnMpIHtcclxuICAgIHJldHVybiBiYXNlQ3JlYXRlUmVuZGVyZXIob3B0aW9ucyk7XHJcbn1cclxuLy8gU2VwYXJhdGUgQVBJIGZvciBjcmVhdGluZyBoeWRyYXRpb24tZW5hYmxlZCByZW5kZXJlci5cclxuLy8gSHlkcmF0aW9uIGxvZ2ljIGlzIG9ubHkgdXNlZCB3aGVuIGNhbGxpbmcgdGhpcyBmdW5jdGlvbiwgbWFraW5nIGl0XHJcbi8vIHRyZWUtc2hha2FibGUuXHJcbmZ1bmN0aW9uIGNyZWF0ZUh5ZHJhdGlvblJlbmRlcmVyKG9wdGlvbnMpIHtcclxuICAgIHJldHVybiBiYXNlQ3JlYXRlUmVuZGVyZXIob3B0aW9ucywgY3JlYXRlSHlkcmF0aW9uRnVuY3Rpb25zKTtcclxufVxyXG4vLyBpbXBsZW1lbnRhdGlvblxyXG5mdW5jdGlvbiBiYXNlQ3JlYXRlUmVuZGVyZXIob3B0aW9ucywgY3JlYXRlSHlkcmF0aW9uRm5zKSB7XHJcbiAgICAvLyBjb21waWxlLXRpbWUgZmVhdHVyZSBmbGFncyBjaGVja1xyXG4gICAge1xyXG4gICAgICAgIGluaXRGZWF0dXJlRmxhZ3MoKTtcclxuICAgIH1cclxuICAgIGNvbnN0IHRhcmdldCA9IGdldEdsb2JhbFRoaXMoKTtcclxuICAgIHRhcmdldC5fX1ZVRV9fID0gdHJ1ZTtcclxuICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgfHwgX19WVUVfUFJPRF9ERVZUT09MU19fKSB7XHJcbiAgICAgICAgc2V0RGV2dG9vbHNIb29rKHRhcmdldC5fX1ZVRV9ERVZUT09MU19HTE9CQUxfSE9PS19fLCB0YXJnZXQpO1xyXG4gICAgfVxyXG4gICAgY29uc3QgeyBpbnNlcnQ6IGhvc3RJbnNlcnQsIHJlbW92ZTogaG9zdFJlbW92ZSwgcGF0Y2hQcm9wOiBob3N0UGF0Y2hQcm9wLCBjcmVhdGVFbGVtZW50OiBob3N0Q3JlYXRlRWxlbWVudCwgY3JlYXRlVGV4dDogaG9zdENyZWF0ZVRleHQsIGNyZWF0ZUNvbW1lbnQ6IGhvc3RDcmVhdGVDb21tZW50LCBzZXRUZXh0OiBob3N0U2V0VGV4dCwgc2V0RWxlbWVudFRleHQ6IGhvc3RTZXRFbGVtZW50VGV4dCwgcGFyZW50Tm9kZTogaG9zdFBhcmVudE5vZGUsIG5leHRTaWJsaW5nOiBob3N0TmV4dFNpYmxpbmcsIHNldFNjb3BlSWQ6IGhvc3RTZXRTY29wZUlkID0gTk9PUCwgY2xvbmVOb2RlOiBob3N0Q2xvbmVOb2RlLCBpbnNlcnRTdGF0aWNDb250ZW50OiBob3N0SW5zZXJ0U3RhdGljQ29udGVudCB9ID0gb3B0aW9ucztcclxuICAgIC8vIE5vdGU6IGZ1bmN0aW9ucyBpbnNpZGUgdGhpcyBjbG9zdXJlIHNob3VsZCB1c2UgYGNvbnN0IHh4eCA9ICgpID0+IHt9YFxyXG4gICAgLy8gc3R5bGUgaW4gb3JkZXIgdG8gcHJldmVudCBiZWluZyBpbmxpbmVkIGJ5IG1pbmlmaWVycy5cclxuICAgIGNvbnN0IHBhdGNoID0gKG4xLCBuMiwgY29udGFpbmVyLCBhbmNob3IgPSBudWxsLCBwYXJlbnRDb21wb25lbnQgPSBudWxsLCBwYXJlbnRTdXNwZW5zZSA9IG51bGwsIGlzU1ZHID0gZmFsc2UsIHNsb3RTY29wZUlkcyA9IG51bGwsIG9wdGltaXplZCA9IChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiBpc0htclVwZGF0aW5nID8gZmFsc2UgOiAhIW4yLmR5bmFtaWNDaGlsZHJlbikgPT4ge1xyXG4gICAgICAgIGlmIChuMSA9PT0gbjIpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBwYXRjaGluZyAmIG5vdCBzYW1lIHR5cGUsIHVubW91bnQgb2xkIHRyZWVcclxuICAgICAgICBpZiAobjEgJiYgIWlzU2FtZVZOb2RlVHlwZShuMSwgbjIpKSB7XHJcbiAgICAgICAgICAgIGFuY2hvciA9IGdldE5leHRIb3N0Tm9kZShuMSk7XHJcbiAgICAgICAgICAgIHVubW91bnQobjEsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIHRydWUpO1xyXG4gICAgICAgICAgICBuMSA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChuMi5wYXRjaEZsYWcgPT09IC0yIC8qIEJBSUwgKi8pIHtcclxuICAgICAgICAgICAgb3B0aW1pemVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIG4yLmR5bmFtaWNDaGlsZHJlbiA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHsgdHlwZSwgcmVmLCBzaGFwZUZsYWcgfSA9IG4yO1xyXG4gICAgICAgIHN3aXRjaCAodHlwZSkge1xyXG4gICAgICAgICAgICBjYXNlIFRleHQ6XHJcbiAgICAgICAgICAgICAgICBwcm9jZXNzVGV4dChuMSwgbjIsIGNvbnRhaW5lciwgYW5jaG9yKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIENvbW1lbnQ6XHJcbiAgICAgICAgICAgICAgICBwcm9jZXNzQ29tbWVudE5vZGUobjEsIG4yLCBjb250YWluZXIsIGFuY2hvcik7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBTdGF0aWM6XHJcbiAgICAgICAgICAgICAgICBpZiAobjEgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG1vdW50U3RhdGljTm9kZShuMiwgY29udGFpbmVyLCBhbmNob3IsIGlzU1ZHKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHBhdGNoU3RhdGljTm9kZShuMSwgbjIsIGNvbnRhaW5lciwgaXNTVkcpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgRnJhZ21lbnQ6XHJcbiAgICAgICAgICAgICAgICBwcm9jZXNzRnJhZ21lbnQobjEsIG4yLCBjb250YWluZXIsIGFuY2hvciwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgaWYgKHNoYXBlRmxhZyAmIDEgLyogRUxFTUVOVCAqLykge1xyXG4gICAgICAgICAgICAgICAgICAgIHByb2Nlc3NFbGVtZW50KG4xLCBuMiwgY29udGFpbmVyLCBhbmNob3IsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIGlzU1ZHLCBzbG90U2NvcGVJZHMsIG9wdGltaXplZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChzaGFwZUZsYWcgJiA2IC8qIENPTVBPTkVOVCAqLykge1xyXG4gICAgICAgICAgICAgICAgICAgIHByb2Nlc3NDb21wb25lbnQobjEsIG4yLCBjb250YWluZXIsIGFuY2hvciwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHNoYXBlRmxhZyAmIDY0IC8qIFRFTEVQT1JUICovKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZS5wcm9jZXNzKG4xLCBuMiwgY29udGFpbmVyLCBhbmNob3IsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIGlzU1ZHLCBzbG90U2NvcGVJZHMsIG9wdGltaXplZCwgaW50ZXJuYWxzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHNoYXBlRmxhZyAmIDEyOCAvKiBTVVNQRU5TRSAqLykge1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGUucHJvY2VzcyhuMSwgbjIsIGNvbnRhaW5lciwgYW5jaG9yLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCBpc1NWRywgc2xvdFNjb3BlSWRzLCBvcHRpbWl6ZWQsIGludGVybmFscyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgICAgICB3YXJuKCdJbnZhbGlkIFZOb2RlIHR5cGU6JywgdHlwZSwgYCgke3R5cGVvZiB0eXBlfSlgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gc2V0IHJlZlxyXG4gICAgICAgIGlmIChyZWYgIT0gbnVsbCAmJiBwYXJlbnRDb21wb25lbnQpIHtcclxuICAgICAgICAgICAgc2V0UmVmKHJlZiwgbjEgJiYgbjEucmVmLCBwYXJlbnRTdXNwZW5zZSwgbjIgfHwgbjEsICFuMik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGNvbnN0IHByb2Nlc3NUZXh0ID0gKG4xLCBuMiwgY29udGFpbmVyLCBhbmNob3IpID0+IHtcclxuICAgICAgICBpZiAobjEgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBob3N0SW5zZXJ0KChuMi5lbCA9IGhvc3RDcmVhdGVUZXh0KG4yLmNoaWxkcmVuKSksIGNvbnRhaW5lciwgYW5jaG9yKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVsID0gKG4yLmVsID0gbjEuZWwpO1xyXG4gICAgICAgICAgICBpZiAobjIuY2hpbGRyZW4gIT09IG4xLmNoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgICAgICBob3N0U2V0VGV4dChlbCwgbjIuY2hpbGRyZW4pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGNvbnN0IHByb2Nlc3NDb21tZW50Tm9kZSA9IChuMSwgbjIsIGNvbnRhaW5lciwgYW5jaG9yKSA9PiB7XHJcbiAgICAgICAgaWYgKG4xID09IG51bGwpIHtcclxuICAgICAgICAgICAgaG9zdEluc2VydCgobjIuZWwgPSBob3N0Q3JlYXRlQ29tbWVudChuMi5jaGlsZHJlbiB8fCAnJykpLCBjb250YWluZXIsIGFuY2hvcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyB0aGVyZSdzIG5vIHN1cHBvcnQgZm9yIGR5bmFtaWMgY29tbWVudHNcclxuICAgICAgICAgICAgbjIuZWwgPSBuMS5lbDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgY29uc3QgbW91bnRTdGF0aWNOb2RlID0gKG4yLCBjb250YWluZXIsIGFuY2hvciwgaXNTVkcpID0+IHtcclxuICAgICAgICBbbjIuZWwsIG4yLmFuY2hvcl0gPSBob3N0SW5zZXJ0U3RhdGljQ29udGVudChuMi5jaGlsZHJlbiwgY29udGFpbmVyLCBhbmNob3IsIGlzU1ZHLCBuMi5lbCwgbjIuYW5jaG9yKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIERldiAvIEhNUiBvbmx5XHJcbiAgICAgKi9cclxuICAgIGNvbnN0IHBhdGNoU3RhdGljTm9kZSA9IChuMSwgbjIsIGNvbnRhaW5lciwgaXNTVkcpID0+IHtcclxuICAgICAgICAvLyBzdGF0aWMgbm9kZXMgYXJlIG9ubHkgcGF0Y2hlZCBkdXJpbmcgZGV2IGZvciBITVJcclxuICAgICAgICBpZiAobjIuY2hpbGRyZW4gIT09IG4xLmNoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGFuY2hvciA9IGhvc3ROZXh0U2libGluZyhuMS5hbmNob3IpO1xyXG4gICAgICAgICAgICAvLyByZW1vdmUgZXhpc3RpbmdcclxuICAgICAgICAgICAgcmVtb3ZlU3RhdGljTm9kZShuMSk7XHJcbiAgICAgICAgICAgIFtuMi5lbCwgbjIuYW5jaG9yXSA9IGhvc3RJbnNlcnRTdGF0aWNDb250ZW50KG4yLmNoaWxkcmVuLCBjb250YWluZXIsIGFuY2hvciwgaXNTVkcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgbjIuZWwgPSBuMS5lbDtcclxuICAgICAgICAgICAgbjIuYW5jaG9yID0gbjEuYW5jaG9yO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBjb25zdCBtb3ZlU3RhdGljTm9kZSA9ICh7IGVsLCBhbmNob3IgfSwgY29udGFpbmVyLCBuZXh0U2libGluZykgPT4ge1xyXG4gICAgICAgIGxldCBuZXh0O1xyXG4gICAgICAgIHdoaWxlIChlbCAmJiBlbCAhPT0gYW5jaG9yKSB7XHJcbiAgICAgICAgICAgIG5leHQgPSBob3N0TmV4dFNpYmxpbmcoZWwpO1xyXG4gICAgICAgICAgICBob3N0SW5zZXJ0KGVsLCBjb250YWluZXIsIG5leHRTaWJsaW5nKTtcclxuICAgICAgICAgICAgZWwgPSBuZXh0O1xyXG4gICAgICAgIH1cclxuICAgICAgICBob3N0SW5zZXJ0KGFuY2hvciwgY29udGFpbmVyLCBuZXh0U2libGluZyk7XHJcbiAgICB9O1xyXG4gICAgY29uc3QgcmVtb3ZlU3RhdGljTm9kZSA9ICh7IGVsLCBhbmNob3IgfSkgPT4ge1xyXG4gICAgICAgIGxldCBuZXh0O1xyXG4gICAgICAgIHdoaWxlIChlbCAmJiBlbCAhPT0gYW5jaG9yKSB7XHJcbiAgICAgICAgICAgIG5leHQgPSBob3N0TmV4dFNpYmxpbmcoZWwpO1xyXG4gICAgICAgICAgICBob3N0UmVtb3ZlKGVsKTtcclxuICAgICAgICAgICAgZWwgPSBuZXh0O1xyXG4gICAgICAgIH1cclxuICAgICAgICBob3N0UmVtb3ZlKGFuY2hvcik7XHJcbiAgICB9O1xyXG4gICAgY29uc3QgcHJvY2Vzc0VsZW1lbnQgPSAobjEsIG4yLCBjb250YWluZXIsIGFuY2hvciwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKSA9PiB7XHJcbiAgICAgICAgaXNTVkcgPSBpc1NWRyB8fCBuMi50eXBlID09PSAnc3ZnJztcclxuICAgICAgICBpZiAobjEgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBtb3VudEVsZW1lbnQobjIsIGNvbnRhaW5lciwgYW5jaG9yLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCBpc1NWRywgc2xvdFNjb3BlSWRzLCBvcHRpbWl6ZWQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcGF0Y2hFbGVtZW50KG4xLCBuMiwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgY29uc3QgbW91bnRFbGVtZW50ID0gKHZub2RlLCBjb250YWluZXIsIGFuY2hvciwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKSA9PiB7XHJcbiAgICAgICAgbGV0IGVsO1xyXG4gICAgICAgIGxldCB2bm9kZUhvb2s7XHJcbiAgICAgICAgY29uc3QgeyB0eXBlLCBwcm9wcywgc2hhcGVGbGFnLCB0cmFuc2l0aW9uLCBwYXRjaEZsYWcsIGRpcnMgfSA9IHZub2RlO1xyXG4gICAgICAgIGlmICghKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmXHJcbiAgICAgICAgICAgIHZub2RlLmVsICYmXHJcbiAgICAgICAgICAgIGhvc3RDbG9uZU5vZGUgIT09IHVuZGVmaW5lZCAmJlxyXG4gICAgICAgICAgICBwYXRjaEZsYWcgPT09IC0xIC8qIEhPSVNURUQgKi8pIHtcclxuICAgICAgICAgICAgLy8gSWYgYSB2bm9kZSBoYXMgbm9uLW51bGwgZWwsIGl0IG1lYW5zIGl0J3MgYmVpbmcgcmV1c2VkLlxyXG4gICAgICAgICAgICAvLyBPbmx5IHN0YXRpYyB2bm9kZXMgY2FuIGJlIHJldXNlZCwgc28gaXRzIG1vdW50ZWQgRE9NIG5vZGVzIHNob3VsZCBiZVxyXG4gICAgICAgICAgICAvLyBleGFjdGx5IHRoZSBzYW1lLCBhbmQgd2UgY2FuIHNpbXBseSBkbyBhIGNsb25lIGhlcmUuXHJcbiAgICAgICAgICAgIC8vIG9ubHkgZG8gdGhpcyBpbiBwcm9kdWN0aW9uIHNpbmNlIGNsb25lZCB0cmVlcyBjYW5ub3QgYmUgSE1SIHVwZGF0ZWQuXHJcbiAgICAgICAgICAgIGVsID0gdm5vZGUuZWwgPSBob3N0Q2xvbmVOb2RlKHZub2RlLmVsKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGVsID0gdm5vZGUuZWwgPSBob3N0Q3JlYXRlRWxlbWVudCh2bm9kZS50eXBlLCBpc1NWRywgcHJvcHMgJiYgcHJvcHMuaXMsIHByb3BzKTtcclxuICAgICAgICAgICAgLy8gbW91bnQgY2hpbGRyZW4gZmlyc3QsIHNpbmNlIHNvbWUgcHJvcHMgbWF5IHJlbHkgb24gY2hpbGQgY29udGVudFxyXG4gICAgICAgICAgICAvLyBiZWluZyBhbHJlYWR5IHJlbmRlcmVkLCBlLmcuIGA8c2VsZWN0IHZhbHVlPmBcclxuICAgICAgICAgICAgaWYgKHNoYXBlRmxhZyAmIDggLyogVEVYVF9DSElMRFJFTiAqLykge1xyXG4gICAgICAgICAgICAgICAgaG9zdFNldEVsZW1lbnRUZXh0KGVsLCB2bm9kZS5jaGlsZHJlbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoc2hhcGVGbGFnICYgMTYgLyogQVJSQVlfQ0hJTERSRU4gKi8pIHtcclxuICAgICAgICAgICAgICAgIG1vdW50Q2hpbGRyZW4odm5vZGUuY2hpbGRyZW4sIGVsLCBudWxsLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCBpc1NWRyAmJiB0eXBlICE9PSAnZm9yZWlnbk9iamVjdCcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoZGlycykge1xyXG4gICAgICAgICAgICAgICAgaW52b2tlRGlyZWN0aXZlSG9vayh2bm9kZSwgbnVsbCwgcGFyZW50Q29tcG9uZW50LCAnY3JlYXRlZCcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIHByb3BzXHJcbiAgICAgICAgICAgIGlmIChwcm9wcykge1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gcHJvcHMpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoa2V5ICE9PSAndmFsdWUnICYmICFpc1Jlc2VydmVkUHJvcChrZXkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhvc3RQYXRjaFByb3AoZWwsIGtleSwgbnVsbCwgcHJvcHNba2V5XSwgaXNTVkcsIHZub2RlLmNoaWxkcmVuLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCB1bm1vdW50Q2hpbGRyZW4pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgICAgICogU3BlY2lhbCBjYXNlIGZvciBzZXR0aW5nIHZhbHVlIG9uIERPTSBlbGVtZW50czpcclxuICAgICAgICAgICAgICAgICAqIC0gaXQgY2FuIGJlIG9yZGVyLXNlbnNpdGl2ZSAoZS5nLiBzaG91bGQgYmUgc2V0ICphZnRlciogbWluL21heCwgIzIzMjUsICM0MDI0KVxyXG4gICAgICAgICAgICAgICAgICogLSBpdCBuZWVkcyB0byBiZSBmb3JjZWQgKCMxNDcxKVxyXG4gICAgICAgICAgICAgICAgICogIzIzNTMgcHJvcG9zZXMgYWRkaW5nIGFub3RoZXIgcmVuZGVyZXIgb3B0aW9uIHRvIGNvbmZpZ3VyZSB0aGlzLCBidXRcclxuICAgICAgICAgICAgICAgICAqIHRoZSBwcm9wZXJ0aWVzIGFmZmVjdHMgYXJlIHNvIGZpbml0ZSBpdCBpcyB3b3J0aCBzcGVjaWFsIGNhc2luZyBpdFxyXG4gICAgICAgICAgICAgICAgICogaGVyZSB0byByZWR1Y2UgdGhlIGNvbXBsZXhpdHkuIChTcGVjaWFsIGNhc2luZyBpdCBhbHNvIHNob3VsZCBub3RcclxuICAgICAgICAgICAgICAgICAqIGFmZmVjdCBub24tRE9NIHJlbmRlcmVycylcclxuICAgICAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICAgICAgaWYgKCd2YWx1ZScgaW4gcHJvcHMpIHtcclxuICAgICAgICAgICAgICAgICAgICBob3N0UGF0Y2hQcm9wKGVsLCAndmFsdWUnLCBudWxsLCBwcm9wcy52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoKHZub2RlSG9vayA9IHByb3BzLm9uVm5vZGVCZWZvcmVNb3VudCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpbnZva2VWTm9kZUhvb2sodm5vZGVIb29rLCBwYXJlbnRDb21wb25lbnQsIHZub2RlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBzY29wZUlkXHJcbiAgICAgICAgICAgIHNldFNjb3BlSWQoZWwsIHZub2RlLCB2bm9kZS5zY29wZUlkLCBzbG90U2NvcGVJZHMsIHBhcmVudENvbXBvbmVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgfHwgX19WVUVfUFJPRF9ERVZUT09MU19fKSB7XHJcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlbCwgJ19fdm5vZGUnLCB7XHJcbiAgICAgICAgICAgICAgICB2YWx1ZTogdm5vZGUsXHJcbiAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGVsLCAnX192dWVQYXJlbnRDb21wb25lbnQnLCB7XHJcbiAgICAgICAgICAgICAgICB2YWx1ZTogcGFyZW50Q29tcG9uZW50LFxyXG4gICAgICAgICAgICAgICAgZW51bWVyYWJsZTogZmFsc2VcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChkaXJzKSB7XHJcbiAgICAgICAgICAgIGludm9rZURpcmVjdGl2ZUhvb2sodm5vZGUsIG51bGwsIHBhcmVudENvbXBvbmVudCwgJ2JlZm9yZU1vdW50Jyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vICMxNTgzIEZvciBpbnNpZGUgc3VzcGVuc2UgKyBzdXNwZW5zZSBub3QgcmVzb2x2ZWQgY2FzZSwgZW50ZXIgaG9vayBzaG91bGQgY2FsbCB3aGVuIHN1c3BlbnNlIHJlc29sdmVkXHJcbiAgICAgICAgLy8gIzE2ODkgRm9yIGluc2lkZSBzdXNwZW5zZSArIHN1c3BlbnNlIHJlc29sdmVkIGNhc2UsIGp1c3QgY2FsbCBpdFxyXG4gICAgICAgIGNvbnN0IG5lZWRDYWxsVHJhbnNpdGlvbkhvb2tzID0gKCFwYXJlbnRTdXNwZW5zZSB8fCAocGFyZW50U3VzcGVuc2UgJiYgIXBhcmVudFN1c3BlbnNlLnBlbmRpbmdCcmFuY2gpKSAmJlxyXG4gICAgICAgICAgICB0cmFuc2l0aW9uICYmXHJcbiAgICAgICAgICAgICF0cmFuc2l0aW9uLnBlcnNpc3RlZDtcclxuICAgICAgICBpZiAobmVlZENhbGxUcmFuc2l0aW9uSG9va3MpIHtcclxuICAgICAgICAgICAgdHJhbnNpdGlvbi5iZWZvcmVFbnRlcihlbCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGhvc3RJbnNlcnQoZWwsIGNvbnRhaW5lciwgYW5jaG9yKTtcclxuICAgICAgICBpZiAoKHZub2RlSG9vayA9IHByb3BzICYmIHByb3BzLm9uVm5vZGVNb3VudGVkKSB8fFxyXG4gICAgICAgICAgICBuZWVkQ2FsbFRyYW5zaXRpb25Ib29rcyB8fFxyXG4gICAgICAgICAgICBkaXJzKSB7XHJcbiAgICAgICAgICAgIHF1ZXVlUG9zdFJlbmRlckVmZmVjdCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB2bm9kZUhvb2sgJiYgaW52b2tlVk5vZGVIb29rKHZub2RlSG9vaywgcGFyZW50Q29tcG9uZW50LCB2bm9kZSk7XHJcbiAgICAgICAgICAgICAgICBuZWVkQ2FsbFRyYW5zaXRpb25Ib29rcyAmJiB0cmFuc2l0aW9uLmVudGVyKGVsKTtcclxuICAgICAgICAgICAgICAgIGRpcnMgJiYgaW52b2tlRGlyZWN0aXZlSG9vayh2bm9kZSwgbnVsbCwgcGFyZW50Q29tcG9uZW50LCAnbW91bnRlZCcpO1xyXG4gICAgICAgICAgICB9LCBwYXJlbnRTdXNwZW5zZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGNvbnN0IHNldFNjb3BlSWQgPSAoZWwsIHZub2RlLCBzY29wZUlkLCBzbG90U2NvcGVJZHMsIHBhcmVudENvbXBvbmVudCkgPT4ge1xyXG4gICAgICAgIGlmIChzY29wZUlkKSB7XHJcbiAgICAgICAgICAgIGhvc3RTZXRTY29wZUlkKGVsLCBzY29wZUlkKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHNsb3RTY29wZUlkcykge1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNsb3RTY29wZUlkcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgaG9zdFNldFNjb3BlSWQoZWwsIHNsb3RTY29wZUlkc1tpXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHBhcmVudENvbXBvbmVudCkge1xyXG4gICAgICAgICAgICBsZXQgc3ViVHJlZSA9IHBhcmVudENvbXBvbmVudC5zdWJUcmVlO1xyXG4gICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmXHJcbiAgICAgICAgICAgICAgICBzdWJUcmVlLnBhdGNoRmxhZyA+IDAgJiZcclxuICAgICAgICAgICAgICAgIHN1YlRyZWUucGF0Y2hGbGFnICYgMjA0OCAvKiBERVZfUk9PVF9GUkFHTUVOVCAqLykge1xyXG4gICAgICAgICAgICAgICAgc3ViVHJlZSA9XHJcbiAgICAgICAgICAgICAgICAgICAgZmlsdGVyU2luZ2xlUm9vdChzdWJUcmVlLmNoaWxkcmVuKSB8fCBzdWJUcmVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh2bm9kZSA9PT0gc3ViVHJlZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcGFyZW50Vk5vZGUgPSBwYXJlbnRDb21wb25lbnQudm5vZGU7XHJcbiAgICAgICAgICAgICAgICBzZXRTY29wZUlkKGVsLCBwYXJlbnRWTm9kZSwgcGFyZW50Vk5vZGUuc2NvcGVJZCwgcGFyZW50Vk5vZGUuc2xvdFNjb3BlSWRzLCBwYXJlbnRDb21wb25lbnQucGFyZW50KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBjb25zdCBtb3VudENoaWxkcmVuID0gKGNoaWxkcmVuLCBjb250YWluZXIsIGFuY2hvciwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkLCBzdGFydCA9IDApID0+IHtcclxuICAgICAgICBmb3IgKGxldCBpID0gc3RhcnQ7IGkgPCBjaGlsZHJlbi5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBjb25zdCBjaGlsZCA9IChjaGlsZHJlbltpXSA9IG9wdGltaXplZFxyXG4gICAgICAgICAgICAgICAgPyBjbG9uZUlmTW91bnRlZChjaGlsZHJlbltpXSlcclxuICAgICAgICAgICAgICAgIDogbm9ybWFsaXplVk5vZGUoY2hpbGRyZW5baV0pKTtcclxuICAgICAgICAgICAgcGF0Y2gobnVsbCwgY2hpbGQsIGNvbnRhaW5lciwgYW5jaG9yLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCBpc1NWRywgc2xvdFNjb3BlSWRzLCBvcHRpbWl6ZWQpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBjb25zdCBwYXRjaEVsZW1lbnQgPSAobjEsIG4yLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCBpc1NWRywgc2xvdFNjb3BlSWRzLCBvcHRpbWl6ZWQpID0+IHtcclxuICAgICAgICBjb25zdCBlbCA9IChuMi5lbCA9IG4xLmVsKTtcclxuICAgICAgICBsZXQgeyBwYXRjaEZsYWcsIGR5bmFtaWNDaGlsZHJlbiwgZGlycyB9ID0gbjI7XHJcbiAgICAgICAgLy8gIzE0MjYgdGFrZSB0aGUgb2xkIHZub2RlJ3MgcGF0Y2ggZmxhZyBpbnRvIGFjY291bnQgc2luY2UgdXNlciBtYXkgY2xvbmUgYVxyXG4gICAgICAgIC8vIGNvbXBpbGVyLWdlbmVyYXRlZCB2bm9kZSwgd2hpY2ggZGUtb3B0cyB0byBGVUxMX1BST1BTXHJcbiAgICAgICAgcGF0Y2hGbGFnIHw9IG4xLnBhdGNoRmxhZyAmIDE2IC8qIEZVTExfUFJPUFMgKi87XHJcbiAgICAgICAgY29uc3Qgb2xkUHJvcHMgPSBuMS5wcm9wcyB8fCBFTVBUWV9PQko7XHJcbiAgICAgICAgY29uc3QgbmV3UHJvcHMgPSBuMi5wcm9wcyB8fCBFTVBUWV9PQko7XHJcbiAgICAgICAgbGV0IHZub2RlSG9vaztcclxuICAgICAgICAvLyBkaXNhYmxlIHJlY3Vyc2UgaW4gYmVmb3JlVXBkYXRlIGhvb2tzXHJcbiAgICAgICAgcGFyZW50Q29tcG9uZW50ICYmIHRvZ2dsZVJlY3Vyc2UocGFyZW50Q29tcG9uZW50LCBmYWxzZSk7XHJcbiAgICAgICAgaWYgKCh2bm9kZUhvb2sgPSBuZXdQcm9wcy5vblZub2RlQmVmb3JlVXBkYXRlKSkge1xyXG4gICAgICAgICAgICBpbnZva2VWTm9kZUhvb2sodm5vZGVIb29rLCBwYXJlbnRDb21wb25lbnQsIG4yLCBuMSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChkaXJzKSB7XHJcbiAgICAgICAgICAgIGludm9rZURpcmVjdGl2ZUhvb2sobjIsIG4xLCBwYXJlbnRDb21wb25lbnQsICdiZWZvcmVVcGRhdGUnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcGFyZW50Q29tcG9uZW50ICYmIHRvZ2dsZVJlY3Vyc2UocGFyZW50Q29tcG9uZW50LCB0cnVlKTtcclxuICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmIGlzSG1yVXBkYXRpbmcpIHtcclxuICAgICAgICAgICAgLy8gSE1SIHVwZGF0ZWQsIGZvcmNlIGZ1bGwgZGlmZlxyXG4gICAgICAgICAgICBwYXRjaEZsYWcgPSAwO1xyXG4gICAgICAgICAgICBvcHRpbWl6ZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgZHluYW1pY0NoaWxkcmVuID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgYXJlQ2hpbGRyZW5TVkcgPSBpc1NWRyAmJiBuMi50eXBlICE9PSAnZm9yZWlnbk9iamVjdCc7XHJcbiAgICAgICAgaWYgKGR5bmFtaWNDaGlsZHJlbikge1xyXG4gICAgICAgICAgICBwYXRjaEJsb2NrQ2hpbGRyZW4objEuZHluYW1pY0NoaWxkcmVuLCBkeW5hbWljQ2hpbGRyZW4sIGVsLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCBhcmVDaGlsZHJlblNWRywgc2xvdFNjb3BlSWRzKTtcclxuICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiBwYXJlbnRDb21wb25lbnQgJiYgcGFyZW50Q29tcG9uZW50LnR5cGUuX19obXJJZCkge1xyXG4gICAgICAgICAgICAgICAgdHJhdmVyc2VTdGF0aWNDaGlsZHJlbihuMSwgbjIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKCFvcHRpbWl6ZWQpIHtcclxuICAgICAgICAgICAgLy8gZnVsbCBkaWZmXHJcbiAgICAgICAgICAgIHBhdGNoQ2hpbGRyZW4objEsIG4yLCBlbCwgbnVsbCwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgYXJlQ2hpbGRyZW5TVkcsIHNsb3RTY29wZUlkcywgZmFsc2UpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocGF0Y2hGbGFnID4gMCkge1xyXG4gICAgICAgICAgICAvLyB0aGUgcHJlc2VuY2Ugb2YgYSBwYXRjaEZsYWcgbWVhbnMgdGhpcyBlbGVtZW50J3MgcmVuZGVyIGNvZGUgd2FzXHJcbiAgICAgICAgICAgIC8vIGdlbmVyYXRlZCBieSB0aGUgY29tcGlsZXIgYW5kIGNhbiB0YWtlIHRoZSBmYXN0IHBhdGguXHJcbiAgICAgICAgICAgIC8vIGluIHRoaXMgcGF0aCBvbGQgbm9kZSBhbmQgbmV3IG5vZGUgYXJlIGd1YXJhbnRlZWQgdG8gaGF2ZSB0aGUgc2FtZSBzaGFwZVxyXG4gICAgICAgICAgICAvLyAoaS5lLiBhdCB0aGUgZXhhY3Qgc2FtZSBwb3NpdGlvbiBpbiB0aGUgc291cmNlIHRlbXBsYXRlKVxyXG4gICAgICAgICAgICBpZiAocGF0Y2hGbGFnICYgMTYgLyogRlVMTF9QUk9QUyAqLykge1xyXG4gICAgICAgICAgICAgICAgLy8gZWxlbWVudCBwcm9wcyBjb250YWluIGR5bmFtaWMga2V5cywgZnVsbCBkaWZmIG5lZWRlZFxyXG4gICAgICAgICAgICAgICAgcGF0Y2hQcm9wcyhlbCwgbjIsIG9sZFByb3BzLCBuZXdQcm9wcywgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gY2xhc3NcclxuICAgICAgICAgICAgICAgIC8vIHRoaXMgZmxhZyBpcyBtYXRjaGVkIHdoZW4gdGhlIGVsZW1lbnQgaGFzIGR5bmFtaWMgY2xhc3MgYmluZGluZ3MuXHJcbiAgICAgICAgICAgICAgICBpZiAocGF0Y2hGbGFnICYgMiAvKiBDTEFTUyAqLykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvbGRQcm9wcy5jbGFzcyAhPT0gbmV3UHJvcHMuY2xhc3MpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaG9zdFBhdGNoUHJvcChlbCwgJ2NsYXNzJywgbnVsbCwgbmV3UHJvcHMuY2xhc3MsIGlzU1ZHKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyBzdHlsZVxyXG4gICAgICAgICAgICAgICAgLy8gdGhpcyBmbGFnIGlzIG1hdGNoZWQgd2hlbiB0aGUgZWxlbWVudCBoYXMgZHluYW1pYyBzdHlsZSBiaW5kaW5nc1xyXG4gICAgICAgICAgICAgICAgaWYgKHBhdGNoRmxhZyAmIDQgLyogU1RZTEUgKi8pIHtcclxuICAgICAgICAgICAgICAgICAgICBob3N0UGF0Y2hQcm9wKGVsLCAnc3R5bGUnLCBvbGRQcm9wcy5zdHlsZSwgbmV3UHJvcHMuc3R5bGUsIGlzU1ZHKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIHByb3BzXHJcbiAgICAgICAgICAgICAgICAvLyBUaGlzIGZsYWcgaXMgbWF0Y2hlZCB3aGVuIHRoZSBlbGVtZW50IGhhcyBkeW5hbWljIHByb3AvYXR0ciBiaW5kaW5nc1xyXG4gICAgICAgICAgICAgICAgLy8gb3RoZXIgdGhhbiBjbGFzcyBhbmQgc3R5bGUuIFRoZSBrZXlzIG9mIGR5bmFtaWMgcHJvcC9hdHRycyBhcmUgc2F2ZWQgZm9yXHJcbiAgICAgICAgICAgICAgICAvLyBmYXN0ZXIgaXRlcmF0aW9uLlxyXG4gICAgICAgICAgICAgICAgLy8gTm90ZSBkeW5hbWljIGtleXMgbGlrZSA6W2Zvb109XCJiYXJcIiB3aWxsIGNhdXNlIHRoaXMgb3B0aW1pemF0aW9uIHRvXHJcbiAgICAgICAgICAgICAgICAvLyBiYWlsIG91dCBhbmQgZ28gdGhyb3VnaCBhIGZ1bGwgZGlmZiBiZWNhdXNlIHdlIG5lZWQgdG8gdW5zZXQgdGhlIG9sZCBrZXlcclxuICAgICAgICAgICAgICAgIGlmIChwYXRjaEZsYWcgJiA4IC8qIFBST1BTICovKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgdGhlIGZsYWcgaXMgcHJlc2VudCB0aGVuIGR5bmFtaWNQcm9wcyBtdXN0IGJlIG5vbi1udWxsXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJvcHNUb1VwZGF0ZSA9IG4yLmR5bmFtaWNQcm9wcztcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHByb3BzVG9VcGRhdGUubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qga2V5ID0gcHJvcHNUb1VwZGF0ZVtpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJldiA9IG9sZFByb3BzW2tleV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5leHQgPSBuZXdQcm9wc1trZXldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAjMTQ3MSBmb3JjZSBwYXRjaCB2YWx1ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobmV4dCAhPT0gcHJldiB8fCBrZXkgPT09ICd2YWx1ZScpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvc3RQYXRjaFByb3AoZWwsIGtleSwgcHJldiwgbmV4dCwgaXNTVkcsIG4xLmNoaWxkcmVuLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCB1bm1vdW50Q2hpbGRyZW4pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIHRleHRcclxuICAgICAgICAgICAgLy8gVGhpcyBmbGFnIGlzIG1hdGNoZWQgd2hlbiB0aGUgZWxlbWVudCBoYXMgb25seSBkeW5hbWljIHRleHQgY2hpbGRyZW4uXHJcbiAgICAgICAgICAgIGlmIChwYXRjaEZsYWcgJiAxIC8qIFRFWFQgKi8pIHtcclxuICAgICAgICAgICAgICAgIGlmIChuMS5jaGlsZHJlbiAhPT0gbjIuY2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgICAgICAgICBob3N0U2V0RWxlbWVudFRleHQoZWwsIG4yLmNoaWxkcmVuKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICghb3B0aW1pemVkICYmIGR5bmFtaWNDaGlsZHJlbiA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIC8vIHVub3B0aW1pemVkLCBmdWxsIGRpZmZcclxuICAgICAgICAgICAgcGF0Y2hQcm9wcyhlbCwgbjIsIG9sZFByb3BzLCBuZXdQcm9wcywgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoKHZub2RlSG9vayA9IG5ld1Byb3BzLm9uVm5vZGVVcGRhdGVkKSB8fCBkaXJzKSB7XHJcbiAgICAgICAgICAgIHF1ZXVlUG9zdFJlbmRlckVmZmVjdCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB2bm9kZUhvb2sgJiYgaW52b2tlVk5vZGVIb29rKHZub2RlSG9vaywgcGFyZW50Q29tcG9uZW50LCBuMiwgbjEpO1xyXG4gICAgICAgICAgICAgICAgZGlycyAmJiBpbnZva2VEaXJlY3RpdmVIb29rKG4yLCBuMSwgcGFyZW50Q29tcG9uZW50LCAndXBkYXRlZCcpO1xyXG4gICAgICAgICAgICB9LCBwYXJlbnRTdXNwZW5zZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8vIFRoZSBmYXN0IHBhdGggZm9yIGJsb2Nrcy5cclxuICAgIGNvbnN0IHBhdGNoQmxvY2tDaGlsZHJlbiA9IChvbGRDaGlsZHJlbiwgbmV3Q2hpbGRyZW4sIGZhbGxiYWNrQ29udGFpbmVyLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCBpc1NWRywgc2xvdFNjb3BlSWRzKSA9PiB7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuZXdDaGlsZHJlbi5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBjb25zdCBvbGRWTm9kZSA9IG9sZENoaWxkcmVuW2ldO1xyXG4gICAgICAgICAgICBjb25zdCBuZXdWTm9kZSA9IG5ld0NoaWxkcmVuW2ldO1xyXG4gICAgICAgICAgICAvLyBEZXRlcm1pbmUgdGhlIGNvbnRhaW5lciAocGFyZW50IGVsZW1lbnQpIGZvciB0aGUgcGF0Y2guXHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IFxyXG4gICAgICAgICAgICAvLyBvbGRWTm9kZSBtYXkgYmUgYW4gZXJyb3JlZCBhc3luYyBzZXR1cCgpIGNvbXBvbmVudCBpbnNpZGUgU3VzcGVuc2VcclxuICAgICAgICAgICAgLy8gd2hpY2ggd2lsbCBub3QgaGF2ZSBhIG1vdW50ZWQgZWxlbWVudFxyXG4gICAgICAgICAgICBvbGRWTm9kZS5lbCAmJlxyXG4gICAgICAgICAgICAgICAgLy8gLSBJbiB0aGUgY2FzZSBvZiBhIEZyYWdtZW50LCB3ZSBuZWVkIHRvIHByb3ZpZGUgdGhlIGFjdHVhbCBwYXJlbnRcclxuICAgICAgICAgICAgICAgIC8vIG9mIHRoZSBGcmFnbWVudCBpdHNlbGYgc28gaXQgY2FuIG1vdmUgaXRzIGNoaWxkcmVuLlxyXG4gICAgICAgICAgICAgICAgKG9sZFZOb2RlLnR5cGUgPT09IEZyYWdtZW50IHx8XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gLSBJbiB0aGUgY2FzZSBvZiBkaWZmZXJlbnQgbm9kZXMsIHRoZXJlIGlzIGdvaW5nIHRvIGJlIGEgcmVwbGFjZW1lbnRcclxuICAgICAgICAgICAgICAgICAgICAvLyB3aGljaCBhbHNvIHJlcXVpcmVzIHRoZSBjb3JyZWN0IHBhcmVudCBjb250YWluZXJcclxuICAgICAgICAgICAgICAgICAgICAhaXNTYW1lVk5vZGVUeXBlKG9sZFZOb2RlLCBuZXdWTm9kZSkgfHxcclxuICAgICAgICAgICAgICAgICAgICAvLyAtIEluIHRoZSBjYXNlIG9mIGEgY29tcG9uZW50LCBpdCBjb3VsZCBjb250YWluIGFueXRoaW5nLlxyXG4gICAgICAgICAgICAgICAgICAgIG9sZFZOb2RlLnNoYXBlRmxhZyAmICg2IC8qIENPTVBPTkVOVCAqLyB8IDY0IC8qIFRFTEVQT1JUICovKSlcclxuICAgICAgICAgICAgICAgID8gaG9zdFBhcmVudE5vZGUob2xkVk5vZGUuZWwpXHJcbiAgICAgICAgICAgICAgICA6IC8vIEluIG90aGVyIGNhc2VzLCB0aGUgcGFyZW50IGNvbnRhaW5lciBpcyBub3QgYWN0dWFsbHkgdXNlZCBzbyB3ZVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGp1c3QgcGFzcyB0aGUgYmxvY2sgZWxlbWVudCBoZXJlIHRvIGF2b2lkIGEgRE9NIHBhcmVudE5vZGUgY2FsbC5cclxuICAgICAgICAgICAgICAgICAgICBmYWxsYmFja0NvbnRhaW5lcjtcclxuICAgICAgICAgICAgcGF0Y2gob2xkVk5vZGUsIG5ld1ZOb2RlLCBjb250YWluZXIsIG51bGwsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIGlzU1ZHLCBzbG90U2NvcGVJZHMsIHRydWUpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBjb25zdCBwYXRjaFByb3BzID0gKGVsLCB2bm9kZSwgb2xkUHJvcHMsIG5ld1Byb3BzLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCBpc1NWRykgPT4ge1xyXG4gICAgICAgIGlmIChvbGRQcm9wcyAhPT0gbmV3UHJvcHMpIHtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gbmV3UHJvcHMpIHtcclxuICAgICAgICAgICAgICAgIC8vIGVtcHR5IHN0cmluZyBpcyBub3QgdmFsaWQgcHJvcFxyXG4gICAgICAgICAgICAgICAgaWYgKGlzUmVzZXJ2ZWRQcm9wKGtleSkpXHJcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuZXh0ID0gbmV3UHJvcHNba2V5XTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHByZXYgPSBvbGRQcm9wc1trZXldO1xyXG4gICAgICAgICAgICAgICAgLy8gZGVmZXIgcGF0Y2hpbmcgdmFsdWVcclxuICAgICAgICAgICAgICAgIGlmIChuZXh0ICE9PSBwcmV2ICYmIGtleSAhPT0gJ3ZhbHVlJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGhvc3RQYXRjaFByb3AoZWwsIGtleSwgcHJldiwgbmV4dCwgaXNTVkcsIHZub2RlLmNoaWxkcmVuLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCB1bm1vdW50Q2hpbGRyZW4pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChvbGRQcm9wcyAhPT0gRU1QVFlfT0JKKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBvbGRQcm9wcykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghaXNSZXNlcnZlZFByb3Aoa2V5KSAmJiAhKGtleSBpbiBuZXdQcm9wcykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaG9zdFBhdGNoUHJvcChlbCwga2V5LCBvbGRQcm9wc1trZXldLCBudWxsLCBpc1NWRywgdm5vZGUuY2hpbGRyZW4sIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIHVubW91bnRDaGlsZHJlbik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICgndmFsdWUnIGluIG5ld1Byb3BzKSB7XHJcbiAgICAgICAgICAgICAgICBob3N0UGF0Y2hQcm9wKGVsLCAndmFsdWUnLCBvbGRQcm9wcy52YWx1ZSwgbmV3UHJvcHMudmFsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGNvbnN0IHByb2Nlc3NGcmFnbWVudCA9IChuMSwgbjIsIGNvbnRhaW5lciwgYW5jaG9yLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCBpc1NWRywgc2xvdFNjb3BlSWRzLCBvcHRpbWl6ZWQpID0+IHtcclxuICAgICAgICBjb25zdCBmcmFnbWVudFN0YXJ0QW5jaG9yID0gKG4yLmVsID0gbjEgPyBuMS5lbCA6IGhvc3RDcmVhdGVUZXh0KCcnKSk7XHJcbiAgICAgICAgY29uc3QgZnJhZ21lbnRFbmRBbmNob3IgPSAobjIuYW5jaG9yID0gbjEgPyBuMS5hbmNob3IgOiBob3N0Q3JlYXRlVGV4dCgnJykpO1xyXG4gICAgICAgIGxldCB7IHBhdGNoRmxhZywgZHluYW1pY0NoaWxkcmVuLCBzbG90U2NvcGVJZHM6IGZyYWdtZW50U2xvdFNjb3BlSWRzIH0gPSBuMjtcclxuICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmIGlzSG1yVXBkYXRpbmcpIHtcclxuICAgICAgICAgICAgLy8gSE1SIHVwZGF0ZWQsIGZvcmNlIGZ1bGwgZGlmZlxyXG4gICAgICAgICAgICBwYXRjaEZsYWcgPSAwO1xyXG4gICAgICAgICAgICBvcHRpbWl6ZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgZHluYW1pY0NoaWxkcmVuID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gY2hlY2sgaWYgdGhpcyBpcyBhIHNsb3QgZnJhZ21lbnQgd2l0aCA6c2xvdHRlZCBzY29wZSBpZHNcclxuICAgICAgICBpZiAoZnJhZ21lbnRTbG90U2NvcGVJZHMpIHtcclxuICAgICAgICAgICAgc2xvdFNjb3BlSWRzID0gc2xvdFNjb3BlSWRzXHJcbiAgICAgICAgICAgICAgICA/IHNsb3RTY29wZUlkcy5jb25jYXQoZnJhZ21lbnRTbG90U2NvcGVJZHMpXHJcbiAgICAgICAgICAgICAgICA6IGZyYWdtZW50U2xvdFNjb3BlSWRzO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAobjEgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBob3N0SW5zZXJ0KGZyYWdtZW50U3RhcnRBbmNob3IsIGNvbnRhaW5lciwgYW5jaG9yKTtcclxuICAgICAgICAgICAgaG9zdEluc2VydChmcmFnbWVudEVuZEFuY2hvciwgY29udGFpbmVyLCBhbmNob3IpO1xyXG4gICAgICAgICAgICAvLyBhIGZyYWdtZW50IGNhbiBvbmx5IGhhdmUgYXJyYXkgY2hpbGRyZW5cclxuICAgICAgICAgICAgLy8gc2luY2UgdGhleSBhcmUgZWl0aGVyIGdlbmVyYXRlZCBieSB0aGUgY29tcGlsZXIsIG9yIGltcGxpY2l0bHkgY3JlYXRlZFxyXG4gICAgICAgICAgICAvLyBmcm9tIGFycmF5cy5cclxuICAgICAgICAgICAgbW91bnRDaGlsZHJlbihuMi5jaGlsZHJlbiwgY29udGFpbmVyLCBmcmFnbWVudEVuZEFuY2hvciwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGlmIChwYXRjaEZsYWcgPiAwICYmXHJcbiAgICAgICAgICAgICAgICBwYXRjaEZsYWcgJiA2NCAvKiBTVEFCTEVfRlJBR01FTlQgKi8gJiZcclxuICAgICAgICAgICAgICAgIGR5bmFtaWNDaGlsZHJlbiAmJlxyXG4gICAgICAgICAgICAgICAgLy8gIzI3MTUgdGhlIHByZXZpb3VzIGZyYWdtZW50IGNvdWxkJ3ZlIGJlZW4gYSBCQUlMZWQgb25lIGFzIGEgcmVzdWx0XHJcbiAgICAgICAgICAgICAgICAvLyBvZiByZW5kZXJTbG90KCkgd2l0aCBubyB2YWxpZCBjaGlsZHJlblxyXG4gICAgICAgICAgICAgICAgbjEuZHluYW1pY0NoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBhIHN0YWJsZSBmcmFnbWVudCAodGVtcGxhdGUgcm9vdCBvciA8dGVtcGxhdGUgdi1mb3I+KSBkb2Vzbid0IG5lZWQgdG9cclxuICAgICAgICAgICAgICAgIC8vIHBhdGNoIGNoaWxkcmVuIG9yZGVyLCBidXQgaXQgbWF5IGNvbnRhaW4gZHluYW1pY0NoaWxkcmVuLlxyXG4gICAgICAgICAgICAgICAgcGF0Y2hCbG9ja0NoaWxkcmVuKG4xLmR5bmFtaWNDaGlsZHJlbiwgZHluYW1pY0NoaWxkcmVuLCBjb250YWluZXIsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIGlzU1ZHLCBzbG90U2NvcGVJZHMpO1xyXG4gICAgICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiBwYXJlbnRDb21wb25lbnQgJiYgcGFyZW50Q29tcG9uZW50LnR5cGUuX19obXJJZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRyYXZlcnNlU3RhdGljQ2hpbGRyZW4objEsIG4yKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKFxyXG4gICAgICAgICAgICAgICAgLy8gIzIwODAgaWYgdGhlIHN0YWJsZSBmcmFnbWVudCBoYXMgYSBrZXksIGl0J3MgYSA8dGVtcGxhdGUgdi1mb3I+IHRoYXQgbWF5XHJcbiAgICAgICAgICAgICAgICAvLyAgZ2V0IG1vdmVkIGFyb3VuZC4gTWFrZSBzdXJlIGFsbCByb290IGxldmVsIHZub2RlcyBpbmhlcml0IGVsLlxyXG4gICAgICAgICAgICAgICAgLy8gIzIxMzQgb3IgaWYgaXQncyBhIGNvbXBvbmVudCByb290LCBpdCBtYXkgYWxzbyBnZXQgbW92ZWQgYXJvdW5kXHJcbiAgICAgICAgICAgICAgICAvLyBhcyB0aGUgY29tcG9uZW50IGlzIGJlaW5nIG1vdmVkLlxyXG4gICAgICAgICAgICAgICAgbjIua2V5ICE9IG51bGwgfHxcclxuICAgICAgICAgICAgICAgICAgICAocGFyZW50Q29tcG9uZW50ICYmIG4yID09PSBwYXJlbnRDb21wb25lbnQuc3ViVHJlZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0cmF2ZXJzZVN0YXRpY0NoaWxkcmVuKG4xLCBuMiwgdHJ1ZSAvKiBzaGFsbG93ICovKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIGtleWVkIC8gdW5rZXllZCwgb3IgbWFudWFsIGZyYWdtZW50cy5cclxuICAgICAgICAgICAgICAgIC8vIGZvciBrZXllZCAmIHVua2V5ZWQsIHNpbmNlIHRoZXkgYXJlIGNvbXBpbGVyIGdlbmVyYXRlZCBmcm9tIHYtZm9yLFxyXG4gICAgICAgICAgICAgICAgLy8gZWFjaCBjaGlsZCBpcyBndWFyYW50ZWVkIHRvIGJlIGEgYmxvY2sgc28gdGhlIGZyYWdtZW50IHdpbGwgbmV2ZXJcclxuICAgICAgICAgICAgICAgIC8vIGhhdmUgZHluYW1pY0NoaWxkcmVuLlxyXG4gICAgICAgICAgICAgICAgcGF0Y2hDaGlsZHJlbihuMSwgbjIsIGNvbnRhaW5lciwgZnJhZ21lbnRFbmRBbmNob3IsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIGlzU1ZHLCBzbG90U2NvcGVJZHMsIG9wdGltaXplZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgY29uc3QgcHJvY2Vzc0NvbXBvbmVudCA9IChuMSwgbjIsIGNvbnRhaW5lciwgYW5jaG9yLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCBpc1NWRywgc2xvdFNjb3BlSWRzLCBvcHRpbWl6ZWQpID0+IHtcclxuICAgICAgICBuMi5zbG90U2NvcGVJZHMgPSBzbG90U2NvcGVJZHM7XHJcbiAgICAgICAgaWYgKG4xID09IG51bGwpIHtcclxuICAgICAgICAgICAgaWYgKG4yLnNoYXBlRmxhZyAmIDUxMiAvKiBDT01QT05FTlRfS0VQVF9BTElWRSAqLykge1xyXG4gICAgICAgICAgICAgICAgcGFyZW50Q29tcG9uZW50LmN0eC5hY3RpdmF0ZShuMiwgY29udGFpbmVyLCBhbmNob3IsIGlzU1ZHLCBvcHRpbWl6ZWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbW91bnRDb21wb25lbnQobjIsIGNvbnRhaW5lciwgYW5jaG9yLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCBpc1NWRywgb3B0aW1pemVkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdXBkYXRlQ29tcG9uZW50KG4xLCBuMiwgb3B0aW1pemVkKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgY29uc3QgbW91bnRDb21wb25lbnQgPSAoaW5pdGlhbFZOb2RlLCBjb250YWluZXIsIGFuY2hvciwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcsIG9wdGltaXplZCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGluc3RhbmNlID0gKGluaXRpYWxWTm9kZS5jb21wb25lbnQgPSBjcmVhdGVDb21wb25lbnRJbnN0YW5jZShpbml0aWFsVk5vZGUsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UpKTtcclxuICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmIGluc3RhbmNlLnR5cGUuX19obXJJZCkge1xyXG4gICAgICAgICAgICByZWdpc3RlckhNUihpbnN0YW5jZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgcHVzaFdhcm5pbmdDb250ZXh0KGluaXRpYWxWTm9kZSk7XHJcbiAgICAgICAgICAgIHN0YXJ0TWVhc3VyZShpbnN0YW5jZSwgYG1vdW50YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGluamVjdCByZW5kZXJlciBpbnRlcm5hbHMgZm9yIGtlZXBBbGl2ZVxyXG4gICAgICAgIGlmIChpc0tlZXBBbGl2ZShpbml0aWFsVk5vZGUpKSB7XHJcbiAgICAgICAgICAgIGluc3RhbmNlLmN0eC5yZW5kZXJlciA9IGludGVybmFscztcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gcmVzb2x2ZSBwcm9wcyBhbmQgc2xvdHMgZm9yIHNldHVwIGNvbnRleHRcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgIHN0YXJ0TWVhc3VyZShpbnN0YW5jZSwgYGluaXRgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzZXR1cENvbXBvbmVudChpbnN0YW5jZSk7XHJcbiAgICAgICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgIGVuZE1lYXN1cmUoaW5zdGFuY2UsIGBpbml0YCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gc2V0dXAoKSBpcyBhc3luYy4gVGhpcyBjb21wb25lbnQgcmVsaWVzIG9uIGFzeW5jIGxvZ2ljIHRvIGJlIHJlc29sdmVkXHJcbiAgICAgICAgLy8gYmVmb3JlIHByb2NlZWRpbmdcclxuICAgICAgICBpZiAoaW5zdGFuY2UuYXN5bmNEZXApIHtcclxuICAgICAgICAgICAgcGFyZW50U3VzcGVuc2UgJiYgcGFyZW50U3VzcGVuc2UucmVnaXN0ZXJEZXAoaW5zdGFuY2UsIHNldHVwUmVuZGVyRWZmZWN0KTtcclxuICAgICAgICAgICAgLy8gR2l2ZSBpdCBhIHBsYWNlaG9sZGVyIGlmIHRoaXMgaXMgbm90IGh5ZHJhdGlvblxyXG4gICAgICAgICAgICAvLyBUT0RPIGhhbmRsZSBzZWxmLWRlZmluZWQgZmFsbGJhY2tcclxuICAgICAgICAgICAgaWYgKCFpbml0aWFsVk5vZGUuZWwpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHBsYWNlaG9sZGVyID0gKGluc3RhbmNlLnN1YlRyZWUgPSBjcmVhdGVWTm9kZShDb21tZW50KSk7XHJcbiAgICAgICAgICAgICAgICBwcm9jZXNzQ29tbWVudE5vZGUobnVsbCwgcGxhY2Vob2xkZXIsIGNvbnRhaW5lciwgYW5jaG9yKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHNldHVwUmVuZGVyRWZmZWN0KGluc3RhbmNlLCBpbml0aWFsVk5vZGUsIGNvbnRhaW5lciwgYW5jaG9yLCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcsIG9wdGltaXplZCk7XHJcbiAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgICAgICBwb3BXYXJuaW5nQ29udGV4dCgpO1xyXG4gICAgICAgICAgICBlbmRNZWFzdXJlKGluc3RhbmNlLCBgbW91bnRgKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgY29uc3QgdXBkYXRlQ29tcG9uZW50ID0gKG4xLCBuMiwgb3B0aW1pemVkKSA9PiB7XHJcbiAgICAgICAgY29uc3QgaW5zdGFuY2UgPSAobjIuY29tcG9uZW50ID0gbjEuY29tcG9uZW50KTtcclxuICAgICAgICBpZiAoc2hvdWxkVXBkYXRlQ29tcG9uZW50KG4xLCBuMiwgb3B0aW1pemVkKSkge1xyXG4gICAgICAgICAgICBpZiAoaW5zdGFuY2UuYXN5bmNEZXAgJiZcclxuICAgICAgICAgICAgICAgICFpbnN0YW5jZS5hc3luY1Jlc29sdmVkKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBhc3luYyAmIHN0aWxsIHBlbmRpbmcgLSBqdXN0IHVwZGF0ZSBwcm9wcyBhbmQgc2xvdHNcclxuICAgICAgICAgICAgICAgIC8vIHNpbmNlIHRoZSBjb21wb25lbnQncyByZWFjdGl2ZSBlZmZlY3QgZm9yIHJlbmRlciBpc24ndCBzZXQtdXAgeWV0XHJcbiAgICAgICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcHVzaFdhcm5pbmdDb250ZXh0KG4yKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHVwZGF0ZUNvbXBvbmVudFByZVJlbmRlcihpbnN0YW5jZSwgbjIsIG9wdGltaXplZCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcG9wV2FybmluZ0NvbnRleHQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIG5vcm1hbCB1cGRhdGVcclxuICAgICAgICAgICAgICAgIGluc3RhbmNlLm5leHQgPSBuMjtcclxuICAgICAgICAgICAgICAgIC8vIGluIGNhc2UgdGhlIGNoaWxkIGNvbXBvbmVudCBpcyBhbHNvIHF1ZXVlZCwgcmVtb3ZlIGl0IHRvIGF2b2lkXHJcbiAgICAgICAgICAgICAgICAvLyBkb3VibGUgdXBkYXRpbmcgdGhlIHNhbWUgY2hpbGQgY29tcG9uZW50IGluIHRoZSBzYW1lIGZsdXNoLlxyXG4gICAgICAgICAgICAgICAgaW52YWxpZGF0ZUpvYihpbnN0YW5jZS51cGRhdGUpO1xyXG4gICAgICAgICAgICAgICAgLy8gaW5zdGFuY2UudXBkYXRlIGlzIHRoZSByZWFjdGl2ZSBlZmZlY3QuXHJcbiAgICAgICAgICAgICAgICBpbnN0YW5jZS51cGRhdGUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8gbm8gdXBkYXRlIG5lZWRlZC4ganVzdCBjb3B5IG92ZXIgcHJvcGVydGllc1xyXG4gICAgICAgICAgICBuMi5jb21wb25lbnQgPSBuMS5jb21wb25lbnQ7XHJcbiAgICAgICAgICAgIG4yLmVsID0gbjEuZWw7XHJcbiAgICAgICAgICAgIGluc3RhbmNlLnZub2RlID0gbjI7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGNvbnN0IHNldHVwUmVuZGVyRWZmZWN0ID0gKGluc3RhbmNlLCBpbml0aWFsVk5vZGUsIGNvbnRhaW5lciwgYW5jaG9yLCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcsIG9wdGltaXplZCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGNvbXBvbmVudFVwZGF0ZUZuID0gKCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoIWluc3RhbmNlLmlzTW91bnRlZCkge1xyXG4gICAgICAgICAgICAgICAgbGV0IHZub2RlSG9vaztcclxuICAgICAgICAgICAgICAgIGNvbnN0IHsgZWwsIHByb3BzIH0gPSBpbml0aWFsVk5vZGU7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB7IGJtLCBtLCBwYXJlbnQgfSA9IGluc3RhbmNlO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaXNBc3luY1dyYXBwZXJWTm9kZSA9IGlzQXN5bmNXcmFwcGVyKGluaXRpYWxWTm9kZSk7XHJcbiAgICAgICAgICAgICAgICB0b2dnbGVSZWN1cnNlKGluc3RhbmNlLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAvLyBiZWZvcmVNb3VudCBob29rXHJcbiAgICAgICAgICAgICAgICBpZiAoYm0pIHtcclxuICAgICAgICAgICAgICAgICAgICBpbnZva2VBcnJheUZucyhibSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyBvblZub2RlQmVmb3JlTW91bnRcclxuICAgICAgICAgICAgICAgIGlmICghaXNBc3luY1dyYXBwZXJWTm9kZSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICh2bm9kZUhvb2sgPSBwcm9wcyAmJiBwcm9wcy5vblZub2RlQmVmb3JlTW91bnQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaW52b2tlVk5vZGVIb29rKHZub2RlSG9vaywgcGFyZW50LCBpbml0aWFsVk5vZGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdG9nZ2xlUmVjdXJzZShpbnN0YW5jZSwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoZWwgJiYgaHlkcmF0ZU5vZGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyB2bm9kZSBoYXMgYWRvcHRlZCBob3N0IG5vZGUgLSBwZXJmb3JtIGh5ZHJhdGlvbiBpbnN0ZWFkIG9mIG1vdW50LlxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGh5ZHJhdGVTdWJUcmVlID0gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydE1lYXN1cmUoaW5zdGFuY2UsIGByZW5kZXJgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZS5zdWJUcmVlID0gcmVuZGVyQ29tcG9uZW50Um9vdChpbnN0YW5jZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZE1lYXN1cmUoaW5zdGFuY2UsIGByZW5kZXJgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydE1lYXN1cmUoaW5zdGFuY2UsIGBoeWRyYXRlYCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaHlkcmF0ZU5vZGUoZWwsIGluc3RhbmNlLnN1YlRyZWUsIGluc3RhbmNlLCBwYXJlbnRTdXNwZW5zZSwgbnVsbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZE1lYXN1cmUoaW5zdGFuY2UsIGBoeWRyYXRlYCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpc0FzeW5jV3JhcHBlclZOb2RlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGluaXRpYWxWTm9kZS50eXBlLl9fYXN5bmNMb2FkZXIoKS50aGVuKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBub3RlOiB3ZSBhcmUgbW92aW5nIHRoZSByZW5kZXIgY2FsbCBpbnRvIGFuIGFzeW5jIGNhbGxiYWNrLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB3aGljaCBtZWFucyBpdCB3b24ndCB0cmFjayBkZXBlbmRlbmNpZXMgLSBidXQgaXQncyBvayBiZWNhdXNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGEgc2VydmVyLXJlbmRlcmVkIGFzeW5jIHdyYXBwZXIgaXMgYWxyZWFkeSBpbiByZXNvbHZlZCBzdGF0ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBhbmQgaXQgd2lsbCBuZXZlciBuZWVkIHRvIGNoYW5nZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgKCkgPT4gIWluc3RhbmNlLmlzVW5tb3VudGVkICYmIGh5ZHJhdGVTdWJUcmVlKCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaHlkcmF0ZVN1YlRyZWUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0TWVhc3VyZShpbnN0YW5jZSwgYHJlbmRlcmApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzdWJUcmVlID0gKGluc3RhbmNlLnN1YlRyZWUgPSByZW5kZXJDb21wb25lbnRSb290KGluc3RhbmNlKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbmRNZWFzdXJlKGluc3RhbmNlLCBgcmVuZGVyYCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnRNZWFzdXJlKGluc3RhbmNlLCBgcGF0Y2hgKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcGF0Y2gobnVsbCwgc3ViVHJlZSwgY29udGFpbmVyLCBhbmNob3IsIGluc3RhbmNlLCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZW5kTWVhc3VyZShpbnN0YW5jZSwgYHBhdGNoYCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGluaXRpYWxWTm9kZS5lbCA9IHN1YlRyZWUuZWw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyBtb3VudGVkIGhvb2tcclxuICAgICAgICAgICAgICAgIGlmIChtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcXVldWVQb3N0UmVuZGVyRWZmZWN0KG0sIHBhcmVudFN1c3BlbnNlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIG9uVm5vZGVNb3VudGVkXHJcbiAgICAgICAgICAgICAgICBpZiAoIWlzQXN5bmNXcmFwcGVyVk5vZGUgJiZcclxuICAgICAgICAgICAgICAgICAgICAodm5vZGVIb29rID0gcHJvcHMgJiYgcHJvcHMub25Wbm9kZU1vdW50ZWQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2NvcGVkSW5pdGlhbFZOb2RlID0gaW5pdGlhbFZOb2RlO1xyXG4gICAgICAgICAgICAgICAgICAgIHF1ZXVlUG9zdFJlbmRlckVmZmVjdCgoKSA9PiBpbnZva2VWTm9kZUhvb2sodm5vZGVIb29rLCBwYXJlbnQsIHNjb3BlZEluaXRpYWxWTm9kZSksIHBhcmVudFN1c3BlbnNlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIGFjdGl2YXRlZCBob29rIGZvciBrZWVwLWFsaXZlIHJvb3RzLlxyXG4gICAgICAgICAgICAgICAgLy8gIzE3NDIgYWN0aXZhdGVkIGhvb2sgbXVzdCBiZSBhY2Nlc3NlZCBhZnRlciBmaXJzdCByZW5kZXJcclxuICAgICAgICAgICAgICAgIC8vIHNpbmNlIHRoZSBob29rIG1heSBiZSBpbmplY3RlZCBieSBhIGNoaWxkIGtlZXAtYWxpdmVcclxuICAgICAgICAgICAgICAgIGlmIChpbml0aWFsVk5vZGUuc2hhcGVGbGFnICYgMjU2IC8qIENPTVBPTkVOVF9TSE9VTERfS0VFUF9BTElWRSAqLykge1xyXG4gICAgICAgICAgICAgICAgICAgIGluc3RhbmNlLmEgJiYgcXVldWVQb3N0UmVuZGVyRWZmZWN0KGluc3RhbmNlLmEsIHBhcmVudFN1c3BlbnNlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGluc3RhbmNlLmlzTW91bnRlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHx8IF9fVlVFX1BST0RfREVWVE9PTFNfXykge1xyXG4gICAgICAgICAgICAgICAgICAgIGRldnRvb2xzQ29tcG9uZW50QWRkZWQoaW5zdGFuY2UpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gIzI0NTg6IGRlZmVyZW5jZSBtb3VudC1vbmx5IG9iamVjdCBwYXJhbWV0ZXJzIHRvIHByZXZlbnQgbWVtbGVha3NcclxuICAgICAgICAgICAgICAgIGluaXRpYWxWTm9kZSA9IGNvbnRhaW5lciA9IGFuY2hvciA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyB1cGRhdGVDb21wb25lbnRcclxuICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgdHJpZ2dlcmVkIGJ5IG11dGF0aW9uIG9mIGNvbXBvbmVudCdzIG93biBzdGF0ZSAobmV4dDogbnVsbClcclxuICAgICAgICAgICAgICAgIC8vIE9SIHBhcmVudCBjYWxsaW5nIHByb2Nlc3NDb21wb25lbnQgKG5leHQ6IFZOb2RlKVxyXG4gICAgICAgICAgICAgICAgbGV0IHsgbmV4dCwgYnUsIHUsIHBhcmVudCwgdm5vZGUgfSA9IGluc3RhbmNlO1xyXG4gICAgICAgICAgICAgICAgbGV0IG9yaWdpbk5leHQgPSBuZXh0O1xyXG4gICAgICAgICAgICAgICAgbGV0IHZub2RlSG9vaztcclxuICAgICAgICAgICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgICAgICBwdXNoV2FybmluZ0NvbnRleHQobmV4dCB8fCBpbnN0YW5jZS52bm9kZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyBEaXNhbGxvdyBjb21wb25lbnQgZWZmZWN0IHJlY3Vyc2lvbiBkdXJpbmcgcHJlLWxpZmVjeWNsZSBob29rcy5cclxuICAgICAgICAgICAgICAgIHRvZ2dsZVJlY3Vyc2UoaW5zdGFuY2UsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIGlmIChuZXh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmV4dC5lbCA9IHZub2RlLmVsO1xyXG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZUNvbXBvbmVudFByZVJlbmRlcihpbnN0YW5jZSwgbmV4dCwgb3B0aW1pemVkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIG5leHQgPSB2bm9kZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIGJlZm9yZVVwZGF0ZSBob29rXHJcbiAgICAgICAgICAgICAgICBpZiAoYnUpIHtcclxuICAgICAgICAgICAgICAgICAgICBpbnZva2VBcnJheUZucyhidSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyBvblZub2RlQmVmb3JlVXBkYXRlXHJcbiAgICAgICAgICAgICAgICBpZiAoKHZub2RlSG9vayA9IG5leHQucHJvcHMgJiYgbmV4dC5wcm9wcy5vblZub2RlQmVmb3JlVXBkYXRlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGludm9rZVZOb2RlSG9vayh2bm9kZUhvb2ssIHBhcmVudCwgbmV4dCwgdm5vZGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdG9nZ2xlUmVjdXJzZShpbnN0YW5jZSwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAvLyByZW5kZXJcclxuICAgICAgICAgICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgICAgICBzdGFydE1lYXN1cmUoaW5zdGFuY2UsIGByZW5kZXJgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IG5leHRUcmVlID0gcmVuZGVyQ29tcG9uZW50Um9vdChpbnN0YW5jZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZW5kTWVhc3VyZShpbnN0YW5jZSwgYHJlbmRlcmApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgcHJldlRyZWUgPSBpbnN0YW5jZS5zdWJUcmVlO1xyXG4gICAgICAgICAgICAgICAgaW5zdGFuY2Uuc3ViVHJlZSA9IG5leHRUcmVlO1xyXG4gICAgICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0TWVhc3VyZShpbnN0YW5jZSwgYHBhdGNoYCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBwYXRjaChwcmV2VHJlZSwgbmV4dFRyZWUsIFxyXG4gICAgICAgICAgICAgICAgLy8gcGFyZW50IG1heSBoYXZlIGNoYW5nZWQgaWYgaXQncyBpbiBhIHRlbGVwb3J0XHJcbiAgICAgICAgICAgICAgICBob3N0UGFyZW50Tm9kZShwcmV2VHJlZS5lbCksIFxyXG4gICAgICAgICAgICAgICAgLy8gYW5jaG9yIG1heSBoYXZlIGNoYW5nZWQgaWYgaXQncyBpbiBhIGZyYWdtZW50XHJcbiAgICAgICAgICAgICAgICBnZXROZXh0SG9zdE5vZGUocHJldlRyZWUpLCBpbnN0YW5jZSwgcGFyZW50U3VzcGVuc2UsIGlzU1ZHKTtcclxuICAgICAgICAgICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgICAgICBlbmRNZWFzdXJlKGluc3RhbmNlLCBgcGF0Y2hgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIG5leHQuZWwgPSBuZXh0VHJlZS5lbDtcclxuICAgICAgICAgICAgICAgIGlmIChvcmlnaW5OZXh0ID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gc2VsZi10cmlnZ2VyZWQgdXBkYXRlLiBJbiBjYXNlIG9mIEhPQywgdXBkYXRlIHBhcmVudCBjb21wb25lbnRcclxuICAgICAgICAgICAgICAgICAgICAvLyB2bm9kZSBlbC4gSE9DIGlzIGluZGljYXRlZCBieSBwYXJlbnQgaW5zdGFuY2UncyBzdWJUcmVlIHBvaW50aW5nXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gdG8gY2hpbGQgY29tcG9uZW50J3Mgdm5vZGVcclxuICAgICAgICAgICAgICAgICAgICB1cGRhdGVIT0NIb3N0RWwoaW5zdGFuY2UsIG5leHRUcmVlLmVsKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIHVwZGF0ZWQgaG9va1xyXG4gICAgICAgICAgICAgICAgaWYgKHUpIHtcclxuICAgICAgICAgICAgICAgICAgICBxdWV1ZVBvc3RSZW5kZXJFZmZlY3QodSwgcGFyZW50U3VzcGVuc2UpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gb25Wbm9kZVVwZGF0ZWRcclxuICAgICAgICAgICAgICAgIGlmICgodm5vZGVIb29rID0gbmV4dC5wcm9wcyAmJiBuZXh0LnByb3BzLm9uVm5vZGVVcGRhdGVkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHF1ZXVlUG9zdFJlbmRlckVmZmVjdCgoKSA9PiBpbnZva2VWTm9kZUhvb2sodm5vZGVIb29rLCBwYXJlbnQsIG5leHQsIHZub2RlKSwgcGFyZW50U3VzcGVuc2UpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB8fCBfX1ZVRV9QUk9EX0RFVlRPT0xTX18pIHtcclxuICAgICAgICAgICAgICAgICAgICBkZXZ0b29sc0NvbXBvbmVudFVwZGF0ZWQoaW5zdGFuY2UpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHBvcFdhcm5pbmdDb250ZXh0KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIC8vIGNyZWF0ZSByZWFjdGl2ZSBlZmZlY3QgZm9yIHJlbmRlcmluZ1xyXG4gICAgICAgIGNvbnN0IGVmZmVjdCA9IChpbnN0YW5jZS5lZmZlY3QgPSBuZXcgUmVhY3RpdmVFZmZlY3QoY29tcG9uZW50VXBkYXRlRm4sICgpID0+IHF1ZXVlSm9iKGluc3RhbmNlLnVwZGF0ZSksIGluc3RhbmNlLnNjb3BlIC8vIHRyYWNrIGl0IGluIGNvbXBvbmVudCdzIGVmZmVjdCBzY29wZVxyXG4gICAgICAgICkpO1xyXG4gICAgICAgIGNvbnN0IHVwZGF0ZSA9IChpbnN0YW5jZS51cGRhdGUgPSBlZmZlY3QucnVuLmJpbmQoZWZmZWN0KSk7XHJcbiAgICAgICAgdXBkYXRlLmlkID0gaW5zdGFuY2UudWlkO1xyXG4gICAgICAgIC8vIGFsbG93UmVjdXJzZVxyXG4gICAgICAgIC8vICMxODAxLCAjMjA0MyBjb21wb25lbnQgcmVuZGVyIGVmZmVjdHMgc2hvdWxkIGFsbG93IHJlY3Vyc2l2ZSB1cGRhdGVzXHJcbiAgICAgICAgdG9nZ2xlUmVjdXJzZShpbnN0YW5jZSwgdHJ1ZSk7XHJcbiAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgICAgICBlZmZlY3Qub25UcmFjayA9IGluc3RhbmNlLnJ0Y1xyXG4gICAgICAgICAgICAgICAgPyBlID0+IGludm9rZUFycmF5Rm5zKGluc3RhbmNlLnJ0YywgZSlcclxuICAgICAgICAgICAgICAgIDogdm9pZCAwO1xyXG4gICAgICAgICAgICBlZmZlY3Qub25UcmlnZ2VyID0gaW5zdGFuY2UucnRnXHJcbiAgICAgICAgICAgICAgICA/IGUgPT4gaW52b2tlQXJyYXlGbnMoaW5zdGFuY2UucnRnLCBlKVxyXG4gICAgICAgICAgICAgICAgOiB2b2lkIDA7XHJcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmUgKGZvciBzY2hlZHVsZXIpXHJcbiAgICAgICAgICAgIHVwZGF0ZS5vd25lckluc3RhbmNlID0gaW5zdGFuY2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHVwZGF0ZSgpO1xyXG4gICAgfTtcclxuICAgIGNvbnN0IHVwZGF0ZUNvbXBvbmVudFByZVJlbmRlciA9IChpbnN0YW5jZSwgbmV4dFZOb2RlLCBvcHRpbWl6ZWQpID0+IHtcclxuICAgICAgICBuZXh0Vk5vZGUuY29tcG9uZW50ID0gaW5zdGFuY2U7XHJcbiAgICAgICAgY29uc3QgcHJldlByb3BzID0gaW5zdGFuY2Uudm5vZGUucHJvcHM7XHJcbiAgICAgICAgaW5zdGFuY2Uudm5vZGUgPSBuZXh0Vk5vZGU7XHJcbiAgICAgICAgaW5zdGFuY2UubmV4dCA9IG51bGw7XHJcbiAgICAgICAgdXBkYXRlUHJvcHMoaW5zdGFuY2UsIG5leHRWTm9kZS5wcm9wcywgcHJldlByb3BzLCBvcHRpbWl6ZWQpO1xyXG4gICAgICAgIHVwZGF0ZVNsb3RzKGluc3RhbmNlLCBuZXh0Vk5vZGUuY2hpbGRyZW4sIG9wdGltaXplZCk7XHJcbiAgICAgICAgcGF1c2VUcmFja2luZygpO1xyXG4gICAgICAgIC8vIHByb3BzIHVwZGF0ZSBtYXkgaGF2ZSB0cmlnZ2VyZWQgcHJlLWZsdXNoIHdhdGNoZXJzLlxyXG4gICAgICAgIC8vIGZsdXNoIHRoZW0gYmVmb3JlIHRoZSByZW5kZXIgdXBkYXRlLlxyXG4gICAgICAgIGZsdXNoUHJlRmx1c2hDYnModW5kZWZpbmVkLCBpbnN0YW5jZS51cGRhdGUpO1xyXG4gICAgICAgIHJlc2V0VHJhY2tpbmcoKTtcclxuICAgIH07XHJcbiAgICBjb25zdCBwYXRjaENoaWxkcmVuID0gKG4xLCBuMiwgY29udGFpbmVyLCBhbmNob3IsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIGlzU1ZHLCBzbG90U2NvcGVJZHMsIG9wdGltaXplZCA9IGZhbHNlKSA9PiB7XHJcbiAgICAgICAgY29uc3QgYzEgPSBuMSAmJiBuMS5jaGlsZHJlbjtcclxuICAgICAgICBjb25zdCBwcmV2U2hhcGVGbGFnID0gbjEgPyBuMS5zaGFwZUZsYWcgOiAwO1xyXG4gICAgICAgIGNvbnN0IGMyID0gbjIuY2hpbGRyZW47XHJcbiAgICAgICAgY29uc3QgeyBwYXRjaEZsYWcsIHNoYXBlRmxhZyB9ID0gbjI7XHJcbiAgICAgICAgLy8gZmFzdCBwYXRoXHJcbiAgICAgICAgaWYgKHBhdGNoRmxhZyA+IDApIHtcclxuICAgICAgICAgICAgaWYgKHBhdGNoRmxhZyAmIDEyOCAvKiBLRVlFRF9GUkFHTUVOVCAqLykge1xyXG4gICAgICAgICAgICAgICAgLy8gdGhpcyBjb3VsZCBiZSBlaXRoZXIgZnVsbHkta2V5ZWQgb3IgbWl4ZWQgKHNvbWUga2V5ZWQgc29tZSBub3QpXHJcbiAgICAgICAgICAgICAgICAvLyBwcmVzZW5jZSBvZiBwYXRjaEZsYWcgbWVhbnMgY2hpbGRyZW4gYXJlIGd1YXJhbnRlZWQgdG8gYmUgYXJyYXlzXHJcbiAgICAgICAgICAgICAgICBwYXRjaEtleWVkQ2hpbGRyZW4oYzEsIGMyLCBjb250YWluZXIsIGFuY2hvciwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChwYXRjaEZsYWcgJiAyNTYgLyogVU5LRVlFRF9GUkFHTUVOVCAqLykge1xyXG4gICAgICAgICAgICAgICAgLy8gdW5rZXllZFxyXG4gICAgICAgICAgICAgICAgcGF0Y2hVbmtleWVkQ2hpbGRyZW4oYzEsIGMyLCBjb250YWluZXIsIGFuY2hvciwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBjaGlsZHJlbiBoYXMgMyBwb3NzaWJpbGl0aWVzOiB0ZXh0LCBhcnJheSBvciBubyBjaGlsZHJlbi5cclxuICAgICAgICBpZiAoc2hhcGVGbGFnICYgOCAvKiBURVhUX0NISUxEUkVOICovKSB7XHJcbiAgICAgICAgICAgIC8vIHRleHQgY2hpbGRyZW4gZmFzdCBwYXRoXHJcbiAgICAgICAgICAgIGlmIChwcmV2U2hhcGVGbGFnICYgMTYgLyogQVJSQVlfQ0hJTERSRU4gKi8pIHtcclxuICAgICAgICAgICAgICAgIHVubW91bnRDaGlsZHJlbihjMSwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGMyICE9PSBjMSkge1xyXG4gICAgICAgICAgICAgICAgaG9zdFNldEVsZW1lbnRUZXh0KGNvbnRhaW5lciwgYzIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAocHJldlNoYXBlRmxhZyAmIDE2IC8qIEFSUkFZX0NISUxEUkVOICovKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBwcmV2IGNoaWxkcmVuIHdhcyBhcnJheVxyXG4gICAgICAgICAgICAgICAgaWYgKHNoYXBlRmxhZyAmIDE2IC8qIEFSUkFZX0NISUxEUkVOICovKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gdHdvIGFycmF5cywgY2Fubm90IGFzc3VtZSBhbnl0aGluZywgZG8gZnVsbCBkaWZmXHJcbiAgICAgICAgICAgICAgICAgICAgcGF0Y2hLZXllZENoaWxkcmVuKGMxLCBjMiwgY29udGFpbmVyLCBhbmNob3IsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIGlzU1ZHLCBzbG90U2NvcGVJZHMsIG9wdGltaXplZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBubyBuZXcgY2hpbGRyZW4sIGp1c3QgdW5tb3VudCBvbGRcclxuICAgICAgICAgICAgICAgICAgICB1bm1vdW50Q2hpbGRyZW4oYzEsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gcHJldiBjaGlsZHJlbiB3YXMgdGV4dCBPUiBudWxsXHJcbiAgICAgICAgICAgICAgICAvLyBuZXcgY2hpbGRyZW4gaXMgYXJyYXkgT1IgbnVsbFxyXG4gICAgICAgICAgICAgICAgaWYgKHByZXZTaGFwZUZsYWcgJiA4IC8qIFRFWFRfQ0hJTERSRU4gKi8pIHtcclxuICAgICAgICAgICAgICAgICAgICBob3N0U2V0RWxlbWVudFRleHQoY29udGFpbmVyLCAnJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyBtb3VudCBuZXcgaWYgYXJyYXlcclxuICAgICAgICAgICAgICAgIGlmIChzaGFwZUZsYWcgJiAxNiAvKiBBUlJBWV9DSElMRFJFTiAqLykge1xyXG4gICAgICAgICAgICAgICAgICAgIG1vdW50Q2hpbGRyZW4oYzIsIGNvbnRhaW5lciwgYW5jaG9yLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCBpc1NWRywgc2xvdFNjb3BlSWRzLCBvcHRpbWl6ZWQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGNvbnN0IHBhdGNoVW5rZXllZENoaWxkcmVuID0gKGMxLCBjMiwgY29udGFpbmVyLCBhbmNob3IsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIGlzU1ZHLCBzbG90U2NvcGVJZHMsIG9wdGltaXplZCkgPT4ge1xyXG4gICAgICAgIGMxID0gYzEgfHwgRU1QVFlfQVJSO1xyXG4gICAgICAgIGMyID0gYzIgfHwgRU1QVFlfQVJSO1xyXG4gICAgICAgIGNvbnN0IG9sZExlbmd0aCA9IGMxLmxlbmd0aDtcclxuICAgICAgICBjb25zdCBuZXdMZW5ndGggPSBjMi5sZW5ndGg7XHJcbiAgICAgICAgY29uc3QgY29tbW9uTGVuZ3RoID0gTWF0aC5taW4ob2xkTGVuZ3RoLCBuZXdMZW5ndGgpO1xyXG4gICAgICAgIGxldCBpO1xyXG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBjb21tb25MZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBjb25zdCBuZXh0Q2hpbGQgPSAoYzJbaV0gPSBvcHRpbWl6ZWRcclxuICAgICAgICAgICAgICAgID8gY2xvbmVJZk1vdW50ZWQoYzJbaV0pXHJcbiAgICAgICAgICAgICAgICA6IG5vcm1hbGl6ZVZOb2RlKGMyW2ldKSk7XHJcbiAgICAgICAgICAgIHBhdGNoKGMxW2ldLCBuZXh0Q2hpbGQsIGNvbnRhaW5lciwgbnVsbCwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKG9sZExlbmd0aCA+IG5ld0xlbmd0aCkge1xyXG4gICAgICAgICAgICAvLyByZW1vdmUgb2xkXHJcbiAgICAgICAgICAgIHVubW91bnRDaGlsZHJlbihjMSwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgdHJ1ZSwgZmFsc2UsIGNvbW1vbkxlbmd0aCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBtb3VudCBuZXdcclxuICAgICAgICAgICAgbW91bnRDaGlsZHJlbihjMiwgY29udGFpbmVyLCBhbmNob3IsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIGlzU1ZHLCBzbG90U2NvcGVJZHMsIG9wdGltaXplZCwgY29tbW9uTGVuZ3RoKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLy8gY2FuIGJlIGFsbC1rZXllZCBvciBtaXhlZFxyXG4gICAgY29uc3QgcGF0Y2hLZXllZENoaWxkcmVuID0gKGMxLCBjMiwgY29udGFpbmVyLCBwYXJlbnRBbmNob3IsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIGlzU1ZHLCBzbG90U2NvcGVJZHMsIG9wdGltaXplZCkgPT4ge1xyXG4gICAgICAgIGxldCBpID0gMDtcclxuICAgICAgICBjb25zdCBsMiA9IGMyLmxlbmd0aDtcclxuICAgICAgICBsZXQgZTEgPSBjMS5sZW5ndGggLSAxOyAvLyBwcmV2IGVuZGluZyBpbmRleFxyXG4gICAgICAgIGxldCBlMiA9IGwyIC0gMTsgLy8gbmV4dCBlbmRpbmcgaW5kZXhcclxuICAgICAgICAvLyAxLiBzeW5jIGZyb20gc3RhcnRcclxuICAgICAgICAvLyAoYSBiKSBjXHJcbiAgICAgICAgLy8gKGEgYikgZCBlXHJcbiAgICAgICAgd2hpbGUgKGkgPD0gZTEgJiYgaSA8PSBlMikge1xyXG4gICAgICAgICAgICBjb25zdCBuMSA9IGMxW2ldO1xyXG4gICAgICAgICAgICBjb25zdCBuMiA9IChjMltpXSA9IG9wdGltaXplZFxyXG4gICAgICAgICAgICAgICAgPyBjbG9uZUlmTW91bnRlZChjMltpXSlcclxuICAgICAgICAgICAgICAgIDogbm9ybWFsaXplVk5vZGUoYzJbaV0pKTtcclxuICAgICAgICAgICAgaWYgKGlzU2FtZVZOb2RlVHlwZShuMSwgbjIpKSB7XHJcbiAgICAgICAgICAgICAgICBwYXRjaChuMSwgbjIsIGNvbnRhaW5lciwgbnVsbCwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGkrKztcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gMi4gc3luYyBmcm9tIGVuZFxyXG4gICAgICAgIC8vIGEgKGIgYylcclxuICAgICAgICAvLyBkIGUgKGIgYylcclxuICAgICAgICB3aGlsZSAoaSA8PSBlMSAmJiBpIDw9IGUyKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG4xID0gYzFbZTFdO1xyXG4gICAgICAgICAgICBjb25zdCBuMiA9IChjMltlMl0gPSBvcHRpbWl6ZWRcclxuICAgICAgICAgICAgICAgID8gY2xvbmVJZk1vdW50ZWQoYzJbZTJdKVxyXG4gICAgICAgICAgICAgICAgOiBub3JtYWxpemVWTm9kZShjMltlMl0pKTtcclxuICAgICAgICAgICAgaWYgKGlzU2FtZVZOb2RlVHlwZShuMSwgbjIpKSB7XHJcbiAgICAgICAgICAgICAgICBwYXRjaChuMSwgbjIsIGNvbnRhaW5lciwgbnVsbCwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGUxLS07XHJcbiAgICAgICAgICAgIGUyLS07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIDMuIGNvbW1vbiBzZXF1ZW5jZSArIG1vdW50XHJcbiAgICAgICAgLy8gKGEgYilcclxuICAgICAgICAvLyAoYSBiKSBjXHJcbiAgICAgICAgLy8gaSA9IDIsIGUxID0gMSwgZTIgPSAyXHJcbiAgICAgICAgLy8gKGEgYilcclxuICAgICAgICAvLyBjIChhIGIpXHJcbiAgICAgICAgLy8gaSA9IDAsIGUxID0gLTEsIGUyID0gMFxyXG4gICAgICAgIGlmIChpID4gZTEpIHtcclxuICAgICAgICAgICAgaWYgKGkgPD0gZTIpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5leHRQb3MgPSBlMiArIDE7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBhbmNob3IgPSBuZXh0UG9zIDwgbDIgPyBjMltuZXh0UG9zXS5lbCA6IHBhcmVudEFuY2hvcjtcclxuICAgICAgICAgICAgICAgIHdoaWxlIChpIDw9IGUyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcGF0Y2gobnVsbCwgKGMyW2ldID0gb3B0aW1pemVkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgID8gY2xvbmVJZk1vdW50ZWQoYzJbaV0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDogbm9ybWFsaXplVk5vZGUoYzJbaV0pKSwgY29udGFpbmVyLCBhbmNob3IsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIGlzU1ZHLCBzbG90U2NvcGVJZHMsIG9wdGltaXplZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaSsrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIDQuIGNvbW1vbiBzZXF1ZW5jZSArIHVubW91bnRcclxuICAgICAgICAvLyAoYSBiKSBjXHJcbiAgICAgICAgLy8gKGEgYilcclxuICAgICAgICAvLyBpID0gMiwgZTEgPSAyLCBlMiA9IDFcclxuICAgICAgICAvLyBhIChiIGMpXHJcbiAgICAgICAgLy8gKGIgYylcclxuICAgICAgICAvLyBpID0gMCwgZTEgPSAwLCBlMiA9IC0xXHJcbiAgICAgICAgZWxzZSBpZiAoaSA+IGUyKSB7XHJcbiAgICAgICAgICAgIHdoaWxlIChpIDw9IGUxKSB7XHJcbiAgICAgICAgICAgICAgICB1bm1vdW50KGMxW2ldLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgIGkrKztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyA1LiB1bmtub3duIHNlcXVlbmNlXHJcbiAgICAgICAgLy8gW2kgLi4uIGUxICsgMV06IGEgYiBbYyBkIGVdIGYgZ1xyXG4gICAgICAgIC8vIFtpIC4uLiBlMiArIDFdOiBhIGIgW2UgZCBjIGhdIGYgZ1xyXG4gICAgICAgIC8vIGkgPSAyLCBlMSA9IDQsIGUyID0gNVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zdCBzMSA9IGk7IC8vIHByZXYgc3RhcnRpbmcgaW5kZXhcclxuICAgICAgICAgICAgY29uc3QgczIgPSBpOyAvLyBuZXh0IHN0YXJ0aW5nIGluZGV4XHJcbiAgICAgICAgICAgIC8vIDUuMSBidWlsZCBrZXk6aW5kZXggbWFwIGZvciBuZXdDaGlsZHJlblxyXG4gICAgICAgICAgICBjb25zdCBrZXlUb05ld0luZGV4TWFwID0gbmV3IE1hcCgpO1xyXG4gICAgICAgICAgICBmb3IgKGkgPSBzMjsgaSA8PSBlMjsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuZXh0Q2hpbGQgPSAoYzJbaV0gPSBvcHRpbWl6ZWRcclxuICAgICAgICAgICAgICAgICAgICA/IGNsb25lSWZNb3VudGVkKGMyW2ldKVxyXG4gICAgICAgICAgICAgICAgICAgIDogbm9ybWFsaXplVk5vZGUoYzJbaV0pKTtcclxuICAgICAgICAgICAgICAgIGlmIChuZXh0Q2hpbGQua2V5ICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmIGtleVRvTmV3SW5kZXhNYXAuaGFzKG5leHRDaGlsZC5rZXkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdhcm4oYER1cGxpY2F0ZSBrZXlzIGZvdW5kIGR1cmluZyB1cGRhdGU6YCwgSlNPTi5zdHJpbmdpZnkobmV4dENoaWxkLmtleSksIGBNYWtlIHN1cmUga2V5cyBhcmUgdW5pcXVlLmApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBrZXlUb05ld0luZGV4TWFwLnNldChuZXh0Q2hpbGQua2V5LCBpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyA1LjIgbG9vcCB0aHJvdWdoIG9sZCBjaGlsZHJlbiBsZWZ0IHRvIGJlIHBhdGNoZWQgYW5kIHRyeSB0byBwYXRjaFxyXG4gICAgICAgICAgICAvLyBtYXRjaGluZyBub2RlcyAmIHJlbW92ZSBub2RlcyB0aGF0IGFyZSBubyBsb25nZXIgcHJlc2VudFxyXG4gICAgICAgICAgICBsZXQgajtcclxuICAgICAgICAgICAgbGV0IHBhdGNoZWQgPSAwO1xyXG4gICAgICAgICAgICBjb25zdCB0b0JlUGF0Y2hlZCA9IGUyIC0gczIgKyAxO1xyXG4gICAgICAgICAgICBsZXQgbW92ZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgLy8gdXNlZCB0byB0cmFjayB3aGV0aGVyIGFueSBub2RlIGhhcyBtb3ZlZFxyXG4gICAgICAgICAgICBsZXQgbWF4TmV3SW5kZXhTb0ZhciA9IDA7XHJcbiAgICAgICAgICAgIC8vIHdvcmtzIGFzIE1hcDxuZXdJbmRleCwgb2xkSW5kZXg+XHJcbiAgICAgICAgICAgIC8vIE5vdGUgdGhhdCBvbGRJbmRleCBpcyBvZmZzZXQgYnkgKzFcclxuICAgICAgICAgICAgLy8gYW5kIG9sZEluZGV4ID0gMCBpcyBhIHNwZWNpYWwgdmFsdWUgaW5kaWNhdGluZyB0aGUgbmV3IG5vZGUgaGFzXHJcbiAgICAgICAgICAgIC8vIG5vIGNvcnJlc3BvbmRpbmcgb2xkIG5vZGUuXHJcbiAgICAgICAgICAgIC8vIHVzZWQgZm9yIGRldGVybWluaW5nIGxvbmdlc3Qgc3RhYmxlIHN1YnNlcXVlbmNlXHJcbiAgICAgICAgICAgIGNvbnN0IG5ld0luZGV4VG9PbGRJbmRleE1hcCA9IG5ldyBBcnJheSh0b0JlUGF0Y2hlZCk7XHJcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCB0b0JlUGF0Y2hlZDsgaSsrKVxyXG4gICAgICAgICAgICAgICAgbmV3SW5kZXhUb09sZEluZGV4TWFwW2ldID0gMDtcclxuICAgICAgICAgICAgZm9yIChpID0gczE7IGkgPD0gZTE7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcHJldkNoaWxkID0gYzFbaV07XHJcbiAgICAgICAgICAgICAgICBpZiAocGF0Y2hlZCA+PSB0b0JlUGF0Y2hlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGFsbCBuZXcgY2hpbGRyZW4gaGF2ZSBiZWVuIHBhdGNoZWQgc28gdGhpcyBjYW4gb25seSBiZSBhIHJlbW92YWxcclxuICAgICAgICAgICAgICAgICAgICB1bm1vdW50KHByZXZDaGlsZCwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBsZXQgbmV3SW5kZXg7XHJcbiAgICAgICAgICAgICAgICBpZiAocHJldkNoaWxkLmtleSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmV3SW5kZXggPSBrZXlUb05ld0luZGV4TWFwLmdldChwcmV2Q2hpbGQua2V5KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGtleS1sZXNzIG5vZGUsIHRyeSB0byBsb2NhdGUgYSBrZXktbGVzcyBub2RlIG9mIHRoZSBzYW1lIHR5cGVcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGogPSBzMjsgaiA8PSBlMjsgaisrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuZXdJbmRleFRvT2xkSW5kZXhNYXBbaiAtIHMyXSA9PT0gMCAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNTYW1lVk5vZGVUeXBlKHByZXZDaGlsZCwgYzJbal0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdJbmRleCA9IGo7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChuZXdJbmRleCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdW5tb3VudChwcmV2Q2hpbGQsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmV3SW5kZXhUb09sZEluZGV4TWFwW25ld0luZGV4IC0gczJdID0gaSArIDE7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5ld0luZGV4ID49IG1heE5ld0luZGV4U29GYXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWF4TmV3SW5kZXhTb0ZhciA9IG5ld0luZGV4O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbW92ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBwYXRjaChwcmV2Q2hpbGQsIGMyW25ld0luZGV4XSwgY29udGFpbmVyLCBudWxsLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCBpc1NWRywgc2xvdFNjb3BlSWRzLCBvcHRpbWl6ZWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHBhdGNoZWQrKztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyA1LjMgbW92ZSBhbmQgbW91bnRcclxuICAgICAgICAgICAgLy8gZ2VuZXJhdGUgbG9uZ2VzdCBzdGFibGUgc3Vic2VxdWVuY2Ugb25seSB3aGVuIG5vZGVzIGhhdmUgbW92ZWRcclxuICAgICAgICAgICAgY29uc3QgaW5jcmVhc2luZ05ld0luZGV4U2VxdWVuY2UgPSBtb3ZlZFxyXG4gICAgICAgICAgICAgICAgPyBnZXRTZXF1ZW5jZShuZXdJbmRleFRvT2xkSW5kZXhNYXApXHJcbiAgICAgICAgICAgICAgICA6IEVNUFRZX0FSUjtcclxuICAgICAgICAgICAgaiA9IGluY3JlYXNpbmdOZXdJbmRleFNlcXVlbmNlLmxlbmd0aCAtIDE7XHJcbiAgICAgICAgICAgIC8vIGxvb3BpbmcgYmFja3dhcmRzIHNvIHRoYXQgd2UgY2FuIHVzZSBsYXN0IHBhdGNoZWQgbm9kZSBhcyBhbmNob3JcclxuICAgICAgICAgICAgZm9yIChpID0gdG9CZVBhdGNoZWQgLSAxOyBpID49IDA7IGktLSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbmV4dEluZGV4ID0gczIgKyBpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbmV4dENoaWxkID0gYzJbbmV4dEluZGV4XTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGFuY2hvciA9IG5leHRJbmRleCArIDEgPCBsMiA/IGMyW25leHRJbmRleCArIDFdLmVsIDogcGFyZW50QW5jaG9yO1xyXG4gICAgICAgICAgICAgICAgaWYgKG5ld0luZGV4VG9PbGRJbmRleE1hcFtpXSA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIG1vdW50IG5ld1xyXG4gICAgICAgICAgICAgICAgICAgIHBhdGNoKG51bGwsIG5leHRDaGlsZCwgY29udGFpbmVyLCBhbmNob3IsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIGlzU1ZHLCBzbG90U2NvcGVJZHMsIG9wdGltaXplZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChtb3ZlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIG1vdmUgaWY6XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gVGhlcmUgaXMgbm8gc3RhYmxlIHN1YnNlcXVlbmNlIChlLmcuIGEgcmV2ZXJzZSlcclxuICAgICAgICAgICAgICAgICAgICAvLyBPUiBjdXJyZW50IG5vZGUgaXMgbm90IGFtb25nIHRoZSBzdGFibGUgc2VxdWVuY2VcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaiA8IDAgfHwgaSAhPT0gaW5jcmVhc2luZ05ld0luZGV4U2VxdWVuY2Vbal0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbW92ZShuZXh0Q2hpbGQsIGNvbnRhaW5lciwgYW5jaG9yLCAyIC8qIFJFT1JERVIgKi8pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgai0tO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBjb25zdCBtb3ZlID0gKHZub2RlLCBjb250YWluZXIsIGFuY2hvciwgbW92ZVR5cGUsIHBhcmVudFN1c3BlbnNlID0gbnVsbCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IHsgZWwsIHR5cGUsIHRyYW5zaXRpb24sIGNoaWxkcmVuLCBzaGFwZUZsYWcgfSA9IHZub2RlO1xyXG4gICAgICAgIGlmIChzaGFwZUZsYWcgJiA2IC8qIENPTVBPTkVOVCAqLykge1xyXG4gICAgICAgICAgICBtb3ZlKHZub2RlLmNvbXBvbmVudC5zdWJUcmVlLCBjb250YWluZXIsIGFuY2hvciwgbW92ZVR5cGUpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChzaGFwZUZsYWcgJiAxMjggLyogU1VTUEVOU0UgKi8pIHtcclxuICAgICAgICAgICAgdm5vZGUuc3VzcGVuc2UubW92ZShjb250YWluZXIsIGFuY2hvciwgbW92ZVR5cGUpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChzaGFwZUZsYWcgJiA2NCAvKiBURUxFUE9SVCAqLykge1xyXG4gICAgICAgICAgICB0eXBlLm1vdmUodm5vZGUsIGNvbnRhaW5lciwgYW5jaG9yLCBpbnRlcm5hbHMpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0eXBlID09PSBGcmFnbWVudCkge1xyXG4gICAgICAgICAgICBob3N0SW5zZXJ0KGVsLCBjb250YWluZXIsIGFuY2hvcik7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIG1vdmUoY2hpbGRyZW5baV0sIGNvbnRhaW5lciwgYW5jaG9yLCBtb3ZlVHlwZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaG9zdEluc2VydCh2bm9kZS5hbmNob3IsIGNvbnRhaW5lciwgYW5jaG9yKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodHlwZSA9PT0gU3RhdGljKSB7XHJcbiAgICAgICAgICAgIG1vdmVTdGF0aWNOb2RlKHZub2RlLCBjb250YWluZXIsIGFuY2hvcik7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gc2luZ2xlIG5vZGVzXHJcbiAgICAgICAgY29uc3QgbmVlZFRyYW5zaXRpb24gPSBtb3ZlVHlwZSAhPT0gMiAvKiBSRU9SREVSICovICYmXHJcbiAgICAgICAgICAgIHNoYXBlRmxhZyAmIDEgLyogRUxFTUVOVCAqLyAmJlxyXG4gICAgICAgICAgICB0cmFuc2l0aW9uO1xyXG4gICAgICAgIGlmIChuZWVkVHJhbnNpdGlvbikge1xyXG4gICAgICAgICAgICBpZiAobW92ZVR5cGUgPT09IDAgLyogRU5URVIgKi8pIHtcclxuICAgICAgICAgICAgICAgIHRyYW5zaXRpb24uYmVmb3JlRW50ZXIoZWwpO1xyXG4gICAgICAgICAgICAgICAgaG9zdEluc2VydChlbCwgY29udGFpbmVyLCBhbmNob3IpO1xyXG4gICAgICAgICAgICAgICAgcXVldWVQb3N0UmVuZGVyRWZmZWN0KCgpID0+IHRyYW5zaXRpb24uZW50ZXIoZWwpLCBwYXJlbnRTdXNwZW5zZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB7IGxlYXZlLCBkZWxheUxlYXZlLCBhZnRlckxlYXZlIH0gPSB0cmFuc2l0aW9uO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcmVtb3ZlID0gKCkgPT4gaG9zdEluc2VydChlbCwgY29udGFpbmVyLCBhbmNob3IpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcGVyZm9ybUxlYXZlID0gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGxlYXZlKGVsLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhZnRlckxlYXZlICYmIGFmdGVyTGVhdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICBpZiAoZGVsYXlMZWF2ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRlbGF5TGVhdmUoZWwsIHJlbW92ZSwgcGVyZm9ybUxlYXZlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHBlcmZvcm1MZWF2ZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBob3N0SW5zZXJ0KGVsLCBjb250YWluZXIsIGFuY2hvcik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGNvbnN0IHVubW91bnQgPSAodm5vZGUsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIGRvUmVtb3ZlID0gZmFsc2UsIG9wdGltaXplZCA9IGZhbHNlKSA9PiB7XHJcbiAgICAgICAgY29uc3QgeyB0eXBlLCBwcm9wcywgcmVmLCBjaGlsZHJlbiwgZHluYW1pY0NoaWxkcmVuLCBzaGFwZUZsYWcsIHBhdGNoRmxhZywgZGlycyB9ID0gdm5vZGU7XHJcbiAgICAgICAgLy8gdW5zZXQgcmVmXHJcbiAgICAgICAgaWYgKHJlZiAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHNldFJlZihyZWYsIG51bGwsIHBhcmVudFN1c3BlbnNlLCB2bm9kZSwgdHJ1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChzaGFwZUZsYWcgJiAyNTYgLyogQ09NUE9ORU5UX1NIT1VMRF9LRUVQX0FMSVZFICovKSB7XHJcbiAgICAgICAgICAgIHBhcmVudENvbXBvbmVudC5jdHguZGVhY3RpdmF0ZSh2bm9kZSk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3Qgc2hvdWxkSW52b2tlRGlycyA9IHNoYXBlRmxhZyAmIDEgLyogRUxFTUVOVCAqLyAmJiBkaXJzO1xyXG4gICAgICAgIGNvbnN0IHNob3VsZEludm9rZVZub2RlSG9vayA9ICFpc0FzeW5jV3JhcHBlcih2bm9kZSk7XHJcbiAgICAgICAgbGV0IHZub2RlSG9vaztcclxuICAgICAgICBpZiAoc2hvdWxkSW52b2tlVm5vZGVIb29rICYmXHJcbiAgICAgICAgICAgICh2bm9kZUhvb2sgPSBwcm9wcyAmJiBwcm9wcy5vblZub2RlQmVmb3JlVW5tb3VudCkpIHtcclxuICAgICAgICAgICAgaW52b2tlVk5vZGVIb29rKHZub2RlSG9vaywgcGFyZW50Q29tcG9uZW50LCB2bm9kZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChzaGFwZUZsYWcgJiA2IC8qIENPTVBPTkVOVCAqLykge1xyXG4gICAgICAgICAgICB1bm1vdW50Q29tcG9uZW50KHZub2RlLmNvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIGRvUmVtb3ZlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGlmIChzaGFwZUZsYWcgJiAxMjggLyogU1VTUEVOU0UgKi8pIHtcclxuICAgICAgICAgICAgICAgIHZub2RlLnN1c3BlbnNlLnVubW91bnQocGFyZW50U3VzcGVuc2UsIGRvUmVtb3ZlKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoc2hvdWxkSW52b2tlRGlycykge1xyXG4gICAgICAgICAgICAgICAgaW52b2tlRGlyZWN0aXZlSG9vayh2bm9kZSwgbnVsbCwgcGFyZW50Q29tcG9uZW50LCAnYmVmb3JlVW5tb3VudCcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChzaGFwZUZsYWcgJiA2NCAvKiBURUxFUE9SVCAqLykge1xyXG4gICAgICAgICAgICAgICAgdm5vZGUudHlwZS5yZW1vdmUodm5vZGUsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIG9wdGltaXplZCwgaW50ZXJuYWxzLCBkb1JlbW92ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoZHluYW1pY0NoaWxkcmVuICYmXHJcbiAgICAgICAgICAgICAgICAvLyAjMTE1MzogZmFzdCBwYXRoIHNob3VsZCBub3QgYmUgdGFrZW4gZm9yIG5vbi1zdGFibGUgKHYtZm9yKSBmcmFnbWVudHNcclxuICAgICAgICAgICAgICAgICh0eXBlICE9PSBGcmFnbWVudCB8fFxyXG4gICAgICAgICAgICAgICAgICAgIChwYXRjaEZsYWcgPiAwICYmIHBhdGNoRmxhZyAmIDY0IC8qIFNUQUJMRV9GUkFHTUVOVCAqLykpKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBmYXN0IHBhdGggZm9yIGJsb2NrIG5vZGVzOiBvbmx5IG5lZWQgdG8gdW5tb3VudCBkeW5hbWljIGNoaWxkcmVuLlxyXG4gICAgICAgICAgICAgICAgdW5tb3VudENoaWxkcmVuKGR5bmFtaWNDaGlsZHJlbiwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgZmFsc2UsIHRydWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKCh0eXBlID09PSBGcmFnbWVudCAmJlxyXG4gICAgICAgICAgICAgICAgcGF0Y2hGbGFnICZcclxuICAgICAgICAgICAgICAgICAgICAoMTI4IC8qIEtFWUVEX0ZSQUdNRU5UICovIHwgMjU2IC8qIFVOS0VZRURfRlJBR01FTlQgKi8pKSB8fFxyXG4gICAgICAgICAgICAgICAgKCFvcHRpbWl6ZWQgJiYgc2hhcGVGbGFnICYgMTYgLyogQVJSQVlfQ0hJTERSRU4gKi8pKSB7XHJcbiAgICAgICAgICAgICAgICB1bm1vdW50Q2hpbGRyZW4oY2hpbGRyZW4sIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChkb1JlbW92ZSkge1xyXG4gICAgICAgICAgICAgICAgcmVtb3ZlKHZub2RlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoKHNob3VsZEludm9rZVZub2RlSG9vayAmJlxyXG4gICAgICAgICAgICAodm5vZGVIb29rID0gcHJvcHMgJiYgcHJvcHMub25Wbm9kZVVubW91bnRlZCkpIHx8XHJcbiAgICAgICAgICAgIHNob3VsZEludm9rZURpcnMpIHtcclxuICAgICAgICAgICAgcXVldWVQb3N0UmVuZGVyRWZmZWN0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHZub2RlSG9vayAmJiBpbnZva2VWTm9kZUhvb2sodm5vZGVIb29rLCBwYXJlbnRDb21wb25lbnQsIHZub2RlKTtcclxuICAgICAgICAgICAgICAgIHNob3VsZEludm9rZURpcnMgJiZcclxuICAgICAgICAgICAgICAgICAgICBpbnZva2VEaXJlY3RpdmVIb29rKHZub2RlLCBudWxsLCBwYXJlbnRDb21wb25lbnQsICd1bm1vdW50ZWQnKTtcclxuICAgICAgICAgICAgfSwgcGFyZW50U3VzcGVuc2UpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBjb25zdCByZW1vdmUgPSB2bm9kZSA9PiB7XHJcbiAgICAgICAgY29uc3QgeyB0eXBlLCBlbCwgYW5jaG9yLCB0cmFuc2l0aW9uIH0gPSB2bm9kZTtcclxuICAgICAgICBpZiAodHlwZSA9PT0gRnJhZ21lbnQpIHtcclxuICAgICAgICAgICAgcmVtb3ZlRnJhZ21lbnQoZWwsIGFuY2hvcik7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHR5cGUgPT09IFN0YXRpYykge1xyXG4gICAgICAgICAgICByZW1vdmVTdGF0aWNOb2RlKHZub2RlKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBwZXJmb3JtUmVtb3ZlID0gKCkgPT4ge1xyXG4gICAgICAgICAgICBob3N0UmVtb3ZlKGVsKTtcclxuICAgICAgICAgICAgaWYgKHRyYW5zaXRpb24gJiYgIXRyYW5zaXRpb24ucGVyc2lzdGVkICYmIHRyYW5zaXRpb24uYWZ0ZXJMZWF2ZSkge1xyXG4gICAgICAgICAgICAgICAgdHJhbnNpdGlvbi5hZnRlckxlYXZlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIGlmICh2bm9kZS5zaGFwZUZsYWcgJiAxIC8qIEVMRU1FTlQgKi8gJiZcclxuICAgICAgICAgICAgdHJhbnNpdGlvbiAmJlxyXG4gICAgICAgICAgICAhdHJhbnNpdGlvbi5wZXJzaXN0ZWQpIHtcclxuICAgICAgICAgICAgY29uc3QgeyBsZWF2ZSwgZGVsYXlMZWF2ZSB9ID0gdHJhbnNpdGlvbjtcclxuICAgICAgICAgICAgY29uc3QgcGVyZm9ybUxlYXZlID0gKCkgPT4gbGVhdmUoZWwsIHBlcmZvcm1SZW1vdmUpO1xyXG4gICAgICAgICAgICBpZiAoZGVsYXlMZWF2ZSkge1xyXG4gICAgICAgICAgICAgICAgZGVsYXlMZWF2ZSh2bm9kZS5lbCwgcGVyZm9ybVJlbW92ZSwgcGVyZm9ybUxlYXZlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHBlcmZvcm1MZWF2ZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBwZXJmb3JtUmVtb3ZlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGNvbnN0IHJlbW92ZUZyYWdtZW50ID0gKGN1ciwgZW5kKSA9PiB7XHJcbiAgICAgICAgLy8gRm9yIGZyYWdtZW50cywgZGlyZWN0bHkgcmVtb3ZlIGFsbCBjb250YWluZWQgRE9NIG5vZGVzLlxyXG4gICAgICAgIC8vIChmcmFnbWVudCBjaGlsZCBub2RlcyBjYW5ub3QgaGF2ZSB0cmFuc2l0aW9uKVxyXG4gICAgICAgIGxldCBuZXh0O1xyXG4gICAgICAgIHdoaWxlIChjdXIgIT09IGVuZCkge1xyXG4gICAgICAgICAgICBuZXh0ID0gaG9zdE5leHRTaWJsaW5nKGN1cik7XHJcbiAgICAgICAgICAgIGhvc3RSZW1vdmUoY3VyKTtcclxuICAgICAgICAgICAgY3VyID0gbmV4dDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaG9zdFJlbW92ZShlbmQpO1xyXG4gICAgfTtcclxuICAgIGNvbnN0IHVubW91bnRDb21wb25lbnQgPSAoaW5zdGFuY2UsIHBhcmVudFN1c3BlbnNlLCBkb1JlbW92ZSkgPT4ge1xyXG4gICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiYgaW5zdGFuY2UudHlwZS5fX2htcklkKSB7XHJcbiAgICAgICAgICAgIHVucmVnaXN0ZXJITVIoaW5zdGFuY2UpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCB7IGJ1bSwgc2NvcGUsIHVwZGF0ZSwgc3ViVHJlZSwgdW0gfSA9IGluc3RhbmNlO1xyXG4gICAgICAgIC8vIGJlZm9yZVVubW91bnQgaG9va1xyXG4gICAgICAgIGlmIChidW0pIHtcclxuICAgICAgICAgICAgaW52b2tlQXJyYXlGbnMoYnVtKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gc3RvcCBlZmZlY3RzIGluIGNvbXBvbmVudCBzY29wZVxyXG4gICAgICAgIHNjb3BlLnN0b3AoKTtcclxuICAgICAgICAvLyB1cGRhdGUgbWF5IGJlIG51bGwgaWYgYSBjb21wb25lbnQgaXMgdW5tb3VudGVkIGJlZm9yZSBpdHMgYXN5bmNcclxuICAgICAgICAvLyBzZXR1cCBoYXMgcmVzb2x2ZWQuXHJcbiAgICAgICAgaWYgKHVwZGF0ZSkge1xyXG4gICAgICAgICAgICAvLyBzbyB0aGF0IHNjaGVkdWxlciB3aWxsIG5vIGxvbmdlciBpbnZva2UgaXRcclxuICAgICAgICAgICAgdXBkYXRlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB1bm1vdW50KHN1YlRyZWUsIGluc3RhbmNlLCBwYXJlbnRTdXNwZW5zZSwgZG9SZW1vdmUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyB1bm1vdW50ZWQgaG9va1xyXG4gICAgICAgIGlmICh1bSkge1xyXG4gICAgICAgICAgICBxdWV1ZVBvc3RSZW5kZXJFZmZlY3QodW0sIHBhcmVudFN1c3BlbnNlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcXVldWVQb3N0UmVuZGVyRWZmZWN0KCgpID0+IHtcclxuICAgICAgICAgICAgaW5zdGFuY2UuaXNVbm1vdW50ZWQgPSB0cnVlO1xyXG4gICAgICAgIH0sIHBhcmVudFN1c3BlbnNlKTtcclxuICAgICAgICAvLyBBIGNvbXBvbmVudCB3aXRoIGFzeW5jIGRlcCBpbnNpZGUgYSBwZW5kaW5nIHN1c3BlbnNlIGlzIHVubW91bnRlZCBiZWZvcmVcclxuICAgICAgICAvLyBpdHMgYXN5bmMgZGVwIHJlc29sdmVzLiBUaGlzIHNob3VsZCByZW1vdmUgdGhlIGRlcCBmcm9tIHRoZSBzdXNwZW5zZSwgYW5kXHJcbiAgICAgICAgLy8gY2F1c2UgdGhlIHN1c3BlbnNlIHRvIHJlc29sdmUgaW1tZWRpYXRlbHkgaWYgdGhhdCB3YXMgdGhlIGxhc3QgZGVwLlxyXG4gICAgICAgIGlmIChwYXJlbnRTdXNwZW5zZSAmJlxyXG4gICAgICAgICAgICBwYXJlbnRTdXNwZW5zZS5wZW5kaW5nQnJhbmNoICYmXHJcbiAgICAgICAgICAgICFwYXJlbnRTdXNwZW5zZS5pc1VubW91bnRlZCAmJlxyXG4gICAgICAgICAgICBpbnN0YW5jZS5hc3luY0RlcCAmJlxyXG4gICAgICAgICAgICAhaW5zdGFuY2UuYXN5bmNSZXNvbHZlZCAmJlxyXG4gICAgICAgICAgICBpbnN0YW5jZS5zdXNwZW5zZUlkID09PSBwYXJlbnRTdXNwZW5zZS5wZW5kaW5nSWQpIHtcclxuICAgICAgICAgICAgcGFyZW50U3VzcGVuc2UuZGVwcy0tO1xyXG4gICAgICAgICAgICBpZiAocGFyZW50U3VzcGVuc2UuZGVwcyA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgcGFyZW50U3VzcGVuc2UucmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgfHwgX19WVUVfUFJPRF9ERVZUT09MU19fKSB7XHJcbiAgICAgICAgICAgIGRldnRvb2xzQ29tcG9uZW50UmVtb3ZlZChpbnN0YW5jZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGNvbnN0IHVubW91bnRDaGlsZHJlbiA9IChjaGlsZHJlbiwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgZG9SZW1vdmUgPSBmYWxzZSwgb3B0aW1pemVkID0gZmFsc2UsIHN0YXJ0ID0gMCkgPT4ge1xyXG4gICAgICAgIGZvciAobGV0IGkgPSBzdGFydDsgaSA8IGNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHVubW91bnQoY2hpbGRyZW5baV0sIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIGRvUmVtb3ZlLCBvcHRpbWl6ZWQpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBjb25zdCBnZXROZXh0SG9zdE5vZGUgPSB2bm9kZSA9PiB7XHJcbiAgICAgICAgaWYgKHZub2RlLnNoYXBlRmxhZyAmIDYgLyogQ09NUE9ORU5UICovKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBnZXROZXh0SG9zdE5vZGUodm5vZGUuY29tcG9uZW50LnN1YlRyZWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodm5vZGUuc2hhcGVGbGFnICYgMTI4IC8qIFNVU1BFTlNFICovKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB2bm9kZS5zdXNwZW5zZS5uZXh0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBob3N0TmV4dFNpYmxpbmcoKHZub2RlLmFuY2hvciB8fCB2bm9kZS5lbCkpO1xyXG4gICAgfTtcclxuICAgIGNvbnN0IHJlbmRlciA9ICh2bm9kZSwgY29udGFpbmVyLCBpc1NWRykgPT4ge1xyXG4gICAgICAgIGlmICh2bm9kZSA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIGlmIChjb250YWluZXIuX3Zub2RlKSB7XHJcbiAgICAgICAgICAgICAgICB1bm1vdW50KGNvbnRhaW5lci5fdm5vZGUsIG51bGwsIG51bGwsIHRydWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBwYXRjaChjb250YWluZXIuX3Zub2RlIHx8IG51bGwsIHZub2RlLCBjb250YWluZXIsIG51bGwsIG51bGwsIG51bGwsIGlzU1ZHKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZmx1c2hQb3N0Rmx1c2hDYnMoKTtcclxuICAgICAgICBjb250YWluZXIuX3Zub2RlID0gdm5vZGU7XHJcbiAgICB9O1xyXG4gICAgY29uc3QgaW50ZXJuYWxzID0ge1xyXG4gICAgICAgIHA6IHBhdGNoLFxyXG4gICAgICAgIHVtOiB1bm1vdW50LFxyXG4gICAgICAgIG06IG1vdmUsXHJcbiAgICAgICAgcjogcmVtb3ZlLFxyXG4gICAgICAgIG10OiBtb3VudENvbXBvbmVudCxcclxuICAgICAgICBtYzogbW91bnRDaGlsZHJlbixcclxuICAgICAgICBwYzogcGF0Y2hDaGlsZHJlbixcclxuICAgICAgICBwYmM6IHBhdGNoQmxvY2tDaGlsZHJlbixcclxuICAgICAgICBuOiBnZXROZXh0SG9zdE5vZGUsXHJcbiAgICAgICAgbzogb3B0aW9uc1xyXG4gICAgfTtcclxuICAgIGxldCBoeWRyYXRlO1xyXG4gICAgbGV0IGh5ZHJhdGVOb2RlO1xyXG4gICAgaWYgKGNyZWF0ZUh5ZHJhdGlvbkZucykge1xyXG4gICAgICAgIFtoeWRyYXRlLCBoeWRyYXRlTm9kZV0gPSBjcmVhdGVIeWRyYXRpb25GbnMoaW50ZXJuYWxzKTtcclxuICAgIH1cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgcmVuZGVyLFxyXG4gICAgICAgIGh5ZHJhdGUsXHJcbiAgICAgICAgY3JlYXRlQXBwOiBjcmVhdGVBcHBBUEkocmVuZGVyLCBoeWRyYXRlKVxyXG4gICAgfTtcclxufVxyXG5mdW5jdGlvbiB0b2dnbGVSZWN1cnNlKHsgZWZmZWN0LCB1cGRhdGUgfSwgYWxsb3dlZCkge1xyXG4gICAgZWZmZWN0LmFsbG93UmVjdXJzZSA9IHVwZGF0ZS5hbGxvd1JlY3Vyc2UgPSBhbGxvd2VkO1xyXG59XHJcbi8qKlxyXG4gKiAjMTE1NlxyXG4gKiBXaGVuIGEgY29tcG9uZW50IGlzIEhNUi1lbmFibGVkLCB3ZSBuZWVkIHRvIG1ha2Ugc3VyZSB0aGF0IGFsbCBzdGF0aWMgbm9kZXNcclxuICogaW5zaWRlIGEgYmxvY2sgYWxzbyBpbmhlcml0IHRoZSBET00gZWxlbWVudCBmcm9tIHRoZSBwcmV2aW91cyB0cmVlIHNvIHRoYXRcclxuICogSE1SIHVwZGF0ZXMgKHdoaWNoIGFyZSBmdWxsIHVwZGF0ZXMpIGNhbiByZXRyaWV2ZSB0aGUgZWxlbWVudCBmb3IgcGF0Y2hpbmcuXHJcbiAqXHJcbiAqICMyMDgwXHJcbiAqIEluc2lkZSBrZXllZCBgdGVtcGxhdGVgIGZyYWdtZW50IHN0YXRpYyBjaGlsZHJlbiwgaWYgYSBmcmFnbWVudCBpcyBtb3ZlZCxcclxuICogdGhlIGNoaWxkcmVuIHdpbGwgYWx3YXlzIGJlIG1vdmVkLiBUaGVyZWZvcmUsIGluIG9yZGVyIHRvIGVuc3VyZSBjb3JyZWN0IG1vdmVcclxuICogcG9zaXRpb24sIGVsIHNob3VsZCBiZSBpbmhlcml0ZWQgZnJvbSBwcmV2aW91cyBub2Rlcy5cclxuICovXHJcbmZ1bmN0aW9uIHRyYXZlcnNlU3RhdGljQ2hpbGRyZW4objEsIG4yLCBzaGFsbG93ID0gZmFsc2UpIHtcclxuICAgIGNvbnN0IGNoMSA9IG4xLmNoaWxkcmVuO1xyXG4gICAgY29uc3QgY2gyID0gbjIuY2hpbGRyZW47XHJcbiAgICBpZiAoaXNBcnJheShjaDEpICYmIGlzQXJyYXkoY2gyKSkge1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY2gxLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIC8vIHRoaXMgaXMgb25seSBjYWxsZWQgaW4gdGhlIG9wdGltaXplZCBwYXRoIHNvIGFycmF5IGNoaWxkcmVuIGFyZVxyXG4gICAgICAgICAgICAvLyBndWFyYW50ZWVkIHRvIGJlIHZub2Rlc1xyXG4gICAgICAgICAgICBjb25zdCBjMSA9IGNoMVtpXTtcclxuICAgICAgICAgICAgbGV0IGMyID0gY2gyW2ldO1xyXG4gICAgICAgICAgICBpZiAoYzIuc2hhcGVGbGFnICYgMSAvKiBFTEVNRU5UICovICYmICFjMi5keW5hbWljQ2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgICAgIGlmIChjMi5wYXRjaEZsYWcgPD0gMCB8fCBjMi5wYXRjaEZsYWcgPT09IDMyIC8qIEhZRFJBVEVfRVZFTlRTICovKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYzIgPSBjaDJbaV0gPSBjbG9uZUlmTW91bnRlZChjaDJbaV0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGMyLmVsID0gYzEuZWw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoIXNoYWxsb3cpXHJcbiAgICAgICAgICAgICAgICAgICAgdHJhdmVyc2VTdGF0aWNDaGlsZHJlbihjMSwgYzIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIGFsc28gaW5oZXJpdCBmb3IgY29tbWVudCBub2RlcywgYnV0IG5vdCBwbGFjZWhvbGRlcnMgKGUuZy4gdi1pZiB3aGljaFxyXG4gICAgICAgICAgICAvLyB3b3VsZCBoYXZlIHJlY2VpdmVkIC5lbCBkdXJpbmcgYmxvY2sgcGF0Y2gpXHJcbiAgICAgICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiYgYzIudHlwZSA9PT0gQ29tbWVudCAmJiAhYzIuZWwpIHtcclxuICAgICAgICAgICAgICAgIGMyLmVsID0gYzEuZWw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuLy8gaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvTG9uZ2VzdF9pbmNyZWFzaW5nX3N1YnNlcXVlbmNlXHJcbmZ1bmN0aW9uIGdldFNlcXVlbmNlKGFycikge1xyXG4gICAgY29uc3QgcCA9IGFyci5zbGljZSgpO1xyXG4gICAgY29uc3QgcmVzdWx0ID0gWzBdO1xyXG4gICAgbGV0IGksIGosIHUsIHYsIGM7XHJcbiAgICBjb25zdCBsZW4gPSBhcnIubGVuZ3RoO1xyXG4gICAgZm9yIChpID0gMDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgY29uc3QgYXJySSA9IGFycltpXTtcclxuICAgICAgICBpZiAoYXJySSAhPT0gMCkge1xyXG4gICAgICAgICAgICBqID0gcmVzdWx0W3Jlc3VsdC5sZW5ndGggLSAxXTtcclxuICAgICAgICAgICAgaWYgKGFycltqXSA8IGFyckkpIHtcclxuICAgICAgICAgICAgICAgIHBbaV0gPSBqO1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goaSk7XHJcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB1ID0gMDtcclxuICAgICAgICAgICAgdiA9IHJlc3VsdC5sZW5ndGggLSAxO1xyXG4gICAgICAgICAgICB3aGlsZSAodSA8IHYpIHtcclxuICAgICAgICAgICAgICAgIGMgPSAodSArIHYpID4+IDE7XHJcbiAgICAgICAgICAgICAgICBpZiAoYXJyW3Jlc3VsdFtjXV0gPCBhcnJJKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdSA9IGMgKyAxO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdiA9IGM7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGFyckkgPCBhcnJbcmVzdWx0W3VdXSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHUgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcFtpXSA9IHJlc3VsdFt1IC0gMV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXN1bHRbdV0gPSBpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgdSA9IHJlc3VsdC5sZW5ndGg7XHJcbiAgICB2ID0gcmVzdWx0W3UgLSAxXTtcclxuICAgIHdoaWxlICh1LS0gPiAwKSB7XHJcbiAgICAgICAgcmVzdWx0W3VdID0gdjtcclxuICAgICAgICB2ID0gcFt2XTtcclxuICAgIH1cclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cblxuY29uc3QgaXNUZWxlcG9ydCA9ICh0eXBlKSA9PiB0eXBlLl9faXNUZWxlcG9ydDtcclxuY29uc3QgaXNUZWxlcG9ydERpc2FibGVkID0gKHByb3BzKSA9PiBwcm9wcyAmJiAocHJvcHMuZGlzYWJsZWQgfHwgcHJvcHMuZGlzYWJsZWQgPT09ICcnKTtcclxuY29uc3QgaXNUYXJnZXRTVkcgPSAodGFyZ2V0KSA9PiB0eXBlb2YgU1ZHRWxlbWVudCAhPT0gJ3VuZGVmaW5lZCcgJiYgdGFyZ2V0IGluc3RhbmNlb2YgU1ZHRWxlbWVudDtcclxuY29uc3QgcmVzb2x2ZVRhcmdldCA9IChwcm9wcywgc2VsZWN0KSA9PiB7XHJcbiAgICBjb25zdCB0YXJnZXRTZWxlY3RvciA9IHByb3BzICYmIHByb3BzLnRvO1xyXG4gICAgaWYgKGlzU3RyaW5nKHRhcmdldFNlbGVjdG9yKSkge1xyXG4gICAgICAgIGlmICghc2VsZWN0KSB7XHJcbiAgICAgICAgICAgIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJlxyXG4gICAgICAgICAgICAgICAgd2FybihgQ3VycmVudCByZW5kZXJlciBkb2VzIG5vdCBzdXBwb3J0IHN0cmluZyB0YXJnZXQgZm9yIFRlbGVwb3J0cy4gYCArXHJcbiAgICAgICAgICAgICAgICAgICAgYChtaXNzaW5nIHF1ZXJ5U2VsZWN0b3IgcmVuZGVyZXIgb3B0aW9uKWApO1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldCA9IHNlbGVjdCh0YXJnZXRTZWxlY3Rvcik7XHJcbiAgICAgICAgICAgIGlmICghdGFyZ2V0KSB7XHJcbiAgICAgICAgICAgICAgICAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiZcclxuICAgICAgICAgICAgICAgICAgICB3YXJuKGBGYWlsZWQgdG8gbG9jYXRlIFRlbGVwb3J0IHRhcmdldCB3aXRoIHNlbGVjdG9yIFwiJHt0YXJnZXRTZWxlY3Rvcn1cIi4gYCArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGBOb3RlIHRoZSB0YXJnZXQgZWxlbWVudCBtdXN0IGV4aXN0IGJlZm9yZSB0aGUgY29tcG9uZW50IGlzIG1vdW50ZWQgLSBgICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYGkuZS4gdGhlIHRhcmdldCBjYW5ub3QgYmUgcmVuZGVyZWQgYnkgdGhlIGNvbXBvbmVudCBpdHNlbGYsIGFuZCBgICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYGlkZWFsbHkgc2hvdWxkIGJlIG91dHNpZGUgb2YgdGhlIGVudGlyZSBWdWUgY29tcG9uZW50IHRyZWUuYCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRhcmdldDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmICF0YXJnZXRTZWxlY3RvciAmJiAhaXNUZWxlcG9ydERpc2FibGVkKHByb3BzKSkge1xyXG4gICAgICAgICAgICB3YXJuKGBJbnZhbGlkIFRlbGVwb3J0IHRhcmdldDogJHt0YXJnZXRTZWxlY3Rvcn1gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRhcmdldFNlbGVjdG9yO1xyXG4gICAgfVxyXG59O1xyXG5jb25zdCBUZWxlcG9ydEltcGwgPSB7XHJcbiAgICBfX2lzVGVsZXBvcnQ6IHRydWUsXHJcbiAgICBwcm9jZXNzKG4xLCBuMiwgY29udGFpbmVyLCBhbmNob3IsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIGlzU1ZHLCBzbG90U2NvcGVJZHMsIG9wdGltaXplZCwgaW50ZXJuYWxzKSB7XHJcbiAgICAgICAgY29uc3QgeyBtYzogbW91bnRDaGlsZHJlbiwgcGM6IHBhdGNoQ2hpbGRyZW4sIHBiYzogcGF0Y2hCbG9ja0NoaWxkcmVuLCBvOiB7IGluc2VydCwgcXVlcnlTZWxlY3RvciwgY3JlYXRlVGV4dCwgY3JlYXRlQ29tbWVudCB9IH0gPSBpbnRlcm5hbHM7XHJcbiAgICAgICAgY29uc3QgZGlzYWJsZWQgPSBpc1RlbGVwb3J0RGlzYWJsZWQobjIucHJvcHMpO1xyXG4gICAgICAgIGxldCB7IHNoYXBlRmxhZywgY2hpbGRyZW4sIGR5bmFtaWNDaGlsZHJlbiB9ID0gbjI7XHJcbiAgICAgICAgLy8gIzMzMDJcclxuICAgICAgICAvLyBITVIgdXBkYXRlZCwgZm9yY2UgZnVsbCBkaWZmXHJcbiAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiBpc0htclVwZGF0aW5nKSB7XHJcbiAgICAgICAgICAgIG9wdGltaXplZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICBkeW5hbWljQ2hpbGRyZW4gPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAobjEgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAvLyBpbnNlcnQgYW5jaG9ycyBpbiB0aGUgbWFpbiB2aWV3XHJcbiAgICAgICAgICAgIGNvbnN0IHBsYWNlaG9sZGVyID0gKG4yLmVsID0gKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpXHJcbiAgICAgICAgICAgICAgICA/IGNyZWF0ZUNvbW1lbnQoJ3RlbGVwb3J0IHN0YXJ0JylcclxuICAgICAgICAgICAgICAgIDogY3JlYXRlVGV4dCgnJykpO1xyXG4gICAgICAgICAgICBjb25zdCBtYWluQW5jaG9yID0gKG4yLmFuY2hvciA9IChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKVxyXG4gICAgICAgICAgICAgICAgPyBjcmVhdGVDb21tZW50KCd0ZWxlcG9ydCBlbmQnKVxyXG4gICAgICAgICAgICAgICAgOiBjcmVhdGVUZXh0KCcnKSk7XHJcbiAgICAgICAgICAgIGluc2VydChwbGFjZWhvbGRlciwgY29udGFpbmVyLCBhbmNob3IpO1xyXG4gICAgICAgICAgICBpbnNlcnQobWFpbkFuY2hvciwgY29udGFpbmVyLCBhbmNob3IpO1xyXG4gICAgICAgICAgICBjb25zdCB0YXJnZXQgPSAobjIudGFyZ2V0ID0gcmVzb2x2ZVRhcmdldChuMi5wcm9wcywgcXVlcnlTZWxlY3RvcikpO1xyXG4gICAgICAgICAgICBjb25zdCB0YXJnZXRBbmNob3IgPSAobjIudGFyZ2V0QW5jaG9yID0gY3JlYXRlVGV4dCgnJykpO1xyXG4gICAgICAgICAgICBpZiAodGFyZ2V0KSB7XHJcbiAgICAgICAgICAgICAgICBpbnNlcnQodGFyZ2V0QW5jaG9yLCB0YXJnZXQpO1xyXG4gICAgICAgICAgICAgICAgLy8gIzI2NTIgd2UgY291bGQgYmUgdGVsZXBvcnRpbmcgZnJvbSBhIG5vbi1TVkcgdHJlZSBpbnRvIGFuIFNWRyB0cmVlXHJcbiAgICAgICAgICAgICAgICBpc1NWRyA9IGlzU1ZHIHx8IGlzVGFyZ2V0U1ZHKHRhcmdldCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmICFkaXNhYmxlZCkge1xyXG4gICAgICAgICAgICAgICAgd2FybignSW52YWxpZCBUZWxlcG9ydCB0YXJnZXQgb24gbW91bnQ6JywgdGFyZ2V0LCBgKCR7dHlwZW9mIHRhcmdldH0pYCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgbW91bnQgPSAoY29udGFpbmVyLCBhbmNob3IpID0+IHtcclxuICAgICAgICAgICAgICAgIC8vIFRlbGVwb3J0ICphbHdheXMqIGhhcyBBcnJheSBjaGlsZHJlbi4gVGhpcyBpcyBlbmZvcmNlZCBpbiBib3RoIHRoZVxyXG4gICAgICAgICAgICAgICAgLy8gY29tcGlsZXIgYW5kIHZub2RlIGNoaWxkcmVuIG5vcm1hbGl6YXRpb24uXHJcbiAgICAgICAgICAgICAgICBpZiAoc2hhcGVGbGFnICYgMTYgLyogQVJSQVlfQ0hJTERSRU4gKi8pIHtcclxuICAgICAgICAgICAgICAgICAgICBtb3VudENoaWxkcmVuKGNoaWxkcmVuLCBjb250YWluZXIsIGFuY2hvciwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgaWYgKGRpc2FibGVkKSB7XHJcbiAgICAgICAgICAgICAgICBtb3VudChjb250YWluZXIsIG1haW5BbmNob3IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHRhcmdldCkge1xyXG4gICAgICAgICAgICAgICAgbW91bnQodGFyZ2V0LCB0YXJnZXRBbmNob3IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyB1cGRhdGUgY29udGVudFxyXG4gICAgICAgICAgICBuMi5lbCA9IG4xLmVsO1xyXG4gICAgICAgICAgICBjb25zdCBtYWluQW5jaG9yID0gKG4yLmFuY2hvciA9IG4xLmFuY2hvcik7XHJcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldCA9IChuMi50YXJnZXQgPSBuMS50YXJnZXQpO1xyXG4gICAgICAgICAgICBjb25zdCB0YXJnZXRBbmNob3IgPSAobjIudGFyZ2V0QW5jaG9yID0gbjEudGFyZ2V0QW5jaG9yKTtcclxuICAgICAgICAgICAgY29uc3Qgd2FzRGlzYWJsZWQgPSBpc1RlbGVwb3J0RGlzYWJsZWQobjEucHJvcHMpO1xyXG4gICAgICAgICAgICBjb25zdCBjdXJyZW50Q29udGFpbmVyID0gd2FzRGlzYWJsZWQgPyBjb250YWluZXIgOiB0YXJnZXQ7XHJcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRBbmNob3IgPSB3YXNEaXNhYmxlZCA/IG1haW5BbmNob3IgOiB0YXJnZXRBbmNob3I7XHJcbiAgICAgICAgICAgIGlzU1ZHID0gaXNTVkcgfHwgaXNUYXJnZXRTVkcodGFyZ2V0KTtcclxuICAgICAgICAgICAgaWYgKGR5bmFtaWNDaGlsZHJlbikge1xyXG4gICAgICAgICAgICAgICAgLy8gZmFzdCBwYXRoIHdoZW4gdGhlIHRlbGVwb3J0IGhhcHBlbnMgdG8gYmUgYSBibG9jayByb290XHJcbiAgICAgICAgICAgICAgICBwYXRjaEJsb2NrQ2hpbGRyZW4objEuZHluYW1pY0NoaWxkcmVuLCBkeW5hbWljQ2hpbGRyZW4sIGN1cnJlbnRDb250YWluZXIsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIGlzU1ZHLCBzbG90U2NvcGVJZHMpO1xyXG4gICAgICAgICAgICAgICAgLy8gZXZlbiBpbiBibG9jayB0cmVlIG1vZGUgd2UgbmVlZCB0byBtYWtlIHN1cmUgYWxsIHJvb3QtbGV2ZWwgbm9kZXNcclxuICAgICAgICAgICAgICAgIC8vIGluIHRoZSB0ZWxlcG9ydCBpbmhlcml0IHByZXZpb3VzIERPTSByZWZlcmVuY2VzIHNvIHRoYXQgdGhleSBjYW5cclxuICAgICAgICAgICAgICAgIC8vIGJlIG1vdmVkIGluIGZ1dHVyZSBwYXRjaGVzLlxyXG4gICAgICAgICAgICAgICAgdHJhdmVyc2VTdGF0aWNDaGlsZHJlbihuMSwgbjIsIHRydWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKCFvcHRpbWl6ZWQpIHtcclxuICAgICAgICAgICAgICAgIHBhdGNoQ2hpbGRyZW4objEsIG4yLCBjdXJyZW50Q29udGFpbmVyLCBjdXJyZW50QW5jaG9yLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCBpc1NWRywgc2xvdFNjb3BlSWRzLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGRpc2FibGVkKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXdhc0Rpc2FibGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gZW5hYmxlZCAtPiBkaXNhYmxlZFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIG1vdmUgaW50byBtYWluIGNvbnRhaW5lclxyXG4gICAgICAgICAgICAgICAgICAgIG1vdmVUZWxlcG9ydChuMiwgY29udGFpbmVyLCBtYWluQW5jaG9yLCBpbnRlcm5hbHMsIDEgLyogVE9HR0xFICovKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIHRhcmdldCBjaGFuZ2VkXHJcbiAgICAgICAgICAgICAgICBpZiAoKG4yLnByb3BzICYmIG4yLnByb3BzLnRvKSAhPT0gKG4xLnByb3BzICYmIG4xLnByb3BzLnRvKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5leHRUYXJnZXQgPSAobjIudGFyZ2V0ID0gcmVzb2x2ZVRhcmdldChuMi5wcm9wcywgcXVlcnlTZWxlY3RvcikpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChuZXh0VGFyZ2V0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vdmVUZWxlcG9ydChuMiwgbmV4dFRhcmdldCwgbnVsbCwgaW50ZXJuYWxzLCAwIC8qIFRBUkdFVF9DSEFOR0UgKi8pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2FybignSW52YWxpZCBUZWxlcG9ydCB0YXJnZXQgb24gdXBkYXRlOicsIHRhcmdldCwgYCgke3R5cGVvZiB0YXJnZXR9KWApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHdhc0Rpc2FibGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gZGlzYWJsZWQgLT4gZW5hYmxlZFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIG1vdmUgaW50byB0ZWxlcG9ydCB0YXJnZXRcclxuICAgICAgICAgICAgICAgICAgICBtb3ZlVGVsZXBvcnQobjIsIHRhcmdldCwgdGFyZ2V0QW5jaG9yLCBpbnRlcm5hbHMsIDEgLyogVE9HR0xFICovKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICByZW1vdmUodm5vZGUsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIG9wdGltaXplZCwgeyB1bTogdW5tb3VudCwgbzogeyByZW1vdmU6IGhvc3RSZW1vdmUgfSB9LCBkb1JlbW92ZSkge1xyXG4gICAgICAgIGNvbnN0IHsgc2hhcGVGbGFnLCBjaGlsZHJlbiwgYW5jaG9yLCB0YXJnZXRBbmNob3IsIHRhcmdldCwgcHJvcHMgfSA9IHZub2RlO1xyXG4gICAgICAgIGlmICh0YXJnZXQpIHtcclxuICAgICAgICAgICAgaG9zdFJlbW92ZSh0YXJnZXRBbmNob3IpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBhbiB1bm1vdW50ZWQgdGVsZXBvcnQgc2hvdWxkIGFsd2F5cyByZW1vdmUgaXRzIGNoaWxkcmVuIGlmIG5vdCBkaXNhYmxlZFxyXG4gICAgICAgIGlmIChkb1JlbW92ZSB8fCAhaXNUZWxlcG9ydERpc2FibGVkKHByb3BzKSkge1xyXG4gICAgICAgICAgICBob3N0UmVtb3ZlKGFuY2hvcik7XHJcbiAgICAgICAgICAgIGlmIChzaGFwZUZsYWcgJiAxNiAvKiBBUlJBWV9DSElMRFJFTiAqLykge1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjaGlsZHJlbi5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoaWxkID0gY2hpbGRyZW5baV07XHJcbiAgICAgICAgICAgICAgICAgICAgdW5tb3VudChjaGlsZCwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgdHJ1ZSwgISFjaGlsZC5keW5hbWljQ2hpbGRyZW4pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIG1vdmU6IG1vdmVUZWxlcG9ydCxcclxuICAgIGh5ZHJhdGU6IGh5ZHJhdGVUZWxlcG9ydFxyXG59O1xyXG5mdW5jdGlvbiBtb3ZlVGVsZXBvcnQodm5vZGUsIGNvbnRhaW5lciwgcGFyZW50QW5jaG9yLCB7IG86IHsgaW5zZXJ0IH0sIG06IG1vdmUgfSwgbW92ZVR5cGUgPSAyIC8qIFJFT1JERVIgKi8pIHtcclxuICAgIC8vIG1vdmUgdGFyZ2V0IGFuY2hvciBpZiB0aGlzIGlzIGEgdGFyZ2V0IGNoYW5nZS5cclxuICAgIGlmIChtb3ZlVHlwZSA9PT0gMCAvKiBUQVJHRVRfQ0hBTkdFICovKSB7XHJcbiAgICAgICAgaW5zZXJ0KHZub2RlLnRhcmdldEFuY2hvciwgY29udGFpbmVyLCBwYXJlbnRBbmNob3IpO1xyXG4gICAgfVxyXG4gICAgY29uc3QgeyBlbCwgYW5jaG9yLCBzaGFwZUZsYWcsIGNoaWxkcmVuLCBwcm9wcyB9ID0gdm5vZGU7XHJcbiAgICBjb25zdCBpc1Jlb3JkZXIgPSBtb3ZlVHlwZSA9PT0gMiAvKiBSRU9SREVSICovO1xyXG4gICAgLy8gbW92ZSBtYWluIHZpZXcgYW5jaG9yIGlmIHRoaXMgaXMgYSByZS1vcmRlci5cclxuICAgIGlmIChpc1Jlb3JkZXIpIHtcclxuICAgICAgICBpbnNlcnQoZWwsIGNvbnRhaW5lciwgcGFyZW50QW5jaG9yKTtcclxuICAgIH1cclxuICAgIC8vIGlmIHRoaXMgaXMgYSByZS1vcmRlciBhbmQgdGVsZXBvcnQgaXMgZW5hYmxlZCAoY29udGVudCBpcyBpbiB0YXJnZXQpXHJcbiAgICAvLyBkbyBub3QgbW92ZSBjaGlsZHJlbi4gU28gdGhlIG9wcG9zaXRlIGlzOiBvbmx5IG1vdmUgY2hpbGRyZW4gaWYgdGhpc1xyXG4gICAgLy8gaXMgbm90IGEgcmVvcmRlciwgb3IgdGhlIHRlbGVwb3J0IGlzIGRpc2FibGVkXHJcbiAgICBpZiAoIWlzUmVvcmRlciB8fCBpc1RlbGVwb3J0RGlzYWJsZWQocHJvcHMpKSB7XHJcbiAgICAgICAgLy8gVGVsZXBvcnQgaGFzIGVpdGhlciBBcnJheSBjaGlsZHJlbiBvciBubyBjaGlsZHJlbi5cclxuICAgICAgICBpZiAoc2hhcGVGbGFnICYgMTYgLyogQVJSQVlfQ0hJTERSRU4gKi8pIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjaGlsZHJlbi5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgbW92ZShjaGlsZHJlbltpXSwgY29udGFpbmVyLCBwYXJlbnRBbmNob3IsIDIgLyogUkVPUkRFUiAqLyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyBtb3ZlIG1haW4gdmlldyBhbmNob3IgaWYgdGhpcyBpcyBhIHJlLW9yZGVyLlxyXG4gICAgaWYgKGlzUmVvcmRlcikge1xyXG4gICAgICAgIGluc2VydChhbmNob3IsIGNvbnRhaW5lciwgcGFyZW50QW5jaG9yKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBoeWRyYXRlVGVsZXBvcnQobm9kZSwgdm5vZGUsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkLCB7IG86IHsgbmV4dFNpYmxpbmcsIHBhcmVudE5vZGUsIHF1ZXJ5U2VsZWN0b3IgfSB9LCBoeWRyYXRlQ2hpbGRyZW4pIHtcclxuICAgIGNvbnN0IHRhcmdldCA9ICh2bm9kZS50YXJnZXQgPSByZXNvbHZlVGFyZ2V0KHZub2RlLnByb3BzLCBxdWVyeVNlbGVjdG9yKSk7XHJcbiAgICBpZiAodGFyZ2V0KSB7XHJcbiAgICAgICAgLy8gaWYgbXVsdGlwbGUgdGVsZXBvcnRzIHJlbmRlcmVkIHRvIHRoZSBzYW1lIHRhcmdldCBlbGVtZW50LCB3ZSBuZWVkIHRvXHJcbiAgICAgICAgLy8gcGljayB1cCBmcm9tIHdoZXJlIHRoZSBsYXN0IHRlbGVwb3J0IGZpbmlzaGVkIGluc3RlYWQgb2YgdGhlIGZpcnN0IG5vZGVcclxuICAgICAgICBjb25zdCB0YXJnZXROb2RlID0gdGFyZ2V0Ll9scGEgfHwgdGFyZ2V0LmZpcnN0Q2hpbGQ7XHJcbiAgICAgICAgaWYgKHZub2RlLnNoYXBlRmxhZyAmIDE2IC8qIEFSUkFZX0NISUxEUkVOICovKSB7XHJcbiAgICAgICAgICAgIGlmIChpc1RlbGVwb3J0RGlzYWJsZWQodm5vZGUucHJvcHMpKSB7XHJcbiAgICAgICAgICAgICAgICB2bm9kZS5hbmNob3IgPSBoeWRyYXRlQ2hpbGRyZW4obmV4dFNpYmxpbmcobm9kZSksIHZub2RlLCBwYXJlbnROb2RlKG5vZGUpLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCBzbG90U2NvcGVJZHMsIG9wdGltaXplZCk7XHJcbiAgICAgICAgICAgICAgICB2bm9kZS50YXJnZXRBbmNob3IgPSB0YXJnZXROb2RlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdm5vZGUuYW5jaG9yID0gbmV4dFNpYmxpbmcobm9kZSk7XHJcbiAgICAgICAgICAgICAgICB2bm9kZS50YXJnZXRBbmNob3IgPSBoeWRyYXRlQ2hpbGRyZW4odGFyZ2V0Tm9kZSwgdm5vZGUsIHRhcmdldCwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgc2xvdFNjb3BlSWRzLCBvcHRpbWl6ZWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRhcmdldC5fbHBhID1cclxuICAgICAgICAgICAgICAgIHZub2RlLnRhcmdldEFuY2hvciAmJiBuZXh0U2libGluZyh2bm9kZS50YXJnZXRBbmNob3IpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiB2bm9kZS5hbmNob3IgJiYgbmV4dFNpYmxpbmcodm5vZGUuYW5jaG9yKTtcclxufVxyXG4vLyBGb3JjZS1jYXN0ZWQgcHVibGljIHR5cGluZyBmb3IgaCBhbmQgVFNYIHByb3BzIGluZmVyZW5jZVxyXG5jb25zdCBUZWxlcG9ydCA9IFRlbGVwb3J0SW1wbDtcblxuY29uc3QgQ09NUE9ORU5UUyA9ICdjb21wb25lbnRzJztcclxuY29uc3QgRElSRUNUSVZFUyA9ICdkaXJlY3RpdmVzJztcclxuLyoqXHJcbiAqIEBwcml2YXRlXHJcbiAqL1xyXG5mdW5jdGlvbiByZXNvbHZlQ29tcG9uZW50KG5hbWUsIG1heWJlU2VsZlJlZmVyZW5jZSkge1xyXG4gICAgcmV0dXJuIHJlc29sdmVBc3NldChDT01QT05FTlRTLCBuYW1lLCB0cnVlLCBtYXliZVNlbGZSZWZlcmVuY2UpIHx8IG5hbWU7XHJcbn1cclxuY29uc3QgTlVMTF9EWU5BTUlDX0NPTVBPTkVOVCA9IFN5bWJvbCgpO1xyXG4vKipcclxuICogQHByaXZhdGVcclxuICovXHJcbmZ1bmN0aW9uIHJlc29sdmVEeW5hbWljQ29tcG9uZW50KGNvbXBvbmVudCkge1xyXG4gICAgaWYgKGlzU3RyaW5nKGNvbXBvbmVudCkpIHtcclxuICAgICAgICByZXR1cm4gcmVzb2x2ZUFzc2V0KENPTVBPTkVOVFMsIGNvbXBvbmVudCwgZmFsc2UpIHx8IGNvbXBvbmVudDtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIC8vIGludmFsaWQgdHlwZXMgd2lsbCBmYWxsdGhyb3VnaCB0byBjcmVhdGVWTm9kZSBhbmQgcmFpc2Ugd2FybmluZ1xyXG4gICAgICAgIHJldHVybiAoY29tcG9uZW50IHx8IE5VTExfRFlOQU1JQ19DT01QT05FTlQpO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBAcHJpdmF0ZVxyXG4gKi9cclxuZnVuY3Rpb24gcmVzb2x2ZURpcmVjdGl2ZShuYW1lKSB7XHJcbiAgICByZXR1cm4gcmVzb2x2ZUFzc2V0KERJUkVDVElWRVMsIG5hbWUpO1xyXG59XHJcbi8vIGltcGxlbWVudGF0aW9uXHJcbmZ1bmN0aW9uIHJlc29sdmVBc3NldCh0eXBlLCBuYW1lLCB3YXJuTWlzc2luZyA9IHRydWUsIG1heWJlU2VsZlJlZmVyZW5jZSA9IGZhbHNlKSB7XHJcbiAgICBjb25zdCBpbnN0YW5jZSA9IGN1cnJlbnRSZW5kZXJpbmdJbnN0YW5jZSB8fCBjdXJyZW50SW5zdGFuY2U7XHJcbiAgICBpZiAoaW5zdGFuY2UpIHtcclxuICAgICAgICBjb25zdCBDb21wb25lbnQgPSBpbnN0YW5jZS50eXBlO1xyXG4gICAgICAgIC8vIGV4cGxpY2l0IHNlbGYgbmFtZSBoYXMgaGlnaGVzdCBwcmlvcml0eVxyXG4gICAgICAgIGlmICh0eXBlID09PSBDT01QT05FTlRTKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHNlbGZOYW1lID0gZ2V0Q29tcG9uZW50TmFtZShDb21wb25lbnQpO1xyXG4gICAgICAgICAgICBpZiAoc2VsZk5hbWUgJiZcclxuICAgICAgICAgICAgICAgIChzZWxmTmFtZSA9PT0gbmFtZSB8fFxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGZOYW1lID09PSBjYW1lbGl6ZShuYW1lKSB8fFxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGZOYW1lID09PSBjYXBpdGFsaXplKGNhbWVsaXplKG5hbWUpKSkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBDb21wb25lbnQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgcmVzID0gXHJcbiAgICAgICAgLy8gbG9jYWwgcmVnaXN0cmF0aW9uXHJcbiAgICAgICAgLy8gY2hlY2sgaW5zdGFuY2VbdHlwZV0gZmlyc3Qgd2hpY2ggaXMgcmVzb2x2ZWQgZm9yIG9wdGlvbnMgQVBJXHJcbiAgICAgICAgcmVzb2x2ZShpbnN0YW5jZVt0eXBlXSB8fCBDb21wb25lbnRbdHlwZV0sIG5hbWUpIHx8XHJcbiAgICAgICAgICAgIC8vIGdsb2JhbCByZWdpc3RyYXRpb25cclxuICAgICAgICAgICAgcmVzb2x2ZShpbnN0YW5jZS5hcHBDb250ZXh0W3R5cGVdLCBuYW1lKTtcclxuICAgICAgICBpZiAoIXJlcyAmJiBtYXliZVNlbGZSZWZlcmVuY2UpIHtcclxuICAgICAgICAgICAgLy8gZmFsbGJhY2sgdG8gaW1wbGljaXQgc2VsZi1yZWZlcmVuY2VcclxuICAgICAgICAgICAgcmV0dXJuIENvbXBvbmVudDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiB3YXJuTWlzc2luZyAmJiAhcmVzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGV4dHJhID0gdHlwZSA9PT0gQ09NUE9ORU5UU1xyXG4gICAgICAgICAgICAgICAgPyBgXFxuSWYgdGhpcyBpcyBhIG5hdGl2ZSBjdXN0b20gZWxlbWVudCwgbWFrZSBzdXJlIHRvIGV4Y2x1ZGUgaXQgZnJvbSBgICtcclxuICAgICAgICAgICAgICAgICAgICBgY29tcG9uZW50IHJlc29sdXRpb24gdmlhIGNvbXBpbGVyT3B0aW9ucy5pc0N1c3RvbUVsZW1lbnQuYFxyXG4gICAgICAgICAgICAgICAgOiBgYDtcclxuICAgICAgICAgICAgd2FybihgRmFpbGVkIHRvIHJlc29sdmUgJHt0eXBlLnNsaWNlKDAsIC0xKX06ICR7bmFtZX0ke2V4dHJhfWApO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgd2FybihgcmVzb2x2ZSR7Y2FwaXRhbGl6ZSh0eXBlLnNsaWNlKDAsIC0xKSl9IGAgK1xyXG4gICAgICAgICAgICBgY2FuIG9ubHkgYmUgdXNlZCBpbiByZW5kZXIoKSBvciBzZXR1cCgpLmApO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHJlc29sdmUocmVnaXN0cnksIG5hbWUpIHtcclxuICAgIHJldHVybiAocmVnaXN0cnkgJiZcclxuICAgICAgICAocmVnaXN0cnlbbmFtZV0gfHxcclxuICAgICAgICAgICAgcmVnaXN0cnlbY2FtZWxpemUobmFtZSldIHx8XHJcbiAgICAgICAgICAgIHJlZ2lzdHJ5W2NhcGl0YWxpemUoY2FtZWxpemUobmFtZSkpXSkpO1xyXG59XG5cbmNvbnN0IEZyYWdtZW50ID0gU3ltYm9sKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSA/ICdGcmFnbWVudCcgOiB1bmRlZmluZWQpO1xyXG5jb25zdCBUZXh0ID0gU3ltYm9sKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSA/ICdUZXh0JyA6IHVuZGVmaW5lZCk7XHJcbmNvbnN0IENvbW1lbnQgPSBTeW1ib2woKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpID8gJ0NvbW1lbnQnIDogdW5kZWZpbmVkKTtcclxuY29uc3QgU3RhdGljID0gU3ltYm9sKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSA/ICdTdGF0aWMnIDogdW5kZWZpbmVkKTtcclxuLy8gU2luY2Ugdi1pZiBhbmQgdi1mb3IgYXJlIHRoZSB0d28gcG9zc2libGUgd2F5cyBub2RlIHN0cnVjdHVyZSBjYW4gZHluYW1pY2FsbHlcclxuLy8gY2hhbmdlLCBvbmNlIHdlIGNvbnNpZGVyIHYtaWYgYnJhbmNoZXMgYW5kIGVhY2ggdi1mb3IgZnJhZ21lbnQgYSBibG9jaywgd2VcclxuLy8gY2FuIGRpdmlkZSBhIHRlbXBsYXRlIGludG8gbmVzdGVkIGJsb2NrcywgYW5kIHdpdGhpbiBlYWNoIGJsb2NrIHRoZSBub2RlXHJcbi8vIHN0cnVjdHVyZSB3b3VsZCBiZSBzdGFibGUuIFRoaXMgYWxsb3dzIHVzIHRvIHNraXAgbW9zdCBjaGlsZHJlbiBkaWZmaW5nXHJcbi8vIGFuZCBvbmx5IHdvcnJ5IGFib3V0IHRoZSBkeW5hbWljIG5vZGVzIChpbmRpY2F0ZWQgYnkgcGF0Y2ggZmxhZ3MpLlxyXG5jb25zdCBibG9ja1N0YWNrID0gW107XHJcbmxldCBjdXJyZW50QmxvY2sgPSBudWxsO1xyXG4vKipcclxuICogT3BlbiBhIGJsb2NrLlxyXG4gKiBUaGlzIG11c3QgYmUgY2FsbGVkIGJlZm9yZSBgY3JlYXRlQmxvY2tgLiBJdCBjYW5ub3QgYmUgcGFydCBvZiBgY3JlYXRlQmxvY2tgXHJcbiAqIGJlY2F1c2UgdGhlIGNoaWxkcmVuIG9mIHRoZSBibG9jayBhcmUgZXZhbHVhdGVkIGJlZm9yZSBgY3JlYXRlQmxvY2tgIGl0c2VsZlxyXG4gKiBpcyBjYWxsZWQuIFRoZSBnZW5lcmF0ZWQgY29kZSB0eXBpY2FsbHkgbG9va3MgbGlrZSB0aGlzOlxyXG4gKlxyXG4gKiBgYGBqc1xyXG4gKiBmdW5jdGlvbiByZW5kZXIoKSB7XHJcbiAqICAgcmV0dXJuIChvcGVuQmxvY2soKSxjcmVhdGVCbG9jaygnZGl2JywgbnVsbCwgWy4uLl0pKVxyXG4gKiB9XHJcbiAqIGBgYFxyXG4gKiBkaXNhYmxlVHJhY2tpbmcgaXMgdHJ1ZSB3aGVuIGNyZWF0aW5nIGEgdi1mb3IgZnJhZ21lbnQgYmxvY2ssIHNpbmNlIGEgdi1mb3JcclxuICogZnJhZ21lbnQgYWx3YXlzIGRpZmZzIGl0cyBjaGlsZHJlbi5cclxuICpcclxuICogQHByaXZhdGVcclxuICovXHJcbmZ1bmN0aW9uIG9wZW5CbG9jayhkaXNhYmxlVHJhY2tpbmcgPSBmYWxzZSkge1xyXG4gICAgYmxvY2tTdGFjay5wdXNoKChjdXJyZW50QmxvY2sgPSBkaXNhYmxlVHJhY2tpbmcgPyBudWxsIDogW10pKTtcclxufVxyXG5mdW5jdGlvbiBjbG9zZUJsb2NrKCkge1xyXG4gICAgYmxvY2tTdGFjay5wb3AoKTtcclxuICAgIGN1cnJlbnRCbG9jayA9IGJsb2NrU3RhY2tbYmxvY2tTdGFjay5sZW5ndGggLSAxXSB8fCBudWxsO1xyXG59XHJcbi8vIFdoZXRoZXIgd2Ugc2hvdWxkIGJlIHRyYWNraW5nIGR5bmFtaWMgY2hpbGQgbm9kZXMgaW5zaWRlIGEgYmxvY2suXHJcbi8vIE9ubHkgdHJhY2tzIHdoZW4gdGhpcyB2YWx1ZSBpcyA+IDBcclxuLy8gV2UgYXJlIG5vdCB1c2luZyBhIHNpbXBsZSBib29sZWFuIGJlY2F1c2UgdGhpcyB2YWx1ZSBtYXkgbmVlZCB0byBiZVxyXG4vLyBpbmNyZW1lbnRlZC9kZWNyZW1lbnRlZCBieSBuZXN0ZWQgdXNhZ2Ugb2Ygdi1vbmNlIChzZWUgYmVsb3cpXHJcbmxldCBpc0Jsb2NrVHJlZUVuYWJsZWQgPSAxO1xyXG4vKipcclxuICogQmxvY2sgdHJhY2tpbmcgc29tZXRpbWVzIG5lZWRzIHRvIGJlIGRpc2FibGVkLCBmb3IgZXhhbXBsZSBkdXJpbmcgdGhlXHJcbiAqIGNyZWF0aW9uIG9mIGEgdHJlZSB0aGF0IG5lZWRzIHRvIGJlIGNhY2hlZCBieSB2LW9uY2UuIFRoZSBjb21waWxlciBnZW5lcmF0ZXNcclxuICogY29kZSBsaWtlIHRoaXM6XHJcbiAqXHJcbiAqIGBgYCBqc1xyXG4gKiBfY2FjaGVbMV0gfHwgKFxyXG4gKiAgIHNldEJsb2NrVHJhY2tpbmcoLTEpLFxyXG4gKiAgIF9jYWNoZVsxXSA9IGNyZWF0ZVZOb2RlKC4uLiksXHJcbiAqICAgc2V0QmxvY2tUcmFja2luZygxKSxcclxuICogICBfY2FjaGVbMV1cclxuICogKVxyXG4gKiBgYGBcclxuICpcclxuICogQHByaXZhdGVcclxuICovXHJcbmZ1bmN0aW9uIHNldEJsb2NrVHJhY2tpbmcodmFsdWUpIHtcclxuICAgIGlzQmxvY2tUcmVlRW5hYmxlZCArPSB2YWx1ZTtcclxufVxyXG5mdW5jdGlvbiBzZXR1cEJsb2NrKHZub2RlKSB7XHJcbiAgICAvLyBzYXZlIGN1cnJlbnQgYmxvY2sgY2hpbGRyZW4gb24gdGhlIGJsb2NrIHZub2RlXHJcbiAgICB2bm9kZS5keW5hbWljQ2hpbGRyZW4gPVxyXG4gICAgICAgIGlzQmxvY2tUcmVlRW5hYmxlZCA+IDAgPyBjdXJyZW50QmxvY2sgfHwgRU1QVFlfQVJSIDogbnVsbDtcclxuICAgIC8vIGNsb3NlIGJsb2NrXHJcbiAgICBjbG9zZUJsb2NrKCk7XHJcbiAgICAvLyBhIGJsb2NrIGlzIGFsd2F5cyBnb2luZyB0byBiZSBwYXRjaGVkLCBzbyB0cmFjayBpdCBhcyBhIGNoaWxkIG9mIGl0c1xyXG4gICAgLy8gcGFyZW50IGJsb2NrXHJcbiAgICBpZiAoaXNCbG9ja1RyZWVFbmFibGVkID4gMCAmJiBjdXJyZW50QmxvY2spIHtcclxuICAgICAgICBjdXJyZW50QmxvY2sucHVzaCh2bm9kZSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdm5vZGU7XHJcbn1cclxuLyoqXHJcbiAqIEBwcml2YXRlXHJcbiAqL1xyXG5mdW5jdGlvbiBjcmVhdGVFbGVtZW50QmxvY2sodHlwZSwgcHJvcHMsIGNoaWxkcmVuLCBwYXRjaEZsYWcsIGR5bmFtaWNQcm9wcywgc2hhcGVGbGFnKSB7XHJcbiAgICByZXR1cm4gc2V0dXBCbG9jayhjcmVhdGVCYXNlVk5vZGUodHlwZSwgcHJvcHMsIGNoaWxkcmVuLCBwYXRjaEZsYWcsIGR5bmFtaWNQcm9wcywgc2hhcGVGbGFnLCB0cnVlIC8qIGlzQmxvY2sgKi8pKTtcclxufVxyXG4vKipcclxuICogQ3JlYXRlIGEgYmxvY2sgcm9vdCB2bm9kZS4gVGFrZXMgdGhlIHNhbWUgZXhhY3QgYXJndW1lbnRzIGFzIGBjcmVhdGVWTm9kZWAuXHJcbiAqIEEgYmxvY2sgcm9vdCBrZWVwcyB0cmFjayBvZiBkeW5hbWljIG5vZGVzIHdpdGhpbiB0aGUgYmxvY2sgaW4gdGhlXHJcbiAqIGBkeW5hbWljQ2hpbGRyZW5gIGFycmF5LlxyXG4gKlxyXG4gKiBAcHJpdmF0ZVxyXG4gKi9cclxuZnVuY3Rpb24gY3JlYXRlQmxvY2sodHlwZSwgcHJvcHMsIGNoaWxkcmVuLCBwYXRjaEZsYWcsIGR5bmFtaWNQcm9wcykge1xyXG4gICAgcmV0dXJuIHNldHVwQmxvY2soY3JlYXRlVk5vZGUodHlwZSwgcHJvcHMsIGNoaWxkcmVuLCBwYXRjaEZsYWcsIGR5bmFtaWNQcm9wcywgdHJ1ZSAvKiBpc0Jsb2NrOiBwcmV2ZW50IGEgYmxvY2sgZnJvbSB0cmFja2luZyBpdHNlbGYgKi8pKTtcclxufVxyXG5mdW5jdGlvbiBpc1ZOb2RlKHZhbHVlKSB7XHJcbiAgICByZXR1cm4gdmFsdWUgPyB2YWx1ZS5fX3ZfaXNWTm9kZSA9PT0gdHJ1ZSA6IGZhbHNlO1xyXG59XHJcbmZ1bmN0aW9uIGlzU2FtZVZOb2RlVHlwZShuMSwgbjIpIHtcclxuICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiZcclxuICAgICAgICBuMi5zaGFwZUZsYWcgJiA2IC8qIENPTVBPTkVOVCAqLyAmJlxyXG4gICAgICAgIGhtckRpcnR5Q29tcG9uZW50cy5oYXMobjIudHlwZSkpIHtcclxuICAgICAgICAvLyBITVIgb25seTogaWYgdGhlIGNvbXBvbmVudCBoYXMgYmVlbiBob3QtdXBkYXRlZCwgZm9yY2UgYSByZWxvYWQuXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG4xLnR5cGUgPT09IG4yLnR5cGUgJiYgbjEua2V5ID09PSBuMi5rZXk7XHJcbn1cclxubGV0IHZub2RlQXJnc1RyYW5zZm9ybWVyO1xyXG4vKipcclxuICogSW50ZXJuYWwgQVBJIGZvciByZWdpc3RlcmluZyBhbiBhcmd1bWVudHMgdHJhbnNmb3JtIGZvciBjcmVhdGVWTm9kZVxyXG4gKiB1c2VkIGZvciBjcmVhdGluZyBzdHVicyBpbiB0aGUgdGVzdC11dGlsc1xyXG4gKiBJdCBpcyAqaW50ZXJuYWwqIGJ1dCBuZWVkcyB0byBiZSBleHBvc2VkIGZvciB0ZXN0LXV0aWxzIHRvIHBpY2sgdXAgcHJvcGVyXHJcbiAqIHR5cGluZ3NcclxuICovXHJcbmZ1bmN0aW9uIHRyYW5zZm9ybVZOb2RlQXJncyh0cmFuc2Zvcm1lcikge1xyXG4gICAgdm5vZGVBcmdzVHJhbnNmb3JtZXIgPSB0cmFuc2Zvcm1lcjtcclxufVxyXG5jb25zdCBjcmVhdGVWTm9kZVdpdGhBcmdzVHJhbnNmb3JtID0gKC4uLmFyZ3MpID0+IHtcclxuICAgIHJldHVybiBfY3JlYXRlVk5vZGUoLi4uKHZub2RlQXJnc1RyYW5zZm9ybWVyXHJcbiAgICAgICAgPyB2bm9kZUFyZ3NUcmFuc2Zvcm1lcihhcmdzLCBjdXJyZW50UmVuZGVyaW5nSW5zdGFuY2UpXHJcbiAgICAgICAgOiBhcmdzKSk7XHJcbn07XHJcbmNvbnN0IEludGVybmFsT2JqZWN0S2V5ID0gYF9fdkludGVybmFsYDtcclxuY29uc3Qgbm9ybWFsaXplS2V5ID0gKHsga2V5IH0pID0+IGtleSAhPSBudWxsID8ga2V5IDogbnVsbDtcclxuY29uc3Qgbm9ybWFsaXplUmVmID0gKHsgcmVmLCByZWZfa2V5LCByZWZfZm9yIH0pID0+IHtcclxuICAgIHJldHVybiAocmVmICE9IG51bGxcclxuICAgICAgICA/IGlzU3RyaW5nKHJlZikgfHwgaXNSZWYocmVmKSB8fCBpc0Z1bmN0aW9uKHJlZilcclxuICAgICAgICAgICAgPyB7IGk6IGN1cnJlbnRSZW5kZXJpbmdJbnN0YW5jZSwgcjogcmVmLCBrOiByZWZfa2V5LCBmOiAhIXJlZl9mb3IgfVxyXG4gICAgICAgICAgICA6IHJlZlxyXG4gICAgICAgIDogbnVsbCk7XHJcbn07XHJcbmZ1bmN0aW9uIGNyZWF0ZUJhc2VWTm9kZSh0eXBlLCBwcm9wcyA9IG51bGwsIGNoaWxkcmVuID0gbnVsbCwgcGF0Y2hGbGFnID0gMCwgZHluYW1pY1Byb3BzID0gbnVsbCwgc2hhcGVGbGFnID0gdHlwZSA9PT0gRnJhZ21lbnQgPyAwIDogMSAvKiBFTEVNRU5UICovLCBpc0Jsb2NrTm9kZSA9IGZhbHNlLCBuZWVkRnVsbENoaWxkcmVuTm9ybWFsaXphdGlvbiA9IGZhbHNlKSB7XHJcbiAgICBjb25zdCB2bm9kZSA9IHtcclxuICAgICAgICBfX3ZfaXNWTm9kZTogdHJ1ZSxcclxuICAgICAgICBfX3Zfc2tpcDogdHJ1ZSxcclxuICAgICAgICB0eXBlLFxyXG4gICAgICAgIHByb3BzLFxyXG4gICAgICAgIGtleTogcHJvcHMgJiYgbm9ybWFsaXplS2V5KHByb3BzKSxcclxuICAgICAgICByZWY6IHByb3BzICYmIG5vcm1hbGl6ZVJlZihwcm9wcyksXHJcbiAgICAgICAgc2NvcGVJZDogY3VycmVudFNjb3BlSWQsXHJcbiAgICAgICAgc2xvdFNjb3BlSWRzOiBudWxsLFxyXG4gICAgICAgIGNoaWxkcmVuLFxyXG4gICAgICAgIGNvbXBvbmVudDogbnVsbCxcclxuICAgICAgICBzdXNwZW5zZTogbnVsbCxcclxuICAgICAgICBzc0NvbnRlbnQ6IG51bGwsXHJcbiAgICAgICAgc3NGYWxsYmFjazogbnVsbCxcclxuICAgICAgICBkaXJzOiBudWxsLFxyXG4gICAgICAgIHRyYW5zaXRpb246IG51bGwsXHJcbiAgICAgICAgZWw6IG51bGwsXHJcbiAgICAgICAgYW5jaG9yOiBudWxsLFxyXG4gICAgICAgIHRhcmdldDogbnVsbCxcclxuICAgICAgICB0YXJnZXRBbmNob3I6IG51bGwsXHJcbiAgICAgICAgc3RhdGljQ291bnQ6IDAsXHJcbiAgICAgICAgc2hhcGVGbGFnLFxyXG4gICAgICAgIHBhdGNoRmxhZyxcclxuICAgICAgICBkeW5hbWljUHJvcHMsXHJcbiAgICAgICAgZHluYW1pY0NoaWxkcmVuOiBudWxsLFxyXG4gICAgICAgIGFwcENvbnRleHQ6IG51bGxcclxuICAgIH07XHJcbiAgICBpZiAobmVlZEZ1bGxDaGlsZHJlbk5vcm1hbGl6YXRpb24pIHtcclxuICAgICAgICBub3JtYWxpemVDaGlsZHJlbih2bm9kZSwgY2hpbGRyZW4pO1xyXG4gICAgICAgIC8vIG5vcm1hbGl6ZSBzdXNwZW5zZSBjaGlsZHJlblxyXG4gICAgICAgIGlmIChzaGFwZUZsYWcgJiAxMjggLyogU1VTUEVOU0UgKi8pIHtcclxuICAgICAgICAgICAgdHlwZS5ub3JtYWxpemUodm5vZGUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGNoaWxkcmVuKSB7XHJcbiAgICAgICAgLy8gY29tcGlsZWQgZWxlbWVudCB2bm9kZSAtIGlmIGNoaWxkcmVuIGlzIHBhc3NlZCwgb25seSBwb3NzaWJsZSB0eXBlcyBhcmVcclxuICAgICAgICAvLyBzdHJpbmcgb3IgQXJyYXkuXHJcbiAgICAgICAgdm5vZGUuc2hhcGVGbGFnIHw9IGlzU3RyaW5nKGNoaWxkcmVuKVxyXG4gICAgICAgICAgICA/IDggLyogVEVYVF9DSElMRFJFTiAqL1xyXG4gICAgICAgICAgICA6IDE2IC8qIEFSUkFZX0NISUxEUkVOICovO1xyXG4gICAgfVxyXG4gICAgLy8gdmFsaWRhdGUga2V5XHJcbiAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmIHZub2RlLmtleSAhPT0gdm5vZGUua2V5KSB7XHJcbiAgICAgICAgd2FybihgVk5vZGUgY3JlYXRlZCB3aXRoIGludmFsaWQga2V5IChOYU4pLiBWTm9kZSB0eXBlOmAsIHZub2RlLnR5cGUpO1xyXG4gICAgfVxyXG4gICAgLy8gdHJhY2sgdm5vZGUgZm9yIGJsb2NrIHRyZWVcclxuICAgIGlmIChpc0Jsb2NrVHJlZUVuYWJsZWQgPiAwICYmXHJcbiAgICAgICAgLy8gYXZvaWQgYSBibG9jayBub2RlIGZyb20gdHJhY2tpbmcgaXRzZWxmXHJcbiAgICAgICAgIWlzQmxvY2tOb2RlICYmXHJcbiAgICAgICAgLy8gaGFzIGN1cnJlbnQgcGFyZW50IGJsb2NrXHJcbiAgICAgICAgY3VycmVudEJsb2NrICYmXHJcbiAgICAgICAgLy8gcHJlc2VuY2Ugb2YgYSBwYXRjaCBmbGFnIGluZGljYXRlcyB0aGlzIG5vZGUgbmVlZHMgcGF0Y2hpbmcgb24gdXBkYXRlcy5cclxuICAgICAgICAvLyBjb21wb25lbnQgbm9kZXMgYWxzbyBzaG91bGQgYWx3YXlzIGJlIHBhdGNoZWQsIGJlY2F1c2UgZXZlbiBpZiB0aGVcclxuICAgICAgICAvLyBjb21wb25lbnQgZG9lc24ndCBuZWVkIHRvIHVwZGF0ZSwgaXQgbmVlZHMgdG8gcGVyc2lzdCB0aGUgaW5zdGFuY2Ugb24gdG9cclxuICAgICAgICAvLyB0aGUgbmV4dCB2bm9kZSBzbyB0aGF0IGl0IGNhbiBiZSBwcm9wZXJseSB1bm1vdW50ZWQgbGF0ZXIuXHJcbiAgICAgICAgKHZub2RlLnBhdGNoRmxhZyA+IDAgfHwgc2hhcGVGbGFnICYgNiAvKiBDT01QT05FTlQgKi8pICYmXHJcbiAgICAgICAgLy8gdGhlIEVWRU5UUyBmbGFnIGlzIG9ubHkgZm9yIGh5ZHJhdGlvbiBhbmQgaWYgaXQgaXMgdGhlIG9ubHkgZmxhZywgdGhlXHJcbiAgICAgICAgLy8gdm5vZGUgc2hvdWxkIG5vdCBiZSBjb25zaWRlcmVkIGR5bmFtaWMgZHVlIHRvIGhhbmRsZXIgY2FjaGluZy5cclxuICAgICAgICB2bm9kZS5wYXRjaEZsYWcgIT09IDMyIC8qIEhZRFJBVEVfRVZFTlRTICovKSB7XHJcbiAgICAgICAgY3VycmVudEJsb2NrLnB1c2godm5vZGUpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHZub2RlO1xyXG59XHJcbmNvbnN0IGNyZWF0ZVZOb2RlID0gKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSA/IGNyZWF0ZVZOb2RlV2l0aEFyZ3NUcmFuc2Zvcm0gOiBfY3JlYXRlVk5vZGUpO1xyXG5mdW5jdGlvbiBfY3JlYXRlVk5vZGUodHlwZSwgcHJvcHMgPSBudWxsLCBjaGlsZHJlbiA9IG51bGwsIHBhdGNoRmxhZyA9IDAsIGR5bmFtaWNQcm9wcyA9IG51bGwsIGlzQmxvY2tOb2RlID0gZmFsc2UpIHtcclxuICAgIGlmICghdHlwZSB8fCB0eXBlID09PSBOVUxMX0RZTkFNSUNfQ09NUE9ORU5UKSB7XHJcbiAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiAhdHlwZSkge1xyXG4gICAgICAgICAgICB3YXJuKGBJbnZhbGlkIHZub2RlIHR5cGUgd2hlbiBjcmVhdGluZyB2bm9kZTogJHt0eXBlfS5gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdHlwZSA9IENvbW1lbnQ7XHJcbiAgICB9XHJcbiAgICBpZiAoaXNWTm9kZSh0eXBlKSkge1xyXG4gICAgICAgIC8vIGNyZWF0ZVZOb2RlIHJlY2VpdmluZyBhbiBleGlzdGluZyB2bm9kZS4gVGhpcyBoYXBwZW5zIGluIGNhc2VzIGxpa2VcclxuICAgICAgICAvLyA8Y29tcG9uZW50IDppcz1cInZub2RlXCIvPlxyXG4gICAgICAgIC8vICMyMDc4IG1ha2Ugc3VyZSB0byBtZXJnZSByZWZzIGR1cmluZyB0aGUgY2xvbmUgaW5zdGVhZCBvZiBvdmVyd3JpdGluZyBpdFxyXG4gICAgICAgIGNvbnN0IGNsb25lZCA9IGNsb25lVk5vZGUodHlwZSwgcHJvcHMsIHRydWUgLyogbWVyZ2VSZWY6IHRydWUgKi8pO1xyXG4gICAgICAgIGlmIChjaGlsZHJlbikge1xyXG4gICAgICAgICAgICBub3JtYWxpemVDaGlsZHJlbihjbG9uZWQsIGNoaWxkcmVuKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGNsb25lZDtcclxuICAgIH1cclxuICAgIC8vIGNsYXNzIGNvbXBvbmVudCBub3JtYWxpemF0aW9uLlxyXG4gICAgaWYgKGlzQ2xhc3NDb21wb25lbnQodHlwZSkpIHtcclxuICAgICAgICB0eXBlID0gdHlwZS5fX3ZjY09wdHM7XHJcbiAgICB9XHJcbiAgICAvLyBjbGFzcyAmIHN0eWxlIG5vcm1hbGl6YXRpb24uXHJcbiAgICBpZiAocHJvcHMpIHtcclxuICAgICAgICAvLyBmb3IgcmVhY3RpdmUgb3IgcHJveHkgb2JqZWN0cywgd2UgbmVlZCB0byBjbG9uZSBpdCB0byBlbmFibGUgbXV0YXRpb24uXHJcbiAgICAgICAgcHJvcHMgPSBndWFyZFJlYWN0aXZlUHJvcHMocHJvcHMpO1xyXG4gICAgICAgIGxldCB7IGNsYXNzOiBrbGFzcywgc3R5bGUgfSA9IHByb3BzO1xyXG4gICAgICAgIGlmIChrbGFzcyAmJiAhaXNTdHJpbmcoa2xhc3MpKSB7XHJcbiAgICAgICAgICAgIHByb3BzLmNsYXNzID0gbm9ybWFsaXplQ2xhc3Moa2xhc3MpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoaXNPYmplY3Qoc3R5bGUpKSB7XHJcbiAgICAgICAgICAgIC8vIHJlYWN0aXZlIHN0YXRlIG9iamVjdHMgbmVlZCB0byBiZSBjbG9uZWQgc2luY2UgdGhleSBhcmUgbGlrZWx5IHRvIGJlXHJcbiAgICAgICAgICAgIC8vIG11dGF0ZWRcclxuICAgICAgICAgICAgaWYgKGlzUHJveHkoc3R5bGUpICYmICFpc0FycmF5KHN0eWxlKSkge1xyXG4gICAgICAgICAgICAgICAgc3R5bGUgPSBleHRlbmQoe30sIHN0eWxlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBwcm9wcy5zdHlsZSA9IG5vcm1hbGl6ZVN0eWxlKHN0eWxlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyBlbmNvZGUgdGhlIHZub2RlIHR5cGUgaW5mb3JtYXRpb24gaW50byBhIGJpdG1hcFxyXG4gICAgY29uc3Qgc2hhcGVGbGFnID0gaXNTdHJpbmcodHlwZSlcclxuICAgICAgICA/IDEgLyogRUxFTUVOVCAqL1xyXG4gICAgICAgIDogaXNTdXNwZW5zZSh0eXBlKVxyXG4gICAgICAgICAgICA/IDEyOCAvKiBTVVNQRU5TRSAqL1xyXG4gICAgICAgICAgICA6IGlzVGVsZXBvcnQodHlwZSlcclxuICAgICAgICAgICAgICAgID8gNjQgLyogVEVMRVBPUlQgKi9cclxuICAgICAgICAgICAgICAgIDogaXNPYmplY3QodHlwZSlcclxuICAgICAgICAgICAgICAgICAgICA/IDQgLyogU1RBVEVGVUxfQ09NUE9ORU5UICovXHJcbiAgICAgICAgICAgICAgICAgICAgOiBpc0Z1bmN0aW9uKHR5cGUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgID8gMiAvKiBGVU5DVElPTkFMX0NPTVBPTkVOVCAqL1xyXG4gICAgICAgICAgICAgICAgICAgICAgICA6IDA7XHJcbiAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmIHNoYXBlRmxhZyAmIDQgLyogU1RBVEVGVUxfQ09NUE9ORU5UICovICYmIGlzUHJveHkodHlwZSkpIHtcclxuICAgICAgICB0eXBlID0gdG9SYXcodHlwZSk7XHJcbiAgICAgICAgd2FybihgVnVlIHJlY2VpdmVkIGEgQ29tcG9uZW50IHdoaWNoIHdhcyBtYWRlIGEgcmVhY3RpdmUgb2JqZWN0LiBUaGlzIGNhbiBgICtcclxuICAgICAgICAgICAgYGxlYWQgdG8gdW5uZWNlc3NhcnkgcGVyZm9ybWFuY2Ugb3ZlcmhlYWQsIGFuZCBzaG91bGQgYmUgYXZvaWRlZCBieSBgICtcclxuICAgICAgICAgICAgYG1hcmtpbmcgdGhlIGNvbXBvbmVudCB3aXRoIFxcYG1hcmtSYXdcXGAgb3IgdXNpbmcgXFxgc2hhbGxvd1JlZlxcYCBgICtcclxuICAgICAgICAgICAgYGluc3RlYWQgb2YgXFxgcmVmXFxgLmAsIGBcXG5Db21wb25lbnQgdGhhdCB3YXMgbWFkZSByZWFjdGl2ZTogYCwgdHlwZSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gY3JlYXRlQmFzZVZOb2RlKHR5cGUsIHByb3BzLCBjaGlsZHJlbiwgcGF0Y2hGbGFnLCBkeW5hbWljUHJvcHMsIHNoYXBlRmxhZywgaXNCbG9ja05vZGUsIHRydWUpO1xyXG59XHJcbmZ1bmN0aW9uIGd1YXJkUmVhY3RpdmVQcm9wcyhwcm9wcykge1xyXG4gICAgaWYgKCFwcm9wcylcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIHJldHVybiBpc1Byb3h5KHByb3BzKSB8fCBJbnRlcm5hbE9iamVjdEtleSBpbiBwcm9wc1xyXG4gICAgICAgID8gZXh0ZW5kKHt9LCBwcm9wcylcclxuICAgICAgICA6IHByb3BzO1xyXG59XHJcbmZ1bmN0aW9uIGNsb25lVk5vZGUodm5vZGUsIGV4dHJhUHJvcHMsIG1lcmdlUmVmID0gZmFsc2UpIHtcclxuICAgIC8vIFRoaXMgaXMgaW50ZW50aW9uYWxseSBOT1QgdXNpbmcgc3ByZWFkIG9yIGV4dGVuZCB0byBhdm9pZCB0aGUgcnVudGltZVxyXG4gICAgLy8ga2V5IGVudW1lcmF0aW9uIGNvc3QuXHJcbiAgICBjb25zdCB7IHByb3BzLCByZWYsIHBhdGNoRmxhZywgY2hpbGRyZW4gfSA9IHZub2RlO1xyXG4gICAgY29uc3QgbWVyZ2VkUHJvcHMgPSBleHRyYVByb3BzID8gbWVyZ2VQcm9wcyhwcm9wcyB8fCB7fSwgZXh0cmFQcm9wcykgOiBwcm9wcztcclxuICAgIGNvbnN0IGNsb25lZCA9IHtcclxuICAgICAgICBfX3ZfaXNWTm9kZTogdHJ1ZSxcclxuICAgICAgICBfX3Zfc2tpcDogdHJ1ZSxcclxuICAgICAgICB0eXBlOiB2bm9kZS50eXBlLFxyXG4gICAgICAgIHByb3BzOiBtZXJnZWRQcm9wcyxcclxuICAgICAgICBrZXk6IG1lcmdlZFByb3BzICYmIG5vcm1hbGl6ZUtleShtZXJnZWRQcm9wcyksXHJcbiAgICAgICAgcmVmOiBleHRyYVByb3BzICYmIGV4dHJhUHJvcHMucmVmXHJcbiAgICAgICAgICAgID8gLy8gIzIwNzggaW4gdGhlIGNhc2Ugb2YgPGNvbXBvbmVudCA6aXM9XCJ2bm9kZVwiIHJlZj1cImV4dHJhXCIvPlxyXG4gICAgICAgICAgICAgICAgLy8gaWYgdGhlIHZub2RlIGl0c2VsZiBhbHJlYWR5IGhhcyBhIHJlZiwgY2xvbmVWTm9kZSB3aWxsIG5lZWQgdG8gbWVyZ2VcclxuICAgICAgICAgICAgICAgIC8vIHRoZSByZWZzIHNvIHRoZSBzaW5nbGUgdm5vZGUgY2FuIGJlIHNldCBvbiBtdWx0aXBsZSByZWZzXHJcbiAgICAgICAgICAgICAgICBtZXJnZVJlZiAmJiByZWZcclxuICAgICAgICAgICAgICAgICAgICA/IGlzQXJyYXkocmVmKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA/IHJlZi5jb25jYXQobm9ybWFsaXplUmVmKGV4dHJhUHJvcHMpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA6IFtyZWYsIG5vcm1hbGl6ZVJlZihleHRyYVByb3BzKV1cclxuICAgICAgICAgICAgICAgICAgICA6IG5vcm1hbGl6ZVJlZihleHRyYVByb3BzKVxyXG4gICAgICAgICAgICA6IHJlZixcclxuICAgICAgICBzY29wZUlkOiB2bm9kZS5zY29wZUlkLFxyXG4gICAgICAgIHNsb3RTY29wZUlkczogdm5vZGUuc2xvdFNjb3BlSWRzLFxyXG4gICAgICAgIGNoaWxkcmVuOiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiYgcGF0Y2hGbGFnID09PSAtMSAvKiBIT0lTVEVEICovICYmIGlzQXJyYXkoY2hpbGRyZW4pXHJcbiAgICAgICAgICAgID8gY2hpbGRyZW4ubWFwKGRlZXBDbG9uZVZOb2RlKVxyXG4gICAgICAgICAgICA6IGNoaWxkcmVuLFxyXG4gICAgICAgIHRhcmdldDogdm5vZGUudGFyZ2V0LFxyXG4gICAgICAgIHRhcmdldEFuY2hvcjogdm5vZGUudGFyZ2V0QW5jaG9yLFxyXG4gICAgICAgIHN0YXRpY0NvdW50OiB2bm9kZS5zdGF0aWNDb3VudCxcclxuICAgICAgICBzaGFwZUZsYWc6IHZub2RlLnNoYXBlRmxhZyxcclxuICAgICAgICAvLyBpZiB0aGUgdm5vZGUgaXMgY2xvbmVkIHdpdGggZXh0cmEgcHJvcHMsIHdlIGNhbiBubyBsb25nZXIgYXNzdW1lIGl0c1xyXG4gICAgICAgIC8vIGV4aXN0aW5nIHBhdGNoIGZsYWcgdG8gYmUgcmVsaWFibGUgYW5kIG5lZWQgdG8gYWRkIHRoZSBGVUxMX1BST1BTIGZsYWcuXHJcbiAgICAgICAgLy8gbm90ZTogcHJlc2VydmUgZmxhZyBmb3IgZnJhZ21lbnRzIHNpbmNlIHRoZXkgdXNlIHRoZSBmbGFnIGZvciBjaGlsZHJlblxyXG4gICAgICAgIC8vIGZhc3QgcGF0aHMgb25seS5cclxuICAgICAgICBwYXRjaEZsYWc6IGV4dHJhUHJvcHMgJiYgdm5vZGUudHlwZSAhPT0gRnJhZ21lbnRcclxuICAgICAgICAgICAgPyBwYXRjaEZsYWcgPT09IC0xIC8vIGhvaXN0ZWQgbm9kZVxyXG4gICAgICAgICAgICAgICAgPyAxNiAvKiBGVUxMX1BST1BTICovXHJcbiAgICAgICAgICAgICAgICA6IHBhdGNoRmxhZyB8IDE2IC8qIEZVTExfUFJPUFMgKi9cclxuICAgICAgICAgICAgOiBwYXRjaEZsYWcsXHJcbiAgICAgICAgZHluYW1pY1Byb3BzOiB2bm9kZS5keW5hbWljUHJvcHMsXHJcbiAgICAgICAgZHluYW1pY0NoaWxkcmVuOiB2bm9kZS5keW5hbWljQ2hpbGRyZW4sXHJcbiAgICAgICAgYXBwQ29udGV4dDogdm5vZGUuYXBwQ29udGV4dCxcclxuICAgICAgICBkaXJzOiB2bm9kZS5kaXJzLFxyXG4gICAgICAgIHRyYW5zaXRpb246IHZub2RlLnRyYW5zaXRpb24sXHJcbiAgICAgICAgLy8gVGhlc2Ugc2hvdWxkIHRlY2huaWNhbGx5IG9ubHkgYmUgbm9uLW51bGwgb24gbW91bnRlZCBWTm9kZXMuIEhvd2V2ZXIsXHJcbiAgICAgICAgLy8gdGhleSAqc2hvdWxkKiBiZSBjb3BpZWQgZm9yIGtlcHQtYWxpdmUgdm5vZGVzLiBTbyB3ZSBqdXN0IGFsd2F5cyBjb3B5XHJcbiAgICAgICAgLy8gdGhlbSBzaW5jZSB0aGVtIGJlaW5nIG5vbi1udWxsIGR1cmluZyBhIG1vdW50IGRvZXNuJ3QgYWZmZWN0IHRoZSBsb2dpYyBhc1xyXG4gICAgICAgIC8vIHRoZXkgd2lsbCBzaW1wbHkgYmUgb3ZlcndyaXR0ZW4uXHJcbiAgICAgICAgY29tcG9uZW50OiB2bm9kZS5jb21wb25lbnQsXHJcbiAgICAgICAgc3VzcGVuc2U6IHZub2RlLnN1c3BlbnNlLFxyXG4gICAgICAgIHNzQ29udGVudDogdm5vZGUuc3NDb250ZW50ICYmIGNsb25lVk5vZGUodm5vZGUuc3NDb250ZW50KSxcclxuICAgICAgICBzc0ZhbGxiYWNrOiB2bm9kZS5zc0ZhbGxiYWNrICYmIGNsb25lVk5vZGUodm5vZGUuc3NGYWxsYmFjayksXHJcbiAgICAgICAgZWw6IHZub2RlLmVsLFxyXG4gICAgICAgIGFuY2hvcjogdm5vZGUuYW5jaG9yXHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIGNsb25lZDtcclxufVxyXG4vKipcclxuICogRGV2IG9ubHksIGZvciBITVIgb2YgaG9pc3RlZCB2bm9kZXMgcmV1c2VkIGluIHYtZm9yXHJcbiAqIGh0dHBzOi8vZ2l0aHViLmNvbS92aXRlanMvdml0ZS9pc3N1ZXMvMjAyMlxyXG4gKi9cclxuZnVuY3Rpb24gZGVlcENsb25lVk5vZGUodm5vZGUpIHtcclxuICAgIGNvbnN0IGNsb25lZCA9IGNsb25lVk5vZGUodm5vZGUpO1xyXG4gICAgaWYgKGlzQXJyYXkodm5vZGUuY2hpbGRyZW4pKSB7XHJcbiAgICAgICAgY2xvbmVkLmNoaWxkcmVuID0gdm5vZGUuY2hpbGRyZW4ubWFwKGRlZXBDbG9uZVZOb2RlKTtcclxuICAgIH1cclxuICAgIHJldHVybiBjbG9uZWQ7XHJcbn1cclxuLyoqXHJcbiAqIEBwcml2YXRlXHJcbiAqL1xyXG5mdW5jdGlvbiBjcmVhdGVUZXh0Vk5vZGUodGV4dCA9ICcgJywgZmxhZyA9IDApIHtcclxuICAgIHJldHVybiBjcmVhdGVWTm9kZShUZXh0LCBudWxsLCB0ZXh0LCBmbGFnKTtcclxufVxyXG4vKipcclxuICogQHByaXZhdGVcclxuICovXHJcbmZ1bmN0aW9uIGNyZWF0ZVN0YXRpY1ZOb2RlKGNvbnRlbnQsIG51bWJlck9mTm9kZXMpIHtcclxuICAgIC8vIEEgc3RhdGljIHZub2RlIGNhbiBjb250YWluIG11bHRpcGxlIHN0cmluZ2lmaWVkIGVsZW1lbnRzLCBhbmQgdGhlIG51bWJlclxyXG4gICAgLy8gb2YgZWxlbWVudHMgaXMgbmVjZXNzYXJ5IGZvciBoeWRyYXRpb24uXHJcbiAgICBjb25zdCB2bm9kZSA9IGNyZWF0ZVZOb2RlKFN0YXRpYywgbnVsbCwgY29udGVudCk7XHJcbiAgICB2bm9kZS5zdGF0aWNDb3VudCA9IG51bWJlck9mTm9kZXM7XHJcbiAgICByZXR1cm4gdm5vZGU7XHJcbn1cclxuLyoqXHJcbiAqIEBwcml2YXRlXHJcbiAqL1xyXG5mdW5jdGlvbiBjcmVhdGVDb21tZW50Vk5vZGUodGV4dCA9ICcnLCBcclxuLy8gd2hlbiB1c2VkIGFzIHRoZSB2LWVsc2UgYnJhbmNoLCB0aGUgY29tbWVudCBub2RlIG11c3QgYmUgY3JlYXRlZCBhcyBhXHJcbi8vIGJsb2NrIHRvIGVuc3VyZSBjb3JyZWN0IHVwZGF0ZXMuXHJcbmFzQmxvY2sgPSBmYWxzZSkge1xyXG4gICAgcmV0dXJuIGFzQmxvY2tcclxuICAgICAgICA/IChvcGVuQmxvY2soKSwgY3JlYXRlQmxvY2soQ29tbWVudCwgbnVsbCwgdGV4dCkpXHJcbiAgICAgICAgOiBjcmVhdGVWTm9kZShDb21tZW50LCBudWxsLCB0ZXh0KTtcclxufVxyXG5mdW5jdGlvbiBub3JtYWxpemVWTm9kZShjaGlsZCkge1xyXG4gICAgaWYgKGNoaWxkID09IG51bGwgfHwgdHlwZW9mIGNoaWxkID09PSAnYm9vbGVhbicpIHtcclxuICAgICAgICAvLyBlbXB0eSBwbGFjZWhvbGRlclxyXG4gICAgICAgIHJldHVybiBjcmVhdGVWTm9kZShDb21tZW50KTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGlzQXJyYXkoY2hpbGQpKSB7XHJcbiAgICAgICAgLy8gZnJhZ21lbnRcclxuICAgICAgICByZXR1cm4gY3JlYXRlVk5vZGUoRnJhZ21lbnQsIG51bGwsIFxyXG4gICAgICAgIC8vICMzNjY2LCBhdm9pZCByZWZlcmVuY2UgcG9sbHV0aW9uIHdoZW4gcmV1c2luZyB2bm9kZVxyXG4gICAgICAgIGNoaWxkLnNsaWNlKCkpO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAodHlwZW9mIGNoaWxkID09PSAnb2JqZWN0Jykge1xyXG4gICAgICAgIC8vIGFscmVhZHkgdm5vZGUsIHRoaXMgc2hvdWxkIGJlIHRoZSBtb3N0IGNvbW1vbiBzaW5jZSBjb21waWxlZCB0ZW1wbGF0ZXNcclxuICAgICAgICAvLyBhbHdheXMgcHJvZHVjZSBhbGwtdm5vZGUgY2hpbGRyZW4gYXJyYXlzXHJcbiAgICAgICAgcmV0dXJuIGNsb25lSWZNb3VudGVkKGNoaWxkKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIC8vIHN0cmluZ3MgYW5kIG51bWJlcnNcclxuICAgICAgICByZXR1cm4gY3JlYXRlVk5vZGUoVGV4dCwgbnVsbCwgU3RyaW5nKGNoaWxkKSk7XHJcbiAgICB9XHJcbn1cclxuLy8gb3B0aW1pemVkIG5vcm1hbGl6YXRpb24gZm9yIHRlbXBsYXRlLWNvbXBpbGVkIHJlbmRlciBmbnNcclxuZnVuY3Rpb24gY2xvbmVJZk1vdW50ZWQoY2hpbGQpIHtcclxuICAgIHJldHVybiBjaGlsZC5lbCA9PT0gbnVsbCB8fCBjaGlsZC5tZW1vID8gY2hpbGQgOiBjbG9uZVZOb2RlKGNoaWxkKTtcclxufVxyXG5mdW5jdGlvbiBub3JtYWxpemVDaGlsZHJlbih2bm9kZSwgY2hpbGRyZW4pIHtcclxuICAgIGxldCB0eXBlID0gMDtcclxuICAgIGNvbnN0IHsgc2hhcGVGbGFnIH0gPSB2bm9kZTtcclxuICAgIGlmIChjaGlsZHJlbiA9PSBudWxsKSB7XHJcbiAgICAgICAgY2hpbGRyZW4gPSBudWxsO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoaXNBcnJheShjaGlsZHJlbikpIHtcclxuICAgICAgICB0eXBlID0gMTYgLyogQVJSQVlfQ0hJTERSRU4gKi87XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICh0eXBlb2YgY2hpbGRyZW4gPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgaWYgKHNoYXBlRmxhZyAmICgxIC8qIEVMRU1FTlQgKi8gfCA2NCAvKiBURUxFUE9SVCAqLykpIHtcclxuICAgICAgICAgICAgLy8gTm9ybWFsaXplIHNsb3QgdG8gcGxhaW4gY2hpbGRyZW4gZm9yIHBsYWluIGVsZW1lbnQgYW5kIFRlbGVwb3J0XHJcbiAgICAgICAgICAgIGNvbnN0IHNsb3QgPSBjaGlsZHJlbi5kZWZhdWx0O1xyXG4gICAgICAgICAgICBpZiAoc2xvdCkge1xyXG4gICAgICAgICAgICAgICAgLy8gX2MgbWFya2VyIGlzIGFkZGVkIGJ5IHdpdGhDdHgoKSBpbmRpY2F0aW5nIHRoaXMgaXMgYSBjb21waWxlZCBzbG90XHJcbiAgICAgICAgICAgICAgICBzbG90Ll9jICYmIChzbG90Ll9kID0gZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgbm9ybWFsaXplQ2hpbGRyZW4odm5vZGUsIHNsb3QoKSk7XHJcbiAgICAgICAgICAgICAgICBzbG90Ll9jICYmIChzbG90Ll9kID0gdHJ1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdHlwZSA9IDMyIC8qIFNMT1RTX0NISUxEUkVOICovO1xyXG4gICAgICAgICAgICBjb25zdCBzbG90RmxhZyA9IGNoaWxkcmVuLl87XHJcbiAgICAgICAgICAgIGlmICghc2xvdEZsYWcgJiYgIShJbnRlcm5hbE9iamVjdEtleSBpbiBjaGlsZHJlbikpIHtcclxuICAgICAgICAgICAgICAgIGNoaWxkcmVuLl9jdHggPSBjdXJyZW50UmVuZGVyaW5nSW5zdGFuY2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoc2xvdEZsYWcgPT09IDMgLyogRk9SV0FSREVEICovICYmIGN1cnJlbnRSZW5kZXJpbmdJbnN0YW5jZSkge1xyXG4gICAgICAgICAgICAgICAgLy8gYSBjaGlsZCBjb21wb25lbnQgcmVjZWl2ZXMgZm9yd2FyZGVkIHNsb3RzIGZyb20gdGhlIHBhcmVudC5cclxuICAgICAgICAgICAgICAgIC8vIGl0cyBzbG90IHR5cGUgaXMgZGV0ZXJtaW5lZCBieSBpdHMgcGFyZW50J3Mgc2xvdCB0eXBlLlxyXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRSZW5kZXJpbmdJbnN0YW5jZS5zbG90cy5fID09PSAxIC8qIFNUQUJMRSAqLykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuLl8gPSAxIC8qIFNUQUJMRSAqLztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuLl8gPSAyIC8qIERZTkFNSUMgKi87XHJcbiAgICAgICAgICAgICAgICAgICAgdm5vZGUucGF0Y2hGbGFnIHw9IDEwMjQgLyogRFlOQU1JQ19TTE9UUyAqLztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGlzRnVuY3Rpb24oY2hpbGRyZW4pKSB7XHJcbiAgICAgICAgY2hpbGRyZW4gPSB7IGRlZmF1bHQ6IGNoaWxkcmVuLCBfY3R4OiBjdXJyZW50UmVuZGVyaW5nSW5zdGFuY2UgfTtcclxuICAgICAgICB0eXBlID0gMzIgLyogU0xPVFNfQ0hJTERSRU4gKi87XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBjaGlsZHJlbiA9IFN0cmluZyhjaGlsZHJlbik7XHJcbiAgICAgICAgLy8gZm9yY2UgdGVsZXBvcnQgY2hpbGRyZW4gdG8gYXJyYXkgc28gaXQgY2FuIGJlIG1vdmVkIGFyb3VuZFxyXG4gICAgICAgIGlmIChzaGFwZUZsYWcgJiA2NCAvKiBURUxFUE9SVCAqLykge1xyXG4gICAgICAgICAgICB0eXBlID0gMTYgLyogQVJSQVlfQ0hJTERSRU4gKi87XHJcbiAgICAgICAgICAgIGNoaWxkcmVuID0gW2NyZWF0ZVRleHRWTm9kZShjaGlsZHJlbildO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdHlwZSA9IDggLyogVEVYVF9DSElMRFJFTiAqLztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICB2bm9kZS5jaGlsZHJlbiA9IGNoaWxkcmVuO1xyXG4gICAgdm5vZGUuc2hhcGVGbGFnIHw9IHR5cGU7XHJcbn1cclxuZnVuY3Rpb24gbWVyZ2VQcm9wcyguLi5hcmdzKSB7XHJcbiAgICBjb25zdCByZXQgPSB7fTtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXJncy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGNvbnN0IHRvTWVyZ2UgPSBhcmdzW2ldO1xyXG4gICAgICAgIGZvciAoY29uc3Qga2V5IGluIHRvTWVyZ2UpIHtcclxuICAgICAgICAgICAgaWYgKGtleSA9PT0gJ2NsYXNzJykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJldC5jbGFzcyAhPT0gdG9NZXJnZS5jbGFzcykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldC5jbGFzcyA9IG5vcm1hbGl6ZUNsYXNzKFtyZXQuY2xhc3MsIHRvTWVyZ2UuY2xhc3NdKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChrZXkgPT09ICdzdHlsZScpIHtcclxuICAgICAgICAgICAgICAgIHJldC5zdHlsZSA9IG5vcm1hbGl6ZVN0eWxlKFtyZXQuc3R5bGUsIHRvTWVyZ2Uuc3R5bGVdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChpc09uKGtleSkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nID0gcmV0W2tleV07XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpbmNvbWluZyA9IHRvTWVyZ2Vba2V5XTtcclxuICAgICAgICAgICAgICAgIGlmIChpbmNvbWluZyAmJlxyXG4gICAgICAgICAgICAgICAgICAgIGV4aXN0aW5nICE9PSBpbmNvbWluZyAmJlxyXG4gICAgICAgICAgICAgICAgICAgICEoaXNBcnJheShleGlzdGluZykgJiYgZXhpc3RpbmcuaW5jbHVkZXMoaW5jb21pbmcpKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldFtrZXldID0gZXhpc3RpbmdcclxuICAgICAgICAgICAgICAgICAgICAgICAgPyBbXS5jb25jYXQoZXhpc3RpbmcsIGluY29taW5nKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA6IGluY29taW5nO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGtleSAhPT0gJycpIHtcclxuICAgICAgICAgICAgICAgIHJldFtrZXldID0gdG9NZXJnZVtrZXldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJldDtcclxufVxyXG5mdW5jdGlvbiBpbnZva2VWTm9kZUhvb2soaG9vaywgaW5zdGFuY2UsIHZub2RlLCBwcmV2Vk5vZGUgPSBudWxsKSB7XHJcbiAgICBjYWxsV2l0aEFzeW5jRXJyb3JIYW5kbGluZyhob29rLCBpbnN0YW5jZSwgNyAvKiBWTk9ERV9IT09LICovLCBbXHJcbiAgICAgICAgdm5vZGUsXHJcbiAgICAgICAgcHJldlZOb2RlXHJcbiAgICBdKTtcclxufVxuXG4vKipcclxuICogQWN0dWFsIGltcGxlbWVudGF0aW9uXHJcbiAqL1xyXG5mdW5jdGlvbiByZW5kZXJMaXN0KHNvdXJjZSwgcmVuZGVySXRlbSwgY2FjaGUsIGluZGV4KSB7XHJcbiAgICBsZXQgcmV0O1xyXG4gICAgY29uc3QgY2FjaGVkID0gKGNhY2hlICYmIGNhY2hlW2luZGV4XSk7XHJcbiAgICBpZiAoaXNBcnJheShzb3VyY2UpIHx8IGlzU3RyaW5nKHNvdXJjZSkpIHtcclxuICAgICAgICByZXQgPSBuZXcgQXJyYXkoc291cmNlLmxlbmd0aCk7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSBzb3VyY2UubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHJldFtpXSA9IHJlbmRlckl0ZW0oc291cmNlW2ldLCBpLCB1bmRlZmluZWQsIGNhY2hlZCAmJiBjYWNoZWRbaV0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2UgaWYgKHR5cGVvZiBzb3VyY2UgPT09ICdudW1iZXInKSB7XHJcbiAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiAhTnVtYmVyLmlzSW50ZWdlcihzb3VyY2UpKSB7XHJcbiAgICAgICAgICAgIHdhcm4oYFRoZSB2LWZvciByYW5nZSBleHBlY3QgYW4gaW50ZWdlciB2YWx1ZSBidXQgZ290ICR7c291cmNlfS5gKTtcclxuICAgICAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXQgPSBuZXcgQXJyYXkoc291cmNlKTtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNvdXJjZTsgaSsrKSB7XHJcbiAgICAgICAgICAgIHJldFtpXSA9IHJlbmRlckl0ZW0oaSArIDEsIGksIHVuZGVmaW5lZCwgY2FjaGVkICYmIGNhY2hlZFtpXSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoaXNPYmplY3Qoc291cmNlKSkge1xyXG4gICAgICAgIGlmIChzb3VyY2VbU3ltYm9sLml0ZXJhdG9yXSkge1xyXG4gICAgICAgICAgICByZXQgPSBBcnJheS5mcm9tKHNvdXJjZSwgKGl0ZW0sIGkpID0+IHJlbmRlckl0ZW0oaXRlbSwgaSwgdW5kZWZpbmVkLCBjYWNoZWQgJiYgY2FjaGVkW2ldKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXMoc291cmNlKTtcclxuICAgICAgICAgICAgcmV0ID0gbmV3IEFycmF5KGtleXMubGVuZ3RoKTtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSBrZXlzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qga2V5ID0ga2V5c1tpXTtcclxuICAgICAgICAgICAgICAgIHJldFtpXSA9IHJlbmRlckl0ZW0oc291cmNlW2tleV0sIGtleSwgaSwgY2FjaGVkICYmIGNhY2hlZFtpXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICByZXQgPSBbXTtcclxuICAgIH1cclxuICAgIGlmIChjYWNoZSkge1xyXG4gICAgICAgIGNhY2hlW2luZGV4XSA9IHJldDtcclxuICAgIH1cclxuICAgIHJldHVybiByZXQ7XHJcbn1cblxuLyoqXHJcbiAqIENvbXBpbGVyIHJ1bnRpbWUgaGVscGVyIGZvciBjcmVhdGluZyBkeW5hbWljIHNsb3RzIG9iamVjdFxyXG4gKiBAcHJpdmF0ZVxyXG4gKi9cclxuZnVuY3Rpb24gY3JlYXRlU2xvdHMoc2xvdHMsIGR5bmFtaWNTbG90cykge1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkeW5hbWljU2xvdHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBjb25zdCBzbG90ID0gZHluYW1pY1Nsb3RzW2ldO1xyXG4gICAgICAgIC8vIGFycmF5IG9mIGR5bmFtaWMgc2xvdCBnZW5lcmF0ZWQgYnkgPHRlbXBsYXRlIHYtZm9yPVwiLi4uXCIgI1suLi5dPlxyXG4gICAgICAgIGlmIChpc0FycmF5KHNsb3QpKSB7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgc2xvdC5sZW5ndGg7IGorKykge1xyXG4gICAgICAgICAgICAgICAgc2xvdHNbc2xvdFtqXS5uYW1lXSA9IHNsb3Rbal0uZm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoc2xvdCkge1xyXG4gICAgICAgICAgICAvLyBjb25kaXRpb25hbCBzaW5nbGUgc2xvdCBnZW5lcmF0ZWQgYnkgPHRlbXBsYXRlIHYtaWY9XCIuLi5cIiAjZm9vPlxyXG4gICAgICAgICAgICBzbG90c1tzbG90Lm5hbWVdID0gc2xvdC5mbjtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gc2xvdHM7XHJcbn1cblxuLyoqXHJcbiAqIENvbXBpbGVyIHJ1bnRpbWUgaGVscGVyIGZvciByZW5kZXJpbmcgYDxzbG90Lz5gXHJcbiAqIEBwcml2YXRlXHJcbiAqL1xyXG5mdW5jdGlvbiByZW5kZXJTbG90KHNsb3RzLCBuYW1lLCBwcm9wcyA9IHt9LCBcclxuLy8gdGhpcyBpcyBub3QgYSB1c2VyLWZhY2luZyBmdW5jdGlvbiwgc28gdGhlIGZhbGxiYWNrIGlzIGFsd2F5cyBnZW5lcmF0ZWQgYnlcclxuLy8gdGhlIGNvbXBpbGVyIGFuZCBndWFyYW50ZWVkIHRvIGJlIGEgZnVuY3Rpb24gcmV0dXJuaW5nIGFuIGFycmF5XHJcbmZhbGxiYWNrLCBub1Nsb3R0ZWQpIHtcclxuICAgIGlmIChjdXJyZW50UmVuZGVyaW5nSW5zdGFuY2UuaXNDRSkge1xyXG4gICAgICAgIHJldHVybiBjcmVhdGVWTm9kZSgnc2xvdCcsIG5hbWUgPT09ICdkZWZhdWx0JyA/IG51bGwgOiB7IG5hbWUgfSwgZmFsbGJhY2sgJiYgZmFsbGJhY2soKSk7XHJcbiAgICB9XHJcbiAgICBsZXQgc2xvdCA9IHNsb3RzW25hbWVdO1xyXG4gICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiBzbG90ICYmIHNsb3QubGVuZ3RoID4gMSkge1xyXG4gICAgICAgIHdhcm4oYFNTUi1vcHRpbWl6ZWQgc2xvdCBmdW5jdGlvbiBkZXRlY3RlZCBpbiBhIG5vbi1TU1Itb3B0aW1pemVkIHJlbmRlciBgICtcclxuICAgICAgICAgICAgYGZ1bmN0aW9uLiBZb3UgbmVlZCB0byBtYXJrIHRoaXMgY29tcG9uZW50IHdpdGggJGR5bmFtaWMtc2xvdHMgaW4gdGhlIGAgK1xyXG4gICAgICAgICAgICBgcGFyZW50IHRlbXBsYXRlLmApO1xyXG4gICAgICAgIHNsb3QgPSAoKSA9PiBbXTtcclxuICAgIH1cclxuICAgIC8vIGEgY29tcGlsZWQgc2xvdCBkaXNhYmxlcyBibG9jayB0cmFja2luZyBieSBkZWZhdWx0IHRvIGF2b2lkIG1hbnVhbFxyXG4gICAgLy8gaW52b2NhdGlvbiBpbnRlcmZlcmluZyB3aXRoIHRlbXBsYXRlLWJhc2VkIGJsb2NrIHRyYWNraW5nLCBidXQgaW5cclxuICAgIC8vIGByZW5kZXJTbG90YCB3ZSBjYW4gYmUgc3VyZSB0aGF0IGl0J3MgdGVtcGxhdGUtYmFzZWQgc28gd2UgY2FuIGZvcmNlXHJcbiAgICAvLyBlbmFibGUgaXQuXHJcbiAgICBpZiAoc2xvdCAmJiBzbG90Ll9jKSB7XHJcbiAgICAgICAgc2xvdC5fZCA9IGZhbHNlO1xyXG4gICAgfVxyXG4gICAgb3BlbkJsb2NrKCk7XHJcbiAgICBjb25zdCB2YWxpZFNsb3RDb250ZW50ID0gc2xvdCAmJiBlbnN1cmVWYWxpZFZOb2RlKHNsb3QocHJvcHMpKTtcclxuICAgIGNvbnN0IHJlbmRlcmVkID0gY3JlYXRlQmxvY2soRnJhZ21lbnQsIHsga2V5OiBwcm9wcy5rZXkgfHwgYF8ke25hbWV9YCB9LCB2YWxpZFNsb3RDb250ZW50IHx8IChmYWxsYmFjayA/IGZhbGxiYWNrKCkgOiBbXSksIHZhbGlkU2xvdENvbnRlbnQgJiYgc2xvdHMuXyA9PT0gMSAvKiBTVEFCTEUgKi9cclxuICAgICAgICA/IDY0IC8qIFNUQUJMRV9GUkFHTUVOVCAqL1xyXG4gICAgICAgIDogLTIgLyogQkFJTCAqLyk7XHJcbiAgICBpZiAoIW5vU2xvdHRlZCAmJiByZW5kZXJlZC5zY29wZUlkKSB7XHJcbiAgICAgICAgcmVuZGVyZWQuc2xvdFNjb3BlSWRzID0gW3JlbmRlcmVkLnNjb3BlSWQgKyAnLXMnXTtcclxuICAgIH1cclxuICAgIGlmIChzbG90ICYmIHNsb3QuX2MpIHtcclxuICAgICAgICBzbG90Ll9kID0gdHJ1ZTtcclxuICAgIH1cclxuICAgIHJldHVybiByZW5kZXJlZDtcclxufVxyXG5mdW5jdGlvbiBlbnN1cmVWYWxpZFZOb2RlKHZub2Rlcykge1xyXG4gICAgcmV0dXJuIHZub2Rlcy5zb21lKGNoaWxkID0+IHtcclxuICAgICAgICBpZiAoIWlzVk5vZGUoY2hpbGQpKVxyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICBpZiAoY2hpbGQudHlwZSA9PT0gQ29tbWVudClcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIGlmIChjaGlsZC50eXBlID09PSBGcmFnbWVudCAmJlxyXG4gICAgICAgICAgICAhZW5zdXJlVmFsaWRWTm9kZShjaGlsZC5jaGlsZHJlbikpXHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH0pXHJcbiAgICAgICAgPyB2bm9kZXNcclxuICAgICAgICA6IG51bGw7XHJcbn1cblxuLyoqXHJcbiAqIEZvciBwcmVmaXhpbmcga2V5cyBpbiB2LW9uPVwib2JqXCIgd2l0aCBcIm9uXCJcclxuICogQHByaXZhdGVcclxuICovXHJcbmZ1bmN0aW9uIHRvSGFuZGxlcnMob2JqKSB7XHJcbiAgICBjb25zdCByZXQgPSB7fTtcclxuICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiYgIWlzT2JqZWN0KG9iaikpIHtcclxuICAgICAgICB3YXJuKGB2LW9uIHdpdGggbm8gYXJndW1lbnQgZXhwZWN0cyBhbiBvYmplY3QgdmFsdWUuYCk7XHJcbiAgICAgICAgcmV0dXJuIHJldDtcclxuICAgIH1cclxuICAgIGZvciAoY29uc3Qga2V5IGluIG9iaikge1xyXG4gICAgICAgIHJldFt0b0hhbmRsZXJLZXkoa2V5KV0gPSBvYmpba2V5XTtcclxuICAgIH1cclxuICAgIHJldHVybiByZXQ7XHJcbn1cblxuLyoqXHJcbiAqICMyNDM3IEluIFZ1ZSAzLCBmdW5jdGlvbmFsIGNvbXBvbmVudHMgZG8gbm90IGhhdmUgYSBwdWJsaWMgaW5zdGFuY2UgcHJveHkgYnV0XHJcbiAqIHRoZXkgZXhpc3QgaW4gdGhlIGludGVybmFsIHBhcmVudCBjaGFpbi4gRm9yIGNvZGUgdGhhdCByZWxpZXMgb24gdHJhdmVyc2luZ1xyXG4gKiBwdWJsaWMgJHBhcmVudCBjaGFpbnMsIHNraXAgZnVuY3Rpb25hbCBvbmVzIGFuZCBnbyB0byB0aGUgcGFyZW50IGluc3RlYWQuXHJcbiAqL1xyXG5jb25zdCBnZXRQdWJsaWNJbnN0YW5jZSA9IChpKSA9PiB7XHJcbiAgICBpZiAoIWkpXHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICBpZiAoaXNTdGF0ZWZ1bENvbXBvbmVudChpKSlcclxuICAgICAgICByZXR1cm4gZ2V0RXhwb3NlUHJveHkoaSkgfHwgaS5wcm94eTtcclxuICAgIHJldHVybiBnZXRQdWJsaWNJbnN0YW5jZShpLnBhcmVudCk7XHJcbn07XHJcbmNvbnN0IHB1YmxpY1Byb3BlcnRpZXNNYXAgPSBleHRlbmQoT2JqZWN0LmNyZWF0ZShudWxsKSwge1xyXG4gICAgJDogaSA9PiBpLFxyXG4gICAgJGVsOiBpID0+IGkudm5vZGUuZWwsXHJcbiAgICAkZGF0YTogaSA9PiBpLmRhdGEsXHJcbiAgICAkcHJvcHM6IGkgPT4gKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSA/IHNoYWxsb3dSZWFkb25seShpLnByb3BzKSA6IGkucHJvcHMpLFxyXG4gICAgJGF0dHJzOiBpID0+ICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgPyBzaGFsbG93UmVhZG9ubHkoaS5hdHRycykgOiBpLmF0dHJzKSxcclxuICAgICRzbG90czogaSA9PiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpID8gc2hhbGxvd1JlYWRvbmx5KGkuc2xvdHMpIDogaS5zbG90cyksXHJcbiAgICAkcmVmczogaSA9PiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpID8gc2hhbGxvd1JlYWRvbmx5KGkucmVmcykgOiBpLnJlZnMpLFxyXG4gICAgJHBhcmVudDogaSA9PiBnZXRQdWJsaWNJbnN0YW5jZShpLnBhcmVudCksXHJcbiAgICAkcm9vdDogaSA9PiBnZXRQdWJsaWNJbnN0YW5jZShpLnJvb3QpLFxyXG4gICAgJGVtaXQ6IGkgPT4gaS5lbWl0LFxyXG4gICAgJG9wdGlvbnM6IGkgPT4gKF9fVlVFX09QVElPTlNfQVBJX18gPyByZXNvbHZlTWVyZ2VkT3B0aW9ucyhpKSA6IGkudHlwZSksXHJcbiAgICAkZm9yY2VVcGRhdGU6IGkgPT4gKCkgPT4gcXVldWVKb2IoaS51cGRhdGUpLFxyXG4gICAgJG5leHRUaWNrOiBpID0+IG5leHRUaWNrLmJpbmQoaS5wcm94eSksXHJcbiAgICAkd2F0Y2g6IGkgPT4gKF9fVlVFX09QVElPTlNfQVBJX18gPyBpbnN0YW5jZVdhdGNoLmJpbmQoaSkgOiBOT09QKVxyXG59KTtcclxuY29uc3QgUHVibGljSW5zdGFuY2VQcm94eUhhbmRsZXJzID0ge1xyXG4gICAgZ2V0KHsgXzogaW5zdGFuY2UgfSwga2V5KSB7XHJcbiAgICAgICAgY29uc3QgeyBjdHgsIHNldHVwU3RhdGUsIGRhdGEsIHByb3BzLCBhY2Nlc3NDYWNoZSwgdHlwZSwgYXBwQ29udGV4dCB9ID0gaW5zdGFuY2U7XHJcbiAgICAgICAgLy8gZm9yIGludGVybmFsIGZvcm1hdHRlcnMgdG8ga25vdyB0aGF0IHRoaXMgaXMgYSBWdWUgaW5zdGFuY2VcclxuICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmIGtleSA9PT0gJ19faXNWdWUnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBwcmlvcml0aXplIDxzY3JpcHQgc2V0dXA+IGJpbmRpbmdzIGR1cmluZyBkZXYuXHJcbiAgICAgICAgLy8gdGhpcyBhbGxvd3MgZXZlbiBwcm9wZXJ0aWVzIHRoYXQgc3RhcnQgd2l0aCBfIG9yICQgdG8gYmUgdXNlZCAtIHNvIHRoYXRcclxuICAgICAgICAvLyBpdCBhbGlnbnMgd2l0aCB0aGUgcHJvZHVjdGlvbiBiZWhhdmlvciB3aGVyZSB0aGUgcmVuZGVyIGZuIGlzIGlubGluZWQgYW5kXHJcbiAgICAgICAgLy8gaW5kZWVkIGhhcyBhY2Nlc3MgdG8gYWxsIGRlY2xhcmVkIHZhcmlhYmxlcy5cclxuICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmXHJcbiAgICAgICAgICAgIHNldHVwU3RhdGUgIT09IEVNUFRZX09CSiAmJlxyXG4gICAgICAgICAgICBzZXR1cFN0YXRlLl9faXNTY3JpcHRTZXR1cCAmJlxyXG4gICAgICAgICAgICBoYXNPd24oc2V0dXBTdGF0ZSwga2V5KSkge1xyXG4gICAgICAgICAgICByZXR1cm4gc2V0dXBTdGF0ZVtrZXldO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBkYXRhIC8gcHJvcHMgLyBjdHhcclxuICAgICAgICAvLyBUaGlzIGdldHRlciBnZXRzIGNhbGxlZCBmb3IgZXZlcnkgcHJvcGVydHkgYWNjZXNzIG9uIHRoZSByZW5kZXIgY29udGV4dFxyXG4gICAgICAgIC8vIGR1cmluZyByZW5kZXIgYW5kIGlzIGEgbWFqb3IgaG90c3BvdC4gVGhlIG1vc3QgZXhwZW5zaXZlIHBhcnQgb2YgdGhpc1xyXG4gICAgICAgIC8vIGlzIHRoZSBtdWx0aXBsZSBoYXNPd24oKSBjYWxscy4gSXQncyBtdWNoIGZhc3RlciB0byBkbyBhIHNpbXBsZSBwcm9wZXJ0eVxyXG4gICAgICAgIC8vIGFjY2VzcyBvbiBhIHBsYWluIG9iamVjdCwgc28gd2UgdXNlIGFuIGFjY2Vzc0NhY2hlIG9iamVjdCAod2l0aCBudWxsXHJcbiAgICAgICAgLy8gcHJvdG90eXBlKSB0byBtZW1vaXplIHdoYXQgYWNjZXNzIHR5cGUgYSBrZXkgY29ycmVzcG9uZHMgdG8uXHJcbiAgICAgICAgbGV0IG5vcm1hbGl6ZWRQcm9wcztcclxuICAgICAgICBpZiAoa2V5WzBdICE9PSAnJCcpIHtcclxuICAgICAgICAgICAgY29uc3QgbiA9IGFjY2Vzc0NhY2hlW2tleV07XHJcbiAgICAgICAgICAgIGlmIChuICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAobikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMSAvKiBTRVRVUCAqLzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNldHVwU3RhdGVba2V5XTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDIgLyogREFUQSAqLzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGFba2V5XTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDQgLyogQ09OVEVYVCAqLzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGN0eFtrZXldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMyAvKiBQUk9QUyAqLzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHByb3BzW2tleV07XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gZGVmYXVsdDoganVzdCBmYWxsdGhyb3VnaFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHNldHVwU3RhdGUgIT09IEVNUFRZX09CSiAmJiBoYXNPd24oc2V0dXBTdGF0ZSwga2V5KSkge1xyXG4gICAgICAgICAgICAgICAgYWNjZXNzQ2FjaGVba2V5XSA9IDEgLyogU0VUVVAgKi87XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc2V0dXBTdGF0ZVtrZXldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGRhdGEgIT09IEVNUFRZX09CSiAmJiBoYXNPd24oZGF0YSwga2V5KSkge1xyXG4gICAgICAgICAgICAgICAgYWNjZXNzQ2FjaGVba2V5XSA9IDIgLyogREFUQSAqLztcclxuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhW2tleV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoXHJcbiAgICAgICAgICAgIC8vIG9ubHkgY2FjaGUgb3RoZXIgcHJvcGVydGllcyB3aGVuIGluc3RhbmNlIGhhcyBkZWNsYXJlZCAodGh1cyBzdGFibGUpXHJcbiAgICAgICAgICAgIC8vIHByb3BzXHJcbiAgICAgICAgICAgIChub3JtYWxpemVkUHJvcHMgPSBpbnN0YW5jZS5wcm9wc09wdGlvbnNbMF0pICYmXHJcbiAgICAgICAgICAgICAgICBoYXNPd24obm9ybWFsaXplZFByb3BzLCBrZXkpKSB7XHJcbiAgICAgICAgICAgICAgICBhY2Nlc3NDYWNoZVtrZXldID0gMyAvKiBQUk9QUyAqLztcclxuICAgICAgICAgICAgICAgIHJldHVybiBwcm9wc1trZXldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGN0eCAhPT0gRU1QVFlfT0JKICYmIGhhc093bihjdHgsIGtleSkpIHtcclxuICAgICAgICAgICAgICAgIGFjY2Vzc0NhY2hlW2tleV0gPSA0IC8qIENPTlRFWFQgKi87XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gY3R4W2tleV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoIV9fVlVFX09QVElPTlNfQVBJX18gfHwgc2hvdWxkQ2FjaGVBY2Nlc3MpIHtcclxuICAgICAgICAgICAgICAgIGFjY2Vzc0NhY2hlW2tleV0gPSAwIC8qIE9USEVSICovO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHB1YmxpY0dldHRlciA9IHB1YmxpY1Byb3BlcnRpZXNNYXBba2V5XTtcclxuICAgICAgICBsZXQgY3NzTW9kdWxlLCBnbG9iYWxQcm9wZXJ0aWVzO1xyXG4gICAgICAgIC8vIHB1YmxpYyAkeHh4IHByb3BlcnRpZXNcclxuICAgICAgICBpZiAocHVibGljR2V0dGVyKSB7XHJcbiAgICAgICAgICAgIGlmIChrZXkgPT09ICckYXR0cnMnKSB7XHJcbiAgICAgICAgICAgICAgICB0cmFjayhpbnN0YW5jZSwgXCJnZXRcIiAvKiBHRVQgKi8sIGtleSk7XHJcbiAgICAgICAgICAgICAgICAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiYgbWFya0F0dHJzQWNjZXNzZWQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gcHVibGljR2V0dGVyKGluc3RhbmNlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoXHJcbiAgICAgICAgLy8gY3NzIG1vZHVsZSAoaW5qZWN0ZWQgYnkgdnVlLWxvYWRlcilcclxuICAgICAgICAoY3NzTW9kdWxlID0gdHlwZS5fX2Nzc01vZHVsZXMpICYmXHJcbiAgICAgICAgICAgIChjc3NNb2R1bGUgPSBjc3NNb2R1bGVba2V5XSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGNzc01vZHVsZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoY3R4ICE9PSBFTVBUWV9PQkogJiYgaGFzT3duKGN0eCwga2V5KSkge1xyXG4gICAgICAgICAgICAvLyB1c2VyIG1heSBzZXQgY3VzdG9tIHByb3BlcnRpZXMgdG8gYHRoaXNgIHRoYXQgc3RhcnQgd2l0aCBgJGBcclxuICAgICAgICAgICAgYWNjZXNzQ2FjaGVba2V5XSA9IDQgLyogQ09OVEVYVCAqLztcclxuICAgICAgICAgICAgcmV0dXJuIGN0eFtrZXldO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChcclxuICAgICAgICAvLyBnbG9iYWwgcHJvcGVydGllc1xyXG4gICAgICAgICgoZ2xvYmFsUHJvcGVydGllcyA9IGFwcENvbnRleHQuY29uZmlnLmdsb2JhbFByb3BlcnRpZXMpLFxyXG4gICAgICAgICAgICBoYXNPd24oZ2xvYmFsUHJvcGVydGllcywga2V5KSkpIHtcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGdsb2JhbFByb3BlcnRpZXNba2V5XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiZcclxuICAgICAgICAgICAgY3VycmVudFJlbmRlcmluZ0luc3RhbmNlICYmXHJcbiAgICAgICAgICAgICghaXNTdHJpbmcoa2V5KSB8fFxyXG4gICAgICAgICAgICAgICAgLy8gIzEwOTEgYXZvaWQgaW50ZXJuYWwgaXNSZWYvaXNWTm9kZSBjaGVja3Mgb24gY29tcG9uZW50IGluc3RhbmNlIGxlYWRpbmdcclxuICAgICAgICAgICAgICAgIC8vIHRvIGluZmluaXRlIHdhcm5pbmcgbG9vcFxyXG4gICAgICAgICAgICAgICAga2V5LmluZGV4T2YoJ19fdicpICE9PSAwKSkge1xyXG4gICAgICAgICAgICBpZiAoZGF0YSAhPT0gRU1QVFlfT0JKICYmXHJcbiAgICAgICAgICAgICAgICAoa2V5WzBdID09PSAnJCcgfHwga2V5WzBdID09PSAnXycpICYmXHJcbiAgICAgICAgICAgICAgICBoYXNPd24oZGF0YSwga2V5KSkge1xyXG4gICAgICAgICAgICAgICAgd2FybihgUHJvcGVydHkgJHtKU09OLnN0cmluZ2lmeShrZXkpfSBtdXN0IGJlIGFjY2Vzc2VkIHZpYSAkZGF0YSBiZWNhdXNlIGl0IHN0YXJ0cyB3aXRoIGEgcmVzZXJ2ZWQgYCArXHJcbiAgICAgICAgICAgICAgICAgICAgYGNoYXJhY3RlciAoXCIkXCIgb3IgXCJfXCIpIGFuZCBpcyBub3QgcHJveGllZCBvbiB0aGUgcmVuZGVyIGNvbnRleHQuYCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoaW5zdGFuY2UgPT09IGN1cnJlbnRSZW5kZXJpbmdJbnN0YW5jZSkge1xyXG4gICAgICAgICAgICAgICAgd2FybihgUHJvcGVydHkgJHtKU09OLnN0cmluZ2lmeShrZXkpfSB3YXMgYWNjZXNzZWQgZHVyaW5nIHJlbmRlciBgICtcclxuICAgICAgICAgICAgICAgICAgICBgYnV0IGlzIG5vdCBkZWZpbmVkIG9uIGluc3RhbmNlLmApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIHNldCh7IF86IGluc3RhbmNlIH0sIGtleSwgdmFsdWUpIHtcclxuICAgICAgICBjb25zdCB7IGRhdGEsIHNldHVwU3RhdGUsIGN0eCB9ID0gaW5zdGFuY2U7XHJcbiAgICAgICAgaWYgKHNldHVwU3RhdGUgIT09IEVNUFRZX09CSiAmJiBoYXNPd24oc2V0dXBTdGF0ZSwga2V5KSkge1xyXG4gICAgICAgICAgICBzZXR1cFN0YXRlW2tleV0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGRhdGEgIT09IEVNUFRZX09CSiAmJiBoYXNPd24oZGF0YSwga2V5KSkge1xyXG4gICAgICAgICAgICBkYXRhW2tleV0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGhhc093bihpbnN0YW5jZS5wcm9wcywga2V5KSkge1xyXG4gICAgICAgICAgICAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiZcclxuICAgICAgICAgICAgICAgIHdhcm4oYEF0dGVtcHRpbmcgdG8gbXV0YXRlIHByb3AgXCIke2tleX1cIi4gUHJvcHMgYXJlIHJlYWRvbmx5LmAsIGluc3RhbmNlKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoa2V5WzBdID09PSAnJCcgJiYga2V5LnNsaWNlKDEpIGluIGluc3RhbmNlKSB7XHJcbiAgICAgICAgICAgIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJlxyXG4gICAgICAgICAgICAgICAgd2FybihgQXR0ZW1wdGluZyB0byBtdXRhdGUgcHVibGljIHByb3BlcnR5IFwiJHtrZXl9XCIuIGAgK1xyXG4gICAgICAgICAgICAgICAgICAgIGBQcm9wZXJ0aWVzIHN0YXJ0aW5nIHdpdGggJCBhcmUgcmVzZXJ2ZWQgYW5kIHJlYWRvbmx5LmAsIGluc3RhbmNlKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiBrZXkgaW4gaW5zdGFuY2UuYXBwQ29udGV4dC5jb25maWcuZ2xvYmFsUHJvcGVydGllcykge1xyXG4gICAgICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGN0eCwga2V5LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgdmFsdWVcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY3R4W2tleV0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH0sXHJcbiAgICBoYXMoeyBfOiB7IGRhdGEsIHNldHVwU3RhdGUsIGFjY2Vzc0NhY2hlLCBjdHgsIGFwcENvbnRleHQsIHByb3BzT3B0aW9ucyB9IH0sIGtleSkge1xyXG4gICAgICAgIGxldCBub3JtYWxpemVkUHJvcHM7XHJcbiAgICAgICAgcmV0dXJuICghIWFjY2Vzc0NhY2hlW2tleV0gfHxcclxuICAgICAgICAgICAgKGRhdGEgIT09IEVNUFRZX09CSiAmJiBoYXNPd24oZGF0YSwga2V5KSkgfHxcclxuICAgICAgICAgICAgKHNldHVwU3RhdGUgIT09IEVNUFRZX09CSiAmJiBoYXNPd24oc2V0dXBTdGF0ZSwga2V5KSkgfHxcclxuICAgICAgICAgICAgKChub3JtYWxpemVkUHJvcHMgPSBwcm9wc09wdGlvbnNbMF0pICYmIGhhc093bihub3JtYWxpemVkUHJvcHMsIGtleSkpIHx8XHJcbiAgICAgICAgICAgIGhhc093bihjdHgsIGtleSkgfHxcclxuICAgICAgICAgICAgaGFzT3duKHB1YmxpY1Byb3BlcnRpZXNNYXAsIGtleSkgfHxcclxuICAgICAgICAgICAgaGFzT3duKGFwcENvbnRleHQuY29uZmlnLmdsb2JhbFByb3BlcnRpZXMsIGtleSkpO1xyXG4gICAgfSxcclxuICAgIGRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBkZXNjcmlwdG9yKSB7XHJcbiAgICAgICAgaWYgKGRlc2NyaXB0b3IuZ2V0ICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5zZXQodGFyZ2V0LCBrZXksIGRlc2NyaXB0b3IuZ2V0KCksIG51bGwpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChkZXNjcmlwdG9yLnZhbHVlICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5zZXQodGFyZ2V0LCBrZXksIGRlc2NyaXB0b3IudmFsdWUsIG51bGwpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gUmVmbGVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgZGVzY3JpcHRvcik7XHJcbiAgICB9XHJcbn07XHJcbmlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiYgIWZhbHNlKSB7XHJcbiAgICBQdWJsaWNJbnN0YW5jZVByb3h5SGFuZGxlcnMub3duS2V5cyA9ICh0YXJnZXQpID0+IHtcclxuICAgICAgICB3YXJuKGBBdm9pZCBhcHAgbG9naWMgdGhhdCByZWxpZXMgb24gZW51bWVyYXRpbmcga2V5cyBvbiBhIGNvbXBvbmVudCBpbnN0YW5jZS4gYCArXHJcbiAgICAgICAgICAgIGBUaGUga2V5cyB3aWxsIGJlIGVtcHR5IGluIHByb2R1Y3Rpb24gbW9kZSB0byBhdm9pZCBwZXJmb3JtYW5jZSBvdmVyaGVhZC5gKTtcclxuICAgICAgICByZXR1cm4gUmVmbGVjdC5vd25LZXlzKHRhcmdldCk7XHJcbiAgICB9O1xyXG59XHJcbmNvbnN0IFJ1bnRpbWVDb21waWxlZFB1YmxpY0luc3RhbmNlUHJveHlIYW5kbGVycyA9IC8qI19fUFVSRV9fKi8gZXh0ZW5kKHt9LCBQdWJsaWNJbnN0YW5jZVByb3h5SGFuZGxlcnMsIHtcclxuICAgIGdldCh0YXJnZXQsIGtleSkge1xyXG4gICAgICAgIC8vIGZhc3QgcGF0aCBmb3IgdW5zY29wYWJsZXMgd2hlbiB1c2luZyBgd2l0aGAgYmxvY2tcclxuICAgICAgICBpZiAoa2V5ID09PSBTeW1ib2wudW5zY29wYWJsZXMpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gUHVibGljSW5zdGFuY2VQcm94eUhhbmRsZXJzLmdldCh0YXJnZXQsIGtleSwgdGFyZ2V0KTtcclxuICAgIH0sXHJcbiAgICBoYXMoXywga2V5KSB7XHJcbiAgICAgICAgY29uc3QgaGFzID0ga2V5WzBdICE9PSAnXycgJiYgIWlzR2xvYmFsbHlXaGl0ZWxpc3RlZChrZXkpO1xyXG4gICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiYgIWhhcyAmJiBQdWJsaWNJbnN0YW5jZVByb3h5SGFuZGxlcnMuaGFzKF8sIGtleSkpIHtcclxuICAgICAgICAgICAgd2FybihgUHJvcGVydHkgJHtKU09OLnN0cmluZ2lmeShrZXkpfSBzaG91bGQgbm90IHN0YXJ0IHdpdGggXyB3aGljaCBpcyBhIHJlc2VydmVkIHByZWZpeCBmb3IgVnVlIGludGVybmFscy5gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGhhcztcclxuICAgIH1cclxufSk7XHJcbi8vIGRldiBvbmx5XHJcbi8vIEluIGRldiBtb2RlLCB0aGUgcHJveHkgdGFyZ2V0IGV4cG9zZXMgdGhlIHNhbWUgcHJvcGVydGllcyBhcyBzZWVuIG9uIGB0aGlzYFxyXG4vLyBmb3IgZWFzaWVyIGNvbnNvbGUgaW5zcGVjdGlvbi4gSW4gcHJvZCBtb2RlIGl0IHdpbGwgYmUgYW4gZW1wdHkgb2JqZWN0IHNvXHJcbi8vIHRoZXNlIHByb3BlcnRpZXMgZGVmaW5pdGlvbnMgY2FuIGJlIHNraXBwZWQuXHJcbmZ1bmN0aW9uIGNyZWF0ZURldlJlbmRlckNvbnRleHQoaW5zdGFuY2UpIHtcclxuICAgIGNvbnN0IHRhcmdldCA9IHt9O1xyXG4gICAgLy8gZXhwb3NlIGludGVybmFsIGluc3RhbmNlIGZvciBwcm94eSBoYW5kbGVyc1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgYF9gLCB7XHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgICAgIGdldDogKCkgPT4gaW5zdGFuY2VcclxuICAgIH0pO1xyXG4gICAgLy8gZXhwb3NlIHB1YmxpYyBwcm9wZXJ0aWVzXHJcbiAgICBPYmplY3Qua2V5cyhwdWJsaWNQcm9wZXJ0aWVzTWFwKS5mb3JFYWNoKGtleSA9PiB7XHJcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCB7XHJcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICAgICAgICAgIGdldDogKCkgPT4gcHVibGljUHJvcGVydGllc01hcFtrZXldKGluc3RhbmNlKSxcclxuICAgICAgICAgICAgLy8gaW50ZXJjZXB0ZWQgYnkgdGhlIHByb3h5IHNvIG5vIG5lZWQgZm9yIGltcGxlbWVudGF0aW9uLFxyXG4gICAgICAgICAgICAvLyBidXQgbmVlZGVkIHRvIHByZXZlbnQgc2V0IGVycm9yc1xyXG4gICAgICAgICAgICBzZXQ6IE5PT1BcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHRhcmdldDtcclxufVxyXG4vLyBkZXYgb25seVxyXG5mdW5jdGlvbiBleHBvc2VQcm9wc09uUmVuZGVyQ29udGV4dChpbnN0YW5jZSkge1xyXG4gICAgY29uc3QgeyBjdHgsIHByb3BzT3B0aW9uczogW3Byb3BzT3B0aW9uc10gfSA9IGluc3RhbmNlO1xyXG4gICAgaWYgKHByb3BzT3B0aW9ucykge1xyXG4gICAgICAgIE9iamVjdC5rZXlzKHByb3BzT3B0aW9ucykuZm9yRWFjaChrZXkgPT4ge1xyXG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoY3R4LCBrZXksIHtcclxuICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBnZXQ6ICgpID0+IGluc3RhbmNlLnByb3BzW2tleV0sXHJcbiAgICAgICAgICAgICAgICBzZXQ6IE5PT1BcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuLy8gZGV2IG9ubHlcclxuZnVuY3Rpb24gZXhwb3NlU2V0dXBTdGF0ZU9uUmVuZGVyQ29udGV4dChpbnN0YW5jZSkge1xyXG4gICAgY29uc3QgeyBjdHgsIHNldHVwU3RhdGUgfSA9IGluc3RhbmNlO1xyXG4gICAgT2JqZWN0LmtleXModG9SYXcoc2V0dXBTdGF0ZSkpLmZvckVhY2goa2V5ID0+IHtcclxuICAgICAgICBpZiAoIXNldHVwU3RhdGUuX19pc1NjcmlwdFNldHVwKSB7XHJcbiAgICAgICAgICAgIGlmIChrZXlbMF0gPT09ICckJyB8fCBrZXlbMF0gPT09ICdfJykge1xyXG4gICAgICAgICAgICAgICAgd2Fybihgc2V0dXAoKSByZXR1cm4gcHJvcGVydHkgJHtKU09OLnN0cmluZ2lmeShrZXkpfSBzaG91bGQgbm90IHN0YXJ0IHdpdGggXCIkXCIgb3IgXCJfXCIgYCArXHJcbiAgICAgICAgICAgICAgICAgICAgYHdoaWNoIGFyZSByZXNlcnZlZCBwcmVmaXhlcyBmb3IgVnVlIGludGVybmFscy5gKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoY3R4LCBrZXksIHtcclxuICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBnZXQ6ICgpID0+IHNldHVwU3RhdGVba2V5XSxcclxuICAgICAgICAgICAgICAgIHNldDogTk9PUFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufVxuXG5jb25zdCBlbXB0eUFwcENvbnRleHQgPSBjcmVhdGVBcHBDb250ZXh0KCk7XHJcbmxldCB1aWQkMSA9IDA7XHJcbmZ1bmN0aW9uIGNyZWF0ZUNvbXBvbmVudEluc3RhbmNlKHZub2RlLCBwYXJlbnQsIHN1c3BlbnNlKSB7XHJcbiAgICBjb25zdCB0eXBlID0gdm5vZGUudHlwZTtcclxuICAgIC8vIGluaGVyaXQgcGFyZW50IGFwcCBjb250ZXh0IC0gb3IgLSBpZiByb290LCBhZG9wdCBmcm9tIHJvb3Qgdm5vZGVcclxuICAgIGNvbnN0IGFwcENvbnRleHQgPSAocGFyZW50ID8gcGFyZW50LmFwcENvbnRleHQgOiB2bm9kZS5hcHBDb250ZXh0KSB8fCBlbXB0eUFwcENvbnRleHQ7XHJcbiAgICBjb25zdCBpbnN0YW5jZSA9IHtcclxuICAgICAgICB1aWQ6IHVpZCQxKyssXHJcbiAgICAgICAgdm5vZGUsXHJcbiAgICAgICAgdHlwZSxcclxuICAgICAgICBwYXJlbnQsXHJcbiAgICAgICAgYXBwQ29udGV4dCxcclxuICAgICAgICByb290OiBudWxsLFxyXG4gICAgICAgIG5leHQ6IG51bGwsXHJcbiAgICAgICAgc3ViVHJlZTogbnVsbCxcclxuICAgICAgICBlZmZlY3Q6IG51bGwsXHJcbiAgICAgICAgdXBkYXRlOiBudWxsLFxyXG4gICAgICAgIHNjb3BlOiBuZXcgRWZmZWN0U2NvcGUodHJ1ZSAvKiBkZXRhY2hlZCAqLyksXHJcbiAgICAgICAgcmVuZGVyOiBudWxsLFxyXG4gICAgICAgIHByb3h5OiBudWxsLFxyXG4gICAgICAgIGV4cG9zZWQ6IG51bGwsXHJcbiAgICAgICAgZXhwb3NlUHJveHk6IG51bGwsXHJcbiAgICAgICAgd2l0aFByb3h5OiBudWxsLFxyXG4gICAgICAgIHByb3ZpZGVzOiBwYXJlbnQgPyBwYXJlbnQucHJvdmlkZXMgOiBPYmplY3QuY3JlYXRlKGFwcENvbnRleHQucHJvdmlkZXMpLFxyXG4gICAgICAgIGFjY2Vzc0NhY2hlOiBudWxsLFxyXG4gICAgICAgIHJlbmRlckNhY2hlOiBbXSxcclxuICAgICAgICAvLyBsb2NhbCByZXNvdmxlZCBhc3NldHNcclxuICAgICAgICBjb21wb25lbnRzOiBudWxsLFxyXG4gICAgICAgIGRpcmVjdGl2ZXM6IG51bGwsXHJcbiAgICAgICAgLy8gcmVzb2x2ZWQgcHJvcHMgYW5kIGVtaXRzIG9wdGlvbnNcclxuICAgICAgICBwcm9wc09wdGlvbnM6IG5vcm1hbGl6ZVByb3BzT3B0aW9ucyh0eXBlLCBhcHBDb250ZXh0KSxcclxuICAgICAgICBlbWl0c09wdGlvbnM6IG5vcm1hbGl6ZUVtaXRzT3B0aW9ucyh0eXBlLCBhcHBDb250ZXh0KSxcclxuICAgICAgICAvLyBlbWl0XHJcbiAgICAgICAgZW1pdDogbnVsbCxcclxuICAgICAgICBlbWl0dGVkOiBudWxsLFxyXG4gICAgICAgIC8vIHByb3BzIGRlZmF1bHQgdmFsdWVcclxuICAgICAgICBwcm9wc0RlZmF1bHRzOiBFTVBUWV9PQkosXHJcbiAgICAgICAgLy8gaW5oZXJpdEF0dHJzXHJcbiAgICAgICAgaW5oZXJpdEF0dHJzOiB0eXBlLmluaGVyaXRBdHRycyxcclxuICAgICAgICAvLyBzdGF0ZVxyXG4gICAgICAgIGN0eDogRU1QVFlfT0JKLFxyXG4gICAgICAgIGRhdGE6IEVNUFRZX09CSixcclxuICAgICAgICBwcm9wczogRU1QVFlfT0JKLFxyXG4gICAgICAgIGF0dHJzOiBFTVBUWV9PQkosXHJcbiAgICAgICAgc2xvdHM6IEVNUFRZX09CSixcclxuICAgICAgICByZWZzOiBFTVBUWV9PQkosXHJcbiAgICAgICAgc2V0dXBTdGF0ZTogRU1QVFlfT0JKLFxyXG4gICAgICAgIHNldHVwQ29udGV4dDogbnVsbCxcclxuICAgICAgICAvLyBzdXNwZW5zZSByZWxhdGVkXHJcbiAgICAgICAgc3VzcGVuc2UsXHJcbiAgICAgICAgc3VzcGVuc2VJZDogc3VzcGVuc2UgPyBzdXNwZW5zZS5wZW5kaW5nSWQgOiAwLFxyXG4gICAgICAgIGFzeW5jRGVwOiBudWxsLFxyXG4gICAgICAgIGFzeW5jUmVzb2x2ZWQ6IGZhbHNlLFxyXG4gICAgICAgIC8vIGxpZmVjeWNsZSBob29rc1xyXG4gICAgICAgIC8vIG5vdCB1c2luZyBlbnVtcyBoZXJlIGJlY2F1c2UgaXQgcmVzdWx0cyBpbiBjb21wdXRlZCBwcm9wZXJ0aWVzXHJcbiAgICAgICAgaXNNb3VudGVkOiBmYWxzZSxcclxuICAgICAgICBpc1VubW91bnRlZDogZmFsc2UsXHJcbiAgICAgICAgaXNEZWFjdGl2YXRlZDogZmFsc2UsXHJcbiAgICAgICAgYmM6IG51bGwsXHJcbiAgICAgICAgYzogbnVsbCxcclxuICAgICAgICBibTogbnVsbCxcclxuICAgICAgICBtOiBudWxsLFxyXG4gICAgICAgIGJ1OiBudWxsLFxyXG4gICAgICAgIHU6IG51bGwsXHJcbiAgICAgICAgdW06IG51bGwsXHJcbiAgICAgICAgYnVtOiBudWxsLFxyXG4gICAgICAgIGRhOiBudWxsLFxyXG4gICAgICAgIGE6IG51bGwsXHJcbiAgICAgICAgcnRnOiBudWxsLFxyXG4gICAgICAgIHJ0YzogbnVsbCxcclxuICAgICAgICBlYzogbnVsbCxcclxuICAgICAgICBzcDogbnVsbFxyXG4gICAgfTtcclxuICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICBpbnN0YW5jZS5jdHggPSBjcmVhdGVEZXZSZW5kZXJDb250ZXh0KGluc3RhbmNlKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIGluc3RhbmNlLmN0eCA9IHsgXzogaW5zdGFuY2UgfTtcclxuICAgIH1cclxuICAgIGluc3RhbmNlLnJvb3QgPSBwYXJlbnQgPyBwYXJlbnQucm9vdCA6IGluc3RhbmNlO1xyXG4gICAgaW5zdGFuY2UuZW1pdCA9IGVtaXQkMS5iaW5kKG51bGwsIGluc3RhbmNlKTtcclxuICAgIC8vIGFwcGx5IGN1c3RvbSBlbGVtZW50IHNwZWNpYWwgaGFuZGxpbmdcclxuICAgIGlmICh2bm9kZS5jZSkge1xyXG4gICAgICAgIHZub2RlLmNlKGluc3RhbmNlKTtcclxuICAgIH1cclxuICAgIHJldHVybiBpbnN0YW5jZTtcclxufVxyXG5sZXQgY3VycmVudEluc3RhbmNlID0gbnVsbDtcclxuY29uc3QgZ2V0Q3VycmVudEluc3RhbmNlID0gKCkgPT4gY3VycmVudEluc3RhbmNlIHx8IGN1cnJlbnRSZW5kZXJpbmdJbnN0YW5jZTtcclxuY29uc3Qgc2V0Q3VycmVudEluc3RhbmNlID0gKGluc3RhbmNlKSA9PiB7XHJcbiAgICBjdXJyZW50SW5zdGFuY2UgPSBpbnN0YW5jZTtcclxuICAgIGluc3RhbmNlLnNjb3BlLm9uKCk7XHJcbn07XHJcbmNvbnN0IHVuc2V0Q3VycmVudEluc3RhbmNlID0gKCkgPT4ge1xyXG4gICAgY3VycmVudEluc3RhbmNlICYmIGN1cnJlbnRJbnN0YW5jZS5zY29wZS5vZmYoKTtcclxuICAgIGN1cnJlbnRJbnN0YW5jZSA9IG51bGw7XHJcbn07XHJcbmNvbnN0IGlzQnVpbHRJblRhZyA9IC8qI19fUFVSRV9fKi8gbWFrZU1hcCgnc2xvdCxjb21wb25lbnQnKTtcclxuZnVuY3Rpb24gdmFsaWRhdGVDb21wb25lbnROYW1lKG5hbWUsIGNvbmZpZykge1xyXG4gICAgY29uc3QgYXBwSXNOYXRpdmVUYWcgPSBjb25maWcuaXNOYXRpdmVUYWcgfHwgTk87XHJcbiAgICBpZiAoaXNCdWlsdEluVGFnKG5hbWUpIHx8IGFwcElzTmF0aXZlVGFnKG5hbWUpKSB7XHJcbiAgICAgICAgd2FybignRG8gbm90IHVzZSBidWlsdC1pbiBvciByZXNlcnZlZCBIVE1MIGVsZW1lbnRzIGFzIGNvbXBvbmVudCBpZDogJyArIG5hbWUpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGlzU3RhdGVmdWxDb21wb25lbnQoaW5zdGFuY2UpIHtcclxuICAgIHJldHVybiBpbnN0YW5jZS52bm9kZS5zaGFwZUZsYWcgJiA0IC8qIFNUQVRFRlVMX0NPTVBPTkVOVCAqLztcclxufVxyXG5sZXQgaXNJblNTUkNvbXBvbmVudFNldHVwID0gZmFsc2U7XHJcbmZ1bmN0aW9uIHNldHVwQ29tcG9uZW50KGluc3RhbmNlLCBpc1NTUiA9IGZhbHNlKSB7XHJcbiAgICBpc0luU1NSQ29tcG9uZW50U2V0dXAgPSBpc1NTUjtcclxuICAgIGNvbnN0IHsgcHJvcHMsIGNoaWxkcmVuIH0gPSBpbnN0YW5jZS52bm9kZTtcclxuICAgIGNvbnN0IGlzU3RhdGVmdWwgPSBpc1N0YXRlZnVsQ29tcG9uZW50KGluc3RhbmNlKTtcclxuICAgIGluaXRQcm9wcyhpbnN0YW5jZSwgcHJvcHMsIGlzU3RhdGVmdWwsIGlzU1NSKTtcclxuICAgIGluaXRTbG90cyhpbnN0YW5jZSwgY2hpbGRyZW4pO1xyXG4gICAgY29uc3Qgc2V0dXBSZXN1bHQgPSBpc1N0YXRlZnVsXHJcbiAgICAgICAgPyBzZXR1cFN0YXRlZnVsQ29tcG9uZW50KGluc3RhbmNlLCBpc1NTUilcclxuICAgICAgICA6IHVuZGVmaW5lZDtcclxuICAgIGlzSW5TU1JDb21wb25lbnRTZXR1cCA9IGZhbHNlO1xyXG4gICAgcmV0dXJuIHNldHVwUmVzdWx0O1xyXG59XHJcbmZ1bmN0aW9uIHNldHVwU3RhdGVmdWxDb21wb25lbnQoaW5zdGFuY2UsIGlzU1NSKSB7XHJcbiAgICBjb25zdCBDb21wb25lbnQgPSBpbnN0YW5jZS50eXBlO1xyXG4gICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgIGlmIChDb21wb25lbnQubmFtZSkge1xyXG4gICAgICAgICAgICB2YWxpZGF0ZUNvbXBvbmVudE5hbWUoQ29tcG9uZW50Lm5hbWUsIGluc3RhbmNlLmFwcENvbnRleHQuY29uZmlnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKENvbXBvbmVudC5jb21wb25lbnRzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG5hbWVzID0gT2JqZWN0LmtleXMoQ29tcG9uZW50LmNvbXBvbmVudHMpO1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5hbWVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YWxpZGF0ZUNvbXBvbmVudE5hbWUobmFtZXNbaV0sIGluc3RhbmNlLmFwcENvbnRleHQuY29uZmlnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoQ29tcG9uZW50LmRpcmVjdGl2ZXMpIHtcclxuICAgICAgICAgICAgY29uc3QgbmFtZXMgPSBPYmplY3Qua2V5cyhDb21wb25lbnQuZGlyZWN0aXZlcyk7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbmFtZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHZhbGlkYXRlRGlyZWN0aXZlTmFtZShuYW1lc1tpXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKENvbXBvbmVudC5jb21waWxlck9wdGlvbnMgJiYgaXNSdW50aW1lT25seSgpKSB7XHJcbiAgICAgICAgICAgIHdhcm4oYFwiY29tcGlsZXJPcHRpb25zXCIgaXMgb25seSBzdXBwb3J0ZWQgd2hlbiB1c2luZyBhIGJ1aWxkIG9mIFZ1ZSB0aGF0IGAgK1xyXG4gICAgICAgICAgICAgICAgYGluY2x1ZGVzIHRoZSBydW50aW1lIGNvbXBpbGVyLiBTaW5jZSB5b3UgYXJlIHVzaW5nIGEgcnVudGltZS1vbmx5IGAgK1xyXG4gICAgICAgICAgICAgICAgYGJ1aWxkLCB0aGUgb3B0aW9ucyBzaG91bGQgYmUgcGFzc2VkIHZpYSB5b3VyIGJ1aWxkIHRvb2wgY29uZmlnIGluc3RlYWQuYCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8gMC4gY3JlYXRlIHJlbmRlciBwcm94eSBwcm9wZXJ0eSBhY2Nlc3MgY2FjaGVcclxuICAgIGluc3RhbmNlLmFjY2Vzc0NhY2hlID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcclxuICAgIC8vIDEuIGNyZWF0ZSBwdWJsaWMgaW5zdGFuY2UgLyByZW5kZXIgcHJveHlcclxuICAgIC8vIGFsc28gbWFyayBpdCByYXcgc28gaXQncyBuZXZlciBvYnNlcnZlZFxyXG4gICAgaW5zdGFuY2UucHJveHkgPSBtYXJrUmF3KG5ldyBQcm94eShpbnN0YW5jZS5jdHgsIFB1YmxpY0luc3RhbmNlUHJveHlIYW5kbGVycykpO1xyXG4gICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgIGV4cG9zZVByb3BzT25SZW5kZXJDb250ZXh0KGluc3RhbmNlKTtcclxuICAgIH1cclxuICAgIC8vIDIuIGNhbGwgc2V0dXAoKVxyXG4gICAgY29uc3QgeyBzZXR1cCB9ID0gQ29tcG9uZW50O1xyXG4gICAgaWYgKHNldHVwKSB7XHJcbiAgICAgICAgY29uc3Qgc2V0dXBDb250ZXh0ID0gKGluc3RhbmNlLnNldHVwQ29udGV4dCA9XHJcbiAgICAgICAgICAgIHNldHVwLmxlbmd0aCA+IDEgPyBjcmVhdGVTZXR1cENvbnRleHQoaW5zdGFuY2UpIDogbnVsbCk7XHJcbiAgICAgICAgc2V0Q3VycmVudEluc3RhbmNlKGluc3RhbmNlKTtcclxuICAgICAgICBwYXVzZVRyYWNraW5nKCk7XHJcbiAgICAgICAgY29uc3Qgc2V0dXBSZXN1bHQgPSBjYWxsV2l0aEVycm9ySGFuZGxpbmcoc2V0dXAsIGluc3RhbmNlLCAwIC8qIFNFVFVQX0ZVTkNUSU9OICovLCBbKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpID8gc2hhbGxvd1JlYWRvbmx5KGluc3RhbmNlLnByb3BzKSA6IGluc3RhbmNlLnByb3BzLCBzZXR1cENvbnRleHRdKTtcclxuICAgICAgICByZXNldFRyYWNraW5nKCk7XHJcbiAgICAgICAgdW5zZXRDdXJyZW50SW5zdGFuY2UoKTtcclxuICAgICAgICBpZiAoaXNQcm9taXNlKHNldHVwUmVzdWx0KSkge1xyXG4gICAgICAgICAgICBzZXR1cFJlc3VsdC50aGVuKHVuc2V0Q3VycmVudEluc3RhbmNlLCB1bnNldEN1cnJlbnRJbnN0YW5jZSk7XHJcbiAgICAgICAgICAgIGlmIChpc1NTUikge1xyXG4gICAgICAgICAgICAgICAgLy8gcmV0dXJuIHRoZSBwcm9taXNlIHNvIHNlcnZlci1yZW5kZXJlciBjYW4gd2FpdCBvbiBpdFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHNldHVwUmVzdWx0XHJcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oKHJlc29sdmVkUmVzdWx0KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlU2V0dXBSZXN1bHQoaW5zdGFuY2UsIHJlc29sdmVkUmVzdWx0LCBpc1NTUik7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5jYXRjaChlID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBoYW5kbGVFcnJvcihlLCBpbnN0YW5jZSwgMCAvKiBTRVRVUF9GVU5DVElPTiAqLyk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIGFzeW5jIHNldHVwIHJldHVybmVkIFByb21pc2UuXHJcbiAgICAgICAgICAgICAgICAvLyBiYWlsIGhlcmUgYW5kIHdhaXQgZm9yIHJlLWVudHJ5LlxyXG4gICAgICAgICAgICAgICAgaW5zdGFuY2UuYXN5bmNEZXAgPSBzZXR1cFJlc3VsdDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgaGFuZGxlU2V0dXBSZXN1bHQoaW5zdGFuY2UsIHNldHVwUmVzdWx0LCBpc1NTUik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgZmluaXNoQ29tcG9uZW50U2V0dXAoaW5zdGFuY2UsIGlzU1NSKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBoYW5kbGVTZXR1cFJlc3VsdChpbnN0YW5jZSwgc2V0dXBSZXN1bHQsIGlzU1NSKSB7XHJcbiAgICBpZiAoaXNGdW5jdGlvbihzZXR1cFJlc3VsdCkpIHtcclxuICAgICAgICAvLyBzZXR1cCByZXR1cm5lZCBhbiBpbmxpbmUgcmVuZGVyIGZ1bmN0aW9uXHJcbiAgICAgICAgaWYgKGluc3RhbmNlLnR5cGUuX19zc3JJbmxpbmVSZW5kZXIpIHtcclxuICAgICAgICAgICAgLy8gd2hlbiB0aGUgZnVuY3Rpb24ncyBuYW1lIGlzIGBzc3JSZW5kZXJgIChjb21waWxlZCBieSBTRkMgaW5saW5lIG1vZGUpLFxyXG4gICAgICAgICAgICAvLyBzZXQgaXQgYXMgc3NyUmVuZGVyIGluc3RlYWQuXHJcbiAgICAgICAgICAgIGluc3RhbmNlLnNzclJlbmRlciA9IHNldHVwUmVzdWx0O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgaW5zdGFuY2UucmVuZGVyID0gc2V0dXBSZXN1bHQ7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoaXNPYmplY3Qoc2V0dXBSZXN1bHQpKSB7XHJcbiAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiBpc1ZOb2RlKHNldHVwUmVzdWx0KSkge1xyXG4gICAgICAgICAgICB3YXJuKGBzZXR1cCgpIHNob3VsZCBub3QgcmV0dXJuIFZOb2RlcyBkaXJlY3RseSAtIGAgK1xyXG4gICAgICAgICAgICAgICAgYHJldHVybiBhIHJlbmRlciBmdW5jdGlvbiBpbnN0ZWFkLmApO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBzZXR1cCByZXR1cm5lZCBiaW5kaW5ncy5cclxuICAgICAgICAvLyBhc3N1bWluZyBhIHJlbmRlciBmdW5jdGlvbiBjb21waWxlZCBmcm9tIHRlbXBsYXRlIGlzIHByZXNlbnQuXHJcbiAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB8fCBfX1ZVRV9QUk9EX0RFVlRPT0xTX18pIHtcclxuICAgICAgICAgICAgaW5zdGFuY2UuZGV2dG9vbHNSYXdTZXR1cFN0YXRlID0gc2V0dXBSZXN1bHQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGluc3RhbmNlLnNldHVwU3RhdGUgPSBwcm94eVJlZnMoc2V0dXBSZXN1bHQpO1xyXG4gICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgZXhwb3NlU2V0dXBTdGF0ZU9uUmVuZGVyQ29udGV4dChpbnN0YW5jZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmIHNldHVwUmVzdWx0ICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICB3YXJuKGBzZXR1cCgpIHNob3VsZCByZXR1cm4gYW4gb2JqZWN0LiBSZWNlaXZlZDogJHtzZXR1cFJlc3VsdCA9PT0gbnVsbCA/ICdudWxsJyA6IHR5cGVvZiBzZXR1cFJlc3VsdH1gKTtcclxuICAgIH1cclxuICAgIGZpbmlzaENvbXBvbmVudFNldHVwKGluc3RhbmNlLCBpc1NTUik7XHJcbn1cclxubGV0IGNvbXBpbGU7XHJcbmxldCBpbnN0YWxsV2l0aFByb3h5O1xyXG4vKipcclxuICogRm9yIHJ1bnRpbWUtZG9tIHRvIHJlZ2lzdGVyIHRoZSBjb21waWxlci5cclxuICogTm90ZSB0aGUgZXhwb3J0ZWQgbWV0aG9kIHVzZXMgYW55IHRvIGF2b2lkIGQudHMgcmVseWluZyBvbiB0aGUgY29tcGlsZXIgdHlwZXMuXHJcbiAqL1xyXG5mdW5jdGlvbiByZWdpc3RlclJ1bnRpbWVDb21waWxlcihfY29tcGlsZSkge1xyXG4gICAgY29tcGlsZSA9IF9jb21waWxlO1xyXG4gICAgaW5zdGFsbFdpdGhQcm94eSA9IGkgPT4ge1xyXG4gICAgICAgIGlmIChpLnJlbmRlci5fcmMpIHtcclxuICAgICAgICAgICAgaS53aXRoUHJveHkgPSBuZXcgUHJveHkoaS5jdHgsIFJ1bnRpbWVDb21waWxlZFB1YmxpY0luc3RhbmNlUHJveHlIYW5kbGVycyk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufVxyXG4vLyBkZXYgb25seVxyXG5jb25zdCBpc1J1bnRpbWVPbmx5ID0gKCkgPT4gIWNvbXBpbGU7XHJcbmZ1bmN0aW9uIGZpbmlzaENvbXBvbmVudFNldHVwKGluc3RhbmNlLCBpc1NTUiwgc2tpcE9wdGlvbnMpIHtcclxuICAgIGNvbnN0IENvbXBvbmVudCA9IGluc3RhbmNlLnR5cGU7XHJcbiAgICAvLyB0ZW1wbGF0ZSAvIHJlbmRlciBmdW5jdGlvbiBub3JtYWxpemF0aW9uXHJcbiAgICAvLyBjb3VsZCBiZSBhbHJlYWR5IHNldCB3aGVuIHJldHVybmVkIGZyb20gc2V0dXAoKVxyXG4gICAgaWYgKCFpbnN0YW5jZS5yZW5kZXIpIHtcclxuICAgICAgICAvLyBvbmx5IGRvIG9uLXRoZS1mbHkgY29tcGlsZSBpZiBub3QgaW4gU1NSIC0gU1NSIG9uLXRoZS1mbHkgY29tcGlsYXRpb25cclxuICAgICAgICAvLyBpcyBkb25lIGJ5IHNlcnZlci1yZW5kZXJlclxyXG4gICAgICAgIGlmICghaXNTU1IgJiYgY29tcGlsZSAmJiAhQ29tcG9uZW50LnJlbmRlcikge1xyXG4gICAgICAgICAgICBjb25zdCB0ZW1wbGF0ZSA9IENvbXBvbmVudC50ZW1wbGF0ZTtcclxuICAgICAgICAgICAgaWYgKHRlbXBsYXRlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RhcnRNZWFzdXJlKGluc3RhbmNlLCBgY29tcGlsZWApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgeyBpc0N1c3RvbUVsZW1lbnQsIGNvbXBpbGVyT3B0aW9ucyB9ID0gaW5zdGFuY2UuYXBwQ29udGV4dC5jb25maWc7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB7IGRlbGltaXRlcnMsIGNvbXBpbGVyT3B0aW9uczogY29tcG9uZW50Q29tcGlsZXJPcHRpb25zIH0gPSBDb21wb25lbnQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBmaW5hbENvbXBpbGVyT3B0aW9ucyA9IGV4dGVuZChleHRlbmQoe1xyXG4gICAgICAgICAgICAgICAgICAgIGlzQ3VzdG9tRWxlbWVudCxcclxuICAgICAgICAgICAgICAgICAgICBkZWxpbWl0ZXJzXHJcbiAgICAgICAgICAgICAgICB9LCBjb21waWxlck9wdGlvbnMpLCBjb21wb25lbnRDb21waWxlck9wdGlvbnMpO1xyXG4gICAgICAgICAgICAgICAgQ29tcG9uZW50LnJlbmRlciA9IGNvbXBpbGUodGVtcGxhdGUsIGZpbmFsQ29tcGlsZXJPcHRpb25zKTtcclxuICAgICAgICAgICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgICAgICBlbmRNZWFzdXJlKGluc3RhbmNlLCBgY29tcGlsZWApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGluc3RhbmNlLnJlbmRlciA9IChDb21wb25lbnQucmVuZGVyIHx8IE5PT1ApO1xyXG4gICAgICAgIC8vIGZvciBydW50aW1lLWNvbXBpbGVkIHJlbmRlciBmdW5jdGlvbnMgdXNpbmcgYHdpdGhgIGJsb2NrcywgdGhlIHJlbmRlclxyXG4gICAgICAgIC8vIHByb3h5IHVzZWQgbmVlZHMgYSBkaWZmZXJlbnQgYGhhc2AgaGFuZGxlciB3aGljaCBpcyBtb3JlIHBlcmZvcm1hbnQgYW5kXHJcbiAgICAgICAgLy8gYWxzbyBvbmx5IGFsbG93cyBhIHdoaXRlbGlzdCBvZiBnbG9iYWxzIHRvIGZhbGx0aHJvdWdoLlxyXG4gICAgICAgIGlmIChpbnN0YWxsV2l0aFByb3h5KSB7XHJcbiAgICAgICAgICAgIGluc3RhbGxXaXRoUHJveHkoaW5zdGFuY2UpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8vIHN1cHBvcnQgZm9yIDIueCBvcHRpb25zXHJcbiAgICBpZiAoX19WVUVfT1BUSU9OU19BUElfXyAmJiAhKGZhbHNlICkpIHtcclxuICAgICAgICBzZXRDdXJyZW50SW5zdGFuY2UoaW5zdGFuY2UpO1xyXG4gICAgICAgIHBhdXNlVHJhY2tpbmcoKTtcclxuICAgICAgICBhcHBseU9wdGlvbnMoaW5zdGFuY2UpO1xyXG4gICAgICAgIHJlc2V0VHJhY2tpbmcoKTtcclxuICAgICAgICB1bnNldEN1cnJlbnRJbnN0YW5jZSgpO1xyXG4gICAgfVxyXG4gICAgLy8gd2FybiBtaXNzaW5nIHRlbXBsYXRlL3JlbmRlclxyXG4gICAgLy8gdGhlIHJ1bnRpbWUgY29tcGlsYXRpb24gb2YgdGVtcGxhdGUgaW4gU1NSIGlzIGRvbmUgYnkgc2VydmVyLXJlbmRlclxyXG4gICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiAhQ29tcG9uZW50LnJlbmRlciAmJiBpbnN0YW5jZS5yZW5kZXIgPT09IE5PT1AgJiYgIWlzU1NSKSB7XHJcbiAgICAgICAgLyogaXN0YW5idWwgaWdub3JlIGlmICovXHJcbiAgICAgICAgaWYgKCFjb21waWxlICYmIENvbXBvbmVudC50ZW1wbGF0ZSkge1xyXG4gICAgICAgICAgICB3YXJuKGBDb21wb25lbnQgcHJvdmlkZWQgdGVtcGxhdGUgb3B0aW9uIGJ1dCBgICtcclxuICAgICAgICAgICAgICAgIGBydW50aW1lIGNvbXBpbGF0aW9uIGlzIG5vdCBzdXBwb3J0ZWQgaW4gdGhpcyBidWlsZCBvZiBWdWUuYCArXHJcbiAgICAgICAgICAgICAgICAoYCBDb25maWd1cmUgeW91ciBidW5kbGVyIHRvIGFsaWFzIFwidnVlXCIgdG8gXCJ2dWUvZGlzdC92dWUuZXNtLWJ1bmRsZXIuanNcIi5gXHJcbiAgICAgICAgICAgICAgICAgICAgKSAvKiBzaG91bGQgbm90IGhhcHBlbiAqLyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB3YXJuKGBDb21wb25lbnQgaXMgbWlzc2luZyB0ZW1wbGF0ZSBvciByZW5kZXIgZnVuY3Rpb24uYCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGNyZWF0ZUF0dHJzUHJveHkoaW5zdGFuY2UpIHtcclxuICAgIHJldHVybiBuZXcgUHJveHkoaW5zdGFuY2UuYXR0cnMsIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKVxyXG4gICAgICAgID8ge1xyXG4gICAgICAgICAgICBnZXQodGFyZ2V0LCBrZXkpIHtcclxuICAgICAgICAgICAgICAgIG1hcmtBdHRyc0FjY2Vzc2VkKCk7XHJcbiAgICAgICAgICAgICAgICB0cmFjayhpbnN0YW5jZSwgXCJnZXRcIiAvKiBHRVQgKi8sICckYXR0cnMnKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXRba2V5XTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgc2V0KCkge1xyXG4gICAgICAgICAgICAgICAgd2Fybihgc2V0dXBDb250ZXh0LmF0dHJzIGlzIHJlYWRvbmx5LmApO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBkZWxldGVQcm9wZXJ0eSgpIHtcclxuICAgICAgICAgICAgICAgIHdhcm4oYHNldHVwQ29udGV4dC5hdHRycyBpcyByZWFkb25seS5gKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICA6IHtcclxuICAgICAgICAgICAgZ2V0KHRhcmdldCwga2V5KSB7XHJcbiAgICAgICAgICAgICAgICB0cmFjayhpbnN0YW5jZSwgXCJnZXRcIiAvKiBHRVQgKi8sICckYXR0cnMnKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXRba2V5XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG59XHJcbmZ1bmN0aW9uIGNyZWF0ZVNldHVwQ29udGV4dChpbnN0YW5jZSkge1xyXG4gICAgY29uc3QgZXhwb3NlID0gZXhwb3NlZCA9PiB7XHJcbiAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiBpbnN0YW5jZS5leHBvc2VkKSB7XHJcbiAgICAgICAgICAgIHdhcm4oYGV4cG9zZSgpIHNob3VsZCBiZSBjYWxsZWQgb25seSBvbmNlIHBlciBzZXR1cCgpLmApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpbnN0YW5jZS5leHBvc2VkID0gZXhwb3NlZCB8fCB7fTtcclxuICAgIH07XHJcbiAgICBsZXQgYXR0cnM7XHJcbiAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgLy8gV2UgdXNlIGdldHRlcnMgaW4gZGV2IGluIGNhc2UgbGlicyBsaWtlIHRlc3QtdXRpbHMgb3ZlcndyaXRlIGluc3RhbmNlXHJcbiAgICAgICAgLy8gcHJvcGVydGllcyAob3ZlcndyaXRlcyBzaG91bGQgbm90IGJlIGRvbmUgaW4gcHJvZClcclxuICAgICAgICByZXR1cm4gT2JqZWN0LmZyZWV6ZSh7XHJcbiAgICAgICAgICAgIGdldCBhdHRycygpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBhdHRycyB8fCAoYXR0cnMgPSBjcmVhdGVBdHRyc1Byb3h5KGluc3RhbmNlKSk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGdldCBzbG90cygpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBzaGFsbG93UmVhZG9ubHkoaW5zdGFuY2Uuc2xvdHMpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBnZXQgZW1pdCgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAoZXZlbnQsIC4uLmFyZ3MpID0+IGluc3RhbmNlLmVtaXQoZXZlbnQsIC4uLmFyZ3MpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBleHBvc2VcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGdldCBhdHRycygpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBhdHRycyB8fCAoYXR0cnMgPSBjcmVhdGVBdHRyc1Byb3h5KGluc3RhbmNlKSk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHNsb3RzOiBpbnN0YW5jZS5zbG90cyxcclxuICAgICAgICAgICAgZW1pdDogaW5zdGFuY2UuZW1pdCxcclxuICAgICAgICAgICAgZXhwb3NlXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBnZXRFeHBvc2VQcm94eShpbnN0YW5jZSkge1xyXG4gICAgaWYgKGluc3RhbmNlLmV4cG9zZWQpIHtcclxuICAgICAgICByZXR1cm4gKGluc3RhbmNlLmV4cG9zZVByb3h5IHx8XHJcbiAgICAgICAgICAgIChpbnN0YW5jZS5leHBvc2VQcm94eSA9IG5ldyBQcm94eShwcm94eVJlZnMobWFya1JhdyhpbnN0YW5jZS5leHBvc2VkKSksIHtcclxuICAgICAgICAgICAgICAgIGdldCh0YXJnZXQsIGtleSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChrZXkgaW4gdGFyZ2V0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXRba2V5XTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoa2V5IGluIHB1YmxpY1Byb3BlcnRpZXNNYXApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHB1YmxpY1Byb3BlcnRpZXNNYXBba2V5XShpbnN0YW5jZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KSkpO1xyXG4gICAgfVxyXG59XHJcbmNvbnN0IGNsYXNzaWZ5UkUgPSAvKD86XnxbLV9dKShcXHcpL2c7XHJcbmNvbnN0IGNsYXNzaWZ5ID0gKHN0cikgPT4gc3RyLnJlcGxhY2UoY2xhc3NpZnlSRSwgYyA9PiBjLnRvVXBwZXJDYXNlKCkpLnJlcGxhY2UoL1stX10vZywgJycpO1xyXG5mdW5jdGlvbiBnZXRDb21wb25lbnROYW1lKENvbXBvbmVudCkge1xyXG4gICAgcmV0dXJuIGlzRnVuY3Rpb24oQ29tcG9uZW50KVxyXG4gICAgICAgID8gQ29tcG9uZW50LmRpc3BsYXlOYW1lIHx8IENvbXBvbmVudC5uYW1lXHJcbiAgICAgICAgOiBDb21wb25lbnQubmFtZTtcclxufVxyXG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xyXG5mdW5jdGlvbiBmb3JtYXRDb21wb25lbnROYW1lKGluc3RhbmNlLCBDb21wb25lbnQsIGlzUm9vdCA9IGZhbHNlKSB7XHJcbiAgICBsZXQgbmFtZSA9IGdldENvbXBvbmVudE5hbWUoQ29tcG9uZW50KTtcclxuICAgIGlmICghbmFtZSAmJiBDb21wb25lbnQuX19maWxlKSB7XHJcbiAgICAgICAgY29uc3QgbWF0Y2ggPSBDb21wb25lbnQuX19maWxlLm1hdGNoKC8oW14vXFxcXF0rKVxcLlxcdyskLyk7XHJcbiAgICAgICAgaWYgKG1hdGNoKSB7XHJcbiAgICAgICAgICAgIG5hbWUgPSBtYXRjaFsxXTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAoIW5hbWUgJiYgaW5zdGFuY2UgJiYgaW5zdGFuY2UucGFyZW50KSB7XHJcbiAgICAgICAgLy8gdHJ5IHRvIGluZmVyIHRoZSBuYW1lIGJhc2VkIG9uIHJldmVyc2UgcmVzb2x1dGlvblxyXG4gICAgICAgIGNvbnN0IGluZmVyRnJvbVJlZ2lzdHJ5ID0gKHJlZ2lzdHJ5KSA9PiB7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IGluIHJlZ2lzdHJ5KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVnaXN0cnlba2V5XSA9PT0gQ29tcG9uZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGtleTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgbmFtZSA9XHJcbiAgICAgICAgICAgIGluZmVyRnJvbVJlZ2lzdHJ5KGluc3RhbmNlLmNvbXBvbmVudHMgfHxcclxuICAgICAgICAgICAgICAgIGluc3RhbmNlLnBhcmVudC50eXBlLmNvbXBvbmVudHMpIHx8IGluZmVyRnJvbVJlZ2lzdHJ5KGluc3RhbmNlLmFwcENvbnRleHQuY29tcG9uZW50cyk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbmFtZSA/IGNsYXNzaWZ5KG5hbWUpIDogaXNSb290ID8gYEFwcGAgOiBgQW5vbnltb3VzYDtcclxufVxyXG5mdW5jdGlvbiBpc0NsYXNzQ29tcG9uZW50KHZhbHVlKSB7XHJcbiAgICByZXR1cm4gaXNGdW5jdGlvbih2YWx1ZSkgJiYgJ19fdmNjT3B0cycgaW4gdmFsdWU7XHJcbn1cblxuY29uc3QgY29tcHV0ZWQgPSAoKGdldHRlck9yT3B0aW9ucywgZGVidWdPcHRpb25zKSA9PiB7XHJcbiAgICAvLyBAdHMtaWdub3JlXHJcbiAgICByZXR1cm4gY29tcHV0ZWQkMShnZXR0ZXJPck9wdGlvbnMsIGRlYnVnT3B0aW9ucywgaXNJblNTUkNvbXBvbmVudFNldHVwKTtcclxufSk7XG5cbi8vIGRldiBvbmx5XHJcbmNvbnN0IHdhcm5SdW50aW1lVXNhZ2UgPSAobWV0aG9kKSA9PiB3YXJuKGAke21ldGhvZH0oKSBpcyBhIGNvbXBpbGVyLWhpbnQgaGVscGVyIHRoYXQgaXMgb25seSB1c2FibGUgaW5zaWRlIGAgK1xyXG4gICAgYDxzY3JpcHQgc2V0dXA+IG9mIGEgc2luZ2xlIGZpbGUgY29tcG9uZW50LiBJdHMgYXJndW1lbnRzIHNob3VsZCBiZSBgICtcclxuICAgIGBjb21waWxlZCBhd2F5IGFuZCBwYXNzaW5nIGl0IGF0IHJ1bnRpbWUgaGFzIG5vIGVmZmVjdC5gKTtcclxuLy8gaW1wbGVtZW50YXRpb25cclxuZnVuY3Rpb24gZGVmaW5lUHJvcHMoKSB7XHJcbiAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgd2FyblJ1bnRpbWVVc2FnZShgZGVmaW5lUHJvcHNgKTtcclxuICAgIH1cclxuICAgIHJldHVybiBudWxsO1xyXG59XHJcbi8vIGltcGxlbWVudGF0aW9uXHJcbmZ1bmN0aW9uIGRlZmluZUVtaXRzKCkge1xyXG4gICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgIHdhcm5SdW50aW1lVXNhZ2UoYGRlZmluZUVtaXRzYCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbnVsbDtcclxufVxyXG4vKipcclxuICogVnVlIGA8c2NyaXB0IHNldHVwPmAgY29tcGlsZXIgbWFjcm8gZm9yIGRlY2xhcmluZyBhIGNvbXBvbmVudCdzIGV4cG9zZWRcclxuICogaW5zdGFuY2UgcHJvcGVydGllcyB3aGVuIGl0IGlzIGFjY2Vzc2VkIGJ5IGEgcGFyZW50IGNvbXBvbmVudCB2aWEgdGVtcGxhdGVcclxuICogcmVmcy5cclxuICpcclxuICogYDxzY3JpcHQgc2V0dXA+YCBjb21wb25lbnRzIGFyZSBjbG9zZWQgYnkgZGVmYXVsdCAtIGkuZS4gdmFyaWFibGVzIGluc2lkZVxyXG4gKiB0aGUgYDxzY3JpcHQgc2V0dXA+YCBzY29wZSBpcyBub3QgZXhwb3NlZCB0byBwYXJlbnQgdW5sZXNzIGV4cGxpY2l0bHkgZXhwb3NlZFxyXG4gKiB2aWEgYGRlZmluZUV4cG9zZWAuXHJcbiAqXHJcbiAqIFRoaXMgaXMgb25seSB1c2FibGUgaW5zaWRlIGA8c2NyaXB0IHNldHVwPmAsIGlzIGNvbXBpbGVkIGF3YXkgaW4gdGhlXHJcbiAqIG91dHB1dCBhbmQgc2hvdWxkICoqbm90KiogYmUgYWN0dWFsbHkgY2FsbGVkIGF0IHJ1bnRpbWUuXHJcbiAqL1xyXG5mdW5jdGlvbiBkZWZpbmVFeHBvc2UoZXhwb3NlZCkge1xyXG4gICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgIHdhcm5SdW50aW1lVXNhZ2UoYGRlZmluZUV4cG9zZWApO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBWdWUgYDxzY3JpcHQgc2V0dXA+YCBjb21waWxlciBtYWNybyBmb3IgcHJvdmlkaW5nIHByb3BzIGRlZmF1bHQgdmFsdWVzIHdoZW5cclxuICogdXNpbmcgdHlwZS1iYXNlZCBgZGVmaW5lUHJvcHNgIGRlY2xhcmF0aW9uLlxyXG4gKlxyXG4gKiBFeGFtcGxlIHVzYWdlOlxyXG4gKiBgYGB0c1xyXG4gKiB3aXRoRGVmYXVsdHMoZGVmaW5lUHJvcHM8e1xyXG4gKiAgIHNpemU/OiBudW1iZXJcclxuICogICBsYWJlbHM/OiBzdHJpbmdbXVxyXG4gKiB9PigpLCB7XHJcbiAqICAgc2l6ZTogMyxcclxuICogICBsYWJlbHM6ICgpID0+IFsnZGVmYXVsdCBsYWJlbCddXHJcbiAqIH0pXHJcbiAqIGBgYFxyXG4gKlxyXG4gKiBUaGlzIGlzIG9ubHkgdXNhYmxlIGluc2lkZSBgPHNjcmlwdCBzZXR1cD5gLCBpcyBjb21waWxlZCBhd2F5IGluIHRoZSBvdXRwdXRcclxuICogYW5kIHNob3VsZCAqKm5vdCoqIGJlIGFjdHVhbGx5IGNhbGxlZCBhdCBydW50aW1lLlxyXG4gKi9cclxuZnVuY3Rpb24gd2l0aERlZmF1bHRzKHByb3BzLCBkZWZhdWx0cykge1xyXG4gICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgIHdhcm5SdW50aW1lVXNhZ2UoYHdpdGhEZWZhdWx0c2ApO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG51bGw7XHJcbn1cclxuZnVuY3Rpb24gdXNlU2xvdHMoKSB7XHJcbiAgICByZXR1cm4gZ2V0Q29udGV4dCgpLnNsb3RzO1xyXG59XHJcbmZ1bmN0aW9uIHVzZUF0dHJzKCkge1xyXG4gICAgcmV0dXJuIGdldENvbnRleHQoKS5hdHRycztcclxufVxyXG5mdW5jdGlvbiBnZXRDb250ZXh0KCkge1xyXG4gICAgY29uc3QgaSA9IGdldEN1cnJlbnRJbnN0YW5jZSgpO1xyXG4gICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiAhaSkge1xyXG4gICAgICAgIHdhcm4oYHVzZUNvbnRleHQoKSBjYWxsZWQgd2l0aG91dCBhY3RpdmUgaW5zdGFuY2UuYCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gaS5zZXR1cENvbnRleHQgfHwgKGkuc2V0dXBDb250ZXh0ID0gY3JlYXRlU2V0dXBDb250ZXh0KGkpKTtcclxufVxyXG4vKipcclxuICogUnVudGltZSBoZWxwZXIgZm9yIG1lcmdpbmcgZGVmYXVsdCBkZWNsYXJhdGlvbnMuIEltcG9ydGVkIGJ5IGNvbXBpbGVkIGNvZGVcclxuICogb25seS5cclxuICogQGludGVybmFsXHJcbiAqL1xyXG5mdW5jdGlvbiBtZXJnZURlZmF1bHRzKHJhdywgZGVmYXVsdHMpIHtcclxuICAgIGNvbnN0IHByb3BzID0gaXNBcnJheShyYXcpXHJcbiAgICAgICAgPyByYXcucmVkdWNlKChub3JtYWxpemVkLCBwKSA9PiAoKG5vcm1hbGl6ZWRbcF0gPSB7fSksIG5vcm1hbGl6ZWQpLCB7fSlcclxuICAgICAgICA6IHJhdztcclxuICAgIGZvciAoY29uc3Qga2V5IGluIGRlZmF1bHRzKSB7XHJcbiAgICAgICAgY29uc3Qgb3B0ID0gcHJvcHNba2V5XTtcclxuICAgICAgICBpZiAob3B0KSB7XHJcbiAgICAgICAgICAgIGlmIChpc0FycmF5KG9wdCkgfHwgaXNGdW5jdGlvbihvcHQpKSB7XHJcbiAgICAgICAgICAgICAgICBwcm9wc1trZXldID0geyB0eXBlOiBvcHQsIGRlZmF1bHQ6IGRlZmF1bHRzW2tleV0gfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIG9wdC5kZWZhdWx0ID0gZGVmYXVsdHNba2V5XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChvcHQgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgcHJvcHNba2V5XSA9IHsgZGVmYXVsdDogZGVmYXVsdHNba2V5XSB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgd2FybihgcHJvcHMgZGVmYXVsdCBrZXkgXCIke2tleX1cIiBoYXMgbm8gY29ycmVzcG9uZGluZyBkZWNsYXJhdGlvbi5gKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcHJvcHM7XHJcbn1cclxuLyoqXHJcbiAqIFVzZWQgdG8gY3JlYXRlIGEgcHJveHkgZm9yIHRoZSByZXN0IGVsZW1lbnQgd2hlbiBkZXN0cnVjdHVyaW5nIHByb3BzIHdpdGhcclxuICogZGVmaW5lUHJvcHMoKS5cclxuICogQGludGVybmFsXHJcbiAqL1xyXG5mdW5jdGlvbiBjcmVhdGVQcm9wc1Jlc3RQcm94eShwcm9wcywgZXhjbHVkZWRLZXlzKSB7XHJcbiAgICBjb25zdCByZXQgPSB7fTtcclxuICAgIGZvciAoY29uc3Qga2V5IGluIHByb3BzKSB7XHJcbiAgICAgICAgaWYgKCFleGNsdWRlZEtleXMuaW5jbHVkZXMoa2V5KSkge1xyXG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocmV0LCBrZXksIHtcclxuICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBnZXQ6ICgpID0+IHByb3BzW2tleV1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJldDtcclxufVxyXG4vKipcclxuICogYDxzY3JpcHQgc2V0dXA+YCBoZWxwZXIgZm9yIHBlcnNpc3RpbmcgdGhlIGN1cnJlbnQgaW5zdGFuY2UgY29udGV4dCBvdmVyXHJcbiAqIGFzeW5jL2F3YWl0IGZsb3dzLlxyXG4gKlxyXG4gKiBgQHZ1ZS9jb21waWxlci1zZmNgIGNvbnZlcnRzIHRoZSBmb2xsb3dpbmc6XHJcbiAqXHJcbiAqIGBgYHRzXHJcbiAqIGNvbnN0IHggPSBhd2FpdCBmb28oKVxyXG4gKiBgYGBcclxuICpcclxuICogaW50bzpcclxuICpcclxuICogYGBgdHNcclxuICogbGV0IF9fdGVtcCwgX19yZXN0b3JlXHJcbiAqIGNvbnN0IHggPSAoKFtfX3RlbXAsIF9fcmVzdG9yZV0gPSB3aXRoQXN5bmNDb250ZXh0KCgpID0+IGZvbygpKSksX190ZW1wPWF3YWl0IF9fdGVtcCxfX3Jlc3RvcmUoKSxfX3RlbXApXHJcbiAqIGBgYFxyXG4gKiBAaW50ZXJuYWxcclxuICovXHJcbmZ1bmN0aW9uIHdpdGhBc3luY0NvbnRleHQoZ2V0QXdhaXRhYmxlKSB7XHJcbiAgICBjb25zdCBjdHggPSBnZXRDdXJyZW50SW5zdGFuY2UoKTtcclxuICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiYgIWN0eCkge1xyXG4gICAgICAgIHdhcm4oYHdpdGhBc3luY0NvbnRleHQgY2FsbGVkIHdpdGhvdXQgYWN0aXZlIGN1cnJlbnQgaW5zdGFuY2UuIGAgK1xyXG4gICAgICAgICAgICBgVGhpcyBpcyBsaWtlbHkgYSBidWcuYCk7XHJcbiAgICB9XHJcbiAgICBsZXQgYXdhaXRhYmxlID0gZ2V0QXdhaXRhYmxlKCk7XHJcbiAgICB1bnNldEN1cnJlbnRJbnN0YW5jZSgpO1xyXG4gICAgaWYgKGlzUHJvbWlzZShhd2FpdGFibGUpKSB7XHJcbiAgICAgICAgYXdhaXRhYmxlID0gYXdhaXRhYmxlLmNhdGNoKGUgPT4ge1xyXG4gICAgICAgICAgICBzZXRDdXJyZW50SW5zdGFuY2UoY3R4KTtcclxuICAgICAgICAgICAgdGhyb3cgZTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIHJldHVybiBbYXdhaXRhYmxlLCAoKSA9PiBzZXRDdXJyZW50SW5zdGFuY2UoY3R4KV07XHJcbn1cblxuLy8gQWN0dWFsIGltcGxlbWVudGF0aW9uXHJcbmZ1bmN0aW9uIGgodHlwZSwgcHJvcHNPckNoaWxkcmVuLCBjaGlsZHJlbikge1xyXG4gICAgY29uc3QgbCA9IGFyZ3VtZW50cy5sZW5ndGg7XHJcbiAgICBpZiAobCA9PT0gMikge1xyXG4gICAgICAgIGlmIChpc09iamVjdChwcm9wc09yQ2hpbGRyZW4pICYmICFpc0FycmF5KHByb3BzT3JDaGlsZHJlbikpIHtcclxuICAgICAgICAgICAgLy8gc2luZ2xlIHZub2RlIHdpdGhvdXQgcHJvcHNcclxuICAgICAgICAgICAgaWYgKGlzVk5vZGUocHJvcHNPckNoaWxkcmVuKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNyZWF0ZVZOb2RlKHR5cGUsIG51bGwsIFtwcm9wc09yQ2hpbGRyZW5dKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBwcm9wcyB3aXRob3V0IGNoaWxkcmVuXHJcbiAgICAgICAgICAgIHJldHVybiBjcmVhdGVWTm9kZSh0eXBlLCBwcm9wc09yQ2hpbGRyZW4pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8gb21pdCBwcm9wc1xyXG4gICAgICAgICAgICByZXR1cm4gY3JlYXRlVk5vZGUodHlwZSwgbnVsbCwgcHJvcHNPckNoaWxkcmVuKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBpZiAobCA+IDMpIHtcclxuICAgICAgICAgICAgY2hpbGRyZW4gPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChsID09PSAzICYmIGlzVk5vZGUoY2hpbGRyZW4pKSB7XHJcbiAgICAgICAgICAgIGNoaWxkcmVuID0gW2NoaWxkcmVuXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGNyZWF0ZVZOb2RlKHR5cGUsIHByb3BzT3JDaGlsZHJlbiwgY2hpbGRyZW4pO1xyXG4gICAgfVxyXG59XG5cbmNvbnN0IHNzckNvbnRleHRLZXkgPSBTeW1ib2woKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpID8gYHNzckNvbnRleHRgIDogYGApO1xyXG5jb25zdCB1c2VTU1JDb250ZXh0ID0gKCkgPT4ge1xyXG4gICAge1xyXG4gICAgICAgIGNvbnN0IGN0eCA9IGluamVjdChzc3JDb250ZXh0S2V5KTtcclxuICAgICAgICBpZiAoIWN0eCkge1xyXG4gICAgICAgICAgICB3YXJuKGBTZXJ2ZXIgcmVuZGVyaW5nIGNvbnRleHQgbm90IHByb3ZpZGVkLiBNYWtlIHN1cmUgdG8gb25seSBjYWxsIGAgK1xyXG4gICAgICAgICAgICAgICAgYHVzZVNTUkNvbnRleHQoKSBjb25kaXRpb25hbGx5IGluIHRoZSBzZXJ2ZXIgYnVpbGQuYCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBjdHg7XHJcbiAgICB9XHJcbn07XG5cbmZ1bmN0aW9uIGlzU2hhbGxvdyh2YWx1ZSkge1xyXG4gICAgcmV0dXJuICEhKHZhbHVlICYmIHZhbHVlW1wiX192X2lzU2hhbGxvd1wiIC8qIElTX1NIQUxMT1cgKi9dKTtcclxufVxuXG5mdW5jdGlvbiBpbml0Q3VzdG9tRm9ybWF0dGVyKCkge1xyXG4gICAgLyogZXNsaW50LWRpc2FibGUgbm8tcmVzdHJpY3RlZC1nbG9iYWxzICovXHJcbiAgICBpZiAoIShwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB8fCB0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IHZ1ZVN0eWxlID0geyBzdHlsZTogJ2NvbG9yOiMzYmE3NzYnIH07XHJcbiAgICBjb25zdCBudW1iZXJTdHlsZSA9IHsgc3R5bGU6ICdjb2xvcjojMGIxYmM5JyB9O1xyXG4gICAgY29uc3Qgc3RyaW5nU3R5bGUgPSB7IHN0eWxlOiAnY29sb3I6I2I2MmUyNCcgfTtcclxuICAgIGNvbnN0IGtleXdvcmRTdHlsZSA9IHsgc3R5bGU6ICdjb2xvcjojOWQyODhjJyB9O1xyXG4gICAgLy8gY3VzdG9tIGZvcm1hdHRlciBmb3IgQ2hyb21lXHJcbiAgICAvLyBodHRwczovL3d3dy5tYXR0emV1bmVydC5jb20vMjAxNi8wMi8xOS9jdXN0b20tY2hyb21lLWRldnRvb2xzLW9iamVjdC1mb3JtYXR0ZXJzLmh0bWxcclxuICAgIGNvbnN0IGZvcm1hdHRlciA9IHtcclxuICAgICAgICBoZWFkZXIob2JqKSB7XHJcbiAgICAgICAgICAgIC8vIFRPRE8gYWxzbyBmb3JtYXQgQ29tcG9uZW50UHVibGljSW5zdGFuY2UgJiBjdHguc2xvdHMvYXR0cnMgaW4gc2V0dXBcclxuICAgICAgICAgICAgaWYgKCFpc09iamVjdChvYmopKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAob2JqLl9faXNWdWUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBbJ2RpdicsIHZ1ZVN0eWxlLCBgVnVlSW5zdGFuY2VgXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChpc1JlZihvYmopKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICAgICAgICAgICdkaXYnLFxyXG4gICAgICAgICAgICAgICAgICAgIHt9LFxyXG4gICAgICAgICAgICAgICAgICAgIFsnc3BhbicsIHZ1ZVN0eWxlLCBnZW5SZWZGbGFnKG9iaildLFxyXG4gICAgICAgICAgICAgICAgICAgICc8JyxcclxuICAgICAgICAgICAgICAgICAgICBmb3JtYXRWYWx1ZShvYmoudmFsdWUpLFxyXG4gICAgICAgICAgICAgICAgICAgIGA+YFxyXG4gICAgICAgICAgICAgICAgXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChpc1JlYWN0aXZlKG9iaikpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgICAgICAgICAgJ2RpdicsXHJcbiAgICAgICAgICAgICAgICAgICAge30sXHJcbiAgICAgICAgICAgICAgICAgICAgWydzcGFuJywgdnVlU3R5bGUsIGlzU2hhbGxvdyhvYmopID8gJ1NoYWxsb3dSZWFjdGl2ZScgOiAnUmVhY3RpdmUnXSxcclxuICAgICAgICAgICAgICAgICAgICAnPCcsXHJcbiAgICAgICAgICAgICAgICAgICAgZm9ybWF0VmFsdWUob2JqKSxcclxuICAgICAgICAgICAgICAgICAgICBgPiR7aXNSZWFkb25seShvYmopID8gYCAocmVhZG9ubHkpYCA6IGBgfWBcclxuICAgICAgICAgICAgICAgIF07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoaXNSZWFkb25seShvYmopKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICAgICAgICAgICdkaXYnLFxyXG4gICAgICAgICAgICAgICAgICAgIHt9LFxyXG4gICAgICAgICAgICAgICAgICAgIFsnc3BhbicsIHZ1ZVN0eWxlLCBpc1NoYWxsb3cob2JqKSA/ICdTaGFsbG93UmVhZG9ubHknIDogJ1JlYWRvbmx5J10sXHJcbiAgICAgICAgICAgICAgICAgICAgJzwnLFxyXG4gICAgICAgICAgICAgICAgICAgIGZvcm1hdFZhbHVlKG9iaiksXHJcbiAgICAgICAgICAgICAgICAgICAgJz4nXHJcbiAgICAgICAgICAgICAgICBdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgaGFzQm9keShvYmopIHtcclxuICAgICAgICAgICAgcmV0dXJuIG9iaiAmJiBvYmouX19pc1Z1ZTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGJvZHkob2JqKSB7XHJcbiAgICAgICAgICAgIGlmIChvYmogJiYgb2JqLl9faXNWdWUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgICAgICAgICAgJ2RpdicsXHJcbiAgICAgICAgICAgICAgICAgICAge30sXHJcbiAgICAgICAgICAgICAgICAgICAgLi4uZm9ybWF0SW5zdGFuY2Uob2JqLiQpXHJcbiAgICAgICAgICAgICAgICBdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGZ1bmN0aW9uIGZvcm1hdEluc3RhbmNlKGluc3RhbmNlKSB7XHJcbiAgICAgICAgY29uc3QgYmxvY2tzID0gW107XHJcbiAgICAgICAgaWYgKGluc3RhbmNlLnR5cGUucHJvcHMgJiYgaW5zdGFuY2UucHJvcHMpIHtcclxuICAgICAgICAgICAgYmxvY2tzLnB1c2goY3JlYXRlSW5zdGFuY2VCbG9jaygncHJvcHMnLCB0b1JhdyhpbnN0YW5jZS5wcm9wcykpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGluc3RhbmNlLnNldHVwU3RhdGUgIT09IEVNUFRZX09CSikge1xyXG4gICAgICAgICAgICBibG9ja3MucHVzaChjcmVhdGVJbnN0YW5jZUJsb2NrKCdzZXR1cCcsIGluc3RhbmNlLnNldHVwU3RhdGUpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGluc3RhbmNlLmRhdGEgIT09IEVNUFRZX09CSikge1xyXG4gICAgICAgICAgICBibG9ja3MucHVzaChjcmVhdGVJbnN0YW5jZUJsb2NrKCdkYXRhJywgdG9SYXcoaW5zdGFuY2UuZGF0YSkpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgY29tcHV0ZWQgPSBleHRyYWN0S2V5cyhpbnN0YW5jZSwgJ2NvbXB1dGVkJyk7XHJcbiAgICAgICAgaWYgKGNvbXB1dGVkKSB7XHJcbiAgICAgICAgICAgIGJsb2Nrcy5wdXNoKGNyZWF0ZUluc3RhbmNlQmxvY2soJ2NvbXB1dGVkJywgY29tcHV0ZWQpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgaW5qZWN0ZWQgPSBleHRyYWN0S2V5cyhpbnN0YW5jZSwgJ2luamVjdCcpO1xyXG4gICAgICAgIGlmIChpbmplY3RlZCkge1xyXG4gICAgICAgICAgICBibG9ja3MucHVzaChjcmVhdGVJbnN0YW5jZUJsb2NrKCdpbmplY3RlZCcsIGluamVjdGVkKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGJsb2Nrcy5wdXNoKFtcclxuICAgICAgICAgICAgJ2RpdicsXHJcbiAgICAgICAgICAgIHt9LFxyXG4gICAgICAgICAgICBbXHJcbiAgICAgICAgICAgICAgICAnc3BhbicsXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3R5bGU6IGtleXdvcmRTdHlsZS5zdHlsZSArICc7b3BhY2l0eTowLjY2J1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICckIChpbnRlcm5hbCk6ICdcclxuICAgICAgICAgICAgXSxcclxuICAgICAgICAgICAgWydvYmplY3QnLCB7IG9iamVjdDogaW5zdGFuY2UgfV1cclxuICAgICAgICBdKTtcclxuICAgICAgICByZXR1cm4gYmxvY2tzO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gY3JlYXRlSW5zdGFuY2VCbG9jayh0eXBlLCB0YXJnZXQpIHtcclxuICAgICAgICB0YXJnZXQgPSBleHRlbmQoe30sIHRhcmdldCk7XHJcbiAgICAgICAgaWYgKCFPYmplY3Qua2V5cyh0YXJnZXQpLmxlbmd0aCkge1xyXG4gICAgICAgICAgICByZXR1cm4gWydzcGFuJywge31dO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICAnZGl2JyxcclxuICAgICAgICAgICAgeyBzdHlsZTogJ2xpbmUtaGVpZ2h0OjEuMjVlbTttYXJnaW4tYm90dG9tOjAuNmVtJyB9LFxyXG4gICAgICAgICAgICBbXHJcbiAgICAgICAgICAgICAgICAnZGl2JyxcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBzdHlsZTogJ2NvbG9yOiM0NzY1ODInXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgdHlwZVxyXG4gICAgICAgICAgICBdLFxyXG4gICAgICAgICAgICBbXHJcbiAgICAgICAgICAgICAgICAnZGl2JyxcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBzdHlsZTogJ3BhZGRpbmctbGVmdDoxLjI1ZW0nXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgLi4uT2JqZWN0LmtleXModGFyZ2V0KS5tYXAoa2V5ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnZGl2JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAge30sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFsnc3BhbicsIGtleXdvcmRTdHlsZSwga2V5ICsgJzogJ10sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdFZhbHVlKHRhcmdldFtrZXldLCBmYWxzZSlcclxuICAgICAgICAgICAgICAgICAgICBdO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgXVxyXG4gICAgICAgIF07XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBmb3JtYXRWYWx1ZSh2LCBhc1JhdyA9IHRydWUpIHtcclxuICAgICAgICBpZiAodHlwZW9mIHYgPT09ICdudW1iZXInKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBbJ3NwYW4nLCBudW1iZXJTdHlsZSwgdl07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHR5cGVvZiB2ID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICByZXR1cm4gWydzcGFuJywgc3RyaW5nU3R5bGUsIEpTT04uc3RyaW5naWZ5KHYpXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodHlwZW9mIHYgPT09ICdib29sZWFuJykge1xyXG4gICAgICAgICAgICByZXR1cm4gWydzcGFuJywga2V5d29yZFN0eWxlLCB2XTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoaXNPYmplY3QodikpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFsnb2JqZWN0JywgeyBvYmplY3Q6IGFzUmF3ID8gdG9SYXcodikgOiB2IH1dO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIFsnc3BhbicsIHN0cmluZ1N0eWxlLCBTdHJpbmcodildO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGV4dHJhY3RLZXlzKGluc3RhbmNlLCB0eXBlKSB7XHJcbiAgICAgICAgY29uc3QgQ29tcCA9IGluc3RhbmNlLnR5cGU7XHJcbiAgICAgICAgaWYgKGlzRnVuY3Rpb24oQ29tcCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBleHRyYWN0ZWQgPSB7fTtcclxuICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBpbnN0YW5jZS5jdHgpIHtcclxuICAgICAgICAgICAgaWYgKGlzS2V5T2ZUeXBlKENvbXAsIGtleSwgdHlwZSkpIHtcclxuICAgICAgICAgICAgICAgIGV4dHJhY3RlZFtrZXldID0gaW5zdGFuY2UuY3R4W2tleV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGV4dHJhY3RlZDtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGlzS2V5T2ZUeXBlKENvbXAsIGtleSwgdHlwZSkge1xyXG4gICAgICAgIGNvbnN0IG9wdHMgPSBDb21wW3R5cGVdO1xyXG4gICAgICAgIGlmICgoaXNBcnJheShvcHRzKSAmJiBvcHRzLmluY2x1ZGVzKGtleSkpIHx8XHJcbiAgICAgICAgICAgIChpc09iamVjdChvcHRzKSAmJiBrZXkgaW4gb3B0cykpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChDb21wLmV4dGVuZHMgJiYgaXNLZXlPZlR5cGUoQ29tcC5leHRlbmRzLCBrZXksIHR5cGUpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoQ29tcC5taXhpbnMgJiYgQ29tcC5taXhpbnMuc29tZShtID0+IGlzS2V5T2ZUeXBlKG0sIGtleSwgdHlwZSkpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGdlblJlZkZsYWcodikge1xyXG4gICAgICAgIGlmIChpc1NoYWxsb3codikpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGBTaGFsbG93UmVmYDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHYuZWZmZWN0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBgQ29tcHV0ZWRSZWZgO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYFJlZmA7XHJcbiAgICB9XHJcbiAgICBpZiAod2luZG93LmRldnRvb2xzRm9ybWF0dGVycykge1xyXG4gICAgICAgIHdpbmRvdy5kZXZ0b29sc0Zvcm1hdHRlcnMucHVzaChmb3JtYXR0ZXIpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgd2luZG93LmRldnRvb2xzRm9ybWF0dGVycyA9IFtmb3JtYXR0ZXJdO1xyXG4gICAgfVxyXG59XG5cbmZ1bmN0aW9uIHdpdGhNZW1vKG1lbW8sIHJlbmRlciwgY2FjaGUsIGluZGV4KSB7XHJcbiAgICBjb25zdCBjYWNoZWQgPSBjYWNoZVtpbmRleF07XHJcbiAgICBpZiAoY2FjaGVkICYmIGlzTWVtb1NhbWUoY2FjaGVkLCBtZW1vKSkge1xyXG4gICAgICAgIHJldHVybiBjYWNoZWQ7XHJcbiAgICB9XHJcbiAgICBjb25zdCByZXQgPSByZW5kZXIoKTtcclxuICAgIC8vIHNoYWxsb3cgY2xvbmVcclxuICAgIHJldC5tZW1vID0gbWVtby5zbGljZSgpO1xyXG4gICAgcmV0dXJuIChjYWNoZVtpbmRleF0gPSByZXQpO1xyXG59XHJcbmZ1bmN0aW9uIGlzTWVtb1NhbWUoY2FjaGVkLCBtZW1vKSB7XHJcbiAgICBjb25zdCBwcmV2ID0gY2FjaGVkLm1lbW87XHJcbiAgICBpZiAocHJldi5sZW5ndGggIT0gbWVtby5sZW5ndGgpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHByZXYubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBpZiAocHJldltpXSAhPT0gbWVtb1tpXSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8gbWFrZSBzdXJlIHRvIGxldCBwYXJlbnQgYmxvY2sgdHJhY2sgaXQgd2hlbiByZXR1cm5pbmcgY2FjaGVkXHJcbiAgICBpZiAoaXNCbG9ja1RyZWVFbmFibGVkID4gMCAmJiBjdXJyZW50QmxvY2spIHtcclxuICAgICAgICBjdXJyZW50QmxvY2sucHVzaChjYWNoZWQpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRydWU7XHJcbn1cblxuLy8gQ29yZSBBUEkgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbmNvbnN0IHZlcnNpb24gPSBcIjMuMi4zMVwiO1xyXG5jb25zdCBfc3NyVXRpbHMgPSB7XHJcbiAgICBjcmVhdGVDb21wb25lbnRJbnN0YW5jZSxcclxuICAgIHNldHVwQ29tcG9uZW50LFxyXG4gICAgcmVuZGVyQ29tcG9uZW50Um9vdCxcclxuICAgIHNldEN1cnJlbnRSZW5kZXJpbmdJbnN0YW5jZSxcclxuICAgIGlzVk5vZGUsXHJcbiAgICBub3JtYWxpemVWTm9kZVxyXG59O1xyXG4vKipcclxuICogU1NSIHV0aWxzIGZvciBcXEB2dWUvc2VydmVyLXJlbmRlcmVyLiBPbmx5IGV4cG9zZWQgaW4gY2pzIGJ1aWxkcy5cclxuICogQGludGVybmFsXHJcbiAqL1xyXG5jb25zdCBzc3JVdGlscyA9IChfc3NyVXRpbHMgKTtcclxuLyoqXHJcbiAqIEBpbnRlcm5hbCBvbmx5IGV4cG9zZWQgaW4gY29tcGF0IGJ1aWxkc1xyXG4gKi9cclxuY29uc3QgcmVzb2x2ZUZpbHRlciA9IG51bGw7XHJcbi8qKlxyXG4gKiBAaW50ZXJuYWwgb25seSBleHBvc2VkIGluIGNvbXBhdCBidWlsZHMuXHJcbiAqL1xyXG5jb25zdCBjb21wYXRVdGlscyA9IChudWxsKTtcblxuZXhwb3J0IHsgQmFzZVRyYW5zaXRpb24sIENvbW1lbnQsIEZyYWdtZW50LCBLZWVwQWxpdmUsIFN0YXRpYywgU3VzcGVuc2UsIFRlbGVwb3J0LCBUZXh0LCBjYWxsV2l0aEFzeW5jRXJyb3JIYW5kbGluZywgY2FsbFdpdGhFcnJvckhhbmRsaW5nLCBjbG9uZVZOb2RlLCBjb21wYXRVdGlscywgY29tcHV0ZWQsIGNyZWF0ZUJsb2NrLCBjcmVhdGVDb21tZW50Vk5vZGUsIGNyZWF0ZUVsZW1lbnRCbG9jaywgY3JlYXRlQmFzZVZOb2RlIGFzIGNyZWF0ZUVsZW1lbnRWTm9kZSwgY3JlYXRlSHlkcmF0aW9uUmVuZGVyZXIsIGNyZWF0ZVByb3BzUmVzdFByb3h5LCBjcmVhdGVSZW5kZXJlciwgY3JlYXRlU2xvdHMsIGNyZWF0ZVN0YXRpY1ZOb2RlLCBjcmVhdGVUZXh0Vk5vZGUsIGNyZWF0ZVZOb2RlLCBkZWZpbmVBc3luY0NvbXBvbmVudCwgZGVmaW5lQ29tcG9uZW50LCBkZWZpbmVFbWl0cywgZGVmaW5lRXhwb3NlLCBkZWZpbmVQcm9wcywgZGV2dG9vbHMsIGdldEN1cnJlbnRJbnN0YW5jZSwgZ2V0VHJhbnNpdGlvblJhd0NoaWxkcmVuLCBndWFyZFJlYWN0aXZlUHJvcHMsIGgsIGhhbmRsZUVycm9yLCBpbml0Q3VzdG9tRm9ybWF0dGVyLCBpbmplY3QsIGlzTWVtb1NhbWUsIGlzUnVudGltZU9ubHksIGlzVk5vZGUsIG1lcmdlRGVmYXVsdHMsIG1lcmdlUHJvcHMsIG5leHRUaWNrLCBvbkFjdGl2YXRlZCwgb25CZWZvcmVNb3VudCwgb25CZWZvcmVVbm1vdW50LCBvbkJlZm9yZVVwZGF0ZSwgb25EZWFjdGl2YXRlZCwgb25FcnJvckNhcHR1cmVkLCBvbk1vdW50ZWQsIG9uUmVuZGVyVHJhY2tlZCwgb25SZW5kZXJUcmlnZ2VyZWQsIG9uU2VydmVyUHJlZmV0Y2gsIG9uVW5tb3VudGVkLCBvblVwZGF0ZWQsIG9wZW5CbG9jaywgcG9wU2NvcGVJZCwgcHJvdmlkZSwgcHVzaFNjb3BlSWQsIHF1ZXVlUG9zdEZsdXNoQ2IsIHJlZ2lzdGVyUnVudGltZUNvbXBpbGVyLCByZW5kZXJMaXN0LCByZW5kZXJTbG90LCByZXNvbHZlQ29tcG9uZW50LCByZXNvbHZlRGlyZWN0aXZlLCByZXNvbHZlRHluYW1pY0NvbXBvbmVudCwgcmVzb2x2ZUZpbHRlciwgcmVzb2x2ZVRyYW5zaXRpb25Ib29rcywgc2V0QmxvY2tUcmFja2luZywgc2V0RGV2dG9vbHNIb29rLCBzZXRUcmFuc2l0aW9uSG9va3MsIHNzckNvbnRleHRLZXksIHNzclV0aWxzLCB0b0hhbmRsZXJzLCB0cmFuc2Zvcm1WTm9kZUFyZ3MsIHVzZUF0dHJzLCB1c2VTU1JDb250ZXh0LCB1c2VTbG90cywgdXNlVHJhbnNpdGlvblN0YXRlLCB2ZXJzaW9uLCB3YXJuLCB3YXRjaCwgd2F0Y2hFZmZlY3QsIHdhdGNoUG9zdEVmZmVjdCwgd2F0Y2hTeW5jRWZmZWN0LCB3aXRoQXN5bmNDb250ZXh0LCB3aXRoQ3R4LCB3aXRoRGVmYXVsdHMsIHdpdGhEaXJlY3RpdmVzLCB3aXRoTWVtbywgd2l0aFNjb3BlSWQgfTtcbiIsImltcG9ydCB7IGNhbWVsaXplLCB3YXJuLCBjYWxsV2l0aEFzeW5jRXJyb3JIYW5kbGluZywgZGVmaW5lQ29tcG9uZW50LCBuZXh0VGljaywgY3JlYXRlVk5vZGUsIGdldEN1cnJlbnRJbnN0YW5jZSwgd2F0Y2hQb3N0RWZmZWN0LCBvbk1vdW50ZWQsIG9uVW5tb3VudGVkLCBGcmFnbWVudCwgU3RhdGljLCBoLCBCYXNlVHJhbnNpdGlvbiwgdXNlVHJhbnNpdGlvblN0YXRlLCBvblVwZGF0ZWQsIHRvUmF3LCBnZXRUcmFuc2l0aW9uUmF3Q2hpbGRyZW4sIHNldFRyYW5zaXRpb25Ib29rcywgcmVzb2x2ZVRyYW5zaXRpb25Ib29rcywgY3JlYXRlUmVuZGVyZXIsIGlzUnVudGltZU9ubHksIGNyZWF0ZUh5ZHJhdGlvblJlbmRlcmVyIH0gZnJvbSAnQHZ1ZS9ydW50aW1lLWNvcmUnO1xuZXhwb3J0ICogZnJvbSAnQHZ1ZS9ydW50aW1lLWNvcmUnO1xuaW1wb3J0IHsgaXNTdHJpbmcsIGlzQXJyYXksIGh5cGhlbmF0ZSwgY2FwaXRhbGl6ZSwgaXNTcGVjaWFsQm9vbGVhbkF0dHIsIGluY2x1ZGVCb29sZWFuQXR0ciwgaXNPbiwgaXNNb2RlbExpc3RlbmVyLCBpc0Z1bmN0aW9uLCB0b051bWJlciwgY2FtZWxpemUgYXMgY2FtZWxpemUkMSwgZXh0ZW5kLCBFTVBUWV9PQkosIGlzT2JqZWN0LCBpbnZva2VBcnJheUZucywgbG9vc2VJbmRleE9mLCBpc1NldCwgbG9vc2VFcXVhbCwgaXNIVE1MVGFnLCBpc1NWR1RhZyB9IGZyb20gJ0B2dWUvc2hhcmVkJztcblxuY29uc3Qgc3ZnTlMgPSAnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnO1xyXG5jb25zdCBkb2MgPSAodHlwZW9mIGRvY3VtZW50ICE9PSAndW5kZWZpbmVkJyA/IGRvY3VtZW50IDogbnVsbCk7XHJcbmNvbnN0IHRlbXBsYXRlQ29udGFpbmVyID0gZG9jICYmIGRvYy5jcmVhdGVFbGVtZW50KCd0ZW1wbGF0ZScpO1xyXG5jb25zdCBub2RlT3BzID0ge1xyXG4gICAgaW5zZXJ0OiAoY2hpbGQsIHBhcmVudCwgYW5jaG9yKSA9PiB7XHJcbiAgICAgICAgcGFyZW50Lmluc2VydEJlZm9yZShjaGlsZCwgYW5jaG9yIHx8IG51bGwpO1xyXG4gICAgfSxcclxuICAgIHJlbW92ZTogY2hpbGQgPT4ge1xyXG4gICAgICAgIGNvbnN0IHBhcmVudCA9IGNoaWxkLnBhcmVudE5vZGU7XHJcbiAgICAgICAgaWYgKHBhcmVudCkge1xyXG4gICAgICAgICAgICBwYXJlbnQucmVtb3ZlQ2hpbGQoY2hpbGQpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBjcmVhdGVFbGVtZW50OiAodGFnLCBpc1NWRywgaXMsIHByb3BzKSA9PiB7XHJcbiAgICAgICAgY29uc3QgZWwgPSBpc1NWR1xyXG4gICAgICAgICAgICA/IGRvYy5jcmVhdGVFbGVtZW50TlMoc3ZnTlMsIHRhZylcclxuICAgICAgICAgICAgOiBkb2MuY3JlYXRlRWxlbWVudCh0YWcsIGlzID8geyBpcyB9IDogdW5kZWZpbmVkKTtcclxuICAgICAgICBpZiAodGFnID09PSAnc2VsZWN0JyAmJiBwcm9wcyAmJiBwcm9wcy5tdWx0aXBsZSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIGVsLnNldEF0dHJpYnV0ZSgnbXVsdGlwbGUnLCBwcm9wcy5tdWx0aXBsZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBlbDtcclxuICAgIH0sXHJcbiAgICBjcmVhdGVUZXh0OiB0ZXh0ID0+IGRvYy5jcmVhdGVUZXh0Tm9kZSh0ZXh0KSxcclxuICAgIGNyZWF0ZUNvbW1lbnQ6IHRleHQgPT4gZG9jLmNyZWF0ZUNvbW1lbnQodGV4dCksXHJcbiAgICBzZXRUZXh0OiAobm9kZSwgdGV4dCkgPT4ge1xyXG4gICAgICAgIG5vZGUubm9kZVZhbHVlID0gdGV4dDtcclxuICAgIH0sXHJcbiAgICBzZXRFbGVtZW50VGV4dDogKGVsLCB0ZXh0KSA9PiB7XHJcbiAgICAgICAgZWwudGV4dENvbnRlbnQgPSB0ZXh0O1xyXG4gICAgfSxcclxuICAgIHBhcmVudE5vZGU6IG5vZGUgPT4gbm9kZS5wYXJlbnROb2RlLFxyXG4gICAgbmV4dFNpYmxpbmc6IG5vZGUgPT4gbm9kZS5uZXh0U2libGluZyxcclxuICAgIHF1ZXJ5U2VsZWN0b3I6IHNlbGVjdG9yID0+IGRvYy5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKSxcclxuICAgIHNldFNjb3BlSWQoZWwsIGlkKSB7XHJcbiAgICAgICAgZWwuc2V0QXR0cmlidXRlKGlkLCAnJyk7XHJcbiAgICB9LFxyXG4gICAgY2xvbmVOb2RlKGVsKSB7XHJcbiAgICAgICAgY29uc3QgY2xvbmVkID0gZWwuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgICAgIC8vICMzMDcyXHJcbiAgICAgICAgLy8gLSBpbiBgcGF0Y2hET01Qcm9wYCwgd2Ugc3RvcmUgdGhlIGFjdHVhbCB2YWx1ZSBpbiB0aGUgYGVsLl92YWx1ZWAgcHJvcGVydHkuXHJcbiAgICAgICAgLy8gLSBub3JtYWxseSwgZWxlbWVudHMgdXNpbmcgYDp2YWx1ZWAgYmluZGluZ3Mgd2lsbCBub3QgYmUgaG9pc3RlZCwgYnV0IGlmXHJcbiAgICAgICAgLy8gICB0aGUgYm91bmQgdmFsdWUgaXMgYSBjb25zdGFudCwgZS5nLiBgOnZhbHVlPVwidHJ1ZVwiYCAtIHRoZXkgZG8gZ2V0XHJcbiAgICAgICAgLy8gICBob2lzdGVkLlxyXG4gICAgICAgIC8vIC0gaW4gcHJvZHVjdGlvbiwgaG9pc3RlZCBub2RlcyBhcmUgY2xvbmVkIHdoZW4gc3Vic2VxdWVudCBpbnNlcnRzLCBidXRcclxuICAgICAgICAvLyAgIGNsb25lTm9kZSgpIGRvZXMgbm90IGNvcHkgdGhlIGN1c3RvbSBwcm9wZXJ0eSB3ZSBhdHRhY2hlZC5cclxuICAgICAgICAvLyAtIFRoaXMgbWF5IG5lZWQgdG8gYWNjb3VudCBmb3Igb3RoZXIgY3VzdG9tIERPTSBwcm9wZXJ0aWVzIHdlIGF0dGFjaCB0b1xyXG4gICAgICAgIC8vICAgZWxlbWVudHMgaW4gYWRkaXRpb24gdG8gYF92YWx1ZWAgaW4gdGhlIGZ1dHVyZS5cclxuICAgICAgICBpZiAoYF92YWx1ZWAgaW4gZWwpIHtcclxuICAgICAgICAgICAgY2xvbmVkLl92YWx1ZSA9IGVsLl92YWx1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGNsb25lZDtcclxuICAgIH0sXHJcbiAgICAvLyBfX1VOU0FGRV9fXHJcbiAgICAvLyBSZWFzb246IGlubmVySFRNTC5cclxuICAgIC8vIFN0YXRpYyBjb250ZW50IGhlcmUgY2FuIG9ubHkgY29tZSBmcm9tIGNvbXBpbGVkIHRlbXBsYXRlcy5cclxuICAgIC8vIEFzIGxvbmcgYXMgdGhlIHVzZXIgb25seSB1c2VzIHRydXN0ZWQgdGVtcGxhdGVzLCB0aGlzIGlzIHNhZmUuXHJcbiAgICBpbnNlcnRTdGF0aWNDb250ZW50KGNvbnRlbnQsIHBhcmVudCwgYW5jaG9yLCBpc1NWRywgc3RhcnQsIGVuZCkge1xyXG4gICAgICAgIC8vIDxwYXJlbnQ+IGJlZm9yZSB8IGZpcnN0IC4uLiBsYXN0IHwgYW5jaG9yIDwvcGFyZW50PlxyXG4gICAgICAgIGNvbnN0IGJlZm9yZSA9IGFuY2hvciA/IGFuY2hvci5wcmV2aW91c1NpYmxpbmcgOiBwYXJlbnQubGFzdENoaWxkO1xyXG4gICAgICAgIC8vICM1MzA4IGNhbiBvbmx5IHRha2UgY2FjaGVkIHBhdGggaWY6XHJcbiAgICAgICAgLy8gLSBoYXMgYSBzaW5nbGUgcm9vdCBub2RlXHJcbiAgICAgICAgLy8gLSBuZXh0U2libGluZyBpbmZvIGlzIHN0aWxsIGF2YWlsYWJsZVxyXG4gICAgICAgIGlmIChzdGFydCAmJiAoc3RhcnQgPT09IGVuZCB8fCBzdGFydC5uZXh0U2libGluZykpIHtcclxuICAgICAgICAgICAgLy8gY2FjaGVkXHJcbiAgICAgICAgICAgIHdoaWxlICh0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICBwYXJlbnQuaW5zZXJ0QmVmb3JlKHN0YXJ0LmNsb25lTm9kZSh0cnVlKSwgYW5jaG9yKTtcclxuICAgICAgICAgICAgICAgIGlmIChzdGFydCA9PT0gZW5kIHx8ICEoc3RhcnQgPSBzdGFydC5uZXh0U2libGluZykpXHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIGZyZXNoIGluc2VydFxyXG4gICAgICAgICAgICB0ZW1wbGF0ZUNvbnRhaW5lci5pbm5lckhUTUwgPSBpc1NWRyA/IGA8c3ZnPiR7Y29udGVudH08L3N2Zz5gIDogY29udGVudDtcclxuICAgICAgICAgICAgY29uc3QgdGVtcGxhdGUgPSB0ZW1wbGF0ZUNvbnRhaW5lci5jb250ZW50O1xyXG4gICAgICAgICAgICBpZiAoaXNTVkcpIHtcclxuICAgICAgICAgICAgICAgIC8vIHJlbW92ZSBvdXRlciBzdmcgd3JhcHBlclxyXG4gICAgICAgICAgICAgICAgY29uc3Qgd3JhcHBlciA9IHRlbXBsYXRlLmZpcnN0Q2hpbGQ7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAod3JhcHBlci5maXJzdENoaWxkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGUuYXBwZW5kQ2hpbGQod3JhcHBlci5maXJzdENoaWxkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlLnJlbW92ZUNoaWxkKHdyYXBwZXIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHBhcmVudC5pbnNlcnRCZWZvcmUodGVtcGxhdGUsIGFuY2hvcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgIC8vIGZpcnN0XHJcbiAgICAgICAgICAgIGJlZm9yZSA/IGJlZm9yZS5uZXh0U2libGluZyA6IHBhcmVudC5maXJzdENoaWxkLFxyXG4gICAgICAgICAgICAvLyBsYXN0XHJcbiAgICAgICAgICAgIGFuY2hvciA/IGFuY2hvci5wcmV2aW91c1NpYmxpbmcgOiBwYXJlbnQubGFzdENoaWxkXHJcbiAgICAgICAgXTtcclxuICAgIH1cclxufTtcblxuLy8gY29tcGlsZXIgc2hvdWxkIG5vcm1hbGl6ZSBjbGFzcyArIDpjbGFzcyBiaW5kaW5ncyBvbiB0aGUgc2FtZSBlbGVtZW50XHJcbi8vIGludG8gYSBzaW5nbGUgYmluZGluZyBbJ3N0YXRpY0NsYXNzJywgZHluYW1pY11cclxuZnVuY3Rpb24gcGF0Y2hDbGFzcyhlbCwgdmFsdWUsIGlzU1ZHKSB7XHJcbiAgICAvLyBkaXJlY3RseSBzZXR0aW5nIGNsYXNzTmFtZSBzaG91bGQgYmUgZmFzdGVyIHRoYW4gc2V0QXR0cmlidXRlIGluIHRoZW9yeVxyXG4gICAgLy8gaWYgdGhpcyBpcyBhbiBlbGVtZW50IGR1cmluZyBhIHRyYW5zaXRpb24sIHRha2UgdGhlIHRlbXBvcmFyeSB0cmFuc2l0aW9uXHJcbiAgICAvLyBjbGFzc2VzIGludG8gYWNjb3VudC5cclxuICAgIGNvbnN0IHRyYW5zaXRpb25DbGFzc2VzID0gZWwuX3Z0YztcclxuICAgIGlmICh0cmFuc2l0aW9uQ2xhc3Nlcykge1xyXG4gICAgICAgIHZhbHVlID0gKHZhbHVlID8gW3ZhbHVlLCAuLi50cmFuc2l0aW9uQ2xhc3Nlc10gOiBbLi4udHJhbnNpdGlvbkNsYXNzZXNdKS5qb2luKCcgJyk7XHJcbiAgICB9XHJcbiAgICBpZiAodmFsdWUgPT0gbnVsbCkge1xyXG4gICAgICAgIGVsLnJlbW92ZUF0dHJpYnV0ZSgnY2xhc3MnKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGlzU1ZHKSB7XHJcbiAgICAgICAgZWwuc2V0QXR0cmlidXRlKCdjbGFzcycsIHZhbHVlKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIGVsLmNsYXNzTmFtZSA9IHZhbHVlO1xyXG4gICAgfVxyXG59XG5cbmZ1bmN0aW9uIHBhdGNoU3R5bGUoZWwsIHByZXYsIG5leHQpIHtcclxuICAgIGNvbnN0IHN0eWxlID0gZWwuc3R5bGU7XHJcbiAgICBjb25zdCBpc0Nzc1N0cmluZyA9IGlzU3RyaW5nKG5leHQpO1xyXG4gICAgaWYgKG5leHQgJiYgIWlzQ3NzU3RyaW5nKSB7XHJcbiAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gbmV4dCkge1xyXG4gICAgICAgICAgICBzZXRTdHlsZShzdHlsZSwga2V5LCBuZXh0W2tleV0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocHJldiAmJiAhaXNTdHJpbmcocHJldikpIHtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gcHJldikge1xyXG4gICAgICAgICAgICAgICAgaWYgKG5leHRba2V5XSA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0U3R5bGUoc3R5bGUsIGtleSwgJycpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgY29uc3QgY3VycmVudERpc3BsYXkgPSBzdHlsZS5kaXNwbGF5O1xyXG4gICAgICAgIGlmIChpc0Nzc1N0cmluZykge1xyXG4gICAgICAgICAgICBpZiAocHJldiAhPT0gbmV4dCkge1xyXG4gICAgICAgICAgICAgICAgc3R5bGUuY3NzVGV4dCA9IG5leHQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAocHJldikge1xyXG4gICAgICAgICAgICBlbC5yZW1vdmVBdHRyaWJ1dGUoJ3N0eWxlJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGluZGljYXRlcyB0aGF0IHRoZSBgZGlzcGxheWAgb2YgdGhlIGVsZW1lbnQgaXMgY29udHJvbGxlZCBieSBgdi1zaG93YCxcclxuICAgICAgICAvLyBzbyB3ZSBhbHdheXMga2VlcCB0aGUgY3VycmVudCBgZGlzcGxheWAgdmFsdWUgcmVnYXJkbGVzcyBvZiB0aGUgYHN0eWxlYFxyXG4gICAgICAgIC8vIHZhbHVlLCB0aHVzIGhhbmRpbmcgb3ZlciBjb250cm9sIHRvIGB2LXNob3dgLlxyXG4gICAgICAgIGlmICgnX3ZvZCcgaW4gZWwpIHtcclxuICAgICAgICAgICAgc3R5bGUuZGlzcGxheSA9IGN1cnJlbnREaXNwbGF5O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5jb25zdCBpbXBvcnRhbnRSRSA9IC9cXHMqIWltcG9ydGFudCQvO1xyXG5mdW5jdGlvbiBzZXRTdHlsZShzdHlsZSwgbmFtZSwgdmFsKSB7XHJcbiAgICBpZiAoaXNBcnJheSh2YWwpKSB7XHJcbiAgICAgICAgdmFsLmZvckVhY2godiA9PiBzZXRTdHlsZShzdHlsZSwgbmFtZSwgdikpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgaWYgKG5hbWUuc3RhcnRzV2l0aCgnLS0nKSkge1xyXG4gICAgICAgICAgICAvLyBjdXN0b20gcHJvcGVydHkgZGVmaW5pdGlvblxyXG4gICAgICAgICAgICBzdHlsZS5zZXRQcm9wZXJ0eShuYW1lLCB2YWwpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgY29uc3QgcHJlZml4ZWQgPSBhdXRvUHJlZml4KHN0eWxlLCBuYW1lKTtcclxuICAgICAgICAgICAgaWYgKGltcG9ydGFudFJFLnRlc3QodmFsKSkge1xyXG4gICAgICAgICAgICAgICAgLy8gIWltcG9ydGFudFxyXG4gICAgICAgICAgICAgICAgc3R5bGUuc2V0UHJvcGVydHkoaHlwaGVuYXRlKHByZWZpeGVkKSwgdmFsLnJlcGxhY2UoaW1wb3J0YW50UkUsICcnKSwgJ2ltcG9ydGFudCcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgc3R5bGVbcHJlZml4ZWRdID0gdmFsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbmNvbnN0IHByZWZpeGVzID0gWydXZWJraXQnLCAnTW96JywgJ21zJ107XHJcbmNvbnN0IHByZWZpeENhY2hlID0ge307XHJcbmZ1bmN0aW9uIGF1dG9QcmVmaXgoc3R5bGUsIHJhd05hbWUpIHtcclxuICAgIGNvbnN0IGNhY2hlZCA9IHByZWZpeENhY2hlW3Jhd05hbWVdO1xyXG4gICAgaWYgKGNhY2hlZCkge1xyXG4gICAgICAgIHJldHVybiBjYWNoZWQ7XHJcbiAgICB9XHJcbiAgICBsZXQgbmFtZSA9IGNhbWVsaXplKHJhd05hbWUpO1xyXG4gICAgaWYgKG5hbWUgIT09ICdmaWx0ZXInICYmIG5hbWUgaW4gc3R5bGUpIHtcclxuICAgICAgICByZXR1cm4gKHByZWZpeENhY2hlW3Jhd05hbWVdID0gbmFtZSk7XHJcbiAgICB9XHJcbiAgICBuYW1lID0gY2FwaXRhbGl6ZShuYW1lKTtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcHJlZml4ZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBjb25zdCBwcmVmaXhlZCA9IHByZWZpeGVzW2ldICsgbmFtZTtcclxuICAgICAgICBpZiAocHJlZml4ZWQgaW4gc3R5bGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIChwcmVmaXhDYWNoZVtyYXdOYW1lXSA9IHByZWZpeGVkKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmF3TmFtZTtcclxufVxuXG5jb25zdCB4bGlua05TID0gJ2h0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsnO1xyXG5mdW5jdGlvbiBwYXRjaEF0dHIoZWwsIGtleSwgdmFsdWUsIGlzU1ZHLCBpbnN0YW5jZSkge1xyXG4gICAgaWYgKGlzU1ZHICYmIGtleS5zdGFydHNXaXRoKCd4bGluazonKSkge1xyXG4gICAgICAgIGlmICh2YWx1ZSA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIGVsLnJlbW92ZUF0dHJpYnV0ZU5TKHhsaW5rTlMsIGtleS5zbGljZSg2LCBrZXkubGVuZ3RoKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBlbC5zZXRBdHRyaWJ1dGVOUyh4bGlua05TLCBrZXksIHZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICAvLyBub3RlIHdlIGFyZSBvbmx5IGNoZWNraW5nIGJvb2xlYW4gYXR0cmlidXRlcyB0aGF0IGRvbid0IGhhdmUgYVxyXG4gICAgICAgIC8vIGNvcnJlc3BvbmRpbmcgZG9tIHByb3Agb2YgdGhlIHNhbWUgbmFtZSBoZXJlLlxyXG4gICAgICAgIGNvbnN0IGlzQm9vbGVhbiA9IGlzU3BlY2lhbEJvb2xlYW5BdHRyKGtleSk7XHJcbiAgICAgICAgaWYgKHZhbHVlID09IG51bGwgfHwgKGlzQm9vbGVhbiAmJiAhaW5jbHVkZUJvb2xlYW5BdHRyKHZhbHVlKSkpIHtcclxuICAgICAgICAgICAgZWwucmVtb3ZlQXR0cmlidXRlKGtleSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBlbC5zZXRBdHRyaWJ1dGUoa2V5LCBpc0Jvb2xlYW4gPyAnJyA6IHZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cblxuLy8gX19VTlNBRkVfX1xyXG4vLyBmdW5jdGlvbnMuIFRoZSB1c2VyIGlzIHJlc3BvbnNpYmxlIGZvciB1c2luZyB0aGVtIHdpdGggb25seSB0cnVzdGVkIGNvbnRlbnQuXHJcbmZ1bmN0aW9uIHBhdGNoRE9NUHJvcChlbCwga2V5LCB2YWx1ZSwgXHJcbi8vIHRoZSBmb2xsb3dpbmcgYXJncyBhcmUgcGFzc2VkIG9ubHkgZHVlIHRvIHBvdGVudGlhbCBpbm5lckhUTUwvdGV4dENvbnRlbnRcclxuLy8gb3ZlcnJpZGluZyBleGlzdGluZyBWTm9kZXMsIGluIHdoaWNoIGNhc2UgdGhlIG9sZCB0cmVlIG11c3QgYmUgcHJvcGVybHlcclxuLy8gdW5tb3VudGVkLlxyXG5wcmV2Q2hpbGRyZW4sIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIHVubW91bnRDaGlsZHJlbikge1xyXG4gICAgaWYgKGtleSA9PT0gJ2lubmVySFRNTCcgfHwga2V5ID09PSAndGV4dENvbnRlbnQnKSB7XHJcbiAgICAgICAgaWYgKHByZXZDaGlsZHJlbikge1xyXG4gICAgICAgICAgICB1bm1vdW50Q2hpbGRyZW4ocHJldkNoaWxkcmVuLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxba2V5XSA9IHZhbHVlID09IG51bGwgPyAnJyA6IHZhbHVlO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGlmIChrZXkgPT09ICd2YWx1ZScgJiZcclxuICAgICAgICBlbC50YWdOYW1lICE9PSAnUFJPR1JFU1MnICYmXHJcbiAgICAgICAgLy8gY3VzdG9tIGVsZW1lbnRzIG1heSB1c2UgX3ZhbHVlIGludGVybmFsbHlcclxuICAgICAgICAhZWwudGFnTmFtZS5pbmNsdWRlcygnLScpKSB7XHJcbiAgICAgICAgLy8gc3RvcmUgdmFsdWUgYXMgX3ZhbHVlIGFzIHdlbGwgc2luY2VcclxuICAgICAgICAvLyBub24tc3RyaW5nIHZhbHVlcyB3aWxsIGJlIHN0cmluZ2lmaWVkLlxyXG4gICAgICAgIGVsLl92YWx1ZSA9IHZhbHVlO1xyXG4gICAgICAgIGNvbnN0IG5ld1ZhbHVlID0gdmFsdWUgPT0gbnVsbCA/ICcnIDogdmFsdWU7XHJcbiAgICAgICAgaWYgKGVsLnZhbHVlICE9PSBuZXdWYWx1ZSB8fFxyXG4gICAgICAgICAgICAvLyAjNDk1NjogYWx3YXlzIHNldCBmb3IgT1BUSU9OIGVsZW1lbnRzIGJlY2F1c2UgaXRzIHZhbHVlIGZhbGxzIGJhY2sgdG9cclxuICAgICAgICAgICAgLy8gdGV4dENvbnRlbnQgaWYgbm8gdmFsdWUgYXR0cmlidXRlIGlzIHByZXNlbnQuIEFuZCBzZXR0aW5nIC52YWx1ZSBmb3JcclxuICAgICAgICAgICAgLy8gT1BUSU9OIGhhcyBubyBzaWRlIGVmZmVjdFxyXG4gICAgICAgICAgICBlbC50YWdOYW1lID09PSAnT1BUSU9OJykge1xyXG4gICAgICAgICAgICBlbC52YWx1ZSA9IG5ld1ZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodmFsdWUgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBlbC5yZW1vdmVBdHRyaWJ1dGUoa2V5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgaWYgKHZhbHVlID09PSAnJyB8fCB2YWx1ZSA9PSBudWxsKSB7XHJcbiAgICAgICAgY29uc3QgdHlwZSA9IHR5cGVvZiBlbFtrZXldO1xyXG4gICAgICAgIGlmICh0eXBlID09PSAnYm9vbGVhbicpIHtcclxuICAgICAgICAgICAgLy8gZS5nLiA8c2VsZWN0IG11bHRpcGxlPiBjb21waWxlcyB0byB7IG11bHRpcGxlOiAnJyB9XHJcbiAgICAgICAgICAgIGVsW2tleV0gPSBpbmNsdWRlQm9vbGVhbkF0dHIodmFsdWUpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHZhbHVlID09IG51bGwgJiYgdHlwZSA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgLy8gZS5nLiA8ZGl2IDppZD1cIm51bGxcIj5cclxuICAgICAgICAgICAgZWxba2V5XSA9ICcnO1xyXG4gICAgICAgICAgICBlbC5yZW1vdmVBdHRyaWJ1dGUoa2V5KTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh0eXBlID09PSAnbnVtYmVyJykge1xyXG4gICAgICAgICAgICAvLyBlLmcuIDxpbWcgOndpZHRoPVwibnVsbFwiPlxyXG4gICAgICAgICAgICAvLyB0aGUgdmFsdWUgb2Ygc29tZSBJREwgYXR0ciBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAwLCBlLmcuIGlucHV0LnNpemUgPSAwIC0+IGVycm9yXHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBlbFtrZXldID0gMDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXRjaCAoX2EpIHsgfVxyXG4gICAgICAgICAgICBlbC5yZW1vdmVBdHRyaWJ1dGUoa2V5KTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8vIHNvbWUgcHJvcGVydGllcyBwZXJmb3JtIHZhbHVlIHZhbGlkYXRpb24gYW5kIHRocm93XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGVsW2tleV0gPSB2YWx1ZTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgICAgICB3YXJuKGBGYWlsZWQgc2V0dGluZyBwcm9wIFwiJHtrZXl9XCIgb24gPCR7ZWwudGFnTmFtZS50b0xvd2VyQ2FzZSgpfT46IGAgK1xyXG4gICAgICAgICAgICAgICAgYHZhbHVlICR7dmFsdWV9IGlzIGludmFsaWQuYCwgZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XG5cbi8vIEFzeW5jIGVkZ2UgY2FzZSBmaXggcmVxdWlyZXMgc3RvcmluZyBhbiBldmVudCBsaXN0ZW5lcidzIGF0dGFjaCB0aW1lc3RhbXAuXHJcbmxldCBfZ2V0Tm93ID0gRGF0ZS5ub3c7XHJcbmxldCBza2lwVGltZXN0YW1wQ2hlY2sgPSBmYWxzZTtcclxuaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAvLyBEZXRlcm1pbmUgd2hhdCBldmVudCB0aW1lc3RhbXAgdGhlIGJyb3dzZXIgaXMgdXNpbmcuIEFubm95aW5nbHksIHRoZVxyXG4gICAgLy8gdGltZXN0YW1wIGNhbiBlaXRoZXIgYmUgaGktcmVzIChyZWxhdGl2ZSB0byBwYWdlIGxvYWQpIG9yIGxvdy1yZXNcclxuICAgIC8vIChyZWxhdGl2ZSB0byBVTklYIGVwb2NoKSwgc28gaW4gb3JkZXIgdG8gY29tcGFyZSB0aW1lIHdlIGhhdmUgdG8gdXNlIHRoZVxyXG4gICAgLy8gc2FtZSB0aW1lc3RhbXAgdHlwZSB3aGVuIHNhdmluZyB0aGUgZmx1c2ggdGltZXN0YW1wLlxyXG4gICAgaWYgKF9nZXROb3coKSA+IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdFdmVudCcpLnRpbWVTdGFtcCkge1xyXG4gICAgICAgIC8vIGlmIHRoZSBsb3ctcmVzIHRpbWVzdGFtcCB3aGljaCBpcyBiaWdnZXIgdGhhbiB0aGUgZXZlbnQgdGltZXN0YW1wXHJcbiAgICAgICAgLy8gKHdoaWNoIGlzIGV2YWx1YXRlZCBBRlRFUikgaXQgbWVhbnMgdGhlIGV2ZW50IGlzIHVzaW5nIGEgaGktcmVzIHRpbWVzdGFtcCxcclxuICAgICAgICAvLyBhbmQgd2UgbmVlZCB0byB1c2UgdGhlIGhpLXJlcyB2ZXJzaW9uIGZvciBldmVudCBsaXN0ZW5lcnMgYXMgd2VsbC5cclxuICAgICAgICBfZ2V0Tm93ID0gKCkgPT4gcGVyZm9ybWFuY2Uubm93KCk7XHJcbiAgICB9XHJcbiAgICAvLyAjMzQ4NTogRmlyZWZveCA8PSA1MyBoYXMgaW5jb3JyZWN0IEV2ZW50LnRpbWVTdGFtcCBpbXBsZW1lbnRhdGlvblxyXG4gICAgLy8gYW5kIGRvZXMgbm90IGZpcmUgbWljcm90YXNrcyBpbiBiZXR3ZWVuIGV2ZW50IHByb3BhZ2F0aW9uLCBzbyBzYWZlIHRvIGV4Y2x1ZGUuXHJcbiAgICBjb25zdCBmZk1hdGNoID0gbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvZmlyZWZveFxcLyhcXGQrKS9pKTtcclxuICAgIHNraXBUaW1lc3RhbXBDaGVjayA9ICEhKGZmTWF0Y2ggJiYgTnVtYmVyKGZmTWF0Y2hbMV0pIDw9IDUzKTtcclxufVxyXG4vLyBUbyBhdm9pZCB0aGUgb3ZlcmhlYWQgb2YgcmVwZWF0ZWRseSBjYWxsaW5nIHBlcmZvcm1hbmNlLm5vdygpLCB3ZSBjYWNoZVxyXG4vLyBhbmQgdXNlIHRoZSBzYW1lIHRpbWVzdGFtcCBmb3IgYWxsIGV2ZW50IGxpc3RlbmVycyBhdHRhY2hlZCBpbiB0aGUgc2FtZSB0aWNrLlxyXG5sZXQgY2FjaGVkTm93ID0gMDtcclxuY29uc3QgcCA9IFByb21pc2UucmVzb2x2ZSgpO1xyXG5jb25zdCByZXNldCA9ICgpID0+IHtcclxuICAgIGNhY2hlZE5vdyA9IDA7XHJcbn07XHJcbmNvbnN0IGdldE5vdyA9ICgpID0+IGNhY2hlZE5vdyB8fCAocC50aGVuKHJlc2V0KSwgKGNhY2hlZE5vdyA9IF9nZXROb3coKSkpO1xyXG5mdW5jdGlvbiBhZGRFdmVudExpc3RlbmVyKGVsLCBldmVudCwgaGFuZGxlciwgb3B0aW9ucykge1xyXG4gICAgZWwuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgaGFuZGxlciwgb3B0aW9ucyk7XHJcbn1cclxuZnVuY3Rpb24gcmVtb3ZlRXZlbnRMaXN0ZW5lcihlbCwgZXZlbnQsIGhhbmRsZXIsIG9wdGlvbnMpIHtcclxuICAgIGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnQsIGhhbmRsZXIsIG9wdGlvbnMpO1xyXG59XHJcbmZ1bmN0aW9uIHBhdGNoRXZlbnQoZWwsIHJhd05hbWUsIHByZXZWYWx1ZSwgbmV4dFZhbHVlLCBpbnN0YW5jZSA9IG51bGwpIHtcclxuICAgIC8vIHZlaSA9IHZ1ZSBldmVudCBpbnZva2Vyc1xyXG4gICAgY29uc3QgaW52b2tlcnMgPSBlbC5fdmVpIHx8IChlbC5fdmVpID0ge30pO1xyXG4gICAgY29uc3QgZXhpc3RpbmdJbnZva2VyID0gaW52b2tlcnNbcmF3TmFtZV07XHJcbiAgICBpZiAobmV4dFZhbHVlICYmIGV4aXN0aW5nSW52b2tlcikge1xyXG4gICAgICAgIC8vIHBhdGNoXHJcbiAgICAgICAgZXhpc3RpbmdJbnZva2VyLnZhbHVlID0gbmV4dFZhbHVlO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgY29uc3QgW25hbWUsIG9wdGlvbnNdID0gcGFyc2VOYW1lKHJhd05hbWUpO1xyXG4gICAgICAgIGlmIChuZXh0VmFsdWUpIHtcclxuICAgICAgICAgICAgLy8gYWRkXHJcbiAgICAgICAgICAgIGNvbnN0IGludm9rZXIgPSAoaW52b2tlcnNbcmF3TmFtZV0gPSBjcmVhdGVJbnZva2VyKG5leHRWYWx1ZSwgaW5zdGFuY2UpKTtcclxuICAgICAgICAgICAgYWRkRXZlbnRMaXN0ZW5lcihlbCwgbmFtZSwgaW52b2tlciwgb3B0aW9ucyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGV4aXN0aW5nSW52b2tlcikge1xyXG4gICAgICAgICAgICAvLyByZW1vdmVcclxuICAgICAgICAgICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcihlbCwgbmFtZSwgZXhpc3RpbmdJbnZva2VyLCBvcHRpb25zKTtcclxuICAgICAgICAgICAgaW52b2tlcnNbcmF3TmFtZV0gPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbmNvbnN0IG9wdGlvbnNNb2RpZmllclJFID0gLyg/Ok9uY2V8UGFzc2l2ZXxDYXB0dXJlKSQvO1xyXG5mdW5jdGlvbiBwYXJzZU5hbWUobmFtZSkge1xyXG4gICAgbGV0IG9wdGlvbnM7XHJcbiAgICBpZiAob3B0aW9uc01vZGlmaWVyUkUudGVzdChuYW1lKSkge1xyXG4gICAgICAgIG9wdGlvbnMgPSB7fTtcclxuICAgICAgICBsZXQgbTtcclxuICAgICAgICB3aGlsZSAoKG0gPSBuYW1lLm1hdGNoKG9wdGlvbnNNb2RpZmllclJFKSkpIHtcclxuICAgICAgICAgICAgbmFtZSA9IG5hbWUuc2xpY2UoMCwgbmFtZS5sZW5ndGggLSBtWzBdLmxlbmd0aCk7XHJcbiAgICAgICAgICAgIG9wdGlvbnNbbVswXS50b0xvd2VyQ2FzZSgpXSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIFtoeXBoZW5hdGUobmFtZS5zbGljZSgyKSksIG9wdGlvbnNdO1xyXG59XHJcbmZ1bmN0aW9uIGNyZWF0ZUludm9rZXIoaW5pdGlhbFZhbHVlLCBpbnN0YW5jZSkge1xyXG4gICAgY29uc3QgaW52b2tlciA9IChlKSA9PiB7XHJcbiAgICAgICAgLy8gYXN5bmMgZWRnZSBjYXNlICM2NTY2OiBpbm5lciBjbGljayBldmVudCB0cmlnZ2VycyBwYXRjaCwgZXZlbnQgaGFuZGxlclxyXG4gICAgICAgIC8vIGF0dGFjaGVkIHRvIG91dGVyIGVsZW1lbnQgZHVyaW5nIHBhdGNoLCBhbmQgdHJpZ2dlcmVkIGFnYWluLiBUaGlzXHJcbiAgICAgICAgLy8gaGFwcGVucyBiZWNhdXNlIGJyb3dzZXJzIGZpcmUgbWljcm90YXNrIHRpY2tzIGJldHdlZW4gZXZlbnQgcHJvcGFnYXRpb24uXHJcbiAgICAgICAgLy8gdGhlIHNvbHV0aW9uIGlzIHNpbXBsZTogd2Ugc2F2ZSB0aGUgdGltZXN0YW1wIHdoZW4gYSBoYW5kbGVyIGlzIGF0dGFjaGVkLFxyXG4gICAgICAgIC8vIGFuZCB0aGUgaGFuZGxlciB3b3VsZCBvbmx5IGZpcmUgaWYgdGhlIGV2ZW50IHBhc3NlZCB0byBpdCB3YXMgZmlyZWRcclxuICAgICAgICAvLyBBRlRFUiBpdCB3YXMgYXR0YWNoZWQuXHJcbiAgICAgICAgY29uc3QgdGltZVN0YW1wID0gZS50aW1lU3RhbXAgfHwgX2dldE5vdygpO1xyXG4gICAgICAgIGlmIChza2lwVGltZXN0YW1wQ2hlY2sgfHwgdGltZVN0YW1wID49IGludm9rZXIuYXR0YWNoZWQgLSAxKSB7XHJcbiAgICAgICAgICAgIGNhbGxXaXRoQXN5bmNFcnJvckhhbmRsaW5nKHBhdGNoU3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKGUsIGludm9rZXIudmFsdWUpLCBpbnN0YW5jZSwgNSAvKiBOQVRJVkVfRVZFTlRfSEFORExFUiAqLywgW2VdKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgaW52b2tlci52YWx1ZSA9IGluaXRpYWxWYWx1ZTtcclxuICAgIGludm9rZXIuYXR0YWNoZWQgPSBnZXROb3coKTtcclxuICAgIHJldHVybiBpbnZva2VyO1xyXG59XHJcbmZ1bmN0aW9uIHBhdGNoU3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKGUsIHZhbHVlKSB7XHJcbiAgICBpZiAoaXNBcnJheSh2YWx1ZSkpIHtcclxuICAgICAgICBjb25zdCBvcmlnaW5hbFN0b3AgPSBlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbjtcclxuICAgICAgICBlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbiA9ICgpID0+IHtcclxuICAgICAgICAgICAgb3JpZ2luYWxTdG9wLmNhbGwoZSk7XHJcbiAgICAgICAgICAgIGUuX3N0b3BwZWQgPSB0cnVlO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIHZhbHVlLm1hcChmbiA9PiAoZSkgPT4gIWUuX3N0b3BwZWQgJiYgZm4gJiYgZm4oZSkpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgfVxyXG59XG5cbmNvbnN0IG5hdGl2ZU9uUkUgPSAvXm9uW2Etel0vO1xyXG5jb25zdCBwYXRjaFByb3AgPSAoZWwsIGtleSwgcHJldlZhbHVlLCBuZXh0VmFsdWUsIGlzU1ZHID0gZmFsc2UsIHByZXZDaGlsZHJlbiwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgdW5tb3VudENoaWxkcmVuKSA9PiB7XHJcbiAgICBpZiAoa2V5ID09PSAnY2xhc3MnKSB7XHJcbiAgICAgICAgcGF0Y2hDbGFzcyhlbCwgbmV4dFZhbHVlLCBpc1NWRyk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChrZXkgPT09ICdzdHlsZScpIHtcclxuICAgICAgICBwYXRjaFN0eWxlKGVsLCBwcmV2VmFsdWUsIG5leHRWYWx1ZSk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChpc09uKGtleSkpIHtcclxuICAgICAgICAvLyBpZ25vcmUgdi1tb2RlbCBsaXN0ZW5lcnNcclxuICAgICAgICBpZiAoIWlzTW9kZWxMaXN0ZW5lcihrZXkpKSB7XHJcbiAgICAgICAgICAgIHBhdGNoRXZlbnQoZWwsIGtleSwgcHJldlZhbHVlLCBuZXh0VmFsdWUsIHBhcmVudENvbXBvbmVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoa2V5WzBdID09PSAnLidcclxuICAgICAgICA/ICgoa2V5ID0ga2V5LnNsaWNlKDEpKSwgdHJ1ZSlcclxuICAgICAgICA6IGtleVswXSA9PT0gJ14nXHJcbiAgICAgICAgICAgID8gKChrZXkgPSBrZXkuc2xpY2UoMSkpLCBmYWxzZSlcclxuICAgICAgICAgICAgOiBzaG91bGRTZXRBc1Byb3AoZWwsIGtleSwgbmV4dFZhbHVlLCBpc1NWRykpIHtcclxuICAgICAgICBwYXRjaERPTVByb3AoZWwsIGtleSwgbmV4dFZhbHVlLCBwcmV2Q2hpbGRyZW4sIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIHVubW91bnRDaGlsZHJlbik7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICAvLyBzcGVjaWFsIGNhc2UgZm9yIDxpbnB1dCB2LW1vZGVsIHR5cGU9XCJjaGVja2JveFwiPiB3aXRoXHJcbiAgICAgICAgLy8gOnRydWUtdmFsdWUgJiA6ZmFsc2UtdmFsdWVcclxuICAgICAgICAvLyBzdG9yZSB2YWx1ZSBhcyBkb20gcHJvcGVydGllcyBzaW5jZSBub24tc3RyaW5nIHZhbHVlcyB3aWxsIGJlXHJcbiAgICAgICAgLy8gc3RyaW5naWZpZWQuXHJcbiAgICAgICAgaWYgKGtleSA9PT0gJ3RydWUtdmFsdWUnKSB7XHJcbiAgICAgICAgICAgIGVsLl90cnVlVmFsdWUgPSBuZXh0VmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGtleSA9PT0gJ2ZhbHNlLXZhbHVlJykge1xyXG4gICAgICAgICAgICBlbC5fZmFsc2VWYWx1ZSA9IG5leHRWYWx1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcGF0Y2hBdHRyKGVsLCBrZXksIG5leHRWYWx1ZSwgaXNTVkcpO1xyXG4gICAgfVxyXG59O1xyXG5mdW5jdGlvbiBzaG91bGRTZXRBc1Byb3AoZWwsIGtleSwgdmFsdWUsIGlzU1ZHKSB7XHJcbiAgICBpZiAoaXNTVkcpIHtcclxuICAgICAgICAvLyBtb3N0IGtleXMgbXVzdCBiZSBzZXQgYXMgYXR0cmlidXRlIG9uIHN2ZyBlbGVtZW50cyB0byB3b3JrXHJcbiAgICAgICAgLy8gLi4uZXhjZXB0IGlubmVySFRNTCAmIHRleHRDb250ZW50XHJcbiAgICAgICAgaWYgKGtleSA9PT0gJ2lubmVySFRNTCcgfHwga2V5ID09PSAndGV4dENvbnRlbnQnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBvciBuYXRpdmUgb25jbGljayB3aXRoIGZ1bmN0aW9uIHZhbHVlc1xyXG4gICAgICAgIGlmIChrZXkgaW4gZWwgJiYgbmF0aXZlT25SRS50ZXN0KGtleSkgJiYgaXNGdW5jdGlvbih2YWx1ZSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIC8vIHNwZWxsY2hlY2sgYW5kIGRyYWdnYWJsZSBhcmUgbnVtZXJhdGVkIGF0dHJzLCBob3dldmVyIHRoZWlyXHJcbiAgICAvLyBjb3JyZXNwb25kaW5nIERPTSBwcm9wZXJ0aWVzIGFyZSBhY3R1YWxseSBib29sZWFucyAtIHRoaXMgbGVhZHMgdG9cclxuICAgIC8vIHNldHRpbmcgaXQgd2l0aCBhIHN0cmluZyBcImZhbHNlXCIgdmFsdWUgbGVhZGluZyBpdCB0byBiZSBjb2VyY2VkIHRvXHJcbiAgICAvLyBgdHJ1ZWAsIHNvIHdlIG5lZWQgdG8gYWx3YXlzIHRyZWF0IHRoZW0gYXMgYXR0cmlidXRlcy5cclxuICAgIC8vIE5vdGUgdGhhdCBgY29udGVudEVkaXRhYmxlYCBkb2Vzbid0IGhhdmUgdGhpcyBwcm9ibGVtOiBpdHMgRE9NXHJcbiAgICAvLyBwcm9wZXJ0eSBpcyBhbHNvIGVudW1lcmF0ZWQgc3RyaW5nIHZhbHVlcy5cclxuICAgIGlmIChrZXkgPT09ICdzcGVsbGNoZWNrJyB8fCBrZXkgPT09ICdkcmFnZ2FibGUnKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgLy8gIzE3ODcsICMyODQwIGZvcm0gcHJvcGVydHkgb24gZm9ybSBlbGVtZW50cyBpcyByZWFkb25seSBhbmQgbXVzdCBiZSBzZXQgYXNcclxuICAgIC8vIGF0dHJpYnV0ZS5cclxuICAgIGlmIChrZXkgPT09ICdmb3JtJykge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIC8vICMxNTI2IDxpbnB1dCBsaXN0PiBtdXN0IGJlIHNldCBhcyBhdHRyaWJ1dGVcclxuICAgIGlmIChrZXkgPT09ICdsaXN0JyAmJiBlbC50YWdOYW1lID09PSAnSU5QVVQnKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgLy8gIzI3NjYgPHRleHRhcmVhIHR5cGU+IG11c3QgYmUgc2V0IGFzIGF0dHJpYnV0ZVxyXG4gICAgaWYgKGtleSA9PT0gJ3R5cGUnICYmIGVsLnRhZ05hbWUgPT09ICdURVhUQVJFQScpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICAvLyBuYXRpdmUgb25jbGljayB3aXRoIHN0cmluZyB2YWx1ZSwgbXVzdCBiZSBzZXQgYXMgYXR0cmlidXRlXHJcbiAgICBpZiAobmF0aXZlT25SRS50ZXN0KGtleSkgJiYgaXNTdHJpbmcodmFsdWUpKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGtleSBpbiBlbDtcclxufVxuXG5mdW5jdGlvbiBkZWZpbmVDdXN0b21FbGVtZW50KG9wdGlvbnMsIGh5ZGF0ZSkge1xyXG4gICAgY29uc3QgQ29tcCA9IGRlZmluZUNvbXBvbmVudChvcHRpb25zKTtcclxuICAgIGNsYXNzIFZ1ZUN1c3RvbUVsZW1lbnQgZXh0ZW5kcyBWdWVFbGVtZW50IHtcclxuICAgICAgICBjb25zdHJ1Y3Rvcihpbml0aWFsUHJvcHMpIHtcclxuICAgICAgICAgICAgc3VwZXIoQ29tcCwgaW5pdGlhbFByb3BzLCBoeWRhdGUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFZ1ZUN1c3RvbUVsZW1lbnQuZGVmID0gQ29tcDtcclxuICAgIHJldHVybiBWdWVDdXN0b21FbGVtZW50O1xyXG59XHJcbmNvbnN0IGRlZmluZVNTUkN1c3RvbUVsZW1lbnQgPSAoKG9wdGlvbnMpID0+IHtcclxuICAgIC8vIEB0cy1pZ25vcmVcclxuICAgIHJldHVybiBkZWZpbmVDdXN0b21FbGVtZW50KG9wdGlvbnMsIGh5ZHJhdGUpO1xyXG59KTtcclxuY29uc3QgQmFzZUNsYXNzID0gKHR5cGVvZiBIVE1MRWxlbWVudCAhPT0gJ3VuZGVmaW5lZCcgPyBIVE1MRWxlbWVudCA6IGNsYXNzIHtcclxufSk7XHJcbmNsYXNzIFZ1ZUVsZW1lbnQgZXh0ZW5kcyBCYXNlQ2xhc3Mge1xyXG4gICAgY29uc3RydWN0b3IoX2RlZiwgX3Byb3BzID0ge30sIGh5ZHJhdGUpIHtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgICAgIHRoaXMuX2RlZiA9IF9kZWY7XHJcbiAgICAgICAgdGhpcy5fcHJvcHMgPSBfcHJvcHM7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGludGVybmFsXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5faW5zdGFuY2UgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuX2Nvbm5lY3RlZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX3Jlc29sdmVkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fbnVtYmVyUHJvcHMgPSBudWxsO1xyXG4gICAgICAgIGlmICh0aGlzLnNoYWRvd1Jvb3QgJiYgaHlkcmF0ZSkge1xyXG4gICAgICAgICAgICBoeWRyYXRlKHRoaXMuX2NyZWF0ZVZOb2RlKCksIHRoaXMuc2hhZG93Um9vdCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmIHRoaXMuc2hhZG93Um9vdCkge1xyXG4gICAgICAgICAgICAgICAgd2FybihgQ3VzdG9tIGVsZW1lbnQgaGFzIHByZS1yZW5kZXJlZCBkZWNsYXJhdGl2ZSBzaGFkb3cgcm9vdCBidXQgaXMgbm90IGAgK1xyXG4gICAgICAgICAgICAgICAgICAgIGBkZWZpbmVkIGFzIGh5ZHJhdGFibGUuIFVzZSBcXGBkZWZpbmVTU1JDdXN0b21FbGVtZW50XFxgLmApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuYXR0YWNoU2hhZG93KHsgbW9kZTogJ29wZW4nIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGNvbm5lY3RlZENhbGxiYWNrKCkge1xyXG4gICAgICAgIHRoaXMuX2Nvbm5lY3RlZCA9IHRydWU7XHJcbiAgICAgICAgaWYgKCF0aGlzLl9pbnN0YW5jZSkge1xyXG4gICAgICAgICAgICB0aGlzLl9yZXNvbHZlRGVmKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZGlzY29ubmVjdGVkQ2FsbGJhY2soKSB7XHJcbiAgICAgICAgdGhpcy5fY29ubmVjdGVkID0gZmFsc2U7XHJcbiAgICAgICAgbmV4dFRpY2soKCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuX2Nvbm5lY3RlZCkge1xyXG4gICAgICAgICAgICAgICAgcmVuZGVyKG51bGwsIHRoaXMuc2hhZG93Um9vdCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9pbnN0YW5jZSA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogcmVzb2x2ZSBpbm5lciBjb21wb25lbnQgZGVmaW5pdGlvbiAoaGFuZGxlIHBvc3NpYmxlIGFzeW5jIGNvbXBvbmVudClcclxuICAgICAqL1xyXG4gICAgX3Jlc29sdmVEZWYoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX3Jlc29sdmVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fcmVzb2x2ZWQgPSB0cnVlO1xyXG4gICAgICAgIC8vIHNldCBpbml0aWFsIGF0dHJzXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmF0dHJpYnV0ZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdGhpcy5fc2V0QXR0cih0aGlzLmF0dHJpYnV0ZXNbaV0ubmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIHdhdGNoIGZ1dHVyZSBhdHRyIGNoYW5nZXNcclxuICAgICAgICBuZXcgTXV0YXRpb25PYnNlcnZlcihtdXRhdGlvbnMgPT4ge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IG0gb2YgbXV0YXRpb25zKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zZXRBdHRyKG0uYXR0cmlidXRlTmFtZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KS5vYnNlcnZlKHRoaXMsIHsgYXR0cmlidXRlczogdHJ1ZSB9KTtcclxuICAgICAgICBjb25zdCByZXNvbHZlID0gKGRlZikgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB7IHByb3BzLCBzdHlsZXMgfSA9IGRlZjtcclxuICAgICAgICAgICAgY29uc3QgaGFzT3B0aW9ucyA9ICFpc0FycmF5KHByb3BzKTtcclxuICAgICAgICAgICAgY29uc3QgcmF3S2V5cyA9IHByb3BzID8gKGhhc09wdGlvbnMgPyBPYmplY3Qua2V5cyhwcm9wcykgOiBwcm9wcykgOiBbXTtcclxuICAgICAgICAgICAgLy8gY2FzdCBOdW1iZXItdHlwZSBwcm9wcyBzZXQgYmVmb3JlIHJlc29sdmVcclxuICAgICAgICAgICAgbGV0IG51bWJlclByb3BzO1xyXG4gICAgICAgICAgICBpZiAoaGFzT3B0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gdGhpcy5fcHJvcHMpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBvcHQgPSBwcm9wc1trZXldO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcHQgPT09IE51bWJlciB8fCAob3B0ICYmIG9wdC50eXBlID09PSBOdW1iZXIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3Byb3BzW2tleV0gPSB0b051bWJlcih0aGlzLl9wcm9wc1trZXldKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgKG51bWJlclByb3BzIHx8IChudW1iZXJQcm9wcyA9IE9iamVjdC5jcmVhdGUobnVsbCkpKVtrZXldID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5fbnVtYmVyUHJvcHMgPSBudW1iZXJQcm9wcztcclxuICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlcmUgYXJlIHByb3BzIHNldCBwcmUtdXBncmFkZSBvciBjb25uZWN0XHJcbiAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IG9mIE9iamVjdC5rZXlzKHRoaXMpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoa2V5WzBdICE9PSAnXycpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZXRQcm9wKGtleSwgdGhpc1trZXldLCB0cnVlLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gZGVmaW5pbmcgZ2V0dGVyL3NldHRlcnMgb24gcHJvdG90eXBlXHJcbiAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IG9mIHJhd0tleXMubWFwKGNhbWVsaXplJDEpKSB7XHJcbiAgICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywga2V5LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgZ2V0KCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZ2V0UHJvcChrZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgc2V0KHZhbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZXRQcm9wKGtleSwgdmFsKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBhcHBseSBDU1NcclxuICAgICAgICAgICAgdGhpcy5fYXBwbHlTdHlsZXMoc3R5bGVzKTtcclxuICAgICAgICAgICAgLy8gaW5pdGlhbCByZW5kZXJcclxuICAgICAgICAgICAgdGhpcy5fdXBkYXRlKCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBjb25zdCBhc3luY0RlZiA9IHRoaXMuX2RlZi5fX2FzeW5jTG9hZGVyO1xyXG4gICAgICAgIGlmIChhc3luY0RlZikge1xyXG4gICAgICAgICAgICBhc3luY0RlZigpLnRoZW4ocmVzb2x2ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXNvbHZlKHRoaXMuX2RlZik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgX3NldEF0dHIoa2V5KSB7XHJcbiAgICAgICAgbGV0IHZhbHVlID0gdGhpcy5nZXRBdHRyaWJ1dGUoa2V5KTtcclxuICAgICAgICBpZiAodGhpcy5fbnVtYmVyUHJvcHMgJiYgdGhpcy5fbnVtYmVyUHJvcHNba2V5XSkge1xyXG4gICAgICAgICAgICB2YWx1ZSA9IHRvTnVtYmVyKHZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fc2V0UHJvcChjYW1lbGl6ZSQxKGtleSksIHZhbHVlLCBmYWxzZSk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEBpbnRlcm5hbFxyXG4gICAgICovXHJcbiAgICBfZ2V0UHJvcChrZXkpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fcHJvcHNba2V5XTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQGludGVybmFsXHJcbiAgICAgKi9cclxuICAgIF9zZXRQcm9wKGtleSwgdmFsLCBzaG91bGRSZWZsZWN0ID0gdHJ1ZSwgc2hvdWxkVXBkYXRlID0gdHJ1ZSkge1xyXG4gICAgICAgIGlmICh2YWwgIT09IHRoaXMuX3Byb3BzW2tleV0pIHtcclxuICAgICAgICAgICAgdGhpcy5fcHJvcHNba2V5XSA9IHZhbDtcclxuICAgICAgICAgICAgaWYgKHNob3VsZFVwZGF0ZSAmJiB0aGlzLl9pbnN0YW5jZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gcmVmbGVjdFxyXG4gICAgICAgICAgICBpZiAoc2hvdWxkUmVmbGVjdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHZhbCA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0QXR0cmlidXRlKGh5cGhlbmF0ZShrZXkpLCAnJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0eXBlb2YgdmFsID09PSAnc3RyaW5nJyB8fCB0eXBlb2YgdmFsID09PSAnbnVtYmVyJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0QXR0cmlidXRlKGh5cGhlbmF0ZShrZXkpLCB2YWwgKyAnJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmICghdmFsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVBdHRyaWJ1dGUoaHlwaGVuYXRlKGtleSkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgX3VwZGF0ZSgpIHtcclxuICAgICAgICByZW5kZXIodGhpcy5fY3JlYXRlVk5vZGUoKSwgdGhpcy5zaGFkb3dSb290KTtcclxuICAgIH1cclxuICAgIF9jcmVhdGVWTm9kZSgpIHtcclxuICAgICAgICBjb25zdCB2bm9kZSA9IGNyZWF0ZVZOb2RlKHRoaXMuX2RlZiwgZXh0ZW5kKHt9LCB0aGlzLl9wcm9wcykpO1xyXG4gICAgICAgIGlmICghdGhpcy5faW5zdGFuY2UpIHtcclxuICAgICAgICAgICAgdm5vZGUuY2UgPSBpbnN0YW5jZSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9pbnN0YW5jZSA9IGluc3RhbmNlO1xyXG4gICAgICAgICAgICAgICAgaW5zdGFuY2UuaXNDRSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAvLyBITVJcclxuICAgICAgICAgICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZS5jZVJlbG9hZCA9IG5ld1N0eWxlcyA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFsd2F5cyByZXNldCBzdHlsZXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX3N0eWxlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3R5bGVzLmZvckVhY2gocyA9PiB0aGlzLnNoYWRvd1Jvb3QucmVtb3ZlQ2hpbGQocykpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3R5bGVzLmxlbmd0aCA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fYXBwbHlTdHlsZXMobmV3U3R5bGVzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWYgdGhpcyBpcyBhbiBhc3luYyBjb21wb25lbnQsIGNlUmVsb2FkIGlzIGNhbGxlZCBmcm9tIHRoZSBpbm5lclxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBjb21wb25lbnQgc28gbm8gbmVlZCB0byByZWxvYWQgdGhlIGFzeW5jIHdyYXBwZXJcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9kZWYuX19hc3luY0xvYWRlcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVsb2FkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9pbnN0YW5jZSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl91cGRhdGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyBpbnRlcmNlcHQgZW1pdFxyXG4gICAgICAgICAgICAgICAgaW5zdGFuY2UuZW1pdCA9IChldmVudCwgLi4uYXJncykgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoZXZlbnQsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiBhcmdzXHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIC8vIGxvY2F0ZSBuZWFyZXN0IFZ1ZSBjdXN0b20gZWxlbWVudCBwYXJlbnQgZm9yIHByb3ZpZGUvaW5qZWN0XHJcbiAgICAgICAgICAgICAgICBsZXQgcGFyZW50ID0gdGhpcztcclxuICAgICAgICAgICAgICAgIHdoaWxlICgocGFyZW50ID1cclxuICAgICAgICAgICAgICAgICAgICBwYXJlbnQgJiYgKHBhcmVudC5wYXJlbnROb2RlIHx8IHBhcmVudC5ob3N0KSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocGFyZW50IGluc3RhbmNlb2YgVnVlRWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZS5wYXJlbnQgPSBwYXJlbnQuX2luc3RhbmNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB2bm9kZTtcclxuICAgIH1cclxuICAgIF9hcHBseVN0eWxlcyhzdHlsZXMpIHtcclxuICAgICAgICBpZiAoc3R5bGVzKSB7XHJcbiAgICAgICAgICAgIHN0eWxlcy5mb3JFYWNoKGNzcyA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTtcclxuICAgICAgICAgICAgICAgIHMudGV4dENvbnRlbnQgPSBjc3M7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNoYWRvd1Jvb3QuYXBwZW5kQ2hpbGQocyk7XHJcbiAgICAgICAgICAgICAgICAvLyByZWNvcmQgZm9yIEhNUlxyXG4gICAgICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICh0aGlzLl9zdHlsZXMgfHwgKHRoaXMuX3N0eWxlcyA9IFtdKSkucHVzaChzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XG5cbmZ1bmN0aW9uIHVzZUNzc01vZHVsZShuYW1lID0gJyRzdHlsZScpIHtcclxuICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBlbHNlICovXHJcbiAgICB7XHJcbiAgICAgICAgY29uc3QgaW5zdGFuY2UgPSBnZXRDdXJyZW50SW5zdGFuY2UoKTtcclxuICAgICAgICBpZiAoIWluc3RhbmNlKSB7XHJcbiAgICAgICAgICAgIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiB3YXJuKGB1c2VDc3NNb2R1bGUgbXVzdCBiZSBjYWxsZWQgaW5zaWRlIHNldHVwKClgKTtcclxuICAgICAgICAgICAgcmV0dXJuIEVNUFRZX09CSjtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgbW9kdWxlcyA9IGluc3RhbmNlLnR5cGUuX19jc3NNb2R1bGVzO1xyXG4gICAgICAgIGlmICghbW9kdWxlcykge1xyXG4gICAgICAgICAgICAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiYgd2FybihgQ3VycmVudCBpbnN0YW5jZSBkb2VzIG5vdCBoYXZlIENTUyBtb2R1bGVzIGluamVjdGVkLmApO1xyXG4gICAgICAgICAgICByZXR1cm4gRU1QVFlfT0JKO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBtb2QgPSBtb2R1bGVzW25hbWVdO1xyXG4gICAgICAgIGlmICghbW9kKSB7XHJcbiAgICAgICAgICAgIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJlxyXG4gICAgICAgICAgICAgICAgd2FybihgQ3VycmVudCBpbnN0YW5jZSBkb2VzIG5vdCBoYXZlIENTUyBtb2R1bGUgbmFtZWQgXCIke25hbWV9XCIuYCk7XHJcbiAgICAgICAgICAgIHJldHVybiBFTVBUWV9PQko7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBtb2Q7XHJcbiAgICB9XHJcbn1cblxuLyoqXHJcbiAqIFJ1bnRpbWUgaGVscGVyIGZvciBTRkMncyBDU1MgdmFyaWFibGUgaW5qZWN0aW9uIGZlYXR1cmUuXHJcbiAqIEBwcml2YXRlXHJcbiAqL1xyXG5mdW5jdGlvbiB1c2VDc3NWYXJzKGdldHRlcikge1xyXG4gICAgY29uc3QgaW5zdGFuY2UgPSBnZXRDdXJyZW50SW5zdGFuY2UoKTtcclxuICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXHJcbiAgICBpZiAoIWluc3RhbmNlKSB7XHJcbiAgICAgICAgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmXHJcbiAgICAgICAgICAgIHdhcm4oYHVzZUNzc1ZhcnMgaXMgY2FsbGVkIHdpdGhvdXQgY3VycmVudCBhY3RpdmUgY29tcG9uZW50IGluc3RhbmNlLmApO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IHNldFZhcnMgPSAoKSA9PiBzZXRWYXJzT25WTm9kZShpbnN0YW5jZS5zdWJUcmVlLCBnZXR0ZXIoaW5zdGFuY2UucHJveHkpKTtcclxuICAgIHdhdGNoUG9zdEVmZmVjdChzZXRWYXJzKTtcclxuICAgIG9uTW91bnRlZCgoKSA9PiB7XHJcbiAgICAgICAgY29uc3Qgb2IgPSBuZXcgTXV0YXRpb25PYnNlcnZlcihzZXRWYXJzKTtcclxuICAgICAgICBvYi5vYnNlcnZlKGluc3RhbmNlLnN1YlRyZWUuZWwucGFyZW50Tm9kZSwgeyBjaGlsZExpc3Q6IHRydWUgfSk7XHJcbiAgICAgICAgb25Vbm1vdW50ZWQoKCkgPT4gb2IuZGlzY29ubmVjdCgpKTtcclxuICAgIH0pO1xyXG59XHJcbmZ1bmN0aW9uIHNldFZhcnNPblZOb2RlKHZub2RlLCB2YXJzKSB7XHJcbiAgICBpZiAodm5vZGUuc2hhcGVGbGFnICYgMTI4IC8qIFNVU1BFTlNFICovKSB7XHJcbiAgICAgICAgY29uc3Qgc3VzcGVuc2UgPSB2bm9kZS5zdXNwZW5zZTtcclxuICAgICAgICB2bm9kZSA9IHN1c3BlbnNlLmFjdGl2ZUJyYW5jaDtcclxuICAgICAgICBpZiAoc3VzcGVuc2UucGVuZGluZ0JyYW5jaCAmJiAhc3VzcGVuc2UuaXNIeWRyYXRpbmcpIHtcclxuICAgICAgICAgICAgc3VzcGVuc2UuZWZmZWN0cy5wdXNoKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHNldFZhcnNPblZOb2RlKHN1c3BlbnNlLmFjdGl2ZUJyYW5jaCwgdmFycyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8vIGRyaWxsIGRvd24gSE9DcyB1bnRpbCBpdCdzIGEgbm9uLWNvbXBvbmVudCB2bm9kZVxyXG4gICAgd2hpbGUgKHZub2RlLmNvbXBvbmVudCkge1xyXG4gICAgICAgIHZub2RlID0gdm5vZGUuY29tcG9uZW50LnN1YlRyZWU7XHJcbiAgICB9XHJcbiAgICBpZiAodm5vZGUuc2hhcGVGbGFnICYgMSAvKiBFTEVNRU5UICovICYmIHZub2RlLmVsKSB7XHJcbiAgICAgICAgc2V0VmFyc09uTm9kZSh2bm9kZS5lbCwgdmFycyk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICh2bm9kZS50eXBlID09PSBGcmFnbWVudCkge1xyXG4gICAgICAgIHZub2RlLmNoaWxkcmVuLmZvckVhY2goYyA9PiBzZXRWYXJzT25WTm9kZShjLCB2YXJzKSk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICh2bm9kZS50eXBlID09PSBTdGF0aWMpIHtcclxuICAgICAgICBsZXQgeyBlbCwgYW5jaG9yIH0gPSB2bm9kZTtcclxuICAgICAgICB3aGlsZSAoZWwpIHtcclxuICAgICAgICAgICAgc2V0VmFyc09uTm9kZShlbCwgdmFycyk7XHJcbiAgICAgICAgICAgIGlmIChlbCA9PT0gYW5jaG9yKVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGVsID0gZWwubmV4dFNpYmxpbmc7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHNldFZhcnNPbk5vZGUoZWwsIHZhcnMpIHtcclxuICAgIGlmIChlbC5ub2RlVHlwZSA9PT0gMSkge1xyXG4gICAgICAgIGNvbnN0IHN0eWxlID0gZWwuc3R5bGU7XHJcbiAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gdmFycykge1xyXG4gICAgICAgICAgICBzdHlsZS5zZXRQcm9wZXJ0eShgLS0ke2tleX1gLCB2YXJzW2tleV0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxuXG5jb25zdCBUUkFOU0lUSU9OID0gJ3RyYW5zaXRpb24nO1xyXG5jb25zdCBBTklNQVRJT04gPSAnYW5pbWF0aW9uJztcclxuLy8gRE9NIFRyYW5zaXRpb24gaXMgYSBoaWdoZXItb3JkZXItY29tcG9uZW50IGJhc2VkIG9uIHRoZSBwbGF0Zm9ybS1hZ25vc3RpY1xyXG4vLyBiYXNlIFRyYW5zaXRpb24gY29tcG9uZW50LCB3aXRoIERPTS1zcGVjaWZpYyBsb2dpYy5cclxuY29uc3QgVHJhbnNpdGlvbiA9IChwcm9wcywgeyBzbG90cyB9KSA9PiBoKEJhc2VUcmFuc2l0aW9uLCByZXNvbHZlVHJhbnNpdGlvblByb3BzKHByb3BzKSwgc2xvdHMpO1xyXG5UcmFuc2l0aW9uLmRpc3BsYXlOYW1lID0gJ1RyYW5zaXRpb24nO1xyXG5jb25zdCBET01UcmFuc2l0aW9uUHJvcHNWYWxpZGF0b3JzID0ge1xyXG4gICAgbmFtZTogU3RyaW5nLFxyXG4gICAgdHlwZTogU3RyaW5nLFxyXG4gICAgY3NzOiB7XHJcbiAgICAgICAgdHlwZTogQm9vbGVhbixcclxuICAgICAgICBkZWZhdWx0OiB0cnVlXHJcbiAgICB9LFxyXG4gICAgZHVyYXRpb246IFtTdHJpbmcsIE51bWJlciwgT2JqZWN0XSxcclxuICAgIGVudGVyRnJvbUNsYXNzOiBTdHJpbmcsXHJcbiAgICBlbnRlckFjdGl2ZUNsYXNzOiBTdHJpbmcsXHJcbiAgICBlbnRlclRvQ2xhc3M6IFN0cmluZyxcclxuICAgIGFwcGVhckZyb21DbGFzczogU3RyaW5nLFxyXG4gICAgYXBwZWFyQWN0aXZlQ2xhc3M6IFN0cmluZyxcclxuICAgIGFwcGVhclRvQ2xhc3M6IFN0cmluZyxcclxuICAgIGxlYXZlRnJvbUNsYXNzOiBTdHJpbmcsXHJcbiAgICBsZWF2ZUFjdGl2ZUNsYXNzOiBTdHJpbmcsXHJcbiAgICBsZWF2ZVRvQ2xhc3M6IFN0cmluZ1xyXG59O1xyXG5jb25zdCBUcmFuc2l0aW9uUHJvcHNWYWxpZGF0b3JzID0gKFRyYW5zaXRpb24ucHJvcHMgPVxyXG4gICAgLyojX19QVVJFX18qLyBleHRlbmQoe30sIEJhc2VUcmFuc2l0aW9uLnByb3BzLCBET01UcmFuc2l0aW9uUHJvcHNWYWxpZGF0b3JzKSk7XHJcbi8qKlxyXG4gKiAjMzIyNyBJbmNvbWluZyBob29rcyBtYXkgYmUgbWVyZ2VkIGludG8gYXJyYXlzIHdoZW4gd3JhcHBpbmcgVHJhbnNpdGlvblxyXG4gKiB3aXRoIGN1c3RvbSBIT0NzLlxyXG4gKi9cclxuY29uc3QgY2FsbEhvb2sgPSAoaG9vaywgYXJncyA9IFtdKSA9PiB7XHJcbiAgICBpZiAoaXNBcnJheShob29rKSkge1xyXG4gICAgICAgIGhvb2suZm9yRWFjaChoID0+IGgoLi4uYXJncykpO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoaG9vaykge1xyXG4gICAgICAgIGhvb2soLi4uYXJncyk7XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKiBDaGVjayBpZiBhIGhvb2sgZXhwZWN0cyBhIGNhbGxiYWNrICgybmQgYXJnKSwgd2hpY2ggbWVhbnMgdGhlIHVzZXJcclxuICogaW50ZW5kcyB0byBleHBsaWNpdGx5IGNvbnRyb2wgdGhlIGVuZCBvZiB0aGUgdHJhbnNpdGlvbi5cclxuICovXHJcbmNvbnN0IGhhc0V4cGxpY2l0Q2FsbGJhY2sgPSAoaG9vaykgPT4ge1xyXG4gICAgcmV0dXJuIGhvb2tcclxuICAgICAgICA/IGlzQXJyYXkoaG9vaylcclxuICAgICAgICAgICAgPyBob29rLnNvbWUoaCA9PiBoLmxlbmd0aCA+IDEpXHJcbiAgICAgICAgICAgIDogaG9vay5sZW5ndGggPiAxXHJcbiAgICAgICAgOiBmYWxzZTtcclxufTtcclxuZnVuY3Rpb24gcmVzb2x2ZVRyYW5zaXRpb25Qcm9wcyhyYXdQcm9wcykge1xyXG4gICAgY29uc3QgYmFzZVByb3BzID0ge307XHJcbiAgICBmb3IgKGNvbnN0IGtleSBpbiByYXdQcm9wcykge1xyXG4gICAgICAgIGlmICghKGtleSBpbiBET01UcmFuc2l0aW9uUHJvcHNWYWxpZGF0b3JzKSkge1xyXG4gICAgICAgICAgICBiYXNlUHJvcHNba2V5XSA9IHJhd1Byb3BzW2tleV07XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYgKHJhd1Byb3BzLmNzcyA9PT0gZmFsc2UpIHtcclxuICAgICAgICByZXR1cm4gYmFzZVByb3BzO1xyXG4gICAgfVxyXG4gICAgY29uc3QgeyBuYW1lID0gJ3YnLCB0eXBlLCBkdXJhdGlvbiwgZW50ZXJGcm9tQ2xhc3MgPSBgJHtuYW1lfS1lbnRlci1mcm9tYCwgZW50ZXJBY3RpdmVDbGFzcyA9IGAke25hbWV9LWVudGVyLWFjdGl2ZWAsIGVudGVyVG9DbGFzcyA9IGAke25hbWV9LWVudGVyLXRvYCwgYXBwZWFyRnJvbUNsYXNzID0gZW50ZXJGcm9tQ2xhc3MsIGFwcGVhckFjdGl2ZUNsYXNzID0gZW50ZXJBY3RpdmVDbGFzcywgYXBwZWFyVG9DbGFzcyA9IGVudGVyVG9DbGFzcywgbGVhdmVGcm9tQ2xhc3MgPSBgJHtuYW1lfS1sZWF2ZS1mcm9tYCwgbGVhdmVBY3RpdmVDbGFzcyA9IGAke25hbWV9LWxlYXZlLWFjdGl2ZWAsIGxlYXZlVG9DbGFzcyA9IGAke25hbWV9LWxlYXZlLXRvYCB9ID0gcmF3UHJvcHM7XHJcbiAgICBjb25zdCBkdXJhdGlvbnMgPSBub3JtYWxpemVEdXJhdGlvbihkdXJhdGlvbik7XHJcbiAgICBjb25zdCBlbnRlckR1cmF0aW9uID0gZHVyYXRpb25zICYmIGR1cmF0aW9uc1swXTtcclxuICAgIGNvbnN0IGxlYXZlRHVyYXRpb24gPSBkdXJhdGlvbnMgJiYgZHVyYXRpb25zWzFdO1xyXG4gICAgY29uc3QgeyBvbkJlZm9yZUVudGVyLCBvbkVudGVyLCBvbkVudGVyQ2FuY2VsbGVkLCBvbkxlYXZlLCBvbkxlYXZlQ2FuY2VsbGVkLCBvbkJlZm9yZUFwcGVhciA9IG9uQmVmb3JlRW50ZXIsIG9uQXBwZWFyID0gb25FbnRlciwgb25BcHBlYXJDYW5jZWxsZWQgPSBvbkVudGVyQ2FuY2VsbGVkIH0gPSBiYXNlUHJvcHM7XHJcbiAgICBjb25zdCBmaW5pc2hFbnRlciA9IChlbCwgaXNBcHBlYXIsIGRvbmUpID0+IHtcclxuICAgICAgICByZW1vdmVUcmFuc2l0aW9uQ2xhc3MoZWwsIGlzQXBwZWFyID8gYXBwZWFyVG9DbGFzcyA6IGVudGVyVG9DbGFzcyk7XHJcbiAgICAgICAgcmVtb3ZlVHJhbnNpdGlvbkNsYXNzKGVsLCBpc0FwcGVhciA/IGFwcGVhckFjdGl2ZUNsYXNzIDogZW50ZXJBY3RpdmVDbGFzcyk7XHJcbiAgICAgICAgZG9uZSAmJiBkb25lKCk7XHJcbiAgICB9O1xyXG4gICAgY29uc3QgZmluaXNoTGVhdmUgPSAoZWwsIGRvbmUpID0+IHtcclxuICAgICAgICByZW1vdmVUcmFuc2l0aW9uQ2xhc3MoZWwsIGxlYXZlVG9DbGFzcyk7XHJcbiAgICAgICAgcmVtb3ZlVHJhbnNpdGlvbkNsYXNzKGVsLCBsZWF2ZUFjdGl2ZUNsYXNzKTtcclxuICAgICAgICBkb25lICYmIGRvbmUoKTtcclxuICAgIH07XHJcbiAgICBjb25zdCBtYWtlRW50ZXJIb29rID0gKGlzQXBwZWFyKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIChlbCwgZG9uZSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBob29rID0gaXNBcHBlYXIgPyBvbkFwcGVhciA6IG9uRW50ZXI7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlc29sdmUgPSAoKSA9PiBmaW5pc2hFbnRlcihlbCwgaXNBcHBlYXIsIGRvbmUpO1xyXG4gICAgICAgICAgICBjYWxsSG9vayhob29rLCBbZWwsIHJlc29sdmVdKTtcclxuICAgICAgICAgICAgbmV4dEZyYW1lKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHJlbW92ZVRyYW5zaXRpb25DbGFzcyhlbCwgaXNBcHBlYXIgPyBhcHBlYXJGcm9tQ2xhc3MgOiBlbnRlckZyb21DbGFzcyk7XHJcbiAgICAgICAgICAgICAgICBhZGRUcmFuc2l0aW9uQ2xhc3MoZWwsIGlzQXBwZWFyID8gYXBwZWFyVG9DbGFzcyA6IGVudGVyVG9DbGFzcyk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWhhc0V4cGxpY2l0Q2FsbGJhY2soaG9vaykpIHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVuVHJhbnNpdGlvbkVuZHMoZWwsIHR5cGUsIGVudGVyRHVyYXRpb24sIHJlc29sdmUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuICAgIHJldHVybiBleHRlbmQoYmFzZVByb3BzLCB7XHJcbiAgICAgICAgb25CZWZvcmVFbnRlcihlbCkge1xyXG4gICAgICAgICAgICBjYWxsSG9vayhvbkJlZm9yZUVudGVyLCBbZWxdKTtcclxuICAgICAgICAgICAgYWRkVHJhbnNpdGlvbkNsYXNzKGVsLCBlbnRlckZyb21DbGFzcyk7XHJcbiAgICAgICAgICAgIGFkZFRyYW5zaXRpb25DbGFzcyhlbCwgZW50ZXJBY3RpdmVDbGFzcyk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBvbkJlZm9yZUFwcGVhcihlbCkge1xyXG4gICAgICAgICAgICBjYWxsSG9vayhvbkJlZm9yZUFwcGVhciwgW2VsXSk7XHJcbiAgICAgICAgICAgIGFkZFRyYW5zaXRpb25DbGFzcyhlbCwgYXBwZWFyRnJvbUNsYXNzKTtcclxuICAgICAgICAgICAgYWRkVHJhbnNpdGlvbkNsYXNzKGVsLCBhcHBlYXJBY3RpdmVDbGFzcyk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBvbkVudGVyOiBtYWtlRW50ZXJIb29rKGZhbHNlKSxcclxuICAgICAgICBvbkFwcGVhcjogbWFrZUVudGVySG9vayh0cnVlKSxcclxuICAgICAgICBvbkxlYXZlKGVsLCBkb25lKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlc29sdmUgPSAoKSA9PiBmaW5pc2hMZWF2ZShlbCwgZG9uZSk7XHJcbiAgICAgICAgICAgIGFkZFRyYW5zaXRpb25DbGFzcyhlbCwgbGVhdmVGcm9tQ2xhc3MpO1xyXG4gICAgICAgICAgICAvLyBmb3JjZSByZWZsb3cgc28gKi1sZWF2ZS1mcm9tIGNsYXNzZXMgaW1tZWRpYXRlbHkgdGFrZSBlZmZlY3QgKCMyNTkzKVxyXG4gICAgICAgICAgICBmb3JjZVJlZmxvdygpO1xyXG4gICAgICAgICAgICBhZGRUcmFuc2l0aW9uQ2xhc3MoZWwsIGxlYXZlQWN0aXZlQ2xhc3MpO1xyXG4gICAgICAgICAgICBuZXh0RnJhbWUoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmVtb3ZlVHJhbnNpdGlvbkNsYXNzKGVsLCBsZWF2ZUZyb21DbGFzcyk7XHJcbiAgICAgICAgICAgICAgICBhZGRUcmFuc2l0aW9uQ2xhc3MoZWwsIGxlYXZlVG9DbGFzcyk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWhhc0V4cGxpY2l0Q2FsbGJhY2sob25MZWF2ZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVuVHJhbnNpdGlvbkVuZHMoZWwsIHR5cGUsIGxlYXZlRHVyYXRpb24sIHJlc29sdmUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgY2FsbEhvb2sob25MZWF2ZSwgW2VsLCByZXNvbHZlXSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBvbkVudGVyQ2FuY2VsbGVkKGVsKSB7XHJcbiAgICAgICAgICAgIGZpbmlzaEVudGVyKGVsLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIGNhbGxIb29rKG9uRW50ZXJDYW5jZWxsZWQsIFtlbF0pO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgb25BcHBlYXJDYW5jZWxsZWQoZWwpIHtcclxuICAgICAgICAgICAgZmluaXNoRW50ZXIoZWwsIHRydWUpO1xyXG4gICAgICAgICAgICBjYWxsSG9vayhvbkFwcGVhckNhbmNlbGxlZCwgW2VsXSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBvbkxlYXZlQ2FuY2VsbGVkKGVsKSB7XHJcbiAgICAgICAgICAgIGZpbmlzaExlYXZlKGVsKTtcclxuICAgICAgICAgICAgY2FsbEhvb2sob25MZWF2ZUNhbmNlbGxlZCwgW2VsXSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn1cclxuZnVuY3Rpb24gbm9ybWFsaXplRHVyYXRpb24oZHVyYXRpb24pIHtcclxuICAgIGlmIChkdXJhdGlvbiA9PSBudWxsKSB7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChpc09iamVjdChkdXJhdGlvbikpIHtcclxuICAgICAgICByZXR1cm4gW051bWJlck9mKGR1cmF0aW9uLmVudGVyKSwgTnVtYmVyT2YoZHVyYXRpb24ubGVhdmUpXTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIGNvbnN0IG4gPSBOdW1iZXJPZihkdXJhdGlvbik7XHJcbiAgICAgICAgcmV0dXJuIFtuLCBuXTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBOdW1iZXJPZih2YWwpIHtcclxuICAgIGNvbnN0IHJlcyA9IHRvTnVtYmVyKHZhbCk7XHJcbiAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKVxyXG4gICAgICAgIHZhbGlkYXRlRHVyYXRpb24ocmVzKTtcclxuICAgIHJldHVybiByZXM7XHJcbn1cclxuZnVuY3Rpb24gdmFsaWRhdGVEdXJhdGlvbih2YWwpIHtcclxuICAgIGlmICh0eXBlb2YgdmFsICE9PSAnbnVtYmVyJykge1xyXG4gICAgICAgIHdhcm4oYDx0cmFuc2l0aW9uPiBleHBsaWNpdCBkdXJhdGlvbiBpcyBub3QgYSB2YWxpZCBudW1iZXIgLSBgICtcclxuICAgICAgICAgICAgYGdvdCAke0pTT04uc3RyaW5naWZ5KHZhbCl9LmApO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoaXNOYU4odmFsKSkge1xyXG4gICAgICAgIHdhcm4oYDx0cmFuc2l0aW9uPiBleHBsaWNpdCBkdXJhdGlvbiBpcyBOYU4gLSBgICtcclxuICAgICAgICAgICAgJ3RoZSBkdXJhdGlvbiBleHByZXNzaW9uIG1pZ2h0IGJlIGluY29ycmVjdC4nKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBhZGRUcmFuc2l0aW9uQ2xhc3MoZWwsIGNscykge1xyXG4gICAgY2xzLnNwbGl0KC9cXHMrLykuZm9yRWFjaChjID0+IGMgJiYgZWwuY2xhc3NMaXN0LmFkZChjKSk7XHJcbiAgICAoZWwuX3Z0YyB8fFxyXG4gICAgICAgIChlbC5fdnRjID0gbmV3IFNldCgpKSkuYWRkKGNscyk7XHJcbn1cclxuZnVuY3Rpb24gcmVtb3ZlVHJhbnNpdGlvbkNsYXNzKGVsLCBjbHMpIHtcclxuICAgIGNscy5zcGxpdCgvXFxzKy8pLmZvckVhY2goYyA9PiBjICYmIGVsLmNsYXNzTGlzdC5yZW1vdmUoYykpO1xyXG4gICAgY29uc3QgeyBfdnRjIH0gPSBlbDtcclxuICAgIGlmIChfdnRjKSB7XHJcbiAgICAgICAgX3Z0Yy5kZWxldGUoY2xzKTtcclxuICAgICAgICBpZiAoIV92dGMuc2l6ZSkge1xyXG4gICAgICAgICAgICBlbC5fdnRjID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBuZXh0RnJhbWUoY2IpIHtcclxuICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XHJcbiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGNiKTtcclxuICAgIH0pO1xyXG59XHJcbmxldCBlbmRJZCA9IDA7XHJcbmZ1bmN0aW9uIHdoZW5UcmFuc2l0aW9uRW5kcyhlbCwgZXhwZWN0ZWRUeXBlLCBleHBsaWNpdFRpbWVvdXQsIHJlc29sdmUpIHtcclxuICAgIGNvbnN0IGlkID0gKGVsLl9lbmRJZCA9ICsrZW5kSWQpO1xyXG4gICAgY29uc3QgcmVzb2x2ZUlmTm90U3RhbGUgPSAoKSA9PiB7XHJcbiAgICAgICAgaWYgKGlkID09PSBlbC5fZW5kSWQpIHtcclxuICAgICAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBpZiAoZXhwbGljaXRUaW1lb3V0KSB7XHJcbiAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQocmVzb2x2ZUlmTm90U3RhbGUsIGV4cGxpY2l0VGltZW91dCk7XHJcbiAgICB9XHJcbiAgICBjb25zdCB7IHR5cGUsIHRpbWVvdXQsIHByb3BDb3VudCB9ID0gZ2V0VHJhbnNpdGlvbkluZm8oZWwsIGV4cGVjdGVkVHlwZSk7XHJcbiAgICBpZiAoIXR5cGUpIHtcclxuICAgICAgICByZXR1cm4gcmVzb2x2ZSgpO1xyXG4gICAgfVxyXG4gICAgY29uc3QgZW5kRXZlbnQgPSB0eXBlICsgJ2VuZCc7XHJcbiAgICBsZXQgZW5kZWQgPSAwO1xyXG4gICAgY29uc3QgZW5kID0gKCkgPT4ge1xyXG4gICAgICAgIGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoZW5kRXZlbnQsIG9uRW5kKTtcclxuICAgICAgICByZXNvbHZlSWZOb3RTdGFsZSgpO1xyXG4gICAgfTtcclxuICAgIGNvbnN0IG9uRW5kID0gKGUpID0+IHtcclxuICAgICAgICBpZiAoZS50YXJnZXQgPT09IGVsICYmICsrZW5kZWQgPj0gcHJvcENvdW50KSB7XHJcbiAgICAgICAgICAgIGVuZCgpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICBpZiAoZW5kZWQgPCBwcm9wQ291bnQpIHtcclxuICAgICAgICAgICAgZW5kKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSwgdGltZW91dCArIDEpO1xyXG4gICAgZWwuYWRkRXZlbnRMaXN0ZW5lcihlbmRFdmVudCwgb25FbmQpO1xyXG59XHJcbmZ1bmN0aW9uIGdldFRyYW5zaXRpb25JbmZvKGVsLCBleHBlY3RlZFR5cGUpIHtcclxuICAgIGNvbnN0IHN0eWxlcyA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGVsKTtcclxuICAgIC8vIEpTRE9NIG1heSByZXR1cm4gdW5kZWZpbmVkIGZvciB0cmFuc2l0aW9uIHByb3BlcnRpZXNcclxuICAgIGNvbnN0IGdldFN0eWxlUHJvcGVydGllcyA9IChrZXkpID0+IChzdHlsZXNba2V5XSB8fCAnJykuc3BsaXQoJywgJyk7XHJcbiAgICBjb25zdCB0cmFuc2l0aW9uRGVsYXlzID0gZ2V0U3R5bGVQcm9wZXJ0aWVzKFRSQU5TSVRJT04gKyAnRGVsYXknKTtcclxuICAgIGNvbnN0IHRyYW5zaXRpb25EdXJhdGlvbnMgPSBnZXRTdHlsZVByb3BlcnRpZXMoVFJBTlNJVElPTiArICdEdXJhdGlvbicpO1xyXG4gICAgY29uc3QgdHJhbnNpdGlvblRpbWVvdXQgPSBnZXRUaW1lb3V0KHRyYW5zaXRpb25EZWxheXMsIHRyYW5zaXRpb25EdXJhdGlvbnMpO1xyXG4gICAgY29uc3QgYW5pbWF0aW9uRGVsYXlzID0gZ2V0U3R5bGVQcm9wZXJ0aWVzKEFOSU1BVElPTiArICdEZWxheScpO1xyXG4gICAgY29uc3QgYW5pbWF0aW9uRHVyYXRpb25zID0gZ2V0U3R5bGVQcm9wZXJ0aWVzKEFOSU1BVElPTiArICdEdXJhdGlvbicpO1xyXG4gICAgY29uc3QgYW5pbWF0aW9uVGltZW91dCA9IGdldFRpbWVvdXQoYW5pbWF0aW9uRGVsYXlzLCBhbmltYXRpb25EdXJhdGlvbnMpO1xyXG4gICAgbGV0IHR5cGUgPSBudWxsO1xyXG4gICAgbGV0IHRpbWVvdXQgPSAwO1xyXG4gICAgbGV0IHByb3BDb3VudCA9IDA7XHJcbiAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgaWYgKi9cclxuICAgIGlmIChleHBlY3RlZFR5cGUgPT09IFRSQU5TSVRJT04pIHtcclxuICAgICAgICBpZiAodHJhbnNpdGlvblRpbWVvdXQgPiAwKSB7XHJcbiAgICAgICAgICAgIHR5cGUgPSBUUkFOU0lUSU9OO1xyXG4gICAgICAgICAgICB0aW1lb3V0ID0gdHJhbnNpdGlvblRpbWVvdXQ7XHJcbiAgICAgICAgICAgIHByb3BDb3VudCA9IHRyYW5zaXRpb25EdXJhdGlvbnMubGVuZ3RoO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGV4cGVjdGVkVHlwZSA9PT0gQU5JTUFUSU9OKSB7XHJcbiAgICAgICAgaWYgKGFuaW1hdGlvblRpbWVvdXQgPiAwKSB7XHJcbiAgICAgICAgICAgIHR5cGUgPSBBTklNQVRJT047XHJcbiAgICAgICAgICAgIHRpbWVvdXQgPSBhbmltYXRpb25UaW1lb3V0O1xyXG4gICAgICAgICAgICBwcm9wQ291bnQgPSBhbmltYXRpb25EdXJhdGlvbnMubGVuZ3RoO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHRpbWVvdXQgPSBNYXRoLm1heCh0cmFuc2l0aW9uVGltZW91dCwgYW5pbWF0aW9uVGltZW91dCk7XHJcbiAgICAgICAgdHlwZSA9XHJcbiAgICAgICAgICAgIHRpbWVvdXQgPiAwXHJcbiAgICAgICAgICAgICAgICA/IHRyYW5zaXRpb25UaW1lb3V0ID4gYW5pbWF0aW9uVGltZW91dFxyXG4gICAgICAgICAgICAgICAgICAgID8gVFJBTlNJVElPTlxyXG4gICAgICAgICAgICAgICAgICAgIDogQU5JTUFUSU9OXHJcbiAgICAgICAgICAgICAgICA6IG51bGw7XHJcbiAgICAgICAgcHJvcENvdW50ID0gdHlwZVxyXG4gICAgICAgICAgICA/IHR5cGUgPT09IFRSQU5TSVRJT05cclxuICAgICAgICAgICAgICAgID8gdHJhbnNpdGlvbkR1cmF0aW9ucy5sZW5ndGhcclxuICAgICAgICAgICAgICAgIDogYW5pbWF0aW9uRHVyYXRpb25zLmxlbmd0aFxyXG4gICAgICAgICAgICA6IDA7XHJcbiAgICB9XHJcbiAgICBjb25zdCBoYXNUcmFuc2Zvcm0gPSB0eXBlID09PSBUUkFOU0lUSU9OICYmXHJcbiAgICAgICAgL1xcYih0cmFuc2Zvcm18YWxsKSgsfCQpLy50ZXN0KHN0eWxlc1tUUkFOU0lUSU9OICsgJ1Byb3BlcnR5J10pO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICB0eXBlLFxyXG4gICAgICAgIHRpbWVvdXQsXHJcbiAgICAgICAgcHJvcENvdW50LFxyXG4gICAgICAgIGhhc1RyYW5zZm9ybVxyXG4gICAgfTtcclxufVxyXG5mdW5jdGlvbiBnZXRUaW1lb3V0KGRlbGF5cywgZHVyYXRpb25zKSB7XHJcbiAgICB3aGlsZSAoZGVsYXlzLmxlbmd0aCA8IGR1cmF0aW9ucy5sZW5ndGgpIHtcclxuICAgICAgICBkZWxheXMgPSBkZWxheXMuY29uY2F0KGRlbGF5cyk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gTWF0aC5tYXgoLi4uZHVyYXRpb25zLm1hcCgoZCwgaSkgPT4gdG9NcyhkKSArIHRvTXMoZGVsYXlzW2ldKSkpO1xyXG59XHJcbi8vIE9sZCB2ZXJzaW9ucyBvZiBDaHJvbWl1bSAoYmVsb3cgNjEuMC4zMTYzLjEwMCkgZm9ybWF0cyBmbG9hdGluZyBwb2ludGVyXHJcbi8vIG51bWJlcnMgaW4gYSBsb2NhbGUtZGVwZW5kZW50IHdheSwgdXNpbmcgYSBjb21tYSBpbnN0ZWFkIG9mIGEgZG90LlxyXG4vLyBJZiBjb21tYSBpcyBub3QgcmVwbGFjZWQgd2l0aCBhIGRvdCwgdGhlIGlucHV0IHdpbGwgYmUgcm91bmRlZCBkb3duXHJcbi8vIChpLmUuIGFjdGluZyBhcyBhIGZsb29yIGZ1bmN0aW9uKSBjYXVzaW5nIHVuZXhwZWN0ZWQgYmVoYXZpb3JzXHJcbmZ1bmN0aW9uIHRvTXMocykge1xyXG4gICAgcmV0dXJuIE51bWJlcihzLnNsaWNlKDAsIC0xKS5yZXBsYWNlKCcsJywgJy4nKSkgKiAxMDAwO1xyXG59XHJcbi8vIHN5bmNocm9ub3VzbHkgZm9yY2UgbGF5b3V0IHRvIHB1dCBlbGVtZW50cyBpbnRvIGEgY2VydGFpbiBzdGF0ZVxyXG5mdW5jdGlvbiBmb3JjZVJlZmxvdygpIHtcclxuICAgIHJldHVybiBkb2N1bWVudC5ib2R5Lm9mZnNldEhlaWdodDtcclxufVxuXG5jb25zdCBwb3NpdGlvbk1hcCA9IG5ldyBXZWFrTWFwKCk7XHJcbmNvbnN0IG5ld1Bvc2l0aW9uTWFwID0gbmV3IFdlYWtNYXAoKTtcclxuY29uc3QgVHJhbnNpdGlvbkdyb3VwSW1wbCA9IHtcclxuICAgIG5hbWU6ICdUcmFuc2l0aW9uR3JvdXAnLFxyXG4gICAgcHJvcHM6IC8qI19fUFVSRV9fKi8gZXh0ZW5kKHt9LCBUcmFuc2l0aW9uUHJvcHNWYWxpZGF0b3JzLCB7XHJcbiAgICAgICAgdGFnOiBTdHJpbmcsXHJcbiAgICAgICAgbW92ZUNsYXNzOiBTdHJpbmdcclxuICAgIH0pLFxyXG4gICAgc2V0dXAocHJvcHMsIHsgc2xvdHMgfSkge1xyXG4gICAgICAgIGNvbnN0IGluc3RhbmNlID0gZ2V0Q3VycmVudEluc3RhbmNlKCk7XHJcbiAgICAgICAgY29uc3Qgc3RhdGUgPSB1c2VUcmFuc2l0aW9uU3RhdGUoKTtcclxuICAgICAgICBsZXQgcHJldkNoaWxkcmVuO1xyXG4gICAgICAgIGxldCBjaGlsZHJlbjtcclxuICAgICAgICBvblVwZGF0ZWQoKCkgPT4ge1xyXG4gICAgICAgICAgICAvLyBjaGlsZHJlbiBpcyBndWFyYW50ZWVkIHRvIGV4aXN0IGFmdGVyIGluaXRpYWwgcmVuZGVyXHJcbiAgICAgICAgICAgIGlmICghcHJldkNoaWxkcmVuLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IG1vdmVDbGFzcyA9IHByb3BzLm1vdmVDbGFzcyB8fCBgJHtwcm9wcy5uYW1lIHx8ICd2J30tbW92ZWA7XHJcbiAgICAgICAgICAgIGlmICghaGFzQ1NTVHJhbnNmb3JtKHByZXZDaGlsZHJlblswXS5lbCwgaW5zdGFuY2Uudm5vZGUuZWwsIG1vdmVDbGFzcykpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyB3ZSBkaXZpZGUgdGhlIHdvcmsgaW50byB0aHJlZSBsb29wcyB0byBhdm9pZCBtaXhpbmcgRE9NIHJlYWRzIGFuZCB3cml0ZXNcclxuICAgICAgICAgICAgLy8gaW4gZWFjaCBpdGVyYXRpb24gLSB3aGljaCBoZWxwcyBwcmV2ZW50IGxheW91dCB0aHJhc2hpbmcuXHJcbiAgICAgICAgICAgIHByZXZDaGlsZHJlbi5mb3JFYWNoKGNhbGxQZW5kaW5nQ2JzKTtcclxuICAgICAgICAgICAgcHJldkNoaWxkcmVuLmZvckVhY2gocmVjb3JkUG9zaXRpb24pO1xyXG4gICAgICAgICAgICBjb25zdCBtb3ZlZENoaWxkcmVuID0gcHJldkNoaWxkcmVuLmZpbHRlcihhcHBseVRyYW5zbGF0aW9uKTtcclxuICAgICAgICAgICAgLy8gZm9yY2UgcmVmbG93IHRvIHB1dCBldmVyeXRoaW5nIGluIHBvc2l0aW9uXHJcbiAgICAgICAgICAgIGZvcmNlUmVmbG93KCk7XHJcbiAgICAgICAgICAgIG1vdmVkQ2hpbGRyZW4uZm9yRWFjaChjID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGVsID0gYy5lbDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHN0eWxlID0gZWwuc3R5bGU7XHJcbiAgICAgICAgICAgICAgICBhZGRUcmFuc2l0aW9uQ2xhc3MoZWwsIG1vdmVDbGFzcyk7XHJcbiAgICAgICAgICAgICAgICBzdHlsZS50cmFuc2Zvcm0gPSBzdHlsZS53ZWJraXRUcmFuc2Zvcm0gPSBzdHlsZS50cmFuc2l0aW9uRHVyYXRpb24gPSAnJztcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNiID0gKGVsLl9tb3ZlQ2IgPSAoZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlICYmIGUudGFyZ2V0ICE9PSBlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghZSB8fCAvdHJhbnNmb3JtJC8udGVzdChlLnByb3BlcnR5TmFtZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcigndHJhbnNpdGlvbmVuZCcsIGNiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZWwuX21vdmVDYiA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZVRyYW5zaXRpb25DbGFzcyhlbCwgbW92ZUNsYXNzKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ3RyYW5zaXRpb25lbmQnLCBjYik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJhd1Byb3BzID0gdG9SYXcocHJvcHMpO1xyXG4gICAgICAgICAgICBjb25zdCBjc3NUcmFuc2l0aW9uUHJvcHMgPSByZXNvbHZlVHJhbnNpdGlvblByb3BzKHJhd1Byb3BzKTtcclxuICAgICAgICAgICAgbGV0IHRhZyA9IHJhd1Byb3BzLnRhZyB8fCBGcmFnbWVudDtcclxuICAgICAgICAgICAgcHJldkNoaWxkcmVuID0gY2hpbGRyZW47XHJcbiAgICAgICAgICAgIGNoaWxkcmVuID0gc2xvdHMuZGVmYXVsdCA/IGdldFRyYW5zaXRpb25SYXdDaGlsZHJlbihzbG90cy5kZWZhdWx0KCkpIDogW107XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNoaWxkID0gY2hpbGRyZW5baV07XHJcbiAgICAgICAgICAgICAgICBpZiAoY2hpbGQua2V5ICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICBzZXRUcmFuc2l0aW9uSG9va3MoY2hpbGQsIHJlc29sdmVUcmFuc2l0aW9uSG9va3MoY2hpbGQsIGNzc1RyYW5zaXRpb25Qcm9wcywgc3RhdGUsIGluc3RhbmNlKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgICAgICB3YXJuKGA8VHJhbnNpdGlvbkdyb3VwPiBjaGlsZHJlbiBtdXN0IGJlIGtleWVkLmApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChwcmV2Q2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcHJldkNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hpbGQgPSBwcmV2Q2hpbGRyZW5baV07XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0VHJhbnNpdGlvbkhvb2tzKGNoaWxkLCByZXNvbHZlVHJhbnNpdGlvbkhvb2tzKGNoaWxkLCBjc3NUcmFuc2l0aW9uUHJvcHMsIHN0YXRlLCBpbnN0YW5jZSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uTWFwLnNldChjaGlsZCwgY2hpbGQuZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBjcmVhdGVWTm9kZSh0YWcsIG51bGwsIGNoaWxkcmVuKTtcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG59O1xyXG5jb25zdCBUcmFuc2l0aW9uR3JvdXAgPSBUcmFuc2l0aW9uR3JvdXBJbXBsO1xyXG5mdW5jdGlvbiBjYWxsUGVuZGluZ0NicyhjKSB7XHJcbiAgICBjb25zdCBlbCA9IGMuZWw7XHJcbiAgICBpZiAoZWwuX21vdmVDYikge1xyXG4gICAgICAgIGVsLl9tb3ZlQ2IoKTtcclxuICAgIH1cclxuICAgIGlmIChlbC5fZW50ZXJDYikge1xyXG4gICAgICAgIGVsLl9lbnRlckNiKCk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gcmVjb3JkUG9zaXRpb24oYykge1xyXG4gICAgbmV3UG9zaXRpb25NYXAuc2V0KGMsIGMuZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkpO1xyXG59XHJcbmZ1bmN0aW9uIGFwcGx5VHJhbnNsYXRpb24oYykge1xyXG4gICAgY29uc3Qgb2xkUG9zID0gcG9zaXRpb25NYXAuZ2V0KGMpO1xyXG4gICAgY29uc3QgbmV3UG9zID0gbmV3UG9zaXRpb25NYXAuZ2V0KGMpO1xyXG4gICAgY29uc3QgZHggPSBvbGRQb3MubGVmdCAtIG5ld1Bvcy5sZWZ0O1xyXG4gICAgY29uc3QgZHkgPSBvbGRQb3MudG9wIC0gbmV3UG9zLnRvcDtcclxuICAgIGlmIChkeCB8fCBkeSkge1xyXG4gICAgICAgIGNvbnN0IHMgPSBjLmVsLnN0eWxlO1xyXG4gICAgICAgIHMudHJhbnNmb3JtID0gcy53ZWJraXRUcmFuc2Zvcm0gPSBgdHJhbnNsYXRlKCR7ZHh9cHgsJHtkeX1weClgO1xyXG4gICAgICAgIHMudHJhbnNpdGlvbkR1cmF0aW9uID0gJzBzJztcclxuICAgICAgICByZXR1cm4gYztcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBoYXNDU1NUcmFuc2Zvcm0oZWwsIHJvb3QsIG1vdmVDbGFzcykge1xyXG4gICAgLy8gRGV0ZWN0IHdoZXRoZXIgYW4gZWxlbWVudCB3aXRoIHRoZSBtb3ZlIGNsYXNzIGFwcGxpZWQgaGFzXHJcbiAgICAvLyBDU1MgdHJhbnNpdGlvbnMuIFNpbmNlIHRoZSBlbGVtZW50IG1heSBiZSBpbnNpZGUgYW4gZW50ZXJpbmdcclxuICAgIC8vIHRyYW5zaXRpb24gYXQgdGhpcyB2ZXJ5IG1vbWVudCwgd2UgbWFrZSBhIGNsb25lIG9mIGl0IGFuZCByZW1vdmVcclxuICAgIC8vIGFsbCBvdGhlciB0cmFuc2l0aW9uIGNsYXNzZXMgYXBwbGllZCB0byBlbnN1cmUgb25seSB0aGUgbW92ZSBjbGFzc1xyXG4gICAgLy8gaXMgYXBwbGllZC5cclxuICAgIGNvbnN0IGNsb25lID0gZWwuY2xvbmVOb2RlKCk7XHJcbiAgICBpZiAoZWwuX3Z0Yykge1xyXG4gICAgICAgIGVsLl92dGMuZm9yRWFjaChjbHMgPT4ge1xyXG4gICAgICAgICAgICBjbHMuc3BsaXQoL1xccysvKS5mb3JFYWNoKGMgPT4gYyAmJiBjbG9uZS5jbGFzc0xpc3QucmVtb3ZlKGMpKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIG1vdmVDbGFzcy5zcGxpdCgvXFxzKy8pLmZvckVhY2goYyA9PiBjICYmIGNsb25lLmNsYXNzTGlzdC5hZGQoYykpO1xyXG4gICAgY2xvbmUuc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuICAgIGNvbnN0IGNvbnRhaW5lciA9IChyb290Lm5vZGVUeXBlID09PSAxID8gcm9vdCA6IHJvb3QucGFyZW50Tm9kZSk7XHJcbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoY2xvbmUpO1xyXG4gICAgY29uc3QgeyBoYXNUcmFuc2Zvcm0gfSA9IGdldFRyYW5zaXRpb25JbmZvKGNsb25lKTtcclxuICAgIGNvbnRhaW5lci5yZW1vdmVDaGlsZChjbG9uZSk7XHJcbiAgICByZXR1cm4gaGFzVHJhbnNmb3JtO1xyXG59XG5cbmNvbnN0IGdldE1vZGVsQXNzaWduZXIgPSAodm5vZGUpID0+IHtcclxuICAgIGNvbnN0IGZuID0gdm5vZGUucHJvcHNbJ29uVXBkYXRlOm1vZGVsVmFsdWUnXTtcclxuICAgIHJldHVybiBpc0FycmF5KGZuKSA/IHZhbHVlID0+IGludm9rZUFycmF5Rm5zKGZuLCB2YWx1ZSkgOiBmbjtcclxufTtcclxuZnVuY3Rpb24gb25Db21wb3NpdGlvblN0YXJ0KGUpIHtcclxuICAgIGUudGFyZ2V0LmNvbXBvc2luZyA9IHRydWU7XHJcbn1cclxuZnVuY3Rpb24gb25Db21wb3NpdGlvbkVuZChlKSB7XHJcbiAgICBjb25zdCB0YXJnZXQgPSBlLnRhcmdldDtcclxuICAgIGlmICh0YXJnZXQuY29tcG9zaW5nKSB7XHJcbiAgICAgICAgdGFyZ2V0LmNvbXBvc2luZyA9IGZhbHNlO1xyXG4gICAgICAgIHRyaWdnZXIodGFyZ2V0LCAnaW5wdXQnKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiB0cmlnZ2VyKGVsLCB0eXBlKSB7XHJcbiAgICBjb25zdCBlID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0hUTUxFdmVudHMnKTtcclxuICAgIGUuaW5pdEV2ZW50KHR5cGUsIHRydWUsIHRydWUpO1xyXG4gICAgZWwuZGlzcGF0Y2hFdmVudChlKTtcclxufVxyXG4vLyBXZSBhcmUgZXhwb3J0aW5nIHRoZSB2LW1vZGVsIHJ1bnRpbWUgZGlyZWN0bHkgYXMgdm5vZGUgaG9va3Mgc28gdGhhdCBpdCBjYW5cclxuLy8gYmUgdHJlZS1zaGFrZW4gaW4gY2FzZSB2LW1vZGVsIGlzIG5ldmVyIHVzZWQuXHJcbmNvbnN0IHZNb2RlbFRleHQgPSB7XHJcbiAgICBjcmVhdGVkKGVsLCB7IG1vZGlmaWVyczogeyBsYXp5LCB0cmltLCBudW1iZXIgfSB9LCB2bm9kZSkge1xyXG4gICAgICAgIGVsLl9hc3NpZ24gPSBnZXRNb2RlbEFzc2lnbmVyKHZub2RlKTtcclxuICAgICAgICBjb25zdCBjYXN0VG9OdW1iZXIgPSBudW1iZXIgfHwgKHZub2RlLnByb3BzICYmIHZub2RlLnByb3BzLnR5cGUgPT09ICdudW1iZXInKTtcclxuICAgICAgICBhZGRFdmVudExpc3RlbmVyKGVsLCBsYXp5ID8gJ2NoYW5nZScgOiAnaW5wdXQnLCBlID0+IHtcclxuICAgICAgICAgICAgaWYgKGUudGFyZ2V0LmNvbXBvc2luZylcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgbGV0IGRvbVZhbHVlID0gZWwudmFsdWU7XHJcbiAgICAgICAgICAgIGlmICh0cmltKSB7XHJcbiAgICAgICAgICAgICAgICBkb21WYWx1ZSA9IGRvbVZhbHVlLnRyaW0oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChjYXN0VG9OdW1iZXIpIHtcclxuICAgICAgICAgICAgICAgIGRvbVZhbHVlID0gdG9OdW1iZXIoZG9tVmFsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsLl9hc3NpZ24oZG9tVmFsdWUpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmICh0cmltKSB7XHJcbiAgICAgICAgICAgIGFkZEV2ZW50TGlzdGVuZXIoZWwsICdjaGFuZ2UnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBlbC52YWx1ZSA9IGVsLnZhbHVlLnRyaW0oKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghbGF6eSkge1xyXG4gICAgICAgICAgICBhZGRFdmVudExpc3RlbmVyKGVsLCAnY29tcG9zaXRpb25zdGFydCcsIG9uQ29tcG9zaXRpb25TdGFydCk7XHJcbiAgICAgICAgICAgIGFkZEV2ZW50TGlzdGVuZXIoZWwsICdjb21wb3NpdGlvbmVuZCcsIG9uQ29tcG9zaXRpb25FbmQpO1xyXG4gICAgICAgICAgICAvLyBTYWZhcmkgPCAxMC4yICYgVUlXZWJWaWV3IGRvZXNuJ3QgZmlyZSBjb21wb3NpdGlvbmVuZCB3aGVuXHJcbiAgICAgICAgICAgIC8vIHN3aXRjaGluZyBmb2N1cyBiZWZvcmUgY29uZmlybWluZyBjb21wb3NpdGlvbiBjaG9pY2VcclxuICAgICAgICAgICAgLy8gdGhpcyBhbHNvIGZpeGVzIHRoZSBpc3N1ZSB3aGVyZSBzb21lIGJyb3dzZXJzIGUuZy4gaU9TIENocm9tZVxyXG4gICAgICAgICAgICAvLyBmaXJlcyBcImNoYW5nZVwiIGluc3RlYWQgb2YgXCJpbnB1dFwiIG9uIGF1dG9jb21wbGV0ZS5cclxuICAgICAgICAgICAgYWRkRXZlbnRMaXN0ZW5lcihlbCwgJ2NoYW5nZScsIG9uQ29tcG9zaXRpb25FbmQpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvLyBzZXQgdmFsdWUgb24gbW91bnRlZCBzbyBpdCdzIGFmdGVyIG1pbi9tYXggZm9yIHR5cGU9XCJyYW5nZVwiXHJcbiAgICBtb3VudGVkKGVsLCB7IHZhbHVlIH0pIHtcclxuICAgICAgICBlbC52YWx1ZSA9IHZhbHVlID09IG51bGwgPyAnJyA6IHZhbHVlO1xyXG4gICAgfSxcclxuICAgIGJlZm9yZVVwZGF0ZShlbCwgeyB2YWx1ZSwgbW9kaWZpZXJzOiB7IGxhenksIHRyaW0sIG51bWJlciB9IH0sIHZub2RlKSB7XHJcbiAgICAgICAgZWwuX2Fzc2lnbiA9IGdldE1vZGVsQXNzaWduZXIodm5vZGUpO1xyXG4gICAgICAgIC8vIGF2b2lkIGNsZWFyaW5nIHVucmVzb2x2ZWQgdGV4dC4gIzIzMDJcclxuICAgICAgICBpZiAoZWwuY29tcG9zaW5nKVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgaWYgKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgPT09IGVsKSB7XHJcbiAgICAgICAgICAgIGlmIChsYXp5KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRyaW0gJiYgZWwudmFsdWUudHJpbSgpID09PSB2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICgobnVtYmVyIHx8IGVsLnR5cGUgPT09ICdudW1iZXInKSAmJiB0b051bWJlcihlbC52YWx1ZSkgPT09IHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgbmV3VmFsdWUgPSB2YWx1ZSA9PSBudWxsID8gJycgOiB2YWx1ZTtcclxuICAgICAgICBpZiAoZWwudmFsdWUgIT09IG5ld1ZhbHVlKSB7XHJcbiAgICAgICAgICAgIGVsLnZhbHVlID0gbmV3VmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG5jb25zdCB2TW9kZWxDaGVja2JveCA9IHtcclxuICAgIC8vICM0MDk2IGFycmF5IGNoZWNrYm94ZXMgbmVlZCB0byBiZSBkZWVwIHRyYXZlcnNlZFxyXG4gICAgZGVlcDogdHJ1ZSxcclxuICAgIGNyZWF0ZWQoZWwsIF8sIHZub2RlKSB7XHJcbiAgICAgICAgZWwuX2Fzc2lnbiA9IGdldE1vZGVsQXNzaWduZXIodm5vZGUpO1xyXG4gICAgICAgIGFkZEV2ZW50TGlzdGVuZXIoZWwsICdjaGFuZ2UnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vZGVsVmFsdWUgPSBlbC5fbW9kZWxWYWx1ZTtcclxuICAgICAgICAgICAgY29uc3QgZWxlbWVudFZhbHVlID0gZ2V0VmFsdWUoZWwpO1xyXG4gICAgICAgICAgICBjb25zdCBjaGVja2VkID0gZWwuY2hlY2tlZDtcclxuICAgICAgICAgICAgY29uc3QgYXNzaWduID0gZWwuX2Fzc2lnbjtcclxuICAgICAgICAgICAgaWYgKGlzQXJyYXkobW9kZWxWYWx1ZSkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gbG9vc2VJbmRleE9mKG1vZGVsVmFsdWUsIGVsZW1lbnRWYWx1ZSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBmb3VuZCA9IGluZGV4ICE9PSAtMTtcclxuICAgICAgICAgICAgICAgIGlmIChjaGVja2VkICYmICFmb3VuZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFzc2lnbihtb2RlbFZhbHVlLmNvbmNhdChlbGVtZW50VmFsdWUpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKCFjaGVja2VkICYmIGZvdW5kKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsdGVyZWQgPSBbLi4ubW9kZWxWYWx1ZV07XHJcbiAgICAgICAgICAgICAgICAgICAgZmlsdGVyZWQuc3BsaWNlKGluZGV4LCAxKTtcclxuICAgICAgICAgICAgICAgICAgICBhc3NpZ24oZmlsdGVyZWQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGlzU2V0KG1vZGVsVmFsdWUpKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjbG9uZWQgPSBuZXcgU2V0KG1vZGVsVmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGNoZWNrZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjbG9uZWQuYWRkKGVsZW1lbnRWYWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjbG9uZWQuZGVsZXRlKGVsZW1lbnRWYWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBhc3NpZ24oY2xvbmVkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGFzc2lnbihnZXRDaGVja2JveFZhbHVlKGVsLCBjaGVja2VkKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcbiAgICAvLyBzZXQgaW5pdGlhbCBjaGVja2VkIG9uIG1vdW50IHRvIHdhaXQgZm9yIHRydWUtdmFsdWUvZmFsc2UtdmFsdWVcclxuICAgIG1vdW50ZWQ6IHNldENoZWNrZWQsXHJcbiAgICBiZWZvcmVVcGRhdGUoZWwsIGJpbmRpbmcsIHZub2RlKSB7XHJcbiAgICAgICAgZWwuX2Fzc2lnbiA9IGdldE1vZGVsQXNzaWduZXIodm5vZGUpO1xyXG4gICAgICAgIHNldENoZWNrZWQoZWwsIGJpbmRpbmcsIHZub2RlKTtcclxuICAgIH1cclxufTtcclxuZnVuY3Rpb24gc2V0Q2hlY2tlZChlbCwgeyB2YWx1ZSwgb2xkVmFsdWUgfSwgdm5vZGUpIHtcclxuICAgIGVsLl9tb2RlbFZhbHVlID0gdmFsdWU7XHJcbiAgICBpZiAoaXNBcnJheSh2YWx1ZSkpIHtcclxuICAgICAgICBlbC5jaGVja2VkID0gbG9vc2VJbmRleE9mKHZhbHVlLCB2bm9kZS5wcm9wcy52YWx1ZSkgPiAtMTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGlzU2V0KHZhbHVlKSkge1xyXG4gICAgICAgIGVsLmNoZWNrZWQgPSB2YWx1ZS5oYXModm5vZGUucHJvcHMudmFsdWUpO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAodmFsdWUgIT09IG9sZFZhbHVlKSB7XHJcbiAgICAgICAgZWwuY2hlY2tlZCA9IGxvb3NlRXF1YWwodmFsdWUsIGdldENoZWNrYm94VmFsdWUoZWwsIHRydWUpKTtcclxuICAgIH1cclxufVxyXG5jb25zdCB2TW9kZWxSYWRpbyA9IHtcclxuICAgIGNyZWF0ZWQoZWwsIHsgdmFsdWUgfSwgdm5vZGUpIHtcclxuICAgICAgICBlbC5jaGVja2VkID0gbG9vc2VFcXVhbCh2YWx1ZSwgdm5vZGUucHJvcHMudmFsdWUpO1xyXG4gICAgICAgIGVsLl9hc3NpZ24gPSBnZXRNb2RlbEFzc2lnbmVyKHZub2RlKTtcclxuICAgICAgICBhZGRFdmVudExpc3RlbmVyKGVsLCAnY2hhbmdlJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBlbC5fYXNzaWduKGdldFZhbHVlKGVsKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG4gICAgYmVmb3JlVXBkYXRlKGVsLCB7IHZhbHVlLCBvbGRWYWx1ZSB9LCB2bm9kZSkge1xyXG4gICAgICAgIGVsLl9hc3NpZ24gPSBnZXRNb2RlbEFzc2lnbmVyKHZub2RlKTtcclxuICAgICAgICBpZiAodmFsdWUgIT09IG9sZFZhbHVlKSB7XHJcbiAgICAgICAgICAgIGVsLmNoZWNrZWQgPSBsb29zZUVxdWFsKHZhbHVlLCB2bm9kZS5wcm9wcy52YWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG5jb25zdCB2TW9kZWxTZWxlY3QgPSB7XHJcbiAgICAvLyA8c2VsZWN0IG11bHRpcGxlPiB2YWx1ZSBuZWVkIHRvIGJlIGRlZXAgdHJhdmVyc2VkXHJcbiAgICBkZWVwOiB0cnVlLFxyXG4gICAgY3JlYXRlZChlbCwgeyB2YWx1ZSwgbW9kaWZpZXJzOiB7IG51bWJlciB9IH0sIHZub2RlKSB7XHJcbiAgICAgICAgY29uc3QgaXNTZXRNb2RlbCA9IGlzU2V0KHZhbHVlKTtcclxuICAgICAgICBhZGRFdmVudExpc3RlbmVyKGVsLCAnY2hhbmdlJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBzZWxlY3RlZFZhbCA9IEFycmF5LnByb3RvdHlwZS5maWx0ZXJcclxuICAgICAgICAgICAgICAgIC5jYWxsKGVsLm9wdGlvbnMsIChvKSA9PiBvLnNlbGVjdGVkKVxyXG4gICAgICAgICAgICAgICAgLm1hcCgobykgPT4gbnVtYmVyID8gdG9OdW1iZXIoZ2V0VmFsdWUobykpIDogZ2V0VmFsdWUobykpO1xyXG4gICAgICAgICAgICBlbC5fYXNzaWduKGVsLm11bHRpcGxlXHJcbiAgICAgICAgICAgICAgICA/IGlzU2V0TW9kZWxcclxuICAgICAgICAgICAgICAgICAgICA/IG5ldyBTZXQoc2VsZWN0ZWRWYWwpXHJcbiAgICAgICAgICAgICAgICAgICAgOiBzZWxlY3RlZFZhbFxyXG4gICAgICAgICAgICAgICAgOiBzZWxlY3RlZFZhbFswXSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgZWwuX2Fzc2lnbiA9IGdldE1vZGVsQXNzaWduZXIodm5vZGUpO1xyXG4gICAgfSxcclxuICAgIC8vIHNldCB2YWx1ZSBpbiBtb3VudGVkICYgdXBkYXRlZCBiZWNhdXNlIDxzZWxlY3Q+IHJlbGllcyBvbiBpdHMgY2hpbGRyZW5cclxuICAgIC8vIDxvcHRpb24+cy5cclxuICAgIG1vdW50ZWQoZWwsIHsgdmFsdWUgfSkge1xyXG4gICAgICAgIHNldFNlbGVjdGVkKGVsLCB2YWx1ZSk7XHJcbiAgICB9LFxyXG4gICAgYmVmb3JlVXBkYXRlKGVsLCBfYmluZGluZywgdm5vZGUpIHtcclxuICAgICAgICBlbC5fYXNzaWduID0gZ2V0TW9kZWxBc3NpZ25lcih2bm9kZSk7XHJcbiAgICB9LFxyXG4gICAgdXBkYXRlZChlbCwgeyB2YWx1ZSB9KSB7XHJcbiAgICAgICAgc2V0U2VsZWN0ZWQoZWwsIHZhbHVlKTtcclxuICAgIH1cclxufTtcclxuZnVuY3Rpb24gc2V0U2VsZWN0ZWQoZWwsIHZhbHVlKSB7XHJcbiAgICBjb25zdCBpc011bHRpcGxlID0gZWwubXVsdGlwbGU7XHJcbiAgICBpZiAoaXNNdWx0aXBsZSAmJiAhaXNBcnJheSh2YWx1ZSkgJiYgIWlzU2V0KHZhbHVlKSkge1xyXG4gICAgICAgIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJlxyXG4gICAgICAgICAgICB3YXJuKGA8c2VsZWN0IG11bHRpcGxlIHYtbW9kZWw+IGV4cGVjdHMgYW4gQXJyYXkgb3IgU2V0IHZhbHVlIGZvciBpdHMgYmluZGluZywgYCArXHJcbiAgICAgICAgICAgICAgICBgYnV0IGdvdCAke09iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh2YWx1ZSkuc2xpY2UoOCwgLTEpfS5gKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBmb3IgKGxldCBpID0gMCwgbCA9IGVsLm9wdGlvbnMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XHJcbiAgICAgICAgY29uc3Qgb3B0aW9uID0gZWwub3B0aW9uc1tpXTtcclxuICAgICAgICBjb25zdCBvcHRpb25WYWx1ZSA9IGdldFZhbHVlKG9wdGlvbik7XHJcbiAgICAgICAgaWYgKGlzTXVsdGlwbGUpIHtcclxuICAgICAgICAgICAgaWYgKGlzQXJyYXkodmFsdWUpKSB7XHJcbiAgICAgICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBsb29zZUluZGV4T2YodmFsdWUsIG9wdGlvblZhbHVlKSA+IC0xO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gdmFsdWUuaGFzKG9wdGlvblZhbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKGxvb3NlRXF1YWwoZ2V0VmFsdWUob3B0aW9uKSwgdmFsdWUpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZWwuc2VsZWN0ZWRJbmRleCAhPT0gaSlcclxuICAgICAgICAgICAgICAgICAgICBlbC5zZWxlY3RlZEluZGV4ID0gaTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGlmICghaXNNdWx0aXBsZSAmJiBlbC5zZWxlY3RlZEluZGV4ICE9PSAtMSkge1xyXG4gICAgICAgIGVsLnNlbGVjdGVkSW5kZXggPSAtMTtcclxuICAgIH1cclxufVxyXG4vLyByZXRyaWV2ZSByYXcgdmFsdWUgc2V0IHZpYSA6dmFsdWUgYmluZGluZ3NcclxuZnVuY3Rpb24gZ2V0VmFsdWUoZWwpIHtcclxuICAgIHJldHVybiAnX3ZhbHVlJyBpbiBlbCA/IGVsLl92YWx1ZSA6IGVsLnZhbHVlO1xyXG59XHJcbi8vIHJldHJpZXZlIHJhdyB2YWx1ZSBmb3IgdHJ1ZS12YWx1ZSBhbmQgZmFsc2UtdmFsdWUgc2V0IHZpYSA6dHJ1ZS12YWx1ZSBvciA6ZmFsc2UtdmFsdWUgYmluZGluZ3NcclxuZnVuY3Rpb24gZ2V0Q2hlY2tib3hWYWx1ZShlbCwgY2hlY2tlZCkge1xyXG4gICAgY29uc3Qga2V5ID0gY2hlY2tlZCA/ICdfdHJ1ZVZhbHVlJyA6ICdfZmFsc2VWYWx1ZSc7XHJcbiAgICByZXR1cm4ga2V5IGluIGVsID8gZWxba2V5XSA6IGNoZWNrZWQ7XHJcbn1cclxuY29uc3Qgdk1vZGVsRHluYW1pYyA9IHtcclxuICAgIGNyZWF0ZWQoZWwsIGJpbmRpbmcsIHZub2RlKSB7XHJcbiAgICAgICAgY2FsbE1vZGVsSG9vayhlbCwgYmluZGluZywgdm5vZGUsIG51bGwsICdjcmVhdGVkJyk7XHJcbiAgICB9LFxyXG4gICAgbW91bnRlZChlbCwgYmluZGluZywgdm5vZGUpIHtcclxuICAgICAgICBjYWxsTW9kZWxIb29rKGVsLCBiaW5kaW5nLCB2bm9kZSwgbnVsbCwgJ21vdW50ZWQnKTtcclxuICAgIH0sXHJcbiAgICBiZWZvcmVVcGRhdGUoZWwsIGJpbmRpbmcsIHZub2RlLCBwcmV2Vk5vZGUpIHtcclxuICAgICAgICBjYWxsTW9kZWxIb29rKGVsLCBiaW5kaW5nLCB2bm9kZSwgcHJldlZOb2RlLCAnYmVmb3JlVXBkYXRlJyk7XHJcbiAgICB9LFxyXG4gICAgdXBkYXRlZChlbCwgYmluZGluZywgdm5vZGUsIHByZXZWTm9kZSkge1xyXG4gICAgICAgIGNhbGxNb2RlbEhvb2soZWwsIGJpbmRpbmcsIHZub2RlLCBwcmV2Vk5vZGUsICd1cGRhdGVkJyk7XHJcbiAgICB9XHJcbn07XHJcbmZ1bmN0aW9uIGNhbGxNb2RlbEhvb2soZWwsIGJpbmRpbmcsIHZub2RlLCBwcmV2Vk5vZGUsIGhvb2spIHtcclxuICAgIGxldCBtb2RlbFRvVXNlO1xyXG4gICAgc3dpdGNoIChlbC50YWdOYW1lKSB7XHJcbiAgICAgICAgY2FzZSAnU0VMRUNUJzpcclxuICAgICAgICAgICAgbW9kZWxUb1VzZSA9IHZNb2RlbFNlbGVjdDtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAnVEVYVEFSRUEnOlxyXG4gICAgICAgICAgICBtb2RlbFRvVXNlID0gdk1vZGVsVGV4dDtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgc3dpdGNoICh2bm9kZS5wcm9wcyAmJiB2bm9kZS5wcm9wcy50eXBlKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdjaGVja2JveCc6XHJcbiAgICAgICAgICAgICAgICAgICAgbW9kZWxUb1VzZSA9IHZNb2RlbENoZWNrYm94O1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAncmFkaW8nOlxyXG4gICAgICAgICAgICAgICAgICAgIG1vZGVsVG9Vc2UgPSB2TW9kZWxSYWRpbztcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgbW9kZWxUb1VzZSA9IHZNb2RlbFRleHQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgIH1cclxuICAgIGNvbnN0IGZuID0gbW9kZWxUb1VzZVtob29rXTtcclxuICAgIGZuICYmIGZuKGVsLCBiaW5kaW5nLCB2bm9kZSwgcHJldlZOb2RlKTtcclxufVxyXG4vLyBTU1Igdm5vZGUgdHJhbnNmb3Jtcywgb25seSB1c2VkIHdoZW4gdXNlciBpbmNsdWRlcyBjbGllbnQtb3JpZW50ZWQgcmVuZGVyXHJcbi8vIGZ1bmN0aW9uIGluIFNTUlxyXG5mdW5jdGlvbiBpbml0Vk1vZGVsRm9yU1NSKCkge1xyXG4gICAgdk1vZGVsVGV4dC5nZXRTU1JQcm9wcyA9ICh7IHZhbHVlIH0pID0+ICh7IHZhbHVlIH0pO1xyXG4gICAgdk1vZGVsUmFkaW8uZ2V0U1NSUHJvcHMgPSAoeyB2YWx1ZSB9LCB2bm9kZSkgPT4ge1xyXG4gICAgICAgIGlmICh2bm9kZS5wcm9wcyAmJiBsb29zZUVxdWFsKHZub2RlLnByb3BzLnZhbHVlLCB2YWx1ZSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHsgY2hlY2tlZDogdHJ1ZSB9O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICB2TW9kZWxDaGVja2JveC5nZXRTU1JQcm9wcyA9ICh7IHZhbHVlIH0sIHZub2RlKSA9PiB7XHJcbiAgICAgICAgaWYgKGlzQXJyYXkodmFsdWUpKSB7XHJcbiAgICAgICAgICAgIGlmICh2bm9kZS5wcm9wcyAmJiBsb29zZUluZGV4T2YodmFsdWUsIHZub2RlLnByb3BzLnZhbHVlKSA+IC0xKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4geyBjaGVja2VkOiB0cnVlIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoaXNTZXQodmFsdWUpKSB7XHJcbiAgICAgICAgICAgIGlmICh2bm9kZS5wcm9wcyAmJiB2YWx1ZS5oYXModm5vZGUucHJvcHMudmFsdWUpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4geyBjaGVja2VkOiB0cnVlIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodmFsdWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHsgY2hlY2tlZDogdHJ1ZSB9O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn1cblxuY29uc3Qgc3lzdGVtTW9kaWZpZXJzID0gWydjdHJsJywgJ3NoaWZ0JywgJ2FsdCcsICdtZXRhJ107XHJcbmNvbnN0IG1vZGlmaWVyR3VhcmRzID0ge1xyXG4gICAgc3RvcDogZSA9PiBlLnN0b3BQcm9wYWdhdGlvbigpLFxyXG4gICAgcHJldmVudDogZSA9PiBlLnByZXZlbnREZWZhdWx0KCksXHJcbiAgICBzZWxmOiBlID0+IGUudGFyZ2V0ICE9PSBlLmN1cnJlbnRUYXJnZXQsXHJcbiAgICBjdHJsOiBlID0+ICFlLmN0cmxLZXksXHJcbiAgICBzaGlmdDogZSA9PiAhZS5zaGlmdEtleSxcclxuICAgIGFsdDogZSA9PiAhZS5hbHRLZXksXHJcbiAgICBtZXRhOiBlID0+ICFlLm1ldGFLZXksXHJcbiAgICBsZWZ0OiBlID0+ICdidXR0b24nIGluIGUgJiYgZS5idXR0b24gIT09IDAsXHJcbiAgICBtaWRkbGU6IGUgPT4gJ2J1dHRvbicgaW4gZSAmJiBlLmJ1dHRvbiAhPT0gMSxcclxuICAgIHJpZ2h0OiBlID0+ICdidXR0b24nIGluIGUgJiYgZS5idXR0b24gIT09IDIsXHJcbiAgICBleGFjdDogKGUsIG1vZGlmaWVycykgPT4gc3lzdGVtTW9kaWZpZXJzLnNvbWUobSA9PiBlW2Ake219S2V5YF0gJiYgIW1vZGlmaWVycy5pbmNsdWRlcyhtKSlcclxufTtcclxuLyoqXHJcbiAqIEBwcml2YXRlXHJcbiAqL1xyXG5jb25zdCB3aXRoTW9kaWZpZXJzID0gKGZuLCBtb2RpZmllcnMpID0+IHtcclxuICAgIHJldHVybiAoZXZlbnQsIC4uLmFyZ3MpID0+IHtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG1vZGlmaWVycy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBjb25zdCBndWFyZCA9IG1vZGlmaWVyR3VhcmRzW21vZGlmaWVyc1tpXV07XHJcbiAgICAgICAgICAgIGlmIChndWFyZCAmJiBndWFyZChldmVudCwgbW9kaWZpZXJzKSlcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZuKGV2ZW50LCAuLi5hcmdzKTtcclxuICAgIH07XHJcbn07XHJcbi8vIEtlcHQgZm9yIDIueCBjb21wYXQuXHJcbi8vIE5vdGU6IElFMTEgY29tcGF0IGZvciBgc3BhY2ViYXJgIGFuZCBgZGVsYCBpcyByZW1vdmVkIGZvciBub3cuXHJcbmNvbnN0IGtleU5hbWVzID0ge1xyXG4gICAgZXNjOiAnZXNjYXBlJyxcclxuICAgIHNwYWNlOiAnICcsXHJcbiAgICB1cDogJ2Fycm93LXVwJyxcclxuICAgIGxlZnQ6ICdhcnJvdy1sZWZ0JyxcclxuICAgIHJpZ2h0OiAnYXJyb3ctcmlnaHQnLFxyXG4gICAgZG93bjogJ2Fycm93LWRvd24nLFxyXG4gICAgZGVsZXRlOiAnYmFja3NwYWNlJ1xyXG59O1xyXG4vKipcclxuICogQHByaXZhdGVcclxuICovXHJcbmNvbnN0IHdpdGhLZXlzID0gKGZuLCBtb2RpZmllcnMpID0+IHtcclxuICAgIHJldHVybiAoZXZlbnQpID0+IHtcclxuICAgICAgICBpZiAoISgna2V5JyBpbiBldmVudCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBldmVudEtleSA9IGh5cGhlbmF0ZShldmVudC5rZXkpO1xyXG4gICAgICAgIGlmIChtb2RpZmllcnMuc29tZShrID0+IGsgPT09IGV2ZW50S2V5IHx8IGtleU5hbWVzW2tdID09PSBldmVudEtleSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZuKGV2ZW50KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59O1xuXG5jb25zdCB2U2hvdyA9IHtcclxuICAgIGJlZm9yZU1vdW50KGVsLCB7IHZhbHVlIH0sIHsgdHJhbnNpdGlvbiB9KSB7XHJcbiAgICAgICAgZWwuX3ZvZCA9IGVsLnN0eWxlLmRpc3BsYXkgPT09ICdub25lJyA/ICcnIDogZWwuc3R5bGUuZGlzcGxheTtcclxuICAgICAgICBpZiAodHJhbnNpdGlvbiAmJiB2YWx1ZSkge1xyXG4gICAgICAgICAgICB0cmFuc2l0aW9uLmJlZm9yZUVudGVyKGVsKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHNldERpc3BsYXkoZWwsIHZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgbW91bnRlZChlbCwgeyB2YWx1ZSB9LCB7IHRyYW5zaXRpb24gfSkge1xyXG4gICAgICAgIGlmICh0cmFuc2l0aW9uICYmIHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHRyYW5zaXRpb24uZW50ZXIoZWwpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICB1cGRhdGVkKGVsLCB7IHZhbHVlLCBvbGRWYWx1ZSB9LCB7IHRyYW5zaXRpb24gfSkge1xyXG4gICAgICAgIGlmICghdmFsdWUgPT09ICFvbGRWYWx1ZSlcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIGlmICh0cmFuc2l0aW9uKSB7XHJcbiAgICAgICAgICAgIGlmICh2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgdHJhbnNpdGlvbi5iZWZvcmVFbnRlcihlbCk7XHJcbiAgICAgICAgICAgICAgICBzZXREaXNwbGF5KGVsLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgIHRyYW5zaXRpb24uZW50ZXIoZWwpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdHJhbnNpdGlvbi5sZWF2ZShlbCwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHNldERpc3BsYXkoZWwsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBzZXREaXNwbGF5KGVsLCB2YWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGJlZm9yZVVubW91bnQoZWwsIHsgdmFsdWUgfSkge1xyXG4gICAgICAgIHNldERpc3BsYXkoZWwsIHZhbHVlKTtcclxuICAgIH1cclxufTtcclxuZnVuY3Rpb24gc2V0RGlzcGxheShlbCwgdmFsdWUpIHtcclxuICAgIGVsLnN0eWxlLmRpc3BsYXkgPSB2YWx1ZSA/IGVsLl92b2QgOiAnbm9uZSc7XHJcbn1cclxuLy8gU1NSIHZub2RlIHRyYW5zZm9ybXMsIG9ubHkgdXNlZCB3aGVuIHVzZXIgaW5jbHVkZXMgY2xpZW50LW9yaWVudGVkIHJlbmRlclxyXG4vLyBmdW5jdGlvbiBpbiBTU1JcclxuZnVuY3Rpb24gaW5pdFZTaG93Rm9yU1NSKCkge1xyXG4gICAgdlNob3cuZ2V0U1NSUHJvcHMgPSAoeyB2YWx1ZSB9KSA9PiB7XHJcbiAgICAgICAgaWYgKCF2YWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4geyBzdHlsZTogeyBkaXNwbGF5OiAnbm9uZScgfSB9O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn1cblxuY29uc3QgcmVuZGVyZXJPcHRpb25zID0gZXh0ZW5kKHsgcGF0Y2hQcm9wIH0sIG5vZGVPcHMpO1xyXG4vLyBsYXp5IGNyZWF0ZSB0aGUgcmVuZGVyZXIgLSB0aGlzIG1ha2VzIGNvcmUgcmVuZGVyZXIgbG9naWMgdHJlZS1zaGFrYWJsZVxyXG4vLyBpbiBjYXNlIHRoZSB1c2VyIG9ubHkgaW1wb3J0cyByZWFjdGl2aXR5IHV0aWxpdGllcyBmcm9tIFZ1ZS5cclxubGV0IHJlbmRlcmVyO1xyXG5sZXQgZW5hYmxlZEh5ZHJhdGlvbiA9IGZhbHNlO1xyXG5mdW5jdGlvbiBlbnN1cmVSZW5kZXJlcigpIHtcclxuICAgIHJldHVybiAocmVuZGVyZXIgfHxcclxuICAgICAgICAocmVuZGVyZXIgPSBjcmVhdGVSZW5kZXJlcihyZW5kZXJlck9wdGlvbnMpKSk7XHJcbn1cclxuZnVuY3Rpb24gZW5zdXJlSHlkcmF0aW9uUmVuZGVyZXIoKSB7XHJcbiAgICByZW5kZXJlciA9IGVuYWJsZWRIeWRyYXRpb25cclxuICAgICAgICA/IHJlbmRlcmVyXHJcbiAgICAgICAgOiBjcmVhdGVIeWRyYXRpb25SZW5kZXJlcihyZW5kZXJlck9wdGlvbnMpO1xyXG4gICAgZW5hYmxlZEh5ZHJhdGlvbiA9IHRydWU7XHJcbiAgICByZXR1cm4gcmVuZGVyZXI7XHJcbn1cclxuLy8gdXNlIGV4cGxpY2l0IHR5cGUgY2FzdHMgaGVyZSB0byBhdm9pZCBpbXBvcnQoKSBjYWxscyBpbiByb2xsZWQtdXAgZC50c1xyXG5jb25zdCByZW5kZXIgPSAoKC4uLmFyZ3MpID0+IHtcclxuICAgIGVuc3VyZVJlbmRlcmVyKCkucmVuZGVyKC4uLmFyZ3MpO1xyXG59KTtcclxuY29uc3QgaHlkcmF0ZSA9ICgoLi4uYXJncykgPT4ge1xyXG4gICAgZW5zdXJlSHlkcmF0aW9uUmVuZGVyZXIoKS5oeWRyYXRlKC4uLmFyZ3MpO1xyXG59KTtcclxuY29uc3QgY3JlYXRlQXBwID0gKCguLi5hcmdzKSA9PiB7XHJcbiAgICBjb25zdCBhcHAgPSBlbnN1cmVSZW5kZXJlcigpLmNyZWF0ZUFwcCguLi5hcmdzKTtcclxuICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICBpbmplY3ROYXRpdmVUYWdDaGVjayhhcHApO1xyXG4gICAgICAgIGluamVjdENvbXBpbGVyT3B0aW9uc0NoZWNrKGFwcCk7XHJcbiAgICB9XHJcbiAgICBjb25zdCB7IG1vdW50IH0gPSBhcHA7XHJcbiAgICBhcHAubW91bnQgPSAoY29udGFpbmVyT3JTZWxlY3RvcikgPT4ge1xyXG4gICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IG5vcm1hbGl6ZUNvbnRhaW5lcihjb250YWluZXJPclNlbGVjdG9yKTtcclxuICAgICAgICBpZiAoIWNvbnRhaW5lcilcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIGNvbnN0IGNvbXBvbmVudCA9IGFwcC5fY29tcG9uZW50O1xyXG4gICAgICAgIGlmICghaXNGdW5jdGlvbihjb21wb25lbnQpICYmICFjb21wb25lbnQucmVuZGVyICYmICFjb21wb25lbnQudGVtcGxhdGUpIHtcclxuICAgICAgICAgICAgLy8gX19VTlNBRkVfX1xyXG4gICAgICAgICAgICAvLyBSZWFzb246IHBvdGVudGlhbCBleGVjdXRpb24gb2YgSlMgZXhwcmVzc2lvbnMgaW4gaW4tRE9NIHRlbXBsYXRlLlxyXG4gICAgICAgICAgICAvLyBUaGUgdXNlciBtdXN0IG1ha2Ugc3VyZSB0aGUgaW4tRE9NIHRlbXBsYXRlIGlzIHRydXN0ZWQuIElmIGl0J3NcclxuICAgICAgICAgICAgLy8gcmVuZGVyZWQgYnkgdGhlIHNlcnZlciwgdGhlIHRlbXBsYXRlIHNob3VsZCBub3QgY29udGFpbiBhbnkgdXNlciBkYXRhLlxyXG4gICAgICAgICAgICBjb21wb25lbnQudGVtcGxhdGUgPSBjb250YWluZXIuaW5uZXJIVE1MO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBjbGVhciBjb250ZW50IGJlZm9yZSBtb3VudGluZ1xyXG4gICAgICAgIGNvbnRhaW5lci5pbm5lckhUTUwgPSAnJztcclxuICAgICAgICBjb25zdCBwcm94eSA9IG1vdW50KGNvbnRhaW5lciwgZmFsc2UsIGNvbnRhaW5lciBpbnN0YW5jZW9mIFNWR0VsZW1lbnQpO1xyXG4gICAgICAgIGlmIChjb250YWluZXIgaW5zdGFuY2VvZiBFbGVtZW50KSB7XHJcbiAgICAgICAgICAgIGNvbnRhaW5lci5yZW1vdmVBdHRyaWJ1dGUoJ3YtY2xvYWsnKTtcclxuICAgICAgICAgICAgY29udGFpbmVyLnNldEF0dHJpYnV0ZSgnZGF0YS12LWFwcCcsICcnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHByb3h5O1xyXG4gICAgfTtcclxuICAgIHJldHVybiBhcHA7XHJcbn0pO1xyXG5jb25zdCBjcmVhdGVTU1JBcHAgPSAoKC4uLmFyZ3MpID0+IHtcclxuICAgIGNvbnN0IGFwcCA9IGVuc3VyZUh5ZHJhdGlvblJlbmRlcmVyKCkuY3JlYXRlQXBwKC4uLmFyZ3MpO1xyXG4gICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgIGluamVjdE5hdGl2ZVRhZ0NoZWNrKGFwcCk7XHJcbiAgICAgICAgaW5qZWN0Q29tcGlsZXJPcHRpb25zQ2hlY2soYXBwKTtcclxuICAgIH1cclxuICAgIGNvbnN0IHsgbW91bnQgfSA9IGFwcDtcclxuICAgIGFwcC5tb3VudCA9IChjb250YWluZXJPclNlbGVjdG9yKSA9PiB7XHJcbiAgICAgICAgY29uc3QgY29udGFpbmVyID0gbm9ybWFsaXplQ29udGFpbmVyKGNvbnRhaW5lck9yU2VsZWN0b3IpO1xyXG4gICAgICAgIGlmIChjb250YWluZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG1vdW50KGNvbnRhaW5lciwgdHJ1ZSwgY29udGFpbmVyIGluc3RhbmNlb2YgU1ZHRWxlbWVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBhcHA7XHJcbn0pO1xyXG5mdW5jdGlvbiBpbmplY3ROYXRpdmVUYWdDaGVjayhhcHApIHtcclxuICAgIC8vIEluamVjdCBgaXNOYXRpdmVUYWdgXHJcbiAgICAvLyB0aGlzIGlzIHVzZWQgZm9yIGNvbXBvbmVudCBuYW1lIHZhbGlkYXRpb24gKGRldiBvbmx5KVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGFwcC5jb25maWcsICdpc05hdGl2ZVRhZycsIHtcclxuICAgICAgICB2YWx1ZTogKHRhZykgPT4gaXNIVE1MVGFnKHRhZykgfHwgaXNTVkdUYWcodGFnKSxcclxuICAgICAgICB3cml0YWJsZTogZmFsc2VcclxuICAgIH0pO1xyXG59XHJcbi8vIGRldiBvbmx5XHJcbmZ1bmN0aW9uIGluamVjdENvbXBpbGVyT3B0aW9uc0NoZWNrKGFwcCkge1xyXG4gICAgaWYgKGlzUnVudGltZU9ubHkoKSkge1xyXG4gICAgICAgIGNvbnN0IGlzQ3VzdG9tRWxlbWVudCA9IGFwcC5jb25maWcuaXNDdXN0b21FbGVtZW50O1xyXG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShhcHAuY29uZmlnLCAnaXNDdXN0b21FbGVtZW50Jywge1xyXG4gICAgICAgICAgICBnZXQoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaXNDdXN0b21FbGVtZW50O1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBzZXQoKSB7XHJcbiAgICAgICAgICAgICAgICB3YXJuKGBUaGUgXFxgaXNDdXN0b21FbGVtZW50XFxgIGNvbmZpZyBvcHRpb24gaXMgZGVwcmVjYXRlZC4gVXNlIGAgK1xyXG4gICAgICAgICAgICAgICAgICAgIGBcXGBjb21waWxlck9wdGlvbnMuaXNDdXN0b21FbGVtZW50XFxgIGluc3RlYWQuYCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBjb25zdCBjb21waWxlck9wdGlvbnMgPSBhcHAuY29uZmlnLmNvbXBpbGVyT3B0aW9ucztcclxuICAgICAgICBjb25zdCBtc2cgPSBgVGhlIFxcYGNvbXBpbGVyT3B0aW9uc1xcYCBjb25maWcgb3B0aW9uIGlzIG9ubHkgcmVzcGVjdGVkIHdoZW4gdXNpbmcgYCArXHJcbiAgICAgICAgICAgIGBhIGJ1aWxkIG9mIFZ1ZS5qcyB0aGF0IGluY2x1ZGVzIHRoZSBydW50aW1lIGNvbXBpbGVyIChha2EgXCJmdWxsIGJ1aWxkXCIpLiBgICtcclxuICAgICAgICAgICAgYFNpbmNlIHlvdSBhcmUgdXNpbmcgdGhlIHJ1bnRpbWUtb25seSBidWlsZCwgXFxgY29tcGlsZXJPcHRpb25zXFxgIGAgK1xyXG4gICAgICAgICAgICBgbXVzdCBiZSBwYXNzZWQgdG8gXFxgQHZ1ZS9jb21waWxlci1kb21cXGAgaW4gdGhlIGJ1aWxkIHNldHVwIGluc3RlYWQuXFxuYCArXHJcbiAgICAgICAgICAgIGAtIEZvciB2dWUtbG9hZGVyOiBwYXNzIGl0IHZpYSB2dWUtbG9hZGVyJ3MgXFxgY29tcGlsZXJPcHRpb25zXFxgIGxvYWRlciBvcHRpb24uXFxuYCArXHJcbiAgICAgICAgICAgIGAtIEZvciB2dWUtY2xpOiBzZWUgaHR0cHM6Ly9jbGkudnVlanMub3JnL2d1aWRlL3dlYnBhY2suaHRtbCNtb2RpZnlpbmctb3B0aW9ucy1vZi1hLWxvYWRlclxcbmAgK1xyXG4gICAgICAgICAgICBgLSBGb3Igdml0ZTogcGFzcyBpdCB2aWEgQHZpdGVqcy9wbHVnaW4tdnVlIG9wdGlvbnMuIFNlZSBodHRwczovL2dpdGh1Yi5jb20vdml0ZWpzL3ZpdGUvdHJlZS9tYWluL3BhY2thZ2VzL3BsdWdpbi12dWUjZXhhbXBsZS1mb3ItcGFzc2luZy1vcHRpb25zLXRvLXZ1ZWNvbXBpbGVyLWRvbWA7XHJcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGFwcC5jb25maWcsICdjb21waWxlck9wdGlvbnMnLCB7XHJcbiAgICAgICAgICAgIGdldCgpIHtcclxuICAgICAgICAgICAgICAgIHdhcm4obXNnKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjb21waWxlck9wdGlvbnM7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHNldCgpIHtcclxuICAgICAgICAgICAgICAgIHdhcm4obXNnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIG5vcm1hbGl6ZUNvbnRhaW5lcihjb250YWluZXIpIHtcclxuICAgIGlmIChpc1N0cmluZyhjb250YWluZXIpKSB7XHJcbiAgICAgICAgY29uc3QgcmVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXIpO1xyXG4gICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiYgIXJlcykge1xyXG4gICAgICAgICAgICB3YXJuKGBGYWlsZWQgdG8gbW91bnQgYXBwOiBtb3VudCB0YXJnZXQgc2VsZWN0b3IgXCIke2NvbnRhaW5lcn1cIiByZXR1cm5lZCBudWxsLmApO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzO1xyXG4gICAgfVxyXG4gICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJlxyXG4gICAgICAgIHdpbmRvdy5TaGFkb3dSb290ICYmXHJcbiAgICAgICAgY29udGFpbmVyIGluc3RhbmNlb2Ygd2luZG93LlNoYWRvd1Jvb3QgJiZcclxuICAgICAgICBjb250YWluZXIubW9kZSA9PT0gJ2Nsb3NlZCcpIHtcclxuICAgICAgICB3YXJuKGBtb3VudGluZyBvbiBhIFNoYWRvd1Jvb3Qgd2l0aCBcXGB7bW9kZTogXCJjbG9zZWRcIn1cXGAgbWF5IGxlYWQgdG8gdW5wcmVkaWN0YWJsZSBidWdzYCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gY29udGFpbmVyO1xyXG59XHJcbmxldCBzc3JEaXJlY3RpdmVJbml0aWFsaXplZCA9IGZhbHNlO1xyXG4vKipcclxuICogQGludGVybmFsXHJcbiAqL1xyXG5jb25zdCBpbml0RGlyZWN0aXZlc0ZvclNTUiA9ICgpID0+IHtcclxuICAgICAgICBpZiAoIXNzckRpcmVjdGl2ZUluaXRpYWxpemVkKSB7XHJcbiAgICAgICAgICAgIHNzckRpcmVjdGl2ZUluaXRpYWxpemVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgaW5pdFZNb2RlbEZvclNTUigpO1xyXG4gICAgICAgICAgICBpbml0VlNob3dGb3JTU1IoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICA7XG5cbmV4cG9ydCB7IFRyYW5zaXRpb24sIFRyYW5zaXRpb25Hcm91cCwgVnVlRWxlbWVudCwgY3JlYXRlQXBwLCBjcmVhdGVTU1JBcHAsIGRlZmluZUN1c3RvbUVsZW1lbnQsIGRlZmluZVNTUkN1c3RvbUVsZW1lbnQsIGh5ZHJhdGUsIGluaXREaXJlY3RpdmVzRm9yU1NSLCByZW5kZXIsIHVzZUNzc01vZHVsZSwgdXNlQ3NzVmFycywgdk1vZGVsQ2hlY2tib3gsIHZNb2RlbER5bmFtaWMsIHZNb2RlbFJhZGlvLCB2TW9kZWxTZWxlY3QsIHZNb2RlbFRleHQsIHZTaG93LCB3aXRoS2V5cywgd2l0aE1vZGlmaWVycyB9O1xuIiwiXG5jb25zb2xlLmFzc2VydCA9IChjb25kaXRpb24sIG1zZykgPT4ge1xuICBpZighY29uZGl0aW9uKSB7XG4gICAgLy8gY29uc29sZS5sb2coLi4ubXNnKTtcbiAgICBjb25zb2xlLmxvZyhuZXcgRXJyb3IobXNnKSk7XG4gIH1cbn1cblxuY29uc3Qgbm8gPSBvID0+IG8gJiYgSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShvKSk7IC8vIG5vcm1hbGl6ZSAoYW5kIGZyZWV6ZSkgb2JqZWN0IGZvciBjb25zb2xlIG91dHB1dCAoY2FuJ3QgaGFuZGxlIGN5Y2xpYyBvYmplY3RzKVxuXG5mdW5jdGlvbiBsYXN0KGFycikge1xuICByZXR1cm4gYXJyW2Fyci5sZW5ndGggLSAxXTtcbn1cblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0gaWQgLS0tLS0tLS0tLS0tLS0tLS0tXG5cbmNvbnN0IHN5bWJvbHMgPSAnMDk4NzY1NDMyMWFiY2RlZmdoaWprbG1ub3Byc3R1dnl6JztcblxuZXhwb3J0IGZ1bmN0aW9uIHJhbmRvbUlEKG49NCkge1xuICBjb25zdCBsID0gc3ltYm9scy5sZW5ndGg7XG4gIGNvbnN0IGsgPSBNYXRoLnBvdyhsLCBuKTtcbiAgLy8gbGV0IHIgPSByYW5kSW50KGspXG4gIGxldCByID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogayk7XG4gIGNvbnN0IGlkID0gW107XG4gIGZvcihsZXQgaT0wOyBpPG47IGkrPTEpIHtcbiAgICBpZC5wdXNoKHN5bWJvbHNbciAlIGxdKVxuICAgIHIgPSBNYXRoLmZsb29yKHIgLyBsKVxuICB9XG4gIHJldHVybiBpZC5qb2luKCcnKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG5ld0lEKHBhcmVudElEKSB7XG4gIHJldHVybiByYW5kb21JRCgpO1xufVxuXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vIERPTSBvbmx5IC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4vLyBwYXJzZSBnZW5lcmFsIERPTSAoZXh0cmFjdCBwYXJhZ3JhcGhzIGFuZCBzcGFucyB3aXRoIGZvcm1hdHRpbmdcbmV4cG9ydCBmdW5jdGlvbiBwYXJzZVZhbmlsbGFET00ocm9vdE5vZGUsIGNzc1J1bGVzKSB7XG5cbiAgbGV0IHVuZGVybGluZUNsYXNzZXMgPSBbXTtcblxuICBpZihjc3NSdWxlcykge1xuICAgIGZvcihjb25zdCBydWxlIG9mIGNzc1J1bGVzKSB7XG4gICAgICBpZihydWxlLnNlbGVjdG9yVGV4dC5zZWFyY2goL1sjOlxcW1xcXT5dL2cpICE9PSAtMSkge1xuICAgICAgICAvLyBza2lwIHJ1bGVzIHdpdGggaWQgc2VsZWN0b3Igb3Igb3RoZXIgY29tcGxleCBzZWxlY3RvcnNcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICAvLyBjb25zb2xlLmxvZyhydWxlLmNzc1RleHQpO1xuICAgICAgLy8gY29uc29sZS5sb2cocnVsZS5zZWxlY3RvclRleHQpO1xuICAgICAgLy8gY29uc29sZS5sb2cocnVsZS5zdHlsZS5jc3NUZXh0KTtcbiAgICAgIC8vIGNvbnNvbGUubG9nKHJ1bGUuc3R5bGUudGV4dERlY29yYXRpb25MaW5lKTtcbiAgICAgIC8vIGNvbnNvbGUubG9nKHJ1bGUpXG4gICAgICBpZihydWxlLnN0eWxlLnRleHREZWNvcmF0aW9uTGluZSA9PT0gJ3VuZGVybGluZScpIHtcbiAgICAgICAgY29uc3Qgc2VsZWN0b3JzID0gcnVsZS5zZWxlY3RvclRleHQuc3BsaXQoJywnKTtcbiAgICAgICAgZm9yKGNvbnN0IHNlbGVjdG9yIG9mIHNlbGVjdG9ycykge1xuICAgICAgICAgIGNvbnN0IHBhcnRzID0gc2VsZWN0b3Iuc3BsaXQoJzonKVswXS5zcGxpdCgnLicpO1xuICAgICAgICAgIGNvbnN0IHRhZyA9IHBhcnRzLnNoaWZ0KCk7XG4gICAgICAgICAgdW5kZXJsaW5lQ2xhc3NlcyA9IHBhcnRzO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8gY29uc29sZS5sb2coJ3VuZGVybGluZScsIHVuZGVybGluZUNsYXNzZXMpXG5cbiAgY29uc3Qgc3RhY2sgPSBbXTtcbiAgY29uc3QgcGFyYWdyYXBocyA9IFtdO1xuICBsZXQgZm10ID0ge307XG4gIGxldCBwYXJhZ3JhcGggPSB1bmRlZmluZWQ7XG5cbiAgbGV0IG5vZGUgPSByb290Tm9kZTsgIC8vIHJvb3Qgbm9kZSBpdHNlbGYgaXMgbm90IFwicGFyc2VkXCJcblxuICBsZXQgbiwgaSA9IDA7XG4gIHdoaWxlKG5vZGUpIHtcbiAgICBjb25zdCBjaGlsZE5vZGVzID0gbm9kZS5jaGlsZE5vZGVzO1xuICAgIG4gPSBjaGlsZE5vZGVzLmxlbmd0aDtcbiAgICBmb3IoOyBpPG47IGkrKykge1xuICAgICAgY29uc3QgY2hpbGQgPSBjaGlsZE5vZGVzW2ldO1xuXG4gICAgICAvLyBjb25zb2xlLmxvZygnQ0hJTEQnLCBjaGlsZC5ub2RlVHlwZSwgY2hpbGQubm9kZU5hbWUsIGNoaWxkLm5vZGVWYWx1ZSwgY2hpbGQuY2hpbGROb2Rlcyk7XG5cbiAgICAgIGlmKGNoaWxkLm5vZGVUeXBlID09PSBOb2RlLlRFWFRfTk9ERSAmJiBjaGlsZC5ub2RlVmFsdWUubGVuZ3RoID4gMCkge1xuXG4gICAgICAgIGlmKGNoaWxkLm5vZGVWYWx1ZS50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cblxuICAgICAgICBpZighcGFyYWdyYXBoKSB7XG4gICAgICAgICAgLy8gY29uc29sZS5sb2coJ05FVyBQQVJBJylcbiAgICAgICAgICBwYXJhZ3JhcGggPSB7IHNwYW5zOiBbXSwgaWQ6IG5ld0lEKCkgfTtcbiAgICAgICAgICBwYXJhZ3JhcGhzLnB1c2gocGFyYWdyYXBoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCdTVE9SRSBTUEFOJywgeyB0ZXh0OiBjaGlsZC5ub2RlVmFsdWUsIGZvcm1hdDogT2JqZWN0LmFzc2lnbih7fSwgZm10KSwgaWQ6IG5ld0lEKCkgfSlcbiAgICAgICAgcGFyYWdyYXBoLnNwYW5zLnB1c2goeyB0ZXh0OiBjaGlsZC5ub2RlVmFsdWUsIGZvcm1hdDogT2JqZWN0LmFzc2lnbih7fSwgZm10KSwgaWQ6IG5ld0lEKCkgfSk7XG5cbiAgICAgIH0gZWxzZSBpZihjaGlsZC5ub2RlVHlwZSA9PT0gTm9kZS5FTEVNRU5UX05PREUpIHtcblxuICAgICAgICBjb25zdCBjaGlsZEZtdCA9IE9iamVjdC5hc3NpZ24oe30sIGZtdCk7XG4gICAgICAgIGNvbnN0IG5vZGVGbXQgPSBPYmplY3QuYXNzaWduKHt9LCBmbXQpO1xuXG4gICAgICAgIC8vIGNoZWNrIHRhZyBuYW1lXG4gICAgICAgIGlmKGNoaWxkLm5vZGVOYW1lID09PSAnQicgfHwgY2hpbGQubm9kZU5hbWUgPT09ICdTVFJPTkcnKSB7XG4gICAgICAgICAgZm10LmJvbGQgPSB0cnVlO1xuICAgICAgICB9IGVsc2UgaWYoY2hpbGQubm9kZU5hbWUgPT09ICdJJyB8fCBjaGlsZC5ub2RlTmFtZSA9PT0gJ0VNJykge1xuICAgICAgICAgIGZtdC5pdGFsaWMgPSB0cnVlO1xuICAgICAgICB9IGVsc2UgaWYoY2hpbGQubm9kZU5hbWUgPT09ICdVJykge1xuICAgICAgICAgIGZtdC51bmRlcmxpbmUgPSB0cnVlO1xuICAgICAgICB9IGVsc2UgaWYoY2hpbGQubm9kZU5hbWUgPT09ICdTVVAnKSB7XG4gICAgICAgICAgZm10LnN1cGVyc2NyaXB0ID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIGlmKGNoaWxkLm5vZGVOYW1lID09PSAnU1VCJykge1xuICAgICAgICAgIGZtdC5zdWJzY3JpcHQgPSB0cnVlO1xuICAgICAgICB9IGVsc2UgaWYoY2hpbGQubm9kZU5hbWUgPT09ICdTUEFOJykge1xuICAgICAgICAgIGZvcihjb25zdCBjbHMgb2YgY2hpbGQuY2xhc3NMaXN0KSB7XG4gICAgICAgICAgICBpZih1bmRlcmxpbmVDbGFzc2VzLmluZGV4T2YoY2xzKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgZm10LnVuZGVybGluZSA9IHRydWU7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmKGNoaWxkLm5vZGVOYW1lID09PSAnUCcpIHtcbiAgICAgICAgICBwYXJhZ3JhcGggPSB7IHNwYW5zOiBbXSwgaWQ6IG5ld0lEKCkgfTtcbiAgICAgICAgICBwYXJhZ3JhcGhzLnB1c2gocGFyYWdyYXBoKTtcbiAgICAgICAgfSBlbHNlIGlmKGNoaWxkLm5vZGVOYW1lID09PSAnTEknKSB7XG4gICAgICAgICAgcGFyYWdyYXBoID0geyBzcGFuczogW10sIGlkOiBuZXdJRCgpLCBidWxsZXQ6IHRydWUgfTtcbiAgICAgICAgICBwYXJhZ3JhcGhzLnB1c2gocGFyYWdyYXBoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGRlYWwgd2l0aCBjaGlsZHJlblxuICAgICAgICBpZihub2RlLmNoaWxkTm9kZXMgJiYgbm9kZS5jaGlsZE5vZGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAvLyBjb25zb2xlLmxvZygnUFVTSCcsIGksIG5vZGUsIG5vZGVGbXQsICdjb250aW51ZSB3aXRoJywgT2JqZWN0LmFzc2lnbih7fSwgZm10KSlcbiAgICAgICAgICBzdGFjay5wdXNoKHsgbm9kZSwgaTogaSsxLCBmbXQ6IE9iamVjdC5hc3NpZ24oe30sIG5vZGVGbXQpIH0pXG4gICAgICAgICAgaSA9IDA7XG4gICAgICAgICAgbm9kZSA9IGNoaWxkO1xuICAgICAgICAgIG4gPSBub2RlLmNoaWxkTm9kZXMubGVuZ3RoO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGlmKGkgPj0gbikge1xuICAgICAgaWYoc3RhY2subGVuZ3RoID4gMCkge1xuICAgICAgICBpZihub2RlLm5vZGVOYW1lID09PSAnUCcgfHwgbm9kZS5ub2RlTmFtZSA9PT0gJ0xJJykge1xuICAgICAgICAgIHBhcmFncmFwaCA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBpdGVtID0gc3RhY2sucG9wKCk7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCdQT1AnLCBpdGVtKVxuICAgICAgICBpID0gaXRlbS5pO1xuICAgICAgICBub2RlID0gaXRlbS5ub2RlO1xuICAgICAgICBmbXQgPSBpdGVtLmZtdDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG5vZGUgPSBudWxsO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gcGFyYWdyYXBocztcbn1cblxuLy8gcGFyc2UgZWRpdG9yIERPTVxuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlRE9NKHJvb3ROb2RlKSB7XG5cblxuICBjb25zdCBhdHRyVmFsdWUgPSAoYXR0ciwgdHJhbnNmb3JtKSA9PiB7XG4gICAgbGV0IHZhbHVlID0gYXR0cjtcbiAgICBpZih2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB2YWx1ZSA9IHZhbHVlLm5vZGVWYWx1ZTtcbiAgICB9XG4gICAgaWYodmFsdWUgIT09IHVuZGVmaW5lZCAmJiB0cmFuc2Zvcm0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgdmFsdWUgPSB0cmFuc2Zvcm0odmFsdWUpO1xuICAgIH1cbiAgICByZXR1cm4gdmFsdWVcbiAgfTtcblxuICBjb25zdCBwYXJhZ3JhcGhzID0gW107XG5cbiAgLy8gcGxhaW50ZXh0MTxici8+cGxhaW50ZXh0MjxkaXYgcGFyYT5wYXJhaGVhZDxzcGFuPnNwYW48L3NwYW4+cGFyYWZvb3Q8L2RpdiBwYXJhPnBsYWludGV4dDNcbiAgLy8gbWFwcG9qYXMgdXpcbiAgLy8gW1xuICAvLyAgPHBhcmE+cGxhaW50ZXh0MTwvcGFyYT5cbiAgLy8gIDxwYXJhPnBsYWludGV4dDI8L3BhcmE+XG4gIC8vICA8cGFyYT48c3Bhbj5wYXJhaGVhZHNwYW5wYXJhZm9vdDwvc3Bhbj48cGFyYT5cbiAgLy8gIDxwYXJhPnBsYWludGV4dDM8L3BhcmE+XG4gIC8vIF1cblxuICAvLyBjb25zb2xlLmxvZygnSFRNTCcsIHJvb3ROb2RlLmlubmVySFRNTCk7XG5cbiAgbGV0IGxhc3RQbGFpbnRleHRQYXJhID0gZmFsc2U7XG4gIGxldCBmbXQgPSB7fTtcblxuICBmb3IoY29uc3Qgbm9kZSBvZiByb290Tm9kZS5jaGlsZE5vZGVzKSB7XG4gICAgaWYobm9kZS5ub2RlVHlwZSA9PT0gTm9kZS5FTEVNRU5UX05PREUpIHtcbiAgICAgIGlmKG5vZGUubm9kZU5hbWUgPT09ICdESVYnICYmIG5vZGUuYXR0cmlidXRlc1snZGF0YS1pZCddKSB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCdkaXYnLCBub2RlKTtcbiAgICAgICAgbGFzdFBsYWludGV4dFBhcmEgPSB0cnVlO1xuICAgICAgICBmbXQgPSB7fTtcbiAgICAgICAgY29uc3QgaWQgPSBub2RlLmF0dHJpYnV0ZXNbJ2RhdGEtaWQnXS5ub2RlVmFsdWU7XG4gICAgICAgIGNvbnN0IHNwYW5zID0gW107XG4gICAgICAgIGNvbnN0IHBhcmFncmFwaCA9IHsgaWQsIHNwYW5zIH07XG4gICAgICAgIHBhcmFncmFwaHMucHVzaChwYXJhZ3JhcGgpO1xuICAgICAgICBsZXQgcHJlcGVuZFRleHQ7XG4gICAgICAgIC8vIGFkZChub2RlLmlubmVyVGV4dCwgdWlkKTtcbiAgICAgICAgLy8gcGFyc2Ugc3BhbnNcbiAgICAgICAgY29uc3QgcGFyYWdyYXBoTm9kZSA9IG5vZGU7XG4gICAgICAgIHtcbiAgICAgICAgICBmb3IoY29uc3Qgbm9kZSBvZiBwYXJhZ3JhcGhOb2RlLmNoaWxkTm9kZXMpIHtcbiAgICAgICAgICAgIGlmKG5vZGUubm9kZVR5cGUgPT09IE5vZGUuRUxFTUVOVF9OT0RFKSB7XG4gICAgICAgICAgICAgIGlmKG5vZGUubm9kZU5hbWUgPT09ICdTUEFOJyAmJiBub2RlLmF0dHJpYnV0ZXNbJ2RhdGEtaWQnXSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGlkID0gbm9kZS5hdHRyaWJ1dGVzWydkYXRhLWlkJ10ubm9kZVZhbHVlO1xuICAgICAgICAgICAgICAgIGxldCB0ZXh0ID0gbm9kZS5pbm5lclRleHQ7XG4gICAgICAgICAgICAgICAgaWYocHJlcGVuZFRleHQgJiYgcHJlcGVuZFRleHQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgdGV4dCA9IHByZXBlbmRUZXh0ICsgdGV4dDtcbiAgICAgICAgICAgICAgICAgIHByZXBlbmRUZXh0ID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCB0aW1lID0gYXR0clZhbHVlKG5vZGUuYXR0cmlidXRlc1snZGF0YS10aW1lJ10sIHBhcnNlSW50KTtcbiAgICAgICAgICAgICAgICBjb25zdCBkdXJhdGlvbiA9IGF0dHJWYWx1ZShub2RlLmF0dHJpYnV0ZXNbJ2RhdGEtZHVyYXRpb24nXSwgcGFyc2VJbnQpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbmZpZGVuY2UgPSBhdHRyVmFsdWUobm9kZS5hdHRyaWJ1dGVzWydkYXRhLWNvbmZpZGVuY2UnXSwgcGFyc2VGbG9hdCk7XG4gICAgICAgICAgICAgICAgc3BhbnMucHVzaCh7IGlkLCB0ZXh0LCB0aW1lLCBkdXJhdGlvbiwgY29uZmlkZW5jZSB9KTtcbiAgICAgICAgICAgICAgICAvLyBhZGQobm9kZS5pbm5lclRleHQsIHVpZCk7XG4gICAgICAgICAgICAgICAgLy8gcGFyc2Ugc3BhbnNcblxuICAgICAgICAgICAgICB9IGVsc2UgaWYobm9kZS5ub2RlTmFtZSA9PT0gJ0JSJykge1xuICAgICAgICAgICAgICAgIC8vIGFkZCgnXFxuJyk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gYWRkKG5vZGUuaW5uZXJUZXh0KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmKG5vZGUubm9kZVR5cGUgPT09IE5vZGUuVEVYVF9OT0RFKSB7XG4gICAgICAgICAgICAgIC8vIGFkZChub2RlLm5vZGVWYWx1ZSk7XG4gICAgICAgICAgICAgIC8vIHdlIGhhdmUgcGxhaW4gdGV4dCwgYXBwZW5kIGl0IHNvbWV3aGVyZVxuICAgICAgICAgICAgICBpZihub2RlLm5vZGVWYWx1ZS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgaWYoc3BhbnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgc3BhbnNbc3BhbnMubGVuZ3RoIC0gMV0udGV4dCArPSBub2RlLm5vZGVWYWx1ZS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIHByZXBlbmRUZXh0ID0gbm9kZS5ub2RlVmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdURVhUIE5PREUnLCBub2RlLm5vZGVWYWx1ZSwgbm9kZS5ub2RlVmFsdWUubGVuZ3RoKVxuICAgICAgICAgICAgICBub2RlLm5vZGVWYWx1ZSA9ICcnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmKHNwYW5zLmxlbmd0aCA9PT0gMCAmJiBwcmVwZW5kVGV4dCAmJiBwcmVwZW5kVGV4dC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgc3BhbnMucHVzaChuZXdTcGFuKHByZXBlbmRUZXh0KSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZihub2RlLm5vZGVOYW1lID09PSAnQlInKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdicicsIG5vZGUpO1xuICAgICAgICBsYXN0UGxhaW50ZXh0UGFyYSA9IGZhbHNlO1xuICAgICAgICBub2RlLnJlbW92ZSgpO1xuICAgICAgICAvLyBhZGQoJ1xcbicpO1xuICAgICAgLy8gfSBlbHNlIGlmKG5vZGUubm9kZU5hbWUgPT09ICdTVFJPTkcnIHx8IG5vZGUubm9kZU5hbWUgPT09ICdCJykge1xuICAgICAgLy8gICBmbXQuYm9sZCA9IHRydWU7XG4gICAgICAvLyB9IGVsc2UgaWYobm9kZS5ub2RlTmFtZSA9PT0gJ0VNJyB8fCBub2RlLm5vZGVOYW1lID09PSAnSScpIHtcbiAgICAgIC8vICAgZm10Lml0YWxpYyA9IHRydWU7XG4gICAgICAvLyB9IGVsc2UgaWYobm9kZS5ub2RlTmFtZSA9PT0gJ1UnKSB7XG4gICAgICAvLyAgIGZtdC51bmRlcmxpbmUgPSB0cnVlO1xuICAgICAgLy8gfSBlbHNlIGlmKG5vZGUubm9kZU5hbWUgPT09ICdTVUInKSB7XG4gICAgICAvLyAgIGZtdC5zdWJzY3JpcHQgPSB0cnVlO1xuICAgICAgLy8gfSBlbHNlIGlmKG5vZGUubm9kZU5hbWUgPT09ICdTVVAnKSB7XG4gICAgICAvLyAgIGZtdC5zdXBlcnNjcmlwdCA9IHRydWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBjb25zb2xlLmxvZygnb3RoZXIgZWxlbWVudCcsIG5vZGUpO1xuICAgICAgICBub2RlLnJlbW92ZSgpO1xuICAgICAgICAvLyBUT0RPOiBtYXAgZm9ybWF0dGluZ1xuICAgICAgICAvLyBhZGQobm9kZS5pbm5lclRleHQpO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZihub2RlLm5vZGVUeXBlID09PSBOb2RlLlRFWFRfTk9ERSAmJiBub2RlLm5vZGVWYWx1ZS5sZW5ndGggPiAwKSB7XG4gICAgICAvLyBjb25zb2xlLmxvZygndGV4dCBub2RlJywgbm9kZSwgYD4ke25vZGUubm9kZVZhbHVlfTxgKTtcbiAgICAgIGxldCBwYXJhZ3JhcGggPSBwYXJhZ3JhcGhzLmxlbmd0aCA+IDAgJiYgbGFzdFBsYWludGV4dFBhcmEgJiYgcGFyYWdyYXBoc1twYXJhZ3JhcGhzLmxlbmd0aCAtIDFdO1xuICAgICAgaWYoIXBhcmFncmFwaCkge1xuICAgICAgICBwYXJhZ3JhcGggPSB7IGlkOiBuZXdJRCgpLCBzcGFuczogW10gfTtcbiAgICAgICAgcGFyYWdyYXBocy5wdXNoKHBhcmFncmFwaCk7XG4gICAgICB9XG4gICAgICBjb25zdCBzcGFucyA9IHBhcmFncmFwaC5zcGFucztcbiAgICAgIHNwYW5zLnB1c2goeyBpZDogbmV3SUQoKSwgdGV4dDogbm9kZS5ub2RlVmFsdWUgfSk7XG4gICAgICAgIG5vZGUucmVtb3ZlKCk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHBhcmFncmFwaHM7XG59XG5cbmZ1bmN0aW9uIGlzRE9NU2VsZWN0aW9uQmFja3dhcmRzKHNlbGVjdGlvbikge1xuICBpZihzZWxlY3Rpb24uaXNDb2xsYXBzZWQpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgaWYoc2VsZWN0aW9uLmFuY2hvck5vZGUgPT09IHNlbGVjdGlvbi5mb2N1c05vZGUpIHtcbiAgICBpZihzZWxlY3Rpb24uYW5jaG9yT2Zmc2V0ID4gc2VsZWN0aW9uLmZvY3VzT2Zmc2V0KSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIC8vIGdldCBsaXN0IG9mIHBhcmVudHMgc3RhcnRpbmcgZnJvbSBhbmNob3JOb2RlXG4gIGNvbnN0IHBhcmVudE5vZGVzID0gW3NlbGVjdGlvbi5hbmNob3JOb2RlXTtcbiAgbGV0IG5vZGUgPSBzZWxlY3Rpb24uYW5jaG9yTm9kZTtcbiAgd2hpbGUobm9kZSAmJiBub2RlICE9IGRvY3VtZW50LmJvZHkpIHtcbiAgICBub2RlID0gbm9kZS5wYXJlbnROb2RlO1xuICAgIHBhcmVudE5vZGVzLnB1c2gobm9kZSk7XG4gIH1cbiAgLy8gaXRlcmF0ZSBmcm9tIGZvY3VzTm9kZSB0byBwYXJlbnQgbm9kZXNcbiAgbm9kZSA9IHNlbGVjdGlvbi5mb2N1c05vZGU7XG4gIHdoaWxlKG5vZGUgJiYgbm9kZSAhPSBkb2N1bWVudC5ib2R5KSB7XG4gICAgY29uc3QgZm9jdXNOb2RlID0gbm9kZTtcbiAgICBub2RlID0gbm9kZS5wYXJlbnROb2RlO1xuICAgIGxldCBhbmNob3JOb2RlO1xuICAgIC8vIGNoZWNrIGVhY2ggbm9kZSBtYXRjaCBpbnNpZGUgcHJldmlvdXNseSBidWlsdCBwYXJlbnQgbm9kZSBsaXN0XG4gICAgZm9yKGNvbnN0IHBhcmVudCBvZiBwYXJlbnROb2Rlcykge1xuICAgICAgaWYobm9kZSA9PT0gcGFyZW50KSB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCdQQVJFTlQ6JywgcGFyZW50LCAnQU5DSE9SOicsIGFuY2hvck5vZGUsICdGT0NVUzonLCBmb2N1c05vZGUpXG4gICAgICAgIC8vIHdlIGhhdmUgY29tbWFuZCBwYXJlbnQgbm9kZSwgbGV0J3MgY2hlY2sgd2hpY2ggY2hpbGQgbm9kZSBjb21lcyBmaXJzdDogZnJvbSBhbmNob3IgYnJhbmNoIG9yIGZvY3VzIGJyYW5jaFxuICAgICAgICBmb3IoY29uc3QgY2hpbGROb2RlIG9mIHBhcmVudC5jaGlsZE5vZGVzKSB7XG4gICAgICAgICAgaWYoY2hpbGROb2RlID09PSBhbmNob3JOb2RlKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgfSBlbHNlIGlmKGNoaWxkTm9kZSA9PT0gZm9jdXNOb2RlKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGFuY2hvck5vZGUgPSBwYXJlbnQ7XG4gICAgfVxuICB9XG4gIC8vIE5PVEU6IGFsdGVybmF0aXZlIGFwcHJvYWNoIGludm9sdmVzIGNoZWNraW5nIGlmIHNvbWUgcG9pbnQgaXMgaW5zaWRlIHRoZSByYW5nZSwgb3Igb3V0c2lkZSB0byB0aGUgbGVmdCBvciByaWdodFxuICAvLyBpZihzZWxlY3Rpb24ucmFuZ2VDb3VudCA9PSAwKSB7XG4gIC8vICAgcmV0dXJuIGZhbHNlO1xuICAvLyB9XG4gIC8vIGNvbnN0IHJhbmdlID0gc2VsZWN0aW9uLmdldFJhbmdlQXQoMCk7XG4gIC8vIHJhbmdlLmNvbXBhcmVQb2ludChub2RlLCBvZmZzZXQpID0+IC0xLCAwLCAxXG59XG5cblxuZXhwb3J0IGZ1bmN0aW9uIG5vcm1hbGl6ZWRET01TZWxlY3Rpb24oc2VsZWN0aW9uKSB7XG4gIGlmKCFzZWxlY3Rpb24pIHtcbiAgICBzZWxlY3Rpb24gPSBkb2N1bWVudC5nZXRTZWxlY3Rpb24oKTtcbiAgfVxuICBpZighKHNlbGVjdGlvbiBpbnN0YW5jZW9mIFNlbGVjdGlvbikpIHtcbiAgICByZXR1cm4gc2VsZWN0aW9uO1xuICB9XG4gIGlmKHNlbGVjdGlvbi5pc0NvbGxhcHNlZCkge1xuICAgIGNvbnN0IHN0YXJ0Tm9kZSA9IHNlbGVjdGlvbi5hbmNob3JOb2RlO1xuICAgIGNvbnN0IHN0YXJ0T2Zmc2V0ID0gc2VsZWN0aW9uLmFuY2hvck9mZnNldDtcbiAgICBjb25zdCBzdGFydCA9IHsgbm9kZTogc3RhcnROb2RlLCBvZmZzZXQ6IHN0YXJ0T2Zmc2V0IH07XG4gICAgLy8gcmV0dXJuIHsgc3RhcnROb2RlLCBzdGFydE9mZnNldCwgZW5kTm9kZTogc3RhcnROb2RlLCBlbmRPZmZzZXQ6IHN0YXJ0T2Zmc2V0LCBiYWNrd2FyZHM6IGZhbHNlLCBjb2xsYXBzZWQ6IHRydWUgfTtcbiAgICByZXR1cm4geyBzdGFydCwgZW5kOiBzdGFydCwgYmFja3dhcmRzOiBmYWxzZSwgY29sbGFwc2VkOiB0cnVlLCBzZWxlY3Rpb24gfTtcbiAgfVxuICBjb25zdCBiYWNrd2FyZHMgPSBpc0RPTVNlbGVjdGlvbkJhY2t3YXJkcyhzZWxlY3Rpb24pO1xuICBjb25zdCBzdGFydE5vZGUgPSBiYWNrd2FyZHMgPyBzZWxlY3Rpb24uZm9jdXNOb2RlIDogc2VsZWN0aW9uLmFuY2hvck5vZGU7XG4gIGNvbnN0IHN0YXJ0T2Zmc2V0ID0gYmFja3dhcmRzID8gc2VsZWN0aW9uLmZvY3VzT2Zmc2V0IDogc2VsZWN0aW9uLmFuY2hvck9mZnNldDtcbiAgY29uc3QgZW5kTm9kZSA9IGJhY2t3YXJkcyA/IHNlbGVjdGlvbi5hbmNob3JOb2RlIDogc2VsZWN0aW9uLmZvY3VzTm9kZTtcbiAgY29uc3QgZW5kT2Zmc2V0ID0gYmFja3dhcmRzID8gc2VsZWN0aW9uLmFuY2hvck9mZnNldCA6IHNlbGVjdGlvbi5mb2N1c09mZnNldDtcbiAgLy8gcmV0dXJuIHsgc3RhcnROb2RlLCBzdGFydE9mZnNldCwgZW5kTm9kZSwgZW5kT2Zmc2V0LCBiYWNrd2FyZHMsIGNvbGxhcHNlZDogZmFsc2UgfTtcbiAgcmV0dXJuIHsgc3RhcnQ6IHsgbm9kZTogc3RhcnROb2RlLCBvZmZzZXQ6IHN0YXJ0T2Zmc2V0IH0sIGVuZDogeyBub2RlOiBlbmROb2RlLCBvZmZzZXQ6IGVuZE9mZnNldCB9LCBiYWNrd2FyZHMsIGNvbGxhcHNlZDogZmFsc2UsIHNlbGVjdGlvbiB9O1xufVxuXG4vLyBET00gdGV4dCBwb2ludGVyIC0+IHRleHQgbm9kZSArIG9mZnNldFxuXG4vLyBmdW5jdGlvbiBub3JtYWxpemVQb2ludGVyKHBvaW50ZXIpIHtcbi8vICAgLy8gZXhwZWN0ZWQgYXR0cmlidXRlczogbm9kZSwgb2Zmc2V0LCBwYXJhZ3JhcGhJRCwgc3BhbklELCBwYXJhZ3JhcGhJbmRleCwgc3BhbkluZGV4XG4vLyB9XG5cbi8vIGdldCBub2RlIHdpdGggc3BlY2lmaWVkIHRhZyBhbmQgZXh0cmFjdCBzcGVjaWZpZWQgZGF0YS0gYXR0cmlidXRlc1xuZXhwb3J0IGZ1bmN0aW9uIGdldERPTUVsZW1lbnREYXRhQXR0cmlidXRlcyhub2RlLCB0YWcsIHJlc29sdmVBdHRycyA9IFtdKSB7XG4gIGlmKG5vZGUgJiYgbm9kZS5ub2RlVHlwZSA9PSBOb2RlLlRFWFRfTk9ERSkge1xuICAgIG5vZGUgPSBub2RlLnBhcmVudE5vZGU7XG4gIH1cbiAgaWYobm9kZSAmJiBub2RlLm5vZGVUeXBlID09IE5vZGUuRUxFTUVOVF9OT0RFKSB7XG4gICAgaWYoIXRhZyB8fCBub2RlLm5vZGVOYW1lID09PSB0YWcpIHtcbiAgICAgIGNvbnN0IGF0dHJzID0ge307XG4gICAgICBmb3IoY29uc3QgbmFtZSBvZiByZXNvbHZlQXR0cnMpIHtcbiAgICAgICAgY29uc3QgYXR0ciA9IG5vZGUuYXR0cmlidXRlc1snZGF0YS0nICsgbmFtZV07XG4gICAgICAgIGlmKGF0dHIpIHtcbiAgICAgICAgICBhdHRyc1tuYW1lXSA9IGF0dHIubm9kZVZhbHVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4geyBub2RlLCBhdHRycyB9O1xuICAgIH1cbiAgfVxuICByZXR1cm4ge307XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkYXRhRE9NTm9kZXNBdE5vZGUobm9kZSkge1xuICBsZXQgaW5wdXROb2RlID0gbm9kZTtcbiAgbGV0IHNwYW5BdHRycywgcGFyYWdyYXBoQXR0cnMsIHNwYW5Ob2RlLCBwYXJhZ3JhcGhOb2RlO1xuICB3aGlsZShpbnB1dE5vZGUgJiYgIXBhcmFncmFwaEF0dHJzKSB7XG4gICAgY29uc3QgeyBub2RlLCBhdHRycyB9ID0gZ2V0RE9NRWxlbWVudERhdGFBdHRyaWJ1dGVzKGlucHV0Tm9kZSwgdW5kZWZpbmVkLCBbJ2lkJywgJ3RpbWUnLCAnZHVyYXRpb24nLCAnY29uZmlkZW5jZSddKTsgIC8vIHRyeSBzcGFuIG5vZGVcbiAgICBpZighcGFyYWdyYXBoQXR0cnMgJiYgIXNwYW5BdHRycyAmJiBub2RlICYmIG5vZGUubm9kZU5hbWUgPT09ICdTUEFOJyAmJiBhdHRycy5pZCkge1xuICAgICAgc3BhbkF0dHJzID0gYXR0cnM7XG4gICAgICBzcGFuTm9kZSA9IG5vZGU7XG4gICAgfSBlbHNlIGlmKCFwYXJhZ3JhcGhBdHRycyAmJiBub2RlICYmIG5vZGUubm9kZU5hbWUgPT09ICdESVYnICYmIGF0dHJzLmlkKSB7XG4gICAgICBwYXJhZ3JhcGhBdHRycyA9IGF0dHJzO1xuICAgICAgcGFyYWdyYXBoTm9kZSA9IG5vZGU7XG4gICAgICBicmVhaztcbiAgICB9XG4gICAgaWYobm9kZSkge1xuICAgICAgaW5wdXROb2RlID0gbm9kZTtcbiAgICB9XG4gICAgaW5wdXROb2RlID0gaW5wdXROb2RlLnBhcmVudE5vZGU7XG4gIH1cbiAgcmV0dXJuIHsgc3Bhbk5vZGUsIHNwYW5BdHRycywgcGFyYWdyYXBoTm9kZSwgcGFyYWdyYXBoQXR0cnMgfTtcbn1cblxuZnVuY3Rpb24gdGV4dE5vZGUobm9kZSkge1xuICBpZihub2RlLm5vZGVUeXBlID09PSBOb2RlLkVMRU1FTlRfTk9ERSkge1xuICAgIGlmKG5vZGUuY2hpbGROb2Rlcy5sZW5ndGggPiAwKSB7XG4gICAgICByZXR1cm4gbm9kZS5jaGlsZE5vZGVzWzBdO1xuICAgIH1cbiAgICByZXR1cm4gbm9kZTtcbiAgfSBlbHNlIGlmKG5vZGUubm9kZVR5cGUgPT09IE5vZGUuVEVYVF9OT0RFKSB7XG4gICAgcmV0dXJuIG5vZGU7XG4gIH1cbiAgcmV0dXJuO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGF0YVBvaW50ZXJET01Ob2RlKHBvaW50ZXIsIGNvbnRhaW5lck5vZGUpIHtcbiAgY29uc3Qgbm9kZSA9IGNvbnRhaW5lck5vZGUucXVlcnlTZWxlY3RvcihgZGl2W2RhdGEtaWQ9XCIke3BvaW50ZXIucGFyYWdyYXBoSUR9XCJdYCArIChwb2ludGVyLnNwYW5JRCA/IGAgPiBzcGFuW2RhdGEtaWQ9XCIke3BvaW50ZXIuc3BhbklEfVwiXWAgOiAnJykgKTtcbiAgcG9pbnRlci5ub2RlID0gbm9kZTtcbiAgLy8gaWYoZG9TZWxlY3RUZXh0ICYmIGVsZW1lbnQuY2hpbGROb2Rlcy5sZW5ndGggPiAwKSB7XG4gIC8vICAgcmV0dXJuIGVsZW1lbnQuY2hpbGROb2Rlc1swXTtcbiAgLy8gfVxuICByZXR1cm4gcG9pbnRlcjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlc3RvcmVET01TZWxlY3Rpb24oY29udGFpbmVyTm9kZSwgc3RhcnQsIGVuZCkge1xuXG4gIGNvbnN0IHN0YXJ0Tm9kZSA9IHRleHROb2RlKHN0YXJ0Lm5vZGUgfHwgZGF0YVBvaW50ZXJET01Ob2RlKHN0YXJ0LCBjb250YWluZXJOb2RlKS5ub2RlKTtcbiAgY29uc3QgZW5kTm9kZSA9IGVuZCAmJiB0ZXh0Tm9kZShlbmQubm9kZSB8fCBkYXRhUG9pbnRlckRPTU5vZGUoZW5kLCBjb250YWluZXJOb2RlKS5ub2RlKTtcblxuICAvLyBjb25zb2xlLmxvZygnc2VsZWN0IHN0YXJ0IGVsZW1lbnQnLCBzdGFydGVsZW1lbnQsICdzdGFydG9mZnNldCcsIHN0YXJ0Lm9mZnNldCwgJ2VuZCBlbGVtZW50JywgZW5kZWxlbWVudCwgJ2VuZG9mZmZzZXQnLCBlbmQgJiYgZW5kLm9mZnNldCk7XG5cbiAgY29uc3Qgc2VsZWN0aW9uID0gZG9jdW1lbnQuZ2V0U2VsZWN0aW9uKCk7XG4gIHNlbGVjdGlvbi5lbXB0eSgpO1xuICBjb25zdCByYW5nZSA9IG5ldyBSYW5nZSgpO1xuICByYW5nZS5zZXRTdGFydChzdGFydE5vZGUsIHN0YXJ0Lm9mZnNldCk7XG4gIGlmKCFlbmQpIHtcbiAgICAvLyByYW5nZS5zZXRFbmQoc3RhcnROb2RlLCBzdGFydC5vZmZzZXQpO1xuICAgIHJhbmdlLmNvbGxhcHNlKHRydWUpO1xuICB9IGVsc2Uge1xuICAgIHJhbmdlLnNldEVuZChlbmROb2RlLCBlbmQub2Zmc2V0KTtcbiAgfVxuICBzZWxlY3Rpb24uYWRkUmFuZ2UocmFuZ2UpO1xufVxuXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBkYXRhIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuZnVuY3Rpb24gZGF0YVBhcmFncmFwaHMoZGF0YSkge1xuICByZXR1cm4gZGF0YTtcbn1cblxuZnVuY3Rpb24gcGFyYWdyYXBoU3BhbnMocGFyYWdyYXBoKSB7XG4gIHJldHVybiBwYXJhZ3JhcGguc3BhbnM7XG59XG5cbmZ1bmN0aW9uIHNldFBhcmFncmFwaFNwYW5zKHBhcmFncmFwaCwgc3BhbnMpIHtcbiAgcmV0dXJuIHBhcmFncmFwaC5zcGFucyA9IHNwYW5zO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbmV3U3Bhbih0ZXh0ID0gJycpIHtcbiAgcmV0dXJuIHsgaWQ6IG5ld0lEKCksIHRleHQsIGZvcm1hdDoge30gfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG5ld1BhcmFncmFwaChzcGFucykge1xuICByZXR1cm4geyBpZDogbmV3SUQoKSwgc3BhbnM6IHR5cGVvZiBzcGFucyA9PT0gJ251bWJlcicgPyBBcnJheS5mcm9tKEFycmF5KHNwYW5zKSwgKCkgPT4gbmV3U3BhbigpKSA6IChzcGFucyB8fCBbXSkgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvcHlTcGFuKHNwYW4sIC4uLm5ld1Byb3BzKSB7XG4gIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCBzcGFuLCB7IGZvcm1hdDogT2JqZWN0LmFzc2lnbih7fSwgc3Bhbi5mb3JtYXQgfHwge30pIH0sIC4uLm5ld1Byb3BzKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gc3BsaXRTcGFuKHNwYW4sIG9mZnNldCwgeyBuZXdpZCwgc3BsaXRUaW1lIH0gPSB7IG5ld2lkOiBuZXdJRCwgc3BsaXRUaW1lOiBmYWxzZSB9KSB7XG4gIGNvbnN0IGxlZnQgPSB7IGlkOiBuZXdpZChzcGFuLmlkKSwgdGV4dDogc3Bhbi50ZXh0LnN1YnN0cigwLCBvZmZzZXQpLCBmb3JtYXQ6IE9iamVjdC5hc3NpZ24oe30sIHNwYW4uZm9ybWF0KSAvKnNwYW4uaWQgKyAnLWwnKi8gfTsgLy8gZ2VuZXJhdGUgbmV3IHJhbmRvbSBpZFxuICBjb25zdCByaWdodCA9IHsgaWQ6IG5ld2lkKHNwYW4uaWQpLCB0ZXh0OiBzcGFuLnRleHQuc3Vic3RyKG9mZnNldCksIGZvcm1hdDogT2JqZWN0LmFzc2lnbih7fSwgc3Bhbi5mb3JtYXQpIC8qc3Bhbi5pZCArICctcicqLyB9OyAvLyBnZW5lcmF0ZSBuZXcgcmFuZG9tIGlkXG4gIGlmKHNwbGl0VGltZSkge1xuICAgIGNvbnN0IHRvdGFsID0gc3Bhbi50ZXh0LnJlcGxhY2UoL1xccyovZywgJycpLmxlbmd0aDtcbiAgICBpZihzcGFuLmR1cmF0aW9uID4gMCkge1xuICAgICAgbGVmdC5kdXJhdGlvbiA9IGxlZnQudGV4dC5yZXBsYWNlKC9cXHMqL2csICcnKS5sZW5ndGggKiBzcGFuLmR1cmF0aW9uIC8gdG90YWw7XG4gICAgICByaWdodC5kdXJhdGlvbiA9IHJpZ2h0LnRleHQucmVwbGFjZSgvXFxzKi9nLCAnJykubGVuZ3RoICogc3Bhbi5kdXJhdGlvbiAvIHRvdGFsO1xuICAgICAgaWYoc3Bhbi50aW1lID49IDApIHtcbiAgICAgICAgbGVmdC50aW1lID0gc3Bhbi50aW1lO1xuICAgICAgICByaWdodC50aW1lID0gc3Bhbi50aW1lICsgbGVmdC5kdXJhdGlvbjtcbiAgICAgICAgLy8gcmlnaHQudGltZSA9IHNwYW4udGltZSArIHBhcnNlSW50KGxlZnQuZHVyYXRpb24gKiAxMDAwKTtcbiAgICAgIH1cbiAgICAgIC8vIFRPRE86IG1heSBuZWVkIHRvIGtlZXAgb3JpZ2luYWwgdGltZS9kdXJhdGlvbiBhcyBiYWNrdXAgdmFsdWVzXG4gICAgfVxuICAgIC8vIFRPRE86IGZuIHRvIGZpeCBncm91cHNcbiAgfSBlbHNlIHtcbiAgICBsZWZ0LnRpbWUgPSBzcGFuLnRpbWU7XG4gICAgcmlnaHQudGltZSA9IHNwYW4udGltZTtcbiAgICBsZWZ0LmR1cmF0aW9uID0gc3Bhbi5kdXJhdGlvbjtcbiAgICByaWdodC5kdXJhdGlvbiA9IHNwYW4uZHVyYXRpb247XG4gICAgaWYoc3Bhbi5ncm91cCAmJiBzcGFuLmdyb3VwLmxlbmd0aCA+IDApIHtcbiAgICAgIC8vIHNhbWUgZ3JvdXBcbiAgICAgIGxlZnQuZ3JvdXAgPSBzcGFuLmdyb3VwO1xuICAgICAgcmlnaHQuZ3JvdXAgPSBzcGFuLmdyb3VwO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBzcGF3biBhIGdyb3VwXG4gICAgICBsZWZ0Lmdyb3VwID0gc3Bhbi5pZDtcbiAgICAgIHJpZ2h0Lmdyb3VwID0gc3Bhbi5pZDtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHsgbGVmdCwgcmlnaHQgfTtcbn1cblxuXG5leHBvcnQgZnVuY3Rpb24gaWRUb0luZGV4KGRhdGEsIHBhcmFncmFwaElELCBzcGFuSUQpIHtcbiAgY29uc29sZS5hc3NlcnQoZGF0YSAhPT0gdW5kZWZpbmVkLCAnZGF0YSBub3Qgc3BlY2lmaWVkJyk7XG4gIGNvbnNvbGUuYXNzZXJ0KHBhcmFncmFwaElEICE9PSB1bmRlZmluZWQsICdwYXJhZ3JhcGhJRCBub3Qgc3BlY2lmaWVkJyk7XG5cbiAgY29uc3Qgbm9ybUluZGV4ID0gKGluZGV4KSA9PiBpbmRleCA9PT0gLTEgPyB1bmRlZmluZWQgOiBpbmRleDtcbiAgY29uc3QgcGFyYWdyYXBocyA9IGRhdGFQYXJhZ3JhcGhzKGRhdGEpO1xuICBjb25zb2xlLmFzc2VydChwYXJhZ3JhcGhzICE9PSB1bmRlZmluZWQsICdubyBwYXJhZ3JhcGhzJyk7XG4gIGNvbnN0IHBhcmFncmFwaEluZGV4ID0gbm9ybUluZGV4KHBhcmFncmFwaHMuZmluZEluZGV4KHBhcmFncmFwaCA9PiBwYXJhZ3JhcGguaWQgPT09IHBhcmFncmFwaElEKSk7XG4gIGNvbnN0IHBhcmFncmFwaCA9IHBhcmFncmFwaEluZGV4ICE9PSB1bmRlZmluZWQgJiYgcGFyYWdyYXBoSW5kZXggIT09IC0xICYmIHBhcmFncmFwaHNbcGFyYWdyYXBoSW5kZXhdIHx8IHVuZGVmaW5lZDtcbiAgY29uc3Qgc3BhbkluZGV4ID0gcGFyYWdyYXBoICYmIG5vcm1JbmRleChwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGgpLmZpbmRJbmRleChzcGFuID0+IHNwYW4uaWQgPT09IHNwYW5JRCkpO1xuICBjb25zdCBzcGFuID0gc3BhbkluZGV4ICE9PSB1bmRlZmluZWQgJiYgc3BhbkluZGV4ICE9PSAtMSAmJiBwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGgpW3NwYW5JbmRleF0gfHwgdW5kZWZpbmVkO1xuICByZXR1cm4geyBwYXJhZ3JhcGgsIHBhcmFncmFwaEluZGV4LCBzcGFuLCBzcGFuSW5kZXggfTtcbn1cblxuZnVuY3Rpb24gZGF0YUF0SW5kZXgoZGF0YSwgcGFyYWdyYXBoSW5kZXgsIHNwYW5JbmRleCkge1xuICBjb25zdCBwYXJhZ3JhcGhzID0gZGF0YVBhcmFncmFwaHMoZGF0YSk7XG4gIGNvbnN0IHBhcmFncmFwaCA9IHBhcmFncmFwaEluZGV4ID49IDAgJiYgcGFyYWdyYXBoc1twYXJhZ3JhcGhJbmRleF0gfHwgdW5kZWZpbmVkO1xuICBjb25zdCBzcGFucyA9IHBhcmFncmFwaCAmJiBwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGgpO1xuICBjb25zdCBzcGFuID0gc3BhbnMgJiYgc3BhbkluZGV4ICE9PSB1bmRlZmluZWQgLyogPj0gMCAqLyAmJiBzcGFuc1tzcGFuSW5kZXggPT09IC0xID8gc3BhbnMubGVuZ3RoIC0gMSA6IChzcGFuSW5kZXggPj0gc3BhbnMubGVuZ3RoID8gc3BhbnMubGVuZ3RoIC0gMSA6IHNwYW5JbmRleCldIHx8IHVuZGVmaW5lZDtcbiAgcmV0dXJuIHsgcGFyYWdyYXBoLCBzcGFuIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkYXRhUG9pbnRlckZyb21ET01Qb2ludGVyKGRhdGEsIHBvaW50ZXIpIHtcbiAgY29uc29sZS5hc3NlcnQoZGF0YSAhPT0gdW5kZWZpbmVkLCAnZGF0YSBub3Qgc3BlY2lmaWVkJyk7XG4gIGNvbnNvbGUuYXNzZXJ0KHBvaW50ZXIgIT09IHVuZGVmaW5lZCwgJ3BvaW50ZXIgbm90IHNwZWNpZmllZCcpO1xuXG4gIGNvbnN0IHsgc3BhbkF0dHJzLCBwYXJhZ3JhcGhBdHRycyB9ID0gZGF0YURPTU5vZGVzQXROb2RlKHBvaW50ZXIubm9kZSk7XG4gIC8vIGNvbnN0IHsgc3BhbkF0dHJzLCBwYXJhZ3JhcGhBdHRycyB9ID0gZXh0cmFjdEluZm9Gcm9tRE9NUG9pbnRlcihwb2ludGVyKTtcblxuICBjb25zdCBwYXJhZ3JhcGhJRCA9IHBhcmFncmFwaEF0dHJzICYmIHBhcmFncmFwaEF0dHJzLmlkO1xuICBjb25zdCBzcGFuSUQgPSBzcGFuQXR0cnMgJiYgc3BhbkF0dHJzLmlkO1xuXG4gIGNvbnN0IHBhcmFncmFwaHMgPSBkYXRhUGFyYWdyYXBocyhkYXRhKTtcbiAgY29uc3QgeyBwYXJhZ3JhcGhJbmRleCwgcGFyYWdyYXBoLCBzcGFuSW5kZXgsIHNwYW4gfSA9IHBhcmFncmFwaHMgJiYgaWRUb0luZGV4KGRhdGEsIHBhcmFncmFwaElELCBzcGFuSUQpIHx8IHt9O1xuXG4gIHJldHVybiB7IG5vZGU6IHBvaW50ZXIubm9kZSwgc3BhbkF0dHJzLCBwYXJhZ3JhcGhBdHRycywgcGFyYWdyYXBoSUQsIHNwYW5JRCwgcGFyYWdyYXBoSW5kZXgsIHBhcmFncmFwaCwgc3BhbkluZGV4LCBzcGFuLCBvZmZzZXQ6IHBvaW50ZXIub2Zmc2V0IH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzZWxlY3RQb2ludGVyVGV4dE9mZnNldENvbnRhaW5lcihyb290Q29udGFpbmVyLCBwb2ludGVyKSB7XG5cbiAgaWYocG9pbnRlci5zcGFuSUQgJiYgcG9pbnRlci5wYXJhZ3JhcGhJRCkge1xuXG4gICAgcmV0dXJuIHBvaW50ZXIubm9kZTtcblxuICB9IGVsc2UgaWYocG9pbnRlci5wYXJhZ3JhcGhJRCkge1xuXG4gICAgY29uc3QgeyBub2RlIH0gPSBnZXRET01FbGVtZW50RGF0YUF0dHJpYnV0ZXMocG9pbnRlci5ub2RlLCAnRElWJywgWydpZCddKTsgIC8vIHRyeSBwYXJhZ3JhcGggbm9kZVxuXG4gICAgcmV0dXJuIG5vZGU7XG4gIH1cbiAgcmV0dXJuIHJvb3RDb250YWluZXI7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwb2ludGVyVGV4dE9mZnNldEluQ29udGFpbmVyKGNvbnRhaW5lciwgcG9pbnRlcikge1xuICBjb25zdCBvZmZzZXRDb250YWluZXIgPSBzZWxlY3RQb2ludGVyVGV4dE9mZnNldENvbnRhaW5lcihjb250YWluZXIsIHBvaW50ZXIpXG5cbiAgbGV0IHsgbm9kZSwgb2Zmc2V0IH0gPSBwb2ludGVyO1xuXG4gIGlmKG5vZGUubm9kZVR5cGUgPT09IE5vZGUuRUxFTUVOVF9OT0RFKSB7XG4gICAgb2Zmc2V0ID0gMDtcbiAgICBmb3IobGV0IGk9cG9pbnRlci5vZmZzZXQtMTsgaSA+PSAwICYmIGk8bm9kZS5jaGlsZE5vZGVzLmxlbmd0aDsgaS0tKSB7XG4gICAgICBvZmZzZXQgKz0gbm9kZS5jaGlsZE5vZGVzLnRleHRDb250ZW50ICYmIG5vZGUuY2hpbGROb2Rlc1tpXS50ZXh0Q29uZW50Lmxlbmd0aCB8fCAwO1xuICAgIH1cbiAgfVxuXG4gIGxldCBzcGFuSUQsIHBhcmFncmFwaElELCBsZWZ0U3BhbklELCBsZWZ0UGFyYWdyYXBoSUQ7XG5cbiAgd2hpbGUobm9kZSAmJiBub2RlICE9IGNvbnRhaW5lcikge1xuICAgIGlmKG5vZGUubm9kZVR5cGUgPT09IE5vZGUuRUxFTUVOVF9OT0RFKSB7XG4gICAgICBpZihub2RlLm5vZGVOYW1lID09PSAnU1BBTicpIHtcbiAgICAgICAgY29uc3QgaWRBdHRyID0gbm9kZS5hdHRyaWJ1dGVzWydkYXRhLWlkJ107XG4gICAgICAgIHNwYW5JRCA9IGlkQXR0ci5ub2RlVmFsdWU7XG4gICAgICB9XG4gICAgICBpZihub2RlLm5vZGVOYW1lID09PSAnRElWJykge1xuICAgICAgICBjb25zdCBpZEF0dHIgPSBub2RlLmF0dHJpYnV0ZXNbJ2RhdGEtaWQnXTtcbiAgICAgICAgcGFyYWdyYXBoSUQgPSBpZEF0dHIubm9kZVZhbHVlO1xuICAgICAgfVxuICAgIH1cbiAgICBsZXQgbiA9IG5vZGU7XG4gICAgd2hpbGUobiA9IG4ucHJldmlvdXNTaWJsaW5nKSB7XG4gICAgICBpZighbGVmdFNwYW5JRCAmJiBuLm5vZGVOYW1lID09PSAnU1BBTicpIHtcbiAgICAgICAgY29uc3QgaWRBdHRyID0gbi5hdHRyaWJ1dGVzWydkYXRhLWlkJ107XG4gICAgICAgIGxlZnRTcGFuSUQgPSBpZEF0dHIubm9kZVZhbHVlO1xuICAgICAgICBpZighc3BhbklEICYmICFwYXJhZ3JhcGhJRCkge1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZighbGVmdFBhcmFncmFwaElEICYmIG4ubm9kZU5hbWUgPT09ICdESVYnKSB7XG4gICAgICAgIGNvbnN0IGlkQXR0ciA9IG4uYXR0cmlidXRlc1snZGF0YS1pZCddO1xuICAgICAgICBsZWZ0UGFyYWdyYXBoSUQgPSBpZEF0dHIubm9kZVZhbHVlO1xuICAgICAgICBpZighc3BhbklEICYmICFwYXJhZ3JhcGhJRCkge1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZighc3BhbklEICYmICFwYXJhZ3JhcGhJRCkge1xuICAgICAgICAgIGlmKG4udGV4dENvbmVudCkge1xuICAgICAgICAgICAgb2Zmc2V0ICs9IG4udGV4dENvbmVudC5sZW5ndGg7XG4gICAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBub2RlID0gbm9kZS5wYXJlbnROb2RlO1xuICB9XG5cbiAgcG9pbnRlci5zcGFuSUQgPSBzcGFuSUQ7XG4gIHBvaW50ZXIucGFyYWdyYXBoSUQgPSBwYXJhZ3JhcGhJRDtcbiAgcG9pbnRlci5vZmZzZXQgPSBvZmZzZXQ7XG4gIHBvaW50ZXIubGVmdFNwYW5JRCA9IGxlZnRTcGFuSUQ7XG4gIHBvaW50ZXIubGVmdFBhcmFncmFwaElEID0gbGVmdFBhcmFncmFwaElEO1xuXG4gIHJldHVybiBwb2ludGVyO1xufVxuXG4vLyBmcm9tIHBhcnRpYWwgdG8gZnVsbFxuZXhwb3J0IGZ1bmN0aW9uIGRhdGFQb2ludGVyKGRhdGEsIHBvaW50ZXIpIHtcbiAgY29uc29sZS5hc3NlcnQoZGF0YSAhPT0gdW5kZWZpbmVkLCAnZGF0YSBub3Qgc3BlY2lmaWVkJyk7XG4gIGNvbnNvbGUuYXNzZXJ0KHBvaW50ZXIgIT09IHVuZGVmaW5lZCwgJ3BvaW50ZXIgbm90IHNwZWNpZmllZCcpO1xuXG4gIC8vIHBhcmFncmFwaFxuICBpZihwb2ludGVyLnBhcmFncmFwaElEID09PSB1bmRlZmluZWQgJiYgKHBvaW50ZXIucGFyYWdyYXBoSW5kZXggPT09IHVuZGVmaW5lZCB8fCBwb2ludGVyLnBhcmFncmFwaEluZGV4ID09PSAtMSkpIHtcbiAgICAvLyBubyBwYXJhZ3JhcGgsIGhhdmUgdG8gY2hlY2sgZm9yIG5vZGVcbiAgICBjb25zb2xlLmFzc2VydChwb2ludGVyLm5vZGUgIT09IHVuZGVmaW5lZCwgJ2ludmFsaWQgcG9pbnRlciwgbm8gcGFyYWdyYXBoIGluZm8gYW5kIG5vIG5vZGUnKVxuICAgIHJldHVybiBPYmplY3QuYXNzaWduKHBvaW50ZXIsIGRhdGFQb2ludGVyRnJvbURPTVBvaW50ZXIoZGF0YSwgcG9pbnRlcikpO1xuICB9IGVsc2UgaWYocG9pbnRlci5wYXJhZ3JhcGhJRCAhPT0gdW5kZWZpbmVkICYmIChwb2ludGVyLnBhcmFncmFwaEluZGV4ID09PSB1bmRlZmluZWQgfHwgcG9pbnRlci5wYXJhZ3JhcGhJbmRleCA9PT0gLTEpKSB7XG4gICAgLy8gaGFzIHBhcmFncmFwaCBpZCwgcGFyYWdyYXBoIGluZGV4IGlzIG1pc3NpbmdcbiAgICBjb25zdCB7IHBhcmFncmFwaEluZGV4LCBwYXJhZ3JhcGgsIHNwYW5JbmRleCwgc3BhbiB9ID0gaWRUb0luZGV4KGRhdGEsIHBvaW50ZXIucGFyYWdyYXBoSUQsIHBvaW50ZXIuc3BhbklEKTtcblxuICAgIGNvbnNvbGUuYXNzZXJ0KHBhcmFncmFwaCwgJ3BhcmFncmFwaCBub3QgcmVzb2x2ZWQnKTtcbiAgICBjb25zb2xlLmFzc2VydChwb2ludGVyLnNwYW5JRCAmJiBzcGFuIHx8IHBvaW50ZXIuc3BhbklEID09PSB1bmRlZmluZWQsICdzcGFuIG5vdCByZXNvbHZlZCwgYnV0IHNwYW4gaWQgaXMgc2V0Jyk7XG5cbiAgICBPYmplY3QuYXNzaWduKHBvaW50ZXIsIHsgcGFyYWdyYXBoSW5kZXgsIHBhcmFncmFwaCB9KTtcbiAgICAvLyBpZihwb2ludGVyLnNwYW5JRCAhPT0gdW5kZWZpbmVkICYmIChzcGFuSW5kZXggPT09IHVuZGVmaW5lZCB8fCBzcGFuSW5kZXggPT09IC0xKSkge1xuICAgIC8vICAgcG9pbnRlci5zcGFuSW5kZXggPSBzcGFuSW5kZXg7XG4gICAgLy8gfVxuICAgIGlmKHBvaW50ZXIuc3BhbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBwb2ludGVyLnNwYW4gPSBzcGFuO1xuICAgIH1cbiAgfSBlbHNlIGlmKHBvaW50ZXIucGFyYWdyYXBoSUQgPT09IHVuZGVmaW5lZCAmJiAocG9pbnRlci5wYXJhZ3JhcGhJbmRleCAhPT0gdW5kZWZpbmVkIHx8IHBvaW50ZXIucGFyYWdyYXBoSW5kZXggIT09IC0xKSkge1xuICAgIC8vIHBhcmFncmFwaCBpZCBpcyBtaXNzaW5nLCBoYXMgcGFyYWdyYXBoIGluZGV4XG4gICAgY29uc3QgeyBwYXJhZ3JhcGgsIHNwYW4gfSA9IGRhdGFBdEluZGV4KGRhdGEsIHBvaW50ZXIucGFyYWdyYXBoSW5kZXgsIHBvaW50ZXIuc3BhbkluZGV4KTtcblxuICAgIGNvbnNvbGUuYXNzZXJ0KHBhcmFncmFwaCwgJ3BhcmFncmFwaCBub3QgcmVzb2x2ZWQnKTtcbiAgICBjb25zb2xlLmFzc2VydChwb2ludGVyLnNwYW5JbmRleCAhPT0gdW5kZWZpbmVkICYmIC8qIHBvaW50ZXIuc3BhbkluZGV4ICE9PSAtMSAmJiAqLyBzcGFuIHx8IHBvaW50ZXIuc3BhbkluZGV4ID09PSB1bmRlZmluZWQgLy8gfHwgcG9pbnRlci5zcGFuSW5kZXggPT09IC0xXG4gICAgICB8fCBwYXJhZ3JhcGhTcGFucyhkYXRhUGFyYWdyYXBocyhkYXRhKVtwb2ludGVyLnBhcmFncmFwaEluZGV4XSkubGVuZ3RoID09PSAwLFxuICAgICAgJ3NwYW4gbm90IHJlc29sdmVkLCBidXQgc3BhbiBpbmRleCBpcyBzZXRaJyk7XG5cbiAgICBPYmplY3QuYXNzaWduKHBvaW50ZXIsIHsgcGFyYWdyYXBoLCBwYXJhZ3JhcGhJRDogcGFyYWdyYXBoLmlkIH0pO1xuICAgIGlmKHNwYW4gJiYgKHBvaW50ZXIuc3BhbiA9PT0gdW5kZWZpbmVkIHx8IHBvaW50ZXIuc3BhbklEID09PSB1bmRlZmluZWQpKSB7XG4gICAgICBPYmplY3QuYXNzaWduKHBvaW50ZXIsIHsgc3Bhbiwgc3BhbklEOiBzcGFuLmlkIH0pO1xuICAgIH1cbiAgfVxuXG4gIGlmKHBvaW50ZXIuc3BhbklEID09PSB1bmRlZmluZWQgJiYgKHBvaW50ZXIuc3BhbkluZGV4ID09PSB1bmRlZmluZWQgLyogfHwgcG9pbnRlci5zcGFuSW5kZXggPT09IC0xICovKSkge1xuICAgIC8vIG5vIHNwYW4sIGhhdmUgdG8gY2hlY2sgZm9yIG5vZGVcbiAgICAvLyBjb25zb2xlLmFzc2VydChwb2ludGVyLm5vZGUgIT09IHVuZGVmaW5lZCwgJ2ludmFsaWQgcG9pbnRlciwgbm8gc3BhbiBpbmZvIGFuZCBubyBub2RlJylcbiAgICBpZihwb2ludGVyLm5vZGUpIHtcbiAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHBvaW50ZXIsIGRhdGFQb2ludGVyRnJvbURPTVBvaW50ZXIoZGF0YSwgcG9pbnRlcikpO1xuICAgIH1cbiAgfSBlbHNlIGlmKHBvaW50ZXIuc3BhbklEICE9PSB1bmRlZmluZWQgJiYgKHBvaW50ZXIuc3BhbkluZGV4ID09PSB1bmRlZmluZWQgLyogfHwgcG9pbnRlci5zcGFuSW5kZXggPT09IC0xICovKSkge1xuICAgIE9iamVjdC5hc3NpZ24ocG9pbnRlciwgaWRUb0luZGV4KGRhdGEsIHBvaW50ZXIucGFyYWdyYXBoSUQsIHBvaW50ZXIuc3BhbklEKSk7XG5cbiAgICBjb25zb2xlLmFzc2VydChwb2ludGVyLnBhcmFncmFwaCwgJ3BhcmFncmFwaCBub3QgcmVzb2x2ZWQnKTtcbiAgICBjb25zb2xlLmFzc2VydCgvKnBvaW50ZXIuc3BhbklEICE9PSB1bmRlZmluZWQgJiYqLyAvKiBwb2ludGVyLnNwYW5JbmRleCAhPT0gLTEgJiYgKi8gcG9pbnRlci5zcGFuSW5kZXggIT09IHVuZGVmaW5lZCAmJiBwb2ludGVyLnNwYW4sXG4gICAgICAnc3BhbiBub3QgcmVzb2x2ZWQsIGJ1dCBzcGFuIGlkIGlzIHNldFknKTtcblxuICB9IGVsc2UgaWYocG9pbnRlci5zcGFuSUQgPT09IHVuZGVmaW5lZCAmJiAocG9pbnRlci5zcGFuSW5kZXggIT09IHVuZGVmaW5lZCAvKiAmJiBwb2ludGVyLnNwYW5JbmRleCAhPT0gLTEgKi8pKSB7XG4gICAgY29uc3QgeyBwYXJhZ3JhcGgsIHNwYW4gfSA9IGRhdGFBdEluZGV4KGRhdGEsIHBvaW50ZXIucGFyYWdyYXBoSW5kZXgsIHBvaW50ZXIuc3BhbkluZGV4KTtcbiAgICBjb25zdCBzcGFucyA9IHBhcmFncmFwaFNwYW5zKHBhcmFncmFwaCk7XG4gICAgaWYocG9pbnRlci5zcGFuSW5kZXggPj0gc3BhbnMubGVuZ3RoICYmIHNwYW5zLmxlbmd0aCA+IDApIHtcbiAgICAgIC8vIGlmIHBvaW50ZXIgaXMgcGFzdCB0aGUgZW5kIG9mIHBhcmFncmFwaCwgcG9pbnQgaXQgdG8gdGhlIGVuZCBvZiBwYXJhZ3JhcGhcbiAgICAgIHBvaW50ZXIuc3BhbkluZGV4ID0gc3BhbnMubGVuZ3RoIC0gMTtcbiAgICAgIHBvaW50ZXIub2Zmc2V0ID0gc3BhbnNbc3BhbnMubGVuZ3RoIC0gMV0udGV4dC5sZW5ndGg7XG4gICAgfVxuXG4gICAgY29uc29sZS5hc3NlcnQocG9pbnRlci5wYXJhZ3JhcGgsICdwYXJhZ3JhcGggbm90IHJlc29sdmVkJyk7XG4gICAgY29uc29sZS5hc3NlcnQoLypwb2ludGVyLnNwYW5JbmRleCAhPT0gLTEgJiYgcG9pbnRlci5zcGFuSW5kZXggIT09IHVuZGVmaW5lZCAmJiovIHNwYW4gfHwgcGFyYWdyYXBoU3BhbnMoZGF0YVBhcmFncmFwaHMoZGF0YSlbcG9pbnRlci5wYXJhZ3JhcGhJbmRleF0pLmxlbmd0aCA9PT0gMCxcbiAgICAgICdzcGFuIG5vdCByZXNvbHZlZCwgYnV0IHNwYW4gaW5kZXggaXMgc2V0Jyk7XG5cbiAgICBPYmplY3QuYXNzaWduKHBvaW50ZXIsIHsgcGFyYWdyYXBoLCBwYXJhZ3JhcGhJRDogcGFyYWdyYXBoLmlkLCBzcGFuLCBzcGFuSUQ6IHNwYW4gJiYgc3Bhbi5pZCwgc3BhbkluZGV4OiBzcGFuICYmIHBvaW50ZXIuc3BhbkluZGV4IH0pO1xuICB9XG5cbiAgaWYocG9pbnRlci5wYXJhZ3JhcGhJbmRleCAhPSB1bmRlZmluZWQgJiYgcG9pbnRlci5wYXJhZ3JhcGhJbmRleCAhPSAtMSAmJiBwb2ludGVyLnNwYW5JbmRleCAhPSB1bmRlZmluZWQgLyogJiYgcG9pbnRlci5zcGFuSW5kZXggIT0gLTEgKi8pIHtcbiAgICBjb25zdCBwYXJhZ3JhcGhzID0gZGF0YVBhcmFncmFwaHMoZGF0YSk7XG4gICAgY29uc3Qgc3BhbnMgPSBwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGhzW3BvaW50ZXIucGFyYWdyYXBoSW5kZXhdKTtcbiAgICBpZihzcGFucy5sZW5ndGggPiAwKSB7XG4gICAgICBpZihwb2ludGVyLnNwYW5JbmRleCA9PT0gLTEpIHtcbiAgICAgICAgcG9pbnRlci5zcGFuSW5kZXggPSBzcGFucy5sZW5ndGggLSAxO1xuICAgICAgfVxuICAgICAgaWYocG9pbnRlci5vZmZzZXQgPCAwKSB7XG4gICAgICAgIHBvaW50ZXIub2Zmc2V0ID0gc3BhbnNbcG9pbnRlci5zcGFuSW5kZXhdLnRleHQubGVuZ3RoICsgMSArIHBvaW50ZXIub2Zmc2V0OyAvLyBmcm9tIHRoZSBlbmQgb2Ygc3BhbjogdGhpcyBpcyBkaWZmZXJlbnQgdGhhbiBpbiBweXRob24sIGl0J3Mgc2hpZnRlZCBieSBvbmUsIGkuZS4sIC0xIGlzIGxlblxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBwb2ludGVyO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGF0YVBvaW50ZXJQcmV2KGRhdGEsIHBvaW50ZXIsIG9mZnNldCkge1xuICBjb25zb2xlLmFzc2VydChkYXRhICE9PSB1bmRlZmluZWQsICdkYXRhIG5vdCBzZXQnKTtcbiAgY29uc29sZS5hc3NlcnQocG9pbnRlci5wYXJhZ3JhcGhJbmRleCA+PSAwLCAncG9pbnRlciBwYXJhZ3JhcGhJbmRleCBtaXNzaW5nIG9yIGludmFsaWQnKTtcblxuICBjb25zdCBwYXJhZ3JhcGhzID0gZGF0YVBhcmFncmFwaHMoZGF0YSk7XG5cbiAgbGV0IHBhcmFncmFwaEluZGV4ID0gcG9pbnRlci5wYXJhZ3JhcGhJbmRleDtcbiAgbGV0IHNwYW5JbmRleCA9IHBvaW50ZXIuc3BhbkluZGV4O1xuXG4gIGlmKHNwYW5JbmRleCAhPT0gdW5kZWZpbmVkICYmIHNwYW5JbmRleCAhPT0gLTEpIHtcbiAgICBpZihzcGFuSW5kZXggPiAwKSB7XG4gICAgICBzcGFuSW5kZXgtLTtcbiAgICB9IGVsc2UgaWYocGFyYWdyYXBoSW5kZXggPiAwKSB7XG4gICAgICBwYXJhZ3JhcGhJbmRleC0tO1xuICAgICAgaWYocGFyYWdyYXBoU3BhbnMocGFyYWdyYXBoc1twYXJhZ3JhcGhJbmRleF0pLmxlbmd0aCA+IDApIHtcbiAgICAgICAgc3BhbkluZGV4ID0gcGFyYWdyYXBoU3BhbnMocGFyYWdyYXBoc1twYXJhZ3JhcGhJbmRleF0pLmxlbmd0aCAtIDE7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzcGFuSW5kZXggPSB1bmRlZmluZWQ7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gIH0gZWxzZSBpZihwYXJhZ3JhcGhJbmRleCA+IDApIHtcbiAgICBwYXJhZ3JhcGhJbmRleC0tO1xuICAgIGlmKHBhcmFncmFwaFNwYW5zKHBhcmFncmFwaHNbcGFyYWdyYXBoSW5kZXhdKS5sZW5ndGggPiAwKSB7XG4gICAgICBzcGFuSW5kZXggPSBwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGhzW3BhcmFncmFwaEluZGV4XSkubGVuZ3RoIC0gMTtcbiAgICB9IGVsc2Uge1xuICAgICAgc3BhbkluZGV4ID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZihvZmZzZXQgPT09IHVuZGVmaW5lZCkge1xuICAgIG9mZnNldCA9IC0xO1xuICB9XG5cbiAgcmV0dXJuIGRhdGFQb2ludGVyKGRhdGEsIHsgcGFyYWdyYXBoSW5kZXgsIHNwYW5JbmRleCwgb2Zmc2V0IH0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGF0YVBvaW50ZXJOZXh0KGRhdGEsIHBvaW50ZXIsIG9mZnNldCkge1xuICBjb25zb2xlLmFzc2VydChkYXRhICE9PSB1bmRlZmluZWQsICdkYXRhIG5vdCBzZXQnKTtcbiAgY29uc29sZS5hc3NlcnQocG9pbnRlci5wYXJhZ3JhcGhJbmRleCA+PSAwLCAncG9pbnRlciBwYXJhZ3JhcGhJbmRleCBtaXNzaW5nIG9yIGludmFsaWQnKTtcblxuICBjb25zdCBwYXJhZ3JhcGhzID0gZGF0YVBhcmFncmFwaHMoZGF0YSk7XG5cbiAgbGV0IHBhcmFncmFwaEluZGV4ID0gcG9pbnRlci5wYXJhZ3JhcGhJbmRleDtcbiAgbGV0IHNwYW5JbmRleCA9IHBvaW50ZXIuc3BhbkluZGV4O1xuXG4gIGlmKHNwYW5JbmRleCAhPT0gdW5kZWZpbmVkICYmIHNwYW5JbmRleCAhPT0gLTEpIHtcbiAgICBpZihzcGFuSW5kZXggPCBwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGhzW3BhcmFncmFwaEluZGV4XSkubGVuZ3RoIC0gMSkge1xuICAgICAgc3BhbkluZGV4Kys7XG4gICAgfSBlbHNlIGlmKHBhcmFncmFwaEluZGV4IDwgcGFyYWdyYXBocy5sZW5ndGggLSAxKSB7XG4gICAgICBwYXJhZ3JhcGhJbmRleCsrO1xuICAgICAgaWYocGFyYWdyYXBoU3BhbnMocGFyYWdyYXBoc1twYXJhZ3JhcGhJbmRleF0pLmxlbmd0aCA+IDApIHtcbiAgICAgICAgc3BhbkluZGV4ID0gMFxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc3BhbkluZGV4ID0gdW5kZWZpbmVkO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICB9IGVsc2UgaWYocGFyYWdyYXBoSW5kZXggPCBwYXJhZ3JhcGhzLmxlbmd0aCAtIDEpIHtcbiAgICBwYXJhZ3JhcGhJbmRleCsrO1xuICAgIGlmKHBhcmFncmFwaFNwYW5zKHBhcmFncmFwaHNbcGFyYWdyYXBoSW5kZXhdKS5sZW5ndGggPiAwKSB7XG4gICAgICBzcGFuSW5kZXggPSAwO1xuICAgIH0gZWxzZSB7XG4gICAgICBzcGFuSW5kZXggPSB1bmRlZmluZWQ7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmKG9mZnNldCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgb2Zmc2V0ID0gMDtcbiAgfVxuXG4gIHJldHVybiBkYXRhUG9pbnRlcihkYXRhLCB7IHBhcmFncmFwaEluZGV4LCBzcGFuSW5kZXgsIG9mZnNldCB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRhdGFQb2ludGVyUHJldlNwYW4oZGF0YSwgcG9pbnRlcikge1xuICBjb25zb2xlLmFzc2VydChkYXRhICE9PSB1bmRlZmluZWQsICdkYXRhIG5vdCBzZXQnKTtcbiAgLy8gY29uc29sZS5hc3NlcnQocG9pbnRlci5wYXJhZ3JhcGhJRCAhPT0gdW5kZWZpbmVkLCAncG9pbnRlciBwYXJhZ3JhcGhJRCBtaXNzaW5nJyk7XG4gIGNvbnNvbGUuYXNzZXJ0KHBvaW50ZXIucGFyYWdyYXBoSW5kZXggPj0gMCwgJ3BvaW50ZXIgcGFyYWdyYXBoSW5kZXggbWlzc2luZyBvciBpbnZhbGlkJyk7XG5cbiAgY29uc3QgcGFyYWdyYXBocyA9IGRhdGFQYXJhZ3JhcGhzKGRhdGEpO1xuICBsZXQgcGFyYWdyYXBoSW5kZXggPSBwb2ludGVyLnBhcmFncmFwaEluZGV4O1xuICBsZXQgc3BhbkluZGV4ID0gcG9pbnRlci5zcGFuSW5kZXggPj0gMCA/IHBvaW50ZXIuc3BhbkluZGV4IDogMDtcbiAgd2hpbGUocGFyYWdyYXBoSW5kZXggPj0gMCkge1xuICAgIHNwYW5JbmRleC0tO1xuICAgIGlmKHNwYW5JbmRleCA8IDApIHtcbiAgICAgIHBhcmFncmFwaEluZGV4LS07XG4gICAgICBpZihwYXJhZ3JhcGhJbmRleCA8IDApIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBzcGFuSW5kZXggPSBwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGhzW3BhcmFncmFwaEluZGV4XSkubGVuZ3RoIC0gMTtcbiAgICB9XG4gICAgaWYoc3BhbkluZGV4ID49IDAgJiYgcGFyYWdyYXBoSW5kZXggPj0gMCkge1xuICAgICAgcmV0dXJuIGRhdGFQb2ludGVyKGRhdGEsIHsgcGFyYWdyYXBoSW5kZXgsIHNwYW5JbmRleCB9KTtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRhdGFQb2ludGVyTmV4dFNwYW4oZGF0YSwgcG9pbnRlcikge1xuICBjb25zb2xlLmFzc2VydChkYXRhICE9PSB1bmRlZmluZWQsICdkYXRhIG5vdCBzZXQnKTtcbiAgLy8gY29uc29sZS5hc3NlcnQocG9pbnRlci5wYXJhZ3JhcGhJRCAhPT0gdW5kZWZpbmVkLCAncG9pbnRlciBwYXJhZ3JhcGhJRCBtaXNzaW5nJyk7XG4gIGNvbnNvbGUuYXNzZXJ0KHBvaW50ZXIucGFyYWdyYXBoSW5kZXggPj0gMCwgJ3BvaW50ZXIgcGFyYWdyYXBoSW5kZXggbWlzc2luZyBvciBpbnZhbGlkJyk7XG5cbiAgY29uc3QgcGFyYWdyYXBocyA9IGRhdGFQYXJhZ3JhcGhzKGRhdGEpO1xuICBsZXQgcGFyYWdyYXBoSW5kZXggPSBwb2ludGVyLnBhcmFncmFwaEluZGV4O1xuICBsZXQgc3BhbkluZGV4ID0gcG9pbnRlci5zcGFuSW5kZXggPj0gMCA/IHBvaW50ZXIuc3BhbkluZGV4IDogcGFyYWdyYXBoc1twYXJhZ3JhcGhJbmRleF0uc3BhbnMubGVuZ3RoO1xuICB3aGlsZShwYXJhZ3JhcGhJbmRleCA8IHBhcmFncmFwaHMubGVuZ3RoKSB7XG4gICAgc3BhbkluZGV4Kys7XG4gICAgaWYoc3BhbkluZGV4ID49IHBhcmFncmFwaHNbcGFyYWdyYXBoSW5kZXhdLnNwYW5zLmxlbmd0aCkge1xuICAgICAgcGFyYWdyYXBoSW5kZXgrKztcbiAgICAgIGlmKHBhcmFncmFwaEluZGV4ID49IHBhcmFncmFwaHMubGVuZ3RoKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgc3BhbkluZGV4ID0gMDtcbiAgICB9XG4gICAgaWYocGFyYWdyYXBoSW5kZXggPCBwYXJhZ3JhcGhzLmxlbmd0aCAmJiBzcGFuSW5kZXggPCBwYXJhZ3JhcGhzW3BhcmFncmFwaEluZGV4XS5zcGFucy5sZW5ndGgpIHtcbiAgICAgIHJldHVybiBkYXRhUG9pbnRlcihkYXRhLCB7IHBhcmFncmFwaEluZGV4LCBzcGFuSW5kZXggfSk7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBjb25zdCBTcGxpY2VNb2RlID0gT2JqZWN0LmZyZWV6ZSh7XG4gIFJlbW92ZTogMSxcbiAgSW5QbGFjZTogMixcbiAgQ29weTogMyxcbn0pO1xuXG5leHBvcnQgZnVuY3Rpb24gc3BsaWNlU3BhbnMoc3BhbnMsIHN0YXJ0SW5kZXgsIHN0YXJ0T2Zmc2V0LCBlbmRJbmRleCwgZW5kT2Zmc2V0LCBtb2RlID0gU3BsaWNlTW9kZS5SZW1vdmUpIHtcbiAgaWYoc3RhcnRJbmRleCA9PSB1bmRlZmluZWQpIHtcbiAgICBzdGFydEluZGV4ID0gMDtcbiAgfVxuICBpZihzdGFydE9mZnNldCA9PSB1bmRlZmluZWQgfHwgc3RhcnRPZmZzZXQgPCAwKSB7XG4gICAgc3RhcnRPZmZzZXQgPSAwO1xuICB9XG4gIGlmKGVuZEluZGV4ID09IHVuZGVmaW5lZCB8fCBlbmRJbmRleCA+PSBzcGFucy5sZW5ndGgpIHtcbiAgICBlbmRJbmRleCA9IHNwYW5zLmxlbmd0aCAtIDE7XG4gIH1cbiAgY29uc3QgZW5kU3Bhbkxlbmd0aCA9IHNwYW5zW2VuZEluZGV4XS50ZXh0Lmxlbmd0aFxuICBpZihlbmRPZmZzZXQgPT09IHVuZGVmaW5lZCB8fCBlbmRPZmZzZXQgPiBlbmRTcGFuTGVuZ3RoKSB7XG4gICAgZW5kT2Zmc2V0ID0gZW5kU3Bhbkxlbmd0aDtcbiAgfVxuICBpZihlbmRPZmZzZXQgPCAwKSB7XG4gICAgZW5kT2Zmc2V0ID0gMDtcbiAgfVxuICBpZihzdGFydE9mZnNldCA+IHNwYW5zW3N0YXJ0SW5kZXhdLnRleHQubGVuZ3RoKSB7XG4gICAgc3RhcnRPZmZzZXQgPSBzcGFuc1tzdGFydEluZGV4XS50ZXh0Lmxlbmd0aDtcbiAgfVxuICBpZihzdGFydEluZGV4ID09PSBlbmRJbmRleCkge1xuICAgIGlmKGVuZE9mZnNldCA8IHN0YXJ0T2Zmc2V0KSB7XG4gICAgICBlbmRPZmZzZXQgPSBzdGFydE9mZnNldFxuICAgIH1cbiAgICBpZihtb2RlID09PSBTcGxpY2VNb2RlLlJlbW92ZSkge1xuICAgICAgY29uc3Qgc3BhbiA9IHNwYW5zW3N0YXJ0SW5kZXhdO1xuICAgICAgY29uc3QgcmVtb3ZlZFNwYW5UZXh0ID0gc3Bhbi50ZXh0LnN1YnN0cmluZyhzdGFydE9mZnNldCwgZW5kT2Zmc2V0KTtcbiAgICAgIHNwYW4udGV4dCA9IHNwYW4udGV4dC5zdWJzdHJpbmcoMCwgc3RhcnRPZmZzZXQpICsgc3Bhbi50ZXh0LnN1YnN0cmluZyhlbmRPZmZzZXQpO1xuICAgICAgY29uc3QgcmVtb3ZlZFNwYW5zID0gW107XG4gICAgICBpZihyZW1vdmVkU3BhblRleHQubGVuZ3RoID4gMCkge1xuICAgICAgICByZW1vdmVkU3BhbnMucHVzaChjb3B5U3BhbihzcGFuLCB7IHRleHQ6IHJlbW92ZWRTcGFuVGV4dCB9KSk7XG4gICAgICB9XG4gICAgICByZXR1cm4geyBzcGFuczogcmVtb3ZlZFNwYW5zLCBzcGxpdEluZGV4OiBzdGFydEluZGV4LCBzcGxpdE9mZnNldDogc3RhcnRPZmZzZXQsIHJlbW92ZWRTcGFuVGV4dCB9O1xuICAgIH0gZWxzZSBpZihtb2RlID09PSBTcGxpY2VNb2RlLkluUGxhY2UpIHtcbiAgICAgIC8vIGNvbnNvbGUubG9nKGBpblBsYWNlICBzdGFydEluZGV4PSR7c3RhcnRJbmRleH0gICBzdGFydE9mZnNldD0ke3N0YXJ0T2Zmc2V0fSAgZW5kSW5kZXg9JHtlbmRJbmRleH0gICBlbmRPZmZzZXQ9JHtlbmRPZmZzZXR9YClcbiAgICAgIC8vIHJlcGxhY2Ugb3JpZ2luYWwgc3BhbiB3aXRoIG9yaWdpbmFsICsgdHdvIG1vcmUgcGFydHNcbiAgICAgIGNvbnN0IHNwYW4gPSBzcGFuc1tzdGFydEluZGV4XTtcbiAgICAgIGlmKHN0YXJ0T2Zmc2V0ID09PSAwICYmIGVuZE9mZnNldCA+PSBzcGFuLnRleHQubGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiB7IHNwYW5zOiBbc3Bhbl0sIHNwbGl0SW5kZXg6IHN0YXJ0SW5kZXgsIHNwbGl0T2Zmc2V0OiBzdGFydE9mZnNldCB9O1xuICAgICAgfSBlbHNlIGlmKHN0YXJ0T2Zmc2V0ID09PSBlbmRPZmZzZXQpIHtcbiAgICAgICAgaWYoc3RhcnRPZmZzZXQgPT09IDApIHtcbiAgICAgICAgICByZXR1cm4geyByaWdodDogc3Bhbiwgc3BhbnM6IFtdLCBzcGxpdEluZGV4OiBzdGFydEluZGV4LCBzcGxpdE9mZnNldDogc3RhcnRPZmZzZXQgfTtcbiAgICAgICAgfSBlbHNlIGlmKGVuZE9mZnNldCA+PSBzcGFuLnRleHQubGVuZ3RoKSB7XG4gICAgICAgICAgcmV0dXJuIHsgbGVmdDogc3Bhbiwgc3BhbnM6IFtdLCBzcGxpdEluZGV4OiBzdGFydEluZGV4ICsgMSwgc3BsaXRPZmZzZXQ6IDAgfTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBsZXQgeyBsZWZ0LCByaWdodCB9ID0gc3BsaXRTcGFuKHNwYW4sIHN0YXJ0T2Zmc2V0KTtcbiAgICAgICAgICBzcGFucy5zcGxpY2Uoc3RhcnRJbmRleCwgMSwgLi4uW2xlZnQsIHJpZ2h0XS5maWx0ZXIocyA9PiBzLnRleHQubGVuZ3RoID4gMCkpO1xuICAgICAgICAgIHJldHVybiB7IGxlZnQsIHJpZ2h0LCBzcGFuczogW10sIHNwbGl0SW5kZXg6IHN0YXJ0SW5kZXggKyAxLCBzcGxpdE9mZnNldDogMCB9O1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYoc3RhcnRPZmZzZXQgPT09IDApIHtcbiAgICAgICAgbGV0IHsgbGVmdDogbWlkLCByaWdodCB9ID0gc3BsaXRTcGFuKHNwYW4sIGVuZE9mZnNldCk7XG4gICAgICAgIHNwYW5zLnNwbGljZShzdGFydEluZGV4LCAxLCAuLi5bbWlkLCByaWdodF0uZmlsdGVyKHMgPT4gcy50ZXh0Lmxlbmd0aCA+IDApKTtcbiAgICAgICAgcmV0dXJuIHsgcmlnaHQsIHNwYW5zOiBbbWlkXSwgc3BsaXRJbmRleDogc3RhcnRJbmRleCwgc3BsaXRPZmZzZXQ6IHN0YXJ0T2Zmc2V0IH07XG4gICAgICB9IGVsc2UgaWYoZW5kT2Zmc2V0ID49IHNwYW4udGV4dC5sZW5ndGgpIHtcbiAgICAgICAgbGV0IHsgbGVmdCwgcmlnaHQ6IG1pZCB9ID0gc3BsaXRTcGFuKHNwYW4sIHN0YXJ0T2Zmc2V0KTtcbiAgICAgICAgc3BhbnMuc3BsaWNlKHN0YXJ0SW5kZXgsIDEsIC4uLltsZWZ0LCBtaWRdLmZpbHRlcihzID0+IHMudGV4dC5sZW5ndGggPiAwKSk7XG4gICAgICAgIHJldHVybiB7IGxlZnQsIHNwYW5zOiBbbWlkXSwgc3BsaXRJbmRleDogc3RhcnRJbmRleCArIDEsIHNwbGl0T2Zmc2V0OiBzdGFydE9mZnNldCB9O1xuICAgICAgfVxuICAgICAgLy8gaWYoc3RhcnRPZmZzZXQgPT09IGVuZE9mZnNldCkge1xuICAgICAgLy8gICBpZihzdGFydE9mZnNldCA9PSAwIHx8IHN0YXJ0T2Zmc2V0ID49IHNwYW4udGV4dC5sZW5ndGgpIHtcbiAgICAgIC8vICAgICByZXR1cm4geyBzcGFuczogW10sIHNwbGl0SW5kZXg6IHN0YXJ0SW5kZXgsIHNwbGl0T2Zmc2V0OiBzdGFydE9mZnNldCB9O1xuICAgICAgLy8gICB9XG4gICAgICAvLyAgIGxldCB7IGxlZnQsIHJpZ2h0IH0gPSBzcGxpdFNwYW4oc3Bhbiwgc3RhcnRPZmZzZXQpO1xuICAgICAgLy8gICBzcGFucy5zcGxpY2Uoc3RhcnRJbmRleCwgMSwgbGVmdCwgcmlnaHQpO1xuICAgICAgLy8gICByZXR1cm4geyBzcGFuczogW10sIHNwbGl0SW5kZXg6IHN0YXJ0SW5kZXggKyAxLCBzcGxpdE9mZnNldDogMCB9O1xuICAgICAgLy8gfVxuICAgICAgbGV0IHsgbGVmdCwgcmlnaHQ6IG1pZHJpZ2h0IH0gPSBzcGxpdFNwYW4oc3Bhbiwgc3RhcnRPZmZzZXQpO1xuICAgICAgbGV0IHsgbGVmdDogbWlkLCByaWdodCB9ID0gc3BsaXRTcGFuKG1pZHJpZ2h0LCBlbmRPZmZzZXQgLSBzdGFydE9mZnNldCk7XG4gICAgICBzcGFucy5zcGxpY2Uoc3RhcnRJbmRleCwgMSwgLi4uW2xlZnQsIG1pZCwgcmlnaHRdLmZpbHRlcihzID0+IHMudGV4dC5sZW5ndGggPiAwKSk7XG4gICAgICByZXR1cm4geyBsZWZ0LCByaWdodCwgc3BhbnM6IFttaWRdLCBzcGxpdEluZGV4OiBzdGFydEluZGV4ICsgMSwgc3BsaXRPZmZzZXQ6IDAgLypzdGFydE9mZnNldCovIH07XG4gICAgfSBlbHNlIGlmKG1vZGUgPT09IFNwbGljZU1vZGUuQ29weSkge1xuICAgICAgY29uc3Qgc3BhbiA9IHNwYW5zW3N0YXJ0SW5kZXhdO1xuICAgICAgY29uc3QgcmVtb3ZlZFNwYW5UZXh0ID0gc3Bhbi50ZXh0LnN1YnN0cmluZyhzdGFydE9mZnNldCwgZW5kT2Zmc2V0KTtcbiAgICAgIC8vIHNwYW4udGV4dCA9IHNwYW4udGV4dC5zdWJzdHJpbmcoMCwgc3RhcnRPZmZzZXQpICsgc3Bhbi50ZXh0LnN1YnN0cmluZyhlbmRPZmZzZXQpO1xuICAgICAgY29uc3QgY29waWVkU3BhbnMgPSBbXTtcbiAgICAgIGlmKHJlbW92ZWRTcGFuVGV4dC5sZW5ndGggPiAwKSB7XG4gICAgICAgIGNvcGllZFNwYW5zLnB1c2goY29weVNwYW4oc3BhbiwgeyB0ZXh0OiByZW1vdmVkU3BhblRleHQsIGdyb3VwOiBzcGFuLmlkIH0pKTsgIC8vIFRPRE86IG5ldyBpZCA/Pz9cbiAgICAgIH1cbiAgICAgIHJldHVybiB7IHNwYW5zOiBjb3BpZWRTcGFucywgc3BsaXRJbmRleDogc3RhcnRJbmRleCwgc3BsaXRPZmZzZXQ6IHN0YXJ0T2Zmc2V0IH07XG4gICAgfVxuICB9XG5cbiAgaWYoZW5kSW5kZXggPT09IHN0YXJ0SW5kZXggKyAxICYmIGVuZE9mZnNldCA9PT0gMCAmJiBzdGFydE9mZnNldCA+PSBzcGFuc1tzdGFydEluZGV4XS50ZXh0Lmxlbmd0aCkge1xuICAgIC8vIGNvbGxhcHNlZCBwb3NpdGlvbiBvbiBzcGFuIHNwYW4gYm9yZGVyIGZyb20gYm90aCBzaWRlc1xuICAgIHJldHVybiB7IHNwYW5zOiBbXSwgc3BsaXRJbmRleDogc3RhcnRJbmRleCwgc3BsaXRPZmZzZXQ6IHN0YXJ0T2Zmc2V0IH07XG4gIH1cblxuICBjb25zdCBzcGxpY2VTdGFydCA9IHN0YXJ0T2Zmc2V0ID09PSAwID8gc3RhcnRJbmRleCA6IHN0YXJ0SW5kZXggKyAxO1xuICBjb25zdCBzcGxpY2VFbmQgPSBlbmRPZmZzZXQgPj0gZW5kU3Bhbkxlbmd0aCA/IGVuZEluZGV4IDogZW5kSW5kZXggLSAxO1xuICAvLyBbc3BsaWNlU3RhcnQsIHNwbGljZUVuZF0gLSBvbmx5IHdob2xlICh1c3VhbGx5IGlubmVyIG9ubHkpIHNwYW5zXG5cbiAgaWYobW9kZSA9PT0gU3BsaWNlTW9kZS5SZW1vdmUpIHtcblxuICAgIGNvbnN0IHJlbW92ZWRTcGFucyA9IHNwYW5zLnNwbGljZShzcGxpY2VTdGFydCwgc3BsaWNlRW5kICsgMSAtIHNwbGljZVN0YXJ0KTsgIC8vICsxIGJlY2F1c2UgZW5kIGlzIGluY2x1c2l2ZVxuICAgIGlmKHN0YXJ0SW5kZXggPCBzcGxpY2VTdGFydCkge1xuICAgICAgY29uc3Qgc3BhbiA9IHNwYW5zW3N0YXJ0SW5kZXhdO1xuICAgICAgY29uc3QgeyBsZWZ0LCByaWdodCB9ID0gc3BsaXRTcGFuKHNwYW4sIHN0YXJ0T2Zmc2V0KTtcbiAgICAgIGlmKHJpZ2h0LnRleHQubGVuZ3RoID4gMCkge1xuICAgICAgICByZW1vdmVkU3BhbnMudW5zaGlmdChjb3B5U3BhbihzcGFuLCByaWdodCkpO1xuICAgICAgfVxuICAgICAgT2JqZWN0LmFzc2lnbihzcGFuLCBsZWZ0KTtcbiAgICB9XG4gICAgaWYoc3BsaWNlRW5kIDwgZW5kSW5kZXgpIHtcbiAgICAgIGNvbnN0IHNwYW4gPSBzcGFuc1tzcGxpY2VTdGFydF07ICAvLyBzcGxpY2VTdGFydDogc3BhbnMgYXJlIGFscmVhZHkgcmVtb3ZlZCAvIHNwbGljZWQgZnJvbSB0aGUgYXJyYXlcbiAgICAgIGNvbnN0IHsgbGVmdCwgcmlnaHQgfSA9IHNwbGl0U3BhbihzcGFuLCBlbmRPZmZzZXQpO1xuICAgICAgaWYobGVmdC50ZXh0Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgcmVtb3ZlZFNwYW5zLnB1c2goY29weVNwYW4oc3BhbiwgbGVmdCkpO1xuICAgICAgfVxuICAgICAgT2JqZWN0LmFzc2lnbihzcGFuLCByaWdodCk7XG4gICAgfVxuICAgIC8vIHNwbGljZSBhbmQgdXBkYXRlIHRpbWUgZGVwZW5kaW5nIG9uIGR1cmF0aW9ucyBhbmQgc3BsaXQgZW5kcG9pbnRzXG4gICAgcmV0dXJuIHsgc3BhbnM6IHJlbW92ZWRTcGFucywgc3BsaXRJbmRleDogc3RhcnRJbmRleCwgc3BsaXRPZmZzZXQ6IHN0YXJ0T2Zmc2V0IH07XG5cbiAgfSBlbHNlIGlmKG1vZGUgPT09IFNwbGljZU1vZGUuSW5QbGFjZSkge1xuXG4gICAgLy8gY29weSBpbm5lciBzcGFuc1xuICAgIGNvbnN0IHNsaWNlZFNwYW5zID0gc3BhbnMuc2xpY2Uoc3BsaWNlU3RhcnQsIHNwbGljZUVuZCArIDEpOyAgLy8gKzEgYmVjYXVzZSBlbmQgaXMgaW5jbHVzaXZlXG5cbiAgICAvLyBjb25zb2xlLmxvZyhgaW5QbGFjZSAgc3RhcnRJbmRleD0ke3N0YXJ0SW5kZXh9ICBzcGxpY2VTdGFydD0ke3NwbGljZVN0YXJ0fSAgc3RhcnRPZmZzZXQ9JHtzdGFydE9mZnNldH0gIGVuZEluZGV4PSR7ZW5kSW5kZXh9ICBzcGxpY2VFbmQ9JHtzcGxpY2VFbmR9ICBlbmRPZmZzZXQ9JHtlbmRPZmZzZXR9YClcbiAgICAvLyBkZWFsIHdpdGggYm9yZGVyIHNwYW5zXG4gICAgLy8gc3RhcnQgd2l0aCBlbmQgYXMgdGhlIGluZGV4IG1heSBiZWNvbSBpbnZhbGlkIGFmdGVyIHRoZSBzdGFydCBpcyBzcGxpdFxuICAgIGlmKHNwbGljZUVuZCA8IGVuZEluZGV4KSB7XG4gICAgICBjb25zdCBzcGFuID0gc3BhbnNbZW5kSW5kZXhdO1xuICAgICAgaWYoZW5kT2Zmc2V0ID4gMCAmJiBlbmRPZmZzZXQgPCBzcGFuLnRleHQubGVuZ3RoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdlbmQgb2Zmc2V0IG1pZGRsZScpXG4gICAgICAgIGNvbnN0IHsgbGVmdCwgcmlnaHQgfSA9IHNwbGl0U3BhbihzcGFuLCBlbmRPZmZzZXQpO1xuICAgICAgICBzcGFucy5zcGxpY2UoZW5kSW5kZXgsIDEsIC4uLltsZWZ0LCByaWdodF0uZmlsdGVyKHMgPT4gcy50ZXh0Lmxlbmd0aCA+IDApKTtcbiAgICAgICAgLy8gaWYobGVmdC50ZXh0Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBzbGljZWRTcGFucy5wdXNoKGxlZnQpO1xuICAgICAgICAvLyB9XG4gICAgICAgIC8vIE9iamVjdC5hc3NpZ24oc3BhbiwgcmlnaHQpO1xuICAgICAgfSBlbHNlIGlmKGVuZE9mZnNldCA+IDApIHtcbiAgICAgICAgc2xpY2VkU3BhbnMucHVzaChzcGFuKTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYoc3RhcnRJbmRleCA8IHNwbGljZVN0YXJ0KSB7XG4gICAgICBjb25zdCBzcGFuID0gc3BhbnNbc3RhcnRJbmRleF07XG4gICAgICBpZihzdGFydE9mZnNldCA+IDAgJiYgc3RhcnRPZmZzZXQgPCBzcGFuLnRleHQubGVuZ3RoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdzdGFydCBvZmZzZXQgbWlkZGxlJylcbiAgICAgICAgY29uc3QgeyBsZWZ0LCByaWdodCB9ID0gc3BsaXRTcGFuKHNwYW4sIHN0YXJ0T2Zmc2V0KTtcbiAgICAgICAgLy8gaWYocmlnaHQudGV4dC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgc2xpY2VkU3BhbnMudW5zaGlmdChyaWdodCk7XG4gICAgICAgIC8vIH1cbiAgICAgICAgc3BhbnMuc3BsaWNlKHN0YXJ0SW5kZXgsIDEsIC4uLltsZWZ0LCByaWdodF0uZmlsdGVyKHMgPT4gcy50ZXh0Lmxlbmd0aCA+IDApKTtcbiAgICAgICAgLy8gT2JqZWN0LmFzc2lnbihzcGFuLCBsZWZ0KTtcbiAgICAgICAgc3RhcnRJbmRleCsrO1xuICAgICAgfSBlbHNlIGlmKHN0YXJ0T2Zmc2V0ID09PSAwKSB7XG4gICAgICAgIHNsaWNlZFNwYW5zLnVuc2hpZnQoc3Bhbik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzdGFydEluZGV4Kys7XG4gICAgICB9XG4gICAgfVxuICAgIC8vIHNwbGljZSBhbmQgdXBkYXRlIHRpbWUgZGVwZW5kaW5nIG9uIGR1cmF0aW9ucyBhbmQgc3BsaXQgZW5kcG9pbnRzXG4gICAgcmV0dXJuIHsgc3BhbnM6IHNsaWNlZFNwYW5zLCBzcGxpdEluZGV4OiBzdGFydEluZGV4LCBzcGxpdE9mZnNldDogc3RhcnRPZmZzZXQgfTtcblxuICB9IGVsc2UgaWYobW9kZSA9PT0gU3BsaWNlTW9kZS5Db3B5KSB7XG5cbiAgICBjb25zdCBzbGljZWRTcGFucyA9IHNwYW5zLnNsaWNlKHNwbGljZVN0YXJ0LCBzcGxpY2VFbmQgKyAxKTtcblxuICAgIGlmKHN0YXJ0SW5kZXggPCBzcGxpY2VTdGFydCkge1xuICAgICAgY29uc3Qgc3BhbiA9IHNwYW5zW3N0YXJ0SW5kZXhdO1xuICAgICAgY29uc3QgeyBsZWZ0LCByaWdodCB9ID0gc3BsaXRTcGFuKHNwYW4sIHN0YXJ0T2Zmc2V0KTtcbiAgICAgIGlmKHJpZ2h0LnRleHQubGVuZ3RoID4gMCkge1xuICAgICAgICBzbGljZWRTcGFucy51bnNoaWZ0KGNvcHlTcGFuKHNwYW4sIHJpZ2h0KSk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmKHNwbGljZUVuZCA8IGVuZEluZGV4KSB7XG4gICAgICBjb25zdCBzcGFuID0gc3BhbnNbZW5kSW5kZXhdO1xuICAgICAgY29uc3QgeyBsZWZ0LCByaWdodCB9ID0gc3BsaXRTcGFuKHNwYW4sIGVuZE9mZnNldCk7XG4gICAgICBpZihsZWZ0LnRleHQubGVuZ3RoID4gMCkge1xuICAgICAgICBzbGljZWRTcGFucy5wdXNoKGNvcHlTcGFuKHNwYW4sIGxlZnQpKTtcbiAgICAgIH1cbiAgICB9XG4gICAgLy8gc3BsaWNlIGFuZCB1cGRhdGUgdGltZSBkZXBlbmRpbmcgb24gZHVyYXRpb25zIGFuZCBzcGxpdCBlbmRwb2ludHNcbiAgICByZXR1cm4geyBzcGFuczogc2xpY2VkU3BhbnMsIHNwbGl0SW5kZXg6IHN0YXJ0SW5kZXgsIHNwbGl0T2Zmc2V0OiBzdGFydE9mZnNldCB9O1xuXG4gIH1cbiAgcmV0dXJuO1xufVxuXG5cblxuXG5leHBvcnQgZnVuY3Rpb24gZGF0YVNwbGljZShkYXRhLCBzdGFydCwgZW5kLCBtb2RlID0gU3BsaWNlTW9kZS5SZW1vdmUpIHtcbiAgLy8gbW9kZTogcmVtb3ZlLCBpbnBsYWNlLCBjb3B5XG4gIGNvbnN0IHBhcmFncmFwaHMgPSBkYXRhUGFyYWdyYXBocyhkYXRhKTtcbiAgY29uc3QgcmVtb3ZlZCA9IFtdO1xuICBsZXQgc3RhcnRQYXJhZ3JhcGg7XG4gIGZvcihsZXQgaT1zdGFydC5wYXJhZ3JhcGhJbmRleDsgaTxwYXJhZ3JhcGhzLmxlbmd0aCAmJiBpIDw9IGVuZC5wYXJhZ3JhcGhJbmRleDspIHtcbiAgICBjb25zdCBwYXJhZ3JhcGggPSBwYXJhZ3JhcGhzW2ldO1xuICAgIGlmKHBhcmFncmFwaC5pZCA9PT0gc3RhcnQucGFyYWdyYXBoSUQpIHtcbiAgICAgIHN0YXJ0UGFyYWdyYXBoID0gcGFyYWdyYXBoO1xuICAgIH1cbiAgICBpZihwYXJhZ3JhcGguaWQgPT09IHN0YXJ0LnBhcmFncmFwaElEICYmIHBhcmFncmFwaC5pZCA9PT0gZW5kLnBhcmFncmFwaElEKSB7XG4gICAgICAvLyBzaW5nbGUgcGFyYWdyYXBoXG4gICAgICBpZihwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGgpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgLy8gbm9uLWVtcHR5IHBhcmFncmFwaFxuICAgICAgICBpZihtb2RlID09PSBTcGxpY2VNb2RlLlJlbW92ZSkge1xuICAgICAgICAgIGNvbnN0IHJlbW92ZWRTcGFucyA9IHNwbGljZVNwYW5zKHBhcmFncmFwaFNwYW5zKHBhcmFncmFwaCksIHN0YXJ0LnNwYW5JbmRleCwgc3RhcnQub2Zmc2V0LCBlbmQuc3BhbkluZGV4LCBlbmQub2Zmc2V0LCBtb2RlKTtcbiAgICAgICAgICBpZihyZW1vdmVkU3BhbnMuc3BhbnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgcmVtb3ZlZC5wdXNoKHtcbiAgICAgICAgICAgICAgaWQ6IHBhcmFncmFwaC5pZCxcbiAgICAgICAgICAgICAgc3BhbnM6IHJlbW92ZWRTcGFucy5zcGFucyxcbiAgICAgICAgICAgICAgcGFydGlhbDogc3RhcnQuc3BhbkluZGV4ID4gMCB8fCBzdGFydC5vZmZzZXQgPiAwIHx8IGVuZC5zcGFuSW5kZXggPCBwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGgpLmxlbmd0aCAtIDFcbiAgICAgICAgICAgICAgICAgICAgICB8fCBwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGgpLmxlbmd0aCA+IDAgJiYgZW5kLm9mZnNldCA8IGxhc3QocGFyYWdyYXBoU3BhbnMocGFyYWdyYXBoKSkudGV4dC5sZW5ndGhcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmKG1vZGUgPT09IFNwbGljZU1vZGUuQ29weSkge1xuICAgICAgICAgIGNvbnN0IHJlbW92ZWRTcGFucyA9IHNwbGljZVNwYW5zKHBhcmFncmFwaFNwYW5zKHBhcmFncmFwaCksIHN0YXJ0LnNwYW5JbmRleCwgc3RhcnQub2Zmc2V0LCBlbmQuc3BhbkluZGV4LCBlbmQub2Zmc2V0LCBtb2RlKTtcbiAgICAgICAgICBpZihyZW1vdmVkU3BhbnMuc3BhbnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgcmVtb3ZlZC5wdXNoKHtcbiAgICAgICAgICAgICAgaWQ6IHBhcmFncmFwaC5pZCxcbiAgICAgICAgICAgICAgc3BhbnM6IHJlbW92ZWRTcGFucy5zcGFucyxcbiAgICAgICAgICAgICAgcGFydGlhbDogc3RhcnQuc3BhbkluZGV4ID4gMCB8fCBzdGFydC5vZmZzZXQgPiAwIHx8IGVuZC5zcGFuSW5kZXggPCBwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGgpLmxlbmd0aCAtIDFcbiAgICAgICAgICAgICAgICAgICAgICB8fCBlbmQub2Zmc2V0IDwgbGFzdChwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGgpKS50ZXh0Lmxlbmd0aFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYobW9kZSA9PT0gU3BsaWNlTW9kZS5JblBsYWNlKSB7XG4gICAgICAgICAgY29uc3QgcmVtb3ZlZFNwYW5zID0gc3BsaWNlU3BhbnMocGFyYWdyYXBoU3BhbnMocGFyYWdyYXBoKSwgc3RhcnQuc3BhbkluZGV4LCBzdGFydC5vZmZzZXQsIGVuZC5zcGFuSW5kZXgsIGVuZC5vZmZzZXQsIG1vZGUpO1xuICAgICAgICAgIGlmKHJlbW92ZWRTcGFucy5zcGFucy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICByZW1vdmVkLnB1c2goe1xuICAgICAgICAgICAgICBpZDogcGFyYWdyYXBoLmlkLFxuICAgICAgICAgICAgICBzcGFuczogcmVtb3ZlZFNwYW5zLnNwYW5zLFxuICAgICAgICAgICAgICBwYXJ0aWFsOiBzdGFydC5zcGFuSW5kZXggPiAwIHx8IHN0YXJ0Lm9mZnNldCA+IDAgfHwgZW5kLnNwYW5JbmRleCA8IHBhcmFncmFwaFNwYW5zKHBhcmFncmFwaCkubGVuZ3RoIC0gMVxuICAgICAgICAgICAgICAgICAgICAgIHx8IGVuZC5vZmZzZXQgPCBsYXN0KHBhcmFncmFwaFNwYW5zKHBhcmFncmFwaCkpLnRleHQubGVuZ3RoXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIGVtcHR5IHBhcmFncmFwaFxuICAgICAgICBpZihtb2RlID09PSBTcGxpY2VNb2RlLlJlbW92ZSkge1xuICAgICAgICAgIHBhcmFncmFwaHMuc3BsaWNlKGksIDEpOyAvLyByZW1vdmUgcGFyYWdyYXBoXG4gICAgICAgICAgcmVtb3ZlZC5wdXNoKE9iamVjdC5hc3NpZ24oe30sIHBhcmFncmFwaCwgeyBwYXJ0aWFsOiBmYWxzZSB9KSk7XG4gICAgICAgIH0gZWxzZSBpZihtb2RlID09PSBTcGxpY2VNb2RlLkNvcHkpIHtcbiAgICAgICAgICByZW1vdmVkLnB1c2goT2JqZWN0LmFzc2lnbih7fSwgcGFyYWdyYXBoLCB7IHBhcnRpYWw6IGZhbHNlIH0pKTtcbiAgICAgICAgfSBlbHNlIGlmKG1vZGUgPT09IFNwbGljZU1vZGUuSW5QbGFjZSkge1xuICAgICAgICAgIHBhcmFncmFwaHMuc3BsaWNlKGksIDEpOyAvLyByZW1vdmUgcGFyYWdyYXBoXG4gICAgICAgICAgcmVtb3ZlZC5wdXNoKHBhcmFncmFwaCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuICAgIH0gZWxzZSBpZihwYXJhZ3JhcGguaWQgPT09IHN0YXJ0LnBhcmFncmFwaElEICYmIHBhcmFncmFwaFNwYW5zKHBhcmFncmFwaCkubGVuZ3RoID4gMCkge1xuICAgICAgLy8gc3RhcnQgcGFyYWdyYXBoIG9ubHlcbiAgICAgIGNvbnN0IHJlbW92ZWRTcGFucyA9IHNwbGljZVNwYW5zKHBhcmFncmFwaFNwYW5zKHBhcmFncmFwaCksIHN0YXJ0LnNwYW5JbmRleCwgc3RhcnQub2Zmc2V0LCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgbW9kZSk7XG4gICAgICBpZihwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGgpLmxlbmd0aCA9PT0gMCAmJiBtb2RlID09PSBTcGxpY2VNb2RlLlJlbW92ZSkge1xuICAgICAgICBwYXJhZ3JhcGhzLnNwbGljZShpLCAxKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGkrKztcbiAgICAgIH1cbiAgICAgIGlmKHJlbW92ZWRTcGFucy5zcGFucy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHJlbW92ZWQucHVzaCh7IGlkOiBwYXJhZ3JhcGguaWQsIHNwYW5zOiByZW1vdmVkU3BhbnMuc3BhbnMsIHBhcnRpYWw6IHBhcmFncmFwaFNwYW5zKHBhcmFncmFwaCkubGVuZ3RoID4gMCB9KTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYocGFyYWdyYXBoLmlkID09PSBlbmQucGFyYWdyYXBoSUQgJiYgcGFyYWdyYXBoU3BhbnMocGFyYWdyYXBoKS5sZW5ndGggPiAwKSB7XG4gICAgICAvLyBlbmQgcGFyYWdyYXBoXG4gICAgICBjb25zdCByZW1vdmVkU3BhbnMgPSBzcGxpY2VTcGFucyhwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGgpLCAwLCAwLCBlbmQuc3BhbkluZGV4LCBlbmQub2Zmc2V0LCBtb2RlKTtcbiAgICAgIGlmKHJlbW92ZWRTcGFucy5zcGFucy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHJlbW92ZWQucHVzaCh7IGlkOiBwYXJhZ3JhcGguaWQsIHNwYW5zOiByZW1vdmVkU3BhbnMuc3BhbnMsIHBhcnRpYWw6IHBhcmFncmFwaFNwYW5zKHBhcmFncmFwaCkubGVuZ3RoID4gMCB9KTtcbiAgICAgIH1cbiAgICAgIC8vIGNoZWNrIGlmIHN0YXJ0IHBhcmFncmFwaCB3YXMgbm9uLWVtcHR5IChhbmQgdGh1cyBub3QgcmVtb3ZlZClcbiAgICAgIGlmKHBhcmFncmFwaFNwYW5zKHN0YXJ0UGFyYWdyYXBoKS5sZW5ndGggPiAwKSB7XG4gICAgICAgIC8vIGpvaW4gZmlyc3QgYW5kIGxhc3QgcGFyYWdyYXBocywgaS5lLiwgYXBwZW5kIHJlc3Qgb2YgdGhlIGxhc3QgdG8gdGhlIGZpcnN0IHBhcmFncmFwaFxuICAgICAgICBpZihtb2RlID09PSBTcGxpY2VNb2RlLlJlbW92ZSkge1xuICAgICAgICAgIHBhcmFncmFwaFNwYW5zKHN0YXJ0UGFyYWdyYXBoKS5zcGxpY2UocGFyYWdyYXBoU3BhbnMoc3RhcnRQYXJhZ3JhcGgpLmxlbmd0aCwgMCwgLi4ucGFyYWdyYXBoU3BhbnMocGFyYWdyYXBoKSk7XG4gICAgICAgICAgcGFyYWdyYXBocy5zcGxpY2UoaSwgMSk7ICAvLyBwYXJhZ3JhcGggbGVmdG92ZXIgc3BhbnMgYXJlIGFkZGVkIHRvIHN0YXJ0IHBhcmFncmFwaFxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBicmVhaztcbiAgICB9IGVsc2UgaWYocGFyYWdyYXBoLmlkID09PSBlbmQucGFyYWdyYXBoSUQpIHtcbiAgICAgIC8vIGVtcHR5IGVuZCBwYXJhZ3JhcGgsIHJlbW92ZSBpdFxuICAgICAgaWYobW9kZSA9PT0gU3BsaWNlTW9kZS5SZW1vdmUpIHtcbiAgICAgICAgcGFyYWdyYXBocy5zcGxpY2UoaSwgMSk7XG4gICAgICB9XG4gICAgICByZW1vdmVkLnB1c2goT2JqZWN0LmFzc2lnbih7fSwgcGFyYWdyYXBoLCB7IHBhcnRpYWw6IGZhbHNlIH0pKTtcbiAgICAgIGJyZWFrO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyByZW1vdmUgaW5uZXIgcGFyYWdyYXBoIG9mIHRoZSByYW5nZSwgcmVtb3ZlIGl0XG4gICAgICBpZihtb2RlID09PSBTcGxpY2VNb2RlLlJlbW92ZSkge1xuICAgICAgICBwYXJhZ3JhcGhzLnNwbGljZShpLCAxKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGkrKztcbiAgICAgIH1cbiAgICAgIHJlbW92ZWQucHVzaChPYmplY3QuYXNzaWduKHt9LCBwYXJhZ3JhcGgsIHsgcGFydGlhbDogZmFsc2UgfSkpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmVtb3ZlZDtcbn1cblxuZnVuY3Rpb24gZGF0YUNvcHlTcGFucyhzcGFucywgc3RhcnRJbmRleCwgc3RhcnRPZmZzZXQsIGVuZEluZGV4LCBlbmRPZmZzZXQpIHtcbiAgaWYoc3RhcnRJbmRleCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgc3RhcnRJbmRleCA9IDA7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRhdGFDb3B5KGRhdGEsIHN0YXJ0LCBlbmQpIHtcbiAgY29uc3QgcGFyYWdyYXBocyA9IGRhdGFQYXJhZ3JhcGhzKGRhdGEpO1xuICBjb25zdCBjb3BpZWQgPSBbXTtcbiAgZm9yKGxldCBpPXN0YXJ0LnBhcmFncmFwaEluZGV4OyBpPHBhcmFncmFwaHMubGVuZ3RoICYmIGkgPD0gZW5kLnBhcmFncmFwaEluZGV4OyBpKyspIHtcbiAgICBjb25zdCBwYXJhZ3JhcGggPSBwYXJhZ3JhcGhzW2ldO1xuICAgIGNvbnN0IHNwYW5zID0gcGFyYWdyYXBoU3BhbnMocGFyYWdyYXBoKTtcbiAgICBpZihzcGFucy5sZW5ndGggPT09IDApIHtcbiAgICAgIGNvcGllZC5wdXNoKHBhcmFncmFwaCk7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgaWYoaSA9PT0gc3RhcnQucGFyYWdyYXBoSW5kZXggJiYgaSA9PT0gZW5kLnBhcmFncmFwaEluZGV4KSB7XG4gICAgICBpZihzdGFydC5zcGFuSW5kZXggPT09IHVuZGVmaW5lZCB8fCBzdGFydC5zcGFuSW5kZXggPT09IC0xIHx8IGVuZC5zcGFuSW5kZXggPT09IHVuZGVmaW5lZCB8fCBlbmQuc3BhbkluZGV4ID09PSAtMSkge1xuICAgICAgICBjb3BpZWQucHVzaChwYXJhZ3JhcGgpO1xuICAgICAgICBicmVhaztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmKHN0YXJ0Lm9mZnNldCA9PT0gdW5kZWZpbmVkICYmIGVuZC5vZmZzZXQgPT09IHVuZGVmaW5lZCkge1xuXG4gICAgICAgIH0gZWxzZSBpZihzdGFydC5vZmZzZXQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICB9IGVsc2UgaWYoZW5kLm9mZnNldCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gY2hlY2sgcG9zaXRpb25zIGJvdGhcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgLy8gbGV0IHNsaWNlU3RhcnQgPSBzdGFydC5cbiAgICB9IGVsc2UgaWYoaSA9PT0gc3RhcnQucGFyYWdyYXBoSW5kZXgpIHtcbiAgICB9IGVsc2UgaWYoaSA9PT0gZW5kLnBhcmFncmFwaEluZGV4KSB7XG4gICAgfVxuXG4gICAgY29waWVkUGFyYWdyYXBoID0gT2JqZWN0LmFzc2lnbih7fSwgcGFyYWdyYXBoLCB7IHNwYW5zOiBbXSB9KTtcbiAgICAvLyBmb3IobGV0IGs9c3RhcnQuc3BhbkluZGV4KVxuICAgIC8vIGlmKHN0YXJ0LilcblxuICB9XG4gIHJldHVybiBjb3BpZWQ7XG5cblxuXG4gIGNvbnN0IHJlbW92ZWQgPSBbXTtcbiAgbGV0IHN0YXJ0UGFyYWdyYXBoO1xuICBmb3IobGV0IGk9c3RhcnQucGFyYWdyYXBoSW5kZXg7IGk8cGFyYWdyYXBocy5sZW5ndGggJiYgaSA8PSBlbmQucGFyYWdyYXBoSW5kZXg7KSB7XG4gICAgY29uc3QgcGFyYWdyYXBoID0gcGFyYWdyYXBoc1tpXTtcbiAgICBpZihwYXJhZ3JhcGguaWQgPT09IHN0YXJ0LnBhcmFncmFwaElEKSB7XG4gICAgICBzdGFydFBhcmFncmFwaCA9IHBhcmFncmFwaDtcbiAgICB9XG4gICAgaWYocGFyYWdyYXBoLmlkID09PSBzdGFydC5wYXJhZ3JhcGhJRCAmJiBwYXJhZ3JhcGguaWQgPT09IGVuZC5wYXJhZ3JhcGhJRCkge1xuICAgICAgaWYocGFyYWdyYXBoU3BhbnMocGFyYWdyYXBoKS5sZW5ndGggPiAwKSB7XG4gICAgICAgIC8vIG5vbi1lbXB0eSBwYXJhZ3JhcGhcbiAgICAgICAgY29uc3QgcmVtb3ZlZFNwYW5zID0gc3BsaWNlU3BhbnMocGFyYWdyYXBoU3BhbnMocGFyYWdyYXBoKSwgc3RhcnQuc3BhbkluZGV4LCBzdGFydC5vZmZzZXQsIGVuZC5zcGFuSW5kZXgsIGVuZC5vZmZzZXQpO1xuICAgICAgICBpZihyZW1vdmVkU3BhbnMuc3BhbnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIHJlbW92ZWQucHVzaCh7IGlkOiBwYXJhZ3JhcGguaWQsIHNwYW5zOiByZW1vdmVkU3BhbnMuc3BhbnMsXG4gICAgICAgICAgICBwYXJ0aWFsOiBzdGFydC5zcGFuSW5kZXggPiAwIHx8IHN0YXJ0Lm9mZnNldCA+IDAgfHwgZW5kLnNwYW5JbmRleCA8IHBhcmFncmFwaFNwYW5zKHBhcmFncmFwaCkubGVuZ3RoIC0gMSB8fCBlbmQub2Zmc2V0IDwgbGFzdChwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGgpKS50ZXh0Lmxlbmd0aCB9KTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gZW1wdHkgcGFyYWdyYXBoLCByZW1vdmUgaXRcbiAgICAgICAgcGFyYWdyYXBocy5zcGxpY2UoaSwgMSk7XG4gICAgICAgIHJlbW92ZWQucHVzaChPYmplY3QuYXNzaWduKHt9LCBwYXJhZ3JhcGgsIHsgcGFydGlhbDogZmFsc2UgfSkpO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG4gICAgfSBlbHNlIGlmKHBhcmFncmFwaC5pZCA9PT0gc3RhcnQucGFyYWdyYXBoSUQgJiYgcGFyYWdyYXBoU3BhbnMocGFyYWdyYXBoKS5sZW5ndGggPiAwKSB7XG4gICAgICAvLyBzdGFydCBwYXJhZ3JhcGggb25seVxuICAgICAgY29uc3QgcmVtb3ZlZFNwYW5zID0gc3BsaWNlU3BhbnMocGFyYWdyYXBoU3BhbnMocGFyYWdyYXBoKSwgc3RhcnQuc3BhbkluZGV4LCBzdGFydC5vZmZzZXQpO1xuICAgICAgaWYocGFyYWdyYXBoU3BhbnMocGFyYWdyYXBoKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgcGFyYWdyYXBocy5zcGxpY2UoaSwgMSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpKys7XG4gICAgICB9XG4gICAgICBpZihyZW1vdmVkU3BhbnMuc3BhbnMubGVuZ3RoID4gMCkge1xuICAgICAgICByZW1vdmVkLnB1c2goeyBpZDogcGFyYWdyYXBoLmlkLCBzcGFuczogcmVtb3ZlZFNwYW5zLnNwYW5zLCBwYXJ0aWFsOiBwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGgpLmxlbmd0aCA+IDAgfSk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmKHBhcmFncmFwaC5pZCA9PT0gZW5kLnBhcmFncmFwaElEICYmIHBhcmFncmFwaFNwYW5zKHBhcmFncmFwaCkubGVuZ3RoID4gMCkge1xuICAgICAgLy8gZW5kIHBhcmFncmFwaFxuICAgICAgY29uc3QgcmVtb3ZlZFNwYW5zID0gc3BsaWNlU3BhbnMocGFyYWdyYXBoU3BhbnMocGFyYWdyYXBoKSwgMCwgMCwgZW5kLnNwYW5JbmRleCwgZW5kLm9mZnNldCk7XG4gICAgICBpZihyZW1vdmVkU3BhbnMuc3BhbnMubGVuZ3RoID4gMCkge1xuICAgICAgICByZW1vdmVkLnB1c2goeyBpZDogcGFyYWdyYXBoLmlkLCBzcGFuczogcmVtb3ZlZFNwYW5zLnNwYW5zLCBwYXJ0aWFsOiBwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGgpLmxlbmd0aCA+IDAgfSk7XG4gICAgICB9XG4gICAgICAvLyBjaGVjayBpZiBzdGFydCBwYXJhZ3JhcGggd2FzIG5vbi1lbXB0eSAoYW5kIHRodXMgbm90IHJlbW92ZWQpXG4gICAgICBpZihwYXJhZ3JhcGhTcGFucyhzdGFydFBhcmFncmFwaCkubGVuZ3RoID4gMCkge1xuICAgICAgICAvLyBqb2luIGZpcnN0IGFuZCBsYXN0IHBhcmFncmFwaHMsIGkuZS4sIGFwcGVuZCByZXN0IG9mIHRoZSBsYXN0IHRvIHRoZSBmaXJzdCBwYXJhZ3JhcGhcbiAgICAgICAgcGFyYWdyYXBoU3BhbnMoc3RhcnRQYXJhZ3JhcGgpLnNwbGljZShwYXJhZ3JhcGhTcGFucyhzdGFydFBhcmFncmFwaCkubGVuZ3RoLCAwLCAuLi5wYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGgpKTtcbiAgICAgICAgcGFyYWdyYXBocy5zcGxpY2UoaSwgMSk7ICAvLyBwYXJhZ3JhcGggbGVmdG92ZXIgc3BhbnMgYXJlIGFkZGVkIHRvIHN0YXJ0IHBhcmFncmFwaFxuICAgICAgfVxuICAgICAgYnJlYWs7XG4gICAgfSBlbHNlIGlmKHBhcmFncmFwaC5pZCA9PT0gZW5kLnBhcmFncmFwaElEKSB7XG4gICAgICAvLyBlbXB0eSBlbmQgcGFyYWdyYXBoLCByZW1vdmUgaXRcbiAgICAgIHBhcmFncmFwaHMuc3BsaWNlKGksIDEpO1xuICAgICAgcmVtb3ZlZC5wdXNoKE9iamVjdC5hc3NpZ24oe30sIHBhcmFncmFwaCwgeyBwYXJ0aWFsOiBmYWxzZSB9KSk7XG4gICAgICBicmVhaztcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gcmVtb3ZlIGlubmVyIHBhcmFncmFwaCBvZiB0aGUgcmFuZ2UsIHJlbW92ZSBpdFxuICAgICAgcGFyYWdyYXBocy5zcGxpY2UoaSwgMSk7XG4gICAgICByZW1vdmVkLnB1c2goT2JqZWN0LmFzc2lnbih7fSwgcGFyYWdyYXBoLCB7IHBhcnRpYWw6IGZhbHNlIH0pKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHJlbW92ZWQ7XG59XG5cblxuZXhwb3J0IGZ1bmN0aW9uIGRhdGFJbnNlcnQoZGF0YSwgc3RhcnQsIG5ld0RhdGEpIHtcbiAgY29uc3QgcGFyYWdyYXBocyA9IGRhdGFQYXJhZ3JhcGhzKGRhdGEpO1xuICBjb25zdCBuZXdQYXJhZ3JhcGhzID0gZGF0YVBhcmFncmFwaHMobmV3RGF0YSk7XG4gIGlmKG5ld1BhcmFncmFwaHMubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYocGFyYWdyYXBocy5sZW5ndGggPT09IDApIHtcbiAgICBwYXJhZ3JhcGhzLnNwbGljZSgwLCAwLCAuLi5uZXdEYXRhKTtcbiAgICBjb25zdCBsYXN0UGFyYWdyYXBoID0gbGFzdChuZXdEYXRhKTtcbiAgICByZXR1cm4geyBzdGFydDogZGF0YVBvaW50ZXIoZGF0YSwgeyBwYXJhZ3JhcGhJbmRleDogMCwgc3BhbkluZGV4OiAwLCBvZmZzZXQ6IDAgfSksXG4gICAgICBlbmQ6IGRhdGFQb2ludGVyKGRhdGEsIHsgcGFyYWdyYXBoSW5kZXg6IG5ld0RhdGEubGVuZ3RoIC0gMSwgc3BhbkluZGV4OiBsYXN0UGFyYWdyYXBoLnNwYW5zLmxlbmd0aCAtIDEsIG9mZnNldDogbGFzdChsYXN0UGFyYWdyYXBoLnNwYW5zKS50ZXh0Lmxlbmd0aCB9KSB9O1xuICB9XG5cbiAgaWYobmV3UGFyYWdyYXBocy5sZW5ndGggPT09IDEpIHtcbiAgICAvLyBzaW5nbGUgcGFyYWdyYXBoIHRvIGJlIGluc2VydGVkXG5cbiAgICBjb25zdCBuZXdTcGFucyA9IHBhcmFncmFwaFNwYW5zKG5ld1BhcmFncmFwaHNbMF0pO1xuICAgIGNvbnN0IHBhcmFncmFwaCA9IHBhcmFncmFwaHNbc3RhcnQucGFyYWdyYXBoSW5kZXhdO1xuXG4gICAgLy8gbGV0IGVuZDtcblxuICAgIGxldCBpbnNlcnRlZFN0YXJ0LCBpbnNlcnRlZEVuZDtcblxuICAgIGlmKHN0YXJ0Lm9mZnNldCA9PT0gMCkge1xuICAgICAgLy8gc3BhbiBiZWxvbmdzIHRvIHJpZ2h0IHNldFxuICAgICAgcGFyYWdyYXBoU3BhbnMocGFyYWdyYXBoKS5zcGxpY2Uoc3RhcnQuc3BhbkluZGV4LCAwLCAuLi5uZXdTcGFucyk7XG5cbiAgICAgIGluc2VydGVkU3RhcnQgPSBkYXRhUG9pbnRlcihkYXRhLCB7IHBhcmFncmFwaElEOiBzdGFydC5wYXJhZ3JhcGhJRCwgc3BhbkluZGV4OiBzdGFydC5zcGFuSW5kZXgsIG9mZnNldDogMCB9KTtcbiAgICAgIGluc2VydGVkRW5kID0gZGF0YVBvaW50ZXIoZGF0YSwgeyBwYXJhZ3JhcGhJRDogc3RhcnQucGFyYWdyYXBoSUQsIHNwYW5JbmRleDogc3RhcnQuc3BhbkluZGV4ICsgbmV3U3BhbnMubGVuZ3RoIC0gMSwgb2Zmc2V0OiAtMSB9KTtcblxuICAgIH0gZWxzZSBpZihzdGFydC5vZmZzZXQgPT09IHBhcmFncmFwaFNwYW5zKHBhcmFncmFwaClbc3RhcnQuc3BhbkluZGV4XS50ZXh0Lmxlbmd0aCkge1xuICAgICAgLy8gc3BhbiBiZWxvbmdzIHRvIGxlZnQgc2V0XG4gICAgICBwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGgpLnNwbGljZShzdGFydC5zcGFuSW5kZXgrMSwgMCwgLi4ubmV3U3BhbnMpO1xuXG4gICAgICBpbnNlcnRlZFN0YXJ0ID0gZGF0YVBvaW50ZXIoZGF0YSwgeyBwYXJhZ3JhcGhJRDogc3RhcnQucGFyYWdyYXBoSUQsIHNwYW5JbmRleDogc3RhcnQuc3BhbkluZGV4ICsgMSwgb2Zmc2V0OiAwIH0pO1xuICAgICAgaW5zZXJ0ZWRFbmQgPSBkYXRhUG9pbnRlcihkYXRhLCB7IHBhcmFncmFwaElEOiBzdGFydC5wYXJhZ3JhcGhJRCwgc3BhbkluZGV4OiBzdGFydC5zcGFuSW5kZXggKyAxICsgbmV3U3BhbnMubGVuZ3RoIC0gMSwgb2Zmc2V0OiAtMSB9KTtcblxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBzcGFuIG11c3QgYmUgY3V0IGluIGhhbGZcbiAgICAgIGNvbnN0IHsgbGVmdCwgcmlnaHQgfSA9IHNwbGl0U3BhbihwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGgpW3N0YXJ0LnNwYW5JbmRleF0sIHN0YXJ0Lm9mZnNldCk7XG4gICAgICBwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGgpLnNwbGljZShzdGFydC5zcGFuSW5kZXggKyAxLCAwLCBjb3B5U3BhbihwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGgpW3N0YXJ0LnNwYW5JbmRleF0sIHJpZ2h0KSk7XG4gICAgICBPYmplY3QuYXNzaWduKHBhcmFncmFwaFNwYW5zKHBhcmFncmFwaClbc3RhcnQuc3BhbkluZGV4XSwgbGVmdCk7XG4gICAgICBwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGgpLnNwbGljZShzdGFydC5zcGFuSW5kZXggKyAxLCAwLCAuLi5uZXdTcGFucyk7XG5cbiAgICAgIGluc2VydGVkU3RhcnQgPSBkYXRhUG9pbnRlcihkYXRhLCB7IHBhcmFncmFwaElEOiBzdGFydC5wYXJhZ3JhcGhJRCwgc3BhbkluZGV4OiBzdGFydC5zcGFuSW5kZXggKyAxLCBvZmZzZXQ6IDAgfSk7XG4gICAgICBpbnNlcnRlZEVuZCA9IGRhdGFQb2ludGVyKGRhdGEsIHsgcGFyYWdyYXBoSUQ6IHN0YXJ0LnBhcmFncmFwaElELCBzcGFuSW5kZXg6IHN0YXJ0LnNwYW5JbmRleCArIDEgKyBuZXdTcGFucy5sZW5ndGggLSAxLCBvZmZzZXQ6IC0xIH0pO1xuICAgIH1cblxuICAgIC8vIFRPRE86IGludGVycG9sYXRlIGluc2VydGVkIHNwYW5zXG4gICAgLy8gVE9ETzogcmVxdWlyZXM6IHByZXYgYW5kIG5leHQgc3BhbnMgZm9yIHRpbWUgaW5mb3JtYXRpb25cblxuICAgIHJldHVybiB7IHN0YXJ0OiBpbnNlcnRlZFN0YXJ0LCBlbmQ6IGluc2VydGVkRW5kLCBzcGFuczogbmV3U3BhbnMgfTtcbiAgfVxuXG4gIC8vIGluc2VydCBtdWx0aXBsZSBwYXJhZ3JhcGhzXG5cbiAgY29uc3Qgc3RhcnRQYXJhZ3JhcGggPSBwYXJhZ3JhcGhzW3N0YXJ0LnBhcmFncmFwaEluZGV4XTtcbiAgY29uc3QgbGFzdFBhcmFncmFwaCA9IG5ld1BhcmFncmFwaCgpO1xuICAvLyBsZXQgZW5kO1xuXG4gIGxldCBpbnNlcnRlZFN0YXJ0LCBpbnNlcnRlZEVuZDtcblxuICAvLyBmaXJzdCBwYXJhZ3JhcGggdG8gYmUgaW5zZXJ0ZWRcbiAgaWYoc3RhcnQuc3BhbkluZGV4ICE9IHVuZGVmaW5lZCAmJiBzdGFydC5zcGFuSW5kZXggIT0gLTEgJiYgcGFyYWdyYXBoU3BhbnMoc3RhcnRQYXJhZ3JhcGgpLmxlbmd0aCA+IDApIHtcbiAgICBpZihzdGFydC5vZmZzZXQgPT09IDApIHtcbiAgICAgIC8vIHNwYW4gYmVsb25ncyB0byByaWdodCBzZXRcbiAgICAgIGNvbnN0IHJpZ2h0U3BhbnMgPSBwYXJhZ3JhcGhTcGFucyhzdGFydFBhcmFncmFwaCkuc3BsaWNlKHN0YXJ0LnNwYW5JbmRleCk7XG4gICAgICBzZXRQYXJhZ3JhcGhTcGFucyhsYXN0UGFyYWdyYXBoLCByaWdodFNwYW5zKTtcbiAgICB9IGVsc2UgaWYoc3RhcnQub2Zmc2V0ID09PSBwYXJhZ3JhcGhTcGFucyhzdGFydFBhcmFncmFwaClbc3RhcnQuc3BhbkluZGV4XS50ZXh0Lmxlbmd0aCkge1xuICAgICAgLy8gc3BhbiBiZWxvbmdzIHRvIGxlZnQgc2V0XG4gICAgICBjb25zdCByaWdodFNwYW5zID0gcGFyYWdyYXBoU3BhbnMoc3RhcnRQYXJhZ3JhcGgpLnNwbGljZShzdGFydC5zcGFuSW5kZXgrMSk7XG4gICAgICBzZXRQYXJhZ3JhcGhTcGFucyhsYXN0UGFyYWdyYXBoLCByaWdodFNwYW5zKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gc3BhbiBtdXN0IGJlIGN1dCBpbiBoYWxmXG4gICAgICBjb25zdCByaWdodFNwYW5zID0gcGFyYWdyYXBoU3BhbnMoc3RhcnRQYXJhZ3JhcGgpLnNwbGljZShzdGFydC5zcGFuSW5kZXgrMSk7XG4gICAgICBjb25zdCB7IGxlZnQsIHJpZ2h0IH0gPSBzcGxpdFNwYW4ocGFyYWdyYXBoU3BhbnMoc3RhcnRQYXJhZ3JhcGgpW3N0YXJ0LnNwYW5JbmRleF0sIHN0YXJ0Lm9mZnNldCk7XG4gICAgICBzZXRQYXJhZ3JhcGhTcGFucyhsYXN0UGFyYWdyYXBoLCByaWdodFNwYW5zKTtcbiAgICAgIHBhcmFncmFwaFNwYW5zKGxhc3RQYXJhZ3JhcGgpLnVuc2hpZnQoY29weVNwYW4ocGFyYWdyYXBoU3BhbnMoc3RhcnRQYXJhZ3JhcGgpW3N0YXJ0LnNwYW5JbmRleF0sIHJpZ2h0KSk7XG4gICAgICBPYmplY3QuYXNzaWduKHBhcmFncmFwaFNwYW5zKHN0YXJ0UGFyYWdyYXBoKVtzdGFydC5zcGFuSW5kZXhdLCBsZWZ0KTtcbiAgICB9XG4gIH1cblxuICBpZihwYXJhZ3JhcGhTcGFucyhuZXdQYXJhZ3JhcGhzWzBdKS5sZW5ndGggPiAwKSB7XG4gICAgaW5zZXJ0ZWRTdGFydCA9IHsgcGFyYWdyYXBoSUQ6IHN0YXJ0UGFyYWdyYXBoLmlkLCBzcGFuSW5kZXg6IHBhcmFncmFwaFNwYW5zKHBhcmFncmFwaHNbc3RhcnQucGFyYWdyYXBoSW5kZXhdKS5sZW5ndGgsIG9mZnNldDogMCB9O1xuICB9XG5cbiAgLy8gYXBwZW5kIHNwYW5zIHRvIHN0YXJ0IHBhcmFncmFwaFxuICBwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGhzW3N0YXJ0LnBhcmFncmFwaEluZGV4XSkuc3BsaWNlKHBhcmFncmFwaFNwYW5zKHBhcmFncmFwaHNbc3RhcnQucGFyYWdyYXBoSW5kZXhdKS5sZW5ndGgsIDAsIC4uLnBhcmFncmFwaFNwYW5zKG5ld1BhcmFncmFwaHNbMF0pKVxuXG4gIC8vIG1pZGRsZSBwYXJhZ3JhcGhzXG4gIGxldCBwYXJhZ3JhcGhJbmRleCA9IHN0YXJ0LnBhcmFncmFwaEluZGV4ICsgMTtcbiAgaWYobmV3UGFyYWdyYXBocy5sZW5ndGggPiAyKSB7XG4gICAgcGFyYWdyYXBocy5zcGxpY2UocGFyYWdyYXBoSW5kZXgsIDAsIC4uLm5ld1BhcmFncmFwaHMuc2xpY2UoMSwgbmV3UGFyYWdyYXBocy5sZW5ndGggLSAxKSk7ICAvLyBnZXRTcGFucyA/IT9cbiAgICBwYXJhZ3JhcGhJbmRleCArPSBuZXdQYXJhZ3JhcGhzLmxlbmd0aCAtIDI7XG4gIH1cblxuICBwYXJhZ3JhcGhTcGFucyhsYXN0UGFyYWdyYXBoKS5zcGxpY2UoMCwgMCwgLi4ucGFyYWdyYXBoU3BhbnMobmV3UGFyYWdyYXBoc1tuZXdQYXJhZ3JhcGhzLmxlbmd0aCAtIDFdKSk7XG4gIHBhcmFncmFwaHMuc3BsaWNlKHBhcmFncmFwaEluZGV4LCAwLCBsYXN0UGFyYWdyYXBoKTtcblxuXG4gIGlmKCFpbnNlcnRlZFN0YXJ0KSB7XG4gICAgaW5zZXJ0ZWRTdGFydCA9IHsgcGFyYWdyYXBoSW5kZXg6IHN0YXJ0LnBhcmFncmFwaEluZGV4ICsgMSwgc3BhbkluZGV4OiAwLCBvZmZzZXQ6IDAgfTtcbiAgfVxuXG4gIGluc2VydGVkRW5kID0gZGF0YVBvaW50ZXIoZGF0YSwgeyBwYXJhZ3JhcGhJRDogbGFzdFBhcmFncmFwaC5pZCwgc3BhbkluZGV4OiBwYXJhZ3JhcGhTcGFucyhuZXdQYXJhZ3JhcGhzW25ld1BhcmFncmFwaHMubGVuZ3RoIC0gMV0pLmxlbmd0aCAtIDEsIG9mZnNldDogLTEgfSk7XG5cbiAgaW5zZXJ0ZWRTdGFydCA9IGRhdGFQb2ludGVyKGRhdGEsIGluc2VydGVkU3RhcnQpO1xuXG4gIC8vIFRPRE86IGludGVycG9sYXRlIGluc2VydGVkIHNwYW5zXG4gIC8vIFRPRE86IHJlcXVpcmVzOiBwcmV2IGFuZCBuZXh0IHNwYW5zIGZvciB0aW1lIGluZm9ybWF0aW9uXG5cbiAgY29uc3QgbmV3U3BhbnMgPSBkYXRhUGFyYWdyYXBocyhuZXdEYXRhKS5yZWR1Y2UoKHNwYW5zLCBwYXJhZ3JhcGgpID0+IHNwYW5zLmNvbmNhdChwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGgpKSwgW10pO1xuXG4gIHJldHVybiB7IHN0YXJ0OiBpbnNlcnRlZFN0YXJ0LCBlbmQ6IGluc2VydGVkRW5kLCBzcGFuczogbmV3U3BhbnMgfTtcbn1cblxuXG5mdW5jdGlvbiBkYXRhTWVyZ2VTcGFucyhzcGFucywgc291cmNlU3BhbnMpIHtcbiAgbGV0IHNvdXJjZVNwYW47XG4gIGxldCBrID0gMDtcbiAgZm9yKGNvbnN0IHNvdXJjZVNwYW4gb2Ygc291cmNlU3BhbnMpIHtcbiAgICBpZihrIDwgc3BhbnMubGVuZ3RoICYmIHNwYW5zW2tdLmlkID09PSBzb3VyY2VTcGFuLmlkKSB7XG4gICAgICBzcGFuc1trXS50ZXh0ID0gc291cmNlU3Bhbi50ZXh0O1xuICAgICAgLy8gZGF0YU1lcmdlU3BhbnMoc3BhblNwYW5zKHNwYW5zW2tdKSwgc3BhblNwYW5zKHNvdXJjZVNwYW4pKTtcbiAgICAgIGsrKztcbiAgICB9IGVsc2Uge1xuICAgICAgbGV0IGZvdW5kID0gZmFsc2U7XG4gICAgICBmb3IobGV0IGo9azsgajxzcGFucy5sZW5ndGg7IGorKykge1xuICAgICAgICBpZihzcGFuc1tqXS5pZCA9PT0gc291cmNlU3Bhbi5pZCkge1xuICAgICAgICAgIHNwYW5zLnNwbGljZShrLCBqLWspO1xuICAgICAgICAgIHNwYW5zW2tdLnRleHQgPSBzb3VyY2VTcGFuLnRleHQ7XG4gICAgICAgICAgaysrO1xuICAgICAgICAgIGZvdW5kID0gdHJ1ZTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYoIWZvdW5kKSB7XG4gICAgICAgIHNwYW5zLnNwbGljZShrLCAwLCBzb3VyY2VTcGFuKTtcbiAgICAgICAgaysrO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICAvLyBjb25zb2xlLmxvZygnc3BhbnMnLCBzcGFucy5sZW5ndGgsIGspO1xuICBpZihzcGFucy5sZW5ndGggPiBrKSB7XG4gICAgc3BhbnMuc3BsaWNlKGspO1xuICB9XG4gIHJldHVybiBzcGFucztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRhdGFNZXJnZVBhcmFncmFwaHMocGFyYWdyYXBocywgc291cmNlUGFyYWdyYXBocykge1xuICBsZXQgc291cmNlUGFyYWdyYXBoO1xuICBsZXQgayA9IDA7XG4gIGZvcihjb25zdCBzb3VyY2VQYXJhZ3JhcGggb2Ygc291cmNlUGFyYWdyYXBocykge1xuICAgIGlmKGsgPCBwYXJhZ3JhcGhzLmxlbmd0aCAmJiBwYXJhZ3JhcGhzW2tdLmlkID09PSBzb3VyY2VQYXJhZ3JhcGguaWQpIHtcbiAgICAgIC8vIGNvbnNvbGUubG9nKCdtZXJnaW5nIHNwYW5zJywgcGFyYWdyYXBoU3BhbnMocGFyYWdyYXBoc1trXSksIHBhcmFncmFwaFNwYW5zKHNvdXJjZVBhcmFncmFwaCkpXG4gICAgICAgIGRhdGFNZXJnZVNwYW5zKHBhcmFncmFwaFNwYW5zKHBhcmFncmFwaHNba10pLCBwYXJhZ3JhcGhTcGFucyhzb3VyY2VQYXJhZ3JhcGgpKTtcbiAgICAgICAgaysrO1xuICAgIH0gZWxzZSB7XG4gICAgICBsZXQgZm91bmQgPSBmYWxzZTtcbiAgICAgIGZvcihsZXQgaj1rOyBqPHBhcmFncmFwaHMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgaWYocGFyYWdyYXBoc1tqXS5pZCA9PT0gc291cmNlUGFyYWdyYXBoLmlkKSB7XG4gICAgICAgICAgcGFyYWdyYXBocy5zcGxpY2Uoaywgai1rKTtcbiAgICAgICAgICBwYXJhZ3JhcGhzW2tdLnRleHQgPSBzb3VyY2VQYXJhZ3JhcGgudGV4dDtcbiAgICAgICAgICBrKys7XG4gICAgICAgICAgZm91bmQgPSB0cnVlO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZighZm91bmQpIHtcbiAgICAgICAgcGFyYWdyYXBocy5zcGxpY2UoaywgMCwgc291cmNlUGFyYWdyYXBoKTtcbiAgICAgICAgaysrO1xuICAgICAgfVxuICAgICAgLy8gcGFyYWdyYXBocy5zcGxpY2UoaywgMCwgc291cmNlUGFyYWdyYXBoKTtcbiAgICAgIC8vIGsrKztcbiAgICB9XG4gIH1cbiAgLy8gY29uc29sZS5sb2coJ3BhcmFncmFwaHMnLCBwYXJhZ3JhcGhzLmxlbmd0aCwgayk7XG4gIGlmKHBhcmFncmFwaHMubGVuZ3RoID4gaykge1xuICAgIHBhcmFncmFwaHMuc3BsaWNlKGspO1xuICB9XG5cbiAgcmV0dXJuIHBhcmFncmFwaHM7XG59XG5cblxuZXhwb3J0IGZ1bmN0aW9uIGRhdGFTZWxlY3Rpb25Ub09mZnNldHMoZGF0YSwgc2VsZWN0aW9uKSB7XG4gIC8vIGdldCBsZWZ0IGFuZCByaWdodCBzcGFuL3BhcmFncmFwaFxuICAvLyBpZihzZWxlY3Rpb24ucGFyYWdyYXBoSUQgJiYgc2VsZWN0aW9uLnBhcmFncmFwaEluZGV4ID09PSB1bmRlZmluZWQgfHwgKHNlbGVjdGlvbi5zcGFuSUQgJiYgc2VsZWN0aW9uLnNwYW5JbmRleCA9PT0gdW5kZWZpbmVkKSkge1xuICAvLyAgIHNlbGVjdGlvblxuICAvLyB9XG4gIGRhdGFQb2ludGVyKGRhdGEsIHNlbGVjdGlvbi5zdGFydCk7XG4gIGRhdGFQb2ludGVyKGRhdGEsIHNlbGVjdGlvbi5lbmQpO1xuICBzZWxlY3Rpb24uc3RhcnQub2Zmc2V0TGVmdCA9IHNlbGVjdGlvbi5zdGFydC5vZmZzZXQ7XG4gIGlmKHNlbGVjdGlvbi5zdGFydC5zcGFuSW5kZXggPT09IDApIHtcbiAgICAvLyBzZWxlY3Rpb24uc3RhcnQub2Zmc2V0RnJvbVBhcmFncmFwaExlZnQgPSBzZWxlY3Rpb24uc3RhcnQub2Zmc2V0O1xuICB9IGVsc2UgaWYoc2VsZWN0aW9uLnN0YXJ0LnNwYW5JbmRleCA+IDApIHtcbiAgICBzZWxlY3Rpb24uc3RhcnQubGVmdFNwYW5JbmRleCA9IHNlbGVjdGlvbi5zdGFydC5zcGFuSW5kZXggLSAxO1xuICAgIHNlbGVjdGlvbi5zdGFydC5sZWZ0U3BhbklEID0gcGFyYWdyYXBoU3BhbnMoc2VsZWN0aW9uLnN0YXJ0LnBhcmFncmFwaClbc2VsZWN0aW9uLnN0YXJ0LnNwYW5JbmRleCAtIDFdLmlkO1xuICAgIC8vIHNlbGVjdGlvbi5zdGFydC5vZmZzZXRGcm9tTGVmdFNwYW4gPSBzZWxlY3Rpb24uc3RhcnQub2Zmc2V0O1xuICB9XG4gIHNlbGVjdGlvbi5lbmQub2Zmc2V0UmlnaHQgPSBzZWxlY3Rpb24uZW5kLnNwYW4udGV4dC5sZW5ndGggLSBzZWxlY3Rpb24uZW5kLm9mZnNldDtcbiAgaWYoc2VsZWN0aW9uLmVuZC5zcGFuSW5kZXggPj0gcGFyYWdyYXBoU3BhbnMoc2VsZWN0aW9uLmVuZC5wYXJhZ3JhcGgpLmxlbmd0aCkge1xuICAgIC8vIHNlbGVjdGlvbi5zdGFydC5vZmZzZXRGcm9tUGFyYWdyYXBoUmlnaHQgPSBzZWxlY3Rpb24uZW5kLnNwYW4udGV4dC5sZW5ndGggLSBzZWxlY3Rpb24uZW5kLm9mZnNldDtcbiAgfSBlbHNlIGlmKHNlbGVjdGlvbi5lbmQuc3BhbkluZGV4IDwgcGFyYWdyYXBoU3BhbnMoc2VsZWN0aW9uLmVuZC5wYXJhZ3JhcGgpLmxlbmd0aCAtIDEpIHtcbiAgICBzZWxlY3Rpb24uZW5kLnJpZ2h0U3BhbkluZGV4ID0gc2VsZWN0aW9uLmVuZC5zcGFuSW5kZXggKyAxO1xuICAgIHNlbGVjdGlvbi5lbmQucmlnaHRTcGFuSUQgPSBwYXJhZ3JhcGhTcGFucyhzZWxlY3Rpb24uZW5kLnBhcmFncmFwaClbc2VsZWN0aW9uLmVuZC5zcGFuSW5kZXggKyAxXS5pZDtcbiAgICAvLyBzZWxlY3Rpb24uZW5kLm9mZnNldEZyb21SaWdodFNwYW4gPSBzZWxlY3Rpb24uZW5kLnNwYW4udGV4dC5sZW5ndGggLSBzZWxlY3Rpb24uZW5kLm9mZnNldDtcbiAgfVxuXG4gIHJldHVybiBzZWxlY3Rpb247XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkYXRhU2VsZWN0aW9uUmVzdG9yZUZyb21PZmZzZXRzKGRhdGEsIHNlbGVjdGlvbikge1xuICBpZihzZWxlY3Rpb24uc3RhcnQub2Zmc2V0TGVmdCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgbGV0IG9mZnNldCA9IDA7XG4gICAgY29uc3Qgc3BhbnMgPSBwYXJhZ3JhcGhTcGFucyhzZWxlY3Rpb24uc3RhcnQucGFyYWdyYXBoKTtcbiAgICBmb3IobGV0IGk9c2VsZWN0aW9uLnN0YXJ0LmxlZnRTcGFuSW5kZXggPT09IHVuZGVmaW5lZCA/IDAgOiBzZWxlY3Rpb24uc3RhcnQubGVmdFNwYW5JbmRleCsxOyBpPHNwYW5zLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBzcGFuID0gc3BhbnNbaV07XG4gICAgICBpZihzZWxlY3Rpb24uc3RhcnQub2Zmc2V0TGVmdCA+PSBvZmZzZXQgJiYgc2VsZWN0aW9uLnN0YXJ0Lm9mZnNldExlZnQgPD0gb2Zmc2V0ICsgc3Bhbi50ZXh0Lmxlbmd0aCkge1xuICAgICAgICBzZWxlY3Rpb24uc3RhcnQuc3BhbkluZGV4ID0gaTtcbiAgICAgICAgc2VsZWN0aW9uLnN0YXJ0LnNwYW4gPSBzcGFuO1xuICAgICAgICBzZWxlY3Rpb24uc3RhcnQuc3BhbklEID0gc3Bhbi5pZDtcbiAgICAgICAgc2VsZWN0aW9uLnN0YXJ0Lm9mZnNldCA9IHNlbGVjdGlvbi5zdGFydC5vZmZzZXRMZWZ0IC0gb2Zmc2V0O1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIG9mZnNldCArPSBzcGFuLnRleHQubGVuZ3RoO1xuICAgIH1cbiAgfVxuICBpZihzZWxlY3Rpb24uZW5kLm9mZnNldFJpZ2h0ICE9PSB1bmRlZmluZWQpIHtcbiAgICBsZXQgb2Zmc2V0ID0gMDtcbiAgICBjb25zdCBzcGFucyA9IHBhcmFncmFwaFNwYW5zKHNlbGVjdGlvbi5lbmQucGFyYWdyYXBoKTtcbiAgICBpZihzZWxlY3Rpb24uZW5kLnJpZ2h0U3BhbklEICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGZvcihsZXQgaT1zZWxlY3Rpb24uc3RhcnQubGVmdFNwYW5JbmRleDsgaSA8IHNwYW5zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IHNwYW4gPSBzcGFuc1tpXTtcbiAgICAgICAgaWYoc3Bhbi5pZCA9PT0gc2VsZWN0aW9uLmVuZC5yaWdodFNwYW5JRCkge1xuICAgICAgICAgIHNlbGVjdGlvbi5lbmQucmlnaHRTcGFuSW5kZXggPSBpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGZvcihsZXQgaT1zZWxlY3Rpb24uZW5kLnJpZ2h0U3BhbkluZGV4ID09PSB1bmRlZmluZWQgPyBzcGFucy5sZW5ndGgtMSA6IHNlbGVjdGlvbi5lbmQucmlnaHRTcGFuSW5kZXgtMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgIGNvbnN0IHNwYW4gPSBzcGFuc1tpXTtcbiAgICAgIGlmKHNlbGVjdGlvbi5lbmQub2Zmc2V0UmlnaHQgPj0gb2Zmc2V0ICYmIHNlbGVjdGlvbi5lbmQub2Zmc2V0UmlnaHQgPD0gb2Zmc2V0ICsgc3Bhbi50ZXh0Lmxlbmd0aCkge1xuICAgICAgICBzZWxlY3Rpb24uZW5kLnNwYW5JbmRleCA9IGk7XG4gICAgICAgIHNlbGVjdGlvbi5lbmQuc3BhbiA9IHNwYW47XG4gICAgICAgIHNlbGVjdGlvbi5lbmQuc3BhbklEID0gc3Bhbi5pZDtcbiAgICAgICAgc2VsZWN0aW9uLmVuZC5vZmZzZXQgPSBzcGFuLnRleHQubGVuZ3RoIC0gKHNlbGVjdGlvbi5lbmQub2Zmc2V0UmlnaHQgLSBvZmZzZXQpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIG9mZnNldCArPSBzcGFuLnRleHQubGVuZ3RoO1xuICAgIH1cbiAgfVxuICBkZWxldGUgc2VsZWN0aW9uLnN0YXJ0Lm9mZnNldExlZnQ7XG4gIGRlbGV0ZSBzZWxlY3Rpb24uc3RhcnQubGVmdFNwYW5JbmRleDtcbiAgZGVsZXRlIHNlbGVjdGlvbi5zdGFydC5sZWZ0U3BhbklEO1xuICBkZWxldGUgc2VsZWN0aW9uLmVuZC5vZmZzZXRSaWdodDtcbiAgZGVsZXRlIHNlbGVjdGlvbi5lbmQucmlnaHRTcGFuSW5kZXg7XG4gIGRlbGV0ZSBzZWxlY3Rpb24uZW5kLnJpZ2h0U3BhbklEO1xuICByZXR1cm4gc2VsZWN0aW9uO1xufVxuXG5cblxuXG5mdW5jdGlvbiogcGFyYWdyYXBoU3Bhbkl0ZXJhdG9yKHNwYW5zLCBzdGFydElELCBlbmRJRCkge1xuICBsZXQgc3RhcnRlZCA9IHN0YXJ0SUQgPT09IHVuZGVmaW5lZDtcbiAgZm9yKGNvbnN0IHNwYW4gb2Ygc3BhbnMpIHtcbiAgICBpZighc3RhcnRlZCAmJiBzcGFuLmlkID09PSBzdGFydElEKSB7XG4gICAgICBzdGFydGVkID0gdHJ1ZTtcbiAgICB9XG4gICAgaWYoIXN0YXJ0ZWQpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICB5aWVsZCBzcGFuO1xuICAgIGlmKGVuZElEICE9PSB1bmRlZmluZWQgJiYgc3Bhbi5pZCA9PT0gZW5kSUQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uKiBkYXRhU3Bhbkl0ZXJhdG9yKGRhdGEsIHN0YXJ0LCBlbmQpIHtcbiAgY29uc3QgcGFyYWdyYXBocyA9IGRhdGE7XG4gIGxldCBzdGFydGVkID0gZmFsc2U7XG4gIGZvcihjb25zdCBwYXJhZ3JhcGggb2YgcGFyYWdyYXBocykge1xuICAgIGlmKCFzdGFydCkge1xuICAgICAgc3RhcnRlZCA9IHRydWU7XG4gICAgfVxuICAgIGlmKHN0YXJ0ICYmIHBhcmFncmFwaC5pZCA9PT0gc3RhcnQucGFyYWdyYXBoSUQgJiYgZW5kICYmIHBhcmFncmFwaC5pZCA9PT0gZW5kLnBhcmFncmFwaElEKSB7XG4gICAgICB5aWVsZCogcGFyYWdyYXBoU3Bhbkl0ZXJhdG9yKHBhcmFncmFwaC5zcGFucywgc3RhcnQuc3BhbklELCBlbmQuc3BhbklEKTtcbiAgICAgIHJldHVybjtcbiAgICB9IGVsc2UgaWYoc3RhcnQgJiYgcGFyYWdyYXBoLmlkID09PSBzdGFydC5wYXJhZ3JhcGhJRCkge1xuICAgICAgc3RhcnRlZCA9IHRydWU7XG4gICAgICB5aWVsZCogcGFyYWdyYXBoU3Bhbkl0ZXJhdG9yKHBhcmFncmFwaC5zcGFucywgc3RhcnQuc3BhbklEKTtcbiAgICB9IGVsc2UgaWYoZW5kICYmIHBhcmFncmFwaC5pZCA9PT0gZW5kLnBhcmFncmFwaElEKSB7XG4gICAgICBpZihzdGFydGVkKSB7XG4gICAgICAgIHlpZWxkKiBwYXJhZ3JhcGhTcGFuSXRlcmF0b3IocGFyYWdyYXBoLnNwYW5zLCB1bmRlZmluZWQsIGVuZC5zcGFuSUQpO1xuICAgICAgfVxuICAgICAgcmV0dXJuO1xuICAgIH0gZWxzZSBpZihzdGFydGVkKSB7XG4gICAgICB5aWVsZCogcGFyYWdyYXBoLnNwYW5zO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24qIGRhdGFJdGVyYXRvcihkYXRhLCBzdGFydCwgZW5kKSB7XG4gIGNvbnN0IHBhcmFncmFwaHMgPSBkYXRhO1xuICBsZXQgc3RhcnRlZCA9IGZhbHNlO1xuICBmb3IoY29uc3QgcGFyYWdyYXBoIG9mIHBhcmFncmFwaHMpIHtcbiAgICBpZighc3RhcnQpIHtcbiAgICAgIHN0YXJ0ZWQgPSB0cnVlO1xuICAgIH1cbiAgICBpZihzdGFydCAmJiBwYXJhZ3JhcGguaWQgPT09IHN0YXJ0LnBhcmFncmFwaElEICYmIGVuZCAmJiBwYXJhZ3JhcGguaWQgPT09IGVuZC5wYXJhZ3JhcGhJRCkge1xuICAgICAgLy8geWllbGQqIHBhcmFncmFwaFNwYW5JdGVyYXRvcihwYXJhZ3JhcGguc3BhbnMsIHN0YXJ0LnNwYW5JRCwgZW5kLnNwYW5JRCk7XG4gICAgICB5aWVsZCB7IHBhcmFncmFwaCwgc3BhbnM6IEFycmF5LmZyb20ocGFyYWdyYXBoU3Bhbkl0ZXJhdG9yKHBhcmFncmFwaC5zcGFucywgc3RhcnQuc3BhbklELCBlbmQuc3BhbklEKSkgfTtcbiAgICAgIHJldHVybjtcbiAgICB9IGVsc2UgaWYoc3RhcnQgJiYgcGFyYWdyYXBoLmlkID09PSBzdGFydC5wYXJhZ3JhcGhJRCkge1xuICAgICAgc3RhcnRlZCA9IHRydWU7XG4gICAgICAvLyB5aWVsZCogcGFyYWdyYXBoU3Bhbkl0ZXJhdG9yKHBhcmFncmFwaC5zcGFucywgc3RhcnQuc3BhbklEKTtcbiAgICAgIHlpZWxkIHsgcGFyYWdyYXBoLCBzcGFuczogQXJyYXkuZnJvbShwYXJhZ3JhcGhTcGFuSXRlcmF0b3IocGFyYWdyYXBoLnNwYW5zLCBzdGFydC5zcGFuSUQpKSB9O1xuICAgIH0gZWxzZSBpZihlbmQgJiYgcGFyYWdyYXBoLmlkID09PSBlbmQucGFyYWdyYXBoSUQpIHtcbiAgICAgIGlmKHN0YXJ0ZWQpIHtcbiAgICAgICAgLy8geWllbGQqIHBhcmFncmFwaFNwYW5JdGVyYXRvcihwYXJhZ3JhcGguc3BhbnMsIHVuZGVmaW5lZCwgZW5kLnNwYW5JRCk7XG4gICAgICAgIHlpZWxkIHsgcGFyYWdyYXBoLCBzcGFuczogQXJyYXkuZnJvbShwYXJhZ3JhcGhTcGFuSXRlcmF0b3IocGFyYWdyYXBoLnNwYW5zLCB1bmRlZmluZWQsIGVuZC5zcGFuSUQpKSB9O1xuICAgICAgfVxuICAgICAgcmV0dXJuO1xuICAgIH0gZWxzZSBpZihzdGFydGVkKSB7XG4gICAgICAvLyB5aWVsZCogcGFyYWdyYXBoLnNwYW5zO1xuICAgICAgeWllbGQgeyBwYXJhZ3JhcGgsIHNwYW5zOiBBcnJheS5mcm9tKHBhcmFncmFwaC5zcGFucykgfTtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG5leHQoZGF0YSwgcG9pbnRlcikge1xuICBjb25zdCBwYXJhZ3JhcGhzID0gZGF0YTtcbiAgbGV0IHsgcGFyYWdyYXBoSW5kZXgsIHNwYW5JbmRleCwgcGFyYWdyYXBoIH0gPSBpZFRvSW5kZXgoZGF0YSwgcG9pbnRlci5wYXJhZ3JhcGhJRCwgcG9pbnRlci5zcGFuSUQpO1xuICBpZihzcGFuSW5kZXggPCBwYXJhZ3JhcGguc3BhbnMubGVuZ3RoIC0gMSkge1xuICAgIHNwYW5JbmRleCArPSAxO1xuICAgIHJldHVybiBPYmplY3QuYXNzaWduKHsgcGFyYWdyYXBoSUQ6IHBhcmFncmFwaC5pZCwgc3BhbklEOiBwYXJhZ3JhcGguc3BhbnNbc3BhbkluZGV4XS5pZCB9LCBpZFRvSW5kZXgoZGF0YSwgcGFyYWdyYXBoLmlkLCBwYXJhZ3JhcGguc3BhbnNbc3BhbkluZGV4XSkpO1xuICB9IGVsc2UgaWYocGFyYWdyYXBoSW5kZXggPCBwYXJhZ3JhcGhzLmxlbmd0aC0xKSB7XG4gICAgcGFyYWdyYXBoSW5kZXggKz0gMTtcbiAgICBzcGFuSW5kZXggPSAwO1xuICAgIGZvcig7IHBhcmFncmFwaEluZGV4IDwgcGFyYWdyYXBocy5sZW5ndGg7IHBhcmFncmFwaEluZGV4KyspIHtcbiAgICAgIHBhcmFncmFwaCA9IHBhcmFncmFwaHNbcGFyYWdyYXBoSW5kZXhdO1xuICAgICAgaWYocGFyYWdyYXBoLnNwYW5zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICAgIGlmKHBhcmFncmFwaC5zcGFucy5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgcmV0dXJuIHBvaW50ZXJSZXNvbHZlKGRhdGEsIE9iamVjdC5hc3NpZ24oeyBwYXJhZ3JhcGhJRDogcGFyYWdyYXBoLmlkLCBzcGFuSUQ6IHBhcmFncmFwaC5zcGFuc1tzcGFuSW5kZXhdLmlkIH0sIGlkVG9JbmRleChkYXRhLCBwYXJhZ3JhcGguaWQsIHBhcmFncmFwaC5zcGFuc1tzcGFuSW5kZXhdKSkpO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwcmV2KGRhdGEsIHBvaW50ZXIpIHtcbiAgY29uc3QgcGFyYWdyYXBocyA9IGRhdGE7XG4gIGxldCB7IHBhcmFncmFwaEluZGV4LCBzcGFuSW5kZXgsIHBhcmFncmFwaCB9ID0gaWRUb0luZGV4KGRhdGEsIHBvaW50ZXIucGFyYWdyYXBoSUQsIHBvaW50ZXIuc3BhbklEKTtcbiAgaWYoc3BhbkluZGV4ID4gMCkge1xuICAgIHNwYW5JbmRleCAtPSAxO1xuICAgIHJldHVybiBPYmplY3QuYXNzaWduKHsgcGFyYWdyYXBoSUQ6IHBhcmFncmFwaC5pZCwgc3BhbklEOiBwYXJhZ3JhcGguc3BhbnNbc3BhbkluZGV4XS5pZCB9LCBpZFRvSW5kZXgoZGF0YSwgcGFyYWdyYXBoLmlkLCBwYXJhZ3JhcGguc3BhbnNbc3BhbkluZGV4XSkpO1xuICB9IGVsc2UgaWYocGFyYWdyYXBoSW5kZXggPiAwKSB7XG4gICAgcGFyYWdyYXBoSW5kZXggLT0gMTtcbiAgICBzcGFuSW5kZXggPSAwO1xuICAgIGZvcig7IHBhcmFncmFwaEluZGV4ID49IDA7IHBhcmFncmFwaEluZGV4LS0pIHtcbiAgICAgIHBhcmFncmFwaCA9IHBhcmFncmFwaHNbcGFyYWdyYXBoSW5kZXhdO1xuICAgICAgaWYocGFyYWdyYXBoLnNwYW5zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgc3BhbkluZGV4ID0gcGFyYWdyYXBoLnNwYW5zLmxlbmd0aC0xO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gICAgaWYocGFyYWdyYXBoLnNwYW5zLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICByZXR1cm4gcG9pbnRlclJlc29sdmUoZGF0YSwgT2JqZWN0LmFzc2lnbih7IHBhcmFncmFwaElEOiBwYXJhZ3JhcGguaWQsIHNwYW5JRDogcGFyYWdyYXBoLnNwYW5zW3NwYW5JbmRleF0uaWQgfSwgaWRUb0luZGV4KGRhdGEsIHBhcmFncmFwaC5pZCwgcGFyYWdyYXBoLnNwYW5zW3NwYW5JbmRleF0pKSk7XG4gIH1cbn1cbiIsIjx0ZW1wbGF0ZT5cbiAgPGRpdiBzdHlsZT1cImJvcmRlcjogMXB4IHNvbGlkICNjY2NcIiA6Y29udGVudGVkaXRhYmxlPVwiZWRpdGFibGVcIiBzcGVsbGNoZWNrPVwiZmFsc2VcIiA6a2V5PVwia2V5XCJcbiAgICBAaW5wdXQ9XCJvbklucHV0XCIgQGtleWRvd249XCJvbktleWRvd25cIiBAcGFzdGU9XCJvblBhc3RlXCIgQGN1dD1cIm9uQ3V0XCIgQGNvcHk9XCJvbkNvcHlcIlxuICAgIEBzZWxlY3RzdGFydD1cInNlbGVjdFN0YXJ0XCIgQG1vdXNldXA9XCJzZWxlY3RFbmRcIiBAZHJhZ3N0YXJ0PVwib25EcmFnU3RhcnRcIlxuICAgIHJlZj1cImNvbnRhaW5lclwiIGNsYXNzPVwidHJhbnNjcmlwdFwiPlxuICAgIDxkaXYgdi1mb3I9XCIocGFyYWdyYXBoLCBpbmRleCkgaW4gcGFyYWdyYXBoc1wiIDpkYXRhLWlkPVwicGFyYWdyYXBoLmlkXCIgOmtleT1cInBhcmFncmFwaC5pZFwiIDpjb250ZW50ZWRpdGFibGU9XCJlZGl0YWJsZVwiXG4gICAgICA6Y2xhc3M9XCJ7ICdsaXN0LWl0ZW0nOiBwYXJhZ3JhcGguYnVsbGV0IH1cIiBjbGFzcz1cInBhcmFncmFwaFwiPlxuICAgICAgPHNwYW4gdi1mb3I9XCIoc3BhbiwgaW5kZXgpIGluIHBhcmFncmFwaC5zcGFuc1wiIDprZXk9XCJzcGFuLmlkXCIgOmRhdGEtZmlyc3Q9XCJpbmRleCA9PSAwXCIgOmRhdGEtbGFzdD1cImluZGV4ID49IHBhcmFncmFwaC5zcGFucy5sZW5ndGgtMVwiIDpjb250ZW50ZWRpdGFibGU9XCJlZGl0YWJsZVwiXG4gICAgICAgICAgICA6ZGF0YS1pZD1cInNwYW4uaWRcIiA6ZGF0YS10aW1lPVwic3Bhbi50aW1lXCIgOmRhdGEtZHVyYXRpb249XCJzcGFuLmR1cmF0aW9uXCIgOmRhdGEtY29uZmlkZW5jZT1cInNwYW4uY29uZmlkZW5jZVwiIGNsYXNzPVwic3BhbiB0b2tlblwiXG4gICAgICAgICAgICA6Y2xhc3M9XCJ7XG4gICAgICAgICAgICAgIHNlbGVjdGVkOiBzcGFuLnRpbWUgPD0gdGltZSAmJiB0aW1lIDwgc3Bhbi50aW1lICsgc3Bhbi5kdXJhdGlvbixcbiAgICAgICAgICAgICAgcGFzdDogc3Bhbi50aW1lICsgc3Bhbi5kdXJhdGlvbiA8PSB0aW1lLCBoaWdobGlnaHRlZDogc3Bhbi5oaWdobGlnaHRlZCxcbiAgICAgICAgICAgICAgYm9sZDogc3Bhbi5mb3JtYXQgJiYgc3Bhbi5mb3JtYXQuYm9sZCwgaXRhbGljOiBzcGFuLmZvcm1hdCAmJiBzcGFuLmZvcm1hdC5pdGFsaWMsIHVuZGVybGluZTogc3Bhbi5mb3JtYXQgJiYgc3Bhbi5mb3JtYXQudW5kZXJsaW5lLFxuICAgICAgICAgICAgICBzdXBlcnNjcmlwdDogc3Bhbi5mb3JtYXQgJiYgc3Bhbi5mb3JtYXQuc3VwZXJzY3JpcHQsIHN1YnNjcmlwdDogc3Bhbi5mb3JtYXQgJiYgc3Bhbi5mb3JtYXQuc3Vic2NyaXB0LFxuICAgICAgICAgICAgfVwiXG4gICAgICAgICAgICBAY2xpY2s9XCJzcGFuU2VsZWN0ZWQoc3BhbiwgJGV2ZW50KVwiXG4gICAgICAgICAgICA6c3R5bGU9XCJzaG93Q29uZmlkZW5jZSA/IGBvcGFjaXR5OiAke01hdGgucG93KHNwYW4uY29uZmlkZW5jZSwgMC41KSAvIDIgKyAuNX07YCA6ICcnXCJcbiAgICAgICAgICAgIDp0aXRsZT1cInNob3dDb25maWRlbmNlID8gYENvbmZpZGVuY2U6ICR7c3Bhbi5jb25maWRlbmNlfWAgOiAnJ1wiXG4gICAgICA+XG4gICAgICAgIHt7c3Bhbi50ZXh0fX1cbiAgICAgIDwvc3Bhbj5cbiAgICA8L2Rpdj5cbiAgPC9kaXY+XG48L3RlbXBsYXRlPlxuXG48c2NyaXB0PlxuXG4vLyBodHRwczovL2xldmVsdXAuZ2l0Y29ubmVjdGVkLmNvbS9kZWJvdW5jZS1pbi1qYXZhc2NyaXB0LWltcHJvdmUteW91ci1hcHBsaWNhdGlvbnMtcGVyZm9ybWFuY2UtNWIwMTg1NWUwODZcbi8vIGh0dHBzOi8vZGF2aWR3YWxzaC5uYW1lL2phdmFzY3JpcHQtZGVib3VuY2UtZnVuY3Rpb25cbi8vIFJldHVybnMgYSBmdW5jdGlvbiwgdGhhdCwgYXMgbG9uZyBhcyBpdCBjb250aW51ZXMgdG8gYmUgaW52b2tlZCwgd2lsbCBub3Rcbi8vIGJlIHRyaWdnZXJlZC4gVGhlIGZ1bmN0aW9uIHdpbGwgYmUgY2FsbGVkIGFmdGVyIGl0IHN0b3BzIGJlaW5nIGNhbGxlZCBmb3Jcbi8vIE4gbWlsbGlzZWNvbmRzLiBJZiBgaW1tZWRpYXRlYCBpcyBwYXNzZWQsIHRyaWdnZXIgdGhlIGZ1bmN0aW9uIG9uIHRoZVxuLy8gbGVhZGluZyBlZGdlLCBpbnN0ZWFkIG9mIHRoZSB0cmFpbGluZy5cblxuLy8gY29uc3QgZGVib3VuY2UgPSAoZnVuYywgd2FpdCwgaW1tZWRpYXRlKSA9PiB7XG4vLyAgIGxldCB0aW1lb3V0O1xuLy9cbi8vICAgcmV0dXJuIGZ1bmN0aW9uIGV4ZWN1dGVkRnVuY3Rpb24oLi4uYXJncykge1xuLy8gICAgIGNvbnN0IGxhdGVyID0gKCkgPT4ge1xuLy8gICAgICAgdGltZW91dCA9IG51bGw7XG4vLyAgICAgICBpZighaW1tZWRpYXRlKSBmdW5jLmFwcGx5KHRoaXMsIGFyZ3MpO1xuLy8gICAgIH07XG4vLyAgICAgY29uc3QgY2FsbE5vdyA9IGltbWVkaWF0ZSAmJiAhdGltZW91dDtcbi8vICAgICBjbGVhclRpbWVvdXQodGltZW91dCk7XG4vLyAgICAgdGltZW91dCA9IHNldFRpbWVvdXQobGF0ZXIsIHdhaXQpO1xuLy8gICAgIGlmKGNhbGxOb3cpIGZ1bmMuYXBwbHkodGhpcywgYXJncyk7XG4vLyAgIH07XG4vLyB9O1xuXG5mdW5jdGlvbiBkZWJvdW5jZWQoZnVuYywgd2FpdCwgaW1tZWRpYXRlKSB7XG4gIGxldCB0aW1lb3V0O1xuXG4gIHJldHVybiB7XG5cbiAgICBub3coc2VsZiwgLi4uYXJncykge1xuICAgICAgdGltZW91dCA9IG51bGw7XG4gICAgICBpZighaW1tZWRpYXRlKSByZXR1cm4gZnVuYy5hcHBseShzZWxmLCBhcmdzKTtcbiAgICB9LFxuXG4gICAgZGVib3VuY2VkKHNlbGYsIC4uLmFyZ3MpIHtcbiAgICAgIGNvbnN0IGNhbGxOb3cgPSBpbW1lZGlhdGUgJiYgIXRpbWVvdXQ7XG4gICAgICBjbGVhclRpbWVvdXQodGltZW91dCk7XG4gICAgICB0aW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7IHRoaXMubm93KHNlbGYsIC4uLmFyZ3MpOyB9LCB3YWl0KTtcbiAgICAgIGlmKGNhbGxOb3cpIGZ1bmMuYXBwbHkoc2VsZiwgYXJncyk7XG4gICAgfSxcbiAgfTtcbn1cblxuY29uc3QgdG9KU09OID0gKG9iaikgPT4gSlNPTi5zdHJpbmdpZnkob2JqLCB1bmRlZmluZWQsIDIpO1xuY29uc3QgZnJlZXplID0gKG9iaikgPT4gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShvYmopKTtcblxuaW1wb3J0IHtcbiAgcGFyc2VET00sXG4gIHBhcnNlVmFuaWxsYURPTSxcbiAgZGF0YU1lcmdlUGFyYWdyYXBocyxcbiAgbmV3UGFyYWdyYXBoLFxuICBkYXRhUG9pbnRlcixcbiAgZGF0YVNwbGljZSxcbiAgZGF0YUluc2VydCxcbiAgbm9ybWFsaXplZERPTVNlbGVjdGlvbixcbiAgcmVzdG9yZURPTVNlbGVjdGlvbixcbiAgZGF0YVBvaW50ZXJET01Ob2RlLFxuICBkYXRhUG9pbnRlclByZXYsXG4gIGRhdGFQb2ludGVyTmV4dCxcbiAgZGF0YUl0ZXJhdG9yLFxuICBTcGxpY2VNb2RlLFxuICBuZXdJRCxcbiAgZGF0YVBvaW50ZXJGcm9tRE9NUG9pbnRlcixcbiAgcG9pbnRlclRleHRPZmZzZXRJbkNvbnRhaW5lcixcbiAgZGF0YVNlbGVjdGlvblRvT2Zmc2V0cyxcbiAgZGF0YVNlbGVjdGlvblJlc3RvcmVGcm9tT2Zmc2V0cyxcbn0gZnJvbSAnLi9lZGl0b3IuanMnO1xuXG5leHBvcnQgZGVmYXVsdCB7XG5cbiAgcHJvcHM6IHtcbiAgICBtb2RlbFZhbHVlOiBPYmplY3QsXG4gICAgdGltZTogTnVtYmVyLFxuICAgIGVkaXRhYmxlOiB7dHlwZTogQm9vbGVhbiwgZGVmYXVsdDogdHJ1ZX0sXG4gICAgc2hvd0NvbmZpZGVuY2U6IHt0eXBlOiBCb29sZWFuLCBkZWZhdWx0OiBmYWxzZX0sXG4gIH0sXG5cbiAgZGF0YSgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgcGFyYWdyYXBoczogW10sXG4gICAgICBrZXk6IDEsXG4gICAgfTtcbiAgfSxcblxuICBtb3VudGVkKCkge1xuICAgIC8vIDUwMCBtYXkgYmUgdG9vIHNsb3cgLSB1c2VyIGNhbiB1cGRhdGUgdGV4dCBhbmQgcHJlc3Mgc29tZSBob3RrZXkgYmVmb3JlIHZlcnNpb24gY2hhbmdlIGhhcyBiZWVuIHJlZ2lzdGVyZWRcbiAgICBjb25zdCBkZCA9IGRlYm91bmNlZCh0aGlzLmFwcGx5Vmlld0NoYW5nZXNOb3csIDIwMCk7XG4gICAgdGhpcy5hcHBseVZpZXdDaGFuZ2VzTm93ID0gKC4uLmFyZ3MpID0+IGRkLm5vdyh0aGlzLCAuLi5hcmdzKTtcbiAgICB0aGlzLmFwcGx5Vmlld0NoYW5nZXMgPSAoLi4uYXJncykgPT4gZGQuZGVib3VuY2VkKHRoaXMsIC4uLmFyZ3MpO1xuICAgIC8vIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3NlbGVjdGlvbmNoYW5nZScsICgpID0+IHtcbiAgICAvLyAgIGNvbnNvbGUuZGVidWcoZG9jdW1lbnQuZ2V0U2VsZWN0aW9uKCkpO1xuICAgIC8vIH0pO1xuICAgIHRoaXMuJG9wdGlvbnMud2F0Y2gubW9kZWxWYWx1ZS5jYWxsKHRoaXMsIHRoaXMubW9kZWxWYWx1ZSk7XG4gIH0sXG5cbiAgd2F0Y2g6IHtcbiAgICBtb2RlbFZhbHVlKHZhbHVlKSB7XG4gICAgICB0aGlzLnBhcmFncmFwaHMgPSB2YWx1ZS5wYXJhZ3JhcGhzIHx8IFtdO1xuICAgIH0sXG4gICAgLy8gdGltZSh2YWx1ZSkge1xuICAgIC8vICAgY29uc29sZS5kZWJ1ZygndGltZSB1cGRhdGVkIHRvJywgdGhpcy50aW1lKTtcbiAgICAvLyB9LFxuICB9LFxuXG4gIG1ldGhvZHM6IHtcblxuICAgIHJlc2V0KCkge1xuICAgICAgY29uc29sZS5kZWJ1ZygncmVzZXR0aW5nJyk7XG4gICAgICB0aGlzLmtleSArPSAxO1xuICAgIH0sXG5cbiAgICBzYXZlKCkge1xuICAgICAgLy8gY29uc29sZS5kZWJ1ZygndXBkYXRpbmcgc291cmNlJylcbiAgICAgIHRoaXMuJGVtaXQoJ3VwZGF0ZTptb2RlbFZhbHVlJywgT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5tb2RlbFZhbHVlLCB7IHBhcmFncmFwaHM6IHRoaXMucGFyYWdyYXBocyB9KSk7XG4gICAgfSxcblxuICAgIGRvd25sb2FkKGZpbGVuYW1lLCB0ZXh0LCB0eXBlID0gJ3RleHQvcGxhaW4nKSB7XG4gICAgICAvLyBodHRwczovL291cmNvZGV3b3JsZC5jb20vYXJ0aWNsZXMvcmVhZC8xODkvaG93LXRvLWNyZWF0ZS1hLWZpbGUtYW5kLWdlbmVyYXRlLWEtZG93bmxvYWQtd2l0aC1qYXZhc2NyaXB0LWluLXRoZS1icm93c2VyLXdpdGhvdXQtYS1zZXJ2ZXJcbiAgICAgIGxldCBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xuICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCBgZGF0YToke3R5cGV9O2NoYXJzZXQ9dXRmLTgsYCArIGVuY29kZVVSSUNvbXBvbmVudCh0ZXh0KSk7XG4gICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZSgnZG93bmxvYWQnLCBmaWxlbmFtZSk7XG4gICAgICBlbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGVsZW1lbnQpO1xuICAgICAgZWxlbWVudC5jbGljaygpO1xuICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChlbGVtZW50KTtcbiAgICB9LFxuXG4gICAgYXNIVE1MKHNvdXJjZSkge1xuICAgICAgaWYoIXNvdXJjZSkge1xuICAgICAgICBzb3VyY2UgPSB0aGlzLnBhcmFncmFwaHM7XG4gICAgICB9XG4gICAgICBjb25zdCBwYXJhZ3JhcGhzID0gW107XG4gICAgICBmb3IoY29uc3QgcGFyYWdyYXBoIG9mIHNvdXJjZSkge1xuICAgICAgICBsZXQgc2VudGVuY2UgPSBbXTtcbiAgICAgICAgZm9yKGNvbnN0IHNwYW4gb2YgcGFyYWdyYXBoLnNwYW5zKSB7XG4gICAgICAgICAgbGV0IHRhZyA9ICdzcGFuJztcbiAgICAgICAgICBpZihzcGFuLmZvcm1hdCkge1xuICAgICAgICAgICAgaWYoc3Bhbi5mb3JtYXQuYm9sZCkge1xuICAgICAgICAgICAgICB0YWcgPSAnc3Ryb25nJztcbiAgICAgICAgICAgIH0gZWxzZSBpZihzcGFuLmZvcm1hdC5pdGFsaWMpIHtcbiAgICAgICAgICAgICAgdGFnID0gJ2VtJztcbiAgICAgICAgICAgIH0gZWxzZSBpZihzcGFuLmZvcm1hdC51bmRlcmxpbmUpIHtcbiAgICAgICAgICAgICAgdGFnID0gJ3UnO1xuICAgICAgICAgICAgfSBlbHNlIGlmKHNwYW4uZm9ybWF0LnN1YnNjcmlwdCkge1xuICAgICAgICAgICAgICB0YWcgPSAnc3ViJztcbiAgICAgICAgICAgIH0gZWxzZSBpZihzcGFuLmZvcm1hdC5zdXBlcnNjcmlwdCkge1xuICAgICAgICAgICAgICB0YWcgPSAnc3VwJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgc2VudGVuY2UucHVzaChgPCR7dGFnfT4ke3NwYW4udGV4dH08LyR7dGFnfT5gKTtcbiAgICAgICAgfVxuICAgICAgICBzZW50ZW5jZSA9IHNlbnRlbmNlLmpvaW4oJycpO1xuICAgICAgICBpZihwYXJhZ3JhcGguYnVsbGV0KSB7XG4gICAgICAgICAgcGFyYWdyYXBocy5wdXNoKGA8bGk+JHtzZW50ZW5jZX08L2xpPmApXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcGFyYWdyYXBocy5wdXNoKGA8cD4ke3NlbnRlbmNlfTwvcD5gKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gcGFyYWdyYXBocy5qb2luKCdcXG4nKTtcbiAgICB9LFxuXG4gICAgZXhwb3J0V29yZChuYW1lPSdkb2N1bWVudC5kb2MnKSB7XG5cbiAgICAgIGNvbnN0IHBhcmFncmFwaHMgPSB0aGlzLmFzSFRNTCgpO1xuXG4gICAgICBjb25zdCB0aXRsZSA9ICdSVVRBIGV4cG9ydGVkIGRvY3VtZW50JztcblxuICAgICAgY29uc3QgaHRtbCA9IGA8aHRtbCB4bWxuczpvPVwidXJuOnNjaGVtYXMtbWljcm9zb2Z0LWNvbTpvZmZpY2U6b2ZmaWNlXCIgeG1sbnM6dz1cInVybjpzY2hlbWFzLW1pY3Jvc29mdC1jb206b2ZmaWNlOndvcmRcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnL1RSL1JFQy1odG1sNDBcIj5cbiAgICAgIDxoZWFkPjxtZXRhIGNoYXJzZXQ9J3V0Zi04Jz48dGl0bGU+JHt0aXRsZX08L3RpdGxlPjwvaGVhZD5cbiAgICAgIDxib2R5PiR7cGFyYWdyYXBoc308L2JvZHk+XG4gICAgICA8L2h0bWw+YDtcblxuICAgICAgdGhpcy5kb3dubG9hZChuYW1lLCBodG1sLCAnYXBwbGljYXRpb24vdm5kLm1zLXdvcmQnKTtcbiAgICB9LFxuXG4gICAgc3BhblNlbGVjdGVkKHNwYW4sIGV2ZW50KSB7XG4gICAgICBpZihkb2N1bWVudC5nZXRTZWxlY3Rpb24oKS5pc0NvbGxhcHNlZCkge1xuICAgICAgICAvLyBjb25zb2xlLmRlYnVnKCdzcGFuIHNlbGVjdGVkJywgc3Bhbik7XG4gICAgICAgIHRoaXMuJGVtaXQoJ3VwZGF0ZTp0aW1lJywgc3Bhbi50aW1lKTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgc2VsZWN0U3RhcnQoZXZlbnQpIHtcbiAgICAgIC8vIGNvbnNvbGUuZGVidWcoJ3NlbGVjdCBzdGFydCcsIGV2ZW50KTtcbiAgICB9LFxuXG4gICAgc2VsZWN0RW5kKGV2ZW50KSB7XG4gICAgICBjb25zdCBkYXRhID0gdGhpcy5wYXJhZ3JhcGhzO1xuICAgICAgY29uc3Qgc2VsZWN0aW9uID0gbm9ybWFsaXplZERPTVNlbGVjdGlvbigpO1xuICAgICAgY29uc3Qgc3RhcnQgPSBzZWxlY3Rpb24uc3RhcnQ7XG4gICAgICBkYXRhUG9pbnRlcihkYXRhLCBzdGFydCk7XG4gICAgICBjb25zdCBlbmQgPSBzZWxlY3Rpb24uZW5kO1xuICAgICAgZGF0YVBvaW50ZXIoZGF0YSwgZW5kKTtcbiAgICAgIC8vIGNvbnNvbGUuZGVidWcoJ1NFTEVDVEVEJywgc3RhcnQsIGVuZCwgZGF0YSlcbiAgICAgIGlmKCFzZWxlY3Rpb24uY29sbGFwc2VkKSB7XG4gICAgICAgIGNvbnN0IHN0YXJ0ID0gc2VsZWN0aW9uLnN0YXJ0LnNwYW4udGltZTtcbiAgICAgICAgY29uc3QgZW5kID0gc2VsZWN0aW9uLmVuZC5zcGFuLnRpbWUgIT09IHVuZGVmaW5lZCA/IChzZWxlY3Rpb24uZW5kLnNwYW4udGltZSArIHNlbGVjdGlvbi5lbmQuc3Bhbi5kdXJhdGlvbiB8fCAwKSA6IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy4kZW1pdCgnc2VsZWN0ZWQnLCB7c3RhcnQsIGVuZH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy4kZW1pdCgnc2VsZWN0ZWQnKTtcbiAgICAgIH1cbiAgICAgIHJldHVybjtcbiAgICB9LFxuXG4gICAgZ2V0U3BhblNlbGVjdGlvbihzZWxlY3Rpb24pIHtcbiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLnBhcmFncmFwaHM7XG4gICAgICBzZWxlY3Rpb24gPSBub3JtYWxpemVkRE9NU2VsZWN0aW9uKHNlbGVjdGlvbik7XG4gICAgICBkYXRhUG9pbnRlcihkYXRhLCBzZWxlY3Rpb24uc3RhcnQpO1xuICAgICAgZGF0YVBvaW50ZXIoZGF0YSwgc2VsZWN0aW9uLmVuZCk7XG4gICAgICByZXR1cm4gQXJyYXkuZnJvbShkYXRhSXRlcmF0b3IodGhpcy5wYXJhZ3JhcGhzLCBzZWxlY3Rpb24uc3RhcnQsIHNlbGVjdGlvbi5lbmQpKTtcbiAgICB9LFxuXG4gICAgdG9nZ2xlU3R5bGVYKG5hbWUsIG5vZm9jdXMpIHtcbiAgICAgIGNvbnN0IHNlbGVjdGlvbiA9IG5vcm1hbGl6ZWRET01TZWxlY3Rpb24oKTtcbiAgICAgIGlmKCFzZWxlY3Rpb24uY29sbGFwc2VkKSB7XG4gICAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLnBhcmFncmFwaHM7XG4gICAgICAgIGRhdGFTZWxlY3Rpb25Ub09mZnNldHMoZGF0YSwgc2VsZWN0aW9uKTtcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ0JFRk9SRSBUT0dHTEUgQUZURVIgT0ZGU0VUUycsIGZyZWV6ZShzZWxlY3Rpb24pKVxuICAgICAgICB0aGlzLnRvZ2dsZVN0eWxlKG5hbWUsIHNlbGVjdGlvbik7XG4gICAgICAgIC8vIHJlc2V0IERPTSBub2RlcyBhcyB0aGV5IGFyZSBtb3N0IGxpa2VseSBnb25lIGFmdGVyIGRhdGEgbW9kaWZpY2F0aW9uc1xuICAgICAgICBzZWxlY3Rpb24uc3RhcnQubm9kZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgc2VsZWN0aW9uLmVuZC5ub2RlID0gdW5kZWZpbmVkO1xuICAgICAgICBkYXRhU2VsZWN0aW9uUmVzdG9yZUZyb21PZmZzZXRzKGRhdGEsIHNlbGVjdGlvbik7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCdBRlRFUiBUT0dHTEUgQUZURVIgUkVTVE9SRSBPRkZTRVRTJywgZnJlZXplKHNlbGVjdGlvbikpXG4gICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHtcbiAgICAgICAgICBpZighbm9mb2N1cykge1xuICAgICAgICAgICAgdGhpcy4kcmVmcy5jb250YWluZXIuZm9jdXMoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmVzdG9yZURPTVNlbGVjdGlvbih0aGlzLiRyZWZzLmNvbnRhaW5lciwgc2VsZWN0aW9uLnN0YXJ0LCBzZWxlY3Rpb24uZW5kKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSxcblxuICAgIHRvZ2dsZVN0eWxlKG5hbWUsIHNlbGVjdGlvbikge1xuXG4gICAgICBjb25zdCBkYXRhID0gdGhpcy5wYXJhZ3JhcGhzO1xuICAgICAgaWYoIXNlbGVjdGlvbikge1xuICAgICAgICBzZWxlY3Rpb24gPSBub3JtYWxpemVkRE9NU2VsZWN0aW9uKCk7XG4gICAgICB9XG4gICAgICBpZihzZWxlY3Rpb24uaXNDb2xsYXBzZWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgY29uc3Qgc3RhcnQgPSBzZWxlY3Rpb24uc3RhcnQ7XG4gICAgICBkYXRhUG9pbnRlcihkYXRhLCBzdGFydCk7XG4gICAgICBjb25zdCBlbmQgPSBzZWxlY3Rpb24uZW5kO1xuICAgICAgZGF0YVBvaW50ZXIoZGF0YSwgZW5kKTtcblxuICAgICAgY29uc3QgciA9IGRhdGFTcGxpY2UoZGF0YSwgc3RhcnQsIGVuZCwgU3BsaWNlTW9kZS5JblBsYWNlKTtcblxuICAgICAgLy8gZ2V0IGN1cnJlbnQgdmFsdWUgYWNyb3NzIHRoZSByYW5nZSwgcmV2ZXJ0IHRvIGZhbHNlIGlmIHRydWUgYXQgdGhlIHdob2xlIHJhbmdlXG4gICAgICBsZXQgdmFsdWUgPSB0cnVlO1xuICAgICAgZm9yKGNvbnN0IHAgb2Ygcikge1xuICAgICAgICBmb3IoY29uc3Qgc3BhbiBvZiBwLnNwYW5zKSB7XG4gICAgICAgICAgaWYoc3Bhbi5mb3JtYXQgJiYgc3Bhbi5mb3JtYXRbbmFtZV0pIHtcbiAgICAgICAgICAgIHZhbHVlID0gZmFsc2U7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIC8vIG9uZSBkaXNhYmxlcyB0aGUgb3RoZXJcbiAgICAgIGxldCBuYW1lMiwgdmFsdWUyO1xuICAgICAgaWYobmFtZSA9PT0gJ3N1YnNjcmlwdCcpIHtcbiAgICAgICAgbmFtZTIgPSAnc3VwZXJzY3JpcHQnO1xuICAgICAgICB2YWx1ZTIgPSBmYWxzZTtcbiAgICAgIH0gZWxzZSBpZihuYW1lID09PSAnc3VwZXJzY3JpcHQnKSB7XG4gICAgICAgIG5hbWUyID0gJ3N1YnNjcmlwdCc7XG4gICAgICAgIHZhbHVlMiA9IGZhbHNlO1xuICAgICAgfVxuICAgICAgLy8gYXBwbHkgdGhlIG5ldyBzdHlsZVxuICAgICAgZm9yKGNvbnN0IHAgb2Ygcikge1xuICAgICAgICBmb3IoY29uc3Qgc3BhbiBvZiBwLnNwYW5zKSB7XG4gICAgICAgICAgT2JqZWN0LmFzc2lnbihzcGFuLCB7IGZvcm1hdDogT2JqZWN0LmFzc2lnbihzcGFuLmZvcm1hdCB8fCB7fSwgeyBbbmFtZV06IHZhbHVlIH0sIG5hbWUyICYmIHsgW25hbWUyXTogdmFsdWUyIH0gfHwge30pLCBpZDogbmV3SUQoKSB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG5cbiAgICB0b2dnbGVCdWxsZXQoKSB7XG4gICAgICBjb25zdCBzZWxlY3Rpb24gPSBkb2N1bWVudC5nZXRTZWxlY3Rpb24oKTtcbiAgICAgIGNvbnN0IHNwYW5TZWxlY3Rpb24gPSB0aGlzLmdldFNwYW5TZWxlY3Rpb24oc2VsZWN0aW9uKTtcbiAgICAgIGxldCBidWxsZXQgPSB0cnVlO1xuICAgICAgZm9yKGNvbnN0IHMgb2Ygc3BhblNlbGVjdGlvbikge1xuICAgICAgICBpZihzLnBhcmFncmFwaC5idWxsZXQpIHtcbiAgICAgICAgICBidWxsZXQgPSBmYWxzZTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgZm9yKGNvbnN0IHMgb2Ygc3BhblNlbGVjdGlvbikge1xuICAgICAgICBzLnBhcmFncmFwaC5idWxsZXQgPSBidWxsZXQ7XG4gICAgICB9XG4gICAgfSxcblxuICAgIG1hcENvbnRhaW5lck9mZnNldFBvaW50ZXJUb0RhdGEoZGF0YSwgcG9pbnRlcikge1xuICAgICAgLy8gbWFwIG91dCBvZiBib3VuZCBvZmZzZXQgdG8gZGF0YSwgdXNlcyBvZmZzZXQgZ2VuZXJhdGVkIGJ5IHBvaW50ZXJUZXh0T2Zmc2V0SW5Db250YWluZXIoKVxuICAgICAgLy8gY29uc29sZS5kZWJ1ZygnTUFQJywgSlNPTi5zdHJpbmdpZnkoZGF0YSwgdW5kZWZpbmVkLCAgMiksICdQT0lOVEVSJywgcG9pbnRlciwgIEpTT04uc3RyaW5naWZ5KHBvaW50ZXIsIHVuZGVmaW5lZCwgMikpXG4gICAgICBpZighcG9pbnRlci5wYXJhZ3JhcGhJRCkge1xuICAgICAgICAvLyBzdGFydCBmcm9tIGJlZ2lubmluZyAvIGxlZnQgcGFyYWdyYXBoXG4gICAgICAgIGxldCBvZmZzZXQgPSAwO1xuICAgICAgICBmb3IoY29uc3QgcGFyYWdyYXBoIG9mIGRhdGEpIHtcbiAgICAgICAgICAvLyBjb25zb2xlLmRlYnVnKCdwYXJhZ3JhcGgnLCBwYXJhZ3JhcGgsICdsZWZ0IHBhcmEgaWQnLCBwb2ludGVyLmxlZnRQYXJhZ3JhcGhJRClcbiAgICAgICAgICBpZihwb2ludGVyLmxlZnRQYXJhZ3JhcGhJRCAmJiBwYXJhZ3JhcGguaWQgPT09IHBvaW50ZXIubGVmdFBhcmFncmFwaElEKSB7XG4gICAgICAgICAgICBvZmZzZXQgPSAwO1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIGZvcihjb25zdCBzcGFuIG9mIHBhcmFncmFwaC5zcGFucykge1xuICAgICAgICAgICAgLy8gY29uc29sZS5kZWJ1Zygnc3BhbicsIHNwYW4uaWQsICdvZmZzZXQnLCBvZmZzZXQsICdwb2ludGVyLm9mZnNldCcsIHBvaW50ZXIub2Zmc2V0KVxuICAgICAgICAgICAgaWYob2Zmc2V0IDw9IHBvaW50ZXIub2Zmc2V0ICYmIHBvaW50ZXIub2Zmc2V0IDwgb2Zmc2V0ICsgc3Bhbi50ZXh0Lmxlbmd0aCkge1xuICAgICAgICAgICAgICBwb2ludGVyLnBhcmFncmFwaElEID0gcGFyYWdyYXBoLmlkO1xuICAgICAgICAgICAgICBwb2ludGVyLnBhcmFncmFwaCA9IHBhcmFncmFwaDtcbiAgICAgICAgICAgICAgcG9pbnRlci5zcGFuSUQgPSBzcGFuLmlkO1xuICAgICAgICAgICAgICBwb2ludGVyLnNwYW4gPSBzcGFuO1xuICAgICAgICAgICAgICBwb2ludGVyLm9mZnNldCAtPSBvZmZzZXQ7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb2Zmc2V0ICs9IHNwYW4udGV4dC5sZW5ndGg7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmKHBvaW50ZXIub2Zmc2V0ID09PSBvZmZzZXQgJiYgcGFyYWdyYXBoLnNwYW5zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHBvaW50ZXIucGFyYWdyYXBoSUQgPSBwYXJhZ3JhcGguaWQ7XG4gICAgICAgICAgICBjb25zdCBzcGFuID0gcGFyYWdyYXBoLnNwYW5zW3BhcmFncmFwaC5zcGFucy5sZW5ndGgtMV1cbiAgICAgICAgICAgIHBvaW50ZXIuc3BhbklEID0gc3Bhbi5pZDtcbiAgICAgICAgICAgIHBvaW50ZXIuc3BhbiA9IHNwYW47XG4gICAgICAgICAgICBwb2ludGVyLm9mZnNldCA9IHNwYW4udGV4dC5sZW5ndGg7O1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZihwb2ludGVyLnBhcmFncmFwaElEKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmKHBvaW50ZXIucGFyYWdyYXBoSUQgJiYgIXBvaW50ZXIuc3BhbklEKSB7XG4gICAgICAgIC8vIHN0YXJ0IGZyb20gcGFyYWdyYXBoIC8gbGVmdCBzcGFuXG4gICAgICAgIC8vIGNvbnNvbGUuZGVidWcoJ2dldHRpbmcgc3BhbiBpZCcpXG4gICAgICAgIGZvcihjb25zdCBwYXJhZ3JhcGggb2YgZGF0YSkge1xuICAgICAgICAgIC8vIGNvbnNvbGUuZGVidWcoJ3BhcmFncmFwaCBpZCcsIHBhcmFncmFwaC5pZCwgJ3BvaW50ZXIgcGFyYSBpZCcsIHBvaW50ZXIucGFyYWdyYXBoSUQpXG4gICAgICAgICAgaWYocGFyYWdyYXBoLmlkICE9PSBwb2ludGVyLnBhcmFncmFwaElEKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLy8gY29uc29sZS5kZWJ1ZygncGFyYWdyYXBoJywgcGFyYWdyYXBoLmlkKVxuICAgICAgICAgIGxldCBvZmZzZXQgPSAwO1xuICAgICAgICAgIGZvcihjb25zdCBzcGFuIG9mIHBhcmFncmFwaC5zcGFucykge1xuICAgICAgICAgICAgLy8gY29uc29sZS5kZWJ1Zygnc3Bhbi5pZCcsIHNwYW4uaWQsIG9mZnNldCwgc3Bhbi50ZXh0Lmxlbmd0aCwgcG9pbnRlci5vZmZzZXQpXG4gICAgICAgICAgICBpZihwb2ludGVyLmxlZnRTcGFuSUQgJiYgc3Bhbi5pZCA9PT0gcG9pbnRlci5sZWZ0U3BhbklEKSB7XG4gICAgICAgICAgICAgIG9mZnNldCA9IDA7XG4gICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYob2Zmc2V0IDw9IHBvaW50ZXIub2Zmc2V0ICYmIHBvaW50ZXIub2Zmc2V0IDwgb2Zmc2V0ICsgc3Bhbi50ZXh0Lmxlbmd0aCkge1xuICAgICAgICAgICAgICBwb2ludGVyLnNwYW5JRCA9IHNwYW4uaWQ7XG4gICAgICAgICAgICAgIHBvaW50ZXIuc3BhbiA9IHNwYW47XG4gICAgICAgICAgICAgIHBvaW50ZXIub2Zmc2V0IC09IG9mZnNldDtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvZmZzZXQgKz0gc3Bhbi50ZXh0Lmxlbmd0aDtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYocG9pbnRlci5vZmZzZXQgPT09IG9mZnNldCAmJiBwYXJhZ3JhcGguc3BhbnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgY29uc3Qgc3BhbiA9IHBhcmFncmFwaC5zcGFuc1twYXJhZ3JhcGguc3BhbnMubGVuZ3RoLTFdXG4gICAgICAgICAgICBwb2ludGVyLnNwYW5JRCA9IHNwYW4uaWQ7XG4gICAgICAgICAgICBwb2ludGVyLnNwYW4gPSBzcGFuO1xuICAgICAgICAgICAgcG9pbnRlci5vZmZzZXQgPSBzcGFuLnRleHQubGVuZ3RoOztcbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHBvaW50ZXIubm9kZSA9IHVuZGVmaW5lZDtcbiAgICAgIGRhdGFQb2ludGVyKGRhdGEsIHBvaW50ZXIpO1xuICAgICAgcmV0dXJuIHBvaW50ZXI7XG4gICAgfSxcblxuICAgIHBhcnNlRE9NKHJlc3RvcmVTZWxlY3Rpb24pIHtcblxuICAgICAgLy8gY29uc29sZS5kZWJ1ZygncGFyc2VET00gdHJhY2U6JywgRXJyb3IoJ3N0YWNrIHRyYWNlIGluZm8nKS5zdGFjayk7XG5cbiAgICAgIGxldCBkYXRhID0gdGhpcy5wYXJhZ3JhcGhzO1xuXG4gICAgICBjb25zdCBzZWxlY3Rpb24gPSBub3JtYWxpemVkRE9NU2VsZWN0aW9uKCk7XG4gICAgICBjb25zdCBzdGFydCA9IGRhdGFQb2ludGVyRnJvbURPTVBvaW50ZXIoZGF0YSwgc2VsZWN0aW9uLnN0YXJ0KTtcbiAgICAgIGNvbnN0IGVuZCA9IGRhdGFQb2ludGVyRnJvbURPTVBvaW50ZXIoZGF0YSwgc2VsZWN0aW9uLmVuZCk7XG5cbiAgICAgIGlmKCFzdGFydC5zcGFuSUQgfHwgIXN0YXJ0LnBhcmFncmFwaElEKSB7XG4gICAgICAgIHBvaW50ZXJUZXh0T2Zmc2V0SW5Db250YWluZXIodGhpcy4kcmVmcy5jb250YWluZXIsIHN0YXJ0KTtcbiAgICAgIH1cbiAgICAgIGlmKCFlbmQuc3BhbklEIHx8ICFlbmQucGFyYWdyYXBoSUQpIHtcbiAgICAgICAgcG9pbnRlclRleHRPZmZzZXRJbkNvbnRhaW5lcih0aGlzLiRyZWZzLmNvbnRhaW5lciwgZW5kKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgcGFyc2VkID0gcGFyc2VET00odGhpcy4kcmVmcy5jb250YWluZXIpXG5cbiAgICAgIC8vIGNvbnNvbGUuZGVidWcoJ0RPTScsIEpTT04uc3RyaW5naWZ5KHBhcnNlZCwgdW5kZWZpbmVkLCAyKSlcbiAgICAgIC8vIGNvbnNvbGUuZGVidWcoJ0RBVEEnLCBKU09OLnN0cmluZ2lmeSh0aGlzLnBhcmFncmFwaHMsIHVuZGVmaW5lZCwgMikpO1xuICAgICAgY29uc3QgcGFyYWdyYXBocyA9IGRhdGFNZXJnZVBhcmFncmFwaHModGhpcy5wYXJhZ3JhcGhzIHx8IFtdLCBwYXJzZWQpO1xuICAgICAgLy8gY29uc29sZS5kZWJ1ZygnTUVSR0VEJywgSlNPTi5zdHJpbmdpZnkocGFyYWdyYXBocywgdW5kZWZpbmVkLCAyKSk7XG4gICAgICB0aGlzLnBhcmFncmFwaHMgPSBwYXJhZ3JhcGhzO1xuICAgICAgZGF0YSA9IHBhcmFncmFwaHM7XG5cbiAgICAgIC8vIHJlLW1hcCBvdXQgb2YgYm91bmQgb2Zmc2V0IHRvIGRhdGFcbiAgICAgIHRoaXMubWFwQ29udGFpbmVyT2Zmc2V0UG9pbnRlclRvRGF0YShkYXRhLCBzdGFydCk7XG4gICAgICB0aGlzLm1hcENvbnRhaW5lck9mZnNldFBvaW50ZXJUb0RhdGEoZGF0YSwgZW5kKTtcblxuICAgICAgaWYocmVzdG9yZVNlbGVjdGlvbikge1xuICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7XG4gICAgICAgICAgLy8gY29uc29sZS5kZWJ1ZygnUkVTVE9SRSBEQVRBJywgZGF0YSwgSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShkYXRhKSkpXG4gICAgICAgICAgLy8gY29uc29sZS5kZWJ1ZygnUkVTVE9SRSBTVEFSVCcsIGRhdGFQb2ludGVyKGRhdGEsIHN0YXJ0KSwgJ1JFU1RPUkUgRU5EJyAsIHNlbGVjdGlvbi5jb2xsYXBzZWQgPyBudWxsIDogZGF0YVBvaW50ZXIoZGF0YSwgZW5kKSwgJ0NPTExBUFNFRCcsIHNlbGVjdGlvbi5jb2xsYXBzZWQpO1xuICAgICAgICAgIHJlc3RvcmVET01TZWxlY3Rpb24odGhpcy4kcmVmcy5jb250YWluZXIsIGRhdGFQb2ludGVyKGRhdGEsIHN0YXJ0KSwgc2VsZWN0aW9uLmNvbGxhcHNlZCA/IG51bGwgOiBkYXRhUG9pbnRlcihkYXRhLCBlbmQpKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIC8vIHBvaW50ZXIgaXMgcG9pbnRpbmcgdG8gZGF0YTsgdG8gZ2V0IGZ1bGwgRE9NIHBvaW50ZXIsIGF1Z21lbnQgYWZ0ZXIgbmV4dCBET00gdXBkYXRlXG4gICAgICByZXR1cm4geyBwYXJhZ3JhcGhzLCBzdGFydCwgZW5kLCBjb2xsYXBzZWQ6IHNlbGVjdGlvbi5jb2xsYXBzZWQgfTtcbiAgICB9LFxuXG4gICAgYXBwbHlWaWV3Q2hhbmdlc05vdyhyZXN0b3JlU2VsZWN0aW9uID0gdHJ1ZSkge1xuXG4gICAgICBjb25zdCB7IHBhcmFncmFwaHMsIHN0YXJ0LCBlbmQsIGNvbGxhcHNlZCB9ID0gdGhpcy5wYXJzZURPTShyZXN0b3JlU2VsZWN0aW9uKTsgIC8vIERPTSAtPiBkYXRhLCBwb2ludGVyIGluIGRhdGFcblxuICAgICAgLy8gY29uc29sZS5kZWJ1ZygnZGVib3VuY2VkJywgSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLnBhcmFncmFwaHMpKSk7XG4gICAgICB0aGlzLnNhdmUoKTtcblxuICAgICAgcmV0dXJuIHsgc3RhcnQsIGVuZCwgY29sbGFwc2VkIH07XG4gICAgfSxcblxuICAgIG9uSW5wdXQoZSkge1xuICAgICAgLy8gY29uc29sZS5kZWJ1Zygnb24gaW5wdXQnKTtcbiAgICAgIHRoaXMuYXBwbHlWaWV3Q2hhbmdlcygpO1xuICAgIH0sXG5cbiAgICAvLyBvbktleXByZXNzKGUpIHtcbiAgICAvLyAgIGNvbnNvbGUuZGVidWcoJ2VkaXRhYmxlLXNwYW5zIGtleXByZXNzOicsIGUpO1xuICAgIC8vICAgaWYoZS5rZXkgPT0gJ0VudGVyJykge1xuICAgIC8vICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgLy8gICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgLy9cbiAgICAvLyAgICAgY29uc3Qgc2VsZWN0aW9uID0gZG9jdW1lbnQuZ2V0U2VsZWN0aW9uKCk7XG4gICAgLy8gICAgIGNvbnN0IHJhbmdlID0gc2VsZWN0aW9uLmdldFJhbmdlQXQoMCk7XG4gICAgLy9cbiAgICAvLyAgICAgLy8gY29uc3QgZ2V0Tm9kZUluZGV4ID0gKG5vZGUpID0+IHsgZm9yKHZhciBpPTA7IChub2RlPW5vZGUucHJldmlvdXNTaWJsaW5nKTsgaSsrKTsgcmV0dXJuIGk7IH07ICAvLyBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL3EvNTkxMzkyN1xuICAgIC8vXG4gICAgLy8gICAgIHJhbmdlLmluc2VydE5vZGUoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnInKSk7IC8vIGluc2VydCA8YnIvPiBlbGVtZW50XG4gICAgLy8gICAgIHJhbmdlLmNvbGxhcHNlKCk7IC8vIHdpdGhvdXQgdGhpcyB0aGUgbmV3bGluZSB3aWxsIHJlbWFpbiBzZWxlY3RlZCBhbmQgbmV3IHRleHQgaW5wdXQgd2lsbCByZXBsYWNlIHRoZSBuZXdsaW5lXG4gICAgLy9cbiAgICAvLyAgICAgLy8gU2FmYXJpIHJlcXVpcmVzIHRoYXQgcmFuZ2UgbXVzdCBiZSByZS1hZGRlZFxuICAgIC8vICAgICBzZWxlY3Rpb24ucmVtb3ZlQWxsUmFuZ2VzKCk7XG4gICAgLy8gICAgIHNlbGVjdGlvbi5hZGRSYW5nZShyYW5nZSk7XG4gICAgLy9cbiAgICAvLyAgICAgLy8gdGhpcy5vbklucHV0KGUpOyAvLyB0byByZWdpc3RlciBjaGFuZ2VzLCBidXQgaXQgYXBwZWFycyB0aGF0IHRoaXMgd2lsbCBiZSBjYWxsZWQgYW55d2F5IGJ5IHRoZSBicm93c2VyXG4gICAgLy8gICAgIC8vIHRoaXMuaW5wdXQoKTtcbiAgICAvLyAgIH0gZWxzZSBpZighZS5jdHJsS2V5ICYmICFlLmFsdEtleSAmJiAhZS5tZXRhS2V5IFsjJiYgIWUuc2hpZnRLZXkjXSkge1xuICAgIC8vICAgfVxuICAgIC8vICAgLy8gaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMTc4OTA1NjgvY29udGVudGVkaXRhYmxlLWRpdi1iYWNrc3BhY2UtYW5kLWRlbGV0aW5nLXRleHQtbm9kZS1wcm9ibGVtc1xuICAgIC8vIH0sXG5cbiAgICBlcnJvckNhcHR1cmVkKGVyciwgdm0sIGluZm8pIHtcbiAgICAgIGNvbnNvbGUuZGVidWcoJ0VSUk9SIGNhcHR1cmVkOicsIGVyciwgdm0sIGluZm8pO1xuICAgIH0sXG5cbiAgICBhc3luYyBvbktleWRvd24oZSkge1xuICAgICAgLy8gY29uc29sZS5kZWJ1ZygnZWRpdGFibGUtc3BhbnMga2V5ZG93bjonLCBlKTtcbiAgICAgIGlmKChlLm1ldGFLZXkgfHwgZS5jdHJsS2V5KSAmJiBlLnNoaWZ0S2V5ICYmIGUuYWx0S2V5ICYmIChlLmNvZGUgPT09ICdLZXlSJykpIHtcbiAgICAgICAgdGhpcy5yZXNldCgpO1xuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmKChlLm1ldGFLZXkgfHwgZS5jdHJsS2V5KSAmJiAoZS5jb2RlID09PSAnS2V5WicpKSB7XG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYoKGUubWV0YUtleSB8fCBlLmN0cmxLZXkpICYmIChlLmNvZGUgPT09ICdLZXlDJyB8fCBlLmNvZGUgPT09ICdLZXlWJyB8fCBlLmNvZGUgPT09ICdLZXlYJyB8fCBlLmNvZGUgPT09ICdLZXlSJyB8fCBlLmtleSA9PT0gJ01ldGEnIHx8IGUua2V5ID09PSAnQ29udHJvbCcpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gaWdub3JlIGNvbnRyb2wgY2hhcnNcbiAgICAgIGlmIChlLmNvZGUgPT09ICdFc2NhcGUnIHx8IGUuY29kZSA9PT0gJ1RhYicpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBkbyBub3QgcHJvY2VzcyBzZWxlY3QgYWN0aW9uIGtleXN0cm9rZXNcbiAgICAgIGlmKC8qIGUuc2hpZnRLZXkgJiYgKi8gKGUua2V5ID09PSAnQXJyb3dMZWZ0JyB8fCBlLmtleSA9PT0gJ0Fycm93UmlnaHQnIHx8IGUua2V5ID09PSAnQXJyb3dVcCcgfHwgZS5rZXkgPT09ICdBcnJvd0Rvd24nKSkge1xuICAgICAgICBpZighZS5zaGlmdEtleSkge1xuICAgICAgICAgIC8vIFRPRE86IHBvdGVudGlvbmFsbHkgY29ycmVjdCBjdXJzb3IgcG9zaXRpb24gaW4gc29tZSBjYXNlcyAoc2VlIGNvZGUgZnJhZ21lbnRzIGJlbG93KVxuICAgICAgICB9XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gZS5rZXkgPT09ICdEZWFkJyAvLyBjb2RlID09PSAnUXVvdGUnXG4gICAgICBpZihlLmtleSA9PT0gJ0RlYWQnKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgbGV0IHNlbGVjdGlvbiA9IGRvY3VtZW50LmdldFNlbGVjdGlvbigpO1xuICAgICAgaWYoIXNlbGVjdGlvbi5pc0NvbGxhcHNlZCAmJiAhZS5jdHJsS2V5ICYmICFlLm1ldGFLZXkgJiYgZS5rZXkgIT0gJ0FsdCcgJiYgZS5rZXkgIT0gJ1NoaWZ0Jykge1xuICAgICAgICAvLyBUT0RPOiBiZWNhdXNlIHRoZXJlIGlzIG5vIHdheSB0byBzZW5kIGtleWJvYXJkIGV2ZW50cyB0byB0aGUgYnJvd3NlciBmcm9tIGphdmFzY3JpcHQ6XG4gICAgICAgIC8vIGEpIHRoZSBjdXJyZW50IGtleWJvYXJkIGV2ZW50ICh0aGF0IHJlbW92ZXMgY3VycmVudCBzZWxlY3Rpb24gZmlyc3QpIG11c3QgYmUgcHJvY2Vzc2VkXG4gICAgICAgIC8vIGIpIHRoZSBjdXJyZW50IGtleWJvYXJkIGV2ZW50IG11c3QgYmUgcGFzc2VkIHRocm91Z2ggZm9yIHNlbGVjdGVkIGtleXN0cm9rZXMgKGUuZy4gdXN1YWwgdGV4dCBpbnB1dClcbiAgICAgICAgLy8gICAgYWZ0ZXIgdGhlIGRhdGEgc3BsaWNlIG9wZXJhdGlvbiBiZWxvd1xuICAgICAgICBpZihlLmtleSA9PT0gJ0RlbGV0ZScgfHwgZS5rZXkgPT09ICdCYWNrc3BhY2UnIHx8IGUua2V5ID09PSAnRW50ZXInKSB7XG4gICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZGF0YSA9IHRoaXMucGFyYWdyYXBocztcbiAgICAgICAgc2VsZWN0aW9uID0gbm9ybWFsaXplZERPTVNlbGVjdGlvbihzZWxlY3Rpb24pO1xuICAgICAgICBjb25zdCBzdGFydCA9IHNlbGVjdGlvbi5zdGFydDtcbiAgICAgICAgZGF0YVBvaW50ZXIoZGF0YSwgc3RhcnQpO1xuICAgICAgICBjb25zdCBlbmQgPSBzZWxlY3Rpb24uZW5kO1xuICAgICAgICBkYXRhUG9pbnRlcihkYXRhLCBlbmQpO1xuICAgICAgICBjb25zdCByID0gZGF0YVNwbGljZShkYXRhLCBzdGFydCwgZW5kKTtcbiAgICAgICAgLy8gY29uc29sZS5kZWJ1ZygnREVMRVRFRCcsIHIpXG5cbiAgICAgICAgaWYoZS5rZXkgPT09ICdFbnRlcicpIHtcbiAgICAgICAgICBjb25zdCByID0gZGF0YUluc2VydChkYXRhLCBzdGFydCwgW25ld1BhcmFncmFwaCgpLCBuZXdQYXJhZ3JhcGgoKV0pO1xuICAgICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHtcbiAgICAgICAgICAgIHJlc3RvcmVET01TZWxlY3Rpb24odGhpcy4kcmVmcy5jb250YWluZXIsIGRhdGFQb2ludGVyRE9NTm9kZShkYXRhUG9pbnRlck5leHQoZGF0YSwgc3RhcnQpLCB0aGlzLiRyZWZzLmNvbnRhaW5lcikpO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICAvLyBUT0RPOiBkbyB3ZSBuZWVkIHRoaXM/XG4gICAgICAgIC8vIGlmKHN0YXJ0LnBhcmFncmFwaC5zcGFucy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgLy8gICBzdGFydC5wYXJhZ3JhcGguc3BhbnMuc3BsaWNlKDAsIDAsIG5ld1NwYW4oKSk7XG4gICAgICAgIC8vIH1cbiAgICAgICAgLy8gaWYoZW5kLnBhcmFncmFwaC5zcGFucy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgLy8gICBlbmQucGFyYWdyYXBoLnNwYW5zLnNwbGljZSgwLCAwLCBuZXdTcGFuKCkpO1xuICAgICAgICAvLyB9XG4gICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHtcbiAgICAgICAgICBzdGFydC5zcGFuSUQgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgc3RhcnQubm9kZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICByZXN0b3JlRE9NU2VsZWN0aW9uKHRoaXMuJHJlZnMuY29udGFpbmVyLCBkYXRhUG9pbnRlcihkYXRhLCBzdGFydCkpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy83MjA3MjkxL2lzLWl0LXBvc3NpYmxlLXRvLWRpc2FibGUtb3ItY29udHJvbC1jb21tYW5kcy1pbi1jb250ZW50ZWRpdGFibGUtZWxlbWVudHNcbiAgICAgIGlmKGUuY29kZSA9PT0gJ0tleUwnICYmIChlLm1ldGFLZXkgPT09IHRydWUgfHwgZS5jdHJsS2V5ID09PSB0cnVlKSkge1xuICAgICAgICAvLyBsaXN0XG4gICAgICAgIHRoaXMudG9nZ2xlQnVsbGV0KCk7XG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfSBlbHNlIGlmKChlLmNvZGUgPT09ICdLZXlMJ1xuICAgICAgICB8fCBlLmNvZGUgPT09ICdLZXlCJ1xuICAgICAgICB8fCBlLmNvZGUgPT09ICdLZXlJJ1xuICAgICAgICB8fCBlLmNvZGUgPT09ICdLZXlVJ1xuICAgICAgICB8fCAoZS5jb2RlID09PSAnRGlnaXQ2JyAmJiBlLnNoaWZ0S2V5ID09PSB0cnVlKVxuICAgICAgICB8fCAoZS5jb2RlID09PSAnTWludXMnICYmIGUuc2hpZnRLZXkgPT09IHRydWUpKSAmJiAoZS5jdHJsS2V5ID09PSB0cnVlIHx8IGUubWV0YUtleSA9PT0gdHJ1ZSkpIHtcblxuICAgICAgICBsZXQgc3R5bGU7XG4gICAgICAgIGlmKGUuY29kZSA9PT0gJ0tleUInKSB7XG4gICAgICAgICAgc3R5bGUgPSAnYm9sZCc7XG4gICAgICAgIH0gZWxzZSBpZihlLmNvZGUgPT09ICdLZXlJJykge1xuICAgICAgICAgIHN0eWxlID0gJ2l0YWxpYyc7XG4gICAgICAgIH0gZWxzZSBpZihlLmNvZGUgPT09ICdLZXlVJykge1xuICAgICAgICAgIHN0eWxlID0gJ3VuZGVybGluZSc7XG4gICAgICAgIH0gZWxzZSBpZihlLmNvZGUgPT09ICdEaWdpdDYnKSB7XG4gICAgICAgICAgc3R5bGUgPSAnc3VwZXJzY3JpcHQnO1xuICAgICAgICB9IGVsc2UgaWYoZS5jb2RlID09PSAnTWludXMnKSB7XG4gICAgICAgICAgc3R5bGUgPSAnc3Vic2NyaXB0JztcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMudG9nZ2xlU3R5bGVYKHN0eWxlLCB0cnVlKTtcblxuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcblxuICAgICAgfSBlbHNlIGlmKGUua2V5ID09PSAnRW50ZXInKSB7XG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICB0aGlzLmFwcGx5Vmlld0NoYW5nZXNOb3coKTtcblxuICAgICAgICBpZighdGhpcy5wYXJhZ3JhcGhzKSB7XG4gICAgICAgICAgdGhpcy5wYXJhZ3JhcGhzID0gW25ld1BhcmFncmFwaCgpLCBuZXdQYXJhZ3JhcGgoKV07XG4gICAgICAgICAgdGhpcy5hcHBseVZpZXdDaGFuZ2VzTm93KGZhbHNlKTtcbiAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7XG4gICAgICAgICAgICByZXN0b3JlRE9NU2VsZWN0aW9uKHRoaXMuJHJlZnMuY29udGFpbmVyLCBkYXRhUG9pbnRlckRPTU5vZGUoZGF0YVBvaW50ZXIodGhpcy5wYXJhZ3JhcGhzLCB7IHBhcmFncmFwaEluZGV4OiAxLCBvZmZzZXQ6IDAgfSksIHRoaXMuJHJlZnMuY29udGFpbmVyKSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4ge1xuXG4gICAgICAgICAgY29uc3QgZGF0YSA9IHRoaXMucGFyYWdyYXBocztcblxuICAgICAgICAgIGNvbnN0IHNlbGVjdGlvbiA9IG5vcm1hbGl6ZWRET01TZWxlY3Rpb24oKTtcblxuICAgICAgICAgIGlmKHNlbGVjdGlvbi5jb2xsYXBzZWQpIHtcbiAgICAgICAgICAgIGRhdGFQb2ludGVyKGRhdGEsIHNlbGVjdGlvbi5zdGFydCk7XG4gICAgICAgICAgICAvLyBkYXRhUG9pbnRlcihkYXRhLCBzZWxlY3Rpb24uZW5kKTtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUuZGVidWcoc2VsZWN0aW9uKTtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUuZGVidWcoJ0VOVEVSIFNFTCcsIEpTT04uc3RyaW5naWZ5KHNlbGVjdGlvbi5zdGFydCwgdW5kZWZpbmVkLCAyKSk7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmRlYnVnKCdFTlRFUiBEQVRBIEJFRk9SRScsIEpTT04uc3RyaW5naWZ5KGRhdGEsIHVuZGVmaW5lZCwgMikpO1xuICAgICAgICAgICAgY29uc3QgciA9IGRhdGFJbnNlcnQoZGF0YSwgc2VsZWN0aW9uLnN0YXJ0LCBbbmV3UGFyYWdyYXBoKCksIG5ld1BhcmFncmFwaCgpXSk7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmRlYnVnKCdFTlRFUiBEQVRBIEFGVEVSJywgSlNPTi5zdHJpbmdpZnkoZGF0YSwgdW5kZWZpbmVkLCAyKSk7XG4gICAgICAgICAgICAvLyBpZihzZWxlY3Rpb24uc3RhcnQuc3BhbkluZGV4ID09PSAwKSB7XG4gICAgICAgICAgICAvLyAgIGNvbnN0IHIgPSBkYXRhSW5zZXJ0KGRhdGEsIHNlbGVjdGlvbi5zdGFydCwgW25ld1BhcmFncmFwaCgxKSwgbmV3UGFyYWdyYXBoKCldKTtcbiAgICAgICAgICAgIC8vIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyAgIGNvbnN0IHIgPSBkYXRhSW5zZXJ0KGRhdGEsIHNlbGVjdGlvbi5zdGFydCwgW25ld1BhcmFncmFwaCgpLCBuZXdQYXJhZ3JhcGgoMSldKTtcbiAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgIC8vIGNvbnNvbGUuZGVidWcoJ0VOVEVSJywgZGF0YSlcbiAgICAgICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgcmVzdG9yZURPTVNlbGVjdGlvbih0aGlzLiRyZWZzLmNvbnRhaW5lciwgZGF0YVBvaW50ZXJET01Ob2RlKGRhdGFQb2ludGVyTmV4dChkYXRhLCBzZWxlY3Rpb24uc3RhcnQpLCB0aGlzLiRyZWZzLmNvbnRhaW5lcikpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgIH0pO1xuXG4gICAgICB9IGVsc2UgaWYoZS5rZXkgPT09ICdCYWNrc3BhY2UnKSB7XG5cbiAgICAgICAgY29uc3QgeyBzdGFydCwgZW5kLCBjb2xsYXBzZWQgfSA9IHRoaXMuYXBwbHlWaWV3Q2hhbmdlc05vdygpO1xuXG4gICAgICAgIGlmKCFjb2xsYXBzZWQpIHtcbiAgICAgICAgICBjb25zb2xlLmRlYnVnKCd3YXJuaW5nOiByYW5nZSBiYWNrc3BhY2UgaGFkIHRvIGJlIGhhbmRsZXIgZWxzZXdoZXJlJyk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYoc3RhcnQub2Zmc2V0ID4gMCB8fCBzdGFydC5zcGFuSW5kZXggPiAwKSB7XG4gICAgICAgICAgcmV0dXJuOyAvLyByZXN1bWUgd2l0aCBub3JtYWwgYmFja3NwYWNlIG9wZXJhdGlvblxuICAgICAgICB9XG5cbiAgICAgICAgLy8gTk9URTogYXR0cnMuZmlyc3QgPT09ICd0cnVlJyBjb3VsZCBub3Qga2VlcCB1cCB0byB0aGUgdGFzaywgaS5lLiwgYXQgdGhhdCBwb2ludCB0aGUgc3BhbiBtaWdodCBiZSBhbHJlYWR5IGdvbmVcblxuICAgICAgICAvLyBiZWNhdXNlIG9mIGRlYm91bmNlIGFwcGx5Vmlld0NoYW5nZXMgd2lsbCBub3Qga2VlcCB1cCB0byB0aGUgdGFzaywgcHJldmVudCBkZWxldGluZyBwYXJhZ3JhcGggRE9NIHRhZ3MgYnkgdGhlIGJyb3dzZXIgYXV0b21hdGljYWxseVxuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4ge1xuXG4gICAgICAgICAgLy8gYXNzdW1lXG5cbiAgICAgICAgICBjb25zdCBkYXRhID0gdGhpcy5wYXJhZ3JhcGhzO1xuICAgICAgICAgIGNvbnN0IHBhcmFncmFwaHMgPSB0aGlzLnBhcmFncmFwaHM7XG5cbiAgICAgICAgICBjb25zdCBzZWxlY3Rpb24gPSBub3JtYWxpemVkRE9NU2VsZWN0aW9uKCk7XG5cbiAgICAgICAgICBjb25zdCBzdGFydCA9IHNlbGVjdGlvbi5zdGFydDtcblxuICAgICAgICAgIGNvbnN0IG9iaiA9IChvKSA9PiBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KG8pKTtcblxuICAgICAgICAgIC8vIGNvbnRpbnVlIGRlbGV0aW5nIHBhcmFncmFwaC4uLlxuXG4gICAgICAgICAgZGF0YVBvaW50ZXIoZGF0YSwgc3RhcnQpOyAvLyB2ZXJpZnkgYnkgYWxpZ25pbmcgd2l0aCBkYXRhIG1vZGVsXG5cbiAgICAgICAgICAvLyBzdGFydCBtYXkgbm90IHBvaW50IHRvIHRoZSBiZWdpbm5pbmcgb2YgcGFyYWdyYXBoLCBldmVuIGlmIHRoZSBjdXJzb3IgdHJ1bHkgaXMsIHNvIGNvbnN0cnVjdFxuICAgICAgICAgIGNvbnN0IHN0YXJ0T2ZQYXJhZ3JhcGggPSBkYXRhUG9pbnRlcihkYXRhLCB7IHBhcmFncmFwaEluZGV4OiBzdGFydC5wYXJhZ3JhcGhJbmRleCwgc3BhbkluZGV4OiAwLCBvZmZzZXQ6IDAgfSk7XG5cbiAgICAgICAgICBpZihzdGFydC5wYXJhZ3JhcGhJbmRleCA+IDAgLyomJiBzdGFydC5zcGFuSW5kZXggPT09IDAgJiYgc3RhcnQub2Zmc2V0ID09PSAwKi8pIHtcblxuICAgICAgICAgICAgY29uc3QgZGF0YSA9IHRoaXMucGFyYWdyYXBocztcblxuICAgICAgICAgICAgLy8gd2UgYXJlIGF0IHRoZSBiZWdpbm5pbmcgb2YgcGFyYWdyYXBoLCBkZWxldGUgaXQgYnkgam9pbmluZyB0aGUgcmVzdCBvZiBpdCB3aXRoIHRoZSBwcmV2aW91cyBwYXJhZ3JhcGhcblxuICAgICAgICAgICAgY29uc3QgcHAgPSBkYXRhUG9pbnRlclByZXYoZGF0YSwgc3RhcnRPZlBhcmFncmFwaCk7ICAvLyBwcmV2aW91cyBwb3NpdGlvbiAobWlnaHQgbm90IGNvbnRhaW4gYSByZWFsIHNwYW4pXG4gICAgICAgICAgICAvLyBjb25zb2xlLmRlYnVnKCdiZWZvcmUgc3BsaWNlJywgJ3N0YXJ0IG9mIHBhcmEnLCBzdGFydE9mUGFyYWdyYXBoLCAnc3RhcnQnLCBzdGFydCwgJy0tPicsIHBwKVxuICAgICAgICAgICAgY29uc3QgciA9IGRhdGFTcGxpY2UoZGF0YSwgcHAsIHN0YXJ0KTtcbiAgICAgICAgICAgIC8vIGlmKHBwLnBhcmFncmFwaC5zcGFucy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIC8vICAgcHAucGFyYWdyYXBoLnNwYW5zLnNwbGljZSgwLCAwLCBuZXdTcGFuKCkpO1xuICAgICAgICAgICAgLy8gfVxuICAgICAgICAgICAgLy8gY29uc29sZS5kZWJ1ZyhKU09OLnN0cmluZ2lmeShyLCB1bmRlZmluZWQsIDIpKTtcblxuICAgICAgICAgICAgY29uc3QgYyA9IHIubGVuZ3RoID4gMCAmJiByWzBdLmlkID09PSBwcC5wYXJhZ3JhcGhJRCA/IHN0YXJ0IDogcHA7XG5cbiAgICAgICAgICAgIC8vIGF0IG5leHQgRE9NIHVwZGF0ZSAoYXQgdGhpcyBwb2ludCBvbmx5IHRoZSBkYXRhIG1vZGVsIGhhcyBjaGFuZ2VzLCB0aGUgRE9NIGNvbnRhaW5zIG9sZCBjb250ZW50KSwgc2V0IGN1cnNvciB0byB0aGUgY29ycmVjdCBwb3NpdGlvblxuICAgICAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAvLyBoYXZlIHRvIHJlc2V0IHRoZXNlXG4gICAgICAgICAgICAgIC8vIGMuc3BhbklEID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICBjLm5vZGUgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgIC8vIHBwLnNwYW5JbmRleCA9IDA7XG4gICAgICAgICAgICAgIC8vIHBwLm9mZnNldCA9IDA7XG4gICAgICAgICAgICAgIC8vIHB1dCB0ZXh0IGN1cnNvciBhdCB0aGUgZXhwZWN0ZWQgcG9zaXRpb25cbiAgICAgICAgICAgICAgLy8gZGF0YVBvaW50ZXIoZGF0YSwgcHApO1xuICAgICAgICAgICAgICAvLyBjb25zb2xlLmRlYnVnKCdEQVRBJywgSlNPTi5zdHJpbmdpZnkoZGF0YSwgdW5kZWZpbmVkLCAyKSk7XG4gICAgICAgICAgICAgIC8vIGNvbnNvbGUuZGVidWcoJ3Jlc3RvcmluZycsIEpTT04uc3RyaW5naWZ5KHBwLCB1bmRlZmluZWQsIDIpKTtcbiAgICAgICAgICAgICAgLy8gY29uc29sZS5kZWJ1ZygncmVzdG9yaW5nJywgYyk7XG4gICAgICAgICAgICAgIHJlc3RvcmVET01TZWxlY3Rpb24odGhpcy4kcmVmcy5jb250YWluZXIsIGMpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgfSBlbHNlIGlmKGUua2V5ID09PSAnRGVsZXRlJykge1xuXG4gICAgICAgIGNvbnN0IHsgc3RhcnQsIGVuZCwgY29sbGFwc2VkIH0gPSB0aGlzLmFwcGx5Vmlld0NoYW5nZXNOb3coKTtcblxuICAgICAgICBpZighY29sbGFwc2VkKSB7XG4gICAgICAgICAgY29uc29sZS5kZWJ1Zygnd2FybmluZzogcmFuZ2UgZGVsZXRlcyBtdXN0IGJlIGhhbmRsZWQgZWxzZXdoZXJlJyk7XG4gICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gY29uc29sZS5kZWJ1ZygnREVMRVRFIEtFWScsIHN0YXJ0LCBlbmQpXG5cbiAgICAgICAgaWYoIXN0YXJ0IHx8IHN0YXJ0LnNwYW5JbmRleCA8IHN0YXJ0LnBhcmFncmFwaC5zcGFucy5sZW5ndGggLSAxIHx8IHN0YXJ0LnNwYW4gJiYgc3RhcnQub2Zmc2V0IDwgc3RhcnQuc3Bhbi50ZXh0Lmxlbmd0aFxuICAgICAgICAgIC8qIHx8IHN0YXJ0LnBhcmFncmFwaC5zcGFucy5sZW5ndGggPiAwICovKSB7XG4gICAgICAgICAgLy8gbm90IGVuZCBvZiBwYXJhZ3JhcGggcG9zaXRpb25cbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4ge1xuXG4gICAgICAgICAgY29uc3QgZGF0YSA9IHRoaXMucGFyYWdyYXBocztcbiAgICAgICAgICBjb25zdCBwYXJhZ3JhcGhzID0gdGhpcy5wYXJhZ3JhcGhzO1xuXG4gICAgICAgICAgLy8gY29uc3Qgc2VsZWN0aW9uID0gbm9ybWFsaXplZERPTVNlbGVjdGlvbigpO1xuXG4gICAgICAgICAgaWYoY29sbGFwc2VkKSB7XG5cbiAgICAgICAgICAgIC8vIGRhdGFQb2ludGVyKGRhdGEsIHN0YXJ0KTtcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0UGFyYWdyYXBoU3BhbnMgPSBwYXJhZ3JhcGhzW3N0YXJ0LnBhcmFncmFwaEluZGV4XS5zcGFucztcbiAgICAgICAgICAgIGNvbnN0IGVuZE9mUGFyYWdyYXBoID0gZGF0YVBvaW50ZXIoZGF0YSwgeyBwYXJhZ3JhcGhJbmRleDogc3RhcnQucGFyYWdyYXBoSW5kZXgsIHNwYW5JbmRleDogc3RhcnRQYXJhZ3JhcGhTcGFucy5sZW5ndGgtMSwgb2Zmc2V0OiAtMSB9KVxuICAgICAgICAgICAgLy8gY29uc29sZS5kZWJ1ZygnREVMRVRFJywgc3RhcnQsIHN0YXJ0UGFyYWdyYXBoU3BhbnMsIHN0YXJ0UGFyYWdyYXBoU3BhbnNbc3RhcnQuc3BhbkluZGV4XSlcblxuICAgICAgICAgICAgaWYoc3RhcnQucGFyYWdyYXBoSW5kZXggPCBwYXJhZ3JhcGhzLmxlbmd0aCAtIDEgLyomJiBzdGFydC5zcGFuSW5kZXggPT09IHN0YXJ0UGFyYWdyYXBoU3BhbnMubGVuZ3RoIC0gMSAmJiBzdGFydC5vZmZzZXQgPj0gc3RhcnRQYXJhZ3JhcGhTcGFuc1tzdGFydC5zcGFuSW5kZXhdLnRleHQudHJpbUVuZCgpLmxlbmd0aCovKSB7XG5cbiAgICAgICAgICAgICAgLy8gd2UgYXJlIGF0IHRoZSBlbmQgb2YgdGhlIGN1cnJlbnQgcGFyYWdyYXBoLCBkZWxldGUgbmV4dCBwYXJhZ3JhcGggaXQgYnkgam9pbmluZyBpdCB0byB0aGUgY3VycmVudCBwYXJhZ3JhcGhcblxuICAgICAgICAgICAgICBjb25zdCBkYXRhID0gdGhpcy5wYXJhZ3JhcGhzO1xuXG4gICAgICAgICAgICAgIGlmKHN0YXJ0LnBhcmFncmFwaC5zcGFucy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAvLyByZW1vdmUgY3VycmVudCBlbXB0eSBwYXJhZ3JhcGggb25seVxuICAgICAgICAgICAgICAgIGRhdGEuc3BsaWNlKHN0YXJ0LnBhcmFncmFwaEluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICBzdGFydC5zcGFuSW5kZXggPSAwO1xuICAgICAgICAgICAgICAgIHN0YXJ0LnBhcmFncmFwaElEID0gMDtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAvLyBkYXRhU3BsaWNlKGRhdGEsIHN0YXJ0LCBkYXRhUG9pbnRlcihkYXRhLCBkYXRhUG9pbnRlcihkYXRhLCB7IHBhcmFncmFwaEluZGV4OiBzdGFydC5wYXJhZ3JhcGhJbmRleCArIDEsIHNwYW5JbmRleDogMCwgb2Zmc2V0OiAwIH0pKSk7XG4gICAgICAgICAgICAgIC8vIGNvbnNvbGUuZGVidWcoJ3N0YXJ0IHBhcmEgc3BhbnMnLCBzdGFydFBhcmFncmFwaFNwYW5zKVxuICAgICAgICAgICAgICAvLyBjb25zb2xlLmRlYnVnKCdlbmRvZiBwYXJhJywgZW5kT2ZQYXJhZ3JhcGgpXG4gICAgICAgICAgICAgIC8vIGNvbnNvbGUuZGVidWcoJ3BvaW50ZXIgbmV4dCcsIGRhdGFQb2ludGVyTmV4dChkYXRhLCBlbmRPZlBhcmFncmFwaCkpXG4gICAgICAgICAgICAgIC8vICAgY29uc29sZS5kZWJ1ZygnREFUQTAnLCBKU09OLnN0cmluZ2lmeShkYXRhLCB1bmRlZmluZWQsIDIpKTtcbiAgICAgICAgICAgICAgY29uc3QgciA9IGRhdGFTcGxpY2UoZGF0YSwgc3RhcnQsIGRhdGFQb2ludGVyTmV4dChkYXRhLCBlbmRPZlBhcmFncmFwaCkpO1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUuZGVidWcoJ0RBVEExJywgSlNPTi5zdHJpbmdpZnkoZGF0YSwgdW5kZWZpbmVkLCAyKSk7XG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5kZWJ1ZygnU1BMSUNFRCcsIEpTT04uc3RyaW5naWZ5KHIsIHVuZGVmaW5lZCwgMikpO1xuICAgICAgICAgICAgICAgIGlmKHN0YXJ0LnNwYW5JbmRleCA9PT0gdW5kZWZpbmVkICYmIHN0YXJ0LnNwYW5JRCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgc3RhcnQuc3BhbkluZGV4ID0gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAvLyBhdCBuZXh0IERPTSB1cGRhdGUgKGF0IHRoaXMgcG9pbnQgb25seSB0aGUgZGF0YSBtb2RlbCBoYXMgY2hhbmdlcywgdGhlIERPTSBjb250YWlucyBvbGQgY29udGVudCksIHNldCBjdXJzb3IgdG8gdGhlIGNvcnJlY3QgcG9zaXRpb25cbiAgICAgICAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgIC8vIGhhdmUgdG8gcmVzZXQgdGhlc2VcbiAgICAgICAgICAgICAgICAvLyBzdGFydC5zcGFuSUQgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgc3RhcnQubm9kZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAvLyBwdXQgdGV4dCBjdXJzb3IgYXQgdGhlIGV4cGVjdGVkIHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgZGF0YVBvaW50ZXIoZGF0YSwgc3RhcnQpXG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5kZWJ1ZygnUkVTVE9SRScsIHN0YXJ0KVxuICAgICAgICAgICAgICAgIHJlc3RvcmVET01TZWxlY3Rpb24odGhpcy4kcmVmcy5jb250YWluZXIsIHN0YXJ0KTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSBpZigoZS5jdHJsS2V5IHx8IGUubWV0YUtleSkgJiYgZS5zaGlmdEtleSAmJiBlLmNvZGUgPT09ICdLZXlIJykge1xuICAgICAgICBjb25zdCBzZWxlY3RlZFNwYW5zID0gdGhpcy5nZXRTcGFuU2VsZWN0aW9uKCk7XG4gICAgICAgIC8vIGNvbnNvbGUuZGVidWcoJ3JlbW92ZSBoaWdobGlnaHRpbmcgZnJvbSBzcGFucycsIHNlbGVjdGVkU3BhbnMpO1xuICAgICAgICBmb3IoY29uc3QgcyBvZiBzZWxlY3RlZFNwYW5zKSB7XG4gICAgICAgICAgZm9yKGNvbnN0IHNwYW4gb2Ygcy5zcGFucykge1xuICAgICAgICAgICAgc3Bhbi5oaWdobGlnaHRlZCA9IGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICB9IGVsc2UgaWYoKGUuY3RybEtleSB8fCBlLm1ldGFLZXkpICYmIGUuY29kZSA9PT0gJ0tleUgnKSB7XG4gICAgICAgIGNvbnN0IHNlbGVjdGVkU3BhbnMgPSB0aGlzLmdldFNwYW5TZWxlY3Rpb24oKTtcbiAgICAgICAgLy8gY29uc29sZS5kZWJ1ZygnaGlnaGxpZ2h0IHNwYW5zJywgc2VsZWN0ZWRTcGFucyk7XG4gICAgICAgIGZvcihjb25zdCBzIG9mIHNlbGVjdGVkU3BhbnMpIHtcbiAgICAgICAgICBmb3IoY29uc3Qgc3BhbiBvZiBzLnNwYW5zKSB7XG4gICAgICAgICAgICBzcGFuLmhpZ2hsaWdodGVkID0gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgfSBlbHNlIGlmKCFzZWxlY3Rpb24uaXNDb2xsYXBzZWQpIHtcbiAgICAgICAgY29uc29sZS5kZWJ1ZygnUFJFVkVOVCBSQU5HRSBSRVBMQUNFJyk7XG4gICAgICAgIC8vIFRPRE8gYmxvY2tzIGNtZCtzIGlmIHRleHQgaXMgc2VsZWN0ZWRcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gY29uc29sZS5kZWJ1ZygnRU5EJylcbiAgICAgIH1cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0sXG5cbiAgICBvbkRyYWdTdGFydChlKSB7XG4gICAgICAvLyBwcmV2ZW50IHRleHQgZHJhZ2dpbmdcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSxcblxuICAgIG9uUGFzdGUoZSkge1xuICAgICAgLy8gY29uc29sZS5kZWJ1ZygnZWRpdGFibGUtc3BhbnMgcGFzdGUnLCBlKTtcbiAgICAgIC8vIHRoaXMgcHJldmVudHMgcGFzdGUgd2l0aCBzZWxlY3RpbmcgcGFzdGUgbWVudSBpdGVtLCBrZXlib2FyZCBzaG9ydGN1dHMgZ2V0IHByZXZlbnRlZCBpbiBrZXlkb3duIGV2ZW50IGhhbmRsZXJcblxuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgY29uc3QgeyBzdGFydCwgZW5kLCBjb2xsYXBzZWQgfSA9IHRoaXMuYXBwbHlWaWV3Q2hhbmdlc05vdyhmYWxzZSk7XG5cbiAgICAgIGNvbnN0IG5hdGl2ZURhdGEgPSBlLmNsaXBib2FyZERhdGEuZ2V0RGF0YSgnYXBwbGljYXRpb24vcnV0YScpO1xuICAgICAgY29uc3QgaHRtbERhdGEgPSBlLmNsaXBib2FyZERhdGEuZ2V0RGF0YSgndGV4dC9odG1sJyk7XG4gICAgICBjb25zdCB0ZXh0RGF0YSA9IGUuY2xpcGJvYXJkRGF0YS5nZXREYXRhKCd0ZXh0L3BsYWluJyk7XG5cbiAgICAgIGlmKG5hdGl2ZURhdGEubGVuZ3RoID09PSAwICYmIGh0bWxEYXRhLmxlbmd0aCA9PT0gMCAmJiB0ZXh0RGF0YS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgLy8gY2xpcGJvYXJkIGVtcHR5IG9yIGluY29tcGF0aWJsZSBmb3JtYXRcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBkYXRhID0gdGhpcy5wYXJhZ3JhcGhzO1xuICAgICAgZGF0YVBvaW50ZXIoZGF0YSwgc3RhcnQpO1xuXG4gICAgICBpZighY29sbGFwc2VkKSB7XG4gICAgICAgIGRhdGFQb2ludGVyKGRhdGEsIGVuZCk7XG4gICAgICAgIGNvbnN0IHIgPSBkYXRhU3BsaWNlKGRhdGEsIHN0YXJ0LCBlbmQpO1xuXG4gICAgICAgIHN0YXJ0LnNwYW5JRCA9IHVuZGVmaW5lZDtcbiAgICAgICAgc3RhcnQubm9kZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgZGF0YVBvaW50ZXIoZGF0YSwgc3RhcnQpO1xuICAgICAgICBzdGFydC5ub2RlID0gdW5kZWZpbmVkO1xuICAgICAgfVxuXG4gICAgICAvLyBjb25zb2xlLmRlYnVnKCdDTElQJywgZS5jbGlwYm9hcmREYXRhLnR5cGVzKVxuICAgICAgLy8gY29uc29sZS5kZWJ1ZygnUEFTVEUgSFRNTCcsIGUuY2xpcGJvYXJkRGF0YS5nZXREYXRhKCd0ZXh0L2h0bWwnKSk7XG4gICAgICAvLyBjb25zb2xlLmRlYnVnKCdQQVNURSBSVEYnLCBlLmNsaXBib2FyZERhdGEuZ2V0RGF0YSgndGV4dC9ydGYnKSk7XG4gICAgICAvLyBjb25zb2xlLmRlYnVnKCdQQVNURSBQTEFJTicsIGUuY2xpcGJvYXJkRGF0YS5nZXREYXRhKCd0ZXh0L3BsYWluJykpO1xuXG4gICAgICBpZihuYXRpdmVEYXRhLmxlbmd0aCA+IDApIHtcblxuICAgICAgICBjb25zb2xlLmRlYnVnKCdwYXN0aW5nIGZyb20gUlVUQScpXG4gICAgICAgIGNvbnN0IG5ld0RhdGEgPSBKU09OLnBhcnNlKG5hdGl2ZURhdGEpOyAgLy8gdGhpcyBuYXR1cmFsbHkgZ2l2ZXMgY29weVxuICAgICAgICAvLyBnZW5lcmF0ZSBuZXcgdW5pcXVlIGlkJ3NcbiAgICAgICAgZm9yKGNvbnN0IHAgb2YgbmV3RGF0YSkge1xuICAgICAgICAgIHAuaWQgPSBuZXdJRCgpO1xuICAgICAgICAgIGZvcihjb25zdCBzIG9mIHAuc3BhbnMpIHtcbiAgICAgICAgICAgIHMuaWQgPSBuZXdJRCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb25zdCByID0gZGF0YUluc2VydChkYXRhLCBzdGFydCwgbmV3RGF0YSk7XG4gICAgICAgIC8vIHB1dCBjdXJzb3IgYWZ0ZXIgcGFzdGVkIHRleHRcbiAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4ge1xuICAgICAgICAgIHIuZW5kLm5vZGUgPSBudWxsO1xuICAgICAgICAgIHJlc3RvcmVET01TZWxlY3Rpb24odGhpcy4kcmVmcy5jb250YWluZXIsIGRhdGFQb2ludGVyKGRhdGEsIHIuZW5kKSk7XG4gICAgICAgIH0pO1xuXG4gICAgICB9IGVsc2UgaWYoaHRtbERhdGEubGVuZ3RoID4gMCkge1xuXG4gICAgICAgIGNvbnN0IGh0bWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdodG1sJylcbiAgICAgICAgaHRtbC5pbm5lckhUTUwgPSBodG1sRGF0YTtcblxuICAgICAgICBjb25zdCBzdHlsZSA9IGh0bWwucXVlcnlTZWxlY3RvcignaGVhZCA+IHN0eWxlJyk7XG4gICAgICAgIC8vIGNvbnN0IHN0eWxlVGV4dCA9IHN0eWxlLnRleHRDb250ZW50O1xuICAgICAgICAvLyBjb25zb2xlLmRlYnVnKHN0eWxlVGV4dClcbiAgICAgICAgLy8gY29uc29sZS5kaXIoaHRtbC5xdWVyeVNlbGVjdG9yKCdoZWFkID4gc3R5bGUnKSlcblxuICAgICAgICAvLyBwYXJzZSBzdHlsZVxuICAgICAgICBpZihzdHlsZSkge1xuICAgICAgICAgIGxldCBkb2MgPSBkb2N1bWVudC5pbXBsZW1lbnRhdGlvbi5jcmVhdGVIVE1MRG9jdW1lbnQoXCJcIik7XG4gICAgICAgICAgZG9jLmJvZHkuYXBwZW5kQ2hpbGQoc3R5bGUpO1xuICAgICAgICAgIC8vIGNvbnNvbGUuZGVidWcoJ1NIRUVUJywgc3R5bGUuc2hlZXQpXG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBib2R5ID0gaHRtbC5xdWVyeVNlbGVjdG9yKCdib2R5Jyk7XG5cbiAgICAgICAgLy8gY29uc29sZS5kZWJ1Zyhib2R5KVxuXG4gICAgICAgIC8vIHBhcnNlIERPTSBoZXJlIHdpdGggZm9ybWF0dGluZ1xuICAgICAgICBjb25zdCBuZXdEYXRhID0gcGFyc2VWYW5pbGxhRE9NKGJvZHksIHN0eWxlICYmIHN0eWxlLnNoZWV0LmNzc1J1bGVzKTtcblxuICAgICAgICAvLyBjb25zb2xlLmRlYnVnKEpTT04uc3RyaW5naWZ5KG5ld0RhdGEsIHVuZGVmaW5lZCwgMikpXG5cbiAgICAgICAgLy8gZ2VuZXJhdGUgbmV3IHVuaXF1ZSBpZCdzXG4gICAgICAgIGZvcihjb25zdCBwIG9mIG5ld0RhdGEpIHtcbiAgICAgICAgICBwLmlkID0gbmV3SUQoKTtcbiAgICAgICAgICBmb3IoY29uc3QgcyBvZiBwLnNwYW5zKSB7XG4gICAgICAgICAgICBzLmlkID0gbmV3SUQoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjb25zb2xlLmRlYnVnKCdwYXN0aW5nIGZvcm1hdHRlZCB0ZXh0IGZyb20gaHRtbCBzb3VyY2UnKTtcbiAgICAgICAgY29uc3QgciA9IGRhdGFJbnNlcnQoZGF0YSwgc3RhcnQsIG5ld0RhdGEpO1xuXG4gICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHtcbiAgICAgICAgICByLmVuZC5ub2RlID0gbnVsbDtcbiAgICAgICAgICByZXN0b3JlRE9NU2VsZWN0aW9uKHRoaXMuJHJlZnMuY29udGFpbmVyLCBkYXRhUG9pbnRlcihkYXRhLCByLmVuZCkpO1xuICAgICAgICB9KTtcblxuICAgICAgfSBlbHNlIGlmKHRleHREYXRhLmxlbmd0aCA+IDApIHtcblxuICAgICAgICBjb25zb2xlLmRlYnVnKCdwYXN0aW5nIHBsYWludGV4dCcpO1xuICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7XG4gICAgICAgICAgaWYoc3RhcnQucGFyYWdyYXBoSW5kZXggIT09IHVuZGVmaW5lZCB8fCBzdGFydC5wYXJhZ3JhcGhJRCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXN0b3JlRE9NU2VsZWN0aW9uKHRoaXMuJHJlZnMuY29udGFpbmVyLCBkYXRhUG9pbnRlcihkYXRhLCBzdGFydCkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBuZXdEYXRhID0gW107XG4gICAgICAgICAgY29uc3QgbGluZXMgPSB0ZXh0RGF0YS5zcGxpdCgnXFxuJyk7XG4gICAgICAgICAgZm9yKGNvbnN0IGxpbmUgb2YgbGluZXMpIHtcbiAgICAgICAgICAgIG5ld0RhdGEucHVzaCh7IGlkOiBuZXdJRCgpLCBzcGFuczogW3sgaWQ6IG5ld0lEKCksIHRleHQ6IGxpbmUsIGZvcm1hdDoge30gfV0gfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGxldCBlbmQ7XG4gICAgICAgICAgaWYobmV3RGF0YS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIGRhdGEuc3BsaWNlLmFwcGx5KGRhdGEsIFswLCAwXS5jb25jYXQobmV3RGF0YSkpO1xuICAgICAgICAgICAgZW5kID0geyBwYXJhZ3JhcGhJRDogbmV3RGF0YVtuZXdEYXRhLmxlbmd0aCAtIDFdLmlkLCBzcGFuSUQ6IG5ld0RhdGFbbmV3RGF0YS5sZW5ndGggLSAxXS5zcGFuc1swXS5pZCwgb2Zmc2V0OiBuZXdEYXRhW25ld0RhdGEubGVuZ3RoIC0gMV0uc3BhbnNbMF0udGV4dC5sZW5ndGggfTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgciA9IGRhdGFJbnNlcnQoZGF0YSwgc3RhcnQsIG5ld0RhdGEpO1xuICAgICAgICAgICAgZW5kID0gci5lbmQ7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8vIHB1dCBjdXJzb3IgYWZ0ZXIgcGFzdGVkIHRleHRcbiAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7XG4gICAgICAgICAgICBlbmQubm9kZSA9IG51bGw7XG4gICAgICAgICAgICByZXN0b3JlRE9NU2VsZWN0aW9uKHRoaXMuJHJlZnMuY29udGFpbmVyLCBkYXRhUG9pbnRlcihkYXRhLCBlbmQpKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICAvLyBkb2N1bWVudC5leGVjQ29tbWFuZChcImluc2VydEhUTUxcIiwgZmFsc2UsIHRleHREYXRhKTsgICAvLyBOT1RFOiB0ZXh0IGlzIG5vdCBzcGxpdHRlZCBpbnRvIHByb3BlciBwYXJhZ3JhcGhzIGF0IG5ld2xpbmVzXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICBvbkN1dChlKSB7XG4gICAgICAvLyBjb25zb2xlLmRlYnVnKCdlZGl0YWJsZS1zcGFucyBjdXQnLCBlKTtcbiAgICAgIC8vIHRoaXMgcHJldmVudHMgY3V0dGluZyB3aXRoIHNlbGVjdGluZyBjdXQgbWVudSBpdGVtLCBrZXlib2FyZCBzaG9ydGN1dHMgZ2V0IHByZXZlbnRlZCBpbiBrZXlkb3duIGV2ZW50IGhhbmRsZXJcbiAgICAgIHRoaXMub25Db3B5KGUpO1xuICAgICAgLy8gZGVsZXRlIHNlbGVjdGlvblxuICAgICAgY29uc3Qgc2VsZWN0aW9uID0gbm9ybWFsaXplZERPTVNlbGVjdGlvbigpO1xuICAgICAgaWYoIXNlbGVjdGlvbi5jb2xsYXBzZWQpIHtcbiAgICAgICAgY29uc3QgZGF0YSA9IHRoaXMucGFyYWdyYXBocztcbiAgICAgICAgY29uc3Qgc3RhcnQgPSBzZWxlY3Rpb24uc3RhcnQ7XG4gICAgICAgIGRhdGFQb2ludGVyKGRhdGEsIHN0YXJ0KTtcbiAgICAgICAgY29uc3QgZW5kID0gc2VsZWN0aW9uLmVuZDtcbiAgICAgICAgZGF0YVBvaW50ZXIoZGF0YSwgZW5kKTtcbiAgICAgICAgY29uc3QgciA9IGRhdGFTcGxpY2UoZGF0YSwgc3RhcnQsIGVuZCk7XG4gICAgICB9XG4gICAgfSxcblxuICAgIG9uQ29weShlKSB7XG4gICAgICAvLyBjb25zb2xlLmRlYnVnKCdlZGl0YWJsZS1zcGFucyBjb3B5JywgZSk7XG4gICAgICBjb25zdCBkYXRhID0gdGhpcy5wYXJhZ3JhcGhzO1xuICAgICAgY29uc3Qgc2VsZWN0aW9uID0gbm9ybWFsaXplZERPTVNlbGVjdGlvbigpO1xuICAgICAgaWYoIXNlbGVjdGlvbi5pc0NvbGxhcHNlZCkge1xuXG4gICAgICAgIGNvbnN0IHN0YXJ0ID0gc2VsZWN0aW9uLnN0YXJ0O1xuICAgICAgICBkYXRhUG9pbnRlcihkYXRhLCBzdGFydCk7XG4gICAgICAgIGNvbnN0IGVuZCA9IHNlbGVjdGlvbi5lbmQ7XG4gICAgICAgIGRhdGFQb2ludGVyKGRhdGEsIGVuZCk7XG5cblxuICAgICAgICBjb25zdCByID0gZGF0YVNwbGljZShkYXRhLCBzdGFydCwgZW5kLCBTcGxpY2VNb2RlLkNvcHkpO1xuXG4gICAgICAgIC8vIGNvcHkgYXMgcnV0YSBpbnRlcm5hbCBmb3JtYXRcbiAgICAgICAgZS5jbGlwYm9hcmREYXRhLnNldERhdGEoJ2FwcGxpY2F0aW9uL3J1dGEnLCBKU09OLnN0cmluZ2lmeShyKSk7XG4gICAgICAgIC8vIGUuY2xpcGJvYXJkRGF0YS5zZXREYXRhKCdhcHBsaWNhdGlvbi9ydXRhJywgSlNPTi5zdHJpbmdpZnkociwgdW5kZWZpbmVkLCAyKSk7XG5cbiAgICAgICAgLy8gY29weSBwbGFpbnRleHRcbiAgICAgICAgY29uc3QgcGFyYWdyYXBocyA9IFtdO1xuICAgICAgICBmb3IoY29uc3QgcCBvZiByKSB7XG4gICAgICAgICAgY29uc3Qgc3BhbnMgPSBbXTtcbiAgICAgICAgICBmb3IoY29uc3QgcyBvZiBwLnNwYW5zKSB7XG4gICAgICAgICAgICBzcGFucy5wdXNoKHMudGV4dCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHBhcmFncmFwaHMucHVzaChzcGFucy5qb2luKCcnKSk7XG4gICAgICAgIH1cbiAgICAgICAgZS5jbGlwYm9hcmREYXRhLnNldERhdGEoJ3RleHQvcGxhaW4nLCBwYXJhZ3JhcGhzLmpvaW4oJ1xcbicpKTtcblxuICAgICAgICAvLyBjb3B5IGFzIEhUTUxcbiAgICAgICAgLy8gY29uc29sZS5kZWJ1ZygnQ09QWSBIVE1MJywgdGhpcy5hc0hUTUwocikpO1xuICAgICAgICBlLmNsaXBib2FyZERhdGEuc2V0RGF0YSgndGV4dC9odG1sJywgdGhpcy5hc0hUTUwocikpO1xuICAgICAgfVxuXG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgLy8gdGhpcyBwcmV2ZW50cyBjdXR0aW5nIHdpdGggc2VsZWN0aW5nIGN1dCBtZW51IGl0ZW0sIGtleWJvYXJkIHNob3J0Y3V0cyBnZXQgcHJldmVudGVkIGluIGtleWRvd24gZXZlbnQgaGFuZGxlclxuICAgIH0sXG4gIH0sXG5cbiAgZXJyb3JDYXB0dXJlZChlcnIsIGluc3RhbmNlLCBpbmZvKSB7XG4gICAgY29uc29sZS5kZWJ1ZygnRURJVE9SIEVSUk9SIENBUFRVUkVEJywgZXJyLCBpbnN0YW5jZSwgaW5mbyk7XG4gICAgcmV0dXJuIHRydWU7XG4gIH0sXG59O1xuPC9zY3JpcHQ+XG5cblxuPHN0eWxlIHNjb3BlZD5cbi50cmFuc2NyaXB0IHtcbiAgZm9udC1zaXplOiAyMHB4O1xuICBjb2xvcjogIzc3Nztcbn1cbnNwYW4uc2VsZWN0ZWQge1xuICBjb2xvcjogIzAwMDtcbiAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgyNTMsIDI0OSwgMTIsIDAuNTApO1xufVxuc3Bhbi5oaWdobGlnaHRlZCB7XG4gIGJhY2tncm91bmQtY29sb3I6IHllbGxvdztcbn1cbnNwYW4ucGFzdCB7XG4gIGNvbG9yOiAjMjIyO1xufVxuLm5vc2VsZWN0IHtcbiAgLXdlYmtpdC10b3VjaC1jYWxsb3V0OiBub25lOyAvKiBpT1MgU2FmYXJpICovXG4gICAgLXdlYmtpdC11c2VyLXNlbGVjdDogbm9uZTsgLyogU2FmYXJpICovXG4gICAgIC1raHRtbC11c2VyLXNlbGVjdDogbm9uZTsgLyogS29ucXVlcm9yIEhUTUwgKi9cbiAgICAgICAtbW96LXVzZXItc2VsZWN0OiBub25lOyAvKiBPbGQgdmVyc2lvbnMgb2YgRmlyZWZveCAqL1xuICAgICAgICAtbXMtdXNlci1zZWxlY3Q6IG5vbmU7IC8qIEludGVybmV0IEV4cGxvcmVyL0VkZ2UgKi9cbiAgICAgICAgICAgIHVzZXItc2VsZWN0OiBub25lOyAvKiBOb24tcHJlZml4ZWQgdmVyc2lvbiwgY3VycmVudGx5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VwcG9ydGVkIGJ5IENocm9tZSwgRWRnZSwgT3BlcmEgYW5kIEZpcmVmb3ggKi9cbn1cbi5saXN0LWl0ZW06OmJlZm9yZSB7XG4gIGNvbnRlbnQ6IFwiXFwyMDIyXCI7ICAvKiBBZGQgY29udGVudDogXFwyMDIyIGlzIHRoZSBDU1MgQ29kZS91bmljb2RlIGZvciBhIGJ1bGxldCAqL1xuICBjb2xvcjogYmxhY2s7IC8qIENoYW5nZSB0aGUgY29sb3IgKi9cbiAgZm9udC13ZWlnaHQ6IGJvbGQ7IC8qIElmIHlvdSB3YW50IGl0IHRvIGJlIGJvbGQgKi9cbiAgZGlzcGxheTogaW5saW5lLWJsb2NrOyAvKiBOZWVkZWQgdG8gYWRkIHNwYWNlIGJldHdlZW4gdGhlIGJ1bGxldCBhbmQgdGhlIHRleHQgKi9cbiAgd2lkdGg6IDFlbTsgLyogQWxzbyBuZWVkZWQgZm9yIHNwYWNlICh0d2VhayBpZiBuZWVkZWQpICovXG4gIG1hcmdpbi1sZWZ0OiAtMWVtOyAvKiBBbHNvIG5lZWRlZCBmb3Igc3BhY2UgKHR3ZWFrIGlmIG5lZWRlZCkgKi9cbiAgbWFyZ2luLWxlZnQ6IDIwcHg7XG4gIC8qIGJvcmRlcjogMXB4IHNvbGlkIGdyZWVuOyAqL1xufVxuLnBhcmFncmFwaCB7XG4gIHBhZGRpbmctYm90dG9tOiAxMHB4O1xuICBtaW4taGVpZ2h0OiA0MHB4O1xufVxuLnBhcmFncmFwaC1udW1iZXIge1xuICBmbG9hdDogbGVmdDtcbn1cbnNwYW4uYm9sZCB7XG4gIGZvbnQtd2VpZ2h0OiBib2xkO1xufVxuc3Bhbi5pdGFsaWMge1xuICBmb250LXN0eWxlOiBpdGFsaWM7XG59XG5zcGFuLnVuZGVybGluZSB7XG4gIHRleHQtZGVjb3JhdGlvbjogdW5kZXJsaW5lO1xufVxuLyogaHR0cHM6Ly9jc3MtdHJpY2tzLmNvbS9zbmlwcGV0cy9jc3MvcHJldmVudC1zdXBlcnNjcmlwdHMtYW5kLXN1YnNjcmlwdHMtZnJvbS1hZmZlY3RpbmctbGluZS1oZWlnaHQvICovXG5zcGFuLnN1cGVyc2NyaXB0IHtcbiAgdmVydGljYWwtYWxpZ246IHN1cGVyO1xuICBmb250LXNpemU6IDgwJTtcblxuICB2ZXJ0aWNhbC1hbGlnbjogYmFzZWxpbmU7XG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgdG9wOiAtMC40ZW07XG4gIGxpbmUtaGVpZ2h0OiAwO1xufVxuc3Bhbi5zdWJzY3JpcHQge1xuICB2ZXJ0aWNhbC1hbGlnbjogc3ViO1xuICBmb250LXNpemU6IDgwJTtcblxuICB2ZXJ0aWNhbC1hbGlnbjogYmFzZWxpbmU7XG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgdG9wOiAwLjRlbTtcbiAgbGluZS1oZWlnaHQ6IDA7XG59XG5zcGFuLnRva2VuLnBzZXVkbzo6YWZ0ZXIge1xuICBjb250ZW50OiBcIlxcMGEwXCI7XG4gIGRpc3BsYXk6IGlubGluZTtcbn1cbjwvc3R5bGU+XG4iLCJ2YXIgbm9vcCA9IHt2YWx1ZTogKCkgPT4ge319O1xuXG5mdW5jdGlvbiBkaXNwYXRjaCgpIHtcbiAgZm9yICh2YXIgaSA9IDAsIG4gPSBhcmd1bWVudHMubGVuZ3RoLCBfID0ge30sIHQ7IGkgPCBuOyArK2kpIHtcbiAgICBpZiAoISh0ID0gYXJndW1lbnRzW2ldICsgXCJcIikgfHwgKHQgaW4gXykgfHwgL1tcXHMuXS8udGVzdCh0KSkgdGhyb3cgbmV3IEVycm9yKFwiaWxsZWdhbCB0eXBlOiBcIiArIHQpO1xuICAgIF9bdF0gPSBbXTtcbiAgfVxuICByZXR1cm4gbmV3IERpc3BhdGNoKF8pO1xufVxuXG5mdW5jdGlvbiBEaXNwYXRjaChfKSB7XG4gIHRoaXMuXyA9IF87XG59XG5cbmZ1bmN0aW9uIHBhcnNlVHlwZW5hbWVzKHR5cGVuYW1lcywgdHlwZXMpIHtcbiAgcmV0dXJuIHR5cGVuYW1lcy50cmltKCkuc3BsaXQoL158XFxzKy8pLm1hcChmdW5jdGlvbih0KSB7XG4gICAgdmFyIG5hbWUgPSBcIlwiLCBpID0gdC5pbmRleE9mKFwiLlwiKTtcbiAgICBpZiAoaSA+PSAwKSBuYW1lID0gdC5zbGljZShpICsgMSksIHQgPSB0LnNsaWNlKDAsIGkpO1xuICAgIGlmICh0ICYmICF0eXBlcy5oYXNPd25Qcm9wZXJ0eSh0KSkgdGhyb3cgbmV3IEVycm9yKFwidW5rbm93biB0eXBlOiBcIiArIHQpO1xuICAgIHJldHVybiB7dHlwZTogdCwgbmFtZTogbmFtZX07XG4gIH0pO1xufVxuXG5EaXNwYXRjaC5wcm90b3R5cGUgPSBkaXNwYXRjaC5wcm90b3R5cGUgPSB7XG4gIGNvbnN0cnVjdG9yOiBEaXNwYXRjaCxcbiAgb246IGZ1bmN0aW9uKHR5cGVuYW1lLCBjYWxsYmFjaykge1xuICAgIHZhciBfID0gdGhpcy5fLFxuICAgICAgICBUID0gcGFyc2VUeXBlbmFtZXModHlwZW5hbWUgKyBcIlwiLCBfKSxcbiAgICAgICAgdCxcbiAgICAgICAgaSA9IC0xLFxuICAgICAgICBuID0gVC5sZW5ndGg7XG5cbiAgICAvLyBJZiBubyBjYWxsYmFjayB3YXMgc3BlY2lmaWVkLCByZXR1cm4gdGhlIGNhbGxiYWNrIG9mIHRoZSBnaXZlbiB0eXBlIGFuZCBuYW1lLlxuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoIDwgMikge1xuICAgICAgd2hpbGUgKCsraSA8IG4pIGlmICgodCA9ICh0eXBlbmFtZSA9IFRbaV0pLnR5cGUpICYmICh0ID0gZ2V0KF9bdF0sIHR5cGVuYW1lLm5hbWUpKSkgcmV0dXJuIHQ7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gSWYgYSB0eXBlIHdhcyBzcGVjaWZpZWQsIHNldCB0aGUgY2FsbGJhY2sgZm9yIHRoZSBnaXZlbiB0eXBlIGFuZCBuYW1lLlxuICAgIC8vIE90aGVyd2lzZSwgaWYgYSBudWxsIGNhbGxiYWNrIHdhcyBzcGVjaWZpZWQsIHJlbW92ZSBjYWxsYmFja3Mgb2YgdGhlIGdpdmVuIG5hbWUuXG4gICAgaWYgKGNhbGxiYWNrICE9IG51bGwgJiYgdHlwZW9mIGNhbGxiYWNrICE9PSBcImZ1bmN0aW9uXCIpIHRocm93IG5ldyBFcnJvcihcImludmFsaWQgY2FsbGJhY2s6IFwiICsgY2FsbGJhY2spO1xuICAgIHdoaWxlICgrK2kgPCBuKSB7XG4gICAgICBpZiAodCA9ICh0eXBlbmFtZSA9IFRbaV0pLnR5cGUpIF9bdF0gPSBzZXQoX1t0XSwgdHlwZW5hbWUubmFtZSwgY2FsbGJhY2spO1xuICAgICAgZWxzZSBpZiAoY2FsbGJhY2sgPT0gbnVsbCkgZm9yICh0IGluIF8pIF9bdF0gPSBzZXQoX1t0XSwgdHlwZW5hbWUubmFtZSwgbnVsbCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH0sXG4gIGNvcHk6IGZ1bmN0aW9uKCkge1xuICAgIHZhciBjb3B5ID0ge30sIF8gPSB0aGlzLl87XG4gICAgZm9yICh2YXIgdCBpbiBfKSBjb3B5W3RdID0gX1t0XS5zbGljZSgpO1xuICAgIHJldHVybiBuZXcgRGlzcGF0Y2goY29weSk7XG4gIH0sXG4gIGNhbGw6IGZ1bmN0aW9uKHR5cGUsIHRoYXQpIHtcbiAgICBpZiAoKG4gPSBhcmd1bWVudHMubGVuZ3RoIC0gMikgPiAwKSBmb3IgKHZhciBhcmdzID0gbmV3IEFycmF5KG4pLCBpID0gMCwgbiwgdDsgaSA8IG47ICsraSkgYXJnc1tpXSA9IGFyZ3VtZW50c1tpICsgMl07XG4gICAgaWYgKCF0aGlzLl8uaGFzT3duUHJvcGVydHkodHlwZSkpIHRocm93IG5ldyBFcnJvcihcInVua25vd24gdHlwZTogXCIgKyB0eXBlKTtcbiAgICBmb3IgKHQgPSB0aGlzLl9bdHlwZV0sIGkgPSAwLCBuID0gdC5sZW5ndGg7IGkgPCBuOyArK2kpIHRbaV0udmFsdWUuYXBwbHkodGhhdCwgYXJncyk7XG4gIH0sXG4gIGFwcGx5OiBmdW5jdGlvbih0eXBlLCB0aGF0LCBhcmdzKSB7XG4gICAgaWYgKCF0aGlzLl8uaGFzT3duUHJvcGVydHkodHlwZSkpIHRocm93IG5ldyBFcnJvcihcInVua25vd24gdHlwZTogXCIgKyB0eXBlKTtcbiAgICBmb3IgKHZhciB0ID0gdGhpcy5fW3R5cGVdLCBpID0gMCwgbiA9IHQubGVuZ3RoOyBpIDwgbjsgKytpKSB0W2ldLnZhbHVlLmFwcGx5KHRoYXQsIGFyZ3MpO1xuICB9XG59O1xuXG5mdW5jdGlvbiBnZXQodHlwZSwgbmFtZSkge1xuICBmb3IgKHZhciBpID0gMCwgbiA9IHR5cGUubGVuZ3RoLCBjOyBpIDwgbjsgKytpKSB7XG4gICAgaWYgKChjID0gdHlwZVtpXSkubmFtZSA9PT0gbmFtZSkge1xuICAgICAgcmV0dXJuIGMudmFsdWU7XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIHNldCh0eXBlLCBuYW1lLCBjYWxsYmFjaykge1xuICBmb3IgKHZhciBpID0gMCwgbiA9IHR5cGUubGVuZ3RoOyBpIDwgbjsgKytpKSB7XG4gICAgaWYgKHR5cGVbaV0ubmFtZSA9PT0gbmFtZSkge1xuICAgICAgdHlwZVtpXSA9IG5vb3AsIHR5cGUgPSB0eXBlLnNsaWNlKDAsIGkpLmNvbmNhdCh0eXBlLnNsaWNlKGkgKyAxKSk7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cbiAgaWYgKGNhbGxiYWNrICE9IG51bGwpIHR5cGUucHVzaCh7bmFtZTogbmFtZSwgdmFsdWU6IGNhbGxiYWNrfSk7XG4gIHJldHVybiB0eXBlO1xufVxuXG5leHBvcnQgZGVmYXVsdCBkaXNwYXRjaDtcbiIsImV4cG9ydCB2YXIgeGh0bWwgPSBcImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWxcIjtcblxuZXhwb3J0IGRlZmF1bHQge1xuICBzdmc6IFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIixcbiAgeGh0bWw6IHhodG1sLFxuICB4bGluazogXCJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rXCIsXG4gIHhtbDogXCJodHRwOi8vd3d3LnczLm9yZy9YTUwvMTk5OC9uYW1lc3BhY2VcIixcbiAgeG1sbnM6IFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC94bWxucy9cIlxufTtcbiIsImltcG9ydCBuYW1lc3BhY2VzIGZyb20gXCIuL25hbWVzcGFjZXMuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24obmFtZSkge1xuICB2YXIgcHJlZml4ID0gbmFtZSArPSBcIlwiLCBpID0gcHJlZml4LmluZGV4T2YoXCI6XCIpO1xuICBpZiAoaSA+PSAwICYmIChwcmVmaXggPSBuYW1lLnNsaWNlKDAsIGkpKSAhPT0gXCJ4bWxuc1wiKSBuYW1lID0gbmFtZS5zbGljZShpICsgMSk7XG4gIHJldHVybiBuYW1lc3BhY2VzLmhhc093blByb3BlcnR5KHByZWZpeCkgPyB7c3BhY2U6IG5hbWVzcGFjZXNbcHJlZml4XSwgbG9jYWw6IG5hbWV9IDogbmFtZTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1wcm90b3R5cGUtYnVpbHRpbnNcbn1cbiIsImltcG9ydCBuYW1lc3BhY2UgZnJvbSBcIi4vbmFtZXNwYWNlLmpzXCI7XG5pbXBvcnQge3hodG1sfSBmcm9tIFwiLi9uYW1lc3BhY2VzLmpzXCI7XG5cbmZ1bmN0aW9uIGNyZWF0b3JJbmhlcml0KG5hbWUpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHZhciBkb2N1bWVudCA9IHRoaXMub3duZXJEb2N1bWVudCxcbiAgICAgICAgdXJpID0gdGhpcy5uYW1lc3BhY2VVUkk7XG4gICAgcmV0dXJuIHVyaSA9PT0geGh0bWwgJiYgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50Lm5hbWVzcGFjZVVSSSA9PT0geGh0bWxcbiAgICAgICAgPyBkb2N1bWVudC5jcmVhdGVFbGVtZW50KG5hbWUpXG4gICAgICAgIDogZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKHVyaSwgbmFtZSk7XG4gIH07XG59XG5cbmZ1bmN0aW9uIGNyZWF0b3JGaXhlZChmdWxsbmFtZSkge1xuICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMub3duZXJEb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoZnVsbG5hbWUuc3BhY2UsIGZ1bGxuYW1lLmxvY2FsKTtcbiAgfTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24obmFtZSkge1xuICB2YXIgZnVsbG5hbWUgPSBuYW1lc3BhY2UobmFtZSk7XG4gIHJldHVybiAoZnVsbG5hbWUubG9jYWxcbiAgICAgID8gY3JlYXRvckZpeGVkXG4gICAgICA6IGNyZWF0b3JJbmhlcml0KShmdWxsbmFtZSk7XG59XG4iLCJmdW5jdGlvbiBub25lKCkge31cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24oc2VsZWN0b3IpIHtcbiAgcmV0dXJuIHNlbGVjdG9yID09IG51bGwgPyBub25lIDogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XG4gIH07XG59XG4iLCIvLyBHaXZlbiBzb21ldGhpbmcgYXJyYXkgbGlrZSAob3IgbnVsbCksIHJldHVybnMgc29tZXRoaW5nIHRoYXQgaXMgc3RyaWN0bHkgYW5cbi8vIGFycmF5LiBUaGlzIGlzIHVzZWQgdG8gZW5zdXJlIHRoYXQgYXJyYXktbGlrZSBvYmplY3RzIHBhc3NlZCB0byBkMy5zZWxlY3RBbGxcbi8vIG9yIHNlbGVjdGlvbi5zZWxlY3RBbGwgYXJlIGNvbnZlcnRlZCBpbnRvIHByb3BlciBhcnJheXMgd2hlbiBjcmVhdGluZyBhXG4vLyBzZWxlY3Rpb247IHdlIGRvbuKAmXQgZXZlciB3YW50IHRvIGNyZWF0ZSBhIHNlbGVjdGlvbiBiYWNrZWQgYnkgYSBsaXZlXG4vLyBIVE1MQ29sbGVjdGlvbiBvciBOb2RlTGlzdC4gSG93ZXZlciwgbm90ZSB0aGF0IHNlbGVjdGlvbi5zZWxlY3RBbGwgd2lsbCB1c2UgYVxuLy8gc3RhdGljIE5vZGVMaXN0IGFzIGEgZ3JvdXAsIHNpbmNlIGl0IHNhZmVseSBkZXJpdmVkIGZyb20gcXVlcnlTZWxlY3RvckFsbC5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGFycmF5KHgpIHtcbiAgcmV0dXJuIHggPT0gbnVsbCA/IFtdIDogQXJyYXkuaXNBcnJheSh4KSA/IHggOiBBcnJheS5mcm9tKHgpO1xufVxuIiwiZnVuY3Rpb24gZW1wdHkoKSB7XG4gIHJldHVybiBbXTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24oc2VsZWN0b3IpIHtcbiAgcmV0dXJuIHNlbGVjdG9yID09IG51bGwgPyBlbXB0eSA6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpO1xuICB9O1xufVxuIiwiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24oc2VsZWN0b3IpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLm1hdGNoZXMoc2VsZWN0b3IpO1xuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY2hpbGRNYXRjaGVyKHNlbGVjdG9yKSB7XG4gIHJldHVybiBmdW5jdGlvbihub2RlKSB7XG4gICAgcmV0dXJuIG5vZGUubWF0Y2hlcyhzZWxlY3Rvcik7XG4gIH07XG59XG5cbiIsImltcG9ydCB7Y2hpbGRNYXRjaGVyfSBmcm9tIFwiLi4vbWF0Y2hlci5qc1wiO1xuXG52YXIgZmluZCA9IEFycmF5LnByb3RvdHlwZS5maW5kO1xuXG5mdW5jdGlvbiBjaGlsZEZpbmQobWF0Y2gpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBmaW5kLmNhbGwodGhpcy5jaGlsZHJlbiwgbWF0Y2gpO1xuICB9O1xufVxuXG5mdW5jdGlvbiBjaGlsZEZpcnN0KCkge1xuICByZXR1cm4gdGhpcy5maXJzdEVsZW1lbnRDaGlsZDtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24obWF0Y2gpIHtcbiAgcmV0dXJuIHRoaXMuc2VsZWN0KG1hdGNoID09IG51bGwgPyBjaGlsZEZpcnN0XG4gICAgICA6IGNoaWxkRmluZCh0eXBlb2YgbWF0Y2ggPT09IFwiZnVuY3Rpb25cIiA/IG1hdGNoIDogY2hpbGRNYXRjaGVyKG1hdGNoKSkpO1xufVxuIiwiaW1wb3J0IHtjaGlsZE1hdGNoZXJ9IGZyb20gXCIuLi9tYXRjaGVyLmpzXCI7XG5cbnZhciBmaWx0ZXIgPSBBcnJheS5wcm90b3R5cGUuZmlsdGVyO1xuXG5mdW5jdGlvbiBjaGlsZHJlbigpIHtcbiAgcmV0dXJuIEFycmF5LmZyb20odGhpcy5jaGlsZHJlbik7XG59XG5cbmZ1bmN0aW9uIGNoaWxkcmVuRmlsdGVyKG1hdGNoKSB7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gZmlsdGVyLmNhbGwodGhpcy5jaGlsZHJlbiwgbWF0Y2gpO1xuICB9O1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbihtYXRjaCkge1xuICByZXR1cm4gdGhpcy5zZWxlY3RBbGwobWF0Y2ggPT0gbnVsbCA/IGNoaWxkcmVuXG4gICAgICA6IGNoaWxkcmVuRmlsdGVyKHR5cGVvZiBtYXRjaCA9PT0gXCJmdW5jdGlvblwiID8gbWF0Y2ggOiBjaGlsZE1hdGNoZXIobWF0Y2gpKSk7XG59XG4iLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbih1cGRhdGUpIHtcbiAgcmV0dXJuIG5ldyBBcnJheSh1cGRhdGUubGVuZ3RoKTtcbn1cbiIsImltcG9ydCBzcGFyc2UgZnJvbSBcIi4vc3BhcnNlLmpzXCI7XG5pbXBvcnQge1NlbGVjdGlvbn0gZnJvbSBcIi4vaW5kZXguanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24oKSB7XG4gIHJldHVybiBuZXcgU2VsZWN0aW9uKHRoaXMuX2VudGVyIHx8IHRoaXMuX2dyb3Vwcy5tYXAoc3BhcnNlKSwgdGhpcy5fcGFyZW50cyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBFbnRlck5vZGUocGFyZW50LCBkYXR1bSkge1xuICB0aGlzLm93bmVyRG9jdW1lbnQgPSBwYXJlbnQub3duZXJEb2N1bWVudDtcbiAgdGhpcy5uYW1lc3BhY2VVUkkgPSBwYXJlbnQubmFtZXNwYWNlVVJJO1xuICB0aGlzLl9uZXh0ID0gbnVsbDtcbiAgdGhpcy5fcGFyZW50ID0gcGFyZW50O1xuICB0aGlzLl9fZGF0YV9fID0gZGF0dW07XG59XG5cbkVudGVyTm9kZS5wcm90b3R5cGUgPSB7XG4gIGNvbnN0cnVjdG9yOiBFbnRlck5vZGUsXG4gIGFwcGVuZENoaWxkOiBmdW5jdGlvbihjaGlsZCkgeyByZXR1cm4gdGhpcy5fcGFyZW50Lmluc2VydEJlZm9yZShjaGlsZCwgdGhpcy5fbmV4dCk7IH0sXG4gIGluc2VydEJlZm9yZTogZnVuY3Rpb24oY2hpbGQsIG5leHQpIHsgcmV0dXJuIHRoaXMuX3BhcmVudC5pbnNlcnRCZWZvcmUoY2hpbGQsIG5leHQpOyB9LFxuICBxdWVyeVNlbGVjdG9yOiBmdW5jdGlvbihzZWxlY3RvcikgeyByZXR1cm4gdGhpcy5fcGFyZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpOyB9LFxuICBxdWVyeVNlbGVjdG9yQWxsOiBmdW5jdGlvbihzZWxlY3RvcikgeyByZXR1cm4gdGhpcy5fcGFyZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpOyB9XG59O1xuIiwiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24oeCkge1xuICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHg7XG4gIH07XG59XG4iLCJpbXBvcnQge1NlbGVjdGlvbn0gZnJvbSBcIi4vaW5kZXguanNcIjtcbmltcG9ydCB7RW50ZXJOb2RlfSBmcm9tIFwiLi9lbnRlci5qc1wiO1xuaW1wb3J0IGNvbnN0YW50IGZyb20gXCIuLi9jb25zdGFudC5qc1wiO1xuXG5mdW5jdGlvbiBiaW5kSW5kZXgocGFyZW50LCBncm91cCwgZW50ZXIsIHVwZGF0ZSwgZXhpdCwgZGF0YSkge1xuICB2YXIgaSA9IDAsXG4gICAgICBub2RlLFxuICAgICAgZ3JvdXBMZW5ndGggPSBncm91cC5sZW5ndGgsXG4gICAgICBkYXRhTGVuZ3RoID0gZGF0YS5sZW5ndGg7XG5cbiAgLy8gUHV0IGFueSBub24tbnVsbCBub2RlcyB0aGF0IGZpdCBpbnRvIHVwZGF0ZS5cbiAgLy8gUHV0IGFueSBudWxsIG5vZGVzIGludG8gZW50ZXIuXG4gIC8vIFB1dCBhbnkgcmVtYWluaW5nIGRhdGEgaW50byBlbnRlci5cbiAgZm9yICg7IGkgPCBkYXRhTGVuZ3RoOyArK2kpIHtcbiAgICBpZiAobm9kZSA9IGdyb3VwW2ldKSB7XG4gICAgICBub2RlLl9fZGF0YV9fID0gZGF0YVtpXTtcbiAgICAgIHVwZGF0ZVtpXSA9IG5vZGU7XG4gICAgfSBlbHNlIHtcbiAgICAgIGVudGVyW2ldID0gbmV3IEVudGVyTm9kZShwYXJlbnQsIGRhdGFbaV0pO1xuICAgIH1cbiAgfVxuXG4gIC8vIFB1dCBhbnkgbm9uLW51bGwgbm9kZXMgdGhhdCBkb27igJl0IGZpdCBpbnRvIGV4aXQuXG4gIGZvciAoOyBpIDwgZ3JvdXBMZW5ndGg7ICsraSkge1xuICAgIGlmIChub2RlID0gZ3JvdXBbaV0pIHtcbiAgICAgIGV4aXRbaV0gPSBub2RlO1xuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBiaW5kS2V5KHBhcmVudCwgZ3JvdXAsIGVudGVyLCB1cGRhdGUsIGV4aXQsIGRhdGEsIGtleSkge1xuICB2YXIgaSxcbiAgICAgIG5vZGUsXG4gICAgICBub2RlQnlLZXlWYWx1ZSA9IG5ldyBNYXAsXG4gICAgICBncm91cExlbmd0aCA9IGdyb3VwLmxlbmd0aCxcbiAgICAgIGRhdGFMZW5ndGggPSBkYXRhLmxlbmd0aCxcbiAgICAgIGtleVZhbHVlcyA9IG5ldyBBcnJheShncm91cExlbmd0aCksXG4gICAgICBrZXlWYWx1ZTtcblxuICAvLyBDb21wdXRlIHRoZSBrZXkgZm9yIGVhY2ggbm9kZS5cbiAgLy8gSWYgbXVsdGlwbGUgbm9kZXMgaGF2ZSB0aGUgc2FtZSBrZXksIHRoZSBkdXBsaWNhdGVzIGFyZSBhZGRlZCB0byBleGl0LlxuICBmb3IgKGkgPSAwOyBpIDwgZ3JvdXBMZW5ndGg7ICsraSkge1xuICAgIGlmIChub2RlID0gZ3JvdXBbaV0pIHtcbiAgICAgIGtleVZhbHVlc1tpXSA9IGtleVZhbHVlID0ga2V5LmNhbGwobm9kZSwgbm9kZS5fX2RhdGFfXywgaSwgZ3JvdXApICsgXCJcIjtcbiAgICAgIGlmIChub2RlQnlLZXlWYWx1ZS5oYXMoa2V5VmFsdWUpKSB7XG4gICAgICAgIGV4aXRbaV0gPSBub2RlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbm9kZUJ5S2V5VmFsdWUuc2V0KGtleVZhbHVlLCBub2RlKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBDb21wdXRlIHRoZSBrZXkgZm9yIGVhY2ggZGF0dW0uXG4gIC8vIElmIHRoZXJlIGEgbm9kZSBhc3NvY2lhdGVkIHdpdGggdGhpcyBrZXksIGpvaW4gYW5kIGFkZCBpdCB0byB1cGRhdGUuXG4gIC8vIElmIHRoZXJlIGlzIG5vdCAob3IgdGhlIGtleSBpcyBhIGR1cGxpY2F0ZSksIGFkZCBpdCB0byBlbnRlci5cbiAgZm9yIChpID0gMDsgaSA8IGRhdGFMZW5ndGg7ICsraSkge1xuICAgIGtleVZhbHVlID0ga2V5LmNhbGwocGFyZW50LCBkYXRhW2ldLCBpLCBkYXRhKSArIFwiXCI7XG4gICAgaWYgKG5vZGUgPSBub2RlQnlLZXlWYWx1ZS5nZXQoa2V5VmFsdWUpKSB7XG4gICAgICB1cGRhdGVbaV0gPSBub2RlO1xuICAgICAgbm9kZS5fX2RhdGFfXyA9IGRhdGFbaV07XG4gICAgICBub2RlQnlLZXlWYWx1ZS5kZWxldGUoa2V5VmFsdWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICBlbnRlcltpXSA9IG5ldyBFbnRlck5vZGUocGFyZW50LCBkYXRhW2ldKTtcbiAgICB9XG4gIH1cblxuICAvLyBBZGQgYW55IHJlbWFpbmluZyBub2RlcyB0aGF0IHdlcmUgbm90IGJvdW5kIHRvIGRhdGEgdG8gZXhpdC5cbiAgZm9yIChpID0gMDsgaSA8IGdyb3VwTGVuZ3RoOyArK2kpIHtcbiAgICBpZiAoKG5vZGUgPSBncm91cFtpXSkgJiYgKG5vZGVCeUtleVZhbHVlLmdldChrZXlWYWx1ZXNbaV0pID09PSBub2RlKSkge1xuICAgICAgZXhpdFtpXSA9IG5vZGU7XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIGRhdHVtKG5vZGUpIHtcbiAgcmV0dXJuIG5vZGUuX19kYXRhX187XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKHZhbHVlLCBrZXkpIHtcbiAgaWYgKCFhcmd1bWVudHMubGVuZ3RoKSByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLCBkYXR1bSk7XG5cbiAgdmFyIGJpbmQgPSBrZXkgPyBiaW5kS2V5IDogYmluZEluZGV4LFxuICAgICAgcGFyZW50cyA9IHRoaXMuX3BhcmVudHMsXG4gICAgICBncm91cHMgPSB0aGlzLl9ncm91cHM7XG5cbiAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gXCJmdW5jdGlvblwiKSB2YWx1ZSA9IGNvbnN0YW50KHZhbHVlKTtcblxuICBmb3IgKHZhciBtID0gZ3JvdXBzLmxlbmd0aCwgdXBkYXRlID0gbmV3IEFycmF5KG0pLCBlbnRlciA9IG5ldyBBcnJheShtKSwgZXhpdCA9IG5ldyBBcnJheShtKSwgaiA9IDA7IGogPCBtOyArK2opIHtcbiAgICB2YXIgcGFyZW50ID0gcGFyZW50c1tqXSxcbiAgICAgICAgZ3JvdXAgPSBncm91cHNbal0sXG4gICAgICAgIGdyb3VwTGVuZ3RoID0gZ3JvdXAubGVuZ3RoLFxuICAgICAgICBkYXRhID0gYXJyYXlsaWtlKHZhbHVlLmNhbGwocGFyZW50LCBwYXJlbnQgJiYgcGFyZW50Ll9fZGF0YV9fLCBqLCBwYXJlbnRzKSksXG4gICAgICAgIGRhdGFMZW5ndGggPSBkYXRhLmxlbmd0aCxcbiAgICAgICAgZW50ZXJHcm91cCA9IGVudGVyW2pdID0gbmV3IEFycmF5KGRhdGFMZW5ndGgpLFxuICAgICAgICB1cGRhdGVHcm91cCA9IHVwZGF0ZVtqXSA9IG5ldyBBcnJheShkYXRhTGVuZ3RoKSxcbiAgICAgICAgZXhpdEdyb3VwID0gZXhpdFtqXSA9IG5ldyBBcnJheShncm91cExlbmd0aCk7XG5cbiAgICBiaW5kKHBhcmVudCwgZ3JvdXAsIGVudGVyR3JvdXAsIHVwZGF0ZUdyb3VwLCBleGl0R3JvdXAsIGRhdGEsIGtleSk7XG5cbiAgICAvLyBOb3cgY29ubmVjdCB0aGUgZW50ZXIgbm9kZXMgdG8gdGhlaXIgZm9sbG93aW5nIHVwZGF0ZSBub2RlLCBzdWNoIHRoYXRcbiAgICAvLyBhcHBlbmRDaGlsZCBjYW4gaW5zZXJ0IHRoZSBtYXRlcmlhbGl6ZWQgZW50ZXIgbm9kZSBiZWZvcmUgdGhpcyBub2RlLFxuICAgIC8vIHJhdGhlciB0aGFuIGF0IHRoZSBlbmQgb2YgdGhlIHBhcmVudCBub2RlLlxuICAgIGZvciAodmFyIGkwID0gMCwgaTEgPSAwLCBwcmV2aW91cywgbmV4dDsgaTAgPCBkYXRhTGVuZ3RoOyArK2kwKSB7XG4gICAgICBpZiAocHJldmlvdXMgPSBlbnRlckdyb3VwW2kwXSkge1xuICAgICAgICBpZiAoaTAgPj0gaTEpIGkxID0gaTAgKyAxO1xuICAgICAgICB3aGlsZSAoIShuZXh0ID0gdXBkYXRlR3JvdXBbaTFdKSAmJiArK2kxIDwgZGF0YUxlbmd0aCk7XG4gICAgICAgIHByZXZpb3VzLl9uZXh0ID0gbmV4dCB8fCBudWxsO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHVwZGF0ZSA9IG5ldyBTZWxlY3Rpb24odXBkYXRlLCBwYXJlbnRzKTtcbiAgdXBkYXRlLl9lbnRlciA9IGVudGVyO1xuICB1cGRhdGUuX2V4aXQgPSBleGl0O1xuICByZXR1cm4gdXBkYXRlO1xufVxuXG4vLyBHaXZlbiBzb21lIGRhdGEsIHRoaXMgcmV0dXJucyBhbiBhcnJheS1saWtlIHZpZXcgb2YgaXQ6IGFuIG9iamVjdCB0aGF0XG4vLyBleHBvc2VzIGEgbGVuZ3RoIHByb3BlcnR5IGFuZCBhbGxvd3MgbnVtZXJpYyBpbmRleGluZy4gTm90ZSB0aGF0IHVubGlrZVxuLy8gc2VsZWN0QWxsLCB0aGlzIGlzbuKAmXQgd29ycmllZCBhYm91dCDigJxsaXZl4oCdIGNvbGxlY3Rpb25zIGJlY2F1c2UgdGhlIHJlc3VsdGluZ1xuLy8gYXJyYXkgd2lsbCBvbmx5IGJlIHVzZWQgYnJpZWZseSB3aGlsZSBkYXRhIGlzIGJlaW5nIGJvdW5kLiAoSXQgaXMgcG9zc2libGUgdG9cbi8vIGNhdXNlIHRoZSBkYXRhIHRvIGNoYW5nZSB3aGlsZSBpdGVyYXRpbmcgYnkgdXNpbmcgYSBrZXkgZnVuY3Rpb24sIGJ1dCBwbGVhc2Vcbi8vIGRvbuKAmXQ7IHdl4oCZZCByYXRoZXIgYXZvaWQgYSBncmF0dWl0b3VzIGNvcHkuKVxuZnVuY3Rpb24gYXJyYXlsaWtlKGRhdGEpIHtcbiAgcmV0dXJuIHR5cGVvZiBkYXRhID09PSBcIm9iamVjdFwiICYmIFwibGVuZ3RoXCIgaW4gZGF0YVxuICAgID8gZGF0YSAvLyBBcnJheSwgVHlwZWRBcnJheSwgTm9kZUxpc3QsIGFycmF5LWxpa2VcbiAgICA6IEFycmF5LmZyb20oZGF0YSk7IC8vIE1hcCwgU2V0LCBpdGVyYWJsZSwgc3RyaW5nLCBvciBhbnl0aGluZyBlbHNlXG59XG4iLCJpbXBvcnQge1NlbGVjdGlvbn0gZnJvbSBcIi4vaW5kZXguanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24oY29tcGFyZSkge1xuICBpZiAoIWNvbXBhcmUpIGNvbXBhcmUgPSBhc2NlbmRpbmc7XG5cbiAgZnVuY3Rpb24gY29tcGFyZU5vZGUoYSwgYikge1xuICAgIHJldHVybiBhICYmIGIgPyBjb21wYXJlKGEuX19kYXRhX18sIGIuX19kYXRhX18pIDogIWEgLSAhYjtcbiAgfVxuXG4gIGZvciAodmFyIGdyb3VwcyA9IHRoaXMuX2dyb3VwcywgbSA9IGdyb3Vwcy5sZW5ndGgsIHNvcnRncm91cHMgPSBuZXcgQXJyYXkobSksIGogPSAwOyBqIDwgbTsgKytqKSB7XG4gICAgZm9yICh2YXIgZ3JvdXAgPSBncm91cHNbal0sIG4gPSBncm91cC5sZW5ndGgsIHNvcnRncm91cCA9IHNvcnRncm91cHNbal0gPSBuZXcgQXJyYXkobiksIG5vZGUsIGkgPSAwOyBpIDwgbjsgKytpKSB7XG4gICAgICBpZiAobm9kZSA9IGdyb3VwW2ldKSB7XG4gICAgICAgIHNvcnRncm91cFtpXSA9IG5vZGU7XG4gICAgICB9XG4gICAgfVxuICAgIHNvcnRncm91cC5zb3J0KGNvbXBhcmVOb2RlKTtcbiAgfVxuXG4gIHJldHVybiBuZXcgU2VsZWN0aW9uKHNvcnRncm91cHMsIHRoaXMuX3BhcmVudHMpLm9yZGVyKCk7XG59XG5cbmZ1bmN0aW9uIGFzY2VuZGluZyhhLCBiKSB7XG4gIHJldHVybiBhIDwgYiA/IC0xIDogYSA+IGIgPyAxIDogYSA+PSBiID8gMCA6IE5hTjtcbn1cbiIsImltcG9ydCBuYW1lc3BhY2UgZnJvbSBcIi4uL25hbWVzcGFjZS5qc1wiO1xuXG5mdW5jdGlvbiBhdHRyUmVtb3ZlKG5hbWUpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHRoaXMucmVtb3ZlQXR0cmlidXRlKG5hbWUpO1xuICB9O1xufVxuXG5mdW5jdGlvbiBhdHRyUmVtb3ZlTlMoZnVsbG5hbWUpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHRoaXMucmVtb3ZlQXR0cmlidXRlTlMoZnVsbG5hbWUuc3BhY2UsIGZ1bGxuYW1lLmxvY2FsKTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gYXR0ckNvbnN0YW50KG5hbWUsIHZhbHVlKSB7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLnNldEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSk7XG4gIH07XG59XG5cbmZ1bmN0aW9uIGF0dHJDb25zdGFudE5TKGZ1bGxuYW1lLCB2YWx1ZSkge1xuICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5zZXRBdHRyaWJ1dGVOUyhmdWxsbmFtZS5zcGFjZSwgZnVsbG5hbWUubG9jYWwsIHZhbHVlKTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gYXR0ckZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICB2YXIgdiA9IHZhbHVlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgaWYgKHYgPT0gbnVsbCkgdGhpcy5yZW1vdmVBdHRyaWJ1dGUobmFtZSk7XG4gICAgZWxzZSB0aGlzLnNldEF0dHJpYnV0ZShuYW1lLCB2KTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gYXR0ckZ1bmN0aW9uTlMoZnVsbG5hbWUsIHZhbHVlKSB7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICB2YXIgdiA9IHZhbHVlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgaWYgKHYgPT0gbnVsbCkgdGhpcy5yZW1vdmVBdHRyaWJ1dGVOUyhmdWxsbmFtZS5zcGFjZSwgZnVsbG5hbWUubG9jYWwpO1xuICAgIGVsc2UgdGhpcy5zZXRBdHRyaWJ1dGVOUyhmdWxsbmFtZS5zcGFjZSwgZnVsbG5hbWUubG9jYWwsIHYpO1xuICB9O1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbihuYW1lLCB2YWx1ZSkge1xuICB2YXIgZnVsbG5hbWUgPSBuYW1lc3BhY2UobmFtZSk7XG5cbiAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPCAyKSB7XG4gICAgdmFyIG5vZGUgPSB0aGlzLm5vZGUoKTtcbiAgICByZXR1cm4gZnVsbG5hbWUubG9jYWxcbiAgICAgICAgPyBub2RlLmdldEF0dHJpYnV0ZU5TKGZ1bGxuYW1lLnNwYWNlLCBmdWxsbmFtZS5sb2NhbClcbiAgICAgICAgOiBub2RlLmdldEF0dHJpYnV0ZShmdWxsbmFtZSk7XG4gIH1cblxuICByZXR1cm4gdGhpcy5lYWNoKCh2YWx1ZSA9PSBudWxsXG4gICAgICA/IChmdWxsbmFtZS5sb2NhbCA/IGF0dHJSZW1vdmVOUyA6IGF0dHJSZW1vdmUpIDogKHR5cGVvZiB2YWx1ZSA9PT0gXCJmdW5jdGlvblwiXG4gICAgICA/IChmdWxsbmFtZS5sb2NhbCA/IGF0dHJGdW5jdGlvbk5TIDogYXR0ckZ1bmN0aW9uKVxuICAgICAgOiAoZnVsbG5hbWUubG9jYWwgPyBhdHRyQ29uc3RhbnROUyA6IGF0dHJDb25zdGFudCkpKShmdWxsbmFtZSwgdmFsdWUpKTtcbn1cbiIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKG5vZGUpIHtcbiAgcmV0dXJuIChub2RlLm93bmVyRG9jdW1lbnQgJiYgbm9kZS5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3KSAvLyBub2RlIGlzIGEgTm9kZVxuICAgICAgfHwgKG5vZGUuZG9jdW1lbnQgJiYgbm9kZSkgLy8gbm9kZSBpcyBhIFdpbmRvd1xuICAgICAgfHwgbm9kZS5kZWZhdWx0VmlldzsgLy8gbm9kZSBpcyBhIERvY3VtZW50XG59XG4iLCJpbXBvcnQgZGVmYXVsdFZpZXcgZnJvbSBcIi4uL3dpbmRvdy5qc1wiO1xuXG5mdW5jdGlvbiBzdHlsZVJlbW92ZShuYW1lKSB7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLnN0eWxlLnJlbW92ZVByb3BlcnR5KG5hbWUpO1xuICB9O1xufVxuXG5mdW5jdGlvbiBzdHlsZUNvbnN0YW50KG5hbWUsIHZhbHVlLCBwcmlvcml0eSkge1xuICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5zdHlsZS5zZXRQcm9wZXJ0eShuYW1lLCB2YWx1ZSwgcHJpb3JpdHkpO1xuICB9O1xufVxuXG5mdW5jdGlvbiBzdHlsZUZ1bmN0aW9uKG5hbWUsIHZhbHVlLCBwcmlvcml0eSkge1xuICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHYgPSB2YWx1ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIGlmICh2ID09IG51bGwpIHRoaXMuc3R5bGUucmVtb3ZlUHJvcGVydHkobmFtZSk7XG4gICAgZWxzZSB0aGlzLnN0eWxlLnNldFByb3BlcnR5KG5hbWUsIHYsIHByaW9yaXR5KTtcbiAgfTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24obmFtZSwgdmFsdWUsIHByaW9yaXR5KSB7XG4gIHJldHVybiBhcmd1bWVudHMubGVuZ3RoID4gMVxuICAgICAgPyB0aGlzLmVhY2goKHZhbHVlID09IG51bGxcbiAgICAgICAgICAgID8gc3R5bGVSZW1vdmUgOiB0eXBlb2YgdmFsdWUgPT09IFwiZnVuY3Rpb25cIlxuICAgICAgICAgICAgPyBzdHlsZUZ1bmN0aW9uXG4gICAgICAgICAgICA6IHN0eWxlQ29uc3RhbnQpKG5hbWUsIHZhbHVlLCBwcmlvcml0eSA9PSBudWxsID8gXCJcIiA6IHByaW9yaXR5KSlcbiAgICAgIDogc3R5bGVWYWx1ZSh0aGlzLm5vZGUoKSwgbmFtZSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzdHlsZVZhbHVlKG5vZGUsIG5hbWUpIHtcbiAgcmV0dXJuIG5vZGUuc3R5bGUuZ2V0UHJvcGVydHlWYWx1ZShuYW1lKVxuICAgICAgfHwgZGVmYXVsdFZpZXcobm9kZSkuZ2V0Q29tcHV0ZWRTdHlsZShub2RlLCBudWxsKS5nZXRQcm9wZXJ0eVZhbHVlKG5hbWUpO1xufVxuIiwiZnVuY3Rpb24gcHJvcGVydHlSZW1vdmUobmFtZSkge1xuICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgZGVsZXRlIHRoaXNbbmFtZV07XG4gIH07XG59XG5cbmZ1bmN0aW9uIHByb3BlcnR5Q29uc3RhbnQobmFtZSwgdmFsdWUpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHRoaXNbbmFtZV0gPSB2YWx1ZTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gcHJvcGVydHlGdW5jdGlvbihuYW1lLCB2YWx1ZSkge1xuICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHYgPSB2YWx1ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIGlmICh2ID09IG51bGwpIGRlbGV0ZSB0aGlzW25hbWVdO1xuICAgIGVsc2UgdGhpc1tuYW1lXSA9IHY7XG4gIH07XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7XG4gIHJldHVybiBhcmd1bWVudHMubGVuZ3RoID4gMVxuICAgICAgPyB0aGlzLmVhY2goKHZhbHVlID09IG51bGxcbiAgICAgICAgICA/IHByb3BlcnR5UmVtb3ZlIDogdHlwZW9mIHZhbHVlID09PSBcImZ1bmN0aW9uXCJcbiAgICAgICAgICA/IHByb3BlcnR5RnVuY3Rpb25cbiAgICAgICAgICA6IHByb3BlcnR5Q29uc3RhbnQpKG5hbWUsIHZhbHVlKSlcbiAgICAgIDogdGhpcy5ub2RlKClbbmFtZV07XG59XG4iLCJmdW5jdGlvbiBjbGFzc0FycmF5KHN0cmluZykge1xuICByZXR1cm4gc3RyaW5nLnRyaW0oKS5zcGxpdCgvXnxcXHMrLyk7XG59XG5cbmZ1bmN0aW9uIGNsYXNzTGlzdChub2RlKSB7XG4gIHJldHVybiBub2RlLmNsYXNzTGlzdCB8fCBuZXcgQ2xhc3NMaXN0KG5vZGUpO1xufVxuXG5mdW5jdGlvbiBDbGFzc0xpc3Qobm9kZSkge1xuICB0aGlzLl9ub2RlID0gbm9kZTtcbiAgdGhpcy5fbmFtZXMgPSBjbGFzc0FycmF5KG5vZGUuZ2V0QXR0cmlidXRlKFwiY2xhc3NcIikgfHwgXCJcIik7XG59XG5cbkNsYXNzTGlzdC5wcm90b3R5cGUgPSB7XG4gIGFkZDogZnVuY3Rpb24obmFtZSkge1xuICAgIHZhciBpID0gdGhpcy5fbmFtZXMuaW5kZXhPZihuYW1lKTtcbiAgICBpZiAoaSA8IDApIHtcbiAgICAgIHRoaXMuX25hbWVzLnB1c2gobmFtZSk7XG4gICAgICB0aGlzLl9ub2RlLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIHRoaXMuX25hbWVzLmpvaW4oXCIgXCIpKTtcbiAgICB9XG4gIH0sXG4gIHJlbW92ZTogZnVuY3Rpb24obmFtZSkge1xuICAgIHZhciBpID0gdGhpcy5fbmFtZXMuaW5kZXhPZihuYW1lKTtcbiAgICBpZiAoaSA+PSAwKSB7XG4gICAgICB0aGlzLl9uYW1lcy5zcGxpY2UoaSwgMSk7XG4gICAgICB0aGlzLl9ub2RlLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIHRoaXMuX25hbWVzLmpvaW4oXCIgXCIpKTtcbiAgICB9XG4gIH0sXG4gIGNvbnRhaW5zOiBmdW5jdGlvbihuYW1lKSB7XG4gICAgcmV0dXJuIHRoaXMuX25hbWVzLmluZGV4T2YobmFtZSkgPj0gMDtcbiAgfVxufTtcblxuZnVuY3Rpb24gY2xhc3NlZEFkZChub2RlLCBuYW1lcykge1xuICB2YXIgbGlzdCA9IGNsYXNzTGlzdChub2RlKSwgaSA9IC0xLCBuID0gbmFtZXMubGVuZ3RoO1xuICB3aGlsZSAoKytpIDwgbikgbGlzdC5hZGQobmFtZXNbaV0pO1xufVxuXG5mdW5jdGlvbiBjbGFzc2VkUmVtb3ZlKG5vZGUsIG5hbWVzKSB7XG4gIHZhciBsaXN0ID0gY2xhc3NMaXN0KG5vZGUpLCBpID0gLTEsIG4gPSBuYW1lcy5sZW5ndGg7XG4gIHdoaWxlICgrK2kgPCBuKSBsaXN0LnJlbW92ZShuYW1lc1tpXSk7XG59XG5cbmZ1bmN0aW9uIGNsYXNzZWRUcnVlKG5hbWVzKSB7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICBjbGFzc2VkQWRkKHRoaXMsIG5hbWVzKTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gY2xhc3NlZEZhbHNlKG5hbWVzKSB7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICBjbGFzc2VkUmVtb3ZlKHRoaXMsIG5hbWVzKTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gY2xhc3NlZEZ1bmN0aW9uKG5hbWVzLCB2YWx1ZSkge1xuICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgKHZhbHVlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgPyBjbGFzc2VkQWRkIDogY2xhc3NlZFJlbW92ZSkodGhpcywgbmFtZXMpO1xuICB9O1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbihuYW1lLCB2YWx1ZSkge1xuICB2YXIgbmFtZXMgPSBjbGFzc0FycmF5KG5hbWUgKyBcIlwiKTtcblxuICBpZiAoYXJndW1lbnRzLmxlbmd0aCA8IDIpIHtcbiAgICB2YXIgbGlzdCA9IGNsYXNzTGlzdCh0aGlzLm5vZGUoKSksIGkgPSAtMSwgbiA9IG5hbWVzLmxlbmd0aDtcbiAgICB3aGlsZSAoKytpIDwgbikgaWYgKCFsaXN0LmNvbnRhaW5zKG5hbWVzW2ldKSkgcmV0dXJuIGZhbHNlO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgcmV0dXJuIHRoaXMuZWFjaCgodHlwZW9mIHZhbHVlID09PSBcImZ1bmN0aW9uXCJcbiAgICAgID8gY2xhc3NlZEZ1bmN0aW9uIDogdmFsdWVcbiAgICAgID8gY2xhc3NlZFRydWVcbiAgICAgIDogY2xhc3NlZEZhbHNlKShuYW1lcywgdmFsdWUpKTtcbn1cbiIsImZ1bmN0aW9uIHRleHRSZW1vdmUoKSB7XG4gIHRoaXMudGV4dENvbnRlbnQgPSBcIlwiO1xufVxuXG5mdW5jdGlvbiB0ZXh0Q29uc3RhbnQodmFsdWUpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHRoaXMudGV4dENvbnRlbnQgPSB2YWx1ZTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gdGV4dEZ1bmN0aW9uKHZhbHVlKSB7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICB2YXIgdiA9IHZhbHVlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgdGhpcy50ZXh0Q29udGVudCA9IHYgPT0gbnVsbCA/IFwiXCIgOiB2O1xuICB9O1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbih2YWx1ZSkge1xuICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aFxuICAgICAgPyB0aGlzLmVhY2godmFsdWUgPT0gbnVsbFxuICAgICAgICAgID8gdGV4dFJlbW92ZSA6ICh0eXBlb2YgdmFsdWUgPT09IFwiZnVuY3Rpb25cIlxuICAgICAgICAgID8gdGV4dEZ1bmN0aW9uXG4gICAgICAgICAgOiB0ZXh0Q29uc3RhbnQpKHZhbHVlKSlcbiAgICAgIDogdGhpcy5ub2RlKCkudGV4dENvbnRlbnQ7XG59XG4iLCJmdW5jdGlvbiBodG1sUmVtb3ZlKCkge1xuICB0aGlzLmlubmVySFRNTCA9IFwiXCI7XG59XG5cbmZ1bmN0aW9uIGh0bWxDb25zdGFudCh2YWx1ZSkge1xuICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbm5lckhUTUwgPSB2YWx1ZTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gaHRtbEZ1bmN0aW9uKHZhbHVlKSB7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICB2YXIgdiA9IHZhbHVlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgdGhpcy5pbm5lckhUTUwgPSB2ID09IG51bGwgPyBcIlwiIDogdjtcbiAgfTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24odmFsdWUpIHtcbiAgcmV0dXJuIGFyZ3VtZW50cy5sZW5ndGhcbiAgICAgID8gdGhpcy5lYWNoKHZhbHVlID09IG51bGxcbiAgICAgICAgICA/IGh0bWxSZW1vdmUgOiAodHlwZW9mIHZhbHVlID09PSBcImZ1bmN0aW9uXCJcbiAgICAgICAgICA/IGh0bWxGdW5jdGlvblxuICAgICAgICAgIDogaHRtbENvbnN0YW50KSh2YWx1ZSkpXG4gICAgICA6IHRoaXMubm9kZSgpLmlubmVySFRNTDtcbn1cbiIsImZ1bmN0aW9uIHJhaXNlKCkge1xuICBpZiAodGhpcy5uZXh0U2libGluZykgdGhpcy5wYXJlbnROb2RlLmFwcGVuZENoaWxkKHRoaXMpO1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHRoaXMuZWFjaChyYWlzZSk7XG59XG4iLCJmdW5jdGlvbiBsb3dlcigpIHtcbiAgaWYgKHRoaXMucHJldmlvdXNTaWJsaW5nKSB0aGlzLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHRoaXMsIHRoaXMucGFyZW50Tm9kZS5maXJzdENoaWxkKTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24oKSB7XG4gIHJldHVybiB0aGlzLmVhY2gobG93ZXIpO1xufVxuIiwiaW1wb3J0IGNyZWF0b3IgZnJvbSBcIi4uL2NyZWF0b3IuanNcIjtcbmltcG9ydCBzZWxlY3RvciBmcm9tIFwiLi4vc2VsZWN0b3IuanNcIjtcblxuZnVuY3Rpb24gY29uc3RhbnROdWxsKCkge1xuICByZXR1cm4gbnVsbDtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24obmFtZSwgYmVmb3JlKSB7XG4gIHZhciBjcmVhdGUgPSB0eXBlb2YgbmFtZSA9PT0gXCJmdW5jdGlvblwiID8gbmFtZSA6IGNyZWF0b3IobmFtZSksXG4gICAgICBzZWxlY3QgPSBiZWZvcmUgPT0gbnVsbCA/IGNvbnN0YW50TnVsbCA6IHR5cGVvZiBiZWZvcmUgPT09IFwiZnVuY3Rpb25cIiA/IGJlZm9yZSA6IHNlbGVjdG9yKGJlZm9yZSk7XG4gIHJldHVybiB0aGlzLnNlbGVjdChmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5pbnNlcnRCZWZvcmUoY3JlYXRlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyksIHNlbGVjdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IG51bGwpO1xuICB9KTtcbn1cbiIsImZ1bmN0aW9uIHJlbW92ZSgpIHtcbiAgdmFyIHBhcmVudCA9IHRoaXMucGFyZW50Tm9kZTtcbiAgaWYgKHBhcmVudCkgcGFyZW50LnJlbW92ZUNoaWxkKHRoaXMpO1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHRoaXMuZWFjaChyZW1vdmUpO1xufVxuIiwiZnVuY3Rpb24gc2VsZWN0aW9uX2Nsb25lU2hhbGxvdygpIHtcbiAgdmFyIGNsb25lID0gdGhpcy5jbG9uZU5vZGUoZmFsc2UpLCBwYXJlbnQgPSB0aGlzLnBhcmVudE5vZGU7XG4gIHJldHVybiBwYXJlbnQgPyBwYXJlbnQuaW5zZXJ0QmVmb3JlKGNsb25lLCB0aGlzLm5leHRTaWJsaW5nKSA6IGNsb25lO1xufVxuXG5mdW5jdGlvbiBzZWxlY3Rpb25fY2xvbmVEZWVwKCkge1xuICB2YXIgY2xvbmUgPSB0aGlzLmNsb25lTm9kZSh0cnVlKSwgcGFyZW50ID0gdGhpcy5wYXJlbnROb2RlO1xuICByZXR1cm4gcGFyZW50ID8gcGFyZW50Lmluc2VydEJlZm9yZShjbG9uZSwgdGhpcy5uZXh0U2libGluZykgOiBjbG9uZTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24oZGVlcCkge1xuICByZXR1cm4gdGhpcy5zZWxlY3QoZGVlcCA/IHNlbGVjdGlvbl9jbG9uZURlZXAgOiBzZWxlY3Rpb25fY2xvbmVTaGFsbG93KTtcbn1cbiIsImZ1bmN0aW9uIGNvbnRleHRMaXN0ZW5lcihsaXN0ZW5lcikge1xuICByZXR1cm4gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICBsaXN0ZW5lci5jYWxsKHRoaXMsIGV2ZW50LCB0aGlzLl9fZGF0YV9fKTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gcGFyc2VUeXBlbmFtZXModHlwZW5hbWVzKSB7XG4gIHJldHVybiB0eXBlbmFtZXMudHJpbSgpLnNwbGl0KC9efFxccysvKS5tYXAoZnVuY3Rpb24odCkge1xuICAgIHZhciBuYW1lID0gXCJcIiwgaSA9IHQuaW5kZXhPZihcIi5cIik7XG4gICAgaWYgKGkgPj0gMCkgbmFtZSA9IHQuc2xpY2UoaSArIDEpLCB0ID0gdC5zbGljZSgwLCBpKTtcbiAgICByZXR1cm4ge3R5cGU6IHQsIG5hbWU6IG5hbWV9O1xuICB9KTtcbn1cblxuZnVuY3Rpb24gb25SZW1vdmUodHlwZW5hbWUpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHZhciBvbiA9IHRoaXMuX19vbjtcbiAgICBpZiAoIW9uKSByZXR1cm47XG4gICAgZm9yICh2YXIgaiA9IDAsIGkgPSAtMSwgbSA9IG9uLmxlbmd0aCwgbzsgaiA8IG07ICsraikge1xuICAgICAgaWYgKG8gPSBvbltqXSwgKCF0eXBlbmFtZS50eXBlIHx8IG8udHlwZSA9PT0gdHlwZW5hbWUudHlwZSkgJiYgby5uYW1lID09PSB0eXBlbmFtZS5uYW1lKSB7XG4gICAgICAgIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcihvLnR5cGUsIG8ubGlzdGVuZXIsIG8ub3B0aW9ucyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBvblsrK2ldID0gbztcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKCsraSkgb24ubGVuZ3RoID0gaTtcbiAgICBlbHNlIGRlbGV0ZSB0aGlzLl9fb247XG4gIH07XG59XG5cbmZ1bmN0aW9uIG9uQWRkKHR5cGVuYW1lLCB2YWx1ZSwgb3B0aW9ucykge1xuICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgdmFyIG9uID0gdGhpcy5fX29uLCBvLCBsaXN0ZW5lciA9IGNvbnRleHRMaXN0ZW5lcih2YWx1ZSk7XG4gICAgaWYgKG9uKSBmb3IgKHZhciBqID0gMCwgbSA9IG9uLmxlbmd0aDsgaiA8IG07ICsraikge1xuICAgICAgaWYgKChvID0gb25bal0pLnR5cGUgPT09IHR5cGVuYW1lLnR5cGUgJiYgby5uYW1lID09PSB0eXBlbmFtZS5uYW1lKSB7XG4gICAgICAgIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcihvLnR5cGUsIG8ubGlzdGVuZXIsIG8ub3B0aW9ucyk7XG4gICAgICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcihvLnR5cGUsIG8ubGlzdGVuZXIgPSBsaXN0ZW5lciwgby5vcHRpb25zID0gb3B0aW9ucyk7XG4gICAgICAgIG8udmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cbiAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIodHlwZW5hbWUudHlwZSwgbGlzdGVuZXIsIG9wdGlvbnMpO1xuICAgIG8gPSB7dHlwZTogdHlwZW5hbWUudHlwZSwgbmFtZTogdHlwZW5hbWUubmFtZSwgdmFsdWU6IHZhbHVlLCBsaXN0ZW5lcjogbGlzdGVuZXIsIG9wdGlvbnM6IG9wdGlvbnN9O1xuICAgIGlmICghb24pIHRoaXMuX19vbiA9IFtvXTtcbiAgICBlbHNlIG9uLnB1c2gobyk7XG4gIH07XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKHR5cGVuYW1lLCB2YWx1ZSwgb3B0aW9ucykge1xuICB2YXIgdHlwZW5hbWVzID0gcGFyc2VUeXBlbmFtZXModHlwZW5hbWUgKyBcIlwiKSwgaSwgbiA9IHR5cGVuYW1lcy5sZW5ndGgsIHQ7XG5cbiAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPCAyKSB7XG4gICAgdmFyIG9uID0gdGhpcy5ub2RlKCkuX19vbjtcbiAgICBpZiAob24pIGZvciAodmFyIGogPSAwLCBtID0gb24ubGVuZ3RoLCBvOyBqIDwgbTsgKytqKSB7XG4gICAgICBmb3IgKGkgPSAwLCBvID0gb25bal07IGkgPCBuOyArK2kpIHtcbiAgICAgICAgaWYgKCh0ID0gdHlwZW5hbWVzW2ldKS50eXBlID09PSBvLnR5cGUgJiYgdC5uYW1lID09PSBvLm5hbWUpIHtcbiAgICAgICAgICByZXR1cm4gby52YWx1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm47XG4gIH1cblxuICBvbiA9IHZhbHVlID8gb25BZGQgOiBvblJlbW92ZTtcbiAgZm9yIChpID0gMDsgaSA8IG47ICsraSkgdGhpcy5lYWNoKG9uKHR5cGVuYW1lc1tpXSwgdmFsdWUsIG9wdGlvbnMpKTtcbiAgcmV0dXJuIHRoaXM7XG59XG4iLCJpbXBvcnQgZGVmYXVsdFZpZXcgZnJvbSBcIi4uL3dpbmRvdy5qc1wiO1xuXG5mdW5jdGlvbiBkaXNwYXRjaEV2ZW50KG5vZGUsIHR5cGUsIHBhcmFtcykge1xuICB2YXIgd2luZG93ID0gZGVmYXVsdFZpZXcobm9kZSksXG4gICAgICBldmVudCA9IHdpbmRvdy5DdXN0b21FdmVudDtcblxuICBpZiAodHlwZW9mIGV2ZW50ID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICBldmVudCA9IG5ldyBldmVudCh0eXBlLCBwYXJhbXMpO1xuICB9IGVsc2Uge1xuICAgIGV2ZW50ID0gd2luZG93LmRvY3VtZW50LmNyZWF0ZUV2ZW50KFwiRXZlbnRcIik7XG4gICAgaWYgKHBhcmFtcykgZXZlbnQuaW5pdEV2ZW50KHR5cGUsIHBhcmFtcy5idWJibGVzLCBwYXJhbXMuY2FuY2VsYWJsZSksIGV2ZW50LmRldGFpbCA9IHBhcmFtcy5kZXRhaWw7XG4gICAgZWxzZSBldmVudC5pbml0RXZlbnQodHlwZSwgZmFsc2UsIGZhbHNlKTtcbiAgfVxuXG4gIG5vZGUuZGlzcGF0Y2hFdmVudChldmVudCk7XG59XG5cbmZ1bmN0aW9uIGRpc3BhdGNoQ29uc3RhbnQodHlwZSwgcGFyYW1zKSB7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gZGlzcGF0Y2hFdmVudCh0aGlzLCB0eXBlLCBwYXJhbXMpO1xuICB9O1xufVxuXG5mdW5jdGlvbiBkaXNwYXRjaEZ1bmN0aW9uKHR5cGUsIHBhcmFtcykge1xuICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIGRpc3BhdGNoRXZlbnQodGhpcywgdHlwZSwgcGFyYW1zLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpO1xuICB9O1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbih0eXBlLCBwYXJhbXMpIHtcbiAgcmV0dXJuIHRoaXMuZWFjaCgodHlwZW9mIHBhcmFtcyA9PT0gXCJmdW5jdGlvblwiXG4gICAgICA/IGRpc3BhdGNoRnVuY3Rpb25cbiAgICAgIDogZGlzcGF0Y2hDb25zdGFudCkodHlwZSwgcGFyYW1zKSk7XG59XG4iLCJpbXBvcnQgc2VsZWN0aW9uX3NlbGVjdCBmcm9tIFwiLi9zZWxlY3QuanNcIjtcbmltcG9ydCBzZWxlY3Rpb25fc2VsZWN0QWxsIGZyb20gXCIuL3NlbGVjdEFsbC5qc1wiO1xuaW1wb3J0IHNlbGVjdGlvbl9zZWxlY3RDaGlsZCBmcm9tIFwiLi9zZWxlY3RDaGlsZC5qc1wiO1xuaW1wb3J0IHNlbGVjdGlvbl9zZWxlY3RDaGlsZHJlbiBmcm9tIFwiLi9zZWxlY3RDaGlsZHJlbi5qc1wiO1xuaW1wb3J0IHNlbGVjdGlvbl9maWx0ZXIgZnJvbSBcIi4vZmlsdGVyLmpzXCI7XG5pbXBvcnQgc2VsZWN0aW9uX2RhdGEgZnJvbSBcIi4vZGF0YS5qc1wiO1xuaW1wb3J0IHNlbGVjdGlvbl9lbnRlciBmcm9tIFwiLi9lbnRlci5qc1wiO1xuaW1wb3J0IHNlbGVjdGlvbl9leGl0IGZyb20gXCIuL2V4aXQuanNcIjtcbmltcG9ydCBzZWxlY3Rpb25fam9pbiBmcm9tIFwiLi9qb2luLmpzXCI7XG5pbXBvcnQgc2VsZWN0aW9uX21lcmdlIGZyb20gXCIuL21lcmdlLmpzXCI7XG5pbXBvcnQgc2VsZWN0aW9uX29yZGVyIGZyb20gXCIuL29yZGVyLmpzXCI7XG5pbXBvcnQgc2VsZWN0aW9uX3NvcnQgZnJvbSBcIi4vc29ydC5qc1wiO1xuaW1wb3J0IHNlbGVjdGlvbl9jYWxsIGZyb20gXCIuL2NhbGwuanNcIjtcbmltcG9ydCBzZWxlY3Rpb25fbm9kZXMgZnJvbSBcIi4vbm9kZXMuanNcIjtcbmltcG9ydCBzZWxlY3Rpb25fbm9kZSBmcm9tIFwiLi9ub2RlLmpzXCI7XG5pbXBvcnQgc2VsZWN0aW9uX3NpemUgZnJvbSBcIi4vc2l6ZS5qc1wiO1xuaW1wb3J0IHNlbGVjdGlvbl9lbXB0eSBmcm9tIFwiLi9lbXB0eS5qc1wiO1xuaW1wb3J0IHNlbGVjdGlvbl9lYWNoIGZyb20gXCIuL2VhY2guanNcIjtcbmltcG9ydCBzZWxlY3Rpb25fYXR0ciBmcm9tIFwiLi9hdHRyLmpzXCI7XG5pbXBvcnQgc2VsZWN0aW9uX3N0eWxlIGZyb20gXCIuL3N0eWxlLmpzXCI7XG5pbXBvcnQgc2VsZWN0aW9uX3Byb3BlcnR5IGZyb20gXCIuL3Byb3BlcnR5LmpzXCI7XG5pbXBvcnQgc2VsZWN0aW9uX2NsYXNzZWQgZnJvbSBcIi4vY2xhc3NlZC5qc1wiO1xuaW1wb3J0IHNlbGVjdGlvbl90ZXh0IGZyb20gXCIuL3RleHQuanNcIjtcbmltcG9ydCBzZWxlY3Rpb25faHRtbCBmcm9tIFwiLi9odG1sLmpzXCI7XG5pbXBvcnQgc2VsZWN0aW9uX3JhaXNlIGZyb20gXCIuL3JhaXNlLmpzXCI7XG5pbXBvcnQgc2VsZWN0aW9uX2xvd2VyIGZyb20gXCIuL2xvd2VyLmpzXCI7XG5pbXBvcnQgc2VsZWN0aW9uX2FwcGVuZCBmcm9tIFwiLi9hcHBlbmQuanNcIjtcbmltcG9ydCBzZWxlY3Rpb25faW5zZXJ0IGZyb20gXCIuL2luc2VydC5qc1wiO1xuaW1wb3J0IHNlbGVjdGlvbl9yZW1vdmUgZnJvbSBcIi4vcmVtb3ZlLmpzXCI7XG5pbXBvcnQgc2VsZWN0aW9uX2Nsb25lIGZyb20gXCIuL2Nsb25lLmpzXCI7XG5pbXBvcnQgc2VsZWN0aW9uX2RhdHVtIGZyb20gXCIuL2RhdHVtLmpzXCI7XG5pbXBvcnQgc2VsZWN0aW9uX29uIGZyb20gXCIuL29uLmpzXCI7XG5pbXBvcnQgc2VsZWN0aW9uX2Rpc3BhdGNoIGZyb20gXCIuL2Rpc3BhdGNoLmpzXCI7XG5pbXBvcnQgc2VsZWN0aW9uX2l0ZXJhdG9yIGZyb20gXCIuL2l0ZXJhdG9yLmpzXCI7XG5cbmV4cG9ydCB2YXIgcm9vdCA9IFtudWxsXTtcblxuZXhwb3J0IGZ1bmN0aW9uIFNlbGVjdGlvbihncm91cHMsIHBhcmVudHMpIHtcbiAgdGhpcy5fZ3JvdXBzID0gZ3JvdXBzO1xuICB0aGlzLl9wYXJlbnRzID0gcGFyZW50cztcbn1cblxuZnVuY3Rpb24gc2VsZWN0aW9uKCkge1xuICByZXR1cm4gbmV3IFNlbGVjdGlvbihbW2RvY3VtZW50LmRvY3VtZW50RWxlbWVudF1dLCByb290KTtcbn1cblxuZnVuY3Rpb24gc2VsZWN0aW9uX3NlbGVjdGlvbigpIHtcbiAgcmV0dXJuIHRoaXM7XG59XG5cblNlbGVjdGlvbi5wcm90b3R5cGUgPSBzZWxlY3Rpb24ucHJvdG90eXBlID0ge1xuICBjb25zdHJ1Y3RvcjogU2VsZWN0aW9uLFxuICBzZWxlY3Q6IHNlbGVjdGlvbl9zZWxlY3QsXG4gIHNlbGVjdEFsbDogc2VsZWN0aW9uX3NlbGVjdEFsbCxcbiAgc2VsZWN0Q2hpbGQ6IHNlbGVjdGlvbl9zZWxlY3RDaGlsZCxcbiAgc2VsZWN0Q2hpbGRyZW46IHNlbGVjdGlvbl9zZWxlY3RDaGlsZHJlbixcbiAgZmlsdGVyOiBzZWxlY3Rpb25fZmlsdGVyLFxuICBkYXRhOiBzZWxlY3Rpb25fZGF0YSxcbiAgZW50ZXI6IHNlbGVjdGlvbl9lbnRlcixcbiAgZXhpdDogc2VsZWN0aW9uX2V4aXQsXG4gIGpvaW46IHNlbGVjdGlvbl9qb2luLFxuICBtZXJnZTogc2VsZWN0aW9uX21lcmdlLFxuICBzZWxlY3Rpb246IHNlbGVjdGlvbl9zZWxlY3Rpb24sXG4gIG9yZGVyOiBzZWxlY3Rpb25fb3JkZXIsXG4gIHNvcnQ6IHNlbGVjdGlvbl9zb3J0LFxuICBjYWxsOiBzZWxlY3Rpb25fY2FsbCxcbiAgbm9kZXM6IHNlbGVjdGlvbl9ub2RlcyxcbiAgbm9kZTogc2VsZWN0aW9uX25vZGUsXG4gIHNpemU6IHNlbGVjdGlvbl9zaXplLFxuICBlbXB0eTogc2VsZWN0aW9uX2VtcHR5LFxuICBlYWNoOiBzZWxlY3Rpb25fZWFjaCxcbiAgYXR0cjogc2VsZWN0aW9uX2F0dHIsXG4gIHN0eWxlOiBzZWxlY3Rpb25fc3R5bGUsXG4gIHByb3BlcnR5OiBzZWxlY3Rpb25fcHJvcGVydHksXG4gIGNsYXNzZWQ6IHNlbGVjdGlvbl9jbGFzc2VkLFxuICB0ZXh0OiBzZWxlY3Rpb25fdGV4dCxcbiAgaHRtbDogc2VsZWN0aW9uX2h0bWwsXG4gIHJhaXNlOiBzZWxlY3Rpb25fcmFpc2UsXG4gIGxvd2VyOiBzZWxlY3Rpb25fbG93ZXIsXG4gIGFwcGVuZDogc2VsZWN0aW9uX2FwcGVuZCxcbiAgaW5zZXJ0OiBzZWxlY3Rpb25faW5zZXJ0LFxuICByZW1vdmU6IHNlbGVjdGlvbl9yZW1vdmUsXG4gIGNsb25lOiBzZWxlY3Rpb25fY2xvbmUsXG4gIGRhdHVtOiBzZWxlY3Rpb25fZGF0dW0sXG4gIG9uOiBzZWxlY3Rpb25fb24sXG4gIGRpc3BhdGNoOiBzZWxlY3Rpb25fZGlzcGF0Y2gsXG4gIFtTeW1ib2wuaXRlcmF0b3JdOiBzZWxlY3Rpb25faXRlcmF0b3Jcbn07XG5cbmV4cG9ydCBkZWZhdWx0IHNlbGVjdGlvbjtcbiIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKGNvbnN0cnVjdG9yLCBmYWN0b3J5LCBwcm90b3R5cGUpIHtcbiAgY29uc3RydWN0b3IucHJvdG90eXBlID0gZmFjdG9yeS5wcm90b3R5cGUgPSBwcm90b3R5cGU7XG4gIHByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IGNvbnN0cnVjdG9yO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZXh0ZW5kKHBhcmVudCwgZGVmaW5pdGlvbikge1xuICB2YXIgcHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShwYXJlbnQucHJvdG90eXBlKTtcbiAgZm9yICh2YXIga2V5IGluIGRlZmluaXRpb24pIHByb3RvdHlwZVtrZXldID0gZGVmaW5pdGlvbltrZXldO1xuICByZXR1cm4gcHJvdG90eXBlO1xufVxuIiwiaW1wb3J0IGRlZmluZSwge2V4dGVuZH0gZnJvbSBcIi4vZGVmaW5lLmpzXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBDb2xvcigpIHt9XG5cbmV4cG9ydCB2YXIgZGFya2VyID0gMC43O1xuZXhwb3J0IHZhciBicmlnaHRlciA9IDEgLyBkYXJrZXI7XG5cbnZhciByZUkgPSBcIlxcXFxzKihbKy1dP1xcXFxkKylcXFxccypcIixcbiAgICByZU4gPSBcIlxcXFxzKihbKy1dP1xcXFxkKlxcXFwuP1xcXFxkKyg/OltlRV1bKy1dP1xcXFxkKyk/KVxcXFxzKlwiLFxuICAgIHJlUCA9IFwiXFxcXHMqKFsrLV0/XFxcXGQqXFxcXC4/XFxcXGQrKD86W2VFXVsrLV0/XFxcXGQrKT8pJVxcXFxzKlwiLFxuICAgIHJlSGV4ID0gL14jKFswLTlhLWZdezMsOH0pJC8sXG4gICAgcmVSZ2JJbnRlZ2VyID0gbmV3IFJlZ0V4cChcIl5yZ2JcXFxcKFwiICsgW3JlSSwgcmVJLCByZUldICsgXCJcXFxcKSRcIiksXG4gICAgcmVSZ2JQZXJjZW50ID0gbmV3IFJlZ0V4cChcIl5yZ2JcXFxcKFwiICsgW3JlUCwgcmVQLCByZVBdICsgXCJcXFxcKSRcIiksXG4gICAgcmVSZ2JhSW50ZWdlciA9IG5ldyBSZWdFeHAoXCJecmdiYVxcXFwoXCIgKyBbcmVJLCByZUksIHJlSSwgcmVOXSArIFwiXFxcXCkkXCIpLFxuICAgIHJlUmdiYVBlcmNlbnQgPSBuZXcgUmVnRXhwKFwiXnJnYmFcXFxcKFwiICsgW3JlUCwgcmVQLCByZVAsIHJlTl0gKyBcIlxcXFwpJFwiKSxcbiAgICByZUhzbFBlcmNlbnQgPSBuZXcgUmVnRXhwKFwiXmhzbFxcXFwoXCIgKyBbcmVOLCByZVAsIHJlUF0gKyBcIlxcXFwpJFwiKSxcbiAgICByZUhzbGFQZXJjZW50ID0gbmV3IFJlZ0V4cChcIl5oc2xhXFxcXChcIiArIFtyZU4sIHJlUCwgcmVQLCByZU5dICsgXCJcXFxcKSRcIik7XG5cbnZhciBuYW1lZCA9IHtcbiAgYWxpY2VibHVlOiAweGYwZjhmZixcbiAgYW50aXF1ZXdoaXRlOiAweGZhZWJkNyxcbiAgYXF1YTogMHgwMGZmZmYsXG4gIGFxdWFtYXJpbmU6IDB4N2ZmZmQ0LFxuICBhenVyZTogMHhmMGZmZmYsXG4gIGJlaWdlOiAweGY1ZjVkYyxcbiAgYmlzcXVlOiAweGZmZTRjNCxcbiAgYmxhY2s6IDB4MDAwMDAwLFxuICBibGFuY2hlZGFsbW9uZDogMHhmZmViY2QsXG4gIGJsdWU6IDB4MDAwMGZmLFxuICBibHVldmlvbGV0OiAweDhhMmJlMixcbiAgYnJvd246IDB4YTUyYTJhLFxuICBidXJseXdvb2Q6IDB4ZGViODg3LFxuICBjYWRldGJsdWU6IDB4NWY5ZWEwLFxuICBjaGFydHJldXNlOiAweDdmZmYwMCxcbiAgY2hvY29sYXRlOiAweGQyNjkxZSxcbiAgY29yYWw6IDB4ZmY3ZjUwLFxuICBjb3JuZmxvd2VyYmx1ZTogMHg2NDk1ZWQsXG4gIGNvcm5zaWxrOiAweGZmZjhkYyxcbiAgY3JpbXNvbjogMHhkYzE0M2MsXG4gIGN5YW46IDB4MDBmZmZmLFxuICBkYXJrYmx1ZTogMHgwMDAwOGIsXG4gIGRhcmtjeWFuOiAweDAwOGI4YixcbiAgZGFya2dvbGRlbnJvZDogMHhiODg2MGIsXG4gIGRhcmtncmF5OiAweGE5YTlhOSxcbiAgZGFya2dyZWVuOiAweDAwNjQwMCxcbiAgZGFya2dyZXk6IDB4YTlhOWE5LFxuICBkYXJra2hha2k6IDB4YmRiNzZiLFxuICBkYXJrbWFnZW50YTogMHg4YjAwOGIsXG4gIGRhcmtvbGl2ZWdyZWVuOiAweDU1NmIyZixcbiAgZGFya29yYW5nZTogMHhmZjhjMDAsXG4gIGRhcmtvcmNoaWQ6IDB4OTkzMmNjLFxuICBkYXJrcmVkOiAweDhiMDAwMCxcbiAgZGFya3NhbG1vbjogMHhlOTk2N2EsXG4gIGRhcmtzZWFncmVlbjogMHg4ZmJjOGYsXG4gIGRhcmtzbGF0ZWJsdWU6IDB4NDgzZDhiLFxuICBkYXJrc2xhdGVncmF5OiAweDJmNGY0ZixcbiAgZGFya3NsYXRlZ3JleTogMHgyZjRmNGYsXG4gIGRhcmt0dXJxdW9pc2U6IDB4MDBjZWQxLFxuICBkYXJrdmlvbGV0OiAweDk0MDBkMyxcbiAgZGVlcHBpbms6IDB4ZmYxNDkzLFxuICBkZWVwc2t5Ymx1ZTogMHgwMGJmZmYsXG4gIGRpbWdyYXk6IDB4Njk2OTY5LFxuICBkaW1ncmV5OiAweDY5Njk2OSxcbiAgZG9kZ2VyYmx1ZTogMHgxZTkwZmYsXG4gIGZpcmVicmljazogMHhiMjIyMjIsXG4gIGZsb3JhbHdoaXRlOiAweGZmZmFmMCxcbiAgZm9yZXN0Z3JlZW46IDB4MjI4YjIyLFxuICBmdWNoc2lhOiAweGZmMDBmZixcbiAgZ2FpbnNib3JvOiAweGRjZGNkYyxcbiAgZ2hvc3R3aGl0ZTogMHhmOGY4ZmYsXG4gIGdvbGQ6IDB4ZmZkNzAwLFxuICBnb2xkZW5yb2Q6IDB4ZGFhNTIwLFxuICBncmF5OiAweDgwODA4MCxcbiAgZ3JlZW46IDB4MDA4MDAwLFxuICBncmVlbnllbGxvdzogMHhhZGZmMmYsXG4gIGdyZXk6IDB4ODA4MDgwLFxuICBob25leWRldzogMHhmMGZmZjAsXG4gIGhvdHBpbms6IDB4ZmY2OWI0LFxuICBpbmRpYW5yZWQ6IDB4Y2Q1YzVjLFxuICBpbmRpZ286IDB4NGIwMDgyLFxuICBpdm9yeTogMHhmZmZmZjAsXG4gIGtoYWtpOiAweGYwZTY4YyxcbiAgbGF2ZW5kZXI6IDB4ZTZlNmZhLFxuICBsYXZlbmRlcmJsdXNoOiAweGZmZjBmNSxcbiAgbGF3bmdyZWVuOiAweDdjZmMwMCxcbiAgbGVtb25jaGlmZm9uOiAweGZmZmFjZCxcbiAgbGlnaHRibHVlOiAweGFkZDhlNixcbiAgbGlnaHRjb3JhbDogMHhmMDgwODAsXG4gIGxpZ2h0Y3lhbjogMHhlMGZmZmYsXG4gIGxpZ2h0Z29sZGVucm9keWVsbG93OiAweGZhZmFkMixcbiAgbGlnaHRncmF5OiAweGQzZDNkMyxcbiAgbGlnaHRncmVlbjogMHg5MGVlOTAsXG4gIGxpZ2h0Z3JleTogMHhkM2QzZDMsXG4gIGxpZ2h0cGluazogMHhmZmI2YzEsXG4gIGxpZ2h0c2FsbW9uOiAweGZmYTA3YSxcbiAgbGlnaHRzZWFncmVlbjogMHgyMGIyYWEsXG4gIGxpZ2h0c2t5Ymx1ZTogMHg4N2NlZmEsXG4gIGxpZ2h0c2xhdGVncmF5OiAweDc3ODg5OSxcbiAgbGlnaHRzbGF0ZWdyZXk6IDB4Nzc4ODk5LFxuICBsaWdodHN0ZWVsYmx1ZTogMHhiMGM0ZGUsXG4gIGxpZ2h0eWVsbG93OiAweGZmZmZlMCxcbiAgbGltZTogMHgwMGZmMDAsXG4gIGxpbWVncmVlbjogMHgzMmNkMzIsXG4gIGxpbmVuOiAweGZhZjBlNixcbiAgbWFnZW50YTogMHhmZjAwZmYsXG4gIG1hcm9vbjogMHg4MDAwMDAsXG4gIG1lZGl1bWFxdWFtYXJpbmU6IDB4NjZjZGFhLFxuICBtZWRpdW1ibHVlOiAweDAwMDBjZCxcbiAgbWVkaXVtb3JjaGlkOiAweGJhNTVkMyxcbiAgbWVkaXVtcHVycGxlOiAweDkzNzBkYixcbiAgbWVkaXVtc2VhZ3JlZW46IDB4M2NiMzcxLFxuICBtZWRpdW1zbGF0ZWJsdWU6IDB4N2I2OGVlLFxuICBtZWRpdW1zcHJpbmdncmVlbjogMHgwMGZhOWEsXG4gIG1lZGl1bXR1cnF1b2lzZTogMHg0OGQxY2MsXG4gIG1lZGl1bXZpb2xldHJlZDogMHhjNzE1ODUsXG4gIG1pZG5pZ2h0Ymx1ZTogMHgxOTE5NzAsXG4gIG1pbnRjcmVhbTogMHhmNWZmZmEsXG4gIG1pc3R5cm9zZTogMHhmZmU0ZTEsXG4gIG1vY2Nhc2luOiAweGZmZTRiNSxcbiAgbmF2YWpvd2hpdGU6IDB4ZmZkZWFkLFxuICBuYXZ5OiAweDAwMDA4MCxcbiAgb2xkbGFjZTogMHhmZGY1ZTYsXG4gIG9saXZlOiAweDgwODAwMCxcbiAgb2xpdmVkcmFiOiAweDZiOGUyMyxcbiAgb3JhbmdlOiAweGZmYTUwMCxcbiAgb3JhbmdlcmVkOiAweGZmNDUwMCxcbiAgb3JjaGlkOiAweGRhNzBkNixcbiAgcGFsZWdvbGRlbnJvZDogMHhlZWU4YWEsXG4gIHBhbGVncmVlbjogMHg5OGZiOTgsXG4gIHBhbGV0dXJxdW9pc2U6IDB4YWZlZWVlLFxuICBwYWxldmlvbGV0cmVkOiAweGRiNzA5MyxcbiAgcGFwYXlhd2hpcDogMHhmZmVmZDUsXG4gIHBlYWNocHVmZjogMHhmZmRhYjksXG4gIHBlcnU6IDB4Y2Q4NTNmLFxuICBwaW5rOiAweGZmYzBjYixcbiAgcGx1bTogMHhkZGEwZGQsXG4gIHBvd2RlcmJsdWU6IDB4YjBlMGU2LFxuICBwdXJwbGU6IDB4ODAwMDgwLFxuICByZWJlY2NhcHVycGxlOiAweDY2MzM5OSxcbiAgcmVkOiAweGZmMDAwMCxcbiAgcm9zeWJyb3duOiAweGJjOGY4ZixcbiAgcm95YWxibHVlOiAweDQxNjllMSxcbiAgc2FkZGxlYnJvd246IDB4OGI0NTEzLFxuICBzYWxtb246IDB4ZmE4MDcyLFxuICBzYW5keWJyb3duOiAweGY0YTQ2MCxcbiAgc2VhZ3JlZW46IDB4MmU4YjU3LFxuICBzZWFzaGVsbDogMHhmZmY1ZWUsXG4gIHNpZW5uYTogMHhhMDUyMmQsXG4gIHNpbHZlcjogMHhjMGMwYzAsXG4gIHNreWJsdWU6IDB4ODdjZWViLFxuICBzbGF0ZWJsdWU6IDB4NmE1YWNkLFxuICBzbGF0ZWdyYXk6IDB4NzA4MDkwLFxuICBzbGF0ZWdyZXk6IDB4NzA4MDkwLFxuICBzbm93OiAweGZmZmFmYSxcbiAgc3ByaW5nZ3JlZW46IDB4MDBmZjdmLFxuICBzdGVlbGJsdWU6IDB4NDY4MmI0LFxuICB0YW46IDB4ZDJiNDhjLFxuICB0ZWFsOiAweDAwODA4MCxcbiAgdGhpc3RsZTogMHhkOGJmZDgsXG4gIHRvbWF0bzogMHhmZjYzNDcsXG4gIHR1cnF1b2lzZTogMHg0MGUwZDAsXG4gIHZpb2xldDogMHhlZTgyZWUsXG4gIHdoZWF0OiAweGY1ZGViMyxcbiAgd2hpdGU6IDB4ZmZmZmZmLFxuICB3aGl0ZXNtb2tlOiAweGY1ZjVmNSxcbiAgeWVsbG93OiAweGZmZmYwMCxcbiAgeWVsbG93Z3JlZW46IDB4OWFjZDMyXG59O1xuXG5kZWZpbmUoQ29sb3IsIGNvbG9yLCB7XG4gIGNvcHk6IGZ1bmN0aW9uKGNoYW5uZWxzKSB7XG4gICAgcmV0dXJuIE9iamVjdC5hc3NpZ24obmV3IHRoaXMuY29uc3RydWN0b3IsIHRoaXMsIGNoYW5uZWxzKTtcbiAgfSxcbiAgZGlzcGxheWFibGU6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLnJnYigpLmRpc3BsYXlhYmxlKCk7XG4gIH0sXG4gIGhleDogY29sb3JfZm9ybWF0SGV4LCAvLyBEZXByZWNhdGVkISBVc2UgY29sb3IuZm9ybWF0SGV4LlxuICBmb3JtYXRIZXg6IGNvbG9yX2Zvcm1hdEhleCxcbiAgZm9ybWF0SHNsOiBjb2xvcl9mb3JtYXRIc2wsXG4gIGZvcm1hdFJnYjogY29sb3JfZm9ybWF0UmdiLFxuICB0b1N0cmluZzogY29sb3JfZm9ybWF0UmdiXG59KTtcblxuZnVuY3Rpb24gY29sb3JfZm9ybWF0SGV4KCkge1xuICByZXR1cm4gdGhpcy5yZ2IoKS5mb3JtYXRIZXgoKTtcbn1cblxuZnVuY3Rpb24gY29sb3JfZm9ybWF0SHNsKCkge1xuICByZXR1cm4gaHNsQ29udmVydCh0aGlzKS5mb3JtYXRIc2woKTtcbn1cblxuZnVuY3Rpb24gY29sb3JfZm9ybWF0UmdiKCkge1xuICByZXR1cm4gdGhpcy5yZ2IoKS5mb3JtYXRSZ2IoKTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gY29sb3IoZm9ybWF0KSB7XG4gIHZhciBtLCBsO1xuICBmb3JtYXQgPSAoZm9ybWF0ICsgXCJcIikudHJpbSgpLnRvTG93ZXJDYXNlKCk7XG4gIHJldHVybiAobSA9IHJlSGV4LmV4ZWMoZm9ybWF0KSkgPyAobCA9IG1bMV0ubGVuZ3RoLCBtID0gcGFyc2VJbnQobVsxXSwgMTYpLCBsID09PSA2ID8gcmdibihtKSAvLyAjZmYwMDAwXG4gICAgICA6IGwgPT09IDMgPyBuZXcgUmdiKChtID4+IDggJiAweGYpIHwgKG0gPj4gNCAmIDB4ZjApLCAobSA+PiA0ICYgMHhmKSB8IChtICYgMHhmMCksICgobSAmIDB4ZikgPDwgNCkgfCAobSAmIDB4ZiksIDEpIC8vICNmMDBcbiAgICAgIDogbCA9PT0gOCA/IHJnYmEobSA+PiAyNCAmIDB4ZmYsIG0gPj4gMTYgJiAweGZmLCBtID4+IDggJiAweGZmLCAobSAmIDB4ZmYpIC8gMHhmZikgLy8gI2ZmMDAwMDAwXG4gICAgICA6IGwgPT09IDQgPyByZ2JhKChtID4+IDEyICYgMHhmKSB8IChtID4+IDggJiAweGYwKSwgKG0gPj4gOCAmIDB4ZikgfCAobSA+PiA0ICYgMHhmMCksIChtID4+IDQgJiAweGYpIHwgKG0gJiAweGYwKSwgKCgobSAmIDB4ZikgPDwgNCkgfCAobSAmIDB4ZikpIC8gMHhmZikgLy8gI2YwMDBcbiAgICAgIDogbnVsbCkgLy8gaW52YWxpZCBoZXhcbiAgICAgIDogKG0gPSByZVJnYkludGVnZXIuZXhlYyhmb3JtYXQpKSA/IG5ldyBSZ2IobVsxXSwgbVsyXSwgbVszXSwgMSkgLy8gcmdiKDI1NSwgMCwgMClcbiAgICAgIDogKG0gPSByZVJnYlBlcmNlbnQuZXhlYyhmb3JtYXQpKSA/IG5ldyBSZ2IobVsxXSAqIDI1NSAvIDEwMCwgbVsyXSAqIDI1NSAvIDEwMCwgbVszXSAqIDI1NSAvIDEwMCwgMSkgLy8gcmdiKDEwMCUsIDAlLCAwJSlcbiAgICAgIDogKG0gPSByZVJnYmFJbnRlZ2VyLmV4ZWMoZm9ybWF0KSkgPyByZ2JhKG1bMV0sIG1bMl0sIG1bM10sIG1bNF0pIC8vIHJnYmEoMjU1LCAwLCAwLCAxKVxuICAgICAgOiAobSA9IHJlUmdiYVBlcmNlbnQuZXhlYyhmb3JtYXQpKSA/IHJnYmEobVsxXSAqIDI1NSAvIDEwMCwgbVsyXSAqIDI1NSAvIDEwMCwgbVszXSAqIDI1NSAvIDEwMCwgbVs0XSkgLy8gcmdiKDEwMCUsIDAlLCAwJSwgMSlcbiAgICAgIDogKG0gPSByZUhzbFBlcmNlbnQuZXhlYyhmb3JtYXQpKSA/IGhzbGEobVsxXSwgbVsyXSAvIDEwMCwgbVszXSAvIDEwMCwgMSkgLy8gaHNsKDEyMCwgNTAlLCA1MCUpXG4gICAgICA6IChtID0gcmVIc2xhUGVyY2VudC5leGVjKGZvcm1hdCkpID8gaHNsYShtWzFdLCBtWzJdIC8gMTAwLCBtWzNdIC8gMTAwLCBtWzRdKSAvLyBoc2xhKDEyMCwgNTAlLCA1MCUsIDEpXG4gICAgICA6IG5hbWVkLmhhc093blByb3BlcnR5KGZvcm1hdCkgPyByZ2JuKG5hbWVkW2Zvcm1hdF0pIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tcHJvdG90eXBlLWJ1aWx0aW5zXG4gICAgICA6IGZvcm1hdCA9PT0gXCJ0cmFuc3BhcmVudFwiID8gbmV3IFJnYihOYU4sIE5hTiwgTmFOLCAwKVxuICAgICAgOiBudWxsO1xufVxuXG5mdW5jdGlvbiByZ2JuKG4pIHtcbiAgcmV0dXJuIG5ldyBSZ2IobiA+PiAxNiAmIDB4ZmYsIG4gPj4gOCAmIDB4ZmYsIG4gJiAweGZmLCAxKTtcbn1cblxuZnVuY3Rpb24gcmdiYShyLCBnLCBiLCBhKSB7XG4gIGlmIChhIDw9IDApIHIgPSBnID0gYiA9IE5hTjtcbiAgcmV0dXJuIG5ldyBSZ2IociwgZywgYiwgYSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZ2JDb252ZXJ0KG8pIHtcbiAgaWYgKCEobyBpbnN0YW5jZW9mIENvbG9yKSkgbyA9IGNvbG9yKG8pO1xuICBpZiAoIW8pIHJldHVybiBuZXcgUmdiO1xuICBvID0gby5yZ2IoKTtcbiAgcmV0dXJuIG5ldyBSZ2Ioby5yLCBvLmcsIG8uYiwgby5vcGFjaXR5KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJnYihyLCBnLCBiLCBvcGFjaXR5KSB7XG4gIHJldHVybiBhcmd1bWVudHMubGVuZ3RoID09PSAxID8gcmdiQ29udmVydChyKSA6IG5ldyBSZ2IociwgZywgYiwgb3BhY2l0eSA9PSBudWxsID8gMSA6IG9wYWNpdHkpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gUmdiKHIsIGcsIGIsIG9wYWNpdHkpIHtcbiAgdGhpcy5yID0gK3I7XG4gIHRoaXMuZyA9ICtnO1xuICB0aGlzLmIgPSArYjtcbiAgdGhpcy5vcGFjaXR5ID0gK29wYWNpdHk7XG59XG5cbmRlZmluZShSZ2IsIHJnYiwgZXh0ZW5kKENvbG9yLCB7XG4gIGJyaWdodGVyOiBmdW5jdGlvbihrKSB7XG4gICAgayA9IGsgPT0gbnVsbCA/IGJyaWdodGVyIDogTWF0aC5wb3coYnJpZ2h0ZXIsIGspO1xuICAgIHJldHVybiBuZXcgUmdiKHRoaXMuciAqIGssIHRoaXMuZyAqIGssIHRoaXMuYiAqIGssIHRoaXMub3BhY2l0eSk7XG4gIH0sXG4gIGRhcmtlcjogZnVuY3Rpb24oaykge1xuICAgIGsgPSBrID09IG51bGwgPyBkYXJrZXIgOiBNYXRoLnBvdyhkYXJrZXIsIGspO1xuICAgIHJldHVybiBuZXcgUmdiKHRoaXMuciAqIGssIHRoaXMuZyAqIGssIHRoaXMuYiAqIGssIHRoaXMub3BhY2l0eSk7XG4gIH0sXG4gIHJnYjogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH0sXG4gIGRpc3BsYXlhYmxlOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gKC0wLjUgPD0gdGhpcy5yICYmIHRoaXMuciA8IDI1NS41KVxuICAgICAgICAmJiAoLTAuNSA8PSB0aGlzLmcgJiYgdGhpcy5nIDwgMjU1LjUpXG4gICAgICAgICYmICgtMC41IDw9IHRoaXMuYiAmJiB0aGlzLmIgPCAyNTUuNSlcbiAgICAgICAgJiYgKDAgPD0gdGhpcy5vcGFjaXR5ICYmIHRoaXMub3BhY2l0eSA8PSAxKTtcbiAgfSxcbiAgaGV4OiByZ2JfZm9ybWF0SGV4LCAvLyBEZXByZWNhdGVkISBVc2UgY29sb3IuZm9ybWF0SGV4LlxuICBmb3JtYXRIZXg6IHJnYl9mb3JtYXRIZXgsXG4gIGZvcm1hdFJnYjogcmdiX2Zvcm1hdFJnYixcbiAgdG9TdHJpbmc6IHJnYl9mb3JtYXRSZ2Jcbn0pKTtcblxuZnVuY3Rpb24gcmdiX2Zvcm1hdEhleCgpIHtcbiAgcmV0dXJuIFwiI1wiICsgaGV4KHRoaXMucikgKyBoZXgodGhpcy5nKSArIGhleCh0aGlzLmIpO1xufVxuXG5mdW5jdGlvbiByZ2JfZm9ybWF0UmdiKCkge1xuICB2YXIgYSA9IHRoaXMub3BhY2l0eTsgYSA9IGlzTmFOKGEpID8gMSA6IE1hdGgubWF4KDAsIE1hdGgubWluKDEsIGEpKTtcbiAgcmV0dXJuIChhID09PSAxID8gXCJyZ2IoXCIgOiBcInJnYmEoXCIpXG4gICAgICArIE1hdGgubWF4KDAsIE1hdGgubWluKDI1NSwgTWF0aC5yb3VuZCh0aGlzLnIpIHx8IDApKSArIFwiLCBcIlxuICAgICAgKyBNYXRoLm1heCgwLCBNYXRoLm1pbigyNTUsIE1hdGgucm91bmQodGhpcy5nKSB8fCAwKSkgKyBcIiwgXCJcbiAgICAgICsgTWF0aC5tYXgoMCwgTWF0aC5taW4oMjU1LCBNYXRoLnJvdW5kKHRoaXMuYikgfHwgMCkpXG4gICAgICArIChhID09PSAxID8gXCIpXCIgOiBcIiwgXCIgKyBhICsgXCIpXCIpO1xufVxuXG5mdW5jdGlvbiBoZXgodmFsdWUpIHtcbiAgdmFsdWUgPSBNYXRoLm1heCgwLCBNYXRoLm1pbigyNTUsIE1hdGgucm91bmQodmFsdWUpIHx8IDApKTtcbiAgcmV0dXJuICh2YWx1ZSA8IDE2ID8gXCIwXCIgOiBcIlwiKSArIHZhbHVlLnRvU3RyaW5nKDE2KTtcbn1cblxuZnVuY3Rpb24gaHNsYShoLCBzLCBsLCBhKSB7XG4gIGlmIChhIDw9IDApIGggPSBzID0gbCA9IE5hTjtcbiAgZWxzZSBpZiAobCA8PSAwIHx8IGwgPj0gMSkgaCA9IHMgPSBOYU47XG4gIGVsc2UgaWYgKHMgPD0gMCkgaCA9IE5hTjtcbiAgcmV0dXJuIG5ldyBIc2woaCwgcywgbCwgYSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBoc2xDb252ZXJ0KG8pIHtcbiAgaWYgKG8gaW5zdGFuY2VvZiBIc2wpIHJldHVybiBuZXcgSHNsKG8uaCwgby5zLCBvLmwsIG8ub3BhY2l0eSk7XG4gIGlmICghKG8gaW5zdGFuY2VvZiBDb2xvcikpIG8gPSBjb2xvcihvKTtcbiAgaWYgKCFvKSByZXR1cm4gbmV3IEhzbDtcbiAgaWYgKG8gaW5zdGFuY2VvZiBIc2wpIHJldHVybiBvO1xuICBvID0gby5yZ2IoKTtcbiAgdmFyIHIgPSBvLnIgLyAyNTUsXG4gICAgICBnID0gby5nIC8gMjU1LFxuICAgICAgYiA9IG8uYiAvIDI1NSxcbiAgICAgIG1pbiA9IE1hdGgubWluKHIsIGcsIGIpLFxuICAgICAgbWF4ID0gTWF0aC5tYXgociwgZywgYiksXG4gICAgICBoID0gTmFOLFxuICAgICAgcyA9IG1heCAtIG1pbixcbiAgICAgIGwgPSAobWF4ICsgbWluKSAvIDI7XG4gIGlmIChzKSB7XG4gICAgaWYgKHIgPT09IG1heCkgaCA9IChnIC0gYikgLyBzICsgKGcgPCBiKSAqIDY7XG4gICAgZWxzZSBpZiAoZyA9PT0gbWF4KSBoID0gKGIgLSByKSAvIHMgKyAyO1xuICAgIGVsc2UgaCA9IChyIC0gZykgLyBzICsgNDtcbiAgICBzIC89IGwgPCAwLjUgPyBtYXggKyBtaW4gOiAyIC0gbWF4IC0gbWluO1xuICAgIGggKj0gNjA7XG4gIH0gZWxzZSB7XG4gICAgcyA9IGwgPiAwICYmIGwgPCAxID8gMCA6IGg7XG4gIH1cbiAgcmV0dXJuIG5ldyBIc2woaCwgcywgbCwgby5vcGFjaXR5KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGhzbChoLCBzLCBsLCBvcGFjaXR5KSB7XG4gIHJldHVybiBhcmd1bWVudHMubGVuZ3RoID09PSAxID8gaHNsQ29udmVydChoKSA6IG5ldyBIc2woaCwgcywgbCwgb3BhY2l0eSA9PSBudWxsID8gMSA6IG9wYWNpdHkpO1xufVxuXG5mdW5jdGlvbiBIc2woaCwgcywgbCwgb3BhY2l0eSkge1xuICB0aGlzLmggPSAraDtcbiAgdGhpcy5zID0gK3M7XG4gIHRoaXMubCA9ICtsO1xuICB0aGlzLm9wYWNpdHkgPSArb3BhY2l0eTtcbn1cblxuZGVmaW5lKEhzbCwgaHNsLCBleHRlbmQoQ29sb3IsIHtcbiAgYnJpZ2h0ZXI6IGZ1bmN0aW9uKGspIHtcbiAgICBrID0gayA9PSBudWxsID8gYnJpZ2h0ZXIgOiBNYXRoLnBvdyhicmlnaHRlciwgayk7XG4gICAgcmV0dXJuIG5ldyBIc2wodGhpcy5oLCB0aGlzLnMsIHRoaXMubCAqIGssIHRoaXMub3BhY2l0eSk7XG4gIH0sXG4gIGRhcmtlcjogZnVuY3Rpb24oaykge1xuICAgIGsgPSBrID09IG51bGwgPyBkYXJrZXIgOiBNYXRoLnBvdyhkYXJrZXIsIGspO1xuICAgIHJldHVybiBuZXcgSHNsKHRoaXMuaCwgdGhpcy5zLCB0aGlzLmwgKiBrLCB0aGlzLm9wYWNpdHkpO1xuICB9LFxuICByZ2I6IGZ1bmN0aW9uKCkge1xuICAgIHZhciBoID0gdGhpcy5oICUgMzYwICsgKHRoaXMuaCA8IDApICogMzYwLFxuICAgICAgICBzID0gaXNOYU4oaCkgfHwgaXNOYU4odGhpcy5zKSA/IDAgOiB0aGlzLnMsXG4gICAgICAgIGwgPSB0aGlzLmwsXG4gICAgICAgIG0yID0gbCArIChsIDwgMC41ID8gbCA6IDEgLSBsKSAqIHMsXG4gICAgICAgIG0xID0gMiAqIGwgLSBtMjtcbiAgICByZXR1cm4gbmV3IFJnYihcbiAgICAgIGhzbDJyZ2IoaCA+PSAyNDAgPyBoIC0gMjQwIDogaCArIDEyMCwgbTEsIG0yKSxcbiAgICAgIGhzbDJyZ2IoaCwgbTEsIG0yKSxcbiAgICAgIGhzbDJyZ2IoaCA8IDEyMCA/IGggKyAyNDAgOiBoIC0gMTIwLCBtMSwgbTIpLFxuICAgICAgdGhpcy5vcGFjaXR5XG4gICAgKTtcbiAgfSxcbiAgZGlzcGxheWFibGU6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiAoMCA8PSB0aGlzLnMgJiYgdGhpcy5zIDw9IDEgfHwgaXNOYU4odGhpcy5zKSlcbiAgICAgICAgJiYgKDAgPD0gdGhpcy5sICYmIHRoaXMubCA8PSAxKVxuICAgICAgICAmJiAoMCA8PSB0aGlzLm9wYWNpdHkgJiYgdGhpcy5vcGFjaXR5IDw9IDEpO1xuICB9LFxuICBmb3JtYXRIc2w6IGZ1bmN0aW9uKCkge1xuICAgIHZhciBhID0gdGhpcy5vcGFjaXR5OyBhID0gaXNOYU4oYSkgPyAxIDogTWF0aC5tYXgoMCwgTWF0aC5taW4oMSwgYSkpO1xuICAgIHJldHVybiAoYSA9PT0gMSA/IFwiaHNsKFwiIDogXCJoc2xhKFwiKVxuICAgICAgICArICh0aGlzLmggfHwgMCkgKyBcIiwgXCJcbiAgICAgICAgKyAodGhpcy5zIHx8IDApICogMTAwICsgXCIlLCBcIlxuICAgICAgICArICh0aGlzLmwgfHwgMCkgKiAxMDAgKyBcIiVcIlxuICAgICAgICArIChhID09PSAxID8gXCIpXCIgOiBcIiwgXCIgKyBhICsgXCIpXCIpO1xuICB9XG59KSk7XG5cbi8qIEZyb20gRnZEIDEzLjM3LCBDU1MgQ29sb3IgTW9kdWxlIExldmVsIDMgKi9cbmZ1bmN0aW9uIGhzbDJyZ2IoaCwgbTEsIG0yKSB7XG4gIHJldHVybiAoaCA8IDYwID8gbTEgKyAobTIgLSBtMSkgKiBoIC8gNjBcbiAgICAgIDogaCA8IDE4MCA/IG0yXG4gICAgICA6IGggPCAyNDAgPyBtMSArIChtMiAtIG0xKSAqICgyNDAgLSBoKSAvIDYwXG4gICAgICA6IG0xKSAqIDI1NTtcbn1cbiIsImltcG9ydCB7U2VsZWN0aW9ufSBmcm9tIFwiLi9pbmRleC5qc1wiO1xuaW1wb3J0IHNlbGVjdG9yIGZyb20gXCIuLi9zZWxlY3Rvci5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbihzZWxlY3QpIHtcbiAgaWYgKHR5cGVvZiBzZWxlY3QgIT09IFwiZnVuY3Rpb25cIikgc2VsZWN0ID0gc2VsZWN0b3Ioc2VsZWN0KTtcblxuICBmb3IgKHZhciBncm91cHMgPSB0aGlzLl9ncm91cHMsIG0gPSBncm91cHMubGVuZ3RoLCBzdWJncm91cHMgPSBuZXcgQXJyYXkobSksIGogPSAwOyBqIDwgbTsgKytqKSB7XG4gICAgZm9yICh2YXIgZ3JvdXAgPSBncm91cHNbal0sIG4gPSBncm91cC5sZW5ndGgsIHN1Ymdyb3VwID0gc3ViZ3JvdXBzW2pdID0gbmV3IEFycmF5KG4pLCBub2RlLCBzdWJub2RlLCBpID0gMDsgaSA8IG47ICsraSkge1xuICAgICAgaWYgKChub2RlID0gZ3JvdXBbaV0pICYmIChzdWJub2RlID0gc2VsZWN0LmNhbGwobm9kZSwgbm9kZS5fX2RhdGFfXywgaSwgZ3JvdXApKSkge1xuICAgICAgICBpZiAoXCJfX2RhdGFfX1wiIGluIG5vZGUpIHN1Ym5vZGUuX19kYXRhX18gPSBub2RlLl9fZGF0YV9fO1xuICAgICAgICBzdWJncm91cFtpXSA9IHN1Ym5vZGU7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG5ldyBTZWxlY3Rpb24oc3ViZ3JvdXBzLCB0aGlzLl9wYXJlbnRzKTtcbn1cbiIsImltcG9ydCB7U2VsZWN0aW9ufSBmcm9tIFwiLi9pbmRleC5qc1wiO1xuaW1wb3J0IGFycmF5IGZyb20gXCIuLi9hcnJheS5qc1wiO1xuaW1wb3J0IHNlbGVjdG9yQWxsIGZyb20gXCIuLi9zZWxlY3RvckFsbC5qc1wiO1xuXG5mdW5jdGlvbiBhcnJheUFsbChzZWxlY3QpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBhcnJheShzZWxlY3QuYXBwbHkodGhpcywgYXJndW1lbnRzKSk7XG4gIH07XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKHNlbGVjdCkge1xuICBpZiAodHlwZW9mIHNlbGVjdCA9PT0gXCJmdW5jdGlvblwiKSBzZWxlY3QgPSBhcnJheUFsbChzZWxlY3QpO1xuICBlbHNlIHNlbGVjdCA9IHNlbGVjdG9yQWxsKHNlbGVjdCk7XG5cbiAgZm9yICh2YXIgZ3JvdXBzID0gdGhpcy5fZ3JvdXBzLCBtID0gZ3JvdXBzLmxlbmd0aCwgc3ViZ3JvdXBzID0gW10sIHBhcmVudHMgPSBbXSwgaiA9IDA7IGogPCBtOyArK2opIHtcbiAgICBmb3IgKHZhciBncm91cCA9IGdyb3Vwc1tqXSwgbiA9IGdyb3VwLmxlbmd0aCwgbm9kZSwgaSA9IDA7IGkgPCBuOyArK2kpIHtcbiAgICAgIGlmIChub2RlID0gZ3JvdXBbaV0pIHtcbiAgICAgICAgc3ViZ3JvdXBzLnB1c2goc2VsZWN0LmNhbGwobm9kZSwgbm9kZS5fX2RhdGFfXywgaSwgZ3JvdXApKTtcbiAgICAgICAgcGFyZW50cy5wdXNoKG5vZGUpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBuZXcgU2VsZWN0aW9uKHN1Ymdyb3VwcywgcGFyZW50cyk7XG59XG4iLCJpbXBvcnQge1NlbGVjdGlvbn0gZnJvbSBcIi4vaW5kZXguanNcIjtcbmltcG9ydCBtYXRjaGVyIGZyb20gXCIuLi9tYXRjaGVyLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKG1hdGNoKSB7XG4gIGlmICh0eXBlb2YgbWF0Y2ggIT09IFwiZnVuY3Rpb25cIikgbWF0Y2ggPSBtYXRjaGVyKG1hdGNoKTtcblxuICBmb3IgKHZhciBncm91cHMgPSB0aGlzLl9ncm91cHMsIG0gPSBncm91cHMubGVuZ3RoLCBzdWJncm91cHMgPSBuZXcgQXJyYXkobSksIGogPSAwOyBqIDwgbTsgKytqKSB7XG4gICAgZm9yICh2YXIgZ3JvdXAgPSBncm91cHNbal0sIG4gPSBncm91cC5sZW5ndGgsIHN1Ymdyb3VwID0gc3ViZ3JvdXBzW2pdID0gW10sIG5vZGUsIGkgPSAwOyBpIDwgbjsgKytpKSB7XG4gICAgICBpZiAoKG5vZGUgPSBncm91cFtpXSkgJiYgbWF0Y2guY2FsbChub2RlLCBub2RlLl9fZGF0YV9fLCBpLCBncm91cCkpIHtcbiAgICAgICAgc3ViZ3JvdXAucHVzaChub2RlKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gbmV3IFNlbGVjdGlvbihzdWJncm91cHMsIHRoaXMuX3BhcmVudHMpO1xufVxuIiwiaW1wb3J0IHNwYXJzZSBmcm9tIFwiLi9zcGFyc2UuanNcIjtcbmltcG9ydCB7U2VsZWN0aW9ufSBmcm9tIFwiLi9pbmRleC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIG5ldyBTZWxlY3Rpb24odGhpcy5fZXhpdCB8fCB0aGlzLl9ncm91cHMubWFwKHNwYXJzZSksIHRoaXMuX3BhcmVudHMpO1xufVxuIiwiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24ob25lbnRlciwgb251cGRhdGUsIG9uZXhpdCkge1xuICB2YXIgZW50ZXIgPSB0aGlzLmVudGVyKCksIHVwZGF0ZSA9IHRoaXMsIGV4aXQgPSB0aGlzLmV4aXQoKTtcbiAgaWYgKHR5cGVvZiBvbmVudGVyID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICBlbnRlciA9IG9uZW50ZXIoZW50ZXIpO1xuICAgIGlmIChlbnRlcikgZW50ZXIgPSBlbnRlci5zZWxlY3Rpb24oKTtcbiAgfSBlbHNlIHtcbiAgICBlbnRlciA9IGVudGVyLmFwcGVuZChvbmVudGVyICsgXCJcIik7XG4gIH1cbiAgaWYgKG9udXBkYXRlICE9IG51bGwpIHtcbiAgICB1cGRhdGUgPSBvbnVwZGF0ZSh1cGRhdGUpO1xuICAgIGlmICh1cGRhdGUpIHVwZGF0ZSA9IHVwZGF0ZS5zZWxlY3Rpb24oKTtcbiAgfVxuICBpZiAob25leGl0ID09IG51bGwpIGV4aXQucmVtb3ZlKCk7IGVsc2Ugb25leGl0KGV4aXQpO1xuICByZXR1cm4gZW50ZXIgJiYgdXBkYXRlID8gZW50ZXIubWVyZ2UodXBkYXRlKS5vcmRlcigpIDogdXBkYXRlO1xufVxuIiwiaW1wb3J0IHtTZWxlY3Rpb259IGZyb20gXCIuL2luZGV4LmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKGNvbnRleHQpIHtcbiAgdmFyIHNlbGVjdGlvbiA9IGNvbnRleHQuc2VsZWN0aW9uID8gY29udGV4dC5zZWxlY3Rpb24oKSA6IGNvbnRleHQ7XG5cbiAgZm9yICh2YXIgZ3JvdXBzMCA9IHRoaXMuX2dyb3VwcywgZ3JvdXBzMSA9IHNlbGVjdGlvbi5fZ3JvdXBzLCBtMCA9IGdyb3VwczAubGVuZ3RoLCBtMSA9IGdyb3VwczEubGVuZ3RoLCBtID0gTWF0aC5taW4obTAsIG0xKSwgbWVyZ2VzID0gbmV3IEFycmF5KG0wKSwgaiA9IDA7IGogPCBtOyArK2opIHtcbiAgICBmb3IgKHZhciBncm91cDAgPSBncm91cHMwW2pdLCBncm91cDEgPSBncm91cHMxW2pdLCBuID0gZ3JvdXAwLmxlbmd0aCwgbWVyZ2UgPSBtZXJnZXNbal0gPSBuZXcgQXJyYXkobiksIG5vZGUsIGkgPSAwOyBpIDwgbjsgKytpKSB7XG4gICAgICBpZiAobm9kZSA9IGdyb3VwMFtpXSB8fCBncm91cDFbaV0pIHtcbiAgICAgICAgbWVyZ2VbaV0gPSBub2RlO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGZvciAoOyBqIDwgbTA7ICsraikge1xuICAgIG1lcmdlc1tqXSA9IGdyb3VwczBbal07XG4gIH1cblxuICByZXR1cm4gbmV3IFNlbGVjdGlvbihtZXJnZXMsIHRoaXMuX3BhcmVudHMpO1xufVxuIiwiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24oKSB7XG5cbiAgZm9yICh2YXIgZ3JvdXBzID0gdGhpcy5fZ3JvdXBzLCBqID0gLTEsIG0gPSBncm91cHMubGVuZ3RoOyArK2ogPCBtOykge1xuICAgIGZvciAodmFyIGdyb3VwID0gZ3JvdXBzW2pdLCBpID0gZ3JvdXAubGVuZ3RoIC0gMSwgbmV4dCA9IGdyb3VwW2ldLCBub2RlOyAtLWkgPj0gMDspIHtcbiAgICAgIGlmIChub2RlID0gZ3JvdXBbaV0pIHtcbiAgICAgICAgaWYgKG5leHQgJiYgbm9kZS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbihuZXh0KSBeIDQpIG5leHQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUobm9kZSwgbmV4dCk7XG4gICAgICAgIG5leHQgPSBub2RlO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiB0aGlzO1xufVxuIiwiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24oKSB7XG4gIHZhciBjYWxsYmFjayA9IGFyZ3VtZW50c1swXTtcbiAgYXJndW1lbnRzWzBdID0gdGhpcztcbiAgY2FsbGJhY2suYXBwbHkobnVsbCwgYXJndW1lbnRzKTtcbiAgcmV0dXJuIHRoaXM7XG59XG4iLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIEFycmF5LmZyb20odGhpcyk7XG59XG4iLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbigpIHtcblxuICBmb3IgKHZhciBncm91cHMgPSB0aGlzLl9ncm91cHMsIGogPSAwLCBtID0gZ3JvdXBzLmxlbmd0aDsgaiA8IG07ICsraikge1xuICAgIGZvciAodmFyIGdyb3VwID0gZ3JvdXBzW2pdLCBpID0gMCwgbiA9IGdyb3VwLmxlbmd0aDsgaSA8IG47ICsraSkge1xuICAgICAgdmFyIG5vZGUgPSBncm91cFtpXTtcbiAgICAgIGlmIChub2RlKSByZXR1cm4gbm9kZTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gbnVsbDtcbn1cbiIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKCkge1xuICBsZXQgc2l6ZSA9IDA7XG4gIGZvciAoY29uc3Qgbm9kZSBvZiB0aGlzKSArK3NpemU7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW51c2VkLXZhcnNcbiAgcmV0dXJuIHNpemU7XG59XG4iLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbigpIHtcbiAgcmV0dXJuICF0aGlzLm5vZGUoKTtcbn1cbiIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKGNhbGxiYWNrKSB7XG5cbiAgZm9yICh2YXIgZ3JvdXBzID0gdGhpcy5fZ3JvdXBzLCBqID0gMCwgbSA9IGdyb3Vwcy5sZW5ndGg7IGogPCBtOyArK2opIHtcbiAgICBmb3IgKHZhciBncm91cCA9IGdyb3Vwc1tqXSwgaSA9IDAsIG4gPSBncm91cC5sZW5ndGgsIG5vZGU7IGkgPCBuOyArK2kpIHtcbiAgICAgIGlmIChub2RlID0gZ3JvdXBbaV0pIGNhbGxiYWNrLmNhbGwobm9kZSwgbm9kZS5fX2RhdGFfXywgaSwgZ3JvdXApO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB0aGlzO1xufVxuIiwiaW1wb3J0IGNyZWF0b3IgZnJvbSBcIi4uL2NyZWF0b3IuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24obmFtZSkge1xuICB2YXIgY3JlYXRlID0gdHlwZW9mIG5hbWUgPT09IFwiZnVuY3Rpb25cIiA/IG5hbWUgOiBjcmVhdG9yKG5hbWUpO1xuICByZXR1cm4gdGhpcy5zZWxlY3QoZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuYXBwZW5kQ2hpbGQoY3JlYXRlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpO1xuICB9KTtcbn1cbiIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKHZhbHVlKSB7XG4gIHJldHVybiBhcmd1bWVudHMubGVuZ3RoXG4gICAgICA/IHRoaXMucHJvcGVydHkoXCJfX2RhdGFfX1wiLCB2YWx1ZSlcbiAgICAgIDogdGhpcy5ub2RlKCkuX19kYXRhX187XG59XG4iLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiooKSB7XG4gIGZvciAodmFyIGdyb3VwcyA9IHRoaXMuX2dyb3VwcywgaiA9IDAsIG0gPSBncm91cHMubGVuZ3RoOyBqIDwgbTsgKytqKSB7XG4gICAgZm9yICh2YXIgZ3JvdXAgPSBncm91cHNbal0sIGkgPSAwLCBuID0gZ3JvdXAubGVuZ3RoLCBub2RlOyBpIDwgbjsgKytpKSB7XG4gICAgICBpZiAobm9kZSA9IGdyb3VwW2ldKSB5aWVsZCBub2RlO1xuICAgIH1cbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgeCA9PiAoKSA9PiB4O1xuIiwiaW1wb3J0IGNvbnN0YW50IGZyb20gXCIuL2NvbnN0YW50LmpzXCI7XG5cbmZ1bmN0aW9uIGxpbmVhcihhLCBkKSB7XG4gIHJldHVybiBmdW5jdGlvbih0KSB7XG4gICAgcmV0dXJuIGEgKyB0ICogZDtcbiAgfTtcbn1cblxuZnVuY3Rpb24gZXhwb25lbnRpYWwoYSwgYiwgeSkge1xuICByZXR1cm4gYSA9IE1hdGgucG93KGEsIHkpLCBiID0gTWF0aC5wb3coYiwgeSkgLSBhLCB5ID0gMSAvIHksIGZ1bmN0aW9uKHQpIHtcbiAgICByZXR1cm4gTWF0aC5wb3coYSArIHQgKiBiLCB5KTtcbiAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGh1ZShhLCBiKSB7XG4gIHZhciBkID0gYiAtIGE7XG4gIHJldHVybiBkID8gbGluZWFyKGEsIGQgPiAxODAgfHwgZCA8IC0xODAgPyBkIC0gMzYwICogTWF0aC5yb3VuZChkIC8gMzYwKSA6IGQpIDogY29uc3RhbnQoaXNOYU4oYSkgPyBiIDogYSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnYW1tYSh5KSB7XG4gIHJldHVybiAoeSA9ICt5KSA9PT0gMSA/IG5vZ2FtbWEgOiBmdW5jdGlvbihhLCBiKSB7XG4gICAgcmV0dXJuIGIgLSBhID8gZXhwb25lbnRpYWwoYSwgYiwgeSkgOiBjb25zdGFudChpc05hTihhKSA/IGIgOiBhKTtcbiAgfTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gbm9nYW1tYShhLCBiKSB7XG4gIHZhciBkID0gYiAtIGE7XG4gIHJldHVybiBkID8gbGluZWFyKGEsIGQpIDogY29uc3RhbnQoaXNOYU4oYSkgPyBiIDogYSk7XG59XG4iLCJpbXBvcnQge3JnYiBhcyBjb2xvclJnYn0gZnJvbSBcImQzLWNvbG9yXCI7XG5pbXBvcnQgYmFzaXMgZnJvbSBcIi4vYmFzaXMuanNcIjtcbmltcG9ydCBiYXNpc0Nsb3NlZCBmcm9tIFwiLi9iYXNpc0Nsb3NlZC5qc1wiO1xuaW1wb3J0IG5vZ2FtbWEsIHtnYW1tYX0gZnJvbSBcIi4vY29sb3IuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgKGZ1bmN0aW9uIHJnYkdhbW1hKHkpIHtcbiAgdmFyIGNvbG9yID0gZ2FtbWEoeSk7XG5cbiAgZnVuY3Rpb24gcmdiKHN0YXJ0LCBlbmQpIHtcbiAgICB2YXIgciA9IGNvbG9yKChzdGFydCA9IGNvbG9yUmdiKHN0YXJ0KSkuciwgKGVuZCA9IGNvbG9yUmdiKGVuZCkpLnIpLFxuICAgICAgICBnID0gY29sb3Ioc3RhcnQuZywgZW5kLmcpLFxuICAgICAgICBiID0gY29sb3Ioc3RhcnQuYiwgZW5kLmIpLFxuICAgICAgICBvcGFjaXR5ID0gbm9nYW1tYShzdGFydC5vcGFjaXR5LCBlbmQub3BhY2l0eSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHQpIHtcbiAgICAgIHN0YXJ0LnIgPSByKHQpO1xuICAgICAgc3RhcnQuZyA9IGcodCk7XG4gICAgICBzdGFydC5iID0gYih0KTtcbiAgICAgIHN0YXJ0Lm9wYWNpdHkgPSBvcGFjaXR5KHQpO1xuICAgICAgcmV0dXJuIHN0YXJ0ICsgXCJcIjtcbiAgICB9O1xuICB9XG5cbiAgcmdiLmdhbW1hID0gcmdiR2FtbWE7XG5cbiAgcmV0dXJuIHJnYjtcbn0pKDEpO1xuXG5mdW5jdGlvbiByZ2JTcGxpbmUoc3BsaW5lKSB7XG4gIHJldHVybiBmdW5jdGlvbihjb2xvcnMpIHtcbiAgICB2YXIgbiA9IGNvbG9ycy5sZW5ndGgsXG4gICAgICAgIHIgPSBuZXcgQXJyYXkobiksXG4gICAgICAgIGcgPSBuZXcgQXJyYXkobiksXG4gICAgICAgIGIgPSBuZXcgQXJyYXkobiksXG4gICAgICAgIGksIGNvbG9yO1xuICAgIGZvciAoaSA9IDA7IGkgPCBuOyArK2kpIHtcbiAgICAgIGNvbG9yID0gY29sb3JSZ2IoY29sb3JzW2ldKTtcbiAgICAgIHJbaV0gPSBjb2xvci5yIHx8IDA7XG4gICAgICBnW2ldID0gY29sb3IuZyB8fCAwO1xuICAgICAgYltpXSA9IGNvbG9yLmIgfHwgMDtcbiAgICB9XG4gICAgciA9IHNwbGluZShyKTtcbiAgICBnID0gc3BsaW5lKGcpO1xuICAgIGIgPSBzcGxpbmUoYik7XG4gICAgY29sb3Iub3BhY2l0eSA9IDE7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHQpIHtcbiAgICAgIGNvbG9yLnIgPSByKHQpO1xuICAgICAgY29sb3IuZyA9IGcodCk7XG4gICAgICBjb2xvci5iID0gYih0KTtcbiAgICAgIHJldHVybiBjb2xvciArIFwiXCI7XG4gICAgfTtcbiAgfTtcbn1cblxuZXhwb3J0IHZhciByZ2JCYXNpcyA9IHJnYlNwbGluZShiYXNpcyk7XG5leHBvcnQgdmFyIHJnYkJhc2lzQ2xvc2VkID0gcmdiU3BsaW5lKGJhc2lzQ2xvc2VkKTtcbiIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKGEsIGIpIHtcbiAgcmV0dXJuIGEgPSArYSwgYiA9ICtiLCBmdW5jdGlvbih0KSB7XG4gICAgcmV0dXJuIGEgKiAoMSAtIHQpICsgYiAqIHQ7XG4gIH07XG59XG4iLCJpbXBvcnQgbnVtYmVyIGZyb20gXCIuL251bWJlci5qc1wiO1xuXG52YXIgcmVBID0gL1stK10/KD86XFxkK1xcLj9cXGQqfFxcLj9cXGQrKSg/OltlRV1bLStdP1xcZCspPy9nLFxuICAgIHJlQiA9IG5ldyBSZWdFeHAocmVBLnNvdXJjZSwgXCJnXCIpO1xuXG5mdW5jdGlvbiB6ZXJvKGIpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBiO1xuICB9O1xufVxuXG5mdW5jdGlvbiBvbmUoYikge1xuICByZXR1cm4gZnVuY3Rpb24odCkge1xuICAgIHJldHVybiBiKHQpICsgXCJcIjtcbiAgfTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24oYSwgYikge1xuICB2YXIgYmkgPSByZUEubGFzdEluZGV4ID0gcmVCLmxhc3RJbmRleCA9IDAsIC8vIHNjYW4gaW5kZXggZm9yIG5leHQgbnVtYmVyIGluIGJcbiAgICAgIGFtLCAvLyBjdXJyZW50IG1hdGNoIGluIGFcbiAgICAgIGJtLCAvLyBjdXJyZW50IG1hdGNoIGluIGJcbiAgICAgIGJzLCAvLyBzdHJpbmcgcHJlY2VkaW5nIGN1cnJlbnQgbnVtYmVyIGluIGIsIGlmIGFueVxuICAgICAgaSA9IC0xLCAvLyBpbmRleCBpbiBzXG4gICAgICBzID0gW10sIC8vIHN0cmluZyBjb25zdGFudHMgYW5kIHBsYWNlaG9sZGVyc1xuICAgICAgcSA9IFtdOyAvLyBudW1iZXIgaW50ZXJwb2xhdG9yc1xuXG4gIC8vIENvZXJjZSBpbnB1dHMgdG8gc3RyaW5ncy5cbiAgYSA9IGEgKyBcIlwiLCBiID0gYiArIFwiXCI7XG5cbiAgLy8gSW50ZXJwb2xhdGUgcGFpcnMgb2YgbnVtYmVycyBpbiBhICYgYi5cbiAgd2hpbGUgKChhbSA9IHJlQS5leGVjKGEpKVxuICAgICAgJiYgKGJtID0gcmVCLmV4ZWMoYikpKSB7XG4gICAgaWYgKChicyA9IGJtLmluZGV4KSA+IGJpKSB7IC8vIGEgc3RyaW5nIHByZWNlZGVzIHRoZSBuZXh0IG51bWJlciBpbiBiXG4gICAgICBicyA9IGIuc2xpY2UoYmksIGJzKTtcbiAgICAgIGlmIChzW2ldKSBzW2ldICs9IGJzOyAvLyBjb2FsZXNjZSB3aXRoIHByZXZpb3VzIHN0cmluZ1xuICAgICAgZWxzZSBzWysraV0gPSBicztcbiAgICB9XG4gICAgaWYgKChhbSA9IGFtWzBdKSA9PT0gKGJtID0gYm1bMF0pKSB7IC8vIG51bWJlcnMgaW4gYSAmIGIgbWF0Y2hcbiAgICAgIGlmIChzW2ldKSBzW2ldICs9IGJtOyAvLyBjb2FsZXNjZSB3aXRoIHByZXZpb3VzIHN0cmluZ1xuICAgICAgZWxzZSBzWysraV0gPSBibTtcbiAgICB9IGVsc2UgeyAvLyBpbnRlcnBvbGF0ZSBub24tbWF0Y2hpbmcgbnVtYmVyc1xuICAgICAgc1srK2ldID0gbnVsbDtcbiAgICAgIHEucHVzaCh7aTogaSwgeDogbnVtYmVyKGFtLCBibSl9KTtcbiAgICB9XG4gICAgYmkgPSByZUIubGFzdEluZGV4O1xuICB9XG5cbiAgLy8gQWRkIHJlbWFpbnMgb2YgYi5cbiAgaWYgKGJpIDwgYi5sZW5ndGgpIHtcbiAgICBicyA9IGIuc2xpY2UoYmkpO1xuICAgIGlmIChzW2ldKSBzW2ldICs9IGJzOyAvLyBjb2FsZXNjZSB3aXRoIHByZXZpb3VzIHN0cmluZ1xuICAgIGVsc2Ugc1srK2ldID0gYnM7XG4gIH1cblxuICAvLyBTcGVjaWFsIG9wdGltaXphdGlvbiBmb3Igb25seSBhIHNpbmdsZSBtYXRjaC5cbiAgLy8gT3RoZXJ3aXNlLCBpbnRlcnBvbGF0ZSBlYWNoIG9mIHRoZSBudW1iZXJzIGFuZCByZWpvaW4gdGhlIHN0cmluZy5cbiAgcmV0dXJuIHMubGVuZ3RoIDwgMiA/IChxWzBdXG4gICAgICA/IG9uZShxWzBdLngpXG4gICAgICA6IHplcm8oYikpXG4gICAgICA6IChiID0gcS5sZW5ndGgsIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbzsgaSA8IGI7ICsraSkgc1sobyA9IHFbaV0pLmldID0gby54KHQpO1xuICAgICAgICAgIHJldHVybiBzLmpvaW4oXCJcIik7XG4gICAgICAgIH0pO1xufVxuIiwidmFyIGRlZ3JlZXMgPSAxODAgLyBNYXRoLlBJO1xuXG5leHBvcnQgdmFyIGlkZW50aXR5ID0ge1xuICB0cmFuc2xhdGVYOiAwLFxuICB0cmFuc2xhdGVZOiAwLFxuICByb3RhdGU6IDAsXG4gIHNrZXdYOiAwLFxuICBzY2FsZVg6IDEsXG4gIHNjYWxlWTogMVxufTtcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24oYSwgYiwgYywgZCwgZSwgZikge1xuICB2YXIgc2NhbGVYLCBzY2FsZVksIHNrZXdYO1xuICBpZiAoc2NhbGVYID0gTWF0aC5zcXJ0KGEgKiBhICsgYiAqIGIpKSBhIC89IHNjYWxlWCwgYiAvPSBzY2FsZVg7XG4gIGlmIChza2V3WCA9IGEgKiBjICsgYiAqIGQpIGMgLT0gYSAqIHNrZXdYLCBkIC09IGIgKiBza2V3WDtcbiAgaWYgKHNjYWxlWSA9IE1hdGguc3FydChjICogYyArIGQgKiBkKSkgYyAvPSBzY2FsZVksIGQgLz0gc2NhbGVZLCBza2V3WCAvPSBzY2FsZVk7XG4gIGlmIChhICogZCA8IGIgKiBjKSBhID0gLWEsIGIgPSAtYiwgc2tld1ggPSAtc2tld1gsIHNjYWxlWCA9IC1zY2FsZVg7XG4gIHJldHVybiB7XG4gICAgdHJhbnNsYXRlWDogZSxcbiAgICB0cmFuc2xhdGVZOiBmLFxuICAgIHJvdGF0ZTogTWF0aC5hdGFuMihiLCBhKSAqIGRlZ3JlZXMsXG4gICAgc2tld1g6IE1hdGguYXRhbihza2V3WCkgKiBkZWdyZWVzLFxuICAgIHNjYWxlWDogc2NhbGVYLFxuICAgIHNjYWxlWTogc2NhbGVZXG4gIH07XG59XG4iLCJpbXBvcnQgZGVjb21wb3NlLCB7aWRlbnRpdHl9IGZyb20gXCIuL2RlY29tcG9zZS5qc1wiO1xuXG52YXIgc3ZnTm9kZTtcblxuLyogZXNsaW50LWRpc2FibGUgbm8tdW5kZWYgKi9cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZUNzcyh2YWx1ZSkge1xuICBjb25zdCBtID0gbmV3ICh0eXBlb2YgRE9NTWF0cml4ID09PSBcImZ1bmN0aW9uXCIgPyBET01NYXRyaXggOiBXZWJLaXRDU1NNYXRyaXgpKHZhbHVlICsgXCJcIik7XG4gIHJldHVybiBtLmlzSWRlbnRpdHkgPyBpZGVudGl0eSA6IGRlY29tcG9zZShtLmEsIG0uYiwgbS5jLCBtLmQsIG0uZSwgbS5mKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlU3ZnKHZhbHVlKSB7XG4gIGlmICh2YWx1ZSA9PSBudWxsKSByZXR1cm4gaWRlbnRpdHk7XG4gIGlmICghc3ZnTm9kZSkgc3ZnTm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyhcImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIsIFwiZ1wiKTtcbiAgc3ZnTm9kZS5zZXRBdHRyaWJ1dGUoXCJ0cmFuc2Zvcm1cIiwgdmFsdWUpO1xuICBpZiAoISh2YWx1ZSA9IHN2Z05vZGUudHJhbnNmb3JtLmJhc2VWYWwuY29uc29saWRhdGUoKSkpIHJldHVybiBpZGVudGl0eTtcbiAgdmFsdWUgPSB2YWx1ZS5tYXRyaXg7XG4gIHJldHVybiBkZWNvbXBvc2UodmFsdWUuYSwgdmFsdWUuYiwgdmFsdWUuYywgdmFsdWUuZCwgdmFsdWUuZSwgdmFsdWUuZik7XG59XG4iLCJpbXBvcnQgbnVtYmVyIGZyb20gXCIuLi9udW1iZXIuanNcIjtcbmltcG9ydCB7cGFyc2VDc3MsIHBhcnNlU3ZnfSBmcm9tIFwiLi9wYXJzZS5qc1wiO1xuXG5mdW5jdGlvbiBpbnRlcnBvbGF0ZVRyYW5zZm9ybShwYXJzZSwgcHhDb21tYSwgcHhQYXJlbiwgZGVnUGFyZW4pIHtcblxuICBmdW5jdGlvbiBwb3Aocykge1xuICAgIHJldHVybiBzLmxlbmd0aCA/IHMucG9wKCkgKyBcIiBcIiA6IFwiXCI7XG4gIH1cblxuICBmdW5jdGlvbiB0cmFuc2xhdGUoeGEsIHlhLCB4YiwgeWIsIHMsIHEpIHtcbiAgICBpZiAoeGEgIT09IHhiIHx8IHlhICE9PSB5Yikge1xuICAgICAgdmFyIGkgPSBzLnB1c2goXCJ0cmFuc2xhdGUoXCIsIG51bGwsIHB4Q29tbWEsIG51bGwsIHB4UGFyZW4pO1xuICAgICAgcS5wdXNoKHtpOiBpIC0gNCwgeDogbnVtYmVyKHhhLCB4Yil9LCB7aTogaSAtIDIsIHg6IG51bWJlcih5YSwgeWIpfSk7XG4gICAgfSBlbHNlIGlmICh4YiB8fCB5Yikge1xuICAgICAgcy5wdXNoKFwidHJhbnNsYXRlKFwiICsgeGIgKyBweENvbW1hICsgeWIgKyBweFBhcmVuKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiByb3RhdGUoYSwgYiwgcywgcSkge1xuICAgIGlmIChhICE9PSBiKSB7XG4gICAgICBpZiAoYSAtIGIgPiAxODApIGIgKz0gMzYwOyBlbHNlIGlmIChiIC0gYSA+IDE4MCkgYSArPSAzNjA7IC8vIHNob3J0ZXN0IHBhdGhcbiAgICAgIHEucHVzaCh7aTogcy5wdXNoKHBvcChzKSArIFwicm90YXRlKFwiLCBudWxsLCBkZWdQYXJlbikgLSAyLCB4OiBudW1iZXIoYSwgYil9KTtcbiAgICB9IGVsc2UgaWYgKGIpIHtcbiAgICAgIHMucHVzaChwb3AocykgKyBcInJvdGF0ZShcIiArIGIgKyBkZWdQYXJlbik7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gc2tld1goYSwgYiwgcywgcSkge1xuICAgIGlmIChhICE9PSBiKSB7XG4gICAgICBxLnB1c2goe2k6IHMucHVzaChwb3AocykgKyBcInNrZXdYKFwiLCBudWxsLCBkZWdQYXJlbikgLSAyLCB4OiBudW1iZXIoYSwgYil9KTtcbiAgICB9IGVsc2UgaWYgKGIpIHtcbiAgICAgIHMucHVzaChwb3AocykgKyBcInNrZXdYKFwiICsgYiArIGRlZ1BhcmVuKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBzY2FsZSh4YSwgeWEsIHhiLCB5YiwgcywgcSkge1xuICAgIGlmICh4YSAhPT0geGIgfHwgeWEgIT09IHliKSB7XG4gICAgICB2YXIgaSA9IHMucHVzaChwb3AocykgKyBcInNjYWxlKFwiLCBudWxsLCBcIixcIiwgbnVsbCwgXCIpXCIpO1xuICAgICAgcS5wdXNoKHtpOiBpIC0gNCwgeDogbnVtYmVyKHhhLCB4Yil9LCB7aTogaSAtIDIsIHg6IG51bWJlcih5YSwgeWIpfSk7XG4gICAgfSBlbHNlIGlmICh4YiAhPT0gMSB8fCB5YiAhPT0gMSkge1xuICAgICAgcy5wdXNoKHBvcChzKSArIFwic2NhbGUoXCIgKyB4YiArIFwiLFwiICsgeWIgKyBcIilcIik7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGZ1bmN0aW9uKGEsIGIpIHtcbiAgICB2YXIgcyA9IFtdLCAvLyBzdHJpbmcgY29uc3RhbnRzIGFuZCBwbGFjZWhvbGRlcnNcbiAgICAgICAgcSA9IFtdOyAvLyBudW1iZXIgaW50ZXJwb2xhdG9yc1xuICAgIGEgPSBwYXJzZShhKSwgYiA9IHBhcnNlKGIpO1xuICAgIHRyYW5zbGF0ZShhLnRyYW5zbGF0ZVgsIGEudHJhbnNsYXRlWSwgYi50cmFuc2xhdGVYLCBiLnRyYW5zbGF0ZVksIHMsIHEpO1xuICAgIHJvdGF0ZShhLnJvdGF0ZSwgYi5yb3RhdGUsIHMsIHEpO1xuICAgIHNrZXdYKGEuc2tld1gsIGIuc2tld1gsIHMsIHEpO1xuICAgIHNjYWxlKGEuc2NhbGVYLCBhLnNjYWxlWSwgYi5zY2FsZVgsIGIuc2NhbGVZLCBzLCBxKTtcbiAgICBhID0gYiA9IG51bGw7IC8vIGdjXG4gICAgcmV0dXJuIGZ1bmN0aW9uKHQpIHtcbiAgICAgIHZhciBpID0gLTEsIG4gPSBxLmxlbmd0aCwgbztcbiAgICAgIHdoaWxlICgrK2kgPCBuKSBzWyhvID0gcVtpXSkuaV0gPSBvLngodCk7XG4gICAgICByZXR1cm4gcy5qb2luKFwiXCIpO1xuICAgIH07XG4gIH07XG59XG5cbmV4cG9ydCB2YXIgaW50ZXJwb2xhdGVUcmFuc2Zvcm1Dc3MgPSBpbnRlcnBvbGF0ZVRyYW5zZm9ybShwYXJzZUNzcywgXCJweCwgXCIsIFwicHgpXCIsIFwiZGVnKVwiKTtcbmV4cG9ydCB2YXIgaW50ZXJwb2xhdGVUcmFuc2Zvcm1TdmcgPSBpbnRlcnBvbGF0ZVRyYW5zZm9ybShwYXJzZVN2ZywgXCIsIFwiLCBcIilcIiwgXCIpXCIpO1xuIiwidmFyIGZyYW1lID0gMCwgLy8gaXMgYW4gYW5pbWF0aW9uIGZyYW1lIHBlbmRpbmc/XG4gICAgdGltZW91dCA9IDAsIC8vIGlzIGEgdGltZW91dCBwZW5kaW5nP1xuICAgIGludGVydmFsID0gMCwgLy8gYXJlIGFueSB0aW1lcnMgYWN0aXZlP1xuICAgIHBva2VEZWxheSA9IDEwMDAsIC8vIGhvdyBmcmVxdWVudGx5IHdlIGNoZWNrIGZvciBjbG9jayBza2V3XG4gICAgdGFza0hlYWQsXG4gICAgdGFza1RhaWwsXG4gICAgY2xvY2tMYXN0ID0gMCxcbiAgICBjbG9ja05vdyA9IDAsXG4gICAgY2xvY2tTa2V3ID0gMCxcbiAgICBjbG9jayA9IHR5cGVvZiBwZXJmb3JtYW5jZSA9PT0gXCJvYmplY3RcIiAmJiBwZXJmb3JtYW5jZS5ub3cgPyBwZXJmb3JtYW5jZSA6IERhdGUsXG4gICAgc2V0RnJhbWUgPSB0eXBlb2Ygd2luZG93ID09PSBcIm9iamVjdFwiICYmIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgPyB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lLmJpbmQod2luZG93KSA6IGZ1bmN0aW9uKGYpIHsgc2V0VGltZW91dChmLCAxNyk7IH07XG5cbmV4cG9ydCBmdW5jdGlvbiBub3coKSB7XG4gIHJldHVybiBjbG9ja05vdyB8fCAoc2V0RnJhbWUoY2xlYXJOb3cpLCBjbG9ja05vdyA9IGNsb2NrLm5vdygpICsgY2xvY2tTa2V3KTtcbn1cblxuZnVuY3Rpb24gY2xlYXJOb3coKSB7XG4gIGNsb2NrTm93ID0gMDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIFRpbWVyKCkge1xuICB0aGlzLl9jYWxsID1cbiAgdGhpcy5fdGltZSA9XG4gIHRoaXMuX25leHQgPSBudWxsO1xufVxuXG5UaW1lci5wcm90b3R5cGUgPSB0aW1lci5wcm90b3R5cGUgPSB7XG4gIGNvbnN0cnVjdG9yOiBUaW1lcixcbiAgcmVzdGFydDogZnVuY3Rpb24oY2FsbGJhY2ssIGRlbGF5LCB0aW1lKSB7XG4gICAgaWYgKHR5cGVvZiBjYWxsYmFjayAhPT0gXCJmdW5jdGlvblwiKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiY2FsbGJhY2sgaXMgbm90IGEgZnVuY3Rpb25cIik7XG4gICAgdGltZSA9ICh0aW1lID09IG51bGwgPyBub3coKSA6ICt0aW1lKSArIChkZWxheSA9PSBudWxsID8gMCA6ICtkZWxheSk7XG4gICAgaWYgKCF0aGlzLl9uZXh0ICYmIHRhc2tUYWlsICE9PSB0aGlzKSB7XG4gICAgICBpZiAodGFza1RhaWwpIHRhc2tUYWlsLl9uZXh0ID0gdGhpcztcbiAgICAgIGVsc2UgdGFza0hlYWQgPSB0aGlzO1xuICAgICAgdGFza1RhaWwgPSB0aGlzO1xuICAgIH1cbiAgICB0aGlzLl9jYWxsID0gY2FsbGJhY2s7XG4gICAgdGhpcy5fdGltZSA9IHRpbWU7XG4gICAgc2xlZXAoKTtcbiAgfSxcbiAgc3RvcDogZnVuY3Rpb24oKSB7XG4gICAgaWYgKHRoaXMuX2NhbGwpIHtcbiAgICAgIHRoaXMuX2NhbGwgPSBudWxsO1xuICAgICAgdGhpcy5fdGltZSA9IEluZmluaXR5O1xuICAgICAgc2xlZXAoKTtcbiAgICB9XG4gIH1cbn07XG5cbmV4cG9ydCBmdW5jdGlvbiB0aW1lcihjYWxsYmFjaywgZGVsYXksIHRpbWUpIHtcbiAgdmFyIHQgPSBuZXcgVGltZXI7XG4gIHQucmVzdGFydChjYWxsYmFjaywgZGVsYXksIHRpbWUpO1xuICByZXR1cm4gdDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHRpbWVyRmx1c2goKSB7XG4gIG5vdygpOyAvLyBHZXQgdGhlIGN1cnJlbnQgdGltZSwgaWYgbm90IGFscmVhZHkgc2V0LlxuICArK2ZyYW1lOyAvLyBQcmV0ZW5kIHdl4oCZdmUgc2V0IGFuIGFsYXJtLCBpZiB3ZSBoYXZlbuKAmXQgYWxyZWFkeS5cbiAgdmFyIHQgPSB0YXNrSGVhZCwgZTtcbiAgd2hpbGUgKHQpIHtcbiAgICBpZiAoKGUgPSBjbG9ja05vdyAtIHQuX3RpbWUpID49IDApIHQuX2NhbGwuY2FsbCh1bmRlZmluZWQsIGUpO1xuICAgIHQgPSB0Ll9uZXh0O1xuICB9XG4gIC0tZnJhbWU7XG59XG5cbmZ1bmN0aW9uIHdha2UoKSB7XG4gIGNsb2NrTm93ID0gKGNsb2NrTGFzdCA9IGNsb2NrLm5vdygpKSArIGNsb2NrU2tldztcbiAgZnJhbWUgPSB0aW1lb3V0ID0gMDtcbiAgdHJ5IHtcbiAgICB0aW1lckZsdXNoKCk7XG4gIH0gZmluYWxseSB7XG4gICAgZnJhbWUgPSAwO1xuICAgIG5hcCgpO1xuICAgIGNsb2NrTm93ID0gMDtcbiAgfVxufVxuXG5mdW5jdGlvbiBwb2tlKCkge1xuICB2YXIgbm93ID0gY2xvY2subm93KCksIGRlbGF5ID0gbm93IC0gY2xvY2tMYXN0O1xuICBpZiAoZGVsYXkgPiBwb2tlRGVsYXkpIGNsb2NrU2tldyAtPSBkZWxheSwgY2xvY2tMYXN0ID0gbm93O1xufVxuXG5mdW5jdGlvbiBuYXAoKSB7XG4gIHZhciB0MCwgdDEgPSB0YXNrSGVhZCwgdDIsIHRpbWUgPSBJbmZpbml0eTtcbiAgd2hpbGUgKHQxKSB7XG4gICAgaWYgKHQxLl9jYWxsKSB7XG4gICAgICBpZiAodGltZSA+IHQxLl90aW1lKSB0aW1lID0gdDEuX3RpbWU7XG4gICAgICB0MCA9IHQxLCB0MSA9IHQxLl9uZXh0O1xuICAgIH0gZWxzZSB7XG4gICAgICB0MiA9IHQxLl9uZXh0LCB0MS5fbmV4dCA9IG51bGw7XG4gICAgICB0MSA9IHQwID8gdDAuX25leHQgPSB0MiA6IHRhc2tIZWFkID0gdDI7XG4gICAgfVxuICB9XG4gIHRhc2tUYWlsID0gdDA7XG4gIHNsZWVwKHRpbWUpO1xufVxuXG5mdW5jdGlvbiBzbGVlcCh0aW1lKSB7XG4gIGlmIChmcmFtZSkgcmV0dXJuOyAvLyBTb29uZXN0IGFsYXJtIGFscmVhZHkgc2V0LCBvciB3aWxsIGJlLlxuICBpZiAodGltZW91dCkgdGltZW91dCA9IGNsZWFyVGltZW91dCh0aW1lb3V0KTtcbiAgdmFyIGRlbGF5ID0gdGltZSAtIGNsb2NrTm93OyAvLyBTdHJpY3RseSBsZXNzIHRoYW4gaWYgd2UgcmVjb21wdXRlZCBjbG9ja05vdy5cbiAgaWYgKGRlbGF5ID4gMjQpIHtcbiAgICBpZiAodGltZSA8IEluZmluaXR5KSB0aW1lb3V0ID0gc2V0VGltZW91dCh3YWtlLCB0aW1lIC0gY2xvY2subm93KCkgLSBjbG9ja1NrZXcpO1xuICAgIGlmIChpbnRlcnZhbCkgaW50ZXJ2YWwgPSBjbGVhckludGVydmFsKGludGVydmFsKTtcbiAgfSBlbHNlIHtcbiAgICBpZiAoIWludGVydmFsKSBjbG9ja0xhc3QgPSBjbG9jay5ub3coKSwgaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChwb2tlLCBwb2tlRGVsYXkpO1xuICAgIGZyYW1lID0gMSwgc2V0RnJhbWUod2FrZSk7XG4gIH1cbn1cbiIsImltcG9ydCB7VGltZXJ9IGZyb20gXCIuL3RpbWVyLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKGNhbGxiYWNrLCBkZWxheSwgdGltZSkge1xuICB2YXIgdCA9IG5ldyBUaW1lcjtcbiAgZGVsYXkgPSBkZWxheSA9PSBudWxsID8gMCA6ICtkZWxheTtcbiAgdC5yZXN0YXJ0KGVsYXBzZWQgPT4ge1xuICAgIHQuc3RvcCgpO1xuICAgIGNhbGxiYWNrKGVsYXBzZWQgKyBkZWxheSk7XG4gIH0sIGRlbGF5LCB0aW1lKTtcbiAgcmV0dXJuIHQ7XG59XG4iLCJpbXBvcnQge2Rpc3BhdGNofSBmcm9tIFwiZDMtZGlzcGF0Y2hcIjtcbmltcG9ydCB7dGltZXIsIHRpbWVvdXR9IGZyb20gXCJkMy10aW1lclwiO1xuXG52YXIgZW1wdHlPbiA9IGRpc3BhdGNoKFwic3RhcnRcIiwgXCJlbmRcIiwgXCJjYW5jZWxcIiwgXCJpbnRlcnJ1cHRcIik7XG52YXIgZW1wdHlUd2VlbiA9IFtdO1xuXG5leHBvcnQgdmFyIENSRUFURUQgPSAwO1xuZXhwb3J0IHZhciBTQ0hFRFVMRUQgPSAxO1xuZXhwb3J0IHZhciBTVEFSVElORyA9IDI7XG5leHBvcnQgdmFyIFNUQVJURUQgPSAzO1xuZXhwb3J0IHZhciBSVU5OSU5HID0gNDtcbmV4cG9ydCB2YXIgRU5ESU5HID0gNTtcbmV4cG9ydCB2YXIgRU5ERUQgPSA2O1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbihub2RlLCBuYW1lLCBpZCwgaW5kZXgsIGdyb3VwLCB0aW1pbmcpIHtcbiAgdmFyIHNjaGVkdWxlcyA9IG5vZGUuX190cmFuc2l0aW9uO1xuICBpZiAoIXNjaGVkdWxlcykgbm9kZS5fX3RyYW5zaXRpb24gPSB7fTtcbiAgZWxzZSBpZiAoaWQgaW4gc2NoZWR1bGVzKSByZXR1cm47XG4gIGNyZWF0ZShub2RlLCBpZCwge1xuICAgIG5hbWU6IG5hbWUsXG4gICAgaW5kZXg6IGluZGV4LCAvLyBGb3IgY29udGV4dCBkdXJpbmcgY2FsbGJhY2suXG4gICAgZ3JvdXA6IGdyb3VwLCAvLyBGb3IgY29udGV4dCBkdXJpbmcgY2FsbGJhY2suXG4gICAgb246IGVtcHR5T24sXG4gICAgdHdlZW46IGVtcHR5VHdlZW4sXG4gICAgdGltZTogdGltaW5nLnRpbWUsXG4gICAgZGVsYXk6IHRpbWluZy5kZWxheSxcbiAgICBkdXJhdGlvbjogdGltaW5nLmR1cmF0aW9uLFxuICAgIGVhc2U6IHRpbWluZy5lYXNlLFxuICAgIHRpbWVyOiBudWxsLFxuICAgIHN0YXRlOiBDUkVBVEVEXG4gIH0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaW5pdChub2RlLCBpZCkge1xuICB2YXIgc2NoZWR1bGUgPSBnZXQobm9kZSwgaWQpO1xuICBpZiAoc2NoZWR1bGUuc3RhdGUgPiBDUkVBVEVEKSB0aHJvdyBuZXcgRXJyb3IoXCJ0b28gbGF0ZTsgYWxyZWFkeSBzY2hlZHVsZWRcIik7XG4gIHJldHVybiBzY2hlZHVsZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNldChub2RlLCBpZCkge1xuICB2YXIgc2NoZWR1bGUgPSBnZXQobm9kZSwgaWQpO1xuICBpZiAoc2NoZWR1bGUuc3RhdGUgPiBTVEFSVEVEKSB0aHJvdyBuZXcgRXJyb3IoXCJ0b28gbGF0ZTsgYWxyZWFkeSBydW5uaW5nXCIpO1xuICByZXR1cm4gc2NoZWR1bGU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXQobm9kZSwgaWQpIHtcbiAgdmFyIHNjaGVkdWxlID0gbm9kZS5fX3RyYW5zaXRpb247XG4gIGlmICghc2NoZWR1bGUgfHwgIShzY2hlZHVsZSA9IHNjaGVkdWxlW2lkXSkpIHRocm93IG5ldyBFcnJvcihcInRyYW5zaXRpb24gbm90IGZvdW5kXCIpO1xuICByZXR1cm4gc2NoZWR1bGU7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZShub2RlLCBpZCwgc2VsZikge1xuICB2YXIgc2NoZWR1bGVzID0gbm9kZS5fX3RyYW5zaXRpb24sXG4gICAgICB0d2VlbjtcblxuICAvLyBJbml0aWFsaXplIHRoZSBzZWxmIHRpbWVyIHdoZW4gdGhlIHRyYW5zaXRpb24gaXMgY3JlYXRlZC5cbiAgLy8gTm90ZSB0aGUgYWN0dWFsIGRlbGF5IGlzIG5vdCBrbm93biB1bnRpbCB0aGUgZmlyc3QgY2FsbGJhY2shXG4gIHNjaGVkdWxlc1tpZF0gPSBzZWxmO1xuICBzZWxmLnRpbWVyID0gdGltZXIoc2NoZWR1bGUsIDAsIHNlbGYudGltZSk7XG5cbiAgZnVuY3Rpb24gc2NoZWR1bGUoZWxhcHNlZCkge1xuICAgIHNlbGYuc3RhdGUgPSBTQ0hFRFVMRUQ7XG4gICAgc2VsZi50aW1lci5yZXN0YXJ0KHN0YXJ0LCBzZWxmLmRlbGF5LCBzZWxmLnRpbWUpO1xuXG4gICAgLy8gSWYgdGhlIGVsYXBzZWQgZGVsYXkgaXMgbGVzcyB0aGFuIG91ciBmaXJzdCBzbGVlcCwgc3RhcnQgaW1tZWRpYXRlbHkuXG4gICAgaWYgKHNlbGYuZGVsYXkgPD0gZWxhcHNlZCkgc3RhcnQoZWxhcHNlZCAtIHNlbGYuZGVsYXkpO1xuICB9XG5cbiAgZnVuY3Rpb24gc3RhcnQoZWxhcHNlZCkge1xuICAgIHZhciBpLCBqLCBuLCBvO1xuXG4gICAgLy8gSWYgdGhlIHN0YXRlIGlzIG5vdCBTQ0hFRFVMRUQsIHRoZW4gd2UgcHJldmlvdXNseSBlcnJvcmVkIG9uIHN0YXJ0LlxuICAgIGlmIChzZWxmLnN0YXRlICE9PSBTQ0hFRFVMRUQpIHJldHVybiBzdG9wKCk7XG5cbiAgICBmb3IgKGkgaW4gc2NoZWR1bGVzKSB7XG4gICAgICBvID0gc2NoZWR1bGVzW2ldO1xuICAgICAgaWYgKG8ubmFtZSAhPT0gc2VsZi5uYW1lKSBjb250aW51ZTtcblxuICAgICAgLy8gV2hpbGUgdGhpcyBlbGVtZW50IGFscmVhZHkgaGFzIGEgc3RhcnRpbmcgdHJhbnNpdGlvbiBkdXJpbmcgdGhpcyBmcmFtZSxcbiAgICAgIC8vIGRlZmVyIHN0YXJ0aW5nIGFuIGludGVycnVwdGluZyB0cmFuc2l0aW9uIHVudGlsIHRoYXQgdHJhbnNpdGlvbiBoYXMgYVxuICAgICAgLy8gY2hhbmNlIHRvIHRpY2sgKGFuZCBwb3NzaWJseSBlbmQpOyBzZWUgZDMvZDMtdHJhbnNpdGlvbiM1NCFcbiAgICAgIGlmIChvLnN0YXRlID09PSBTVEFSVEVEKSByZXR1cm4gdGltZW91dChzdGFydCk7XG5cbiAgICAgIC8vIEludGVycnVwdCB0aGUgYWN0aXZlIHRyYW5zaXRpb24sIGlmIGFueS5cbiAgICAgIGlmIChvLnN0YXRlID09PSBSVU5OSU5HKSB7XG4gICAgICAgIG8uc3RhdGUgPSBFTkRFRDtcbiAgICAgICAgby50aW1lci5zdG9wKCk7XG4gICAgICAgIG8ub24uY2FsbChcImludGVycnVwdFwiLCBub2RlLCBub2RlLl9fZGF0YV9fLCBvLmluZGV4LCBvLmdyb3VwKTtcbiAgICAgICAgZGVsZXRlIHNjaGVkdWxlc1tpXTtcbiAgICAgIH1cblxuICAgICAgLy8gQ2FuY2VsIGFueSBwcmUtZW1wdGVkIHRyYW5zaXRpb25zLlxuICAgICAgZWxzZSBpZiAoK2kgPCBpZCkge1xuICAgICAgICBvLnN0YXRlID0gRU5ERUQ7XG4gICAgICAgIG8udGltZXIuc3RvcCgpO1xuICAgICAgICBvLm9uLmNhbGwoXCJjYW5jZWxcIiwgbm9kZSwgbm9kZS5fX2RhdGFfXywgby5pbmRleCwgby5ncm91cCk7XG4gICAgICAgIGRlbGV0ZSBzY2hlZHVsZXNbaV07XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gRGVmZXIgdGhlIGZpcnN0IHRpY2sgdG8gZW5kIG9mIHRoZSBjdXJyZW50IGZyYW1lOyBzZWUgZDMvZDMjMTU3Ni5cbiAgICAvLyBOb3RlIHRoZSB0cmFuc2l0aW9uIG1heSBiZSBjYW5jZWxlZCBhZnRlciBzdGFydCBhbmQgYmVmb3JlIHRoZSBmaXJzdCB0aWNrIVxuICAgIC8vIE5vdGUgdGhpcyBtdXN0IGJlIHNjaGVkdWxlZCBiZWZvcmUgdGhlIHN0YXJ0IGV2ZW50OyBzZWUgZDMvZDMtdHJhbnNpdGlvbiMxNiFcbiAgICAvLyBBc3N1bWluZyB0aGlzIGlzIHN1Y2Nlc3NmdWwsIHN1YnNlcXVlbnQgY2FsbGJhY2tzIGdvIHN0cmFpZ2h0IHRvIHRpY2suXG4gICAgdGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgIGlmIChzZWxmLnN0YXRlID09PSBTVEFSVEVEKSB7XG4gICAgICAgIHNlbGYuc3RhdGUgPSBSVU5OSU5HO1xuICAgICAgICBzZWxmLnRpbWVyLnJlc3RhcnQodGljaywgc2VsZi5kZWxheSwgc2VsZi50aW1lKTtcbiAgICAgICAgdGljayhlbGFwc2VkKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIERpc3BhdGNoIHRoZSBzdGFydCBldmVudC5cbiAgICAvLyBOb3RlIHRoaXMgbXVzdCBiZSBkb25lIGJlZm9yZSB0aGUgdHdlZW4gYXJlIGluaXRpYWxpemVkLlxuICAgIHNlbGYuc3RhdGUgPSBTVEFSVElORztcbiAgICBzZWxmLm9uLmNhbGwoXCJzdGFydFwiLCBub2RlLCBub2RlLl9fZGF0YV9fLCBzZWxmLmluZGV4LCBzZWxmLmdyb3VwKTtcbiAgICBpZiAoc2VsZi5zdGF0ZSAhPT0gU1RBUlRJTkcpIHJldHVybjsgLy8gaW50ZXJydXB0ZWRcbiAgICBzZWxmLnN0YXRlID0gU1RBUlRFRDtcblxuICAgIC8vIEluaXRpYWxpemUgdGhlIHR3ZWVuLCBkZWxldGluZyBudWxsIHR3ZWVuLlxuICAgIHR3ZWVuID0gbmV3IEFycmF5KG4gPSBzZWxmLnR3ZWVuLmxlbmd0aCk7XG4gICAgZm9yIChpID0gMCwgaiA9IC0xOyBpIDwgbjsgKytpKSB7XG4gICAgICBpZiAobyA9IHNlbGYudHdlZW5baV0udmFsdWUuY2FsbChub2RlLCBub2RlLl9fZGF0YV9fLCBzZWxmLmluZGV4LCBzZWxmLmdyb3VwKSkge1xuICAgICAgICB0d2VlblsrK2pdID0gbztcbiAgICAgIH1cbiAgICB9XG4gICAgdHdlZW4ubGVuZ3RoID0gaiArIDE7XG4gIH1cblxuICBmdW5jdGlvbiB0aWNrKGVsYXBzZWQpIHtcbiAgICB2YXIgdCA9IGVsYXBzZWQgPCBzZWxmLmR1cmF0aW9uID8gc2VsZi5lYXNlLmNhbGwobnVsbCwgZWxhcHNlZCAvIHNlbGYuZHVyYXRpb24pIDogKHNlbGYudGltZXIucmVzdGFydChzdG9wKSwgc2VsZi5zdGF0ZSA9IEVORElORywgMSksXG4gICAgICAgIGkgPSAtMSxcbiAgICAgICAgbiA9IHR3ZWVuLmxlbmd0aDtcblxuICAgIHdoaWxlICgrK2kgPCBuKSB7XG4gICAgICB0d2VlbltpXS5jYWxsKG5vZGUsIHQpO1xuICAgIH1cblxuICAgIC8vIERpc3BhdGNoIHRoZSBlbmQgZXZlbnQuXG4gICAgaWYgKHNlbGYuc3RhdGUgPT09IEVORElORykge1xuICAgICAgc2VsZi5vbi5jYWxsKFwiZW5kXCIsIG5vZGUsIG5vZGUuX19kYXRhX18sIHNlbGYuaW5kZXgsIHNlbGYuZ3JvdXApO1xuICAgICAgc3RvcCgpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHN0b3AoKSB7XG4gICAgc2VsZi5zdGF0ZSA9IEVOREVEO1xuICAgIHNlbGYudGltZXIuc3RvcCgpO1xuICAgIGRlbGV0ZSBzY2hlZHVsZXNbaWRdO1xuICAgIGZvciAodmFyIGkgaW4gc2NoZWR1bGVzKSByZXR1cm47IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW51c2VkLXZhcnNcbiAgICBkZWxldGUgbm9kZS5fX3RyYW5zaXRpb247XG4gIH1cbn1cbiIsImltcG9ydCB7Z2V0LCBzZXR9IGZyb20gXCIuL3NjaGVkdWxlLmpzXCI7XG5cbmZ1bmN0aW9uIHR3ZWVuUmVtb3ZlKGlkLCBuYW1lKSB7XG4gIHZhciB0d2VlbjAsIHR3ZWVuMTtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHZhciBzY2hlZHVsZSA9IHNldCh0aGlzLCBpZCksXG4gICAgICAgIHR3ZWVuID0gc2NoZWR1bGUudHdlZW47XG5cbiAgICAvLyBJZiB0aGlzIG5vZGUgc2hhcmVkIHR3ZWVuIHdpdGggdGhlIHByZXZpb3VzIG5vZGUsXG4gICAgLy8ganVzdCBhc3NpZ24gdGhlIHVwZGF0ZWQgc2hhcmVkIHR3ZWVuIGFuZCB3ZeKAmXJlIGRvbmUhXG4gICAgLy8gT3RoZXJ3aXNlLCBjb3B5LW9uLXdyaXRlLlxuICAgIGlmICh0d2VlbiAhPT0gdHdlZW4wKSB7XG4gICAgICB0d2VlbjEgPSB0d2VlbjAgPSB0d2VlbjtcbiAgICAgIGZvciAodmFyIGkgPSAwLCBuID0gdHdlZW4xLmxlbmd0aDsgaSA8IG47ICsraSkge1xuICAgICAgICBpZiAodHdlZW4xW2ldLm5hbWUgPT09IG5hbWUpIHtcbiAgICAgICAgICB0d2VlbjEgPSB0d2VlbjEuc2xpY2UoKTtcbiAgICAgICAgICB0d2VlbjEuc3BsaWNlKGksIDEpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgc2NoZWR1bGUudHdlZW4gPSB0d2VlbjE7XG4gIH07XG59XG5cbmZ1bmN0aW9uIHR3ZWVuRnVuY3Rpb24oaWQsIG5hbWUsIHZhbHVlKSB7XG4gIHZhciB0d2VlbjAsIHR3ZWVuMTtcbiAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gXCJmdW5jdGlvblwiKSB0aHJvdyBuZXcgRXJyb3I7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICB2YXIgc2NoZWR1bGUgPSBzZXQodGhpcywgaWQpLFxuICAgICAgICB0d2VlbiA9IHNjaGVkdWxlLnR3ZWVuO1xuXG4gICAgLy8gSWYgdGhpcyBub2RlIHNoYXJlZCB0d2VlbiB3aXRoIHRoZSBwcmV2aW91cyBub2RlLFxuICAgIC8vIGp1c3QgYXNzaWduIHRoZSB1cGRhdGVkIHNoYXJlZCB0d2VlbiBhbmQgd2XigJlyZSBkb25lIVxuICAgIC8vIE90aGVyd2lzZSwgY29weS1vbi13cml0ZS5cbiAgICBpZiAodHdlZW4gIT09IHR3ZWVuMCkge1xuICAgICAgdHdlZW4xID0gKHR3ZWVuMCA9IHR3ZWVuKS5zbGljZSgpO1xuICAgICAgZm9yICh2YXIgdCA9IHtuYW1lOiBuYW1lLCB2YWx1ZTogdmFsdWV9LCBpID0gMCwgbiA9IHR3ZWVuMS5sZW5ndGg7IGkgPCBuOyArK2kpIHtcbiAgICAgICAgaWYgKHR3ZWVuMVtpXS5uYW1lID09PSBuYW1lKSB7XG4gICAgICAgICAgdHdlZW4xW2ldID0gdDtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKGkgPT09IG4pIHR3ZWVuMS5wdXNoKHQpO1xuICAgIH1cblxuICAgIHNjaGVkdWxlLnR3ZWVuID0gdHdlZW4xO1xuICB9O1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbihuYW1lLCB2YWx1ZSkge1xuICB2YXIgaWQgPSB0aGlzLl9pZDtcblxuICBuYW1lICs9IFwiXCI7XG5cbiAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPCAyKSB7XG4gICAgdmFyIHR3ZWVuID0gZ2V0KHRoaXMubm9kZSgpLCBpZCkudHdlZW47XG4gICAgZm9yICh2YXIgaSA9IDAsIG4gPSB0d2Vlbi5sZW5ndGgsIHQ7IGkgPCBuOyArK2kpIHtcbiAgICAgIGlmICgodCA9IHR3ZWVuW2ldKS5uYW1lID09PSBuYW1lKSB7XG4gICAgICAgIHJldHVybiB0LnZhbHVlO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIHJldHVybiB0aGlzLmVhY2goKHZhbHVlID09IG51bGwgPyB0d2VlblJlbW92ZSA6IHR3ZWVuRnVuY3Rpb24pKGlkLCBuYW1lLCB2YWx1ZSkpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdHdlZW5WYWx1ZSh0cmFuc2l0aW9uLCBuYW1lLCB2YWx1ZSkge1xuICB2YXIgaWQgPSB0cmFuc2l0aW9uLl9pZDtcblxuICB0cmFuc2l0aW9uLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgdmFyIHNjaGVkdWxlID0gc2V0KHRoaXMsIGlkKTtcbiAgICAoc2NoZWR1bGUudmFsdWUgfHwgKHNjaGVkdWxlLnZhbHVlID0ge30pKVtuYW1lXSA9IHZhbHVlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH0pO1xuXG4gIHJldHVybiBmdW5jdGlvbihub2RlKSB7XG4gICAgcmV0dXJuIGdldChub2RlLCBpZCkudmFsdWVbbmFtZV07XG4gIH07XG59XG4iLCJpbXBvcnQge2NvbG9yfSBmcm9tIFwiZDMtY29sb3JcIjtcbmltcG9ydCB7aW50ZXJwb2xhdGVOdW1iZXIsIGludGVycG9sYXRlUmdiLCBpbnRlcnBvbGF0ZVN0cmluZ30gZnJvbSBcImQzLWludGVycG9sYXRlXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKGEsIGIpIHtcbiAgdmFyIGM7XG4gIHJldHVybiAodHlwZW9mIGIgPT09IFwibnVtYmVyXCIgPyBpbnRlcnBvbGF0ZU51bWJlclxuICAgICAgOiBiIGluc3RhbmNlb2YgY29sb3IgPyBpbnRlcnBvbGF0ZVJnYlxuICAgICAgOiAoYyA9IGNvbG9yKGIpKSA/IChiID0gYywgaW50ZXJwb2xhdGVSZ2IpXG4gICAgICA6IGludGVycG9sYXRlU3RyaW5nKShhLCBiKTtcbn1cbiIsImltcG9ydCB7aW50ZXJwb2xhdGVUcmFuc2Zvcm1TdmcgYXMgaW50ZXJwb2xhdGVUcmFuc2Zvcm19IGZyb20gXCJkMy1pbnRlcnBvbGF0ZVwiO1xuaW1wb3J0IHtuYW1lc3BhY2V9IGZyb20gXCJkMy1zZWxlY3Rpb25cIjtcbmltcG9ydCB7dHdlZW5WYWx1ZX0gZnJvbSBcIi4vdHdlZW4uanNcIjtcbmltcG9ydCBpbnRlcnBvbGF0ZSBmcm9tIFwiLi9pbnRlcnBvbGF0ZS5qc1wiO1xuXG5mdW5jdGlvbiBhdHRyUmVtb3ZlKG5hbWUpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHRoaXMucmVtb3ZlQXR0cmlidXRlKG5hbWUpO1xuICB9O1xufVxuXG5mdW5jdGlvbiBhdHRyUmVtb3ZlTlMoZnVsbG5hbWUpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHRoaXMucmVtb3ZlQXR0cmlidXRlTlMoZnVsbG5hbWUuc3BhY2UsIGZ1bGxuYW1lLmxvY2FsKTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gYXR0ckNvbnN0YW50KG5hbWUsIGludGVycG9sYXRlLCB2YWx1ZTEpIHtcbiAgdmFyIHN0cmluZzAwLFxuICAgICAgc3RyaW5nMSA9IHZhbHVlMSArIFwiXCIsXG4gICAgICBpbnRlcnBvbGF0ZTA7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICB2YXIgc3RyaW5nMCA9IHRoaXMuZ2V0QXR0cmlidXRlKG5hbWUpO1xuICAgIHJldHVybiBzdHJpbmcwID09PSBzdHJpbmcxID8gbnVsbFxuICAgICAgICA6IHN0cmluZzAgPT09IHN0cmluZzAwID8gaW50ZXJwb2xhdGUwXG4gICAgICAgIDogaW50ZXJwb2xhdGUwID0gaW50ZXJwb2xhdGUoc3RyaW5nMDAgPSBzdHJpbmcwLCB2YWx1ZTEpO1xuICB9O1xufVxuXG5mdW5jdGlvbiBhdHRyQ29uc3RhbnROUyhmdWxsbmFtZSwgaW50ZXJwb2xhdGUsIHZhbHVlMSkge1xuICB2YXIgc3RyaW5nMDAsXG4gICAgICBzdHJpbmcxID0gdmFsdWUxICsgXCJcIixcbiAgICAgIGludGVycG9sYXRlMDtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHZhciBzdHJpbmcwID0gdGhpcy5nZXRBdHRyaWJ1dGVOUyhmdWxsbmFtZS5zcGFjZSwgZnVsbG5hbWUubG9jYWwpO1xuICAgIHJldHVybiBzdHJpbmcwID09PSBzdHJpbmcxID8gbnVsbFxuICAgICAgICA6IHN0cmluZzAgPT09IHN0cmluZzAwID8gaW50ZXJwb2xhdGUwXG4gICAgICAgIDogaW50ZXJwb2xhdGUwID0gaW50ZXJwb2xhdGUoc3RyaW5nMDAgPSBzdHJpbmcwLCB2YWx1ZTEpO1xuICB9O1xufVxuXG5mdW5jdGlvbiBhdHRyRnVuY3Rpb24obmFtZSwgaW50ZXJwb2xhdGUsIHZhbHVlKSB7XG4gIHZhciBzdHJpbmcwMCxcbiAgICAgIHN0cmluZzEwLFxuICAgICAgaW50ZXJwb2xhdGUwO1xuICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHN0cmluZzAsIHZhbHVlMSA9IHZhbHVlKHRoaXMpLCBzdHJpbmcxO1xuICAgIGlmICh2YWx1ZTEgPT0gbnVsbCkgcmV0dXJuIHZvaWQgdGhpcy5yZW1vdmVBdHRyaWJ1dGUobmFtZSk7XG4gICAgc3RyaW5nMCA9IHRoaXMuZ2V0QXR0cmlidXRlKG5hbWUpO1xuICAgIHN0cmluZzEgPSB2YWx1ZTEgKyBcIlwiO1xuICAgIHJldHVybiBzdHJpbmcwID09PSBzdHJpbmcxID8gbnVsbFxuICAgICAgICA6IHN0cmluZzAgPT09IHN0cmluZzAwICYmIHN0cmluZzEgPT09IHN0cmluZzEwID8gaW50ZXJwb2xhdGUwXG4gICAgICAgIDogKHN0cmluZzEwID0gc3RyaW5nMSwgaW50ZXJwb2xhdGUwID0gaW50ZXJwb2xhdGUoc3RyaW5nMDAgPSBzdHJpbmcwLCB2YWx1ZTEpKTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gYXR0ckZ1bmN0aW9uTlMoZnVsbG5hbWUsIGludGVycG9sYXRlLCB2YWx1ZSkge1xuICB2YXIgc3RyaW5nMDAsXG4gICAgICBzdHJpbmcxMCxcbiAgICAgIGludGVycG9sYXRlMDtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHZhciBzdHJpbmcwLCB2YWx1ZTEgPSB2YWx1ZSh0aGlzKSwgc3RyaW5nMTtcbiAgICBpZiAodmFsdWUxID09IG51bGwpIHJldHVybiB2b2lkIHRoaXMucmVtb3ZlQXR0cmlidXRlTlMoZnVsbG5hbWUuc3BhY2UsIGZ1bGxuYW1lLmxvY2FsKTtcbiAgICBzdHJpbmcwID0gdGhpcy5nZXRBdHRyaWJ1dGVOUyhmdWxsbmFtZS5zcGFjZSwgZnVsbG5hbWUubG9jYWwpO1xuICAgIHN0cmluZzEgPSB2YWx1ZTEgKyBcIlwiO1xuICAgIHJldHVybiBzdHJpbmcwID09PSBzdHJpbmcxID8gbnVsbFxuICAgICAgICA6IHN0cmluZzAgPT09IHN0cmluZzAwICYmIHN0cmluZzEgPT09IHN0cmluZzEwID8gaW50ZXJwb2xhdGUwXG4gICAgICAgIDogKHN0cmluZzEwID0gc3RyaW5nMSwgaW50ZXJwb2xhdGUwID0gaW50ZXJwb2xhdGUoc3RyaW5nMDAgPSBzdHJpbmcwLCB2YWx1ZTEpKTtcbiAgfTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24obmFtZSwgdmFsdWUpIHtcbiAgdmFyIGZ1bGxuYW1lID0gbmFtZXNwYWNlKG5hbWUpLCBpID0gZnVsbG5hbWUgPT09IFwidHJhbnNmb3JtXCIgPyBpbnRlcnBvbGF0ZVRyYW5zZm9ybSA6IGludGVycG9sYXRlO1xuICByZXR1cm4gdGhpcy5hdHRyVHdlZW4obmFtZSwgdHlwZW9mIHZhbHVlID09PSBcImZ1bmN0aW9uXCJcbiAgICAgID8gKGZ1bGxuYW1lLmxvY2FsID8gYXR0ckZ1bmN0aW9uTlMgOiBhdHRyRnVuY3Rpb24pKGZ1bGxuYW1lLCBpLCB0d2VlblZhbHVlKHRoaXMsIFwiYXR0ci5cIiArIG5hbWUsIHZhbHVlKSlcbiAgICAgIDogdmFsdWUgPT0gbnVsbCA/IChmdWxsbmFtZS5sb2NhbCA/IGF0dHJSZW1vdmVOUyA6IGF0dHJSZW1vdmUpKGZ1bGxuYW1lKVxuICAgICAgOiAoZnVsbG5hbWUubG9jYWwgPyBhdHRyQ29uc3RhbnROUyA6IGF0dHJDb25zdGFudCkoZnVsbG5hbWUsIGksIHZhbHVlKSk7XG59XG4iLCJpbXBvcnQge25hbWVzcGFjZX0gZnJvbSBcImQzLXNlbGVjdGlvblwiO1xuXG5mdW5jdGlvbiBhdHRySW50ZXJwb2xhdGUobmFtZSwgaSkge1xuICByZXR1cm4gZnVuY3Rpb24odCkge1xuICAgIHRoaXMuc2V0QXR0cmlidXRlKG5hbWUsIGkuY2FsbCh0aGlzLCB0KSk7XG4gIH07XG59XG5cbmZ1bmN0aW9uIGF0dHJJbnRlcnBvbGF0ZU5TKGZ1bGxuYW1lLCBpKSB7XG4gIHJldHVybiBmdW5jdGlvbih0KSB7XG4gICAgdGhpcy5zZXRBdHRyaWJ1dGVOUyhmdWxsbmFtZS5zcGFjZSwgZnVsbG5hbWUubG9jYWwsIGkuY2FsbCh0aGlzLCB0KSk7XG4gIH07XG59XG5cbmZ1bmN0aW9uIGF0dHJUd2Vlbk5TKGZ1bGxuYW1lLCB2YWx1ZSkge1xuICB2YXIgdDAsIGkwO1xuICBmdW5jdGlvbiB0d2VlbigpIHtcbiAgICB2YXIgaSA9IHZhbHVlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgaWYgKGkgIT09IGkwKSB0MCA9IChpMCA9IGkpICYmIGF0dHJJbnRlcnBvbGF0ZU5TKGZ1bGxuYW1lLCBpKTtcbiAgICByZXR1cm4gdDA7XG4gIH1cbiAgdHdlZW4uX3ZhbHVlID0gdmFsdWU7XG4gIHJldHVybiB0d2Vlbjtcbn1cblxuZnVuY3Rpb24gYXR0clR3ZWVuKG5hbWUsIHZhbHVlKSB7XG4gIHZhciB0MCwgaTA7XG4gIGZ1bmN0aW9uIHR3ZWVuKCkge1xuICAgIHZhciBpID0gdmFsdWUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICBpZiAoaSAhPT0gaTApIHQwID0gKGkwID0gaSkgJiYgYXR0ckludGVycG9sYXRlKG5hbWUsIGkpO1xuICAgIHJldHVybiB0MDtcbiAgfVxuICB0d2Vlbi5fdmFsdWUgPSB2YWx1ZTtcbiAgcmV0dXJuIHR3ZWVuO1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbihuYW1lLCB2YWx1ZSkge1xuICB2YXIga2V5ID0gXCJhdHRyLlwiICsgbmFtZTtcbiAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPCAyKSByZXR1cm4gKGtleSA9IHRoaXMudHdlZW4oa2V5KSkgJiYga2V5Ll92YWx1ZTtcbiAgaWYgKHZhbHVlID09IG51bGwpIHJldHVybiB0aGlzLnR3ZWVuKGtleSwgbnVsbCk7XG4gIGlmICh0eXBlb2YgdmFsdWUgIT09IFwiZnVuY3Rpb25cIikgdGhyb3cgbmV3IEVycm9yO1xuICB2YXIgZnVsbG5hbWUgPSBuYW1lc3BhY2UobmFtZSk7XG4gIHJldHVybiB0aGlzLnR3ZWVuKGtleSwgKGZ1bGxuYW1lLmxvY2FsID8gYXR0clR3ZWVuTlMgOiBhdHRyVHdlZW4pKGZ1bGxuYW1lLCB2YWx1ZSkpO1xufVxuIiwiaW1wb3J0IHtnZXQsIGluaXR9IGZyb20gXCIuL3NjaGVkdWxlLmpzXCI7XG5cbmZ1bmN0aW9uIGRlbGF5RnVuY3Rpb24oaWQsIHZhbHVlKSB7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICBpbml0KHRoaXMsIGlkKS5kZWxheSA9ICt2YWx1ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xufVxuXG5mdW5jdGlvbiBkZWxheUNvbnN0YW50KGlkLCB2YWx1ZSkge1xuICByZXR1cm4gdmFsdWUgPSArdmFsdWUsIGZ1bmN0aW9uKCkge1xuICAgIGluaXQodGhpcywgaWQpLmRlbGF5ID0gdmFsdWU7XG4gIH07XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKHZhbHVlKSB7XG4gIHZhciBpZCA9IHRoaXMuX2lkO1xuXG4gIHJldHVybiBhcmd1bWVudHMubGVuZ3RoXG4gICAgICA/IHRoaXMuZWFjaCgodHlwZW9mIHZhbHVlID09PSBcImZ1bmN0aW9uXCJcbiAgICAgICAgICA/IGRlbGF5RnVuY3Rpb25cbiAgICAgICAgICA6IGRlbGF5Q29uc3RhbnQpKGlkLCB2YWx1ZSkpXG4gICAgICA6IGdldCh0aGlzLm5vZGUoKSwgaWQpLmRlbGF5O1xufVxuIiwiaW1wb3J0IHtnZXQsIHNldH0gZnJvbSBcIi4vc2NoZWR1bGUuanNcIjtcblxuZnVuY3Rpb24gZHVyYXRpb25GdW5jdGlvbihpZCwgdmFsdWUpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHNldCh0aGlzLCBpZCkuZHVyYXRpb24gPSArdmFsdWUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gZHVyYXRpb25Db25zdGFudChpZCwgdmFsdWUpIHtcbiAgcmV0dXJuIHZhbHVlID0gK3ZhbHVlLCBmdW5jdGlvbigpIHtcbiAgICBzZXQodGhpcywgaWQpLmR1cmF0aW9uID0gdmFsdWU7XG4gIH07XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKHZhbHVlKSB7XG4gIHZhciBpZCA9IHRoaXMuX2lkO1xuXG4gIHJldHVybiBhcmd1bWVudHMubGVuZ3RoXG4gICAgICA/IHRoaXMuZWFjaCgodHlwZW9mIHZhbHVlID09PSBcImZ1bmN0aW9uXCJcbiAgICAgICAgICA/IGR1cmF0aW9uRnVuY3Rpb25cbiAgICAgICAgICA6IGR1cmF0aW9uQ29uc3RhbnQpKGlkLCB2YWx1ZSkpXG4gICAgICA6IGdldCh0aGlzLm5vZGUoKSwgaWQpLmR1cmF0aW9uO1xufVxuIiwiaW1wb3J0IHtnZXQsIHNldH0gZnJvbSBcIi4vc2NoZWR1bGUuanNcIjtcblxuZnVuY3Rpb24gZWFzZUNvbnN0YW50KGlkLCB2YWx1ZSkge1xuICBpZiAodHlwZW9mIHZhbHVlICE9PSBcImZ1bmN0aW9uXCIpIHRocm93IG5ldyBFcnJvcjtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHNldCh0aGlzLCBpZCkuZWFzZSA9IHZhbHVlO1xuICB9O1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbih2YWx1ZSkge1xuICB2YXIgaWQgPSB0aGlzLl9pZDtcblxuICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aFxuICAgICAgPyB0aGlzLmVhY2goZWFzZUNvbnN0YW50KGlkLCB2YWx1ZSkpXG4gICAgICA6IGdldCh0aGlzLm5vZGUoKSwgaWQpLmVhc2U7XG59XG4iLCJpbXBvcnQge2dldCwgc2V0LCBpbml0fSBmcm9tIFwiLi9zY2hlZHVsZS5qc1wiO1xuXG5mdW5jdGlvbiBzdGFydChuYW1lKSB7XG4gIHJldHVybiAobmFtZSArIFwiXCIpLnRyaW0oKS5zcGxpdCgvXnxcXHMrLykuZXZlcnkoZnVuY3Rpb24odCkge1xuICAgIHZhciBpID0gdC5pbmRleE9mKFwiLlwiKTtcbiAgICBpZiAoaSA+PSAwKSB0ID0gdC5zbGljZSgwLCBpKTtcbiAgICByZXR1cm4gIXQgfHwgdCA9PT0gXCJzdGFydFwiO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gb25GdW5jdGlvbihpZCwgbmFtZSwgbGlzdGVuZXIpIHtcbiAgdmFyIG9uMCwgb24xLCBzaXQgPSBzdGFydChuYW1lKSA/IGluaXQgOiBzZXQ7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICB2YXIgc2NoZWR1bGUgPSBzaXQodGhpcywgaWQpLFxuICAgICAgICBvbiA9IHNjaGVkdWxlLm9uO1xuXG4gICAgLy8gSWYgdGhpcyBub2RlIHNoYXJlZCBhIGRpc3BhdGNoIHdpdGggdGhlIHByZXZpb3VzIG5vZGUsXG4gICAgLy8ganVzdCBhc3NpZ24gdGhlIHVwZGF0ZWQgc2hhcmVkIGRpc3BhdGNoIGFuZCB3ZeKAmXJlIGRvbmUhXG4gICAgLy8gT3RoZXJ3aXNlLCBjb3B5LW9uLXdyaXRlLlxuICAgIGlmIChvbiAhPT0gb24wKSAob24xID0gKG9uMCA9IG9uKS5jb3B5KCkpLm9uKG5hbWUsIGxpc3RlbmVyKTtcblxuICAgIHNjaGVkdWxlLm9uID0gb24xO1xuICB9O1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbihuYW1lLCBsaXN0ZW5lcikge1xuICB2YXIgaWQgPSB0aGlzLl9pZDtcblxuICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA8IDJcbiAgICAgID8gZ2V0KHRoaXMubm9kZSgpLCBpZCkub24ub24obmFtZSlcbiAgICAgIDogdGhpcy5lYWNoKG9uRnVuY3Rpb24oaWQsIG5hbWUsIGxpc3RlbmVyKSk7XG59XG4iLCJpbXBvcnQge3NlbGVjdGlvbn0gZnJvbSBcImQzLXNlbGVjdGlvblwiO1xuXG52YXIgU2VsZWN0aW9uID0gc2VsZWN0aW9uLnByb3RvdHlwZS5jb25zdHJ1Y3RvcjtcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24oKSB7XG4gIHJldHVybiBuZXcgU2VsZWN0aW9uKHRoaXMuX2dyb3VwcywgdGhpcy5fcGFyZW50cyk7XG59XG4iLCJpbXBvcnQge2ludGVycG9sYXRlVHJhbnNmb3JtQ3NzIGFzIGludGVycG9sYXRlVHJhbnNmb3JtfSBmcm9tIFwiZDMtaW50ZXJwb2xhdGVcIjtcbmltcG9ydCB7c3R5bGV9IGZyb20gXCJkMy1zZWxlY3Rpb25cIjtcbmltcG9ydCB7c2V0fSBmcm9tIFwiLi9zY2hlZHVsZS5qc1wiO1xuaW1wb3J0IHt0d2VlblZhbHVlfSBmcm9tIFwiLi90d2Vlbi5qc1wiO1xuaW1wb3J0IGludGVycG9sYXRlIGZyb20gXCIuL2ludGVycG9sYXRlLmpzXCI7XG5cbmZ1bmN0aW9uIHN0eWxlTnVsbChuYW1lLCBpbnRlcnBvbGF0ZSkge1xuICB2YXIgc3RyaW5nMDAsXG4gICAgICBzdHJpbmcxMCxcbiAgICAgIGludGVycG9sYXRlMDtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHZhciBzdHJpbmcwID0gc3R5bGUodGhpcywgbmFtZSksXG4gICAgICAgIHN0cmluZzEgPSAodGhpcy5zdHlsZS5yZW1vdmVQcm9wZXJ0eShuYW1lKSwgc3R5bGUodGhpcywgbmFtZSkpO1xuICAgIHJldHVybiBzdHJpbmcwID09PSBzdHJpbmcxID8gbnVsbFxuICAgICAgICA6IHN0cmluZzAgPT09IHN0cmluZzAwICYmIHN0cmluZzEgPT09IHN0cmluZzEwID8gaW50ZXJwb2xhdGUwXG4gICAgICAgIDogaW50ZXJwb2xhdGUwID0gaW50ZXJwb2xhdGUoc3RyaW5nMDAgPSBzdHJpbmcwLCBzdHJpbmcxMCA9IHN0cmluZzEpO1xuICB9O1xufVxuXG5mdW5jdGlvbiBzdHlsZVJlbW92ZShuYW1lKSB7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLnN0eWxlLnJlbW92ZVByb3BlcnR5KG5hbWUpO1xuICB9O1xufVxuXG5mdW5jdGlvbiBzdHlsZUNvbnN0YW50KG5hbWUsIGludGVycG9sYXRlLCB2YWx1ZTEpIHtcbiAgdmFyIHN0cmluZzAwLFxuICAgICAgc3RyaW5nMSA9IHZhbHVlMSArIFwiXCIsXG4gICAgICBpbnRlcnBvbGF0ZTA7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICB2YXIgc3RyaW5nMCA9IHN0eWxlKHRoaXMsIG5hbWUpO1xuICAgIHJldHVybiBzdHJpbmcwID09PSBzdHJpbmcxID8gbnVsbFxuICAgICAgICA6IHN0cmluZzAgPT09IHN0cmluZzAwID8gaW50ZXJwb2xhdGUwXG4gICAgICAgIDogaW50ZXJwb2xhdGUwID0gaW50ZXJwb2xhdGUoc3RyaW5nMDAgPSBzdHJpbmcwLCB2YWx1ZTEpO1xuICB9O1xufVxuXG5mdW5jdGlvbiBzdHlsZUZ1bmN0aW9uKG5hbWUsIGludGVycG9sYXRlLCB2YWx1ZSkge1xuICB2YXIgc3RyaW5nMDAsXG4gICAgICBzdHJpbmcxMCxcbiAgICAgIGludGVycG9sYXRlMDtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHZhciBzdHJpbmcwID0gc3R5bGUodGhpcywgbmFtZSksXG4gICAgICAgIHZhbHVlMSA9IHZhbHVlKHRoaXMpLFxuICAgICAgICBzdHJpbmcxID0gdmFsdWUxICsgXCJcIjtcbiAgICBpZiAodmFsdWUxID09IG51bGwpIHN0cmluZzEgPSB2YWx1ZTEgPSAodGhpcy5zdHlsZS5yZW1vdmVQcm9wZXJ0eShuYW1lKSwgc3R5bGUodGhpcywgbmFtZSkpO1xuICAgIHJldHVybiBzdHJpbmcwID09PSBzdHJpbmcxID8gbnVsbFxuICAgICAgICA6IHN0cmluZzAgPT09IHN0cmluZzAwICYmIHN0cmluZzEgPT09IHN0cmluZzEwID8gaW50ZXJwb2xhdGUwXG4gICAgICAgIDogKHN0cmluZzEwID0gc3RyaW5nMSwgaW50ZXJwb2xhdGUwID0gaW50ZXJwb2xhdGUoc3RyaW5nMDAgPSBzdHJpbmcwLCB2YWx1ZTEpKTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gc3R5bGVNYXliZVJlbW92ZShpZCwgbmFtZSkge1xuICB2YXIgb24wLCBvbjEsIGxpc3RlbmVyMCwga2V5ID0gXCJzdHlsZS5cIiArIG5hbWUsIGV2ZW50ID0gXCJlbmQuXCIgKyBrZXksIHJlbW92ZTtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHZhciBzY2hlZHVsZSA9IHNldCh0aGlzLCBpZCksXG4gICAgICAgIG9uID0gc2NoZWR1bGUub24sXG4gICAgICAgIGxpc3RlbmVyID0gc2NoZWR1bGUudmFsdWVba2V5XSA9PSBudWxsID8gcmVtb3ZlIHx8IChyZW1vdmUgPSBzdHlsZVJlbW92ZShuYW1lKSkgOiB1bmRlZmluZWQ7XG5cbiAgICAvLyBJZiB0aGlzIG5vZGUgc2hhcmVkIGEgZGlzcGF0Y2ggd2l0aCB0aGUgcHJldmlvdXMgbm9kZSxcbiAgICAvLyBqdXN0IGFzc2lnbiB0aGUgdXBkYXRlZCBzaGFyZWQgZGlzcGF0Y2ggYW5kIHdl4oCZcmUgZG9uZSFcbiAgICAvLyBPdGhlcndpc2UsIGNvcHktb24td3JpdGUuXG4gICAgaWYgKG9uICE9PSBvbjAgfHwgbGlzdGVuZXIwICE9PSBsaXN0ZW5lcikgKG9uMSA9IChvbjAgPSBvbikuY29weSgpKS5vbihldmVudCwgbGlzdGVuZXIwID0gbGlzdGVuZXIpO1xuXG4gICAgc2NoZWR1bGUub24gPSBvbjE7XG4gIH07XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKG5hbWUsIHZhbHVlLCBwcmlvcml0eSkge1xuICB2YXIgaSA9IChuYW1lICs9IFwiXCIpID09PSBcInRyYW5zZm9ybVwiID8gaW50ZXJwb2xhdGVUcmFuc2Zvcm0gOiBpbnRlcnBvbGF0ZTtcbiAgcmV0dXJuIHZhbHVlID09IG51bGwgPyB0aGlzXG4gICAgICAuc3R5bGVUd2VlbihuYW1lLCBzdHlsZU51bGwobmFtZSwgaSkpXG4gICAgICAub24oXCJlbmQuc3R5bGUuXCIgKyBuYW1lLCBzdHlsZVJlbW92ZShuYW1lKSlcbiAgICA6IHR5cGVvZiB2YWx1ZSA9PT0gXCJmdW5jdGlvblwiID8gdGhpc1xuICAgICAgLnN0eWxlVHdlZW4obmFtZSwgc3R5bGVGdW5jdGlvbihuYW1lLCBpLCB0d2VlblZhbHVlKHRoaXMsIFwic3R5bGUuXCIgKyBuYW1lLCB2YWx1ZSkpKVxuICAgICAgLmVhY2goc3R5bGVNYXliZVJlbW92ZSh0aGlzLl9pZCwgbmFtZSkpXG4gICAgOiB0aGlzXG4gICAgICAuc3R5bGVUd2VlbihuYW1lLCBzdHlsZUNvbnN0YW50KG5hbWUsIGksIHZhbHVlKSwgcHJpb3JpdHkpXG4gICAgICAub24oXCJlbmQuc3R5bGUuXCIgKyBuYW1lLCBudWxsKTtcbn1cbiIsImZ1bmN0aW9uIHN0eWxlSW50ZXJwb2xhdGUobmFtZSwgaSwgcHJpb3JpdHkpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKHQpIHtcbiAgICB0aGlzLnN0eWxlLnNldFByb3BlcnR5KG5hbWUsIGkuY2FsbCh0aGlzLCB0KSwgcHJpb3JpdHkpO1xuICB9O1xufVxuXG5mdW5jdGlvbiBzdHlsZVR3ZWVuKG5hbWUsIHZhbHVlLCBwcmlvcml0eSkge1xuICB2YXIgdCwgaTA7XG4gIGZ1bmN0aW9uIHR3ZWVuKCkge1xuICAgIHZhciBpID0gdmFsdWUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICBpZiAoaSAhPT0gaTApIHQgPSAoaTAgPSBpKSAmJiBzdHlsZUludGVycG9sYXRlKG5hbWUsIGksIHByaW9yaXR5KTtcbiAgICByZXR1cm4gdDtcbiAgfVxuICB0d2Vlbi5fdmFsdWUgPSB2YWx1ZTtcbiAgcmV0dXJuIHR3ZWVuO1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbihuYW1lLCB2YWx1ZSwgcHJpb3JpdHkpIHtcbiAgdmFyIGtleSA9IFwic3R5bGUuXCIgKyAobmFtZSArPSBcIlwiKTtcbiAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPCAyKSByZXR1cm4gKGtleSA9IHRoaXMudHdlZW4oa2V5KSkgJiYga2V5Ll92YWx1ZTtcbiAgaWYgKHZhbHVlID09IG51bGwpIHJldHVybiB0aGlzLnR3ZWVuKGtleSwgbnVsbCk7XG4gIGlmICh0eXBlb2YgdmFsdWUgIT09IFwiZnVuY3Rpb25cIikgdGhyb3cgbmV3IEVycm9yO1xuICByZXR1cm4gdGhpcy50d2VlbihrZXksIHN0eWxlVHdlZW4obmFtZSwgdmFsdWUsIHByaW9yaXR5ID09IG51bGwgPyBcIlwiIDogcHJpb3JpdHkpKTtcbn1cbiIsImZ1bmN0aW9uIHRleHRJbnRlcnBvbGF0ZShpKSB7XG4gIHJldHVybiBmdW5jdGlvbih0KSB7XG4gICAgdGhpcy50ZXh0Q29udGVudCA9IGkuY2FsbCh0aGlzLCB0KTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gdGV4dFR3ZWVuKHZhbHVlKSB7XG4gIHZhciB0MCwgaTA7XG4gIGZ1bmN0aW9uIHR3ZWVuKCkge1xuICAgIHZhciBpID0gdmFsdWUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICBpZiAoaSAhPT0gaTApIHQwID0gKGkwID0gaSkgJiYgdGV4dEludGVycG9sYXRlKGkpO1xuICAgIHJldHVybiB0MDtcbiAgfVxuICB0d2Vlbi5fdmFsdWUgPSB2YWx1ZTtcbiAgcmV0dXJuIHR3ZWVuO1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbih2YWx1ZSkge1xuICB2YXIga2V5ID0gXCJ0ZXh0XCI7XG4gIGlmIChhcmd1bWVudHMubGVuZ3RoIDwgMSkgcmV0dXJuIChrZXkgPSB0aGlzLnR3ZWVuKGtleSkpICYmIGtleS5fdmFsdWU7XG4gIGlmICh2YWx1ZSA9PSBudWxsKSByZXR1cm4gdGhpcy50d2VlbihrZXksIG51bGwpO1xuICBpZiAodHlwZW9mIHZhbHVlICE9PSBcImZ1bmN0aW9uXCIpIHRocm93IG5ldyBFcnJvcjtcbiAgcmV0dXJuIHRoaXMudHdlZW4oa2V5LCB0ZXh0VHdlZW4odmFsdWUpKTtcbn1cbiIsImltcG9ydCB7c2VsZWN0aW9ufSBmcm9tIFwiZDMtc2VsZWN0aW9uXCI7XG5pbXBvcnQgdHJhbnNpdGlvbl9hdHRyIGZyb20gXCIuL2F0dHIuanNcIjtcbmltcG9ydCB0cmFuc2l0aW9uX2F0dHJUd2VlbiBmcm9tIFwiLi9hdHRyVHdlZW4uanNcIjtcbmltcG9ydCB0cmFuc2l0aW9uX2RlbGF5IGZyb20gXCIuL2RlbGF5LmpzXCI7XG5pbXBvcnQgdHJhbnNpdGlvbl9kdXJhdGlvbiBmcm9tIFwiLi9kdXJhdGlvbi5qc1wiO1xuaW1wb3J0IHRyYW5zaXRpb25fZWFzZSBmcm9tIFwiLi9lYXNlLmpzXCI7XG5pbXBvcnQgdHJhbnNpdGlvbl9lYXNlVmFyeWluZyBmcm9tIFwiLi9lYXNlVmFyeWluZy5qc1wiO1xuaW1wb3J0IHRyYW5zaXRpb25fZmlsdGVyIGZyb20gXCIuL2ZpbHRlci5qc1wiO1xuaW1wb3J0IHRyYW5zaXRpb25fbWVyZ2UgZnJvbSBcIi4vbWVyZ2UuanNcIjtcbmltcG9ydCB0cmFuc2l0aW9uX29uIGZyb20gXCIuL29uLmpzXCI7XG5pbXBvcnQgdHJhbnNpdGlvbl9yZW1vdmUgZnJvbSBcIi4vcmVtb3ZlLmpzXCI7XG5pbXBvcnQgdHJhbnNpdGlvbl9zZWxlY3QgZnJvbSBcIi4vc2VsZWN0LmpzXCI7XG5pbXBvcnQgdHJhbnNpdGlvbl9zZWxlY3RBbGwgZnJvbSBcIi4vc2VsZWN0QWxsLmpzXCI7XG5pbXBvcnQgdHJhbnNpdGlvbl9zZWxlY3Rpb24gZnJvbSBcIi4vc2VsZWN0aW9uLmpzXCI7XG5pbXBvcnQgdHJhbnNpdGlvbl9zdHlsZSBmcm9tIFwiLi9zdHlsZS5qc1wiO1xuaW1wb3J0IHRyYW5zaXRpb25fc3R5bGVUd2VlbiBmcm9tIFwiLi9zdHlsZVR3ZWVuLmpzXCI7XG5pbXBvcnQgdHJhbnNpdGlvbl90ZXh0IGZyb20gXCIuL3RleHQuanNcIjtcbmltcG9ydCB0cmFuc2l0aW9uX3RleHRUd2VlbiBmcm9tIFwiLi90ZXh0VHdlZW4uanNcIjtcbmltcG9ydCB0cmFuc2l0aW9uX3RyYW5zaXRpb24gZnJvbSBcIi4vdHJhbnNpdGlvbi5qc1wiO1xuaW1wb3J0IHRyYW5zaXRpb25fdHdlZW4gZnJvbSBcIi4vdHdlZW4uanNcIjtcbmltcG9ydCB0cmFuc2l0aW9uX2VuZCBmcm9tIFwiLi9lbmQuanNcIjtcblxudmFyIGlkID0gMDtcblxuZXhwb3J0IGZ1bmN0aW9uIFRyYW5zaXRpb24oZ3JvdXBzLCBwYXJlbnRzLCBuYW1lLCBpZCkge1xuICB0aGlzLl9ncm91cHMgPSBncm91cHM7XG4gIHRoaXMuX3BhcmVudHMgPSBwYXJlbnRzO1xuICB0aGlzLl9uYW1lID0gbmFtZTtcbiAgdGhpcy5faWQgPSBpZDtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gdHJhbnNpdGlvbihuYW1lKSB7XG4gIHJldHVybiBzZWxlY3Rpb24oKS50cmFuc2l0aW9uKG5hbWUpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbmV3SWQoKSB7XG4gIHJldHVybiArK2lkO1xufVxuXG52YXIgc2VsZWN0aW9uX3Byb3RvdHlwZSA9IHNlbGVjdGlvbi5wcm90b3R5cGU7XG5cblRyYW5zaXRpb24ucHJvdG90eXBlID0gdHJhbnNpdGlvbi5wcm90b3R5cGUgPSB7XG4gIGNvbnN0cnVjdG9yOiBUcmFuc2l0aW9uLFxuICBzZWxlY3Q6IHRyYW5zaXRpb25fc2VsZWN0LFxuICBzZWxlY3RBbGw6IHRyYW5zaXRpb25fc2VsZWN0QWxsLFxuICBzZWxlY3RDaGlsZDogc2VsZWN0aW9uX3Byb3RvdHlwZS5zZWxlY3RDaGlsZCxcbiAgc2VsZWN0Q2hpbGRyZW46IHNlbGVjdGlvbl9wcm90b3R5cGUuc2VsZWN0Q2hpbGRyZW4sXG4gIGZpbHRlcjogdHJhbnNpdGlvbl9maWx0ZXIsXG4gIG1lcmdlOiB0cmFuc2l0aW9uX21lcmdlLFxuICBzZWxlY3Rpb246IHRyYW5zaXRpb25fc2VsZWN0aW9uLFxuICB0cmFuc2l0aW9uOiB0cmFuc2l0aW9uX3RyYW5zaXRpb24sXG4gIGNhbGw6IHNlbGVjdGlvbl9wcm90b3R5cGUuY2FsbCxcbiAgbm9kZXM6IHNlbGVjdGlvbl9wcm90b3R5cGUubm9kZXMsXG4gIG5vZGU6IHNlbGVjdGlvbl9wcm90b3R5cGUubm9kZSxcbiAgc2l6ZTogc2VsZWN0aW9uX3Byb3RvdHlwZS5zaXplLFxuICBlbXB0eTogc2VsZWN0aW9uX3Byb3RvdHlwZS5lbXB0eSxcbiAgZWFjaDogc2VsZWN0aW9uX3Byb3RvdHlwZS5lYWNoLFxuICBvbjogdHJhbnNpdGlvbl9vbixcbiAgYXR0cjogdHJhbnNpdGlvbl9hdHRyLFxuICBhdHRyVHdlZW46IHRyYW5zaXRpb25fYXR0clR3ZWVuLFxuICBzdHlsZTogdHJhbnNpdGlvbl9zdHlsZSxcbiAgc3R5bGVUd2VlbjogdHJhbnNpdGlvbl9zdHlsZVR3ZWVuLFxuICB0ZXh0OiB0cmFuc2l0aW9uX3RleHQsXG4gIHRleHRUd2VlbjogdHJhbnNpdGlvbl90ZXh0VHdlZW4sXG4gIHJlbW92ZTogdHJhbnNpdGlvbl9yZW1vdmUsXG4gIHR3ZWVuOiB0cmFuc2l0aW9uX3R3ZWVuLFxuICBkZWxheTogdHJhbnNpdGlvbl9kZWxheSxcbiAgZHVyYXRpb246IHRyYW5zaXRpb25fZHVyYXRpb24sXG4gIGVhc2U6IHRyYW5zaXRpb25fZWFzZSxcbiAgZWFzZVZhcnlpbmc6IHRyYW5zaXRpb25fZWFzZVZhcnlpbmcsXG4gIGVuZDogdHJhbnNpdGlvbl9lbmQsXG4gIFtTeW1ib2wuaXRlcmF0b3JdOiBzZWxlY3Rpb25fcHJvdG90eXBlW1N5bWJvbC5pdGVyYXRvcl1cbn07XG4iLCJpbXBvcnQge3NlbGVjdG9yfSBmcm9tIFwiZDMtc2VsZWN0aW9uXCI7XG5pbXBvcnQge1RyYW5zaXRpb259IGZyb20gXCIuL2luZGV4LmpzXCI7XG5pbXBvcnQgc2NoZWR1bGUsIHtnZXR9IGZyb20gXCIuL3NjaGVkdWxlLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKHNlbGVjdCkge1xuICB2YXIgbmFtZSA9IHRoaXMuX25hbWUsXG4gICAgICBpZCA9IHRoaXMuX2lkO1xuXG4gIGlmICh0eXBlb2Ygc2VsZWN0ICE9PSBcImZ1bmN0aW9uXCIpIHNlbGVjdCA9IHNlbGVjdG9yKHNlbGVjdCk7XG5cbiAgZm9yICh2YXIgZ3JvdXBzID0gdGhpcy5fZ3JvdXBzLCBtID0gZ3JvdXBzLmxlbmd0aCwgc3ViZ3JvdXBzID0gbmV3IEFycmF5KG0pLCBqID0gMDsgaiA8IG07ICsraikge1xuICAgIGZvciAodmFyIGdyb3VwID0gZ3JvdXBzW2pdLCBuID0gZ3JvdXAubGVuZ3RoLCBzdWJncm91cCA9IHN1Ymdyb3Vwc1tqXSA9IG5ldyBBcnJheShuKSwgbm9kZSwgc3Vibm9kZSwgaSA9IDA7IGkgPCBuOyArK2kpIHtcbiAgICAgIGlmICgobm9kZSA9IGdyb3VwW2ldKSAmJiAoc3Vibm9kZSA9IHNlbGVjdC5jYWxsKG5vZGUsIG5vZGUuX19kYXRhX18sIGksIGdyb3VwKSkpIHtcbiAgICAgICAgaWYgKFwiX19kYXRhX19cIiBpbiBub2RlKSBzdWJub2RlLl9fZGF0YV9fID0gbm9kZS5fX2RhdGFfXztcbiAgICAgICAgc3ViZ3JvdXBbaV0gPSBzdWJub2RlO1xuICAgICAgICBzY2hlZHVsZShzdWJncm91cFtpXSwgbmFtZSwgaWQsIGksIHN1Ymdyb3VwLCBnZXQobm9kZSwgaWQpKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gbmV3IFRyYW5zaXRpb24oc3ViZ3JvdXBzLCB0aGlzLl9wYXJlbnRzLCBuYW1lLCBpZCk7XG59XG4iLCJpbXBvcnQge3NlbGVjdG9yQWxsfSBmcm9tIFwiZDMtc2VsZWN0aW9uXCI7XG5pbXBvcnQge1RyYW5zaXRpb259IGZyb20gXCIuL2luZGV4LmpzXCI7XG5pbXBvcnQgc2NoZWR1bGUsIHtnZXR9IGZyb20gXCIuL3NjaGVkdWxlLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKHNlbGVjdCkge1xuICB2YXIgbmFtZSA9IHRoaXMuX25hbWUsXG4gICAgICBpZCA9IHRoaXMuX2lkO1xuXG4gIGlmICh0eXBlb2Ygc2VsZWN0ICE9PSBcImZ1bmN0aW9uXCIpIHNlbGVjdCA9IHNlbGVjdG9yQWxsKHNlbGVjdCk7XG5cbiAgZm9yICh2YXIgZ3JvdXBzID0gdGhpcy5fZ3JvdXBzLCBtID0gZ3JvdXBzLmxlbmd0aCwgc3ViZ3JvdXBzID0gW10sIHBhcmVudHMgPSBbXSwgaiA9IDA7IGogPCBtOyArK2opIHtcbiAgICBmb3IgKHZhciBncm91cCA9IGdyb3Vwc1tqXSwgbiA9IGdyb3VwLmxlbmd0aCwgbm9kZSwgaSA9IDA7IGkgPCBuOyArK2kpIHtcbiAgICAgIGlmIChub2RlID0gZ3JvdXBbaV0pIHtcbiAgICAgICAgZm9yICh2YXIgY2hpbGRyZW4gPSBzZWxlY3QuY2FsbChub2RlLCBub2RlLl9fZGF0YV9fLCBpLCBncm91cCksIGNoaWxkLCBpbmhlcml0ID0gZ2V0KG5vZGUsIGlkKSwgayA9IDAsIGwgPSBjaGlsZHJlbi5sZW5ndGg7IGsgPCBsOyArK2spIHtcbiAgICAgICAgICBpZiAoY2hpbGQgPSBjaGlsZHJlbltrXSkge1xuICAgICAgICAgICAgc2NoZWR1bGUoY2hpbGQsIG5hbWUsIGlkLCBrLCBjaGlsZHJlbiwgaW5oZXJpdCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHN1Ymdyb3Vwcy5wdXNoKGNoaWxkcmVuKTtcbiAgICAgICAgcGFyZW50cy5wdXNoKG5vZGUpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBuZXcgVHJhbnNpdGlvbihzdWJncm91cHMsIHBhcmVudHMsIG5hbWUsIGlkKTtcbn1cbiIsImltcG9ydCB7bWF0Y2hlcn0gZnJvbSBcImQzLXNlbGVjdGlvblwiO1xuaW1wb3J0IHtUcmFuc2l0aW9ufSBmcm9tIFwiLi9pbmRleC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbihtYXRjaCkge1xuICBpZiAodHlwZW9mIG1hdGNoICE9PSBcImZ1bmN0aW9uXCIpIG1hdGNoID0gbWF0Y2hlcihtYXRjaCk7XG5cbiAgZm9yICh2YXIgZ3JvdXBzID0gdGhpcy5fZ3JvdXBzLCBtID0gZ3JvdXBzLmxlbmd0aCwgc3ViZ3JvdXBzID0gbmV3IEFycmF5KG0pLCBqID0gMDsgaiA8IG07ICsraikge1xuICAgIGZvciAodmFyIGdyb3VwID0gZ3JvdXBzW2pdLCBuID0gZ3JvdXAubGVuZ3RoLCBzdWJncm91cCA9IHN1Ymdyb3Vwc1tqXSA9IFtdLCBub2RlLCBpID0gMDsgaSA8IG47ICsraSkge1xuICAgICAgaWYgKChub2RlID0gZ3JvdXBbaV0pICYmIG1hdGNoLmNhbGwobm9kZSwgbm9kZS5fX2RhdGFfXywgaSwgZ3JvdXApKSB7XG4gICAgICAgIHN1Ymdyb3VwLnB1c2gobm9kZSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG5ldyBUcmFuc2l0aW9uKHN1Ymdyb3VwcywgdGhpcy5fcGFyZW50cywgdGhpcy5fbmFtZSwgdGhpcy5faWQpO1xufVxuIiwiaW1wb3J0IHtUcmFuc2l0aW9ufSBmcm9tIFwiLi9pbmRleC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbih0cmFuc2l0aW9uKSB7XG4gIGlmICh0cmFuc2l0aW9uLl9pZCAhPT0gdGhpcy5faWQpIHRocm93IG5ldyBFcnJvcjtcblxuICBmb3IgKHZhciBncm91cHMwID0gdGhpcy5fZ3JvdXBzLCBncm91cHMxID0gdHJhbnNpdGlvbi5fZ3JvdXBzLCBtMCA9IGdyb3VwczAubGVuZ3RoLCBtMSA9IGdyb3VwczEubGVuZ3RoLCBtID0gTWF0aC5taW4obTAsIG0xKSwgbWVyZ2VzID0gbmV3IEFycmF5KG0wKSwgaiA9IDA7IGogPCBtOyArK2opIHtcbiAgICBmb3IgKHZhciBncm91cDAgPSBncm91cHMwW2pdLCBncm91cDEgPSBncm91cHMxW2pdLCBuID0gZ3JvdXAwLmxlbmd0aCwgbWVyZ2UgPSBtZXJnZXNbal0gPSBuZXcgQXJyYXkobiksIG5vZGUsIGkgPSAwOyBpIDwgbjsgKytpKSB7XG4gICAgICBpZiAobm9kZSA9IGdyb3VwMFtpXSB8fCBncm91cDFbaV0pIHtcbiAgICAgICAgbWVyZ2VbaV0gPSBub2RlO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGZvciAoOyBqIDwgbTA7ICsraikge1xuICAgIG1lcmdlc1tqXSA9IGdyb3VwczBbal07XG4gIH1cblxuICByZXR1cm4gbmV3IFRyYW5zaXRpb24obWVyZ2VzLCB0aGlzLl9wYXJlbnRzLCB0aGlzLl9uYW1lLCB0aGlzLl9pZCk7XG59XG4iLCJpbXBvcnQge1RyYW5zaXRpb24sIG5ld0lkfSBmcm9tIFwiLi9pbmRleC5qc1wiO1xuaW1wb3J0IHNjaGVkdWxlLCB7Z2V0fSBmcm9tIFwiLi9zY2hlZHVsZS5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbigpIHtcbiAgdmFyIG5hbWUgPSB0aGlzLl9uYW1lLFxuICAgICAgaWQwID0gdGhpcy5faWQsXG4gICAgICBpZDEgPSBuZXdJZCgpO1xuXG4gIGZvciAodmFyIGdyb3VwcyA9IHRoaXMuX2dyb3VwcywgbSA9IGdyb3Vwcy5sZW5ndGgsIGogPSAwOyBqIDwgbTsgKytqKSB7XG4gICAgZm9yICh2YXIgZ3JvdXAgPSBncm91cHNbal0sIG4gPSBncm91cC5sZW5ndGgsIG5vZGUsIGkgPSAwOyBpIDwgbjsgKytpKSB7XG4gICAgICBpZiAobm9kZSA9IGdyb3VwW2ldKSB7XG4gICAgICAgIHZhciBpbmhlcml0ID0gZ2V0KG5vZGUsIGlkMCk7XG4gICAgICAgIHNjaGVkdWxlKG5vZGUsIG5hbWUsIGlkMSwgaSwgZ3JvdXAsIHtcbiAgICAgICAgICB0aW1lOiBpbmhlcml0LnRpbWUgKyBpbmhlcml0LmRlbGF5ICsgaW5oZXJpdC5kdXJhdGlvbixcbiAgICAgICAgICBkZWxheTogMCxcbiAgICAgICAgICBkdXJhdGlvbjogaW5oZXJpdC5kdXJhdGlvbixcbiAgICAgICAgICBlYXNlOiBpbmhlcml0LmVhc2VcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG5ldyBUcmFuc2l0aW9uKGdyb3VwcywgdGhpcy5fcGFyZW50cywgbmFtZSwgaWQxKTtcbn1cbiIsImltcG9ydCB7dHdlZW5WYWx1ZX0gZnJvbSBcIi4vdHdlZW4uanNcIjtcblxuZnVuY3Rpb24gdGV4dENvbnN0YW50KHZhbHVlKSB7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLnRleHRDb250ZW50ID0gdmFsdWU7XG4gIH07XG59XG5cbmZ1bmN0aW9uIHRleHRGdW5jdGlvbih2YWx1ZSkge1xuICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHZhbHVlMSA9IHZhbHVlKHRoaXMpO1xuICAgIHRoaXMudGV4dENvbnRlbnQgPSB2YWx1ZTEgPT0gbnVsbCA/IFwiXCIgOiB2YWx1ZTE7XG4gIH07XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKHZhbHVlKSB7XG4gIHJldHVybiB0aGlzLnR3ZWVuKFwidGV4dFwiLCB0eXBlb2YgdmFsdWUgPT09IFwiZnVuY3Rpb25cIlxuICAgICAgPyB0ZXh0RnVuY3Rpb24odHdlZW5WYWx1ZSh0aGlzLCBcInRleHRcIiwgdmFsdWUpKVxuICAgICAgOiB0ZXh0Q29uc3RhbnQodmFsdWUgPT0gbnVsbCA/IFwiXCIgOiB2YWx1ZSArIFwiXCIpKTtcbn1cbiIsImZ1bmN0aW9uIHJlbW92ZUZ1bmN0aW9uKGlkKSB7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICB2YXIgcGFyZW50ID0gdGhpcy5wYXJlbnROb2RlO1xuICAgIGZvciAodmFyIGkgaW4gdGhpcy5fX3RyYW5zaXRpb24pIGlmICgraSAhPT0gaWQpIHJldHVybjtcbiAgICBpZiAocGFyZW50KSBwYXJlbnQucmVtb3ZlQ2hpbGQodGhpcyk7XG4gIH07XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gdGhpcy5vbihcImVuZC5yZW1vdmVcIiwgcmVtb3ZlRnVuY3Rpb24odGhpcy5faWQpKTtcbn1cbiIsImltcG9ydCB7c2V0fSBmcm9tIFwiLi9zY2hlZHVsZS5qc1wiO1xuXG5mdW5jdGlvbiBlYXNlVmFyeWluZyhpZCwgdmFsdWUpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHZhciB2ID0gdmFsdWUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICBpZiAodHlwZW9mIHYgIT09IFwiZnVuY3Rpb25cIikgdGhyb3cgbmV3IEVycm9yO1xuICAgIHNldCh0aGlzLCBpZCkuZWFzZSA9IHY7XG4gIH07XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKHZhbHVlKSB7XG4gIGlmICh0eXBlb2YgdmFsdWUgIT09IFwiZnVuY3Rpb25cIikgdGhyb3cgbmV3IEVycm9yO1xuICByZXR1cm4gdGhpcy5lYWNoKGVhc2VWYXJ5aW5nKHRoaXMuX2lkLCB2YWx1ZSkpO1xufVxuIiwiaW1wb3J0IHtzZXR9IGZyb20gXCIuL3NjaGVkdWxlLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKCkge1xuICB2YXIgb24wLCBvbjEsIHRoYXQgPSB0aGlzLCBpZCA9IHRoYXQuX2lkLCBzaXplID0gdGhhdC5zaXplKCk7XG4gIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICB2YXIgY2FuY2VsID0ge3ZhbHVlOiByZWplY3R9LFxuICAgICAgICBlbmQgPSB7dmFsdWU6IGZ1bmN0aW9uKCkgeyBpZiAoLS1zaXplID09PSAwKSByZXNvbHZlKCk7IH19O1xuXG4gICAgdGhhdC5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHNjaGVkdWxlID0gc2V0KHRoaXMsIGlkKSxcbiAgICAgICAgICBvbiA9IHNjaGVkdWxlLm9uO1xuXG4gICAgICAvLyBJZiB0aGlzIG5vZGUgc2hhcmVkIGEgZGlzcGF0Y2ggd2l0aCB0aGUgcHJldmlvdXMgbm9kZSxcbiAgICAgIC8vIGp1c3QgYXNzaWduIHRoZSB1cGRhdGVkIHNoYXJlZCBkaXNwYXRjaCBhbmQgd2XigJlyZSBkb25lIVxuICAgICAgLy8gT3RoZXJ3aXNlLCBjb3B5LW9uLXdyaXRlLlxuICAgICAgaWYgKG9uICE9PSBvbjApIHtcbiAgICAgICAgb24xID0gKG9uMCA9IG9uKS5jb3B5KCk7XG4gICAgICAgIG9uMS5fLmNhbmNlbC5wdXNoKGNhbmNlbCk7XG4gICAgICAgIG9uMS5fLmludGVycnVwdC5wdXNoKGNhbmNlbCk7XG4gICAgICAgIG9uMS5fLmVuZC5wdXNoKGVuZCk7XG4gICAgICB9XG5cbiAgICAgIHNjaGVkdWxlLm9uID0gb24xO1xuICAgIH0pO1xuXG4gICAgLy8gVGhlIHNlbGVjdGlvbiB3YXMgZW1wdHksIHJlc29sdmUgZW5kIGltbWVkaWF0ZWx5XG4gICAgaWYgKHNpemUgPT09IDApIHJlc29sdmUoKTtcbiAgfSk7XG59XG4iLCJpbXBvcnQge1RyYW5zaXRpb24sIG5ld0lkfSBmcm9tIFwiLi4vdHJhbnNpdGlvbi9pbmRleC5qc1wiO1xuaW1wb3J0IHNjaGVkdWxlIGZyb20gXCIuLi90cmFuc2l0aW9uL3NjaGVkdWxlLmpzXCI7XG5pbXBvcnQge2Vhc2VDdWJpY0luT3V0fSBmcm9tIFwiZDMtZWFzZVwiO1xuaW1wb3J0IHtub3d9IGZyb20gXCJkMy10aW1lclwiO1xuXG52YXIgZGVmYXVsdFRpbWluZyA9IHtcbiAgdGltZTogbnVsbCwgLy8gU2V0IG9uIHVzZS5cbiAgZGVsYXk6IDAsXG4gIGR1cmF0aW9uOiAyNTAsXG4gIGVhc2U6IGVhc2VDdWJpY0luT3V0XG59O1xuXG5mdW5jdGlvbiBpbmhlcml0KG5vZGUsIGlkKSB7XG4gIHZhciB0aW1pbmc7XG4gIHdoaWxlICghKHRpbWluZyA9IG5vZGUuX190cmFuc2l0aW9uKSB8fCAhKHRpbWluZyA9IHRpbWluZ1tpZF0pKSB7XG4gICAgaWYgKCEobm9kZSA9IG5vZGUucGFyZW50Tm9kZSkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgdHJhbnNpdGlvbiAke2lkfSBub3QgZm91bmRgKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHRpbWluZztcbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24obmFtZSkge1xuICB2YXIgaWQsXG4gICAgICB0aW1pbmc7XG5cbiAgaWYgKG5hbWUgaW5zdGFuY2VvZiBUcmFuc2l0aW9uKSB7XG4gICAgaWQgPSBuYW1lLl9pZCwgbmFtZSA9IG5hbWUuX25hbWU7XG4gIH0gZWxzZSB7XG4gICAgaWQgPSBuZXdJZCgpLCAodGltaW5nID0gZGVmYXVsdFRpbWluZykudGltZSA9IG5vdygpLCBuYW1lID0gbmFtZSA9PSBudWxsID8gbnVsbCA6IG5hbWUgKyBcIlwiO1xuICB9XG5cbiAgZm9yICh2YXIgZ3JvdXBzID0gdGhpcy5fZ3JvdXBzLCBtID0gZ3JvdXBzLmxlbmd0aCwgaiA9IDA7IGogPCBtOyArK2opIHtcbiAgICBmb3IgKHZhciBncm91cCA9IGdyb3Vwc1tqXSwgbiA9IGdyb3VwLmxlbmd0aCwgbm9kZSwgaSA9IDA7IGkgPCBuOyArK2kpIHtcbiAgICAgIGlmIChub2RlID0gZ3JvdXBbaV0pIHtcbiAgICAgICAgc2NoZWR1bGUobm9kZSwgbmFtZSwgaWQsIGksIGdyb3VwLCB0aW1pbmcgfHwgaW5oZXJpdChub2RlLCBpZCkpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBuZXcgVHJhbnNpdGlvbihncm91cHMsIHRoaXMuX3BhcmVudHMsIG5hbWUsIGlkKTtcbn1cbiIsImV4cG9ydCBmdW5jdGlvbiBjdWJpY0luKHQpIHtcbiAgcmV0dXJuIHQgKiB0ICogdDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGN1YmljT3V0KHQpIHtcbiAgcmV0dXJuIC0tdCAqIHQgKiB0ICsgMTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGN1YmljSW5PdXQodCkge1xuICByZXR1cm4gKCh0ICo9IDIpIDw9IDEgPyB0ICogdCAqIHQgOiAodCAtPSAyKSAqIHQgKiB0ICsgMikgLyAyO1xufVxuIiwiaW1wb3J0IHtzZWxlY3Rpb259IGZyb20gXCJkMy1zZWxlY3Rpb25cIjtcbmltcG9ydCBzZWxlY3Rpb25faW50ZXJydXB0IGZyb20gXCIuL2ludGVycnVwdC5qc1wiO1xuaW1wb3J0IHNlbGVjdGlvbl90cmFuc2l0aW9uIGZyb20gXCIuL3RyYW5zaXRpb24uanNcIjtcblxuc2VsZWN0aW9uLnByb3RvdHlwZS5pbnRlcnJ1cHQgPSBzZWxlY3Rpb25faW50ZXJydXB0O1xuc2VsZWN0aW9uLnByb3RvdHlwZS50cmFuc2l0aW9uID0gc2VsZWN0aW9uX3RyYW5zaXRpb247XG4iLCJpbXBvcnQgaW50ZXJydXB0IGZyb20gXCIuLi9pbnRlcnJ1cHQuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24obmFtZSkge1xuICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkge1xuICAgIGludGVycnVwdCh0aGlzLCBuYW1lKTtcbiAgfSk7XG59XG4iLCJpbXBvcnQge1NUQVJUSU5HLCBFTkRJTkcsIEVOREVEfSBmcm9tIFwiLi90cmFuc2l0aW9uL3NjaGVkdWxlLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKG5vZGUsIG5hbWUpIHtcbiAgdmFyIHNjaGVkdWxlcyA9IG5vZGUuX190cmFuc2l0aW9uLFxuICAgICAgc2NoZWR1bGUsXG4gICAgICBhY3RpdmUsXG4gICAgICBlbXB0eSA9IHRydWUsXG4gICAgICBpO1xuXG4gIGlmICghc2NoZWR1bGVzKSByZXR1cm47XG5cbiAgbmFtZSA9IG5hbWUgPT0gbnVsbCA/IG51bGwgOiBuYW1lICsgXCJcIjtcblxuICBmb3IgKGkgaW4gc2NoZWR1bGVzKSB7XG4gICAgaWYgKChzY2hlZHVsZSA9IHNjaGVkdWxlc1tpXSkubmFtZSAhPT0gbmFtZSkgeyBlbXB0eSA9IGZhbHNlOyBjb250aW51ZTsgfVxuICAgIGFjdGl2ZSA9IHNjaGVkdWxlLnN0YXRlID4gU1RBUlRJTkcgJiYgc2NoZWR1bGUuc3RhdGUgPCBFTkRJTkc7XG4gICAgc2NoZWR1bGUuc3RhdGUgPSBFTkRFRDtcbiAgICBzY2hlZHVsZS50aW1lci5zdG9wKCk7XG4gICAgc2NoZWR1bGUub24uY2FsbChhY3RpdmUgPyBcImludGVycnVwdFwiIDogXCJjYW5jZWxcIiwgbm9kZSwgbm9kZS5fX2RhdGFfXywgc2NoZWR1bGUuaW5kZXgsIHNjaGVkdWxlLmdyb3VwKTtcbiAgICBkZWxldGUgc2NoZWR1bGVzW2ldO1xuICB9XG5cbiAgaWYgKGVtcHR5KSBkZWxldGUgbm9kZS5fX3RyYW5zaXRpb247XG59XG4iLCI8dGVtcGxhdGU+XG4gIDwhLS0gV2F2ZWZvcm0gZ29lcyBoZXJlIC0tPlxuICA8ZGl2IEBjbGljaz1cImNsaWNrXCI+XG4gICAgPHN2ZyByZWY9XCJzdmdcIiBzdHlsZT1cIi1ib3JkZXI6IDFweCBzb2xpZCByZWQ7IHdpZHRoOiAxMDAlOyBoZWlnaHQ6IDEwMCVcIj48L3N2Zz5cbiAgICA8ZGl2IHYtaWY9XCJzZWxlY3Rpb25cIlxuICAgICAgc3R5bGU9XCJwb3NpdGlvbjogYWJzb2x1dGU7IHRvcDogMHB4OyBoZWlnaHQ6IDEwMCU7IGxlZnQ6IDBweDsgbGVmdDogMHB4OyBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmYjsgcG9pbnRlci1ldmVudHM6IG5vbmU7IGJvcmRlci1sZWZ0OiAxcHggc29saWQgYmx1ZTsgYm9yZGVyLXJpZ2h0OiAxcHggc29saWQgYmx1ZVwiXG4gICAgICA6c3R5bGU9XCJ7IGxlZnQ6IChzZWxlY3Rpb24uc3RhcnQvZHVyYXRpb24gKiAxMDApICsgJyUnLCB3aWR0aDogKChzZWxlY3Rpb24uZW5kIC0gc2VsZWN0aW9uLnN0YXJ0KS9kdXJhdGlvbiAqIDEwMCkgKyAnJScgfVwiPjwvZGl2PlxuICAgIDwhLS0gPGRpdiB2LWZvcj1cIlwiIHJlZj1cImhpZ2hsaWdodHNcIj4gLS0+XG4gICAgPCEtLSA8L2Rpdj4gLS0+XG4gICAgPGRpdiBzdHlsZT1cInBvc2l0aW9uOiBhYnNvbHV0ZTsgdG9wOiAwcHg7IGhlaWdodDogMTAwJTsgd2lkdGg6IDBweDsgYm9yZGVyOiAxcHggc29saWQgcmVkOyBsZWZ0OiAwcHhcIiByZWY9XCJoZWFkXCIgOnN0eWxlPVwieyBsZWZ0OiAodGltZS9kdXJhdGlvbikgKiAxMDAgKyAnJScgfVwiPjwvZGl2PlxuXG5cbiAgPC9kaXY+XG48L3RlbXBsYXRlPlxuXG48c2NyaXB0PlxuaW1wb3J0ICogYXMgZDMgZnJvbSAnZDMnO1xuXG5leHBvcnQgZGVmYXVsdCB7XG4gIHByb3BzOiB7XG4gICAgbW9kZWxWYWx1ZTogW0ludDE2QXJyYXksIEludDMyQXJyYXksIEFycmF5XSxcbiAgICAvLyB0cmFuc2NyaXB0OiBPYmplY3QsXG4gICAgdGltZTogTnVtYmVyLFxuICAgIGR1cmF0aW9uOiBOdW1iZXIsXG4gICAgc2VsZWN0aW9uOiBPYmplY3QsXG4gIH0sXG5cbiAgZGF0YSgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgd2F2ZWZvcm06IHVuZGVmaW5lZCxcbiAgICAgIHN2ZzogdW5kZWZpbmVkLFxuICAgICAgZGF0YTogdW5kZWZpbmVkLFxuICAgIH07XG4gIH0sXG5cbiAgLy8gZW1pdHM6IFsndXBkYXRlOnRpbWUnXSxcblxuICBhc3luYyBtb3VudGVkKCkge1xuICAgIHRoaXMuJG9wdGlvbnMud2F0Y2gubW9kZWxWYWx1ZS5jYWxsKHRoaXMsIHRoaXMubW9kZWxWYWx1ZSk7XG4gICAgLy8gdGVtcG9yYXJ5IHdvcmthcm91bmQgKHJlcXVpcmVzIHByb3BlciBkaW1lbnNpb24gY2hhbmdlIGRldGVjdGlvbik6XG4gICAgLy8gcmVndWxhcmx5IChlYWNoIDIgc2Vjb25kcyBvciBzbykgY2hlY2sgZHJhd2luZyBhcmVhIGRpbWVuc2lvbnMgYW5kIHJlZHJhdyB3YXZlZm9ybSBpZiBjaGFuZ2VkXG4gICAgdGhpcy5yZXNpemVDaGVja0ludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgaWYodGhpcy5jdXJyZW50V2lkdGggIT0gdW5kZWZpbmVkICYmIHRoaXMuY3VycmVudEhlaWdodCAhPSB1bmRlZmluZWQgJiYgdGhpcy4kcmVmcy5zdmcgJiZcbiAgICAgICAgKHRoaXMuY3VycmVudFdpZHRoICE9IHRoaXMuJHJlZnMuc3ZnLmNsaWVudFdpZHRoIHx8IHRoaXMuY3VycmVudEhlaWdodCAhPSB0aGlzLiRyZWZzLnN2Zy5jbGllbnRIZWlnaHQpKSB7XG4gICAgICAgIHRoaXMuZHJhdygpO1xuICAgICAgfVxuICAgIH0sIDIwMDApO1xuICB9LFxuXG4gIHdhdGNoOiB7XG4gICAgbW9kZWxWYWx1ZSh2YWx1ZSkge1xuICAgICAgaWYodmFsdWUpIHtcbiAgICAgICAgaWYodmFsdWUgaW5zdGFuY2VvZiBJbnQxNkFycmF5KSB7XG4gICAgICAgICAgY29uc3QgZGF0YSA9IG5ldyBGbG9hdDMyQXJyYXkodmFsdWUpXG4gICAgICAgICAgdGhpcy5kYXRhID0gZGF0YS5tYXAoeCA9PiB4IC8gMHg4MDAwKTtcbiAgICAgICAgfSBlbHNlIGlmKHZhbHVlIGluc3RhbmNlb2YgRmxvYXQzMkFycmF5KSB7XG4gICAgICAgICAgdGhpcy5kYXRhID0gdmFsdWU7XG4gICAgICAgIH0gZWxzZSBpZih2YWx1ZSBpbnN0YW5jZW9mIEFycmF5ICYmIHZhbHVlLmxlbmd0aCA+IDAgJiYgdHlwZW9mIHZhbHVlWzBdID09PSAnbnVtYmVyJyAmJiB2YWx1ZVswXSA+PSAtMSAmJiB2YWx1ZVswXSA8PSAxKSB7XG4gICAgICAgICAgdGhpcy5kYXRhID0gdmFsdWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5kYXRhID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmRhdGEgPSB1bmRlZmluZWQ7XG4gICAgICB9XG4gICAgICB0aGlzLmRyYXcoKTtcbiAgICAgIC8vIGlmKHZhbHVlKSB7XG4gICAgICAvLyAgIGNvbnN0IG1pbiA9IGQzLm1pbih2YWx1ZSk7XG4gICAgICAvLyAgIGNvbnN0IGRhdGEgPSB2YWx1ZS5tYXAoKHksIHgpID0+ICh7IHgsIHkgfSkpO1xuICAgICAgLy8gICBkYXRhLnB1c2goeyB4OiBkYXRhLmxlbmd0aCwgeTogbWluIH0pO1xuICAgICAgLy8gICBkYXRhLnVuc2hpZnQoeyB4OiAwLCB5OiBtaW4gfSk7XG4gICAgICAvLyAgIHRoaXMud2F2ZWZvcm0gPSBkYXRhO1xuICAgICAgLy9cbiAgICAgIC8vICAgLy8gdGhpcy5kcmF3KCk7XG4gICAgICAvLyB9XG4gICAgfSxcbiAgICB0aW1lKHZhbHVlKSB7XG4gICAgICAvLyBjb25zb2xlLmxvZygndGltZSB1cGRhdGVkIHRvJywgdGhpcy50aW1lKTtcbiAgICAgIC8vIGNvbnN0IHdpZHRoID0gdGhpcy4kcmVmcy5zdmcuY2xpZW50V2lkdGg7XG4gICAgICAvLyBjb25zb2xlLmRpcih0aGlzLiRyZWZzLmhlYWQpO1xuICAgICAgLy8gdGhpcy4kcmVmcy5oZWFkLnN0eWxlLmxlZnQgPSBgJHt2YWx1ZS8xMDAwL3RoaXMuZHVyYXRpb24gKiAxMDB9JWA7XG4gICAgfSxcbiAgfSxcblxuICBtZXRob2RzOiB7XG5cbiAgICBjbGljayhldmVudCkge1xuICAgICAgLy8gY29uc29sZS5sb2coZXZlbnQpXG4gICAgICBjb25zdCB4ID0gZXZlbnQub2Zmc2V0WDtcbiAgICAgIGNvbnN0IHdpZHRoID0gdGhpcy4kcmVmcy5zdmcuY2xpZW50V2lkdGg7XG4gICAgICBjb25zdCB0aW1lID0geCAvIHdpZHRoICogdGhpcy5kdXJhdGlvbjtcbiAgICAgIC8vIGNvbnNvbGUubG9nKCduZXcgdGltZScsIHRpbWUpXG4gICAgICB0aGlzLiRlbWl0KCd1cGRhdGU6dGltZScsIHRpbWUpO1xuICAgIH0sXG5cbiAgICBkcmF3KHdpZHRoID0gdW5kZWZpbmVkLCBoZWlnaHQgPSB1bmRlZmluZWQpIHtcbiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7XG5cbiAgICAgIHdpZHRoID0gd2lkdGggfHwgdGhpcy4kcmVmcy5zdmcuY2xpZW50V2lkdGg7XG4gICAgICBoZWlnaHQgPSBoZWlnaHQgfHwgdGhpcy4kcmVmcy5zdmcuY2xpZW50SGVpZ2h0O1xuICAgICAgdGhpcy5jdXJyZW50V2lkdGggPSB3aWR0aDtcbiAgICAgIHRoaXMuY3VycmVudEhlaWdodCA9IGhlaWdodDtcblxuICAgICAgY29uc3Qgc3ZnID0gZDMuc2VsZWN0KHRoaXMuJHJlZnMuc3ZnKTtcblxuICAgICAgaWYoIWRhdGEpIHtcbiAgICAgICAgc3ZnLnNlbGVjdEFsbCgnKicpLnJlbW92ZSgpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cblxuICAgICAgc3ZnLmF0dHIoJ2hlaWdodCcsIGhlaWdodCkuYXR0cignd2lkdGgnLCB3aWR0aCk7XG5cbiAgICAgIC8vIGNvbnNvbGUubG9nKGhlaWdodCwgd2lkdGgpXG5cbiAgICAgIC8vIGh0dHA6Ly9qb2VzdWwubGkvdmFuLzIwMTQvMDMvZHJhd2luZy13YXZlZm9ybXMvXG4gICAgICBmdW5jdGlvbiBzdW1tYXJpemUoIGRhdGEsIHBpeGVscyApIHtcbiAgICAgICAgdmFyIHBpeGVsTGVuZ3RoID0gTWF0aC5yb3VuZChkYXRhLmxlbmd0aC9waXhlbHMpO1xuICAgICAgICB2YXIgdmFscyA9IFtdO1xuXG4gICAgICAgIC8vIEZvciBlYWNoIHBpeGVsIHdlIGRpc3BsYXlcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwaXhlbHM7IGkrKykge1xuICAgICAgICAgIHZhciBwb3NTdW0gPSAwLFxuICAgICAgICAgICAgbmVnU3VtID0gMDtcblxuICAgICAgICAgIC8vIEN5Y2xlIHRocm91Z2ggdGhlIGRhdGEtcG9pbnRzIHJlbGV2YW50IHRvIHRoZSBwaXhlbFxuICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgcGl4ZWxMZW5ndGg7IGorKykge1xuICAgICAgICAgICAgdmFyIHZhbCA9IGRhdGFbIGkgKiBwaXhlbExlbmd0aCArIGogXTtcbiAgICAgICAgICAgIGlmKGkgKiBwaXhlbExlbmd0aCArIGogPj0gZGF0YS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEtlZXAgdHJhY2sgb2YgcG9zaXRpdmUgYW5kIG5lZ2F0aXZlIHZhbHVlcyBzZXBhcmF0ZWx5XG4gICAgICAgICAgICBpZiAodmFsID4gMCkge1xuICAgICAgICAgICAgICBwb3NTdW0gKz0gdmFsO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgbmVnU3VtICs9IHZhbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgdmFscy5wdXNoKCBbIG5lZ1N1bSAvIHBpeGVsTGVuZ3RoLCBwb3NTdW0gLyBwaXhlbExlbmd0aCBdICk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbHM7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIHN1bW1hcml6ZUZhc3RlciggZGF0YSwgcGl4ZWxzICkge1xuICAgICAgICB2YXIgcGl4ZWxMZW5ndGggPSBNYXRoLnJvdW5kKGRhdGEubGVuZ3RoL3BpeGVscyk7XG4gICAgICAgIHZhciB2YWxzID0gW107XG5cbiAgICAgICAgLy8gRGVmaW5lIGEgbWluaW11bSBzYW1wbGUgc2l6ZSBwZXIgcGl4ZWxcbiAgICAgICAgdmFyIG1heFNhbXBsZVNpemUgPSAxMDAwO1xuICAgICAgICBjb25zdCBzYW1wbGVTaXplID0gTWF0aC5taW4ocGl4ZWxMZW5ndGgsIG1heFNhbXBsZVNpemUpO1xuXG5cbiAgICAgICAgLy8gRm9yIGVhY2ggcGl4ZWwgd2UgZGlzcGxheVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBpeGVsczsgaSsrKSB7XG4gICAgICAgICAgdmFyIHBvc1N1bSA9IDAsXG4gICAgICAgICAgICBuZWdTdW0gPSAwO1xuXG4gICAgICAgICAgLy8gQ3ljbGUgdGhyb3VnaCB0aGUgZGF0YS1wb2ludHMgcmVsZXZhbnQgdG8gdGhlIHBpeGVsXG4gICAgICAgICAgLy8gRG9uJ3QgY3ljbGUgdGhyb3VnaCBtb3JlIHRoYW4gc2FtcGxlU2l6ZSBmcmFtZXMgcGVyIHBpeGVsLlxuICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2FtcGxlU2l6ZTsgaisrKSB7XG4gICAgICAgICAgICBpZihpICogcGl4ZWxMZW5ndGggKyBqID49IGRhdGEubGVuZ3RoKSB7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHZhbCA9IGRhdGFbIGkgKiBwaXhlbExlbmd0aCArIGogXTtcblxuICAgICAgICAgICAgLy8gS2VlcCB0cmFjayBvZiBwb3NpdGl2ZSBhbmQgbmVnYXRpdmUgdmFsdWVzIHNlcGFyYXRlbHlcbiAgICAgICAgICAgIGlmICh2YWwgPiAwKSB7XG4gICAgICAgICAgICAgIHBvc1N1bSArPSB2YWw7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBuZWdTdW0gKz0gdmFsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICB2YWxzLnB1c2goIFsgbmVnU3VtIC8gc2FtcGxlU2l6ZSwgcG9zU3VtIC8gc2FtcGxlU2l6ZSBdICk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbHM7XG4gICAgICB9XG5cbiAgICAgIC8vIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xMzQ0MDg0MlxuICAgICAgZnVuY3Rpb24gYXJyYXlNaW4oYXJyKSB7XG4gICAgICAgIHZhciBsZW4gPSBhcnIubGVuZ3RoLCBtaW4gPSBJbmZpbml0eTtcbiAgICAgICAgd2hpbGUgKGxlbi0tKSB7XG4gICAgICAgICAgaWYgKGFycltsZW5dIDwgbWluKSB7XG4gICAgICAgICAgICBtaW4gPSBhcnJbbGVuXTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG1pbjtcbiAgICAgIH07XG5cbiAgICAgIGZ1bmN0aW9uIGFycmF5TWF4KGFycikge1xuICAgICAgICB2YXIgbGVuID0gYXJyLmxlbmd0aCwgbWF4ID0gLUluZmluaXR5O1xuICAgICAgICB3aGlsZSAobGVuLS0pIHtcbiAgICAgICAgICBpZiAoYXJyW2xlbl0gPiBtYXgpIHtcbiAgICAgICAgICAgIG1heCA9IGFycltsZW5dO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbWF4O1xuICAgICAgfTtcblxuXG4gICAgICAvLyBsZXQgZGF0YSA9IG5ldyBGbG9hdDMyQXJyYXkodGhpcy5kYXRhKVxuICAgICAgLy8gZGF0YSA9IGRhdGEubWFwKHggPT4geCAvIDB4ODAwMCk7XG5cbiAgICAgIGNvbnN0IHN1bW1hcnkgPSBzdW1tYXJpemVGYXN0ZXIoZGF0YSwgMTIwMCk7XG5cbiAgICAgIGxldCBtZWFuID0gMDtcbiAgICAgIGZvcihjb25zdCBlbCBvZiBzdW1tYXJ5KSB7XG4gICAgICAgIG1lYW4gKz0gLWVsWzBdICsgZWxbMV07XG4gICAgICB9XG4gICAgICBtZWFuID0gbWVhbiAvICgyICogc3VtbWFyeS5sZW5ndGgpO1xuICAgICAgLy8gY29uc29sZS5sb2coYXJyYXlNYXgoZGF0YSkgLSBhcnJheU1pbihkYXRhKSlcbiAgICAgIC8vIGNvbnN0IG11bHRpcGxpZXIgPSAxMC8gKGFycmF5TWF4KGRhdGEpIC0gYXJyYXlNaW4oZGF0YSkpICogaGVpZ2h0Oy8vIC8gMjtcbiAgICAgIGNvbnN0IG11bHRpcGxpZXIgPSAwLjEgKiBoZWlnaHQgLyBtZWFuOyAgLy8gbWVhbiBhdCAxMCUgb2YgaGVpZ2h0XG4gICAgICBjb25zdCB3ID0gd2lkdGggLyBzdW1tYXJ5Lmxlbmd0aDtcbiAgICAgIHN2Z1xuICAgICAgICAuc2VsZWN0QWxsKCdyZWN0JylcbiAgICAgICAgLmRhdGEoIHN1bW1hcnkgKVxuICAgICAgICAgIC5hdHRyKCd4JywgZnVuY3Rpb24oZCwgaSkge1xuICAgICAgICAgICAgcmV0dXJuIGkgLyBzdW1tYXJ5Lmxlbmd0aCAqIHdpZHRoO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmF0dHIoJ3knLCBmdW5jdGlvbihkLCBpKSB7XG4gICAgICAgICAgICByZXR1cm4gMC41ICogaGVpZ2h0IC0gKG11bHRpcGxpZXIgKiBkWzFdICk7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuYXR0cignd2lkdGgnLCB3KVxuICAgICAgICAgIC5hdHRyKCdoZWlnaHQnLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICByZXR1cm4gbXVsdGlwbGllciooZFsxXSAtIGRbMF0pO1xuICAgICAgICAgIH0pXG4gICAgICAgIC5lbnRlcigpXG4gICAgICAgICAgLmFwcGVuZCgncmVjdCcpXG4gICAgICAgICAgLnN0eWxlKCdzdHJva2UnLCAnIzM0MmE0MCcpXG4gICAgICAgICAgLnN0eWxlKCdzdHJva2Utd2lkdGgnLCAnMCcpXG4gICAgICAgICAgLnN0eWxlKCdmaWxsJywgJ3JnYmEoMCwwLDAsMC4zKScpXG4gICAgICAgICAgLmF0dHIoJ3gnLCBmdW5jdGlvbihkLCBpKSB7XG4gICAgICAgICAgICByZXR1cm4gaSAvIHN1bW1hcnkubGVuZ3RoICogd2lkdGg7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuYXR0cigneScsIGZ1bmN0aW9uKGQsIGkpIHtcbiAgICAgICAgICAgIHJldHVybiAwLjUgKiBoZWlnaHQgLSAobXVsdGlwbGllciAqIGRbMV0gKTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5hdHRyKCd3aWR0aCcsIHcpXG4gICAgICAgICAgLmF0dHIoJ2hlaWdodCcsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgIHJldHVybiBtdWx0aXBsaWVyKihkWzFdIC0gZFswXSk7XG4gICAgICAgICAgfSlcbiAgICAgICAgLmV4aXQoKS5yZW1vdmUoKVxuICAgICAgO1xuICAgIH0sXG4gIH0sXG59O1xuPC9zY3JpcHQ+XG5cbjxzdHlsZSBzY29wZWQ+XG5zdmcge1xuICBjb2xvcjogd2hpdGU7XG59XG48L3N0eWxlPlxuIiwiaW1wb3J0IHtTZWxlY3Rpb24sIHJvb3R9IGZyb20gXCIuL3NlbGVjdGlvbi9pbmRleC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbihzZWxlY3Rvcikge1xuICByZXR1cm4gdHlwZW9mIHNlbGVjdG9yID09PSBcInN0cmluZ1wiXG4gICAgICA/IG5ldyBTZWxlY3Rpb24oW1tkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKV1dLCBbZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50XSlcbiAgICAgIDogbmV3IFNlbGVjdGlvbihbW3NlbGVjdG9yXV0sIHJvb3QpO1xufVxuIiwiXG5leHBvcnQgY2xhc3MgQXVkaW9GaWxlRGVjb2RlciB7XG5cbiAgY29uc3RydWN0b3IoY2IpIHtcbiAgICB0aGlzLmluaXQoY2IpO1xuICB9XG5cbiAgaW5pdChjYikge1xuICAgIHRoaXMuY2xvc2UoKTtcbiAgICB0aGlzLmNvbnRleHQgPSBuZXcgQXVkaW9Db250ZXh0KCk7XG4gICAgaWYoY2IpIHtcbiAgICAgIHRoaXMuY29udGV4dC5vbnN0YXRlY2hhbmdlID0gKCkgPT4geyBjYih0aGlzKTsgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5jb250ZXh0Lm9uc3RhdGVjaGFuZ2UgPSAoKSA9PiB7IGNiICYmIGNiIHx8IHRoaXMub25zdGF0ZWNoYW5nZSh0aGlzKTsgfTtcbiAgICB9XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICBpZih0aGlzLmNvbnRleHQpIHtcbiAgICAgIHRoaXMuY29udGV4dC5jbG9zZSgpO1xuICAgICAgdGhpcy5jb250ZXh0ID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgfVxuXG4gIHJlc3VtZSgpIHtcbiAgICB0aGlzLmNvbnRleHQucmVzdW1lKCk7XG4gIH1cblxuICBnZXQgc3VzcGVuZGVkKCkge1xuICAgIHJldHVybiB0aGlzLmNvbnRleHQuc3RhdGUgPT09ICdzdXNwZW5kZWQnO1xuICB9XG5cbiAgb25zdGF0ZWNoYW5nZShkZWNvZGVyKSB7XG4gICAgY29uc29sZS5sb2coJ2F1ZGlvIGNvbnRleHQgc3RhdGUgY2hhbmdlZDonLCBkZWNvZGVyLmNvbnRleHQuc3RhdGUpO1xuICB9XG5cbiAgYXN5bmMgZGVjb2RlQXVkaW9GaWxlRGF0YShhcnJheUJ1ZmZlcikge1xuICAgIGNvbnN0IGJ1ZmZlciA9IGF3YWl0IHRoaXMuZGVjb2RlQXVkaW9GaWxlQnVmZmVyKGFycmF5QnVmZmVyKTtcblxuICAgIGNvbnN0IGRhdGEgPSB0aGlzLmJ1ZmZlckRhdGEoYnVmZmVyKTtcblxuICAgIHJldHVybiB7IGRhdGE6IHRoaXMuRmxvYXQzMkFycmF5VG9JbnQxNkFycmF5KGRhdGEpLCBzYW1wbGVSYXRlOiBidWZmZXIuc2FtcGxlUmF0ZSwgbGVuZ3RoOiBidWZmZXIubGVuZ3RoLCBkdXJhdGlvbjogYnVmZmVyLmR1cmF0aW9uLCBudW1iZXJPZkNoYW5uZWxzOiBidWZmZXIubnVtYmVyT2ZDaGFubmVscyB9O1xuICB9XG5cbiAgYXN5bmMgZmV0Y2hBbmREZWNvZGVBdWRpb0ZpbGUodXJsKSB7XG4gICAgY29uc3QgYnVmZmVyID0gYXdhaXQgdGhpcy5mZXRjaEF1ZGlvRmlsZUFuZERlY29kZSh1cmwpO1xuXG4gICAgY29uc3QgZGF0YSA9IHRoaXMuYnVmZmVyRGF0YShidWZmZXIpO1xuXG4gICAgcmV0dXJuIHsgZGF0YTogdGhpcy5GbG9hdDMyQXJyYXlUb0ludDE2QXJyYXkoZGF0YSksIHNhbXBsZVJhdGU6IGJ1ZmZlci5zYW1wbGVSYXRlLCBsZW5ndGg6IGJ1ZmZlci5sZW5ndGgsIGR1cmF0aW9uOiBidWZmZXIuZHVyYXRpb24sIG51bWJlck9mQ2hhbm5lbHM6IGJ1ZmZlci5udW1iZXJPZkNoYW5uZWxzIH07XG4gIH1cblxuICBhc3luYyBmZXRjaEF1ZGlvRmlsZUFuZERlY29kZSh1cmwpIHtcblxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsKTtcblxuICAgIGNvbnN0IGJ1ZmZlciA9IGF3YWl0IHRoaXMuZGVjb2RlQXVkaW9GaWxlQnVmZmVyKGF3YWl0IHJlc3BvbnNlLmFycmF5QnVmZmVyKCkpO1xuXG4gICAgcmV0dXJuIGJ1ZmZlcjtcbiAgfVxuXG4gIGFzeW5jIGRlY29kZUF1ZGlvRmlsZUJ1ZmZlcihhcnJheUJ1ZmZlcikge1xuXG4gICAgLy8gY29uc3QgY29udGV4dCA9IG5ldyBBdWRpb0NvbnRleHQoKTtcbiAgICBjb25zdCBjb250ZXh0ID0gdGhpcy5jb250ZXh0O1xuICAgIC8vIGNvbnNvbGUubG9nKCdDVFggc3RhdGUnLCBjb250ZXh0LnN0YXRlKVxuICAgIC8vIGlmKGNvbnRleHQuc3RhdGUgPT09ICdzdXNwZW5kZWQnKSB7XG4gICAgLy8gICBjb25zb2xlLmxvZygnU1VTUEVOREVEJylcbiAgICAvLyB9XG5cbiAgICAvLyBUT0RPOiBhZGQgdHJ5IHt9IGNhdGNoIHt9XG5cbiAgICBjb25zdCBidWZmZXIgPSBhd2FpdCBjb250ZXh0LmRlY29kZUF1ZGlvRGF0YShhcnJheUJ1ZmZlcik7XG5cbiAgICByZXR1cm4gYnVmZmVyO1xuICB9XG5cbiAgRmxvYXQzMkFycmF5VG9JbnQxNkFycmF5KGZsb2F0QXJyYXkpIHtcbiAgICByZXR1cm4gSW50MTZBcnJheS5mcm9tKGZsb2F0QXJyYXkubWFwKHNhbXBsZSA9PiBzYW1wbGUgKiAweDgwMDApKTtcbiAgfVxuXG4gIGJ1ZmZlckRhdGEoYnVmZmVyLCB7IGNoYW5uZWwgPSAwIH0gPSB7fSkge1xuICAgIGNvbnN0IGRhdGEgPSBidWZmZXIuZ2V0Q2hhbm5lbERhdGEoY2hhbm5lbCk7XG4gICAgLy8gcmV0dXJuIEZsb2F0MzJBcnJheVRvSW50MTZBcnJheShkYXRhKTtcbiAgICByZXR1cm4gZGF0YTtcbiAgfVxufVxuIiwiPHRlbXBsYXRlPlxuICA8ZGl2IGNsYXNzPVwiZWRpdG9yLXdyYXBwZXJcIj5cblxuICAgIDxzbG90Pjwvc2xvdD5cblxuICAgIDxkaXYgdi1pZj1cInRoaXMuZWRpdGFibGVcIiBjbGFzcz1cImhlYWRlclwiPlxuICAgICAgPGRpdiBjbGFzcz1cImJ0bi1ncm91cCBtZS0yXCIgcm9sZT1cImdyb3VwXCI+XG4gICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImJ0biBidG4tb3V0bGluZS1wcmltYXJ5XCIgQGNsaWNrPVwic2F2ZSgpXCI+XG4gICAgICAgICAgICA8ZGl2IHYtaWY9XCJzYXZpbmdcIiBjbGFzcz1cInNwaW5uZXItYm9yZGVyIHNwaW5uZXItYm9yZGVyLXNtXCIgcm9sZT1cInN0YXR1c1wiPjwvZGl2PlxuICAgICAgICAgICAgPGkgdi1lbHNlLWlmPVwic3luY2VkXCIgIGNsYXNzPVwiYmkgYmktY2hlY2stbGdcIiB0aXRsZT1cIlNhZ2xhYsSBdHNcIj48L2k+XG4gICAgICAgICAgICA8aSB2LWVsc2UgY2xhc3M9XCJiaSBiaS1hc3Rlcmlza1wiIHRpdGxlPVwiSXIgbmVzYWdsYWLEgXRhcyBpem1hacWGYXNcIj48L2k+XG4gICAgICAgICAgICBTYWdsYWLEgXRcbiAgICAgICAgICA8L2J1dHRvbj5cblxuICAgICAgICA8YnV0dG9uIDpjbGFzcz1cImBidG4gJHthdXRvU2F2ZSA/ICdidG4tcHJpbWFyeScgOiAnYnRuLW91dGxpbmUtcHJpbWFyeSd9YFwiIEBjbGljaz1cInRvZ2dsZUF1dG9TYXZlXCIgdGl0bGU9XCJBdXRvbcSBdGlza2kgc2FnYWxhYsSBdCBrYXRyYXMgNXNcIj5cbiAgICAgICAgICA8aSA6Y2xhc3M9XCJgYmkgYmktdG9nZ2xlLSR7YXV0b1NhdmUgPyAnb24nIDogJ29mZid9YFwiPjwvaT4gNXNcbiAgICAgICAgPC9idXR0b24+XG5cbiAgICAgIDwvZGl2PlxuXG4gICAgICA8ZGl2IGNsYXNzPVwiYnRuLWdyb3VwIG1lLTJcIiByb2xlPVwiZ3JvdXBcIj5cbiAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImJ0biBidG4tb3V0bGluZS1wcmltYXJ5XCIgQGNsaWNrPVwiJHJlZnMudHJhbnNjcmlwdC50b2dnbGVTdHlsZVgoJ2JvbGQnKVwiPjxpIGNsYXNzPVwiYmkgYmktdHlwZS1ib2xkXCI+PC9pPjwvYnV0dG9uPlxuICAgICAgICA8YnV0dG9uIGNsYXNzPVwiYnRuIGJ0bi1vdXRsaW5lLXByaW1hcnlcIiBAY2xpY2s9XCIkcmVmcy50cmFuc2NyaXB0LnRvZ2dsZVN0eWxlWCgnaXRhbGljJylcIj48aSBjbGFzcz1cImJpIGJpLXR5cGUtaXRhbGljXCI+PC9pPjwvYnV0dG9uPlxuICAgICAgICA8YnV0dG9uIGNsYXNzPVwiYnRuIGJ0bi1vdXRsaW5lLXByaW1hcnlcIiBAY2xpY2s9XCIkcmVmcy50cmFuc2NyaXB0LnRvZ2dsZVN0eWxlWCgndW5kZXJsaW5lJylcIj48aSBjbGFzcz1cImJpIGJpLXR5cGUtdW5kZXJsaW5lXCI+PC9pPjwvYnV0dG9uPlxuICAgICAgICA8YnV0dG9uIGNsYXNzPVwiYnRuIGJ0bi1vdXRsaW5lLXByaW1hcnlcIiBAY2xpY2s9XCIkcmVmcy50cmFuc2NyaXB0LnRvZ2dsZVN0eWxlWCgnc3VwZXJzY3JpcHQnKVwiPjxpIGNsYXNzPVwiYmlcIj54PHN1cD4yPC9zdXA+PC9pPjwvYnV0dG9uPlxuICAgICAgICA8YnV0dG9uIGNsYXNzPVwiYnRuIGJ0bi1vdXRsaW5lLXByaW1hcnlcIiBAY2xpY2s9XCIkcmVmcy50cmFuc2NyaXB0LnRvZ2dsZVN0eWxlWCgnc3Vic2NyaXB0JylcIj48aSBjbGFzcz1cImJpXCI+eDxzdWI+Mjwvc3ViPjwvaT48L2J1dHRvbj5cbiAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImJ0biBidG4tb3V0bGluZS1wcmltYXJ5XCIgQGNsaWNrPVwiJHJlZnMudHJhbnNjcmlwdC50b2dnbGVCdWxsZXQoKVwiPjxpIGNsYXNzPVwiYmkgYmktbGlzdC11bFwiPjwvaT48L2J1dHRvbj5cbiAgICAgIDwvZGl2PlxuPCEtLSAgICAgIDxkaXYgY2xhc3M9XCJidG4tZ3JvdXAgbWUtMlwiIHJvbGU9XCJncm91cFwiPi0tPlxuPCEtLSAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImJ0biBidG4tb3V0bGluZS1wcmltYXJ5XCIgQGNsaWNrPVwiJHJlZnMudHJhbnNjcmlwdC5leHBvcnRXb3JkKClcIj48aSBjbGFzcz1cImJpIGJpLWZpbGUtd29yZFwiPjwvaT4gZG9jPC9idXR0b24+LS0+XG48IS0tICAgICAgICA8YnV0dG9uIGNsYXNzPVwiYnRuIGJ0bi1vdXRsaW5lLXByaW1hcnlcIiBAY2xpY2s9XCIkcmVmcy50cmFuc2NyaXB0LmRvd25sb2FkKCdleHBvcnQuanNvbicsIEpTT04uc3RyaW5naWZ5KHRyYW5zY3JpcHQsIG51bGwsICcgICcpLCAnYXBwbGljYXRpb24vanNvbicpXCI+PGkgY2xhc3M9XCJiaSBiaS1jbG91ZC1kb3dubG9hZFwiPjwvaT4ganNvbjwvYnV0dG9uPi0tPlxuPCEtLSAgICAgIDwvZGl2Pi0tPlxuICAgIDwvZGl2PlxuXG4gICAgPFRyYW5zY3JpcHRFZGl0b3IgY2xhc3M9XCJtYWluIHRyYW5zY3JpcHQtZWRpdG9yXCJcbiAgICAgIHJlZj1cInRyYW5zY3JpcHRcIiB2LW1vZGVsPVwidHJhbnNjcmlwdFwiIEB1cGRhdGU6bW9kZWxWYWx1ZT1cInRyYW5zY3JpcHRVcGRhdGVkXCJcbiAgICAgIDp0aW1lPVwicG9zaXRpb25cIiBAdXBkYXRlOnRpbWU9XCJzZXRQb3NpdGlvblwiIEBzZWxlY3RlZD1cInNlbGVjdGVkID0gJGV2ZW50XCIgOmVkaXRhYmxlPVwiZWRpdGFibGVcIlxuICAgICAgOnNob3ctY29uZmlkZW5jZT1cInRoaXMuc2hvd0NvbmZpZGVuY2VcIlxuICAgID48L1RyYW5zY3JpcHRFZGl0b3I+XG5cbiAgICA8ZGl2IGNsYXNzPVwiZm9vdGVyXCI+XG4gICAgICA8ZGl2IGNsYXNzPVwibWVkaWEtcGFuZWxcIiA6Y2xhc3M9XCJ7IHZpZGVvOiBpc1ZpZGVvICYmIHByZXZpZXdWaWRlbyB9XCI+XG5cbiAgICAgICAgPCEtLSA8ZGl2PiAtLT5cbiAgICAgICAgICA8dmlkZW8gcGxheXNpbmxpbmVcbiAgICAgICAgICAgIDpzcmM9XCJfdXJsXCIgcmVmPVwidmlkZW9cIiBAdGltZXVwZGF0ZT1cInRpbWVVcGRhdGVcIiBAbG9hZGVkZGF0YT1cIm9uRGF0YUxvYWRlZFwiIEBsb2Fkc3RhcnQ9XCJvbkRhdGFMb2FkZWRcIiBAZW1wdGllZD1cIm9uRW1wdHlcIiBAZHVyYXRpb25jaGFuZ2U9XCJkdXJhdGlvbkNoYW5nZWRcIlxuICAgICAgICAgICAgQHBsYXk9XCJvblBsYXlcIiBAcGF1c2U9XCJvblBhdXNlXCIgQGVuZGVkPVwib25FbmRlZFwiPjwvdmlkZW8+XG4gICAgICAgIDwhLS0gPC9kaXY+IC0tPlxuXG4gICAgICAgIDxkaXYgY2xhc3M9XCJ3YXZlZm9ybS1hbmQtYnV0dG9uc1wiPlxuXG4gICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgIDxXYXZlZm9ybSBjbGFzcz1cIndhdmVmb3JtXCIgdi1pZj1cIl93YXZlZm9ybSAhPSB1bmRlZmluZWRcIlxuICAgICAgICAgICAgICB2LW1vZGVsPVwiX3dhdmVmb3JtXCIgdi1tb2RlbDp0aW1lPVwicG9zaXRpb25cIiBAdXBkYXRlOnRpbWU9XCJzZXRQb3NpdGlvblwiIDpkdXJhdGlvbj1cIl9kdXJhdGlvblwiIDpzZWxlY3Rpb249XCJzZWxlY3RlZFwiPjwvV2F2ZWZvcm0+XG5cbiAgICAgICAgICAgIDwhLS1cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ3YXZlZm9ybS1sb2FkaW5nXCIgdi1lbHNlLWlmPVwiYXVkaW9EZWNvZGluZ1N1c3BlbmRlZFwiPlxuICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVwiYnRuIGJ0bi1wcmltYXJ5XCIgQGNsaWNrPVwiZGVjb2Rlci5yZXN1bWUoKVwiPkxvYWQ8L2J1dHRvbj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgLS0+XG5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ3YXZlZm9ybS1sb2FkaW5nXCIgdi1lbHNlPlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwidGV4dC1jZW50ZXJcIiBzdHlsZT1cInBvc2l0aW9uOiByZWxhdGl2ZTsgdG9wOiBjYWxjKDUwJSAtIDFyZW0pXCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInNwaW5uZXItZ3Jvd1wiIHJvbGU9XCJzdGF0dXNcIj5cbiAgICAgICAgICAgICAgICAgIDwhLS0gPHNwYW4gY2xhc3M9XCJ2aXN1YWxseS1oaWRkZW5cIj5Mb2FkaW5nLi4uPC9zcGFuPiAtLT5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPVwicG9zaXRpb246IHJlbGF0aXZlOyBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHRvcDogLTAuNXJlbTsgbGVmdDogMC41cmVtXCI+XG4gICAgICAgICAgICAgICAgICBMb2FkaW5nLi4uXG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29udHJvbHNcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJidG4tZ3JvdXAgcGUtMlwiIHJvbGU9XCJncm91cFwiIHYtaWY9XCJsb2FkZWRcIj5cbiAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImJ0biBidG4tcHJpbWFyeVwiIEBjbGljaz1cIiRyZWZzLnZpZGVvLnBsYXkoKVwiIHYtaWY9XCIhcGxheWluZ1wiPjxpIGNsYXNzPVwiYmkgYmktcGxheS1maWxsXCI+PC9pPjwvYnV0dG9uPlxuICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVwiYnRuIGJ0bi1wcmltYXJ5XCIgQGNsaWNrPVwiJHJlZnMudmlkZW8ucGF1c2UoKVwiIHYtZWxzZT48aSBjbGFzcz1cImJpIGJpLXBhdXNlLWZpbGxcIj48L2k+PC9idXR0b24+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDxzcGFuIHN0eWxlPVwiZm9udC12YXJpYW50LW51bWVyaWM6IHRhYnVsYXItbnVtcztcIj57e21zVG9UaW1lKHBvc2l0aW9uKX19IC8ge3sgbXNUb1RpbWUodmlkZW9fZHVyYXRpb24pIH19PC9zcGFuPlxuICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgIDwvZGl2PlxuXG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbiAgPC9kaXY+XG48L3RlbXBsYXRlPlxuXG5cbjxzY3JpcHQgbGFuZz1cInRzXCI+XG5pbXBvcnQgVHJhbnNjcmlwdEVkaXRvciBmcm9tICcuL1RyYW5zY3JpcHRFZGl0b3IudnVlJztcbmltcG9ydCBXYXZlZm9ybSBmcm9tICcuL1dhdmVmb3JtLnZ1ZSc7XG5pbXBvcnQge21zVG9UaW1lfSBmcm9tICcuL3V0aWxzJztcbmltcG9ydCB7IEF1ZGlvRmlsZURlY29kZXIgfSBmcm9tICcuL2F1ZGlvJztcblxuZXhwb3J0IGRlZmF1bHQge1xuICBjb21wb25lbnRzOiB7XG4gICAgVHJhbnNjcmlwdEVkaXRvcixcbiAgICBXYXZlZm9ybSxcbiAgfSxcbiAgcHJvcHM6IHtcbiAgICB0cmFuc2NyaXB0OiB7IHR5cGU6IE9iamVjdCwgZGVmYXVsdDogeyBwYXJhZ3JhcGhzOiB7fSB9IH0sXG4gICAgZHVyYXRpb246IHsgdHlwZTogTnVtYmVyIH0sXG4gICAgdXJsOiB7IHR5cGU6IFN0cmluZyB9LFxuICAgIG5hbWU6IHt9LFxuICAgIHdhdmVmb3JtOiBbSW50MTZBcnJheSwgSW50MzJBcnJheSwgQXJyYXksIFN0cmluZ10sXG4gICAgcHJldmlld1ZpZGVvOiB7IHR5cGU6IEJvb2xlYW4sIGRlZmF1bHQ6IHRydWUgfSxcbiAgICBvblNhdmU6IHsgdHlwZTogRnVuY3Rpb24sIGRlZmF1bHQ6IGFzeW5jICgpID0+IGNvbnNvbGUubG9nKCdvblNhdmUgbm90IGltcGxlbWVudGVkJykgfSxcbiAgICBlZGl0YWJsZToge3R5cGU6IEJvb2xlYW4sIGRlZmF1bHQ6IHRydWV9XG4gIH0sXG4gIGRhdGEoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHBvc2l0aW9uOiAwLFxuICAgICAgc2VsZWN0ZWQ6IHVuZGVmaW5lZCxcbiAgICAgIHBsYXlpbmc6IGZhbHNlLFxuICAgICAgbG9hZGVkOiBmYWxzZSxcbiAgICAgIGlzVmlkZW86IGZhbHNlLFxuXG4gICAgICBfdXJsOiB1bmRlZmluZWQsXG4gICAgICBfZHVyYXRpb246IHVuZGVmaW5lZCxcbiAgICAgIF93YXZlZm9ybTogdW5kZWZpbmVkLFxuICAgICAgcGVuZGluZ193YXZlZm9ybTogdW5kZWZpbmVkLFxuICAgICAgcGVuZGluZ19kdXJhdGlvbjogdW5kZWZpbmVkLFxuICAgICAgdmlkZW9fZHVyYXRpb246IHVuZGVmaW5lZCxcblxuICAgICAgc2F2aW5nOiBmYWxzZSxcbiAgICAgIHZlcnNpb246IDAsXG4gICAgICBsYXN0U2F2ZWRWZXJzaW9uOiAwLFxuICAgICAgYXV0b1NhdmU6IGZhbHNlLFxuICAgICAgYXV0b1NhdmVJbnRlcnZhbDogbnVsbCxcblxuICAgICAgZGVjb2RlclN1c3BlbmRlZDogZmFsc2UsXG4gICAgICBkZWNvZGluZ0F1ZGlvOiBmYWxzZSxcbiAgICAgIHNob3dDb25maWRlbmNlOiBmYWxzZVxuICAgIH1cbiAgfSxcblxuICBhc3luYyBtb3VudGVkKCkge1xuICAgIHRoaXMuJG9wdGlvbnMud2F0Y2gud2F2ZWZvcm0uY2FsbCh0aGlzLCB0aGlzLndhdmVmb3JtKTtcbiAgICB0aGlzLmF1dG9TYXZlSW50ZXJ2YWwgPSB3aW5kb3cuc2V0SW50ZXJ2YWwodGhpcy5zYXZlQXV0bywgNTAwMCk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLm9uR2xvYmFsS2V5ZG93bik7XG5cbiAgICB0aGlzLmRlY29kZXIgPSBuZXcgQXVkaW9GaWxlRGVjb2RlcigoZGVjb2RlcikgPT4geyB0aGlzLmRlY29kZXJTdXNwZW5kZWQgPSB0aGlzLmRlY29kZXIuc3VzcGVuZGVkOyBpZih0aGlzLmRlY29kZXIuc3VzcGVuZGVkKSB7IGNvbnNvbGUubG9nKCdhdWRpbyBkZWNvZGVyIHN1c3BlbmRlZCcpOyB9IH0pO1xuICAgIHRoaXMuZGVjb2RlclN1c3BlbmRlZCA9IHRoaXMuZGVjb2Rlci5zdXNwZW5kZWQ7XG4gICAgLy8gY29uc29sZS5sb2coJ2RlY29kZXIgc3VzcGVuZGVkIGFmdGVyIGluaXQ6JywgdGhpcy5kZWNvZGVyU3VzcGVuZGVkKTtcbiAgfSxcblxuICBiZWZvcmVVbm1vdW50KCkge1xuICAgIGlmICh0aGlzLmF1dG9TYXZlSW50ZXJ2YWwpIHdpbmRvdy5jbGVhckludGVydmFsKHRoaXMuYXV0b1NhdmVJbnRlcnZhbCk7XG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLm9uR2xvYmFsS2V5ZG93bik7XG4gIH0sXG5cbiAgd2F0Y2g6IHtcbiAgICBwb3NpdGlvbih2YWx1ZSkge1xuICAgICAgLy8gY29uc29sZS5sb2coJ3Bvc2l0aW9uIGNoYW5nZWQ6JywgdmFsdWUpO1xuICAgIH0sXG4gICAgdHJhbnNjcmlwdDoge1xuICAgICAgaGFuZGxlcih2YWx1ZSwgb2xkVmFsdWUpIHtcbiAgICAgICAgLy8gaWYgKHRoaXMudmVyc2lvbiA9PSAwICYmICghb2xkVmFsdWUgfHwgT2JqZWN0LmtleXMob2xkVmFsdWUpLmxlbmd0aCA9PT0gMCkpIHtcbiAgICAgICAgLy8gICAvLyBpZ25vcmUgaW5pdGlhbCBzZXR1cFxuICAgICAgICAvLyAgIHJldHVybjtcbiAgICAgICAgLy8gfVxuICAgICAgICAvLyB0aGlzLnZlcnNpb24gKz0gMTtcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ25ldycsIEpTT04uc3RyaW5naWZ5KHZhbHVlKSlcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ29sZCcsIEpTT04uc3RyaW5naWZ5KG9sZFZhbHVlKSlcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ3RyYW5zY3JpcHQgdXBkYXRlZCcsIHRoaXMudmVyc2lvbiwgdmFsdWUpXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCd0cmFuc2NyaXB0IHVwZGF0ZWQnLCB0aGlzLnRyYW5zY3JpcHQpXG4gICAgICB9LFxuICAgICAgZGVlcDogdHJ1ZSxcbiAgICB9LFxuICAgIGR1cmF0aW9uKHZhbHVlKSB7XG4gICAgICB0aGlzLl9kdXJhdGlvbiA9IHZhbHVlO1xuICAgIH0sXG4gICAgdXJsKHZhbHVlKSB7XG4gICAgICB0aGlzLl91cmwgPSB2YWx1ZTtcbiAgICB9LFxuICAgIGFzeW5jIHdhdmVmb3JtKHZhbHVlKSB7XG4gICAgICBpZih0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIGNvbnN0IHsgZGF0YSwgZHVyYXRpb24gfSA9IGF3YWl0IHRoaXMuZGVjb2RlQXVkaW9XYXZlZm9ybSh2YWx1ZSk7XG4gICAgICAgIHRoaXMuX3dhdmVmb3JtID0gZGF0YTtcbiAgICAgIH0gZWxzZSBpZih2YWx1ZSBpbnN0YW5jZW9mIEZpbGUpIHtcbiAgICAgICAgY29uc3QgeyBkYXRhLCBkdXJhdGlvbiB9ID0gYXdhaXQgdGhpcy5kZWNvZGVyLmRlY29kZUF1ZGlvRmlsZURhdGEoYXdhaXQgdmFsdWUuYXJyYXlCdWZmZXIoKSk7XG4gICAgICAgIHRoaXMuX3dhdmVmb3JtID0gZGF0YTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX3dhdmVmb3JtID0gdmFsdWU7XG4gICAgICB9XG4gICAgfSxcbiAgfSxcblxuICBjb21wdXRlZDoge1xuICAgIHN5bmNlZCgpIHtcbiAgICAgIHJldHVybiB0aGlzLmxhc3RTYXZlZFZlcnNpb24gPT09IHRoaXMudmVyc2lvbjtcbiAgICB9XG4gIH0sXG5cbiAgbWV0aG9kczoge1xuICAgIG1zVG9UaW1lLFxuXG4gICAgdG9nZ2xlQXV0b1NhdmUoKSB7XG4gICAgICB0aGlzLmF1dG9TYXZlID0gIXRoaXMuYXV0b1NhdmU7XG4gICAgfSxcblxuICAgIGFzeW5jIHNhdmUoKSB7XG4gICAgICBpZiAodGhpcy5vblNhdmUgJiYgdGhpcy5lZGl0YWJsZSkge1xuICAgICAgICBjb25zdCB2ZXJzaW9uID0gdGhpcy52ZXJzaW9uO1xuICAgICAgICB0aGlzLnNhdmluZyA9IHRydWU7XG4gICAgICAgIGNvbnN0IHIgPSBhd2FpdCB0aGlzLm9uU2F2ZSh0aGlzLnRyYW5zY3JpcHQpO1xuICAgICAgICBjb25zb2xlLmxvZygnc2F2ZWQnLCB0aGlzLnRyYW5zY3JpcHQpXG4gICAgICAgIHRoaXMubGFzdFNhdmVkVmVyc2lvbiA9IHZlcnNpb247XG4gICAgICAgIHRoaXMuc2F2aW5nID0gZmFsc2U7XG4gICAgICB9XG4gICAgfSxcblxuICAgIHNhdmVBdXRvKCkge1xuICAgICAgaWYgKHRoaXMuYXV0b1NhdmUpIHtcbiAgICAgICAgdGhpcy5zYXZlKCk7XG4gICAgICB9XG4gICAgfSxcblxuICAgIGFzeW5jIGRlY29kZUF1ZGlvV2F2ZWZvcm0odXJsKSB7XG4gICAgICB0cnkge1xuICAgICAgICB0aGlzLmRlY29kaW5nQXVkaW8gPSB0cnVlO1xuICAgICAgICBpZih0aGlzLmRlY29kZXIuc3VzcGVuZGVkKSB7XG4gICAgICAgICAgYXdhaXQgdGhpcy5kZWNvZGVyLnJlc3VtZSgpO1xuICAgICAgICB9XG4gICAgICAgIGlmKHVybCBpbnN0YW5jZW9mIEZpbGUpIHtcbiAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kZWNvZGVyLmRlY29kZUF1ZGlvRmlsZURhdGEoYXdhaXQgdXJsLmFycmF5QnVmZmVyKCkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRlY29kZXIuZmV0Y2hBbmREZWNvZGVBdWRpb0ZpbGUodXJsKTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaChlKSB7XG4gICAgICAgIHRocm93IGU7XG4gICAgICB9IGZpbmFsbHkge1xuICAgICAgICB0aGlzLmRlY29kaW5nQXVkaW8gPSBmYWxzZTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgLy8gc2V0IGV2ZXJ5dGhpbmcgaW4gb25lIHNob3QgZm9yIHRoZSBiZXN0IHVzZXIgZXhwZXJpZW5jZVxuICAgIGFzeW5jIGxvYWQoeyB1cmwsIHdhdmVmb3JtLCBkdXJhdGlvbiB9KSB7XG4gICAgICBpZih0eXBlb2Ygd2F2ZWZvcm0gPT09ICdzdHJpbmcnIHx8IHdhdmVmb3JtIGluc3RhbmNlb2YgRmlsZSkge1xuICAgICAgICB0aGlzLnBlbmRpbmdfd2F2ZWZvcm0gPSAoYXN5bmMgKCkgPT4geyBjb25zdCB7IGRhdGEsIGR1cmF0aW9uIH0gPSBhd2FpdCB0aGlzLmRlY29kZUF1ZGlvV2F2ZWZvcm0od2F2ZWZvcm0pOyByZXR1cm4gZGF0YTsgfSkoKTtcbiAgICAgIH0gZWxzZSBpZih3YXZlZm9ybSA9PT0gbnVsbCkge1xuICAgICAgICB0aGlzLl93YXZlZm9ybSA9IFtdO1xuICAgICAgfSBlbHNlIGlmKHdhdmVmb3JtICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdGhpcy5wZW5kaW5nX3dhdmVmb3JtID0gKGFzeW5jICgpID0+IHdhdmVmb3JtKSgpO1xuICAgICAgfVxuICAgICAgaWYoZHVyYXRpb24pIHtcbiAgICAgICAgdGhpcy5wZW5kaW5nX2R1cmF0aW9uID0gZHVyYXRpb247XG4gICAgICB9XG4gICAgICBpZih1cmwgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICB0aGlzLl91cmwgPSB1cmw7XG4gICAgICAgIGlmKCF1cmwgfHwgdXJsLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgIHRoaXMudmlkZW9fZHVyYXRpb24gPSB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZih0aGlzLnBlbmRpbmdfd2F2ZWZvcm0pIHtcbiAgICAgICAgdGhpcy5fd2F2ZWZvcm0gPSBhd2FpdCB0aGlzLnBlbmRpbmdfd2F2ZWZvcm07XG4gICAgICAgIHRoaXMucGVuZGluZ193YXZlZm9ybSA9IHVuZGVmaW5lZDtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgd2F2ZWZvcm1Mb2FkaW5nKCkge1xuICAgICAgdGhpcy5fd2F2ZWZvcm0gPSB1bmRlZmluZWQ7XG4gICAgICB0aGlzLmxvYWRlZCA9IGZhbHNlO1xuICAgIH0sXG5cbiAgICBvblBsYXkoKSB7XG4gICAgICAvLyB0aGlzLnN0ZXAgPSB0aGlzLmR1cmF0aW9uIC8gdGhpcy4kcmVmcy53YXZlZm9ybS4kZWwucGFyZW50Tm9kZS5jbGllbnRXaWR0aDtcbiAgICAgIC8vIHRoaXMubmV4dENoZWNrcG9pbnQgPSB0aGlzLnBvc2l0aW9uO1xuICAgICAgdGhpcy5wbGF5aW5nID0gdHJ1ZTtcbiAgICAgIHRoaXMuYW5pbWF0aW9uRnJhbWVJRCA9IHJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLnVwZGF0ZVBvc2l0aW9uKTtcbiAgICB9LFxuXG4gICAgb25QYXVzZSgpIHtcbiAgICAgIHRoaXMucGxheWluZyA9IGZhbHNlO1xuICAgICAgaWYodGhpcy5hbmltYXRpb25GcmFtZUlEKSB7XG4gICAgICAgIGNhbmNlbEFuaW1hdGlvbkZyYW1lKHRoaXMuYW5pbWF0aW9uRnJhbWVJRCk7XG4gICAgICAgIHRoaXMuYW5pbWF0aW9uRnJhbWVJRCA9IHVuZGVmaW5lZDtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgb25FbmRlZCgpIHtcbiAgICAgIHRoaXMub25QYXVzZSgpO1xuICAgIH0sXG5cbiAgICB1cGRhdGVQb3NpdGlvbih0aW1lc3RhbXApIHtcbiAgICAgIHRoaXMucG9zaXRpb24gPSB0aGlzLiRyZWZzLnZpZGVvLmN1cnJlbnRUaW1lICogMTAwMDtcbiAgICAgIC8vIE5PVEU6IGluc3RlYWQgdGhlIGZvbGxvd2luZyBhcHByb2FjaCBtYXkgaGF2ZSBzb21lIGVmZmVjdCBvbiBsYXJnZXIgaW5wdXQgbWVkaWFcbiAgICAgIC8vIGNvbnN0IHBvc2l0aW9uID0gdGhpcy4kcmVmcy52aWRlby5jdXJyZW50VGltZSAqIDEwMDA7XG4gICAgICAvLyBpZihwb3NpdGlvbiA+PSB0aGlzLm5leHRDaGVja3BvaW50KSB7XG4gICAgICAvLyAgIHRoaXMucG9zaXRpb24gPSBwb3NpdGlvbjtcbiAgICAgIC8vICAgdGhpcy5uZXh0Q2hlY2twb2ludCA9IHBvc2l0aW9uICsgdGhpcy5zdGVwO1xuICAgICAgLy8gfVxuXG4gICAgICB0aGlzLmFuaW1hdGlvbkZyYW1lSUQgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy51cGRhdGVQb3NpdGlvbik7XG4gICAgfSxcblxuICAgIGR1cmF0aW9uQ2hhbmdlZCgpIHtcbiAgICAgIGNvbnN0IHZpZGVvID0gdGhpcy4kcmVmcy52aWRlbztcbiAgICAgIHRoaXMuX2R1cmF0aW9uID0gdmlkZW8uZHVyYXRpb24gKiAxMDAwO1xuICAgICAgdGhpcy52aWRlb19kdXJhdGlvbiA9IHZpZGVvLmR1cmF0aW9uICogMTAwMDtcbiAgICB9LFxuXG4gICAgYXN5bmMgb25EYXRhTG9hZGVkKCkge1xuICAgICAgY29uc3QgdmlkZW8gPSB0aGlzLiRyZWZzLnZpZGVvO1xuICAgICAgaWYodmlkZW8pIHtcbiAgICAgICAgdGhpcy5pc1ZpZGVvID0gdmlkZW8udmlkZW9XaWR0aCA+IDAgJiYgdmlkZW8udmlkZW9IZWlnaHQgPiAwO1xuICAgICAgfVxuICAgICAgaWYodGhpcy5wZW5kaW5nX2R1cmF0aW9uKSB7XG4gICAgICAgIC8vIHRoaXMuX2R1cmF0aW9uID0gdGhpcy5wZW5kaW5nX2R1cmF0aW9uO1xuICAgICAgICB0aGlzLnBlbmRpbmdfZHVyYXRpb24gPSB1bmRlZmluZWQ7XG4gICAgICB9XG4gICAgICBpZih0aGlzLnBlbmRpbmdfd2F2ZWZvcm0pIHtcbiAgICAgICAgdGhpcy5fd2F2ZWZvcm0gPSBhd2FpdCB0aGlzLnBlbmRpbmdfd2F2ZWZvcm07XG4gICAgICAgIHRoaXMucGVuZGluZ193YXZlZm9ybSA9IHVuZGVmaW5lZDtcbiAgICAgIH1cbiAgICAgIHRoaXMubG9hZGVkID0gdHJ1ZTtcbiAgICB9LFxuXG4gICAgb25FbXB0eSgpIHtcbiAgICAgIHRoaXMubG9hZGVkID0gZmFsc2U7XG4gICAgICB0aGlzLmlzVmlkZW8gPSBmYWxzZTtcbiAgICB9LFxuXG4gICAgb25HbG9iYWxLZXlkb3duKGUpIHtcbiAgICAgIC8vIGN0cmwvY21kICsgc1xuICAgICAgaWYgKGUua2V5ID09PSAncycgJiYgKGUuY3RybEtleSA9PT0gdHJ1ZSB8fCBlLm1ldGFLZXkgPT09IHRydWUpKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKVxuICAgICAgICB0aGlzLnNhdmUoKTtcbiAgICAgIH1cblxuICAgICAgaWYoZS5jb2RlID09PSAnU3BhY2UnICYmIGUuY3RybEtleSA9PT0gdHJ1ZSB8fCBlLmNvZGUgPT0gJ0VzY2FwZScpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpXG4gICAgICAgIGlmKCF0aGlzLiRyZWZzLnZpZGVvLnBhdXNlZCkge1xuICAgICAgICAgIHRoaXMuJHJlZnMudmlkZW8ucGF1c2UoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLiRyZWZzLnZpZGVvLnBsYXkoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG5cbiAgICB0cmFuc2NyaXB0VXBkYXRlZCh2YWx1ZSkge1xuICAgICAgLy8gY29uc29sZS5sb2coJ3RyYW5zY3JpcHQgVVBEQVRFRCcsIHRoaXMudHJhbnNjcmlwdCwgdmFsdWUpXG4gICAgICB0aGlzLnZlcnNpb24gKz0gMTtcbiAgICB9LFxuXG4gICAgc2V0UG9zaXRpb24oZXZlbnQpIHtcbiAgICAgIC8vIGNvbnNvbGUubG9nKCdzZXQgcG9zaXRpb24nLCBldmVudCk7XG4gICAgICBpZihldmVudCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIC8vIHRoaXMucG9zaXRpb24gPSBldmVudDtcbiAgICAgIHRoaXMuJHJlZnMudmlkZW8uY3VycmVudFRpbWUgPSBldmVudCAvIDEwMDA7XG4gICAgICB0aGlzLiRlbWl0KCdzZXRQb3NpdGlvbicsIGV2ZW50KTtcbiAgICB9LFxuXG4gICAgdGltZVVwZGF0ZShldmVudCkge1xuICAgICAgLy8gY29uc29sZS5sb2coJ3RpbWUgdXBkYXRlZCcsIGV2ZW50LCBldmVudC50aW1lU3RhbXAsIHRoaXMuJHJlZnMudmlkZW8uY3VycmVudFRpbWUpO1xuICAgICAgLy8gY29uc29sZS5kaXIodGhpcy4kcmVmcy52aWRlbylcbiAgICAgIC8vIHRoaXMucG9zaXRpb24gPSBldmVudC50aW1lU3RhbXA7XG4gICAgICB0aGlzLnBvc2l0aW9uID0gdGhpcy4kcmVmcy52aWRlby5jdXJyZW50VGltZSAqIDEwMDA7XG4gICAgfSxcblxuICAgIHRvZ2dsZVNob3dDb25maWRlbmNlKCkge1xuICAgICAgdGhpcy5zaG93Q29uZmlkZW5jZSA9ICF0aGlzLnNob3dDb25maWRlbmNlO1xuICAgIH0sXG4gIH0sXG59O1xuXG48L3NjcmlwdD5cblxuPHN0eWxlIHNjb3BlZD5cbi5lZGl0b3Itd3JhcHBlciB7XG4gIGRpc3BsYXk6IGZsZXg7XG4gIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gIC8qdG9wOiAxMDBweDsqL1xuICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgdG9wOiAwcHg7XG4gIGJvdHRvbTogMHB4O1xuICBsZWZ0OiAwcHg7XG4gIHJpZ2h0OiAwcHg7XG59XG5cbi5oZWFkZXIge1xufVxuXG4ubWFpbiB7XG4gIHBhZGRpbmc6IDEwcHg7XG4gIGJhY2tncm91bmQ6ICNmZmY7XG4gIGZsZXg6IDEgMSBhdXRvO1xuICBvdmVyZmxvdy15OiBzY3JvbGw7XG4gIG1hcmdpbjogNXB4IDA7XG59XG5cbi5mb290ZXIge1xuICBib3R0b206IDA7XG4gIGhlaWdodDogOTBweDtcbn1cblxuLmZvb3RlciAuY29udHJvbHMge1xuICBtYXJnaW46IDNweCAwO1xufVxuLm1lZGlhLXBhbmVsIHtcbiAgZGlzcGxheTogZmxleDtcbiAgZmxleC1kaXJlY3Rpb246IHJvdztcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xuICBmbGV4OiAxIDEgYXV0bztcbn1cbi5tZWRpYS1wYW5lbCB2aWRlbyB7XG4gIGRpc3BsYXk6IG5vbmU7XG59XG4ubWVkaWEtcGFuZWwudmlkZW8gdmlkZW8ge1xuICAvKmhlaWdodDogNzBweDsqL1xuICBoZWlnaHQ6IDkwcHg7XG4gIGRpc3BsYXk6IGlubGluZS1ibG9jaztcbiAgbWFyZ2luLXJpZ2h0OiA2cHg7XG59XG4ubWVkaWEtcGFuZWwgLndhdmVmb3JtLWFuZC1idXR0b25zIHtcbiAgZmxleDogMSAxIGF1dG87XG59XG4ubWVkaWEtcGFuZWwgLndhdmVmb3JtIHtcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xuICBoZWlnaHQ6IDUwcHg7XG4gIHdpZHRoOiAxMDAlO1xufVxuLm1lZGlhLXBhbmVsIC53YXZlZm9ybS1sb2FkaW5nIHtcbiAgaGVpZ2h0OiA1MHB4O1xuICB3aWR0aDogMTAwJTtcbn1cbjwvc3R5bGU+XG4iLCJleHBvcnQgZnVuY3Rpb24gbXNUb1RpbWUocywge21zPWZhbHNlLCBob3Vycz10cnVlfT17fSkge1xuICBpZihzID09IHVuZGVmaW5lZCB8fCBpc05hTihzKSkge1xuICAgIHJldHVybiBgJHtob3VycyA/ICctLTonIDogJyd9LS06LS0ke21zID8gJy4tLS0nIDogJyd9YDtcbiAgfVxuICBmdW5jdGlvbiBwYWQobiwgeikge1xuICAgIHogPSB6IHx8IDI7XG4gICAgcmV0dXJuICgnMDAnICsgbikuc2xpY2UoLXopO1xuICB9XG4gIHZhciBfbXMgPSBzICUgMTAwMDtcbiAgcyA9IChzIC0gX21zKSAvIDEwMDA7XG4gIHZhciBzZWNzID0gcyAlIDYwO1xuICBzID0gKHMgLSBzZWNzKSAvIDYwO1xuICB2YXIgbWlucyA9IHMgJSA2MDtcbiAgdmFyIGhycyA9IChzIC0gbWlucykgLyA2MDtcbiAgcmV0dXJuICgoaHJzIHx8IGhvdXJzKSA/IChwYWQoaHJzKSArICc6JykgOiAnJykgKyBwYWQobWlucykgKyAnOicgKyBwYWQoc2VjcykgKyAobXMgPyAnLicgKyBwYWQoX21zLCAzKSA6ICcnKTtcbn1cbiIsIlxuXG5hc3luYyBmdW5jdGlvbiBmZXRjaEF1ZGlvRmlsZUFuZERlY29kZSh1cmwpIHtcblxuICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCk7XG5cbiAgY29uc3QgYnVmZmVyID0gYXdhaXQgZGVjb2RlQXVkaW9GaWxlQnVmZmVyKGF3YWl0IHJlc3BvbnNlLmFycmF5QnVmZmVyKCkpO1xuXG4gIHJldHVybiBidWZmZXI7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGRlY29kZUF1ZGlvRmlsZUJ1ZmZlcihhcnJheUJ1ZmZlcikge1xuXG4gIGNvbnN0IGNvbnRleHQgPSBuZXcgQXVkaW9Db250ZXh0KCk7XG5cbiAgLy8gVE9ETzogYWRkIHRyeSB7fSBjYXRjaCB7fVxuXG4gIGNvbnN0IGJ1ZmZlciA9IGF3YWl0IGNvbnRleHQuZGVjb2RlQXVkaW9EYXRhKGFycmF5QnVmZmVyKTtcblxuICBjb250ZXh0LmNsb3NlKCk7XG5cbiAgcmV0dXJuIGJ1ZmZlcjtcbn1cblxuZnVuY3Rpb24gRmxvYXQzMkFycmF5VG9JbnQxNkFycmF5KGZsb2F0QXJyYXkpIHtcbiAgcmV0dXJuIEludDE2QXJyYXkuZnJvbShmbG9hdEFycmF5Lm1hcChzYW1wbGUgPT4gc2FtcGxlICogMHg4MDAwKSk7XG59XG5cbmZ1bmN0aW9uIGJ1ZmZlckRhdGEoYnVmZmVyLCB7IGNoYW5uZWwgPSAwIH0gPSB7fSkge1xuICBjb25zdCBkYXRhID0gYnVmZmVyLmdldENoYW5uZWxEYXRhKGNoYW5uZWwpO1xuICAvLyByZXR1cm4gRmxvYXQzMkFycmF5VG9JbnQxNkFycmF5KGRhdGEpO1xuICByZXR1cm4gZGF0YTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gcmVzY2FsZUF1ZGlvQnVmZmVyKGlucHV0QnVmZmVyLCB7IG51bWJlck9mQ2hhbm5lbHMgPSAxLCBsZW5ndGgsIHNhbXBsZVJhdGUgPSAxNjAwMCB9ID0ge30pIHtcblxuICBpZihsZW5ndGggPT09IHVuZGVmaW5lZCkge1xuICAgIGxlbmd0aCA9IGlucHV0QnVmZmVyLmR1cmF0aW9uICogc2FtcGxlUmF0ZTtcbiAgfVxuXG4gIGNvbnN0IGNvbnRleHQgPSBuZXcgT2ZmbGluZUF1ZGlvQ29udGV4dChudW1iZXJPZkNoYW5uZWxzLCBsZW5ndGgsIHNhbXBsZVJhdGUpO1xuXG4gIGNvbnN0IHNvdXJjZSA9IGNvbnRleHQuY3JlYXRlQnVmZmVyU291cmNlKCk7XG4gIHNvdXJjZS5jb25uZWN0KGNvbnRleHQuZGVzdGluYXRpb24pO1xuICBzb3VyY2UuYnVmZmVyID0gaW5wdXRCdWZmZXI7XG4gIHNvdXJjZS5zdGFydCgpOyAvLyBBdWRpb0J1ZmZlclNvdXJjZU5vZGUuc3RhcnQoW3doZW5dWywgb2Zmc2V0XVssIGR1cmF0aW9uXSlcbiAgY29uc3QgYnVmZmVyID0gYXdhaXQgY29udGV4dC5zdGFydFJlbmRlcmluZygpO1xuICBjb250ZXh0LmNsb3NlKCk7XG4gIHJldHVybiBidWZmZXI7XG59XG5cblxuYXN5bmMgZnVuY3Rpb24gc2FtcGxlUHJvY2Vzc0F1ZGlvQnVmZmVyKGJ1ZmZlcikge1xuICAvLyBjb25zdCBzYW1wbGVSYXRlID0gYnVmZmVyLnNhbXBsZVJhdGU7XG4gIGNodW5rcy5wdXNoKEZsb2F0MzJBcnJheS5mcm9tKGJ1ZmZlci5nZXRDaGFubmVsRGF0YSgwKSkpO1xuXG4gIGNvbnN0IG91cHV0QnVmZmVyID0gYXdhaXQgcmVzY2FsZUF1ZGlvQnVmZmVyKGJ1ZmZlciwge30pO1xuXG4gIGNvbnN0IGRhdGEgPSBidWZmZXJEYXRhKG91dHB1dEJ1ZmZlcik7XG5cbiAgdG90YWxTYW1wbGVzICs9IGRhdGEubGVuZ3RoO1xuICByZWNvcmRlZENodW5rcy5wdXNoKGRhdGEpO1xuXG4gIC8qXG4gIGlmKHRvdGFsU2FtcGxlcyA+PSAxNjAwMCAqIDEwKSB7IC8vIDEwc1xuICAgIC8vIFRPRE86IGFzeW5jXG5cbiAgICBjb25zdCBkYXRhID0gW107XG4gICAgZm9yKGNvbnN0IGNodW5rIG9mIHJlY29yZGVkQ2h1bmtzKSB7XG4gICAgICBkYXRhLnB1c2goSW50MTZBcnJheS5mcm9tKGNodW5rLm1hcChzYW1wbGUgPT4gc2FtcGxlICogMHg4MDAwKSkpO1xuICAgICAgLy8gc2FtcGxlQ291bnQgKz0gY2h1bmsubGVuZ3RoO1xuICAgIH1cbiAgICBjb25zb2xlLmxvZyhkYXRhKVxuICAgIGNvbnN0IGJsb2IgPSBuZXcgQmxvYihkYXRhKVxuXG4gICAgdG90YWxTYW1wbGVzID0gMDtcbiAgICByZWNvcmRlZENodW5rcyA9IFtdO1xuXG4gICAgLy8gY29uc29sZS5sb2coJ2NhbGxpbmcgQVNSJylcbiAgICAvLyAvLyBjb25zdCByZXNwb25zZSA9IGF3YWl0IGF4aW9zLnBvc3QoJ2h0dHA6Ly90ZW5zb3I6OTAwMC9kYXRhJywgYmxvYilcbiAgICAvLyAvLyBjb25zb2xlLmxvZyhyZXNwb25zZS5zdGF0dXMsIGF3YWl0IHJlc3BvbnNlLmRhdGEpO1xuICAgIC8vIGFzclNvY2tldC5zZW5kKGJsb2IpO1xuICB9XG4gICovXG59XG5cblxuZnVuY3Rpb24gcHJvY2Vzc0F1ZGlvU3RyZWFtKHN0cmVhbSwgY2FsbGJhY2ssIHsgYnVmZmVyU2l6ZSA9IDEwMjQsIG51bWJlck9mSW5wdXRDaGFubmVscyA9IDEsIG51bWJlck9mT3V0cHV0Q2hhbm5lbHMgPSAxLCBjb250ZXh0IH0gPSB7fSkge1xuXG4gIC8vIFRoZSBidWZmZXIgc2l6ZSBpbiB1bml0cyBvZiBzYW1wbGUtZnJhbWVzLiBJZiBzcGVjaWZpZWQsIHRoZSBidWZmZXJTaXplIG11c3QgYmUgb25lIG9mIHRoZSBmb2xsb3dpbmcgdmFsdWVzOiAyNTYsIDUxMiwgMTAyNCwgMjA0OCwgNDA5NiwgODE5MiwgMTYzODQuXG4gIC8vIElmIGl0J3Mgbm90IHBhc3NlZCBpbiwgb3IgaWYgdGhlIHZhbHVlIGlzIDAsIHRoZW4gdGhlIGltcGxlbWVudGF0aW9uIHdpbGwgY2hvb3NlIHRoZSBiZXN0IGJ1ZmZlciBzaXplIGZvciB0aGUgZ2l2ZW4gZW52aXJvbm1lbnQsXG4gIC8vIHdoaWNoIHdpbGwgYmUgYSBjb25zdGFudCBwb3dlciBvZiAyIHRocm91Z2hvdXQgdGhlIGxpZmV0aW1lIG9mIHRoZSBub2RlLlxuXG4gIC8vIGNvbnN0IGNvbnRleHQgPSBuZXcgQXVkaW9Db250ZXh0KCk7XG4gIGlmKGNvbnRleHQgPT09IHVuZGVmaW5lZCkge1xuICAgIGNvbnRleHQgPSBuZXcgQXVkaW9Db250ZXh0KCk7XG4gIH1cblxuICBjb25zdCBzb3VyY2UgPSBjb250ZXh0LmNyZWF0ZU1lZGlhU3RyZWFtU291cmNlKHN0cmVhbSk7XG4gIGNvbnN0IHByb2Nlc3NvciA9IGNvbnRleHQuY3JlYXRlU2NyaXB0UHJvY2Vzc29yKGJ1ZmZlclNpemUsIG51bWJlck9mSW5wdXRDaGFubmVscywgbnVtYmVyT2ZPdXRwdXRDaGFubmVscyk7XG5cbiAgc291cmNlLmNvbm5lY3QocHJvY2Vzc29yKTtcbiAgcHJvY2Vzc29yLmNvbm5lY3QoY29udGV4dC5kZXN0aW5hdGlvbik7XG5cbiAgcHJvY2Vzc29yLm9uYXVkaW9wcm9jZXNzID0gZnVuY3Rpb24oZSkge1xuICAgIGNvbnN0IGJ1ZmZlciA9IGUuaW5wdXRCdWZmZXI7XG4gICAgaWYoY2FsbGJhY2spIHtcbiAgICAgIGNhbGxiYWNrKGUuaW5wdXRCdWZmZXIpO1xuICAgIH1cbiAgfTtcblxuICByZXR1cm4gY29udGV4dDtcblxuICAvLyBpZihjb250ZXh0LnN0YXRlID09PSAnc3VzcGVuZGVkJylcbiAgLy8gICBjb25zb2xlLmxvZygncmVzdW1pbmcnKVxuICAvLyAgIGNvbnRleHQucmVzdW1lKCk7XG4gIC8vIGlmKGNvbnRleHQuc3RhdGUgPT09ICdydW5uaW5nJylcbiAgLy8gICBjb25zb2xlLmxvZygnc3VzcGVuZGluZycpXG5cbn1cblxuLy8gZnVuY3Rpb24gbG9hZFJhd0F1ZGlvRGF0YSgpIHtcbi8vIH1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlY29kZUF1ZGlvRmlsZURhdGEoYXJyYXlCdWZmZXIpIHtcblxuICBjb25zdCBidWZmZXIgPSBhd2FpdCBkZWNvZGVBdWRpb0ZpbGVCdWZmZXIoYXJyYXlCdWZmZXIpO1xuXG4gIGNvbnN0IGRhdGEgPSBidWZmZXJEYXRhKGJ1ZmZlcik7XG5cbiAgcmV0dXJuIHsgZGF0YTogRmxvYXQzMkFycmF5VG9JbnQxNkFycmF5KGRhdGEpLCBzYW1wbGVSYXRlOiBidWZmZXIuc2FtcGxlUmF0ZSwgbGVuZ3RoOiBidWZmZXIubGVuZ3RoLCBkdXJhdGlvbjogYnVmZmVyLmR1cmF0aW9uLCBudW1iZXJPZkNoYW5uZWxzOiBidWZmZXIubnVtYmVyT2ZDaGFubmVscyB9O1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZmV0Y2hBbmREZWNvZGVBdWRpb0ZpbGUodXJsKSB7XG5cbiAgY29uc3QgYnVmZmVyID0gYXdhaXQgZmV0Y2hBdWRpb0ZpbGVBbmREZWNvZGUodXJsKTtcblxuICBjb25zdCBkYXRhID0gYnVmZmVyRGF0YShidWZmZXIpO1xuXG4gIHJldHVybiB7IGRhdGE6IEZsb2F0MzJBcnJheVRvSW50MTZBcnJheShkYXRhKSwgc2FtcGxlUmF0ZTogYnVmZmVyLnNhbXBsZVJhdGUsIGxlbmd0aDogYnVmZmVyLmxlbmd0aCwgZHVyYXRpb246IGJ1ZmZlci5kdXJhdGlvbiwgbnVtYmVyT2ZDaGFubmVsczogYnVmZmVyLm51bWJlck9mQ2hhbm5lbHMgfTtcbn1cbiIsIjx0ZW1wbGF0ZT5cbiAgPEVkaXRvciBjbGFzcz1cIlwiIDp0cmFuc2NyaXB0PVwidHJhbnNjcmlwdFwiIDp3YXZlZm9ybT1cIndhdmVmb3JtXCIgOmR1cmF0aW9uPVwiZHVyYXRpb25cIiA6dXJsPVwidXJsXCIgOm9uU2F2ZT1cIm9uU2F2ZVwiIEBzZXQtcG9zaXRpb249XCJvblNldFBvc2l0aW9uXCIgcmVmPVwiZWRpdG9yXCI+PC9FZGl0b3I+XG48L3RlbXBsYXRlPlxuXG5cbjxzY3JpcHQgbGFuZz1cInRzXCI+XG4vLyBpbXBvcnQgYm9vdHN0cmFwIGNzc1xuLy8gaW1wb3J0ICdib290c3RyYXAvZGlzdC9jc3MvYm9vdHN0cmFwLm1pbi5jc3MnO1xuLy8gaW1wb3J0ICdib290c3RyYXAtaWNvbnMvZm9udC9ib290c3RyYXAtaWNvbnMuY3NzJztcblxuaW1wb3J0IEVkaXRvciBmcm9tICcuL2NvbXBvbmVudHMvRWRpdG9yLnZ1ZSc7XG5cbmltcG9ydCB7IGRlY29kZUF1ZGlvRmlsZURhdGEsIGZldGNoQW5kRGVjb2RlQXVkaW9GaWxlIH0gZnJvbSAnLi9hdWRpby5qcyc7XG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgY29tcG9uZW50czoge1xuICAgIEVkaXRvcixcbiAgfSxcbiAgcHJvcHM6IHtcbiAgfSxcbiAgZGF0YSgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdHJhbnNjcmlwdDoge30sXG4gICAgICB3YXZlZm9ybTogW10sICAvLyByYXcgYXVkaW8gZGF0YVxuICAgICAgZHVyYXRpb246IDAsXG4gICAgICB1cmw6IHVuZGVmaW5lZCxcbiAgICB9XG4gIH0sXG4gIGFzeW5jIG1vdW50ZWQoKSB7XG4gIH0sXG5cbiAgdW5tb3VudGVkKCkge1xuICAgIGlmKHRoaXMudXJsICYmIHRoaXMudXJsLmxlbmd0aCA+IDAgJiYgdGhpcy51cmwuc3RhcnRzV2l0aCgnYmxvYjonKSkge1xuICAgICAgVVJMLnJldm9rZU9iamVjdFVSTCh0aGlzLnVybCk7XG4gICAgfVxuICB9LFxuXG4gIHdhdGNoOiB7XG4gIH0sXG5cbiAgbWV0aG9kczoge1xuXG4gICAgYXN5bmMgbG9hZCh7IGF1ZGlvLCB0cmFuc2NyaXB0LCBmaWxlLCB3YXZlZm9ybSB9KSB7XG4gICAgICBpZih3YXZlZm9ybSAhPT0gdW5kZWZpbmVkICYmIHdhdmVmb3JtICE9PSBudWxsKSB7XG4gICAgICAgIGlmKHdhdmVmb3JtIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHtcbiAgICAgICAgICBjb25zdCBhdWRpb0RhdGEgPSBhd2FpdCBkZWNvZGVBdWRpb0ZpbGVEYXRhKHdhdmVmb3JtKTtcbiAgICAgICAgICB3YXZlZm9ybSA9IGF1ZGlvRGF0YS5kYXRhO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZih0eXBlb2YoYXVkaW8pID09PSAnc3RyaW5nJykge1xuICAgICAgICB0aGlzLiRyZWZzLmVkaXRvci53YXZlZm9ybUxvYWRpbmcoKTtcbiAgICAgICAgaWYodGhpcy51cmwgJiYgdGhpcy51cmwubGVuZ3RoID4gMCAmJiB0aGlzLnVybC5zdGFydHNXaXRoKCdibG9iOicpKSB7XG4gICAgICAgICAgVVJMLnJldm9rZU9iamVjdFVSTCh0aGlzLnVybCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgdXJsID0gYXVkaW87XG4gICAgICAgIGlmKHdhdmVmb3JtID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICB3YXZlZm9ybSA9IGF1ZGlvO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuJHJlZnMuZWRpdG9yLmxvYWQoeyB1cmwsIHdhdmVmb3JtIH0pO1xuICAgICAgICAvKlxuICAgICAgICAvLyB0aGlzLnVybCA9IHVybDtcbiAgICAgICAgY29uc3QgYXVkaW9EYXRhID0gYXdhaXQgZmV0Y2hBbmREZWNvZGVBdWRpb0ZpbGUoYXVkaW8pO1xuICAgICAgICAvLyB0aGlzLndhdmVmb3JtID0gYXVkaW9EYXRhLmRhdGE7XG4gICAgICAgIC8vIHRoaXMuZHVyYXRpb24gPSBhdWRpb0RhdGEuZHVyYXRpb24gKiAxMDAwO1xuICAgICAgICB0aGlzLiRyZWZzLmVkaXRvci5sb2FkKHsgdXJsLCB3YXZlZm9ybTogYXVkaW9EYXRhLmRhdGEsIGR1cmF0aW9uOiBhdWRpb0RhdGEuZHVyYXRpb24gKiAxMDAwIH0pO1xuICAgICAgICAqL1xuICAgICAgfSBlbHNlIGlmKGF1ZGlvIGluc3RhbmNlb2YgRmlsZSkge1xuICAgICAgICB0aGlzLiRyZWZzLmVkaXRvci53YXZlZm9ybUxvYWRpbmcoKTtcbiAgICAgICAgLy8gdGhpcy53YXZlZm9ybSA9IHVuZGVmaW5lZDtcbiAgICAgICAgaWYodGhpcy51cmwgJiYgdGhpcy51cmwubGVuZ3RoID4gMCAmJiB0aGlzLnVybC5zdGFydHNXaXRoKCdibG9iOicpKSB7XG4gICAgICAgICAgVVJMLnJldm9rZU9iamVjdFVSTCh0aGlzLnVybCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgdXJsID0gVVJMLmNyZWF0ZU9iamVjdFVSTChhdWRpbyk7XG4gICAgICAgIGlmKHdhdmVmb3JtID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICB3YXZlZm9ybSA9IGF1ZGlvO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuJHJlZnMuZWRpdG9yLmxvYWQoeyB1cmwsIHdhdmVmb3JtIH0pO1xuICAgICAgICAvKlxuICAgICAgICAvLyB0aGlzLnVybCA9IHVybDtcbiAgICAgICAgY29uc3QgYXVkaW9EYXRhID0gYXdhaXQgZGVjb2RlQXVkaW9GaWxlRGF0YShhd2FpdCBhdWRpby5hcnJheUJ1ZmZlcigpKTtcbiAgICAgICAgLy8gdGhpcy53YXZlZm9ybSA9IGF1ZGlvRGF0YS5kYXRhO1xuICAgICAgICAvLyB0aGlzLmR1cmF0aW9uID0gYXVkaW9EYXRhLmR1cmF0aW9uICogMTAwMDtcbiAgICAgICAgdGhpcy4kcmVmcy5lZGl0b3IubG9hZCh7IHVybCwgd2F2ZWZvcm06IGF1ZGlvRGF0YS5kYXRhLCBkdXJhdGlvbjogYXVkaW9EYXRhLmR1cmF0aW9uICogMTAwMCB9KTtcbiAgICAgICAgKi9cbiAgICAgIH0gZWxzZSBpZihhdWRpbyBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7XG4gICAgICAgIHRoaXMuJHJlZnMuZWRpdG9yLndhdmVmb3JtTG9hZGluZygpO1xuICAgICAgICBjb25zdCB1cmwgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGZpbGUgfHwgbmV3IEJsb2IoW2F1ZGlvXSkpO1xuICAgICAgICAvLyB0aGlzLnVybCA9IHVybDtcbiAgICAgICAgY29uc3QgYXVkaW9EYXRhID0gYXdhaXQgZGVjb2RlQXVkaW9GaWxlRGF0YShhdWRpbyk7XG4gICAgICAgIC8vIHRoaXMud2F2ZWZvcm0gPSBhdWRpb0RhdGEuZGF0YTtcbiAgICAgICAgLy8gdGhpcy5kdXJhdGlvbiA9IGF1ZGlvRGF0YS5kdXJhdGlvbiAqIDEwMDA7XG4gICAgICAgIGlmKHdhdmVmb3JtID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICB3YXZlZm9ybSA9IGF1ZGlvRGF0YS5kYXRhO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuJHJlZnMuZWRpdG9yLmxvYWQoeyB1cmwsIHdhdmVmb3JtLCBkdXJhdGlvbjogYXVkaW9EYXRhLmR1cmF0aW9uICogMTAwMCB9KTtcbiAgICAgIH0gZWxzZSBpZihhdWRpbyA9PT0gbnVsbCkge1xuICAgICAgICBpZih0aGlzLnVybCAmJiB0aGlzLnVybC5sZW5ndGggPiAwICYmIHRoaXMudXJsLnN0YXJ0c1dpdGgoJ2Jsb2I6JykpIHtcbiAgICAgICAgICBVUkwucmV2b2tlT2JqZWN0VVJMKHRoaXMudXJsKTtcbiAgICAgICAgfVxuICAgICAgICBpZih3YXZlZm9ybSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgd2F2ZWZvcm0gPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuJHJlZnMuZWRpdG9yLmxvYWQoeyB1cmw6ICcnLCB3YXZlZm9ybSwgZHVyYXRpb246IDAgfSk7XG4gICAgICB9IGVsc2UgaWYod2F2ZWZvcm0pIHtcbiAgICAgICAgLy8gdGhpcy4kcmVmcy5lZGl0b3Iud2F2ZWZvcm1Mb2FkaW5nKCk7XG4gICAgICAgIHRoaXMuJHJlZnMuZWRpdG9yLmxvYWQoeyB3YXZlZm9ybSB9KTtcbiAgICAgIH1cbiAgICAgIGlmKHRyYW5zY3JpcHQpIHtcbiAgICAgICAgaWYodHlwZW9mIHRyYW5zY3JpcHQgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh0cmFuc2NyaXB0KTtcbiAgICAgICAgICB0aGlzLnRyYW5zY3JpcHQgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICAgIH0gZWxzZSBpZih0cmFuc2NyaXB0IGluc3RhbmNlb2YgRmlsZSkge1xuICAgICAgICAgIHRoaXMudHJhbnNjcmlwdCA9IEpTT04ucGFyc2UoYXdhaXQgdHJhbnNjcmlwdC50ZXh0KCkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMudHJhbnNjcmlwdCA9IHRyYW5zY3JpcHQ7XG4gICAgICAgIH1cbiAgICAgIC8vIH0gZWxzZSBpZih0aGlzLmF1ZGlvRGF0YSkge1xuICAgICAgICAvLyBUT0RPOiBjYWxsIEFTUlxuICAgICAgfVxuICAgIH0sXG5cbiAgICBhc3luYyBvblNldFBvc2l0aW9uKHBvc2l0aW9uKSB7XG4gICAgICAgIGNvbnNvbGUuZGVidWcoJ29uIHNldCBwb3NpdGlvbjonLCBwb3NpdGlvbik7XG4gICAgfSxcblxuICAgIGFzeW5jIG9uU2F2ZSh0cmFuc2NyaXB0KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdvbiBzYXZlIHRyYW5zY3JpcHQ6JywgdHJhbnNjcmlwdCk7XG4gICAgfSxcblxuICAgIGFzeW5jIHNhdmUodHJhbnNjcmlwdCkge1xuICAgICAgY29uc29sZS5sb2coJ3NhdmUgdHJhbnNjcmlwdCBub3QgaW1wbGVtZW50ZWQsIHRyYW5zY3JpcHQ6JywgdHJhbnNjcmlwdCk7XG4gICAgfSxcbiAgfSxcbn07XG5cbjwvc2NyaXB0PlxuXG48c3R5bGUgc2NvcGVkPlxuPC9zdHlsZT5cbiIsImltcG9ydCB7IGNyZWF0ZUFwcCB9IGZyb20gJ3Z1ZSdcbmltcG9ydCBFZGl0b3JXaXRoTWVkaWFMb2FkZXIgZnJvbSAnLi9FZGl0b3JXaXRoTWVkaWFMb2FkZXIudnVlJ1xuXG4vLyBpbXBvcnQgYm9vdHN0cmFwIGNzc1xuaW1wb3J0ICdib290c3RyYXAvZGlzdC9jc3MvYm9vdHN0cmFwLm1pbi5jc3MnO1xuaW1wb3J0ICdib290c3RyYXAtaWNvbnMvZm9udC9ib290c3RyYXAtaWNvbnMuY3NzJztcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gaW5pdChzZWxlY3RvciA9ICcjYXBwJykge1xuICByZXR1cm4gY3JlYXRlQXBwKEVkaXRvcldpdGhNZWRpYUxvYWRlcikubW91bnQoc2VsZWN0b3IpO1xufVxuIl0sIm5hbWVzIjpbInN0ciIsImV4cGVjdHNMb3dlckNhc2UiLCJtYXAiLCJPYmplY3QiLCJjcmVhdGUiLCJsaXN0Iiwic3BsaXQiLCJpIiwibGVuZ3RoIiwidmFsIiwidG9Mb3dlckNhc2UiLCJpc1NwZWNpYWxCb29sZWFuQXR0ciIsInZhbHVlIiwiaXNBcnJheSIsInJlcyIsIml0ZW0iLCJub3JtYWxpemVkIiwiaXNTdHJpbmciLCJwYXJzZVN0cmluZ1N0eWxlIiwibm9ybWFsaXplU3R5bGUiLCJrZXkiLCJpc09iamVjdCIsImxpc3REZWxpbWl0ZXJSRSIsInByb3BlcnR5RGVsaW1pdGVyUkUiLCJjc3NUZXh0IiwicmV0IiwiZm9yRWFjaCIsInRtcCIsInRyaW0iLCJub3JtYWxpemVDbGFzcyIsIm5hbWUiLCJ0b0Rpc3BsYXlTdHJpbmciLCJ0b1N0cmluZyIsIm9iamVjdFRvU3RyaW5nIiwiaXNGdW5jdGlvbiIsIkpTT04iLCJzdHJpbmdpZnkiLCJyZXBsYWNlciIsIlN0cmluZyIsIl9rZXkiLCJfX3ZfaXNSZWYiLCJpc01hcCIsInNpemUiLCJlbnRyaWVzIiwicmVkdWNlIiwidmFsMiIsImlzU2V0IiwidmFsdWVzIiwiaXNQbGFpbk9iamVjdCIsIkVNUFRZX09CSiIsIkVNUFRZX0FSUiIsIk5PT1AiLCJOTyIsIm9uUkUiLCJpc09uIiwidGVzdCIsImlzTW9kZWxMaXN0ZW5lciIsInN0YXJ0c1dpdGgiLCJleHRlbmQiLCJhc3NpZ24iLCJyZW1vdmUiLCJhcnIiLCJlbCIsImluZGV4T2YiLCJzcGxpY2UiLCJoYXNPd25Qcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093biIsImNhbGwiLCJBcnJheSIsInRvVHlwZVN0cmluZyIsImlzU3ltYm9sIiwiaXNQcm9taXNlIiwidGhlbiIsImNhdGNoIiwiaXNJbnRlZ2VyS2V5IiwicGFyc2VJbnQiLCJpc1Jlc2VydmVkUHJvcCIsImNhY2hlU3RyaW5nRnVuY3Rpb24iLCJmbiIsImNhY2hlIiwiY2FtZWxpemVSRSIsImNhbWVsaXplIiwicmVwbGFjZSIsIl8iLCJjIiwidG9VcHBlckNhc2UiLCJoeXBoZW5hdGVSRSIsImh5cGhlbmF0ZSIsImNhcGl0YWxpemUiLCJjaGFyQXQiLCJzbGljZSIsInRvSGFuZGxlcktleSIsImhhc0NoYW5nZWQiLCJvbGRWYWx1ZSIsImlzIiwiaW52b2tlQXJyYXlGbnMiLCJmbnMiLCJhcmciLCJkZWYiLCJvYmoiLCJkZWZpbmVQcm9wZXJ0eSIsImNvbmZpZ3VyYWJsZSIsImVudW1lcmFibGUiLCJ0b051bWJlciIsIm4iLCJwYXJzZUZsb2F0IiwiaXNOYU4iLCJfZ2xvYmFsVGhpcyIsImFjdGl2ZUVmZmVjdFNjb3BlIiwiY29uc3RydWN0b3IiLCJkZXRhY2hlZCIsImFjdGl2ZSIsImVmZmVjdHMiLCJjbGVhbnVwcyIsInBhcmVudCIsImluZGV4Iiwic2NvcGVzIiwicHVzaCIsInRoaXMiLCJydW4iLCJvbiIsIm9mZiIsInN0b3AiLCJmcm9tUGFyZW50IiwibCIsImxhc3QyIiwicG9wIiwiY3JlYXRlRGVwIiwiZGVwIiwiU2V0IiwidyIsIndhc1RyYWNrZWQiLCJ0cmFja09wQml0IiwibmV3VHJhY2tlZCIsInRhcmdldE1hcCIsIldlYWtNYXAiLCJlZmZlY3RUcmFja0RlcHRoIiwiYWN0aXZlRWZmZWN0IiwiSVRFUkFURV9LRVkiLCJTeW1ib2wiLCJNQVBfS0VZX0lURVJBVEVfS0VZIiwic2NoZWR1bGVyIiwic2NvcGUiLCJkZXBzIiwiZWZmZWN0IiwibGFzdFNob3VsZFRyYWNrIiwic2hvdWxkVHJhY2siLCJwdHIiLCJkZWxldGUiLCJvblN0b3AiLCJ0cmFja1N0YWNrIiwidGFyZ2V0IiwidHlwZSIsImRlcHNNYXAiLCJnZXQiLCJzZXQiLCJNYXAiLCJkZWJ1Z2dlckV2ZW50RXh0cmFJbmZvIiwic2hvdWxkVHJhY2syIiwiaGFzIiwiYWRkIiwibmV3VmFsdWUiLCJvbGRUYXJnZXQiLCJrZXkyIiwiYWxsb3dSZWN1cnNlIiwiaXNOb25UcmFja2FibGVLZXlzIiwiYnVpbHRJblN5bWJvbHMiLCJnZXRPd25Qcm9wZXJ0eU5hbWVzIiwiZmlsdGVyIiwic2hhbGxvd0dldCIsInJlYWRvbmx5R2V0IiwiYXJyYXlJbnN0cnVtZW50YXRpb25zIiwiaW5zdHJ1bWVudGF0aW9ucyIsImFyZ3MiLCJ0b1JhdyIsImFwcGx5IiwiaXNSZWFkb25seTIiLCJzaGFsbG93IiwicmVjZWl2ZXIiLCJzaGFsbG93UmVhZG9ubHlNYXAiLCJyZWFkb25seU1hcCIsInNoYWxsb3dSZWFjdGl2ZU1hcCIsInJlYWN0aXZlTWFwIiwidGFyZ2V0SXNBcnJheSIsIlJlZmxlY3QiLCJpc1JlZiIsInJlYWRvbmx5IiwicmVhY3RpdmUiLCJpc1JlYWRvbmx5IiwiaXNTaGFsbG93IiwiaGFkS2V5IiwiTnVtYmVyIiwicmVzdWx0IiwibXV0YWJsZUhhbmRsZXJzIiwiZGVsZXRlUHJvcGVydHkiLCJvd25LZXlzIiwicmVhZG9ubHlIYW5kbGVycyIsInNoYWxsb3dSZWFjdGl2ZUhhbmRsZXJzIiwidG9TaGFsbG93IiwiZ2V0UHJvdG8iLCJ2IiwiZ2V0UHJvdG90eXBlT2YiLCJpc1NoYWxsb3cyIiwicmF3VGFyZ2V0IiwicmF3S2V5IiwidHJhY2siLCJ3cmFwIiwidG9SZWFkb25seSIsInRvUmVhY3RpdmUiLCJoYXMyIiwiZ2V0MiIsImhhZEl0ZW1zIiwiY2xlYXIiLCJjYWxsYmFjayIsInRoaXNBcmciLCJvYnNlcnZlZCIsIm1ldGhvZCIsInRhcmdldElzTWFwIiwiaXNQYWlyIiwiaXRlcmF0b3IiLCJpc0tleU9ubHkiLCJpbm5lckl0ZXJhdG9yIiwibmV4dCIsImRvbmUiLCJtdXRhYmxlSW5zdHJ1bWVudGF0aW9uczIiLCJnZXQkMSIsImhhcyQxIiwic2V0JDEiLCJkZWxldGVFbnRyeSIsImNyZWF0ZUZvckVhY2giLCJzaGFsbG93SW5zdHJ1bWVudGF0aW9uczIiLCJyZWFkb25seUluc3RydW1lbnRhdGlvbnMyIiwiY3JlYXRlUmVhZG9ubHlNZXRob2QiLCJzaGFsbG93UmVhZG9ubHlJbnN0cnVtZW50YXRpb25zMiIsImNyZWF0ZUl0ZXJhYmxlTWV0aG9kIiwibXV0YWJsZUluc3RydW1lbnRhdGlvbnMiLCJyZWFkb25seUluc3RydW1lbnRhdGlvbnMiLCJzaGFsbG93SW5zdHJ1bWVudGF0aW9ucyIsInNoYWxsb3dSZWFkb25seUluc3RydW1lbnRhdGlvbnMiLCJtdXRhYmxlQ29sbGVjdGlvbkhhbmRsZXJzIiwic2hhbGxvd0NvbGxlY3Rpb25IYW5kbGVycyIsInJlYWRvbmx5Q29sbGVjdGlvbkhhbmRsZXJzIiwiaXNFeHRlbnNpYmxlIiwicmF3VHlwZSIsInRhcmdldFR5cGVNYXAiLCJ0b1Jhd1R5cGUiLCJjcmVhdGVSZWFjdGl2ZU9iamVjdCIsImJhc2VIYW5kbGVycyIsImNvbGxlY3Rpb25IYW5kbGVycyIsInByb3h5TWFwIiwiZXhpc3RpbmdQcm94eSIsInRhcmdldFR5cGUiLCJnZXRUYXJnZXRUeXBlIiwicHJveHkiLCJQcm94eSIsImlzUmVhY3RpdmUiLCJyYXciLCJyIiwic2hhbGxvd1Vud3JhcEhhbmRsZXJzIiwidW5yZWYiLCJyZWYiLCJvYmplY3RXaXRoUmVmcyIsImdldHRlciIsIl9zZXR0ZXIiLCJpc1NTUiIsIl9kaXJ0eSIsIlJlYWN0aXZlRWZmZWN0IiwiY29tcHV0ZWQiLCJfY2FjaGVhYmxlIiwic2VsZjIiLCJfdmFsdWUiLCJpbnN0YW5jZSIsImVyciIsImNhbGxXaXRoRXJyb3JIYW5kbGluZyIsImNhbGxXaXRoQXN5bmNFcnJvckhhbmRsaW5nIiwidGhyb3dJbkRldiIsInZub2RlIiwiY3VyIiwiZXhwb3NlZEluc3RhbmNlIiwiZXJyb3JJbmZvIiwiZXJyb3JDYXB0dXJlZEhvb2tzIiwiZWMiLCJhcHBFcnJvckhhbmRsZXIiLCJhcHBDb250ZXh0IiwiY29uZmlnIiwiZXJyb3JIYW5kbGVyIiwiY29udGV4dFZOb2RlIiwiZXJyb3IiLCJQcm9taXNlIiwicmVzb2x2ZSIsImlzRmx1c2hpbmciLCJpc0ZsdXNoUGVuZGluZyIsInF1ZXVlIiwiZmx1c2hJbmRleCIsInBlbmRpbmdQcmVGbHVzaENicyIsImFjdGl2ZVByZUZsdXNoQ2JzIiwicHJlRmx1c2hJbmRleCIsInBlbmRpbmdQb3N0Rmx1c2hDYnMiLCJhY3RpdmVQb3N0Rmx1c2hDYnMiLCJwb3N0Rmx1c2hJbmRleCIsInJlc29sdmVkUHJvbWlzZSIsImN1cnJlbnRGbHVzaFByb21pc2UiLCJjdXJyZW50UHJlRmx1c2hQYXJlbnRKb2IiLCJwMiIsImJpbmQiLCJqb2IiLCJpbmNsdWRlcyIsImlkIiwiaWQyIiwic3RhcnQyIiwiZW5kIiwibWlkZGxlIiwiZ2V0SWQiLCJmaW5kSW5zZXJ0aW9uSW5kZXgiLCJmbHVzaEpvYnMiLCJjYiIsImFjdGl2ZVF1ZXVlIiwicGVuZGluZ1F1ZXVlIiwic2VlbiIsInBhcmVudEpvYiIsImRlZHVwZWQiLCJzb3J0IiwiYSIsImIiLCJJbmZpbml0eSIsImV2ZW50IiwicmF3QXJncyIsInByb3BzIiwiaXNNb2RlbExpc3RlbmVyMiIsIm1vZGVsQXJnIiwibW9kaWZpZXJzS2V5IiwibnVtYmVyIiwiaGFuZGxlck5hbWUiLCJoYW5kbGVyIiwib25jZUhhbmRsZXIiLCJlbWl0dGVkIiwiY29tcCIsImFzTWl4aW4iLCJlbWl0c0NhY2hlIiwiY2FjaGVkIiwiZW1pdHMiLCJoYXNFeHRlbmRzIiwiZXh0ZW5kRW1pdHMiLCJyYXcyIiwibm9ybWFsaXplZEZyb21FeHRlbmQiLCJub3JtYWxpemVFbWl0c09wdGlvbnMiLCJtaXhpbnMiLCJleHRlbmRzIiwib3B0aW9ucyIsImN1cnJlbnRSZW5kZXJpbmdJbnN0YW5jZSIsImN1cnJlbnRTY29wZUlkIiwicHJldiIsIl9fc2NvcGVJZCIsIkNvbXBvbmVudCIsIndpdGhQcm94eSIsInByb3BzT3B0aW9ucyIsInNsb3RzIiwiYXR0cnMiLCJlbWl0IiwicmVuZGVyIiwicmVuZGVyQ2FjaGUiLCJkYXRhIiwic2V0dXBTdGF0ZSIsImN0eCIsImluaGVyaXRBdHRycyIsImZhbGx0aHJvdWdoQXR0cnMiLCJzZXRDdXJyZW50UmVuZGVyaW5nSW5zdGFuY2UiLCJzaGFwZUZsYWciLCJwcm94eVRvVXNlIiwibm9ybWFsaXplVk5vZGUiLCJyZW5kZXIyIiwiZ2V0RnVuY3Rpb25hbEZhbGx0aHJvdWdoIiwiY3JlYXRlVk5vZGUiLCJDb21tZW50Iiwicm9vdDIiLCJrZXlzIiwic29tZSIsImZpbHRlck1vZGVsTGlzdGVuZXJzIiwiY2xvbmVWTm9kZSIsImRpcnMiLCJjb25jYXQiLCJ0cmFuc2l0aW9uIiwicHJldlByb3BzIiwibmV4dFByb3BzIiwiZW1pdHNPcHRpb25zIiwibmV4dEtleXMiLCJpc0VtaXRMaXN0ZW5lciIsImRlZmF1bHRWYWx1ZSIsInRyZWF0RGVmYXVsdEFzRmFjdG9yeSIsImN1cnJlbnRJbnN0YW5jZSIsInByb3ZpZGVzIiwiYXJndW1lbnRzIiwiSU5JVElBTF9XQVRDSEVSX1ZBTFVFIiwic291cmNlIiwiZG9XYXRjaCIsImltbWVkaWF0ZSIsImRlZXAiLCJmbHVzaCIsIm9uVHJhY2siLCJvblRyaWdnZXIiLCJjbGVhbnVwIiwiZm9yY2VUcmlnZ2VyIiwiaXNNdWx0aVNvdXJjZSIsImlzU2hhbGxvdyQxIiwicyIsInRyYXZlcnNlIiwiaXNVbm1vdW50ZWQiLCJvbkNsZWFudXAiLCJiYXNlR2V0dGVyIiwiaXNJblNTUkNvbXBvbmVudFNldHVwIiwicXVldWVQb3N0UmVuZGVyRWZmZWN0Iiwic3VzcGVuc2UiLCJpc01vdW50ZWQiLCJwdWJsaWNUaGlzIiwiY3JlYXRlUGF0aEdldHRlciIsInBhdGgiLCJzZWdtZW50cyIsImlzQXN5bmNXcmFwcGVyIiwiX19hc3luY0xvYWRlciIsImlzS2VlcEFsaXZlIiwiX19pc0tlZXBBbGl2ZSIsImhvb2siLCJ3cmFwcGVkSG9vayIsIl9fd2RjIiwiY3VycmVudCIsImlzRGVhY3RpdmF0ZWQiLCJrZWVwQWxpdmVSb290IiwiaW5qZWN0ZWQiLCJpbmplY3RIb29rIiwicHJlcGVuZCIsImhvb2tzIiwiX193ZWgiLCJ1bnNoaWZ0IiwiY3JlYXRlSG9vayIsImxpZmVjeWNsZSIsIm9uQmVmb3JlTW91bnQiLCJvbk1vdW50ZWQiLCJvbkJlZm9yZVVwZGF0ZSIsIm9uVXBkYXRlZCIsIm9uQmVmb3JlVW5tb3VudCIsIm9uVW5tb3VudGVkIiwib25TZXJ2ZXJQcmVmZXRjaCIsIm9uUmVuZGVyVHJpZ2dlcmVkIiwib25SZW5kZXJUcmFja2VkIiwic2hvdWxkQ2FjaGVBY2Nlc3MiLCJyZXNvbHZlTWVyZ2VkT3B0aW9ucyIsImJlZm9yZUNyZWF0ZSIsImRhdGFPcHRpb25zIiwiY29tcHV0ZWRPcHRpb25zIiwibWV0aG9kcyIsIndhdGNoIiwid2F0Y2hPcHRpb25zIiwicHJvdmlkZSIsInByb3ZpZGVPcHRpb25zIiwiaW5qZWN0IiwiaW5qZWN0T3B0aW9ucyIsImNyZWF0ZWQiLCJiZWZvcmVNb3VudCIsIm1vdW50ZWQiLCJiZWZvcmVVcGRhdGUiLCJ1cGRhdGVkIiwiYWN0aXZhdGVkIiwiZGVhY3RpdmF0ZWQiLCJiZWZvcmVEZXN0cm95IiwiYmVmb3JlVW5tb3VudCIsImRlc3Ryb3llZCIsInVubW91bnRlZCIsInJlbmRlclRyYWNrZWQiLCJyZW5kZXJUcmlnZ2VyZWQiLCJlcnJvckNhcHR1cmVkIiwic2VydmVyUHJlZmV0Y2giLCJleHBvc2UiLCJjb21wb25lbnRzIiwiZGlyZWN0aXZlcyIsImZpbHRlcnMiLCJjaGVja0R1cGxpY2F0ZVByb3BlcnRpZXMiLCJ1bndyYXBSZWYiLCJub3JtYWxpemVJbmplY3QiLCJvcHQiLCJmcm9tIiwiZGVmYXVsdCIsInVud3JhcEluamVjdGVkUmVmIiwibWV0aG9kSGFuZGxlciIsInNldDIiLCJwYXJlbnRQcm92aWRlcyIsInJlZ2lzdGVyIiwiX2hvb2siLCJvbkFjdGl2YXRlZCIsIm9uRGVhY3RpdmF0ZWQiLCJvbkVycm9yQ2FwdHVyZWQiLCJleHBvc2VkIiwiaCIsImNyZWF0ZVdhdGNoZXIiLCJiYXNlIiwiZXh0ZW5kc09wdGlvbnMiLCJnbG9iYWxNaXhpbnMiLCJvcHRpb25zQ2FjaGUiLCJvcHRpb25NZXJnZVN0cmF0ZWdpZXMiLCJyZXNvbHZlZCIsIm1lcmdlT3B0aW9ucyIsIm0iLCJ0byIsInN0cmF0cyIsInN0cmF0IiwiaW50ZXJuYWxPcHRpb25NZXJnZVN0cmF0cyIsIm1lcmdlRGF0YUZuIiwibWVyZ2VPYmplY3RPcHRpb25zIiwibWVyZ2VBc0FycmF5IiwibWVyZ2VkIiwicmF3UHJvcHMiLCJpc1N0YXRlZnVsIiwiSW50ZXJuYWxPYmplY3RLZXkiLCJwcm9wc0RlZmF1bHRzIiwibmVlZENhc3RLZXlzIiwicmF3Q2FzdFZhbHVlcyIsImhhc0F0dHJzQ2hhbmdlZCIsImNhbWVsS2V5IiwicmF3Q3VycmVudFByb3BzIiwiY2FzdFZhbHVlcyIsInJlc29sdmVQcm9wVmFsdWUiLCJpc0Fic2VudCIsImhhc0RlZmF1bHQiLCJGdW5jdGlvbiIsInByb3BzQ2FjaGUiLCJleHRlbmRQcm9wcyIsIm5vcm1hbGl6ZVByb3BzT3B0aW9ucyIsIm5vcm1hbGl6ZWRLZXkiLCJ2YWxpZGF0ZVByb3BOYW1lIiwicHJvcCIsImJvb2xlYW5JbmRleCIsImdldFR5cGVJbmRleCIsIkJvb2xlYW4iLCJzdHJpbmdJbmRleCIsImN0b3IiLCJtYXRjaCIsImdldFR5cGUiLCJleHBlY3RlZFR5cGVzIiwiZmluZEluZGV4IiwiaXNTYW1lVHlwZSIsInQiLCJpc0ludGVybmFsS2V5Iiwibm9ybWFsaXplU2xvdFZhbHVlIiwibm9ybWFsaXplU2xvdCIsInJhd1Nsb3QiLCJpc05vblNjb3BlZFNsb3QiLCJfbiIsInJlbmRlckZuV2l0aENvbnRleHQiLCJfZCIsInByZXZJbnN0YW5jZSIsIl9jIiwid2l0aEN0eCIsIm5vcm1hbGl6ZU9iamVjdFNsb3RzIiwicmF3U2xvdHMiLCJfY3R4Iiwibm9ybWFsaXplVk5vZGVTbG90cyIsImNoaWxkcmVuMiIsInByZXZWTm9kZSIsImJpbmRpbmdzIiwib2xkQmluZGluZ3MiLCJiaW5kaW5nIiwiZGlyIiwiYXBwIiwiaXNOYXRpdmVUYWciLCJwZXJmb3JtYW5jZSIsImdsb2JhbFByb3BlcnRpZXMiLCJ3YXJuSGFuZGxlciIsImNvbXBpbGVyT3B0aW9ucyIsInVpZCIsImh5ZHJhdGUiLCJyb290Q29tcG9uZW50Iiwicm9vdFByb3BzIiwiY29udGV4dCIsImNyZWF0ZUFwcENvbnRleHQiLCJpbnN0YWxsZWRQbHVnaW5zIiwiX3VpZCIsIl9jb21wb25lbnQiLCJfcHJvcHMiLCJfY29udGFpbmVyIiwiX2NvbnRleHQiLCJfaW5zdGFuY2UiLCJ2ZXJzaW9uIiwidXNlIiwicGx1Z2luIiwiaW5zdGFsbCIsIm1peGluIiwiY29tcG9uZW50IiwiZGlyZWN0aXZlIiwibW91bnQiLCJyb290Q29udGFpbmVyIiwiaXNIeWRyYXRlIiwiaXNTVkciLCJfX3Z1ZV9hcHBfXyIsImdldEV4cG9zZVByb3h5IiwidW5tb3VudCIsInJhd1JlZiIsIm9sZFJhd1JlZiIsInBhcmVudFN1c3BlbnNlIiwiaXNVbm1vdW50Iiwic2V0UmVmIiwicmVmVmFsdWUiLCJvd25lciIsIm9sZFJlZiIsInJlZnMiLCJfaXNTdHJpbmciLCJfaXNSZWYiLCJkb1NldCIsImYiLCJleGlzdGluZyIsImsiLCJwZW5kaW5nQnJhbmNoIiwiY3JlYXRlSHlkcmF0aW9uRm5zIiwiZ2xvYmFsVGhpcyIsInNlbGYiLCJ3aW5kb3ciLCJnbG9iYWwiLCJfX1ZVRV9fIiwiaW5zZXJ0IiwiaG9zdEluc2VydCIsImhvc3RSZW1vdmUiLCJwYXRjaFByb3AiLCJob3N0UGF0Y2hQcm9wIiwiY3JlYXRlRWxlbWVudCIsImhvc3RDcmVhdGVFbGVtZW50IiwiY3JlYXRlVGV4dCIsImhvc3RDcmVhdGVUZXh0IiwiY3JlYXRlQ29tbWVudCIsImhvc3RDcmVhdGVDb21tZW50Iiwic2V0VGV4dCIsImhvc3RTZXRUZXh0Iiwic2V0RWxlbWVudFRleHQiLCJob3N0U2V0RWxlbWVudFRleHQiLCJwYXJlbnROb2RlIiwiaG9zdFBhcmVudE5vZGUiLCJuZXh0U2libGluZyIsImhvc3ROZXh0U2libGluZyIsInNldFNjb3BlSWQiLCJob3N0U2V0U2NvcGVJZCIsImNsb25lTm9kZSIsImhvc3RDbG9uZU5vZGUiLCJpbnNlcnRTdGF0aWNDb250ZW50IiwiaG9zdEluc2VydFN0YXRpY0NvbnRlbnQiLCJwYXRjaCIsIm4xIiwibjIiLCJjb250YWluZXIiLCJhbmNob3IiLCJwYXJlbnRDb21wb25lbnQiLCJzbG90U2NvcGVJZHMiLCJvcHRpbWl6ZWQiLCJkeW5hbWljQ2hpbGRyZW4iLCJpc1NhbWVWTm9kZVR5cGUiLCJnZXROZXh0SG9zdE5vZGUiLCJwYXRjaEZsYWciLCJUZXh0IiwiU3RhdGljIiwiRnJhZ21lbnQiLCJwcm9jZXNzIiwiaW50ZXJuYWxzIiwicHJvY2Vzc1RleHQiLCJjaGlsZHJlbiIsInByb2Nlc3NDb21tZW50Tm9kZSIsIm1vdW50U3RhdGljTm9kZSIsIm1vdmVTdGF0aWNOb2RlIiwicmVtb3ZlU3RhdGljTm9kZSIsInByb2Nlc3NFbGVtZW50IiwibW91bnRFbGVtZW50Iiwidm5vZGVIb29rIiwidW5tb3VudENoaWxkcmVuIiwib25Wbm9kZUJlZm9yZU1vdW50Iiwic2NvcGVJZCIsIm5lZWRDYWxsVHJhbnNpdGlvbkhvb2tzIiwicGVyc2lzdGVkIiwiYmVmb3JlRW50ZXIiLCJvblZub2RlTW91bnRlZCIsImludm9rZVZOb2RlSG9vayIsImVudGVyIiwiaW52b2tlRGlyZWN0aXZlSG9vayIsInN1YlRyZWUiLCJwYXJlbnRWTm9kZSIsIm1vdW50Q2hpbGRyZW4iLCJjaGlsZCIsImNsb25lSWZNb3VudGVkIiwicGF0Y2hFbGVtZW50Iiwib2xkUHJvcHMiLCJuZXdQcm9wcyIsInRvZ2dsZVJlY3Vyc2UiLCJvblZub2RlQmVmb3JlVXBkYXRlIiwiYXJlQ2hpbGRyZW5TVkciLCJjbGFzcyIsInN0eWxlIiwicHJvcHNUb1VwZGF0ZSIsImR5bmFtaWNQcm9wcyIsIm9uVm5vZGVVcGRhdGVkIiwicGF0Y2hCbG9ja0NoaWxkcmVuIiwib2xkQ2hpbGRyZW4iLCJuZXdDaGlsZHJlbiIsImZhbGxiYWNrQ29udGFpbmVyIiwib2xkVk5vZGUiLCJuZXdWTm9kZSIsInBhdGNoUHJvcHMiLCJwcm9jZXNzRnJhZ21lbnQiLCJmcmFnbWVudFN0YXJ0QW5jaG9yIiwiZnJhZ21lbnRFbmRBbmNob3IiLCJmcmFnbWVudFNsb3RTY29wZUlkcyIsInByb2Nlc3NDb21wb25lbnQiLCJhY3RpdmF0ZSIsIm1vdW50Q29tcG9uZW50IiwiaW5pdGlhbFZOb2RlIiwiZW1wdHlBcHBDb250ZXh0IiwidWlkJDEiLCJyb290IiwidXBkYXRlIiwiRWZmZWN0U2NvcGUiLCJleHBvc2VQcm94eSIsImFjY2Vzc0NhY2hlIiwic2V0dXBDb250ZXh0Iiwic3VzcGVuc2VJZCIsInBlbmRpbmdJZCIsImFzeW5jRGVwIiwiYXN5bmNSZXNvbHZlZCIsImJjIiwiYm0iLCJidSIsInUiLCJ1bSIsImJ1bSIsImRhIiwicnRnIiwicnRjIiwic3AiLCJlbWl0JDEiLCJjZSIsImNyZWF0ZUNvbXBvbmVudEluc3RhbmNlIiwicmVuZGVyZXIiLCJpc1N0YXRlZnVsQ29tcG9uZW50Iiwic2V0dXBSZXN1bHQiLCJtYXJrUmF3IiwiUHVibGljSW5zdGFuY2VQcm94eUhhbmRsZXJzIiwic2V0dXAiLCJjcmVhdGVBdHRyc1Byb3h5IiwiY3JlYXRlU2V0dXBDb250ZXh0IiwidW5zZXRDdXJyZW50SW5zdGFuY2UiLCJyZXNvbHZlZFJlc3VsdCIsImUiLCJzZXR1cFN0YXRlZnVsQ29tcG9uZW50IiwicmVnaXN0ZXJEZXAiLCJzZXR1cFJlbmRlckVmZmVjdCIsInBsYWNlaG9sZGVyIiwidXBkYXRlQ29tcG9uZW50IiwibmV4dFZOb2RlIiwicHJldkNoaWxkcmVuIiwibmV4dENoaWxkcmVuIiwiJHN0YWJsZSIsImhhc1Byb3BzQ2hhbmdlZCIsInNob3VsZFVwZGF0ZUNvbXBvbmVudCIsImNvbXBvbmVudFVwZGF0ZUZuIiwib3JpZ2luTmV4dCIsIm5leHRUcmVlIiwicmVuZGVyQ29tcG9uZW50Um9vdCIsInByZXZUcmVlIiwiaXNBc3luY1dyYXBwZXJWTm9kZSIsImh5ZHJhdGVOb2RlIiwiaHlkcmF0ZVN1YlRyZWUiLCJzY29wZWRJbml0aWFsVk5vZGUiLCJxdWV1ZUpvYiIsInVwZGF0ZUNvbXBvbmVudFByZVJlbmRlciIsInJhd1ByZXZQcm9wcyIsImtlYmFiS2V5Iiwic2V0RnVsbFByb3BzIiwiY2FtZWxpemVkS2V5IiwibmVlZERlbGV0aW9uQ2hlY2siLCJkZWxldGlvbkNvbXBhcmlzb25UYXJnZXQiLCJwYXRjaENoaWxkcmVuIiwiYzEiLCJwcmV2U2hhcGVGbGFnIiwiYzIiLCJwYXRjaFVua2V5ZWRDaGlsZHJlbiIsIm9sZExlbmd0aCIsIm5ld0xlbmd0aCIsImNvbW1vbkxlbmd0aCIsIk1hdGgiLCJtaW4iLCJuZXh0Q2hpbGQiLCJwYXRjaEtleWVkQ2hpbGRyZW4iLCJwYXJlbnRBbmNob3IiLCJsMiIsImUxIiwiZTIiLCJuZXh0UG9zIiwiczEiLCJzMiIsImtleVRvTmV3SW5kZXhNYXAiLCJqIiwicGF0Y2hlZCIsInRvQmVQYXRjaGVkIiwibW92ZWQiLCJtYXhOZXdJbmRleFNvRmFyIiwibmV3SW5kZXhUb09sZEluZGV4TWFwIiwicHJldkNoaWxkIiwibmV3SW5kZXgiLCJpbmNyZWFzaW5nTmV3SW5kZXhTZXF1ZW5jZSIsImxlbiIsImFyckkiLCJnZXRTZXF1ZW5jZSIsIm5leHRJbmRleCIsIm1vdmUiLCJtb3ZlVHlwZSIsImxlYXZlIiwiZGVsYXlMZWF2ZSIsImFmdGVyTGVhdmUiLCJyZW1vdmUzIiwicGVyZm9ybUxlYXZlIiwiZG9SZW1vdmUiLCJkZWFjdGl2YXRlIiwic2hvdWxkSW52b2tlRGlycyIsInNob3VsZEludm9rZVZub2RlSG9vayIsIm9uVm5vZGVCZWZvcmVVbm1vdW50Iiwib25Wbm9kZVVubW91bnRlZCIsInJlbW92ZTIiLCJwZXJmb3JtUmVtb3ZlIiwicmVtb3ZlRnJhZ21lbnQiLCJ1bm1vdW50Q29tcG9uZW50IiwiX3Zub2RlIiwicCIsIm10IiwibWMiLCJwYyIsInBiYyIsIm8iLCJjcmVhdGVBcHAiLCJjcmVhdGVBcHBBUEkiLCJiYXNlQ3JlYXRlUmVuZGVyZXIiLCJhbGxvd2VkIiwiY2gxIiwiY2gyIiwibWF5YmVTZWxmUmVmZXJlbmNlIiwid2Fybk1pc3NpbmciLCJzZWxmTmFtZSIsImRpc3BsYXlOYW1lIiwiZ2V0Q29tcG9uZW50TmFtZSIsInJlc29sdmVBc3NldCIsIk5VTExfRFlOQU1JQ19DT01QT05FTlQiLCJyZWdpc3RyeSIsImJsb2NrU3RhY2siLCJjdXJyZW50QmxvY2siLCJkaXNhYmxlVHJhY2tpbmciLCJpc0Jsb2NrVHJlZUVuYWJsZWQiLCJzZXR1cEJsb2NrIiwiY3JlYXRlQmFzZVZOb2RlIiwiX192X2lzVk5vZGUiLCJub3JtYWxpemVLZXkiLCJub3JtYWxpemVSZWYiLCJyZWZfa2V5IiwicmVmX2ZvciIsImlzQmxvY2tOb2RlIiwibmVlZEZ1bGxDaGlsZHJlbk5vcm1hbGl6YXRpb24iLCJfX3Zfc2tpcCIsInNzQ29udGVudCIsInNzRmFsbGJhY2siLCJ0YXJnZXRBbmNob3IiLCJzdGF0aWNDb3VudCIsIm5vcm1hbGl6ZSIsImlzVk5vZGUiLCJjbG9uZWQiLCJfX3ZjY09wdHMiLCJpc1Byb3h5IiwiZ3VhcmRSZWFjdGl2ZVByb3BzIiwia2xhc3MiLCJfX2lzU3VzcGVuc2UiLCJpc1N1c3BlbnNlIiwiX19pc1RlbGVwb3J0IiwiaXNUZWxlcG9ydCIsImV4dHJhUHJvcHMiLCJtZXJnZVJlZiIsIm1lcmdlZFByb3BzIiwidG9NZXJnZSIsImluY29taW5nIiwibWVyZ2VQcm9wcyIsInRleHQiLCJmbGFnIiwiYXNCbG9jayIsImNyZWF0ZUJsb2NrIiwibWVtbyIsInNsb3QiLCJzbG90RmxhZyIsImNyZWF0ZVRleHRWTm9kZSIsInJlbmRlckl0ZW0iLCJmYWxsYmFjayIsIm5vU2xvdHRlZCIsImlzQ0UiLCJ2YWxpZFNsb3RDb250ZW50IiwiZW5zdXJlVmFsaWRWTm9kZSIsInJlbmRlcmVkIiwidm5vZGVzIiwiZ2V0UHVibGljSW5zdGFuY2UiLCJwdWJsaWNQcm9wZXJ0aWVzTWFwIiwiJCIsIiRlbCIsIiRkYXRhIiwiJHByb3BzIiwiJGF0dHJzIiwiJHNsb3RzIiwiJHJlZnMiLCIkcGFyZW50IiwiJHJvb3QiLCIkZW1pdCIsIiRvcHRpb25zIiwiJGZvcmNlVXBkYXRlIiwiJG5leHRUaWNrIiwibmV4dFRpY2siLCIkd2F0Y2giLCJpbnN0YW5jZVdhdGNoIiwibm9ybWFsaXplZFByb3BzIiwicHVibGljR2V0dGVyIiwiY3NzTW9kdWxlIiwiX19jc3NNb2R1bGVzIiwiZGVzY3JpcHRvciIsInNldEN1cnJlbnRJbnN0YW5jZSIsIl9fc3NySW5saW5lUmVuZGVyIiwic3NyUmVuZGVyIiwicHJveHlSZWZzIiwic2tpcE9wdGlvbnMiLCJnZXR0ZXJPck9wdGlvbnMiLCJkZWJ1Z09wdGlvbnMiLCJzZXR0ZXIiLCJvbmx5R2V0dGVyIiwiQ29tcHV0ZWRSZWZJbXBsIiwiY29tcHV0ZWQkMSIsImRvYyIsImRvY3VtZW50IiwidGVtcGxhdGVDb250YWluZXIiLCJub2RlT3BzIiwiaW5zZXJ0QmVmb3JlIiwicmVtb3ZlQ2hpbGQiLCJ0YWciLCJjcmVhdGVFbGVtZW50TlMiLCJtdWx0aXBsZSIsInNldEF0dHJpYnV0ZSIsImNyZWF0ZVRleHROb2RlIiwibm9kZSIsIm5vZGVWYWx1ZSIsInRleHRDb250ZW50IiwicXVlcnlTZWxlY3RvciIsInNlbGVjdG9yMiIsImNvbnRlbnQiLCJiZWZvcmUiLCJwcmV2aW91c1NpYmxpbmciLCJsYXN0Q2hpbGQiLCJpbm5lckhUTUwiLCJ0ZW1wbGF0ZSIsIndyYXBwZXIiLCJmaXJzdENoaWxkIiwiYXBwZW5kQ2hpbGQiLCJpbXBvcnRhbnRSRSIsInNldFN0eWxlIiwic2V0UHJvcGVydHkiLCJwcmVmaXhlZCIsInJhd05hbWUiLCJwcmVmaXhDYWNoZSIsInByZWZpeGVzIiwiYXV0b1ByZWZpeCIsInhsaW5rTlMiLCJfZ2V0Tm93IiwiRGF0ZSIsIm5vdyIsInNraXBUaW1lc3RhbXBDaGVjayIsImNyZWF0ZUV2ZW50IiwidGltZVN0YW1wIiwiZmZNYXRjaCIsIm5hdmlnYXRvciIsInVzZXJBZ2VudCIsImNhY2hlZE5vdyIsInJlc2V0IiwicHJldlZhbHVlIiwibmV4dFZhbHVlIiwiaW52b2tlcnMiLCJfdmVpIiwiZXhpc3RpbmdJbnZva2VyIiwib3B0aW9uc01vZGlmaWVyUkUiLCJwYXJzZU5hbWUiLCJhZGRFdmVudExpc3RlbmVyIiwiaW5pdGlhbFZhbHVlIiwiaW52b2tlciIsImF0dGFjaGVkIiwib3JpZ2luYWxTdG9wIiwic3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uIiwiX3N0b3BwZWQiLCJwYXRjaFN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbiIsImdldE5vdyIsImNyZWF0ZUludm9rZXIiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwibmF0aXZlT25SRSIsInJlbmRlcmVyT3B0aW9ucyIsInRyYW5zaXRpb25DbGFzc2VzIiwiX3Z0YyIsImpvaW4iLCJyZW1vdmVBdHRyaWJ1dGUiLCJjbGFzc05hbWUiLCJpc0Nzc1N0cmluZyIsImN1cnJlbnREaXNwbGF5IiwiZGlzcGxheSIsInRhZ05hbWUiLCJzaG91bGRTZXRBc1Byb3AiLCJpbmNsdWRlQm9vbGVhbkF0dHIiLCJfYSIsIl90cnVlVmFsdWUiLCJfZmFsc2VWYWx1ZSIsInJlbW92ZUF0dHJpYnV0ZU5TIiwic2V0QXR0cmlidXRlTlMiLCJpc0Jvb2xlYW4iLCJjcmVhdGVSZW5kZXJlciIsImNvbnRhaW5lck9yU2VsZWN0b3IiLCJub3JtYWxpemVDb250YWluZXIiLCJTVkdFbGVtZW50IiwiRWxlbWVudCIsImNvbnNvbGUiLCJhc3NlcnQiLCJjb25kaXRpb24iLCJtc2ciLCJsb2ciLCJFcnJvciIsInN5bWJvbHMiLCJwYXJlbnRJRCIsInBvdyIsImZsb29yIiwicmFuZG9tIiwicmFuZG9tSUQiLCJzZWxlY3Rpb24yIiwiZ2V0U2VsZWN0aW9uIiwiU2VsZWN0aW9uIiwiaXNDb2xsYXBzZWQiLCJhbmNob3JOb2RlIiwib2Zmc2V0IiwiYW5jaG9yT2Zmc2V0Iiwic3RhcnQiLCJiYWNrd2FyZHMiLCJjb2xsYXBzZWQiLCJzZWxlY3Rpb24iLCJmb2N1c05vZGUiLCJmb2N1c09mZnNldCIsInBhcmVudE5vZGVzIiwiYm9keSIsImNoaWxkTm9kZSIsImNoaWxkTm9kZXMiLCJpc0RPTVNlbGVjdGlvbkJhY2t3YXJkcyIsInJlc29sdmVBdHRycyIsIm5vZGVUeXBlIiwiTm9kZSIsIlRFWFRfTk9ERSIsIkVMRU1FTlRfTk9ERSIsIm5vZGVOYW1lIiwiYXR0ciIsImF0dHJpYnV0ZXMiLCJwb2ludGVyIiwiY29udGFpbmVyTm9kZSIsInBhcmFncmFwaElEIiwic3BhbklEIiwic3RhcnROb2RlIiwidGV4dE5vZGUiLCJkYXRhUG9pbnRlckRPTU5vZGUiLCJlbmROb2RlIiwiZW1wdHkiLCJyYW5nZSIsIlJhbmdlIiwic2V0U3RhcnQiLCJzZXRFbmQiLCJjb2xsYXBzZSIsImFkZFJhbmdlIiwicGFyYWdyYXBoIiwic3BhbnMiLCJuZXdJRCIsImZvcm1hdCIsIm5ld1NwYW4iLCJzcGFuIiwibmV3aWQiLCJzcGxpdFRpbWUiLCJsZWZ0Iiwic3Vic3RyIiwicmlnaHQiLCJ0b3RhbCIsImR1cmF0aW9uIiwidGltZSIsImdyb3VwIiwibm9ybUluZGV4IiwicGFyYWdyYXBocyIsInBhcmFncmFwaEluZGV4IiwicGFyYWdyYXBoMiIsInNwYW5JbmRleCIsInBhcmFncmFwaFNwYW5zIiwic3BhbjIiLCJzcGFuQXR0cnMiLCJwYXJhZ3JhcGhBdHRycyIsInNwYW5Ob2RlIiwicGFyYWdyYXBoTm9kZSIsImlucHV0Tm9kZSIsImdldERPTUVsZW1lbnREYXRhQXR0cmlidXRlcyIsIm5vZGUyIiwiZGF0YURPTU5vZGVzQXROb2RlIiwiaWRUb0luZGV4IiwibGVmdFNwYW5JRCIsImxlZnRQYXJhZ3JhcGhJRCIsInRleHRDb25lbnQiLCJkYXRhUG9pbnRlckZyb21ET01Qb2ludGVyIiwiZGF0YUF0SW5kZXgiLCJkYXRhUG9pbnRlciIsIlNwbGljZU1vZGUiLCJmcmVlemUiLCJSZW1vdmUiLCJJblBsYWNlIiwiQ29weSIsInN0YXJ0SW5kZXgiLCJzdGFydE9mZnNldCIsImVuZEluZGV4IiwiZW5kT2Zmc2V0IiwibW9kZSIsImVuZFNwYW5MZW5ndGgiLCJyZW1vdmVkU3BhblRleHQiLCJzdWJzdHJpbmciLCJyZW1vdmVkU3BhbnMiLCJjb3B5U3BhbiIsInNwbGl0SW5kZXgiLCJzcGxpdE9mZnNldCIsInNwbGl0U3BhbiIsImxlZnQyIiwicmlnaHQyIiwibWlkMiIsIm1pZHJpZ2h0IiwibWlkIiwiY29waWVkU3BhbnMiLCJzcGxpY2VTdGFydCIsInNwbGljZUVuZCIsInNsaWNlZFNwYW5zIiwicmVtb3ZlZCIsInN0YXJ0UGFyYWdyYXBoIiwic3BsaWNlU3BhbnMiLCJwYXJ0aWFsIiwibGFzdCIsIm5ld0RhdGEiLCJuZXdQYXJhZ3JhcGhzIiwibGFzdFBhcmFncmFwaDIiLCJuZXdTcGFuczIiLCJpbnNlcnRlZFN0YXJ0MiIsImluc2VydGVkRW5kMiIsImxhc3RQYXJhZ3JhcGgiLCJuZXdQYXJhZ3JhcGgiLCJpbnNlcnRlZFN0YXJ0IiwiaW5zZXJ0ZWRFbmQiLCJyaWdodFNwYW5zIiwic291cmNlU3BhbnMiLCJzb3VyY2VTcGFuIiwiZm91bmQiLCJzdGFydElEIiwiZW5kSUQiLCJzdGFydGVkIiwibW9kZWxWYWx1ZSIsImVkaXRhYmxlIiwic2hvd0NvbmZpZGVuY2UiLCJkZCIsImZ1bmMiLCJ3YWl0IiwidGltZW91dDIiLCJkZWJvdW5jZWQiLCJjYWxsTm93Iiwic2V0VGltZW91dCIsImFwcGx5Vmlld0NoYW5nZXNOb3ciLCJhcHBseVZpZXdDaGFuZ2VzIiwiZGVidWciLCJzYXZlIiwiZG93bmxvYWQiLCJmaWxlbmFtZSIsImVsZW1lbnQiLCJlbmNvZGVVUklDb21wb25lbnQiLCJjbGljayIsImFzSFRNTCIsInNlbnRlbmNlIiwiYm9sZCIsIml0YWxpYyIsInVuZGVybGluZSIsInN1YnNjcmlwdCIsInN1cGVyc2NyaXB0IiwiYnVsbGV0IiwiZXhwb3J0V29yZCIsImh0bWwiLCJzcGFuU2VsZWN0ZWQiLCJzZWxlY3RTdGFydCIsInNlbGVjdEVuZCIsIm5vcm1hbGl6ZWRET01TZWxlY3Rpb24iLCJzdGFydDMiLCJlbmQyIiwiZ2V0U3BhblNlbGVjdGlvbiIsInBhcmFncmFwaFNwYW5JdGVyYXRvciIsImRhdGFJdGVyYXRvciIsInRvZ2dsZVN0eWxlWCIsIm5vZm9jdXMiLCJvZmZzZXRMZWZ0IiwibGVmdFNwYW5JbmRleCIsIm9mZnNldFJpZ2h0IiwicmlnaHRTcGFuSW5kZXgiLCJyaWdodFNwYW5JRCIsInRvZ2dsZVN0eWxlIiwiZm9jdXMiLCJkYXRhU3BsaWNlIiwibmFtZTIiLCJ2YWx1ZTIiLCJ0b2dnbGVCdWxsZXQiLCJzcGFuU2VsZWN0aW9uIiwibWFwQ29udGFpbmVyT2Zmc2V0UG9pbnRlclRvRGF0YSIsInBhcnNlRE9NIiwicmVzdG9yZVNlbGVjdGlvbiIsInBhcnNlZCIsInJvb3ROb2RlIiwiYXR0clZhbHVlIiwidHJhbnNmb3JtIiwibGFzdFBsYWludGV4dFBhcmEiLCJwcmVwZW5kVGV4dCIsImlkMyIsImlubmVyVGV4dCIsImNvbmZpZGVuY2UiLCJzb3VyY2VQYXJhZ3JhcGhzIiwic291cmNlUGFyYWdyYXBoIiwiZGF0YU1lcmdlUGFyYWdyYXBocyIsIm9uSW5wdXQiLCJ2bSIsImluZm8iLCJtZXRhS2V5IiwiY3RybEtleSIsInNoaWZ0S2V5IiwiYWx0S2V5IiwiY29kZSIsInN0b3BQcm9wYWdhdGlvbiIsInByZXZlbnREZWZhdWx0IiwiZGF0YVBvaW50ZXJOZXh0Iiwic2VsZWN0aW9uMyIsInN0YXJ0T2ZQYXJhZ3JhcGgiLCJkYXRhMiIsInBwIiwiZGF0YVBvaW50ZXJQcmV2Iiwic3RhcnRQYXJhZ3JhcGhTcGFucyIsImVuZE9mUGFyYWdyYXBoIiwic2VsZWN0ZWRTcGFucyIsImhpZ2hsaWdodGVkIiwib25EcmFnU3RhcnQiLCJvblBhc3RlIiwibmF0aXZlRGF0YSIsImNsaXBib2FyZERhdGEiLCJnZXREYXRhIiwiaHRtbERhdGEiLCJ0ZXh0RGF0YSIsInBhcnNlIiwiZGF0YUluc2VydCIsImltcGxlbWVudGF0aW9uIiwiY3JlYXRlSFRNTERvY3VtZW50IiwiY3NzUnVsZXMiLCJ1bmRlcmxpbmVDbGFzc2VzIiwicnVsZSIsInNlbGVjdG9yVGV4dCIsInNlYXJjaCIsInRleHREZWNvcmF0aW9uTGluZSIsInNlbGVjdG9ycyIsInBhcnRzIiwic2hpZnQiLCJzdGFjayIsImZtdCIsIm5vZGVGbXQiLCJjbHMiLCJjbGFzc0xpc3QiLCJwYXJzZVZhbmlsbGFET00iLCJzaGVldCIsImxpbmVzIiwibGluZSIsIm9uQ3V0Iiwib25Db3B5Iiwic2V0RGF0YSIsImNvbnRlbnRlZGl0YWJsZSIsInNwZWxsY2hlY2siLCJfY2FjaGUiLCJvbktleWRvd24iLCJvblNlbGVjdHN0YXJ0Iiwib25Nb3VzZXVwIiwib25EcmFnc3RhcnQiLCJfY3JlYXRlRWxlbWVudEJsb2NrIiwib25DbGljayIsIl9ub3JtYWxpemVTdHlsZSIsIm5vb3AiLCJEaXNwYXRjaCIsInR5cGVuYW1lcyIsInR5cGVzIiwiZGlzcGF0Y2giLCJ0eXBlbmFtZSIsIlQiLCJwYXJzZVR5cGVuYW1lcyIsImNvcHkiLCJ0aGF0IiwieGh0bWwiLCJzdmciLCJ4bGluayIsInhtbCIsInhtbG5zIiwicHJlZml4IiwibmFtZXNwYWNlcyIsInNwYWNlIiwibG9jYWwiLCJkb2N1bWVudDIiLCJvd25lckRvY3VtZW50IiwidXJpIiwibmFtZXNwYWNlVVJJIiwiZG9jdW1lbnRFbGVtZW50IiwiZnVsbG5hbWUiLCJuYW1lc3BhY2UiLCJjcmVhdG9yRml4ZWQiLCJjcmVhdG9ySW5oZXJpdCIsIm5vbmUiLCJ4IiwicXVlcnlTZWxlY3RvckFsbCIsIm1hdGNoZXMiLCJmaW5kIiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJkYXR1bTIiLCJfbmV4dCIsIl9wYXJlbnQiLCJfX2RhdGFfXyIsImV4aXQiLCJncm91cExlbmd0aCIsImRhdGFMZW5ndGgiLCJFbnRlck5vZGUiLCJrZXlWYWx1ZSIsIm5vZGVCeUtleVZhbHVlIiwia2V5VmFsdWVzIiwiTmFOIiwiZGVmYXVsdFZpZXciLCJyZW1vdmVQcm9wZXJ0eSIsInByaW9yaXR5IiwiZ2V0UHJvcGVydHlWYWx1ZSIsImdldENvbXB1dGVkU3R5bGUiLCJzdHJpbmciLCJDbGFzc0xpc3QiLCJfbm9kZSIsIl9uYW1lcyIsImNsYXNzQXJyYXkiLCJnZXRBdHRyaWJ1dGUiLCJuYW1lcyIsImNsYXNzZWRBZGQiLCJjbGFzc2VkUmVtb3ZlIiwiY2xvbmUiLCJfX29uIiwibGlzdGVuZXIiLCJjb250ZXh0TGlzdGVuZXIiLCJwYXJhbXMiLCJ3aW5kb3cyIiwiQ3VzdG9tRXZlbnQiLCJpbml0RXZlbnQiLCJidWJibGVzIiwiY2FuY2VsYWJsZSIsImRldGFpbCIsImRpc3BhdGNoRXZlbnQiLCJjb250YWlucyIsImdyb3VwcyIsInBhcmVudHMiLCJfZ3JvdXBzIiwiX3BhcmVudHMiLCJmYWN0b3J5IiwiZGVmaW5pdGlvbiIsInNlbGVjdCIsInNlbGVjdDIiLCJzZWxlY3RvciIsInN1Ymdyb3VwcyIsInN1Ym5vZGUiLCJzdWJncm91cCIsInNlbGVjdEFsbCIsImFycmF5IiwiYXJyYXlBbGwiLCJzZWxlY3RvckFsbCIsInNlbGVjdENoaWxkIiwiY2hpbGRGaXJzdCIsImNoaWxkRmluZCIsImNoaWxkTWF0Y2hlciIsInNlbGVjdENoaWxkcmVuIiwiY2hpbGRyZW5GaWx0ZXIiLCJtYXRjaGVyIiwiZGF0dW0iLCJiaW5kS2V5IiwiYmluZEluZGV4IiwiY29uc3RhbnQiLCJhcnJheWxpa2UiLCJlbnRlckdyb3VwIiwidXBkYXRlR3JvdXAiLCJleGl0R3JvdXAiLCJwcmV2aW91cyIsImkwIiwiaTEiLCJfZW50ZXIiLCJfZXhpdCIsInNwYXJzZSIsIm9uZW50ZXIiLCJvbnVwZGF0ZSIsIm9uZXhpdCIsImFwcGVuZCIsIm1lcmdlIiwib3JkZXIiLCJncm91cHMwIiwiZ3JvdXBzMSIsIm0wIiwibTEiLCJtZXJnZXMiLCJncm91cDAiLCJncm91cDEiLCJjb21wYXJlRG9jdW1lbnRQb3NpdGlvbiIsImNvbXBhcmUiLCJhc2NlbmRpbmciLCJzb3J0Z3JvdXBzIiwic29ydGdyb3VwIiwiY29tcGFyZU5vZGUiLCJub2RlcyIsInNpemUyIiwiZWFjaCIsImdldEF0dHJpYnV0ZU5TIiwiYXR0clJlbW92ZU5TIiwiYXR0clJlbW92ZSIsImF0dHJGdW5jdGlvbk5TIiwiYXR0ckZ1bmN0aW9uIiwiYXR0ckNvbnN0YW50TlMiLCJhdHRyQ29uc3RhbnQiLCJzdHlsZVJlbW92ZSIsInN0eWxlRnVuY3Rpb24iLCJzdHlsZUNvbnN0YW50Iiwic3R5bGVWYWx1ZSIsInByb3BlcnR5IiwicHJvcGVydHlSZW1vdmUiLCJwcm9wZXJ0eUZ1bmN0aW9uIiwicHJvcGVydHlDb25zdGFudCIsImNsYXNzZWQiLCJjbGFzc2VkRnVuY3Rpb24iLCJjbGFzc2VkVHJ1ZSIsImNsYXNzZWRGYWxzZSIsInRleHRSZW1vdmUiLCJ0ZXh0RnVuY3Rpb24iLCJ0ZXh0Q29uc3RhbnQiLCJodG1sUmVtb3ZlIiwiaHRtbEZ1bmN0aW9uIiwiaHRtbENvbnN0YW50IiwicmFpc2UiLCJsb3dlciIsImNyZWF0ZTIiLCJjcmVhdG9yIiwiY29uc3RhbnROdWxsIiwic2VsZWN0aW9uX2Nsb25lRGVlcCIsInNlbGVjdGlvbl9jbG9uZVNoYWxsb3ciLCJvbkFkZCIsIm9uUmVtb3ZlIiwiZGlzcGF0Y2hGdW5jdGlvbiIsImRpc3BhdGNoQ29uc3RhbnQiLCJicmlnaHRlciIsInJlSSIsInJlTiIsInJlUCIsInJlSGV4IiwicmVSZ2JJbnRlZ2VyIiwiUmVnRXhwIiwicmVSZ2JQZXJjZW50IiwicmVSZ2JhSW50ZWdlciIsInJlUmdiYVBlcmNlbnQiLCJyZUhzbFBlcmNlbnQiLCJyZUhzbGFQZXJjZW50IiwibmFtZWQiLCJhbGljZWJsdWUiLCJhbnRpcXVld2hpdGUiLCJhcXVhIiwiYXF1YW1hcmluZSIsImF6dXJlIiwiYmVpZ2UiLCJiaXNxdWUiLCJibGFjayIsImJsYW5jaGVkYWxtb25kIiwiYmx1ZSIsImJsdWV2aW9sZXQiLCJicm93biIsImJ1cmx5d29vZCIsImNhZGV0Ymx1ZSIsImNoYXJ0cmV1c2UiLCJjaG9jb2xhdGUiLCJjb3JhbCIsImNvcm5mbG93ZXJibHVlIiwiY29ybnNpbGsiLCJjcmltc29uIiwiY3lhbiIsImRhcmtibHVlIiwiZGFya2N5YW4iLCJkYXJrZ29sZGVucm9kIiwiZGFya2dyYXkiLCJkYXJrZ3JlZW4iLCJkYXJrZ3JleSIsImRhcmtraGFraSIsImRhcmttYWdlbnRhIiwiZGFya29saXZlZ3JlZW4iLCJkYXJrb3JhbmdlIiwiZGFya29yY2hpZCIsImRhcmtyZWQiLCJkYXJrc2FsbW9uIiwiZGFya3NlYWdyZWVuIiwiZGFya3NsYXRlYmx1ZSIsImRhcmtzbGF0ZWdyYXkiLCJkYXJrc2xhdGVncmV5IiwiZGFya3R1cnF1b2lzZSIsImRhcmt2aW9sZXQiLCJkZWVwcGluayIsImRlZXBza3libHVlIiwiZGltZ3JheSIsImRpbWdyZXkiLCJkb2RnZXJibHVlIiwiZmlyZWJyaWNrIiwiZmxvcmFsd2hpdGUiLCJmb3Jlc3RncmVlbiIsImZ1Y2hzaWEiLCJnYWluc2Jvcm8iLCJnaG9zdHdoaXRlIiwiZ29sZCIsImdvbGRlbnJvZCIsImdyYXkiLCJncmVlbiIsImdyZWVueWVsbG93IiwiZ3JleSIsImhvbmV5ZGV3IiwiaG90cGluayIsImluZGlhbnJlZCIsImluZGlnbyIsIml2b3J5Iiwia2hha2kiLCJsYXZlbmRlciIsImxhdmVuZGVyYmx1c2giLCJsYXduZ3JlZW4iLCJsZW1vbmNoaWZmb24iLCJsaWdodGJsdWUiLCJsaWdodGNvcmFsIiwibGlnaHRjeWFuIiwibGlnaHRnb2xkZW5yb2R5ZWxsb3ciLCJsaWdodGdyYXkiLCJsaWdodGdyZWVuIiwibGlnaHRncmV5IiwibGlnaHRwaW5rIiwibGlnaHRzYWxtb24iLCJsaWdodHNlYWdyZWVuIiwibGlnaHRza3libHVlIiwibGlnaHRzbGF0ZWdyYXkiLCJsaWdodHNsYXRlZ3JleSIsImxpZ2h0c3RlZWxibHVlIiwibGlnaHR5ZWxsb3ciLCJsaW1lIiwibGltZWdyZWVuIiwibGluZW4iLCJtYWdlbnRhIiwibWFyb29uIiwibWVkaXVtYXF1YW1hcmluZSIsIm1lZGl1bWJsdWUiLCJtZWRpdW1vcmNoaWQiLCJtZWRpdW1wdXJwbGUiLCJtZWRpdW1zZWFncmVlbiIsIm1lZGl1bXNsYXRlYmx1ZSIsIm1lZGl1bXNwcmluZ2dyZWVuIiwibWVkaXVtdHVycXVvaXNlIiwibWVkaXVtdmlvbGV0cmVkIiwibWlkbmlnaHRibHVlIiwibWludGNyZWFtIiwibWlzdHlyb3NlIiwibW9jY2FzaW4iLCJuYXZham93aGl0ZSIsIm5hdnkiLCJvbGRsYWNlIiwib2xpdmUiLCJvbGl2ZWRyYWIiLCJvcmFuZ2UiLCJvcmFuZ2VyZWQiLCJvcmNoaWQiLCJwYWxlZ29sZGVucm9kIiwicGFsZWdyZWVuIiwicGFsZXR1cnF1b2lzZSIsInBhbGV2aW9sZXRyZWQiLCJwYXBheWF3aGlwIiwicGVhY2hwdWZmIiwicGVydSIsInBpbmsiLCJwbHVtIiwicG93ZGVyYmx1ZSIsInB1cnBsZSIsInJlYmVjY2FwdXJwbGUiLCJyZWQiLCJyb3N5YnJvd24iLCJyb3lhbGJsdWUiLCJzYWRkbGVicm93biIsInNhbG1vbiIsInNhbmR5YnJvd24iLCJzZWFncmVlbiIsInNlYXNoZWxsIiwic2llbm5hIiwic2lsdmVyIiwic2t5Ymx1ZSIsInNsYXRlYmx1ZSIsInNsYXRlZ3JheSIsInNsYXRlZ3JleSIsInNub3ciLCJzcHJpbmdncmVlbiIsInN0ZWVsYmx1ZSIsInRhbiIsInRlYWwiLCJ0aGlzdGxlIiwidG9tYXRvIiwidHVycXVvaXNlIiwidmlvbGV0Iiwid2hlYXQiLCJ3aGl0ZSIsIndoaXRlc21va2UiLCJ5ZWxsb3ciLCJ5ZWxsb3dncmVlbiIsInJnYiIsImZvcm1hdEhleCIsImZvcm1hdFJnYiIsImV4ZWMiLCJyZ2JuIiwiUmdiIiwicmdiYSIsImhzbGEiLCJnIiwiQ29sb3IiLCJjb2xvciIsIm9wYWNpdHkiLCJyZ2JDb252ZXJ0IiwiaGV4IiwibWF4Iiwicm91bmQiLCJIc2wiLCJtMiIsImRlZmluZSIsImNoYW5uZWxzIiwiZGlzcGxheWFibGUiLCJjb2xvcl9mb3JtYXRIZXgiLCJmb3JtYXRIc2wiLCJoc2xDb252ZXJ0IiwiY29sb3JfZm9ybWF0UmdiIiwiZGFya2VyIiwicmdiX2Zvcm1hdEhleCIsInJnYl9mb3JtYXRSZ2IiLCJoc2wycmdiIiwieSIsIm5vZ2FtbWEiLCJleHBvbmVudGlhbCIsImQiLCJsaW5lYXIiLCJjb2xvcjIiLCJnYW1tYSIsImNvbG9yUmdiIiwicmdiR2FtbWEiLCJyZUEiLCJyZUIiLCJhbSIsImJzIiwiYmkiLCJsYXN0SW5kZXgiLCJxIiwib25lIiwiemVybyIsImkyIiwic3ZnTm9kZSIsImRlZ3JlZXMiLCJQSSIsImlkZW50aXR5IiwidHJhbnNsYXRlWCIsInRyYW5zbGF0ZVkiLCJyb3RhdGUiLCJza2V3WCIsInNjYWxlWCIsInNjYWxlWSIsInNxcnQiLCJhdGFuMiIsImF0YW4iLCJweENvbW1hIiwicHhQYXJlbiIsImRlZ1BhcmVuIiwieGEiLCJ5YSIsInhiIiwieWIiLCJ0YXNrSGVhZCIsInRhc2tUYWlsIiwiaW50ZXJwb2xhdGVUcmFuc2Zvcm1Dc3MiLCJpbnRlcnBvbGF0ZVRyYW5zZm9ybSIsIkRPTU1hdHJpeCIsIldlYktpdENTU01hdHJpeCIsImlzSWRlbnRpdHkiLCJkZWNvbXBvc2UiLCJpbnRlcnBvbGF0ZVRyYW5zZm9ybVN2ZyIsImJhc2VWYWwiLCJjb25zb2xpZGF0ZSIsIm1hdHJpeCIsImZyYW1lIiwidGltZW91dCIsImludGVydmFsIiwiY2xvY2tMYXN0IiwiY2xvY2tOb3ciLCJjbG9ja1NrZXciLCJjbG9jayIsInNldEZyYW1lIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwiY2xlYXJOb3ciLCJfY2FsbCIsIl90aW1lIiwiZGVsYXkiLCJUaW1lciIsInJlc3RhcnQiLCJ0MCIsInQyIiwidDEiLCJub3cyIiwiY2xlYXJUaW1lb3V0Iiwid2FrZSIsImNsZWFySW50ZXJ2YWwiLCJzZXRJbnRlcnZhbCIsInBva2UiLCJlbGFwc2VkIiwidGltZXIiLCJUeXBlRXJyb3IiLCJlbXB0eU9uIiwiZW1wdHlUd2VlbiIsInRpbWluZyIsInNjaGVkdWxlcyIsIl9fdHJhbnNpdGlvbiIsInR3ZWVuIiwic3RhdGUiLCJ0aWNrIiwiZWFzZSIsInNjaGVkdWxlMiIsInR3ZWVuMCIsInR3ZWVuMSIsIl9pZCIsImludGVycG9sYXRlTnVtYmVyIiwiaW50ZXJwb2xhdGVSZ2IiLCJpbnRlcnBvbGF0ZVN0cmluZyIsImludGVycG9sYXRlMiIsInZhbHVlMSIsInN0cmluZzAwIiwiaW50ZXJwb2xhdGUwIiwic3RyaW5nMSIsInN0cmluZzAiLCJzdHJpbmcxMCIsImF0dHJJbnRlcnBvbGF0ZU5TIiwiYXR0ckludGVycG9sYXRlIiwib24wIiwib24xIiwic2l0IiwiZXZlcnkiLCJpbml0Iiwic3R5bGVJbnRlcnBvbGF0ZSIsInRleHRJbnRlcnBvbGF0ZSIsIl9uYW1lIiwic2VsZWN0aW9uX3Byb3RvdHlwZSIsIlRyYW5zaXRpb24iLCJpbmhlcml0MiIsImlkMCIsImlkMSIsIm5ld0lkIiwib25GdW5jdGlvbiIsImludGVycG9sYXRlIiwiYXR0clR3ZWVuIiwidHdlZW5WYWx1ZSIsImF0dHJUd2Vlbk5TIiwic3R5bGVUd2VlbiIsInN0eWxlTnVsbCIsImxpc3RlbmVyMCIsInN0eWxlTWF5YmVSZW1vdmUiLCJ0ZXh0VHdlZW4iLCJ0d2VlblJlbW92ZSIsInR3ZWVuRnVuY3Rpb24iLCJkZWxheUZ1bmN0aW9uIiwiZGVsYXlDb25zdGFudCIsImR1cmF0aW9uRnVuY3Rpb24iLCJkdXJhdGlvbkNvbnN0YW50IiwiZWFzZUNvbnN0YW50IiwiZWFzZVZhcnlpbmciLCJyZXNvbHZlMiIsInJlamVjdCIsImNhbmNlbCIsImludGVycnVwdCIsImRlZmF1bHRUaW1pbmciLCJlbXB0eTIiLCJpbmhlcml0IiwiSW50MTZBcnJheSIsIkludDMyQXJyYXkiLCJ3YXZlZm9ybSIsInJlc2l6ZUNoZWNrSW50ZXJ2YWwiLCJjdXJyZW50V2lkdGgiLCJjdXJyZW50SGVpZ2h0IiwiY2xpZW50V2lkdGgiLCJjbGllbnRIZWlnaHQiLCJkcmF3IiwiRmxvYXQzMkFycmF5Iiwib2Zmc2V0WCIsIndpZHRoIiwiaGVpZ2h0Iiwic3VtbWFyeSIsInBpeGVscyIsInBpeGVsTGVuZ3RoIiwidmFscyIsInNhbXBsZVNpemUiLCJwb3NTdW0iLCJuZWdTdW0iLCJzdW1tYXJpemVGYXN0ZXIiLCJtZWFuIiwibXVsdGlwbGllciIsImNsb3NlIiwiQXVkaW9Db250ZXh0Iiwib25zdGF0ZWNoYW5nZSIsInJlc3VtZSIsImRlY29kZXIiLCJhcnJheUJ1ZmZlciIsImJ1ZmZlciIsImRlY29kZUF1ZGlvRmlsZUJ1ZmZlciIsImJ1ZmZlckRhdGEiLCJGbG9hdDMyQXJyYXlUb0ludDE2QXJyYXkiLCJzYW1wbGVSYXRlIiwibnVtYmVyT2ZDaGFubmVscyIsInVybCIsImZldGNoQXVkaW9GaWxlQW5kRGVjb2RlIiwicmVzcG9uc2UiLCJmZXRjaCIsImRlY29kZUF1ZGlvRGF0YSIsImZsb2F0QXJyYXkiLCJzYW1wbGUiLCJjaGFubmVsIiwiZ2V0Q2hhbm5lbERhdGEiLCJUcmFuc2NyaXB0RWRpdG9yIiwiV2F2ZWZvcm0iLCJ0cmFuc2NyaXB0IiwicHJldmlld1ZpZGVvIiwib25TYXZlIiwiYXN5bmMiLCJwb3NpdGlvbiIsInNlbGVjdGVkIiwicGxheWluZyIsImxvYWRlZCIsImlzVmlkZW8iLCJfdXJsIiwiX2R1cmF0aW9uIiwiX3dhdmVmb3JtIiwicGVuZGluZ193YXZlZm9ybSIsInBlbmRpbmdfZHVyYXRpb24iLCJ2aWRlb19kdXJhdGlvbiIsInNhdmluZyIsImxhc3RTYXZlZFZlcnNpb24iLCJhdXRvU2F2ZSIsImF1dG9TYXZlSW50ZXJ2YWwiLCJkZWNvZGVyU3VzcGVuZGVkIiwiZGVjb2RpbmdBdWRpbyIsInNhdmVBdXRvIiwib25HbG9iYWxLZXlkb3duIiwiQXVkaW9GaWxlRGVjb2RlciIsInN1c3BlbmRlZCIsImRlY29kZUF1ZGlvV2F2ZWZvcm0iLCJGaWxlIiwiZGVjb2RlQXVkaW9GaWxlRGF0YSIsInN5bmNlZCIsIm1zVG9UaW1lIiwibXMiLCJob3VycyIsInoiLCJfbXMiLCJzZWNzIiwibWlucyIsImhycyIsInBhZCIsInRvZ2dsZUF1dG9TYXZlIiwidmVyc2lvbjIiLCJmZXRjaEFuZERlY29kZUF1ZGlvRmlsZSIsIndhdmVmb3JtTG9hZGluZyIsIm9uUGxheSIsImFuaW1hdGlvbkZyYW1lSUQiLCJ1cGRhdGVQb3NpdGlvbiIsIm9uUGF1c2UiLCJvbkVuZGVkIiwidGltZXN0YW1wIiwidmlkZW8iLCJjdXJyZW50VGltZSIsImR1cmF0aW9uQ2hhbmdlZCIsInZpZGVvV2lkdGgiLCJ2aWRlb0hlaWdodCIsIm9uRW1wdHkiLCJwYXVzZWQiLCJwbGF5IiwicGF1c2UiLCJ0cmFuc2NyaXB0VXBkYXRlZCIsInNldFBvc2l0aW9uIiwidGltZVVwZGF0ZSIsInRvZ2dsZVNob3dDb25maWRlbmNlIiwiRWRpdG9yIiwicmV2b2tlT2JqZWN0VVJMIiwiYXVkaW8iLCJmaWxlIiwiQXJyYXlCdWZmZXIiLCJlZGl0b3IiLCJsb2FkIiwiVVJMIiwiY3JlYXRlT2JqZWN0VVJMIiwiQmxvYiIsImF1ZGlvRGF0YSIsImpzb24iLCJFZGl0b3JXaXRoTWVkaWFMb2FkZXIiXSwibWFwcGluZ3MiOiJBQU9BLFdBQWlCQSxFQUFLQyxTQUNaQyxFQUFNQyxPQUFPQyxPQUFPLE1BQ3BCQyxFQUFPTCxFQUFJTSxNQUFNLGFBQ2RDLEVBQUksRUFBR0EsRUFBSUYsRUFBS0csT0FBUUQsTUFDekJGLEVBQUtFLEtBQU0sU0FFWk4sT0FBNEJDLEVBQUlPLEVBQUlDLG9CQUEwQlIsRUFBSU8sR0E0RjdFLE1BQ01FLElBRHNCLCtFQWE1QixXQUE0QkMsV0FDZkEsR0FBbUIsS0FBVkEsRUFnR3RCLFdBQXdCQSxNQUNoQkMsRUFBUUQsR0FBUSxPQUNWRSxFQUFNLFdBQ0hQLEVBQUksRUFBR0EsRUFBSUssRUFBTUosT0FBUUQsSUFBSyxPQUM3QlEsRUFBT0gsRUFBTUwsR0FDYlMsRUFBYUMsRUFBU0YsR0FDdEJHLEVBQWlCSCxHQUNqQkksRUFBZUosTUFDakJDLFlBQ1dJLEtBQU9KLElBQ1ZJLEdBQU9KLEVBQVdJLFVBSTNCTixTQUVGRyxFQUFTTCxJQUdUUyxFQUFTVCxHQUZQQSxTQU1mLE1BQU1VLEVBQWtCLGdCQUNsQkMsRUFBc0IsUUFDNUIsV0FBMEJDLFNBQ2hCQyxFQUFNLFlBQ0puQixNQUFNZ0IsR0FBaUJJLGdCQUN2QlgsRUFBTSxPQUNBWSxFQUFNWixFQUFLVCxNQUFNaUIsS0FDbkJmLE9BQVMsTUFBVW1CLEVBQUksR0FBR0MsUUFBVUQsRUFBSSxHQUFHQyxZQUdoREgsRUFrQlgsV0FBd0JiLE9BQ2hCRSxFQUFNLE1BQ05HLEVBQVNMLEtBQ0hBLFVBRURDLEVBQVFELFdBQ0pMLEVBQUksRUFBR0EsRUFBSUssRUFBTUosT0FBUUQsSUFBSyxPQUM3QlMsRUFB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
