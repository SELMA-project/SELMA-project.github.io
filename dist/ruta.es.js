function t(t,e){const n=Object.create(null),r=t.split(",");for(let o=0;o<r.length;o++)n[r[o]]=!0;return e?t=>!!n[t.toLowerCase()]:t=>!!n[t]}const e=t("itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly");function n(t){return!!t||""===t}function r(t){if(x(t)){const e={};for(let n=0;n<t.length;n++){const o=t[n],i=S(o)?s(o):r(o);if(i)for(const t in i)e[t]=i[t]}return e}return S(t)||N(t)?t:void 0}const o=/;(?![^(]*\))/g,i=/:(.+)/;function s(t){const e={};return t.split(o).forEach((t=>{if(t){const n=t.split(i);n.length>1&&(e[n[0].trim()]=n[1].trim())}})),e}function a(t){let e="";if(S(t))e=t;else if(x(t))for(let n=0;n<t.length;n++){const r=a(t[n]);r&&(e+=r+" ")}else if(N(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const l=t=>S(t)?t:null==t?"":x(t)||N(t)&&(t.toString===A||!k(t.toString))?JSON.stringify(t,c,2):String(t),c=(t,e)=>e&&e.__v_isRef?c(t,e.value):w(e)?{[`Map(${e.size})`]:[...e.entries()].reduce(((t,[e,n])=>(t[`${e} =>`]=n,t)),{})}:I(e)?{[`Set(${e.size})`]:[...e.values()]}:!N(e)||x(e)||O(e)?e:String(e),u={},f=[],d=()=>{},p=()=>!1,h=/^on[^a-z]/,g=t=>h.test(t),v=t=>t.startsWith("onUpdate:"),m=Object.assign,y=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},b=Object.prototype.hasOwnProperty,_=(t,e)=>b.call(t,e),x=Array.isArray,w=t=>"[object Map]"===E(t),I=t=>"[object Set]"===E(t),k=t=>"function"==typeof t,S=t=>"string"==typeof t,D=t=>"symbol"==typeof t,N=t=>null!==t&&"object"==typeof t,C=t=>N(t)&&k(t.then)&&k(t.catch),A=Object.prototype.toString,E=t=>A.call(t),O=t=>"[object Object]"===E(t),T=t=>S(t)&&"NaN"!==t&&"-"!==t[0]&&""+parseInt(t,10)===t,$=t(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),P=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},R=/-(\w)/g,M=P((t=>t.replace(R,((t,e)=>e?e.toUpperCase():"")))),V=/\B([A-Z])/g,j=P((t=>t.replace(V,"-$1").toLowerCase())),F=P((t=>t.charAt(0).toUpperCase()+t.slice(1))),L=P((t=>t?`on${F(t)}`:"")),U=(t,e)=>!Object.is(t,e),K=(t,e)=>{for(let n=0;n<t.length;n++)t[n](e)},B=(t,e,n)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:n})},W=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let H;let X;class q{constructor(t=!1){this.active=!0,this.effects=[],this.cleanups=[],!t&&X&&(this.parent=X,this.index=(X.scopes||(X.scopes=[])).push(this)-1)}run(t){if(this.active)try{return X=this,t()}finally{X=this.parent}}on(){X=this}off(){X=this.parent}stop(t){if(this.active){let e,n;for(e=0,n=this.effects.length;e<n;e++)this.effects[e].stop();for(e=0,n=this.cleanups.length;e<n;e++)this.cleanups[e]();if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].stop(!0);if(this.parent&&!t){const t=this.parent.scopes.pop();t&&t!==this&&(this.parent.scopes[this.index]=t,t.index=this.index)}this.active=!1}}}const z=t=>{const e=new Set(t);return e.w=0,e.n=0,e},Y=t=>(t.w&Q)>0,G=t=>(t.n&Q)>0,J=new WeakMap;let Z=0,Q=1;let tt;const et=Symbol(""),nt=Symbol("");class rt{constructor(t,e=null,n){this.fn=t,this.scheduler=e,this.active=!0,this.deps=[],this.parent=void 0,function(t,e=X){e&&e.active&&e.effects.push(t)}(this,n)}run(){if(!this.active)return this.fn();let t=tt,e=it;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=tt,tt=this,it=!0,Q=1<<++Z,Z<=30?(({deps:t})=>{if(t.length)for(let e=0;e<t.length;e++)t[e].w|=Q})(this):ot(this),this.fn()}finally{Z<=30&&(t=>{const{deps:e}=t;if(e.length){let n=0;for(let r=0;r<e.length;r++){const o=e[r];Y(o)&&!G(o)?o.delete(t):e[n++]=o,o.w&=~Q,o.n&=~Q}e.length=n}})(this),Q=1<<--Z,tt=this.parent,it=e,this.parent=void 0}}stop(){this.active&&(ot(this),this.onStop&&this.onStop(),this.active=!1)}}function ot(t){const{deps:e}=t;if(e.length){for(let n=0;n<e.length;n++)e[n].delete(t);e.length=0}}let it=!0;const st=[];function at(){st.push(it),it=!1}function lt(){const t=st.pop();it=void 0===t||t}function ct(t,e,n){if(it&&tt){let e=J.get(t);e||J.set(t,e=new Map);let r=e.get(n);r||e.set(n,r=z()),ut(r)}}function ut(t,e){let n=!1;Z<=30?G(t)||(t.n|=Q,n=!Y(t)):n=!t.has(tt),n&&(t.add(tt),tt.deps.push(t))}function ft(t,e,n,r,o,i){const s=J.get(t);if(!s)return;let a=[];if("clear"===e)a=[...s.values()];else if("length"===n&&x(t))s.forEach(((t,e)=>{("length"===e||e>=r)&&a.push(t)}));else switch(void 0!==n&&a.push(s.get(n)),e){case"add":x(t)?T(n)&&a.push(s.get("length")):(a.push(s.get(et)),w(t)&&a.push(s.get(nt)));break;case"delete":x(t)||(a.push(s.get(et)),w(t)&&a.push(s.get(nt)));break;case"set":w(t)&&a.push(s.get(et))}if(1===a.length)a[0]&&dt(a[0]);else{const t=[];for(const e of a)e&&t.push(...e);dt(z(t))}}function dt(t,e){for(const n of x(t)?t:[...t])(n!==tt||n.allowRecurse)&&(n.scheduler?n.scheduler():n.run())}const pt=t("__proto__,__v_isRef,__isVue"),ht=new Set(Object.getOwnPropertyNames(Symbol).map((t=>Symbol[t])).filter(D)),gt=_t(),vt=_t(!1,!0),mt=_t(!0),yt=bt();function bt(){const t={};return["includes","indexOf","lastIndexOf"].forEach((e=>{t[e]=function(...t){const n=oe(this);for(let e=0,o=this.length;e<o;e++)ct(n,0,e+"");const r=n[e](...t);return-1===r||!1===r?n[e](...t.map(oe)):r}})),["push","pop","shift","unshift","splice"].forEach((e=>{t[e]=function(...t){at();const n=oe(this)[e].apply(this,t);return lt(),n}})),t}function _t(t=!1,e=!1){return function(n,r,o){if("__v_isReactive"===r)return!t;if("__v_isReadonly"===r)return t;if("__v_isShallow"===r)return e;if("__v_raw"===r&&o===(t?e?Yt:zt:e?qt:Xt).get(n))return n;const i=x(n);if(!t&&i&&_(yt,r))return Reflect.get(yt,r,o);const s=Reflect.get(n,r,o);if(D(r)?ht.has(r):pt(r))return s;if(t||ct(n,0,r),e)return s;if(le(s)){return!i||!T(r)?s.value:s}return N(s)?t?Zt(s):Jt(s):s}}function xt(t=!1){return function(e,n,r,o){let i=e[n];if(ee(i)&&le(i)&&!le(r))return!1;if(!t&&!ee(r)&&(ne(r)||(r=oe(r),i=oe(i)),!x(e)&&le(i)&&!le(r)))return i.value=r,!0;const s=x(e)&&T(n)?Number(n)<e.length:_(e,n),a=Reflect.set(e,n,r,o);return e===oe(o)&&(s?U(r,i)&&ft(e,"set",n,r):ft(e,"add",n,r)),a}}const wt={get:gt,set:xt(),deleteProperty:function(t,e){const n=_(t,e);t[e];const r=Reflect.deleteProperty(t,e);return r&&n&&ft(t,"delete",e,void 0),r},has:function(t,e){const n=Reflect.has(t,e);return D(e)&&ht.has(e)||ct(t,0,e),n},ownKeys:function(t){return ct(t,0,x(t)?"length":et),Reflect.ownKeys(t)}},It={get:mt,set:(t,e)=>!0,deleteProperty:(t,e)=>!0},kt=m({},wt,{get:vt,set:xt(!0)}),St=t=>t,Dt=t=>Reflect.getPrototypeOf(t);function Nt(t,e,n=!1,r=!1){const o=oe(t=t.__v_raw),i=oe(e);e!==i&&!n&&ct(o,0,e),!n&&ct(o,0,i);const{has:s}=Dt(o),a=r?St:n?ae:se;return s.call(o,e)?a(t.get(e)):s.call(o,i)?a(t.get(i)):void(t!==o&&t.get(e))}function Ct(t,e=!1){const n=this.__v_raw,r=oe(n),o=oe(t);return t!==o&&!e&&ct(r,0,t),!e&&ct(r,0,o),t===o?n.has(t):n.has(t)||n.has(o)}function At(t,e=!1){return t=t.__v_raw,!e&&ct(oe(t),0,et),Reflect.get(t,"size",t)}function Et(t){t=oe(t);const e=oe(this);return Dt(e).has.call(e,t)||(e.add(t),ft(e,"add",t,t)),this}function Ot(t,e){e=oe(e);const n=oe(this),{has:r,get:o}=Dt(n);let i=r.call(n,t);i||(t=oe(t),i=r.call(n,t));const s=o.call(n,t);return n.set(t,e),i?U(e,s)&&ft(n,"set",t,e):ft(n,"add",t,e),this}function Tt(t){const e=oe(this),{has:n,get:r}=Dt(e);let o=n.call(e,t);o||(t=oe(t),o=n.call(e,t)),r&&r.call(e,t);const i=e.delete(t);return o&&ft(e,"delete",t,void 0),i}function $t(){const t=oe(this),e=0!==t.size,n=t.clear();return e&&ft(t,"clear",void 0,void 0),n}function Pt(t,e){return function(n,r){const o=this,i=o.__v_raw,s=oe(i),a=e?St:t?ae:se;return!t&&ct(s,0,et),i.forEach(((t,e)=>n.call(r,a(t),a(e),o)))}}function Rt(t,e,n){return function(...r){const o=this.__v_raw,i=oe(o),s=w(i),a="entries"===t||t===Symbol.iterator&&s,l="keys"===t&&s,c=o[t](...r),u=n?St:e?ae:se;return!e&&ct(i,0,l?nt:et),{next(){const{value:t,done:e}=c.next();return e?{value:t,done:e}:{value:a?[u(t[0]),u(t[1])]:u(t),done:e}},[Symbol.iterator](){return this}}}}function Mt(t){return function(...e){return"delete"!==t&&this}}function Vt(){const t={get(t){return Nt(this,t)},get size(){return At(this)},has:Ct,add:Et,set:Ot,delete:Tt,clear:$t,forEach:Pt(!1,!1)},e={get(t){return Nt(this,t,!1,!0)},get size(){return At(this)},has:Ct,add:Et,set:Ot,delete:Tt,clear:$t,forEach:Pt(!1,!0)},n={get(t){return Nt(this,t,!0)},get size(){return At(this,!0)},has(t){return Ct.call(this,t,!0)},add:Mt("add"),set:Mt("set"),delete:Mt("delete"),clear:Mt("clear"),forEach:Pt(!0,!1)},r={get(t){return Nt(this,t,!0,!0)},get size(){return At(this,!0)},has(t){return Ct.call(this,t,!0)},add:Mt("add"),set:Mt("set"),delete:Mt("delete"),clear:Mt("clear"),forEach:Pt(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach((o=>{t[o]=Rt(o,!1,!1),n[o]=Rt(o,!0,!1),e[o]=Rt(o,!1,!0),r[o]=Rt(o,!0,!0)})),[t,n,e,r]}const[jt,Ft,Lt,Ut]=Vt();function Kt(t,e){const n=e?t?Ut:Lt:t?Ft:jt;return(e,r,o)=>"__v_isReactive"===r?!t:"__v_isReadonly"===r?t:"__v_raw"===r?e:Reflect.get(_(n,r)&&r in e?n:e,r,o)}const Bt={get:Kt(!1,!1)},Wt={get:Kt(!1,!0)},Ht={get:Kt(!0,!1)},Xt=new WeakMap,qt=new WeakMap,zt=new WeakMap,Yt=new WeakMap;function Gt(t){return t.__v_skip||!Object.isExtensible(t)?0:function(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}((t=>E(t).slice(8,-1))(t))}function Jt(t){return ee(t)?t:Qt(t,!1,wt,Bt,Xt)}function Zt(t){return Qt(t,!0,It,Ht,zt)}function Qt(t,e,n,r,o){if(!N(t))return t;if(t.__v_raw&&(!e||!t.__v_isReactive))return t;const i=o.get(t);if(i)return i;const s=Gt(t);if(0===s)return t;const a=new Proxy(t,2===s?r:n);return o.set(t,a),a}function te(t){return ee(t)?te(t.__v_raw):!(!t||!t.__v_isReactive)}function ee(t){return!(!t||!t.__v_isReadonly)}function ne(t){return!(!t||!t.__v_isShallow)}function re(t){return te(t)||ee(t)}function oe(t){const e=t&&t.__v_raw;return e?oe(e):t}function ie(t){return B(t,"__v_skip",!0),t}const se=t=>N(t)?Jt(t):t,ae=t=>N(t)?Zt(t):t;function le(t){return!(!t||!0!==t.__v_isRef)}const ce={get:(t,e,n)=>{return le(r=Reflect.get(t,e,n))?r.value:r;var r},set:(t,e,n,r)=>{const o=t[e];return le(o)&&!le(n)?(o.value=n,!0):Reflect.set(t,e,n,r)}};function ue(t){return te(t)?t:new Proxy(t,ce)}class fe{constructor(t,e,n,r){this._setter=e,this.dep=void 0,this.__v_isRef=!0,this._dirty=!0,this.effect=new rt(t,(()=>{var t;this._dirty||(this._dirty=!0,(t=oe(t=this)).dep&&dt(t.dep))})),this.effect.computed=this,this.effect.active=this._cacheable=!r,this.__v_isReadonly=n}get value(){const t=oe(this);var e;return e=t,it&&tt&&ut((e=oe(e)).dep||(e.dep=z())),!t._dirty&&t._cacheable||(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}function de(t,e,n,r){let o;try{o=r?t(...r):t()}catch(i){he(i,e,n)}return o}function pe(t,e,n,r){if(k(t)){const o=de(t,e,n,r);return o&&C(o)&&o.catch((t=>{he(t,e,n)})),o}const o=[];for(let i=0;i<t.length;i++)o.push(pe(t[i],e,n,r));return o}function he(t,e,n,r=!0){e&&e.vnode;if(e){let r=e.parent;const o=e.proxy,i=n;for(;r;){const e=r.ec;if(e)for(let n=0;n<e.length;n++)if(!1===e[n](t,o,i))return;r=r.parent}const s=e.appContext.config.errorHandler;if(s)return void de(s,null,10,[t,o,i])}!function(t,e,n,r=!0){console.error(t)}(t,0,0,r)}Promise.resolve();let ge=!1,ve=!1;const me=[];let ye=0;const be=[];let _e=null,xe=0;const we=[];let Ie=null,ke=0;const Se=Promise.resolve();let De=null,Ne=null;function Ce(t){const e=De||Se;return t?e.then(this?t.bind(this):t):e}function Ae(t){me.length&&me.includes(t,ge&&t.allowRecurse?ye+1:ye)||t===Ne||(null==t.id?me.push(t):me.splice(function(t){let e=ye+1,n=me.length;for(;e<n;){const r=e+n>>>1;Pe(me[r])<t?e=r+1:n=r}return e}(t.id),0,t),Ee())}function Ee(){ge||ve||(ve=!0,De=Se.then(Re))}function Oe(t,e,n,r){x(t)?n.push(...t):e&&e.includes(t,t.allowRecurse?r+1:r)||n.push(t),Ee()}function Te(t,e=null){if(be.length){for(Ne=e,_e=[...new Set(be)],be.length=0,xe=0;xe<_e.length;xe++)_e[xe]();_e=null,xe=0,Ne=null,Te(t,e)}}function $e(t){if(we.length){const t=[...new Set(we)];if(we.length=0,Ie)return void Ie.push(...t);for(Ie=t,Ie.sort(((t,e)=>Pe(t)-Pe(e))),ke=0;ke<Ie.length;ke++)Ie[ke]();Ie=null,ke=0}}const Pe=t=>null==t.id?1/0:t.id;function Re(t){ve=!1,ge=!0,Te(t),me.sort(((t,e)=>Pe(t)-Pe(e)));try{for(ye=0;ye<me.length;ye++){const t=me[ye];t&&!1!==t.active&&de(t,null,14)}}finally{ye=0,me.length=0,$e(),ge=!1,De=null,(me.length||be.length||we.length)&&Re(t)}}function Me(t,e,...n){const r=t.vnode.props||u;let o=n;const i=e.startsWith("update:"),s=i&&e.slice(7);if(s&&s in r){const t=`${"modelValue"===s?"model":s}Modifiers`,{number:e,trim:i}=r[t]||u;i?o=n.map((t=>t.trim())):e&&(o=n.map(W))}let a,l=r[a=L(e)]||r[a=L(M(e))];!l&&i&&(l=r[a=L(j(e))]),l&&pe(l,t,6,o);const c=r[a+"Once"];if(c){if(t.emitted){if(t.emitted[a])return}else t.emitted={};t.emitted[a]=!0,pe(c,t,6,o)}}function Ve(t,e,n=!1){const r=e.emitsCache,o=r.get(t);if(void 0!==o)return o;const i=t.emits;let s={},a=!1;if(!k(t)){const r=t=>{const n=Ve(t,e,!0);n&&(a=!0,m(s,n))};!n&&e.mixins.length&&e.mixins.forEach(r),t.extends&&r(t.extends),t.mixins&&t.mixins.forEach(r)}return i||a?(x(i)?i.forEach((t=>s[t]=null)):m(s,i),r.set(t,s),s):(r.set(t,null),null)}function je(t,e){return!(!t||!g(e))&&(e=e.slice(2).replace(/Once$/,""),_(t,e[0].toLowerCase()+e.slice(1))||_(t,j(e))||_(t,e))}let Fe=null,Le=null;function Ue(t){const e=Fe;return Fe=t,Le=t&&t.type.__scopeId||null,e}function Ke(t){const{type:e,vnode:n,proxy:r,withProxy:o,props:i,propsOptions:[s],slots:a,attrs:l,emit:c,render:u,renderCache:f,data:d,setupState:p,ctx:h,inheritAttrs:g}=t;let m,y;const b=Ue(t);try{if(4&n.shapeFlag){const t=o||r;m=wr(u.call(t,t,f,i,p,d,h)),y=l}else{const t=e;0,m=wr(t.length>1?t(i,{attrs:l,slots:a,emit:c}):t(i,null)),y=e.props?l:Be(l)}}catch(x){or.length=0,he(x,t,1),m=yr(nr)}let _=m;if(y&&!1!==g){const t=Object.keys(y),{shapeFlag:e}=_;t.length&&7&e&&(s&&t.some(v)&&(y=We(y,s)),_=br(_,y))}return n.dirs&&(_.dirs=_.dirs?_.dirs.concat(n.dirs):n.dirs),n.transition&&(_.transition=n.transition),m=_,Ue(b),m}const Be=t=>{let e;for(const n in t)("class"===n||"style"===n||g(n))&&((e||(e={}))[n]=t[n]);return e},We=(t,e)=>{const n={};for(const r in t)v(r)&&r.slice(9)in e||(n[r]=t[r]);return n};function He(t,e,n){const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!0;for(let o=0;o<r.length;o++){const i=r[o];if(e[i]!==t[i]&&!je(n,i))return!0}return!1}function Xe(t,e,n=!1){const r=Pr||Fe;if(r){const o=null==r.parent?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides;if(o&&t in o)return o[t];if(arguments.length>1)return n&&k(e)?e.call(r.proxy):e}}const qe={};function ze(t,e,n){return Ye(t,e,n)}function Ye(t,e,{immediate:n,deep:r,flush:o,onTrack:i,onTrigger:s}=u){const a=Pr;let l,c,f=!1,p=!1;if(le(t)?(l=()=>t.value,f=ne(t)):te(t)?(l=()=>t,r=!0):x(t)?(p=!0,f=t.some(te),l=()=>t.map((t=>le(t)?t.value:te(t)?Ze(t):k(t)?de(t,a,2):void 0))):l=k(t)?e?()=>de(t,a,2):()=>{if(!a||!a.isUnmounted)return c&&c(),pe(t,a,3,[h])}:d,e&&r){const t=l;l=()=>Ze(t())}let h=t=>{c=b.onStop=()=>{de(t,a,4)}};if(jr)return h=d,e?n&&pe(e,a,3,[l(),p?[]:void 0,h]):l(),d;let g=p?[]:qe;const v=()=>{if(b.active)if(e){const t=b.run();(r||f||(p?t.some(((t,e)=>U(t,g[e]))):U(t,g)))&&(c&&c(),pe(e,a,3,[t,g===qe?void 0:g,h]),g=t)}else b.run()};let m;v.allowRecurse=!!e,m="sync"===o?v:"post"===o?()=>qn(v,a&&a.suspense):()=>{!a||a.isMounted?function(t){Oe(t,_e,be,xe)}(v):v()};const b=new rt(l,m);return e?n?v():g=b.run():"post"===o?qn(b.run.bind(b),a&&a.suspense):b.run(),()=>{b.stop(),a&&a.scope&&y(a.scope.effects,b)}}function Ge(t,e,n){const r=this.proxy,o=S(t)?t.includes(".")?Je(r,t):()=>r[t]:t.bind(r,r);let i;k(e)?i=e:(i=e.handler,n=e);const s=Pr;Rr(this);const a=Ye(o,i.bind(r),n);return s?Rr(s):Mr(),a}function Je(t,e){const n=e.split(".");return()=>{let e=t;for(let t=0;t<n.length&&e;t++)e=e[n[t]];return e}}function Ze(t,e){if(!N(t)||t.__v_skip)return t;if((e=e||new Set).has(t))return t;if(e.add(t),le(t))Ze(t.value,e);else if(x(t))for(let n=0;n<t.length;n++)Ze(t[n],e);else if(I(t)||w(t))t.forEach((t=>{Ze(t,e)}));else if(O(t))for(const n in t)Ze(t[n],e);return t}const Qe=t=>!!t.type.__asyncLoader,tn=t=>t.type.__isKeepAlive;function en(t,e){rn(t,"a",e)}function nn(t,e){rn(t,"da",e)}function rn(t,e,n=Pr){const r=t.__wdc||(t.__wdc=()=>{let e=n;for(;e;){if(e.isDeactivated)return;e=e.parent}return t()});if(sn(e,r,n),n){let t=n.parent;for(;t&&t.parent;)tn(t.parent.vnode)&&on(r,e,n,t),t=t.parent}}function on(t,e,n,r){const o=sn(e,t,r,!0);pn((()=>{y(r[e],o)}),n)}function sn(t,e,n=Pr,r=!1){if(n){const o=n[t]||(n[t]=[]),i=e.__weh||(e.__weh=(...r)=>{if(n.isUnmounted)return;at(),Rr(n);const o=pe(e,n,t,r);return Mr(),lt(),o});return r?o.unshift(i):o.push(i),i}}const an=t=>(e,n=Pr)=>(!jr||"sp"===t)&&sn(t,e,n),ln=an("bm"),cn=an("m"),un=an("bu"),fn=an("u"),dn=an("bum"),pn=an("um"),hn=an("sp"),gn=an("rtg"),vn=an("rtc");function mn(t,e=Pr){sn("ec",t,e)}let yn=!0;function bn(t){const e=wn(t),n=t.proxy,r=t.ctx;yn=!1,e.beforeCreate&&_n(e.beforeCreate,t,"bc");const{data:o,computed:i,methods:s,watch:a,provide:l,inject:c,created:u,beforeMount:f,mounted:p,beforeUpdate:h,updated:g,activated:v,deactivated:m,beforeDestroy:y,beforeUnmount:b,destroyed:_,unmounted:w,render:I,renderTracked:S,renderTriggered:D,errorCaptured:C,serverPrefetch:A,expose:E,inheritAttrs:O,components:T,directives:$,filters:P}=e;if(c&&function(t,e,n=d,r=!1){x(t)&&(t=Dn(t));for(const o in t){const n=t[o];let i;i=N(n)?"default"in n?Xe(n.from||o,n.default,!0):Xe(n.from||o):Xe(n),le(i)&&r?Object.defineProperty(e,o,{enumerable:!0,configurable:!0,get:()=>i.value,set:t=>i.value=t}):e[o]=i}}(c,r,null,t.appContext.config.unwrapInjectedRef),s)for(const d in s){const t=s[d];k(t)&&(r[d]=t.bind(n))}if(o){const e=o.call(n,n);N(e)&&(t.data=Jt(e))}if(yn=!0,i)for(const x in i){const t=i[x],e=k(t)?t.bind(n,n):k(t.get)?t.get.bind(n,n):d,o=!k(t)&&k(t.set)?t.set.bind(n):d,s=Kr({get:e,set:o});Object.defineProperty(r,x,{enumerable:!0,configurable:!0,get:()=>s.value,set:t=>s.value=t})}if(a)for(const d in a)xn(a[d],r,n,d);if(l){const t=k(l)?l.call(n):l;Reflect.ownKeys(t).forEach((e=>{!function(t,e){if(Pr){let n=Pr.provides;const r=Pr.parent&&Pr.parent.provides;r===n&&(n=Pr.provides=Object.create(r)),n[t]=e}}(e,t[e])}))}function R(t,e){x(e)?e.forEach((e=>t(e.bind(n)))):e&&t(e.bind(n))}if(u&&_n(u,t,"c"),R(ln,f),R(cn,p),R(un,h),R(fn,g),R(en,v),R(nn,m),R(mn,C),R(vn,S),R(gn,D),R(dn,b),R(pn,w),R(hn,A),x(E))if(E.length){const e=t.exposed||(t.exposed={});E.forEach((t=>{Object.defineProperty(e,t,{get:()=>n[t],set:e=>n[t]=e})}))}else t.exposed||(t.exposed={});I&&t.render===d&&(t.render=I),null!=O&&(t.inheritAttrs=O),T&&(t.components=T),$&&(t.directives=$)}function _n(t,e,n){pe(x(t)?t.map((t=>t.bind(e.proxy))):t.bind(e.proxy),e,n)}function xn(t,e,n,r){const o=r.includes(".")?Je(n,r):()=>n[r];if(S(t)){const n=e[t];k(n)&&ze(o,n)}else if(k(t))ze(o,t.bind(n));else if(N(t))if(x(t))t.forEach((t=>xn(t,e,n,r)));else{const r=k(t.handler)?t.handler.bind(n):e[t.handler];k(r)&&ze(o,r,t)}}function wn(t){const e=t.type,{mixins:n,extends:r}=e,{mixins:o,optionsCache:i,config:{optionMergeStrategies:s}}=t.appContext,a=i.get(e);let l;return a?l=a:o.length||n||r?(l={},o.length&&o.forEach((t=>In(l,t,s,!0))),In(l,e,s)):l=e,i.set(e,l),l}function In(t,e,n,r=!1){const{mixins:o,extends:i}=e;i&&In(t,i,n,!0),o&&o.forEach((e=>In(t,e,n,!0)));for(const s in e)if(r&&"expose"===s);else{const r=kn[s]||n&&n[s];t[s]=r?r(t[s],e[s]):e[s]}return t}const kn={data:Sn,props:Cn,emits:Cn,methods:Cn,computed:Cn,beforeCreate:Nn,created:Nn,beforeMount:Nn,mounted:Nn,beforeUpdate:Nn,updated:Nn,beforeDestroy:Nn,beforeUnmount:Nn,destroyed:Nn,unmounted:Nn,activated:Nn,deactivated:Nn,errorCaptured:Nn,serverPrefetch:Nn,components:Cn,directives:Cn,watch:function(t,e){if(!t)return e;if(!e)return t;const n=m(Object.create(null),t);for(const r in e)n[r]=Nn(t[r],e[r]);return n},provide:Sn,inject:function(t,e){return Cn(Dn(t),Dn(e))}};function Sn(t,e){return e?t?function(){return m(k(t)?t.call(this,this):t,k(e)?e.call(this,this):e)}:e:t}function Dn(t){if(x(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function Nn(t,e){return t?[...new Set([].concat(t,e))]:e}function Cn(t,e){return t?m(m(Object.create(null),t),e):e}function An(t,e,n,r=!1){const o={},i={};B(i,hr,1),t.propsDefaults=Object.create(null),En(t,e,o,i);for(const s in t.propsOptions[0])s in o||(o[s]=void 0);n?t.props=r?o:Qt(o,!1,kt,Wt,qt):t.type.props?t.props=o:t.props=i,t.attrs=i}function En(t,e,n,r){const[o,i]=t.propsOptions;let s,a=!1;if(e)for(let l in e){if($(l))continue;const c=e[l];let u;o&&_(o,u=M(l))?i&&i.includes(u)?(s||(s={}))[u]=c:n[u]=c:je(t.emitsOptions,l)||l in r&&c===r[l]||(r[l]=c,a=!0)}if(i){const e=oe(n),r=s||u;for(let s=0;s<i.length;s++){const a=i[s];n[a]=On(o,e,a,r[a],t,!_(r,a))}}return a}function On(t,e,n,r,o,i){const s=t[n];if(null!=s){const t=_(s,"default");if(t&&void 0===r){const t=s.default;if(s.type!==Function&&k(t)){const{propsDefaults:i}=o;n in i?r=i[n]:(Rr(o),r=i[n]=t.call(null,e),Mr())}else r=t}s[0]&&(i&&!t?r=!1:!s[1]||""!==r&&r!==j(n)||(r=!0))}return r}function Tn(t,e,n=!1){const r=e.propsCache,o=r.get(t);if(o)return o;const i=t.props,s={},a=[];let l=!1;if(!k(t)){const r=t=>{l=!0;const[n,r]=Tn(t,e,!0);m(s,n),r&&a.push(...r)};!n&&e.mixins.length&&e.mixins.forEach(r),t.extends&&r(t.extends),t.mixins&&t.mixins.forEach(r)}if(!i&&!l)return r.set(t,f),f;if(x(i))for(let f=0;f<i.length;f++){const t=M(i[f]);$n(t)&&(s[t]=u)}else if(i)for(const u in i){const t=M(u);if($n(t)){const e=i[u],n=s[t]=x(e)||k(e)?{type:e}:e;if(n){const e=Mn(Boolean,n.type),r=Mn(String,n.type);n[0]=e>-1,n[1]=r<0||e<r,(e>-1||_(n,"default"))&&a.push(t)}}}const c=[s,a];return r.set(t,c),c}function $n(t){return"$"!==t[0]}function Pn(t){const e=t&&t.toString().match(/^\s*function (\w+)/);return e?e[1]:null===t?"null":""}function Rn(t,e){return Pn(t)===Pn(e)}function Mn(t,e){return x(e)?e.findIndex((e=>Rn(e,t))):k(e)&&Rn(e,t)?0:-1}const Vn=t=>"_"===t[0]||"$stable"===t,jn=t=>x(t)?t.map(wr):[wr(t)],Fn=(t,e,n)=>{const r=function(t,e=Fe,n){if(!e)return t;if(t._n)return t;const r=(...n)=>{r._d&&lr(-1);const o=Ue(e),i=t(...n);return Ue(o),r._d&&lr(1),i};return r._n=!0,r._c=!0,r._d=!0,r}(((...t)=>jn(e(...t))),n);return r._c=!1,r},Ln=(t,e,n)=>{const r=t._ctx;for(const o in t){if(Vn(o))continue;const n=t[o];if(k(n))e[o]=Fn(0,n,r);else if(null!=n){const t=jn(n);e[o]=()=>t}}},Un=(t,e)=>{const n=jn(e);t.slots.default=()=>n};function Kn(t,e,n,r){const o=t.dirs,i=e&&e.dirs;for(let s=0;s<o.length;s++){const a=o[s];i&&(a.oldValue=i[s].value);let l=a.dir[r];l&&(at(),pe(l,n,8,[t.el,a,t,e]),lt())}}function Bn(){return{app:null,config:{isNativeTag:p,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Wn=0;function Hn(t,e){return function(n,r=null){null==r||N(r)||(r=null);const o=Bn(),i=new Set;let s=!1;const a=o.app={_uid:Wn++,_component:n,_props:r,_container:null,_context:o,_instance:null,version:Br,get config(){return o.config},set config(t){},use:(t,...e)=>(i.has(t)||(t&&k(t.install)?(i.add(t),t.install(a,...e)):k(t)&&(i.add(t),t(a,...e))),a),mixin:t=>(o.mixins.includes(t)||o.mixins.push(t),a),component:(t,e)=>e?(o.components[t]=e,a):o.components[t],directive:(t,e)=>e?(o.directives[t]=e,a):o.directives[t],mount(i,l,c){if(!s){const u=yr(n,r);return u.appContext=o,l&&e?e(u,i):t(u,i,c),s=!0,a._container=i,i.__vue_app__=a,Ur(u.component)||u.component.proxy}},unmount(){s&&(t(null,a._container),delete a._container.__vue_app__)},provide:(t,e)=>(o.provides[t]=e,a)};return a}}function Xn(t,e,n,r,o=!1){if(x(t))return void t.forEach(((t,i)=>Xn(t,e&&(x(e)?e[i]:e),n,r,o)));if(Qe(r)&&!o)return;const i=4&r.shapeFlag?Ur(r.component)||r.component.proxy:r.el,s=o?null:i,{i:a,r:l}=t,c=e&&e.r,f=a.refs===u?a.refs={}:a.refs,d=a.setupState;if(null!=c&&c!==l&&(S(c)?(f[c]=null,_(d,c)&&(d[c]=null)):le(c)&&(c.value=null)),k(l))de(l,a,12,[s,f]);else{const e=S(l),r=le(l);if(e||r){const r=()=>{if(t.f){const n=e?f[l]:l.value;o?x(n)&&y(n,i):x(n)?n.includes(i)||n.push(i):e?f[l]=[i]:(l.value=[i],t.k&&(f[t.k]=l.value))}else e?(f[l]=s,_(d,l)&&(d[l]=s)):le(l)&&(l.value=s,t.k&&(f[t.k]=s))};s?(r.id=-1,qn(r,n)):r()}}}const qn=function(t,e){e&&e.pendingBranch?x(t)?e.effects.push(...t):e.effects.push(t):Oe(t,Ie,we,ke)};function zn(t){return function(t,e){(H||(H="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})).__VUE__=!0;const{insert:n,remove:r,patchProp:o,createElement:i,createText:s,createComment:a,setText:l,setElementText:c,parentNode:p,nextSibling:h,setScopeId:g=d,cloneNode:v,insertStaticContent:y}=t,b=(t,e,n,r=null,o=null,i=null,s=!1,a=null,l=!!e.dynamicChildren)=>{if(t===e)return;t&&!pr(t,e)&&(r=nt(t),J(t,o,i,!0),t=null),-2===e.patchFlag&&(l=!1,e.dynamicChildren=null);const{type:c,ref:u,shapeFlag:f}=e;switch(c){case er:x(t,e,n,r);break;case nr:w(t,e,n,r);break;case rr:null==t&&I(e,n,r,s);break;case tr:R(t,e,n,r,o,i,s,a,l);break;default:1&f?D(t,e,n,r,o,i,s,a,l):6&f?V(t,e,n,r,o,i,s,a,l):(64&f||128&f)&&c.process(t,e,n,r,o,i,s,a,l,it)}null!=u&&o&&Xn(u,t&&t.ref,i,e||t,!e)},x=(t,e,r,o)=>{if(null==t)n(e.el=s(e.children),r,o);else{const n=e.el=t.el;e.children!==t.children&&l(n,e.children)}},w=(t,e,r,o)=>{null==t?n(e.el=a(e.children||""),r,o):e.el=t.el},I=(t,e,n,r)=>{[t.el,t.anchor]=y(t.children,e,n,r,t.el,t.anchor)},k=({el:t,anchor:e},r,o)=>{let i;for(;t&&t!==e;)i=h(t),n(t,r,o),t=i;n(e,r,o)},S=({el:t,anchor:e})=>{let n;for(;t&&t!==e;)n=h(t),r(t),t=n;r(e)},D=(t,e,n,r,o,i,s,a,l)=>{s=s||"svg"===e.type,null==t?N(e,n,r,o,i,s,a,l):O(t,e,o,i,s,a,l)},N=(t,e,r,s,a,l,u,f)=>{let d,p;const{type:h,props:g,shapeFlag:m,transition:y,patchFlag:b,dirs:_}=t;if(t.el&&void 0!==v&&-1===b)d=t.el=v(t.el);else{if(d=t.el=i(t.type,l,g&&g.is,g),8&m?c(d,t.children):16&m&&E(t.children,d,null,s,a,l&&"foreignObject"!==h,u,f),_&&Kn(t,null,s,"created"),g){for(const e in g)"value"===e||$(e)||o(d,e,null,g[e],l,t.children,s,a,et);"value"in g&&o(d,"value",null,g.value),(p=g.onVnodeBeforeMount)&&Sr(p,s,t)}A(d,t,t.scopeId,u,s)}_&&Kn(t,null,s,"beforeMount");const x=(!a||a&&!a.pendingBranch)&&y&&!y.persisted;x&&y.beforeEnter(d),n(d,e,r),((p=g&&g.onVnodeMounted)||x||_)&&qn((()=>{p&&Sr(p,s,t),x&&y.enter(d),_&&Kn(t,null,s,"mounted")}),a)},A=(t,e,n,r,o)=>{if(n&&g(t,n),r)for(let i=0;i<r.length;i++)g(t,r[i]);if(o){if(e===o.subTree){const e=o.vnode;A(t,e,e.scopeId,e.slotScopeIds,o.parent)}}},E=(t,e,n,r,o,i,s,a,l=0)=>{for(let c=l;c<t.length;c++){const l=t[c]=a?Ir(t[c]):wr(t[c]);b(null,l,e,n,r,o,i,s,a)}},O=(t,e,n,r,i,s,a)=>{const l=e.el=t.el;let{patchFlag:f,dynamicChildren:d,dirs:p}=e;f|=16&t.patchFlag;const h=t.props||u,g=e.props||u;let v;n&&Yn(n,!1),(v=g.onVnodeBeforeUpdate)&&Sr(v,n,e,t),p&&Kn(e,t,n,"beforeUpdate"),n&&Yn(n,!0);const m=i&&"foreignObject"!==e.type;if(d?T(t.dynamicChildren,d,l,n,r,m,s):a||X(t,e,l,null,n,r,m,s,!1),f>0){if(16&f)P(l,e,h,g,n,r,i);else if(2&f&&h.class!==g.class&&o(l,"class",null,g.class,i),4&f&&o(l,"style",h.style,g.style,i),8&f){const s=e.dynamicProps;for(let e=0;e<s.length;e++){const a=s[e],c=h[a],u=g[a];u===c&&"value"!==a||o(l,a,c,u,i,t.children,n,r,et)}}1&f&&t.children!==e.children&&c(l,e.children)}else a||null!=d||P(l,e,h,g,n,r,i);((v=g.onVnodeUpdated)||p)&&qn((()=>{v&&Sr(v,n,e,t),p&&Kn(e,t,n,"updated")}),r)},T=(t,e,n,r,o,i,s)=>{for(let a=0;a<e.length;a++){const l=t[a],c=e[a],u=l.el&&(l.type===tr||!pr(l,c)||70&l.shapeFlag)?p(l.el):n;b(l,c,u,null,r,o,i,s,!0)}},P=(t,e,n,r,i,s,a)=>{if(n!==r){for(const l in r){if($(l))continue;const c=r[l],u=n[l];c!==u&&"value"!==l&&o(t,l,u,c,a,e.children,i,s,et)}if(n!==u)for(const l in n)$(l)||l in r||o(t,l,n[l],null,a,e.children,i,s,et);"value"in r&&o(t,"value",n.value,r.value)}},R=(t,e,r,o,i,a,l,c,u)=>{const f=e.el=t?t.el:s(""),d=e.anchor=t?t.anchor:s("");let{patchFlag:p,dynamicChildren:h,slotScopeIds:g}=e;g&&(c=c?c.concat(g):g),null==t?(n(f,r,o),n(d,r,o),E(e.children,r,d,i,a,l,c,u)):p>0&&64&p&&h&&t.dynamicChildren?(T(t.dynamicChildren,h,r,i,a,l,c),(null!=e.key||i&&e===i.subTree)&&Gn(t,e,!0)):X(t,e,r,d,i,a,l,c,u)},V=(t,e,n,r,o,i,s,a,l)=>{e.slotScopeIds=a,null==t?512&e.shapeFlag?o.ctx.activate(e,n,r,s,l):F(e,n,r,o,i,s,l):L(t,e,l)},F=(t,e,n,r,o,i,s)=>{const a=t.component=function(t,e,n){const r=t.type,o=(e?e.appContext:t.appContext)||Tr,i={uid:$r++,vnode:t,type:r,parent:e,appContext:o,root:null,next:null,subTree:null,effect:null,update:null,scope:new q(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(o.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Tn(r,o),emitsOptions:Ve(r,o),emit:null,emitted:null,propsDefaults:u,inheritAttrs:r.inheritAttrs,ctx:u,data:u,props:u,attrs:u,slots:u,refs:u,setupState:u,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};i.ctx={_:i},i.root=e?e.root:i,i.emit=Me.bind(null,i),t.ce&&t.ce(i);return i}(t,r,o);if(tn(t)&&(a.ctx.renderer=it),function(t,e=!1){jr=e;const{props:n,children:r}=t.vnode,o=Vr(t);An(t,n,o,e),((t,e)=>{if(32&t.vnode.shapeFlag){const n=e._;n?(t.slots=oe(e),B(e,"_",n)):Ln(e,t.slots={})}else t.slots={},e&&Un(t,e);B(t.slots,hr,1)})(t,r);const i=o?function(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=ie(new Proxy(t.ctx,Or));const{setup:r}=n;if(r){const n=t.setupContext=r.length>1?function(t){const e=e=>{t.exposed=e||{}};let n;return{get attrs(){return n||(n=function(t){return new Proxy(t.attrs,{get:(e,n)=>(ct(t,0,"$attrs"),e[n])})}(t))},slots:t.slots,emit:t.emit,expose:e}}(t):null;Rr(t),at();const o=de(r,t,0,[t.props,n]);if(lt(),Mr(),C(o)){if(o.then(Mr,Mr),e)return o.then((n=>{Fr(t,n,e)})).catch((e=>{he(e,t,0)}));t.asyncDep=o}else Fr(t,o,e)}else Lr(t,e)}(t,e):void 0;jr=!1}(a),a.asyncDep){if(o&&o.registerDep(a,U),!t.el){const t=a.subTree=yr(nr);w(null,t,e,n)}}else U(a,t,e,n,o,i,s)},L=(t,e,n)=>{const r=e.component=t.component;if(function(t,e,n){const{props:r,children:o,component:i}=t,{props:s,children:a,patchFlag:l}=e,c=i.emitsOptions;if(e.dirs||e.transition)return!0;if(!(n&&l>=0))return!(!o&&!a||a&&a.$stable)||r!==s&&(r?!s||He(r,s,c):!!s);if(1024&l)return!0;if(16&l)return r?He(r,s,c):!!s;if(8&l){const t=e.dynamicProps;for(let e=0;e<t.length;e++){const n=t[e];if(s[n]!==r[n]&&!je(c,n))return!0}}return!1}(t,e,n)){if(r.asyncDep&&!r.asyncResolved)return void W(r,e,n);r.next=e,function(t){const e=me.indexOf(t);e>ye&&me.splice(e,1)}(r.update),r.update()}else e.component=t.component,e.el=t.el,r.vnode=e},U=(t,e,n,r,o,i,s)=>{const a=()=>{if(t.isMounted){let e,{next:n,bu:r,u:a,parent:l,vnode:c}=t,u=n;Yn(t,!1),n?(n.el=c.el,W(t,n,s)):n=c,r&&K(r),(e=n.props&&n.props.onVnodeBeforeUpdate)&&Sr(e,l,n,c),Yn(t,!0);const f=Ke(t),d=t.subTree;t.subTree=f,b(d,f,p(d.el),nt(d),t,o,i),n.el=f.el,null===u&&function({vnode:t,parent:e},n){for(;e&&e.subTree===t;)(t=e.vnode).el=n,e=e.parent}(t,f.el),a&&qn(a,o),(e=n.props&&n.props.onVnodeUpdated)&&qn((()=>Sr(e,l,n,c)),o)}else{let s;const{el:a,props:l}=e,{bm:c,m:u,parent:f}=t,d=Qe(e);if(Yn(t,!1),c&&K(c),!d&&(s=l&&l.onVnodeBeforeMount)&&Sr(s,f,e),Yn(t,!0),a&&ut){const n=()=>{t.subTree=Ke(t),ut(a,t.subTree,t,o,null)};d?e.type.__asyncLoader().then((()=>!t.isUnmounted&&n())):n()}else{const s=t.subTree=Ke(t);b(null,s,n,r,t,o,i),e.el=s.el}if(u&&qn(u,o),!d&&(s=l&&l.onVnodeMounted)){const t=e;qn((()=>Sr(s,f,t)),o)}256&e.shapeFlag&&t.a&&qn(t.a,o),t.isMounted=!0,e=n=r=null}},l=t.effect=new rt(a,(()=>Ae(t.update)),t.scope),c=t.update=l.run.bind(l);c.id=t.uid,Yn(t,!0),c()},W=(t,e,n)=>{e.component=t;const r=t.vnode.props;t.vnode=e,t.next=null,function(t,e,n,r){const{props:o,attrs:i,vnode:{patchFlag:s}}=t,a=oe(o),[l]=t.propsOptions;let c=!1;if(!(r||s>0)||16&s){let r;En(t,e,o,i)&&(c=!0);for(const i in a)e&&(_(e,i)||(r=j(i))!==i&&_(e,r))||(l?!n||void 0===n[i]&&void 0===n[r]||(o[i]=On(l,a,i,void 0,t,!0)):delete o[i]);if(i!==a)for(const t in i)e&&_(e,t)||(delete i[t],c=!0)}else if(8&s){const n=t.vnode.dynamicProps;for(let r=0;r<n.length;r++){let s=n[r];const u=e[s];if(l)if(_(i,s))u!==i[s]&&(i[s]=u,c=!0);else{const e=M(s);o[e]=On(l,a,e,u,t,!1)}else u!==i[s]&&(i[s]=u,c=!0)}}c&&ft(t,"set","$attrs")}(t,e.props,r,n),((t,e,n)=>{const{vnode:r,slots:o}=t;let i=!0,s=u;if(32&r.shapeFlag){const t=e._;t?n&&1===t?i=!1:(m(o,e),n||1!==t||delete o._):(i=!e.$stable,Ln(e,o)),s=e}else e&&(Un(t,e),s={default:1});if(i)for(const a in o)Vn(a)||a in s||delete o[a]})(t,e.children,n),at(),Te(void 0,t.update),lt()},X=(t,e,n,r,o,i,s,a,l=!1)=>{const u=t&&t.children,f=t?t.shapeFlag:0,d=e.children,{patchFlag:p,shapeFlag:h}=e;if(p>0){if(128&p)return void Y(u,d,n,r,o,i,s,a,l);if(256&p)return void z(u,d,n,r,o,i,s,a,l)}8&h?(16&f&&et(u,o,i),d!==u&&c(n,d)):16&f?16&h?Y(u,d,n,r,o,i,s,a,l):et(u,o,i,!0):(8&f&&c(n,""),16&h&&E(d,n,r,o,i,s,a,l))},z=(t,e,n,r,o,i,s,a,l)=>{e=e||f;const c=(t=t||f).length,u=e.length,d=Math.min(c,u);let p;for(p=0;p<d;p++){const r=e[p]=l?Ir(e[p]):wr(e[p]);b(t[p],r,n,null,o,i,s,a,l)}c>u?et(t,o,i,!0,!1,d):E(e,n,r,o,i,s,a,l,d)},Y=(t,e,n,r,o,i,s,a,l)=>{let c=0;const u=e.length;let d=t.length-1,p=u-1;for(;c<=d&&c<=p;){const r=t[c],u=e[c]=l?Ir(e[c]):wr(e[c]);if(!pr(r,u))break;b(r,u,n,null,o,i,s,a,l),c++}for(;c<=d&&c<=p;){const r=t[d],c=e[p]=l?Ir(e[p]):wr(e[p]);if(!pr(r,c))break;b(r,c,n,null,o,i,s,a,l),d--,p--}if(c>d){if(c<=p){const t=p+1,f=t<u?e[t].el:r;for(;c<=p;)b(null,e[c]=l?Ir(e[c]):wr(e[c]),n,f,o,i,s,a,l),c++}}else if(c>p)for(;c<=d;)J(t[c],o,i,!0),c++;else{const h=c,g=c,v=new Map;for(c=g;c<=p;c++){const t=e[c]=l?Ir(e[c]):wr(e[c]);null!=t.key&&v.set(t.key,c)}let m,y=0;const _=p-g+1;let x=!1,w=0;const I=new Array(_);for(c=0;c<_;c++)I[c]=0;for(c=h;c<=d;c++){const r=t[c];if(y>=_){J(r,o,i,!0);continue}let u;if(null!=r.key)u=v.get(r.key);else for(m=g;m<=p;m++)if(0===I[m-g]&&pr(r,e[m])){u=m;break}void 0===u?J(r,o,i,!0):(I[u-g]=c+1,u>=w?w=u:x=!0,b(r,e[u],n,null,o,i,s,a,l),y++)}const k=x?function(t){const e=t.slice(),n=[0];let r,o,i,s,a;const l=t.length;for(r=0;r<l;r++){const l=t[r];if(0!==l){if(o=n[n.length-1],t[o]<l){e[r]=o,n.push(r);continue}for(i=0,s=n.length-1;i<s;)a=i+s>>1,t[n[a]]<l?i=a+1:s=a;l<t[n[i]]&&(i>0&&(e[r]=n[i-1]),n[i]=r)}}i=n.length,s=n[i-1];for(;i-- >0;)n[i]=s,s=e[s];return n}(I):f;for(m=k.length-1,c=_-1;c>=0;c--){const t=g+c,f=e[t],d=t+1<u?e[t+1].el:r;0===I[c]?b(null,f,n,d,o,i,s,a,l):x&&(m<0||c!==k[m]?G(f,n,d,2):m--)}}},G=(t,e,r,o,i=null)=>{const{el:s,type:a,transition:l,children:c,shapeFlag:u}=t;if(6&u)return void G(t.component.subTree,e,r,o);if(128&u)return void t.suspense.move(e,r,o);if(64&u)return void a.move(t,e,r,it);if(a===tr){n(s,e,r);for(let t=0;t<c.length;t++)G(c[t],e,r,o);return void n(t.anchor,e,r)}if(a===rr)return void k(t,e,r);if(2!==o&&1&u&&l)if(0===o)l.beforeEnter(s),n(s,e,r),qn((()=>l.enter(s)),i);else{const{leave:t,delayLeave:o,afterLeave:i}=l,a=()=>n(s,e,r),c=()=>{t(s,(()=>{a(),i&&i()}))};o?o(s,a,c):c()}else n(s,e,r)},J=(t,e,n,r=!1,o=!1)=>{const{type:i,props:s,ref:a,children:l,dynamicChildren:c,shapeFlag:u,patchFlag:f,dirs:d}=t;if(null!=a&&Xn(a,null,n,t,!0),256&u)return void e.ctx.deactivate(t);const p=1&u&&d,h=!Qe(t);let g;if(h&&(g=s&&s.onVnodeBeforeUnmount)&&Sr(g,e,t),6&u)tt(t.component,n,r);else{if(128&u)return void t.suspense.unmount(n,r);p&&Kn(t,null,e,"beforeUnmount"),64&u?t.type.remove(t,e,n,o,it,r):c&&(i!==tr||f>0&&64&f)?et(c,e,n,!1,!0):(i===tr&&384&f||!o&&16&u)&&et(l,e,n),r&&Z(t)}(h&&(g=s&&s.onVnodeUnmounted)||p)&&qn((()=>{g&&Sr(g,e,t),p&&Kn(t,null,e,"unmounted")}),n)},Z=t=>{const{type:e,el:n,anchor:o,transition:i}=t;if(e===tr)return void Q(n,o);if(e===rr)return void S(t);const s=()=>{r(n),i&&!i.persisted&&i.afterLeave&&i.afterLeave()};if(1&t.shapeFlag&&i&&!i.persisted){const{leave:e,delayLeave:r}=i,o=()=>e(n,s);r?r(t.el,s,o):o()}else s()},Q=(t,e)=>{let n;for(;t!==e;)n=h(t),r(t),t=n;r(e)},tt=(t,e,n)=>{const{bum:r,scope:o,update:i,subTree:s,um:a}=t;r&&K(r),o.stop(),i&&(i.active=!1,J(s,t,e,n)),a&&qn(a,e),qn((()=>{t.isUnmounted=!0}),e),e&&e.pendingBranch&&!e.isUnmounted&&t.asyncDep&&!t.asyncResolved&&t.suspenseId===e.pendingId&&(e.deps--,0===e.deps&&e.resolve())},et=(t,e,n,r=!1,o=!1,i=0)=>{for(let s=i;s<t.length;s++)J(t[s],e,n,r,o)},nt=t=>6&t.shapeFlag?nt(t.component.subTree):128&t.shapeFlag?t.suspense.next():h(t.anchor||t.el),ot=(t,e,n)=>{null==t?e._vnode&&J(e._vnode,null,null,!0):b(e._vnode||null,t,e,null,null,null,n),$e(),e._vnode=t},it={p:b,um:J,m:G,r:Z,mt:F,mc:E,pc:X,pbc:T,n:nt,o:t};let st,ut;e&&([st,ut]=e(it));return{render:ot,hydrate:st,createApp:Hn(ot,st)}}(t)}function Yn({effect:t,update:e},n){t.allowRecurse=e.allowRecurse=n}function Gn(t,e,n=!1){const r=t.children,o=e.children;if(x(r)&&x(o))for(let i=0;i<r.length;i++){const t=r[i];let e=o[i];1&e.shapeFlag&&!e.dynamicChildren&&((e.patchFlag<=0||32===e.patchFlag)&&(e=o[i]=Ir(o[i]),e.el=t.el),n||Gn(t,e))}}function Jn(t,e){return function(t,e,n=!0,r=!1){const o=Fe||Pr;if(o){const n=o.type;if("components"===t){const t=function(t){return k(t)&&t.displayName||t.name}(n);if(t&&(t===e||t===M(e)||t===F(M(e))))return n}const i=Qn(o[t]||n[t],e)||Qn(o.appContext[t],e);return!i&&r?n:i}}("components",t,!0,e)||t}const Zn=Symbol();function Qn(t,e){return t&&(t[e]||t[M(e)]||t[F(M(e))])}const tr=Symbol(void 0),er=Symbol(void 0),nr=Symbol(void 0),rr=Symbol(void 0),or=[];let ir=null;function sr(t=!1){or.push(ir=t?null:[])}let ar=1;function lr(t){ar+=t}function cr(t){return t.dynamicChildren=ar>0?ir||f:null,or.pop(),ir=or[or.length-1]||null,ar>0&&ir&&ir.push(t),t}function ur(t,e,n,r,o,i){return cr(mr(t,e,n,r,o,i,!0))}function fr(t,e,n,r,o){return cr(yr(t,e,n,r,o,!0))}function dr(t){return!!t&&!0===t.__v_isVNode}function pr(t,e){return t.type===e.type&&t.key===e.key}const hr="__vInternal",gr=({key:t})=>null!=t?t:null,vr=({ref:t,ref_key:e,ref_for:n})=>null!=t?S(t)||le(t)||k(t)?{i:Fe,r:t,k:e,f:!!n}:t:null;function mr(t,e=null,n=null,r=0,o=null,i=(t===tr?0:1),s=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&gr(e),ref:e&&vr(e),scopeId:Le,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:r,dynamicProps:o,dynamicChildren:null,appContext:null};return a?(kr(l,n),128&i&&t.normalize(l)):n&&(l.shapeFlag|=S(n)?8:16),ar>0&&!s&&ir&&(l.patchFlag>0||6&i)&&32!==l.patchFlag&&ir.push(l),l}const yr=function(t,e=null,n=null,o=0,i=null,s=!1){t&&t!==Zn||(t=nr);if(dr(t)){const r=br(t,e,!0);return n&&kr(r,n),r}l=t,k(l)&&"__vccOpts"in l&&(t=t.__vccOpts);var l;if(e){e=function(t){return t?re(t)||hr in t?m({},t):t:null}(e);let{class:t,style:n}=e;t&&!S(t)&&(e.class=a(t)),N(n)&&(re(n)&&!x(n)&&(n=m({},n)),e.style=r(n))}const c=S(t)?1:(t=>t.__isSuspense)(t)?128:(t=>t.__isTeleport)(t)?64:N(t)?4:k(t)?2:0;return mr(t,e,n,o,i,c,s,!0)};function br(t,e,n=!1){const{props:o,ref:i,patchFlag:s,children:l}=t,c=e?function(...t){const e={};for(let n=0;n<t.length;n++){const o=t[n];for(const t in o)if("class"===t)e.class!==o.class&&(e.class=a([e.class,o.class]));else if("style"===t)e.style=r([e.style,o.style]);else if(g(t)){const n=e[t],r=o[t];!r||n===r||x(n)&&n.includes(r)||(e[t]=n?[].concat(n,r):r)}else""!==t&&(e[t]=o[t])}return e}(o||{},e):o;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:c,key:c&&gr(c),ref:e&&e.ref?n&&i?x(i)?i.concat(vr(e)):[i,vr(e)]:vr(e):i,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:l,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==tr?-1===s?16:16|s:s,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&br(t.ssContent),ssFallback:t.ssFallback&&br(t.ssFallback),el:t.el,anchor:t.anchor}}function _r(t=" ",e=0){return yr(er,null,t,e)}function xr(t="",e=!1){return e?(sr(),fr(nr,null,t)):yr(nr,null,t)}function wr(t){return null==t||"boolean"==typeof t?yr(nr):x(t)?yr(tr,null,t.slice()):"object"==typeof t?Ir(t):yr(er,null,String(t))}function Ir(t){return null===t.el||t.memo?t:br(t)}function kr(t,e){let n=0;const{shapeFlag:r}=t;if(null==e)e=null;else if(x(e))n=16;else if("object"==typeof e){if(65&r){const n=e.default;return void(n&&(n._c&&(n._d=!1),kr(t,n()),n._c&&(n._d=!0)))}{n=32;const r=e._;r||hr in e?3===r&&Fe&&(1===Fe.slots._?e._=1:(e._=2,t.patchFlag|=1024)):e._ctx=Fe}}else k(e)?(e={default:e,_ctx:Fe},n=32):(e=String(e),64&r?(n=16,e=[_r(e)]):n=8);t.children=e,t.shapeFlag|=n}function Sr(t,e,n,r=null){pe(t,e,7,[n,r])}function Dr(t,e,n,r){let o;const i=n&&n[r];if(x(t)||S(t)){o=new Array(t.length);for(let n=0,r=t.length;n<r;n++)o[n]=e(t[n],n,void 0,i&&i[n])}else if("number"==typeof t){o=new Array(t);for(let n=0;n<t;n++)o[n]=e(n+1,n,void 0,i&&i[n])}else if(N(t))if(t[Symbol.iterator])o=Array.from(t,((t,n)=>e(t,n,void 0,i&&i[n])));else{const n=Object.keys(t);o=new Array(n.length);for(let r=0,s=n.length;r<s;r++){const s=n[r];o[r]=e(t[s],s,r,i&&i[r])}}else o=[];return n&&(n[r]=o),o}function Nr(t,e,n={},r,o){if(Fe.isCE)return yr("slot","default"===e?null:{name:e},r&&r());let i=t[e];i&&i._c&&(i._d=!1),sr();const s=i&&Cr(i(n)),a=fr(tr,{key:n.key||`_${e}`},s||(r?r():[]),s&&1===t._?64:-2);return!o&&a.scopeId&&(a.slotScopeIds=[a.scopeId+"-s"]),i&&i._c&&(i._d=!0),a}function Cr(t){return t.some((t=>!dr(t)||t.type!==nr&&!(t.type===tr&&!Cr(t.children))))?t:null}const Ar=t=>t?Vr(t)?Ur(t)||t.proxy:Ar(t.parent):null,Er=m(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>Ar(t.parent),$root:t=>Ar(t.root),$emit:t=>t.emit,$options:t=>wn(t),$forceUpdate:t=>()=>Ae(t.update),$nextTick:t=>Ce.bind(t.proxy),$watch:t=>Ge.bind(t)}),Or={get({_:t},e){const{ctx:n,setupState:r,data:o,props:i,accessCache:s,type:a,appContext:l}=t;let c;if("$"!==e[0]){const a=s[e];if(void 0!==a)switch(a){case 1:return r[e];case 2:return o[e];case 4:return n[e];case 3:return i[e]}else{if(r!==u&&_(r,e))return s[e]=1,r[e];if(o!==u&&_(o,e))return s[e]=2,o[e];if((c=t.propsOptions[0])&&_(c,e))return s[e]=3,i[e];if(n!==u&&_(n,e))return s[e]=4,n[e];yn&&(s[e]=0)}}const f=Er[e];let d,p;return f?("$attrs"===e&&ct(t,0,e),f(t)):(d=a.__cssModules)&&(d=d[e])?d:n!==u&&_(n,e)?(s[e]=4,n[e]):(p=l.config.globalProperties,_(p,e)?p[e]:void 0)},set({_:t},e,n){const{data:r,setupState:o,ctx:i}=t;return o!==u&&_(o,e)?(o[e]=n,!0):r!==u&&_(r,e)?(r[e]=n,!0):!_(t.props,e)&&(("$"!==e[0]||!(e.slice(1)in t))&&(i[e]=n,!0))},has({_:{data:t,setupState:e,accessCache:n,ctx:r,appContext:o,propsOptions:i}},s){let a;return!!n[s]||t!==u&&_(t,s)||e!==u&&_(e,s)||(a=i[0])&&_(a,s)||_(r,s)||_(Er,s)||_(o.config.globalProperties,s)},defineProperty(t,e,n){return null!=n.get?this.set(t,e,n.get(),null):null!=n.value&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}},Tr=Bn();let $r=0;let Pr=null;const Rr=t=>{Pr=t,t.scope.on()},Mr=()=>{Pr&&Pr.scope.off(),Pr=null};function Vr(t){return 4&t.vnode.shapeFlag}let jr=!1;function Fr(t,e,n){k(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:N(e)&&(t.setupState=ue(e)),Lr(t,n)}function Lr(t,e,n){const r=t.type;t.render||(t.render=r.render||d),Rr(t),at(),bn(t),lt(),Mr()}function Ur(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(ue(ie(t.exposed)),{get:(e,n)=>n in e?e[n]:n in Er?Er[n](t):void 0}))}const Kr=(t,e)=>function(t,e,n=!1){let r,o;const i=k(t);return i?(r=t,o=d):(r=t.get,o=t.set),new fe(r,o,i||!o,n)}(t,0,jr),Br="3.2.31",Wr="undefined"!=typeof document?document:null,Hr=Wr&&Wr.createElement("template"),Xr={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,r)=>{const o=e?Wr.createElementNS("http://www.w3.org/2000/svg",t):Wr.createElement(t,n?{is:n}:void 0);return"select"===t&&r&&null!=r.multiple&&o.setAttribute("multiple",r.multiple),o},createText:t=>Wr.createTextNode(t),createComment:t=>Wr.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Wr.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},cloneNode(t){const e=t.cloneNode(!0);return"_value"in t&&(e._value=t._value),e},insertStaticContent(t,e,n,r,o,i){const s=n?n.previousSibling:e.lastChild;if(o&&(o===i||o.nextSibling))for(;e.insertBefore(o.cloneNode(!0),n),o!==i&&(o=o.nextSibling););else{Hr.innerHTML=r?`<svg>${t}</svg>`:t;const o=Hr.content;if(r){const t=o.firstChild;for(;t.firstChild;)o.appendChild(t.firstChild);o.removeChild(t)}e.insertBefore(o,n)}return[s?s.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}};const qr=/\s*!important$/;function zr(t,e,n){if(x(n))n.forEach((n=>zr(t,e,n)));else if(e.startsWith("--"))t.setProperty(e,n);else{const r=function(t,e){const n=Gr[e];if(n)return n;let r=M(e);if("filter"!==r&&r in t)return Gr[e]=r;r=F(r);for(let o=0;o<Yr.length;o++){const n=Yr[o]+r;if(n in t)return Gr[e]=n}return e}(t,e);qr.test(n)?t.setProperty(j(r),n.replace(qr,""),"important"):t[r]=n}}const Yr=["Webkit","Moz","ms"],Gr={};const Jr="http://www.w3.org/1999/xlink";let Zr=Date.now,Qr=!1;if("undefined"!=typeof window){Zr()>document.createEvent("Event").timeStamp&&(Zr=()=>performance.now());const t=navigator.userAgent.match(/firefox\/(\d+)/i);Qr=!!(t&&Number(t[1])<=53)}let to=0;const eo=Promise.resolve(),no=()=>{to=0};function ro(t,e,n,r,o=null){const i=t._vei||(t._vei={}),s=i[e];if(r&&s)s.value=r;else{const[n,a]=function(t){let e;if(oo.test(t)){let n;for(e={};n=t.match(oo);)t=t.slice(0,t.length-n[0].length),e[n[0].toLowerCase()]=!0}return[j(t.slice(2)),e]}(e);if(r){!function(t,e,n,r){t.addEventListener(e,n,r)}(t,n,i[e]=function(t,e){const n=t=>{const r=t.timeStamp||Zr();(Qr||r>=n.attached-1)&&pe(function(t,e){if(x(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map((t=>e=>!e._stopped&&t&&t(e)))}return e}(t,n.value),e,5,[t])};return n.value=t,n.attached=(()=>to||(eo.then(no),to=Zr()))(),n}(r,o),a)}else s&&(!function(t,e,n,r){t.removeEventListener(e,n,r)}(t,n,s,a),i[e]=void 0)}}const oo=/(?:Once|Passive|Capture)$/;const io=/^on[a-z]/;const so=m({patchProp:(t,r,o,i,s=!1,a,l,c,u)=>{"class"===r?function(t,e,n){const r=t._vtc;r&&(e=(e?[e,...r]:[...r]).join(" ")),null==e?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}(t,i,s):"style"===r?function(t,e,n){const r=t.style,o=S(n);if(n&&!o){for(const t in n)zr(r,t,n[t]);if(e&&!S(e))for(const t in e)null==n[t]&&zr(r,t,"")}else{const i=r.display;o?e!==n&&(r.cssText=n):e&&t.removeAttribute("style"),"_vod"in t&&(r.display=i)}}(t,o,i):g(r)?v(r)||ro(t,r,0,i,l):("."===r[0]?(r=r.slice(1),1):"^"===r[0]?(r=r.slice(1),0):function(t,e,n,r){if(r)return"innerHTML"===e||"textContent"===e||!!(e in t&&io.test(e)&&k(n));if("spellcheck"===e||"draggable"===e)return!1;if("form"===e)return!1;if("list"===e&&"INPUT"===t.tagName)return!1;if("type"===e&&"TEXTAREA"===t.tagName)return!1;if(io.test(e)&&S(n))return!1;return e in t}(t,r,i,s))?function(t,e,r,o,i,s,a){if("innerHTML"===e||"textContent"===e)return o&&a(o,i,s),void(t[e]=null==r?"":r);if("value"===e&&"PROGRESS"!==t.tagName&&!t.tagName.includes("-")){t._value=r;const n=null==r?"":r;return t.value===n&&"OPTION"!==t.tagName||(t.value=n),void(null==r&&t.removeAttribute(e))}if(""===r||null==r){const o=typeof t[e];if("boolean"===o)return void(t[e]=n(r));if(null==r&&"string"===o)return t[e]="",void t.removeAttribute(e);if("number"===o){try{t[e]=0}catch(l){}return void t.removeAttribute(e)}}try{t[e]=r}catch(c){}}(t,r,i,a,l,c,u):("true-value"===r?t._trueValue=i:"false-value"===r&&(t._falseValue=i),function(t,r,o,i,s){if(i&&r.startsWith("xlink:"))null==o?t.removeAttributeNS(Jr,r.slice(6,r.length)):t.setAttributeNS(Jr,r,o);else{const i=e(r);null==o||i&&!n(o)?t.removeAttribute(r):t.setAttribute(r,i?"":o)}}(t,r,i,s))}},Xr);let ao;const lo=(...t)=>{const e=(ao||(ao=zn(so))).createApp(...t),{mount:n}=e;return e.mount=t=>{const r=function(t){if(S(t)){return document.querySelector(t)}return t}(t);if(!r)return;const o=e._component;k(o)||o.render||o.template||(o.template=r.innerHTML),r.innerHTML="";const i=n(r,!1,r instanceof SVGElement);return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),i},e};function co(t){return t[t.length-1]}console.assert=(t,e)=>{t||console.log(new Error(e))};const uo="0987654321abcdefghijklmnoprstuvyz";function fo(t){return function(t=4){const e=uo.length,n=Math.pow(e,t);let r=Math.floor(Math.random()*n);const o=[];for(let i=0;i<t;i+=1)o.push(uo[r%e]),r=Math.floor(r/e);return o.join("")}()}function po(t){if(t||(t=document.getSelection()),!(t instanceof Selection))return t;if(t.isCollapsed){const e={node:t.anchorNode,offset:t.anchorOffset};return{start:e,end:e,backwards:!1,collapsed:!0,selection:t}}const e=function(t){if(t.isCollapsed)return!1;if(t.anchorNode===t.focusNode)return t.anchorOffset>t.focusOffset;const e=[t.anchorNode];let n=t.anchorNode;for(;n&&n!=document.body;)n=n.parentNode,e.push(n);for(n=t.focusNode;n&&n!=document.body;){const t=n;let r;n=n.parentNode;for(const o of e){if(n===o)for(const e of o.childNodes){if(e===r)return!1;if(e===t)return!0}r=o}}}(t);return{start:{node:e?t.focusNode:t.anchorNode,offset:e?t.focusOffset:t.anchorOffset},end:{node:e?t.anchorNode:t.focusNode,offset:e?t.anchorOffset:t.focusOffset},backwards:e,collapsed:!1,selection:t}}function ho(t,e,n=[]){if(t&&t.nodeType==Node.TEXT_NODE&&(t=t.parentNode),t&&t.nodeType==Node.ELEMENT_NODE&&(!e||t.nodeName===e)){const e={};for(const r of n){const n=t.attributes["data-"+r];n&&(e[r]=n.nodeValue)}return{node:t,attrs:e}}return{}}function go(t){return t.nodeType===Node.ELEMENT_NODE?t.childNodes.length>0?t.childNodes[0]:t:t.nodeType===Node.TEXT_NODE?t:void 0}function vo(t,e){const n=e.querySelector(`div[data-id="${t.paragraphID}"]`+(t.spanID?` > span[data-id="${t.spanID}"]`:""));return t.node=n,t}function mo(t,e,n){const r=go(e.node||vo(e,t).node),o=n&&go(n.node||vo(n,t).node),i=document.getSelection();i.empty();const s=new Range;s.setStart(r,e.offset),n?s.setEnd(o,n.offset):s.collapse(!0),i.addRange(s)}function yo(t){return t.spans}function bo(t,e){return t.spans=e}function _o(t=""){return{id:fo(),text:t,format:{}}}function xo(t){return{id:fo(),spans:"number"==typeof t?Array.from(Array(t),(()=>_o())):t||[]}}function wo(t,...e){return Object.assign({},t,{format:Object.assign({},t.format||{})},...e)}function Io(t,e,{newid:n,splitTime:r}={newid:fo,splitTime:!1}){const o={id:n(t.id),text:t.text.substr(0,e),format:Object.assign({},t.format)},i={id:n(t.id),text:t.text.substr(e),format:Object.assign({},t.format)};if(r){const e=t.text.replace(/\s*/g,"").length;t.duration>0&&(o.duration=o.text.replace(/\s*/g,"").length*t.duration/e,i.duration=i.text.replace(/\s*/g,"").length*t.duration/e,t.time>=0&&(o.time=t.time,i.time=t.time+o.duration))}else o.time=t.time,i.time=t.time,o.duration=t.duration,i.duration=t.duration,t.group&&t.group.length>0?(o.group=t.group,i.group=t.group):(o.group=t.id,i.group=t.id);return{left:o,right:i}}function ko(t,e,n){console.assert(void 0!==t,"data not specified"),console.assert(void 0!==e,"paragraphID not specified");const r=t=>-1===t?void 0:t,o=t;console.assert(void 0!==o,"no paragraphs");const i=r(o.findIndex((t=>t.id===e))),s=void 0!==i&&-1!==i&&o[i]||void 0,a=s&&r(yo(s).findIndex((t=>t.id===n)));return{paragraph:s,paragraphIndex:i,span:void 0!==a&&-1!==a&&yo(s)[a]||void 0,spanIndex:a}}function So(t,e,n){const r=e>=0&&t[e]||void 0,o=r&&yo(r);return{paragraph:r,span:o&&void 0!==n&&o[-1===n||n>=o.length?o.length-1:n]||void 0}}function Do(t,e){console.assert(void 0!==t,"data not specified"),console.assert(void 0!==e,"pointer not specified");const{spanAttrs:n,paragraphAttrs:r}=function(t){let e,n,r,o,i=t;for(;i&&!n;){const{node:t,attrs:s}=ho(i,void 0,["id","time","duration","confidence"]);if(!n&&!e&&t&&"SPAN"===t.nodeName&&s.id)e=s,r=t;else if(!n&&t&&"DIV"===t.nodeName&&s.id){n=s,o=t;break}t&&(i=t),i=i.parentNode}return{spanNode:r,spanAttrs:e,paragraphNode:o,paragraphAttrs:n}}(e.node),o=r&&r.id,i=n&&n.id,s=t,{paragraphIndex:a,paragraph:l,spanIndex:c,span:u}=s&&ko(t,o,i)||{};return{node:e.node,spanAttrs:n,paragraphAttrs:r,paragraphID:o,spanID:i,paragraphIndex:a,paragraph:l,spanIndex:c,span:u,offset:e.offset}}function No(t,e){!function(t,e){if(e.spanID&&e.paragraphID)return e.node;if(e.paragraphID){const{node:t}=ho(e.node,"DIV",["id"]);return t}}(t,e);let n,r,o,i,{node:s,offset:a}=e;if(s.nodeType===Node.ELEMENT_NODE){a=0;for(let t=e.offset-1;t>=0&&t<s.childNodes.length;t--)a+=s.childNodes.textContent&&s.childNodes[t].textConent.length||0}for(;s&&s!=t;){if(s.nodeType===Node.ELEMENT_NODE){if("SPAN"===s.nodeName){n=s.attributes["data-id"].nodeValue}if("DIV"===s.nodeName){r=s.attributes["data-id"].nodeValue}}let t=s;for(;t=t.previousSibling;){if(!o&&"SPAN"===t.nodeName){if(o=t.attributes["data-id"].nodeValue,!n&&!r)break}if(!i&&"DIV"===t.nodeName){if(i=t.attributes["data-id"].nodeValue,!n&&!r)break}n||r||t.textConent&&(a+=t.textConent.length)}s=s.parentNode}return e.spanID=n,e.paragraphID=r,e.offset=a,e.leftSpanID=o,e.leftParagraphID=i,e}function Co(t,e){if(console.assert(void 0!==t,"data not specified"),console.assert(void 0!==e,"pointer not specified"),void 0===e.paragraphID&&(void 0===e.paragraphIndex||-1===e.paragraphIndex))return console.assert(void 0!==e.node,"invalid pointer, no paragraph info and no node"),Object.assign(e,Do(t,e));if(void 0===e.paragraphID||void 0!==e.paragraphIndex&&-1!==e.paragraphIndex){if(void 0===e.paragraphID&&(void 0!==e.paragraphIndex||-1!==e.paragraphIndex)){const{paragraph:n,span:r}=So(t,e.paragraphIndex,e.spanIndex);console.assert(n,"paragraph not resolved"),console.assert(void 0!==e.spanIndex&&r||void 0===e.spanIndex||0===yo(t[e.paragraphIndex]).length,"span not resolved, but span index is setZ"),Object.assign(e,{paragraph:n,paragraphID:n.id}),!r||void 0!==e.span&&void 0!==e.spanID||Object.assign(e,{span:r,spanID:r.id})}}else{const{paragraphIndex:n,paragraph:r,spanIndex:o,span:i}=ko(t,e.paragraphID,e.spanID);console.assert(r,"paragraph not resolved"),console.assert(e.spanID&&i||void 0===e.spanID,"span not resolved, but span id is set"),Object.assign(e,{paragraphIndex:n,paragraph:r}),void 0!==e.span&&(e.span=i)}if(void 0===e.spanID&&void 0===e.spanIndex){if(e.node)return Object.assign(e,Do(t,e))}else if(void 0!==e.spanID&&void 0===e.spanIndex)Object.assign(e,ko(t,e.paragraphID,e.spanID)),console.assert(e.paragraph,"paragraph not resolved"),console.assert(void 0!==e.spanIndex&&e.span,"span not resolved, but span id is setY");else if(void 0===e.spanID&&void 0!==e.spanIndex){const{paragraph:n,span:r}=So(t,e.paragraphIndex,e.spanIndex),o=yo(n);e.spanIndex>=o.length&&o.length>0&&(e.spanIndex=o.length-1,e.offset=o[o.length-1].text.length),console.assert(e.paragraph,"paragraph not resolved"),console.assert(r||0===yo(t[e.paragraphIndex]).length,"span not resolved, but span index is set"),Object.assign(e,{paragraph:n,paragraphID:n.id,span:r,spanID:r&&r.id,spanIndex:r&&e.spanIndex})}if(null!=e.paragraphIndex&&-1!=e.paragraphIndex&&null!=e.spanIndex){const n=yo(t[e.paragraphIndex]);n.length>0&&(-1===e.spanIndex&&(e.spanIndex=n.length-1),e.offset<0&&(e.offset=n[e.spanIndex].text.length+1+e.offset))}return e}function Ao(t,e,n){console.assert(void 0!==t,"data not set"),console.assert(e.paragraphIndex>=0,"pointer paragraphIndex missing or invalid");const r=t;let o=e.paragraphIndex,i=e.spanIndex;if(void 0!==i&&-1!==i)if(i<yo(r[o]).length-1)i++;else{if(!(o<r.length-1))return;o++,i=yo(r[o]).length>0?0:void 0}else{if(!(o<r.length-1))return;o++,i=yo(r[o]).length>0?0:void 0}return void 0===n&&(n=0),Co(t,{paragraphIndex:o,spanIndex:i,offset:n})}const Eo=Object.freeze({Remove:1,InPlace:2,Copy:3});function Oo(t,e,n,r,o,i=Eo.Remove){null==e&&(e=0),(null==n||n<0)&&(n=0),(null==r||r>=t.length)&&(r=t.length-1);const s=t[r].text.length;if((void 0===o||o>s)&&(o=s),o<0&&(o=0),n>t[e].text.length&&(n=t[e].text.length),e===r){if(o<n&&(o=n),i===Eo.Remove){const r=t[e],i=r.text.substring(n,o);r.text=r.text.substring(0,n)+r.text.substring(o);const s=[];return i.length>0&&s.push(wo(r,{text:i})),{spans:s,splitIndex:e,splitOffset:n,removedSpanText:i}}if(i===Eo.InPlace){const r=t[e];if(0===n&&o>=r.text.length)return{spans:[r],splitIndex:e,splitOffset:n};if(n===o){if(0===n)return{right:r,spans:[],splitIndex:e,splitOffset:n};if(o>=r.text.length)return{left:r,spans:[],splitIndex:e+1,splitOffset:0};{let{left:o,right:i}=Io(r,n);return t.splice(e,1,...[o,i].filter((t=>t.text.length>0))),{left:o,right:i,spans:[],splitIndex:e+1,splitOffset:0}}}if(0===n){let{left:i,right:s}=Io(r,o);return t.splice(e,1,...[i,s].filter((t=>t.text.length>0))),{right:s,spans:[i],splitIndex:e,splitOffset:n}}if(o>=r.text.length){let{left:o,right:i}=Io(r,n);return t.splice(e,1,...[o,i].filter((t=>t.text.length>0))),{left:o,spans:[i],splitIndex:e+1,splitOffset:n}}let{left:i,right:s}=Io(r,n),{left:a,right:l}=Io(s,o-n);return t.splice(e,1,...[i,a,l].filter((t=>t.text.length>0))),{left:i,right:l,spans:[a],splitIndex:e+1,splitOffset:0}}if(i===Eo.Copy){const r=t[e],i=r.text.substring(n,o),s=[];return i.length>0&&s.push(wo(r,{text:i,group:r.id})),{spans:s,splitIndex:e,splitOffset:n}}}if(r===e+1&&0===o&&n>=t[e].text.length)return{spans:[],splitIndex:e,splitOffset:n};const a=0===n?e:e+1,l=o>=s?r:r-1;if(i===Eo.Remove){const i=t.splice(a,l+1-a);if(e<a){const r=t[e],{left:o,right:s}=Io(r,n);s.text.length>0&&i.unshift(wo(r,s)),Object.assign(r,o)}if(l<r){const e=t[a],{left:n,right:r}=Io(e,o);n.text.length>0&&i.push(wo(e,n)),Object.assign(e,r)}return{spans:i,splitIndex:e,splitOffset:n}}if(i===Eo.InPlace){const i=t.slice(a,l+1);if(l<r){const e=t[r];if(o>0&&o<e.text.length){console.log("end offset middle");const{left:n,right:s}=Io(e,o);t.splice(r,1,...[n,s].filter((t=>t.text.length>0))),i.push(n)}else o>0&&i.push(e)}if(e<a){const r=t[e];if(n>0&&n<r.text.length){console.log("start offset middle");const{left:o,right:s}=Io(r,n);i.unshift(s),t.splice(e,1,...[o,s].filter((t=>t.text.length>0))),e++}else 0===n?i.unshift(r):e++}return{spans:i,splitIndex:e,splitOffset:n}}if(i===Eo.Copy){const i=t.slice(a,l+1);if(e<a){const r=t[e],{left:o,right:s}=Io(r,n);s.text.length>0&&i.unshift(wo(r,s))}if(l<r){const e=t[r],{left:n,right:s}=Io(e,o);n.text.length>0&&i.push(wo(e,n))}return{spans:i,splitIndex:e,splitOffset:n}}}function To(t,e,n,r=Eo.Remove){const o=t,i=[];let s;for(let a=e.paragraphIndex;a<o.length&&a<=n.paragraphIndex;){const t=o[a];if(t.id===e.paragraphID&&(s=t),t.id===e.paragraphID&&t.id===n.paragraphID){if(yo(t).length>0){if(r===Eo.Remove){const o=Oo(yo(t),e.spanIndex,e.offset,n.spanIndex,n.offset,r);o.spans.length>0&&i.push({id:t.id,spans:o.spans,partial:e.spanIndex>0||e.offset>0||n.spanIndex<yo(t).length-1||yo(t).length>0&&n.offset<co(yo(t)).text.length})}else if(r===Eo.Copy){const o=Oo(yo(t),e.spanIndex,e.offset,n.spanIndex,n.offset,r);o.spans.length>0&&i.push({id:t.id,spans:o.spans,partial:e.spanIndex>0||e.offset>0||n.spanIndex<yo(t).length-1||n.offset<co(yo(t)).text.length})}else if(r===Eo.InPlace){const o=Oo(yo(t),e.spanIndex,e.offset,n.spanIndex,n.offset,r);o.spans.length>0&&i.push({id:t.id,spans:o.spans,partial:e.spanIndex>0||e.offset>0||n.spanIndex<yo(t).length-1||n.offset<co(yo(t)).text.length})}}else r===Eo.Remove?(o.splice(a,1),i.push(Object.assign({},t,{partial:!1}))):r===Eo.Copy?i.push(Object.assign({},t,{partial:!1})):r===Eo.InPlace&&(o.splice(a,1),i.push(t));break}if(t.id===e.paragraphID&&yo(t).length>0){const n=Oo(yo(t),e.spanIndex,e.offset,void 0,void 0,r);0===yo(t).length&&r===Eo.Remove?o.splice(a,1):a++,n.spans.length>0&&i.push({id:t.id,spans:n.spans,partial:yo(t).length>0})}else{if(t.id===n.paragraphID&&yo(t).length>0){const e=Oo(yo(t),0,0,n.spanIndex,n.offset,r);e.spans.length>0&&i.push({id:t.id,spans:e.spans,partial:yo(t).length>0}),yo(s).length>0&&r===Eo.Remove&&(yo(s).splice(yo(s).length,0,...yo(t)),o.splice(a,1));break}if(t.id===n.paragraphID){r===Eo.Remove&&o.splice(a,1),i.push(Object.assign({},t,{partial:!1}));break}r===Eo.Remove?o.splice(a,1):a++,i.push(Object.assign({},t,{partial:!1}))}}return i}function $o(t,e,n){const r=t,o=n;if(0===o.length)return;if(0===r.length){r.splice(0,0,...n);const e=co(n);return{start:Co(t,{paragraphIndex:0,spanIndex:0,offset:0}),end:Co(t,{paragraphIndex:n.length-1,spanIndex:e.spans.length-1,offset:co(e.spans).text.length})}}if(1===o.length){const n=yo(o[0]),i=r[e.paragraphIndex];let s,a;if(0===e.offset)yo(i).splice(e.spanIndex,0,...n),s=Co(t,{paragraphID:e.paragraphID,spanIndex:e.spanIndex,offset:0}),a=Co(t,{paragraphID:e.paragraphID,spanIndex:e.spanIndex+n.length-1,offset:-1});else if(e.offset===yo(i)[e.spanIndex].text.length)yo(i).splice(e.spanIndex+1,0,...n),s=Co(t,{paragraphID:e.paragraphID,spanIndex:e.spanIndex+1,offset:0}),a=Co(t,{paragraphID:e.paragraphID,spanIndex:e.spanIndex+1+n.length-1,offset:-1});else{const{left:r,right:o}=Io(yo(i)[e.spanIndex],e.offset);yo(i).splice(e.spanIndex+1,0,wo(yo(i)[e.spanIndex],o)),Object.assign(yo(i)[e.spanIndex],r),yo(i).splice(e.spanIndex+1,0,...n),s=Co(t,{paragraphID:e.paragraphID,spanIndex:e.spanIndex+1,offset:0}),a=Co(t,{paragraphID:e.paragraphID,spanIndex:e.spanIndex+1+n.length-1,offset:-1})}return{start:s,end:a,spans:n}}const i=r[e.paragraphIndex],s=xo();let a,l;if(null!=e.spanIndex&&-1!=e.spanIndex&&yo(i).length>0)if(0===e.offset){bo(s,yo(i).splice(e.spanIndex))}else if(e.offset===yo(i)[e.spanIndex].text.length){bo(s,yo(i).splice(e.spanIndex+1))}else{const t=yo(i).splice(e.spanIndex+1),{left:n,right:r}=Io(yo(i)[e.spanIndex],e.offset);bo(s,t),yo(s).unshift(wo(yo(i)[e.spanIndex],r)),Object.assign(yo(i)[e.spanIndex],n)}yo(o[0]).length>0&&(a={paragraphID:i.id,spanIndex:yo(r[e.paragraphIndex]).length,offset:0}),yo(r[e.paragraphIndex]).splice(yo(r[e.paragraphIndex]).length,0,...yo(o[0]));let c=e.paragraphIndex+1;o.length>2&&(r.splice(c,0,...o.slice(1,o.length-1)),c+=o.length-2),yo(s).splice(0,0,...yo(o[o.length-1])),r.splice(c,0,s),a||(a={paragraphIndex:e.paragraphIndex+1,spanIndex:0,offset:0}),l=Co(t,{paragraphID:s.id,spanIndex:yo(o[o.length-1]).length-1,offset:-1}),a=Co(t,a);return{start:a,end:l,spans:n.reduce(((t,e)=>t.concat(yo(e))),[])}}function Po(t,e){let n=0;for(const r of e)if(n<t.length&&t[n].id===r.id)t[n].text=r.text,n++;else{let e=!1;for(let o=n;o<t.length;o++)if(t[o].id===r.id){t.splice(n,o-n),t[n].text=r.text,n++,e=!0;break}e||(t.splice(n,0,r),n++)}return t.length>n&&t.splice(n),t}function*Ro(t,e,n){let r=void 0===e;for(const o of t)if(r||o.id!==e||(r=!0),r&&(yield o,void 0!==n&&o.id===n))return}const Mo={props:{modelValue:Object,time:Number,editable:{type:Boolean,default:!0},showConfidence:{type:Boolean,default:!1}},data:()=>({paragraphs:[],key:1}),mounted(){const t=function(t,e,n){let r;return{now(e,...o){if(r=null,!n)return t.apply(e,o)},debounced(o,...i){const s=n&&!r;clearTimeout(r),r=setTimeout((()=>{this.now(o,...i)}),e),s&&t.apply(o,i)}}}(this.applyViewChangesNow,200);this.applyViewChangesNow=(...e)=>t.now(this,...e),this.applyViewChanges=(...e)=>t.debounced(this,...e),this.$options.watch.modelValue.call(this,this.modelValue)},watch:{modelValue(t){this.paragraphs=t.paragraphs||[]}},methods:{reset(){console.debug("resetting"),this.key+=1},save(){this.$emit("update:modelValue",Object.assign({},this.modelValue,{paragraphs:this.paragraphs}))},download(t,e,n="text/plain"){let r=document.createElement("a");r.setAttribute("href",`data:${n};charset=utf-8,`+encodeURIComponent(e)),r.setAttribute("download",t),r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r)},asHTML(t){t||(t=this.paragraphs);const e=[];for(const n of t){let t=[];for(const e of n.spans){let n="span";e.format&&(e.format.bold?n="strong":e.format.italic?n="em":e.format.underline?n="u":e.format.subscript?n="sub":e.format.superscript&&(n="sup")),t.push(`<${n}>${e.text}</${n}>`)}t=t.join(""),n.bullet?e.push(`<li>${t}</li>`):e.push(`<p>${t}</p>`)}return e.join("\n")},exportWord(t="document.doc"){const e=`<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns="http://www.w3.org/TR/REC-html40">\n      <head><meta charset='utf-8'><title>RUTA exported document</title></head>\n      <body>${this.asHTML()}</body>\n      </html>`;this.download(t,e,"application/vnd.ms-word")},spanSelected(t,e){document.getSelection().isCollapsed&&this.$emit("update:time",t.time)},selectStart(t){},selectEnd(t){const e=this.paragraphs,n=po();Co(e,n.start);if(Co(e,n.end),n.collapsed)this.$emit("selected");else{const t=n.start.span.time,e=void 0!==n.end.span.time?n.end.span.time+n.end.span.duration||0:void 0;this.$emit("selected",{start:t,end:e})}},getSpanSelection(t){const e=this.paragraphs;return Co(e,(t=po(t)).start),Co(e,t.end),Array.from(function*(t,e,n){const r=t;let o=!1;for(const i of r){if(e||(o=!0),e&&i.id===e.paragraphID&&n&&i.id===n.paragraphID)return void(yield{paragraph:i,spans:Array.from(Ro(i.spans,e.spanID,n.spanID))});if(e&&i.id===e.paragraphID)o=!0,yield{paragraph:i,spans:Array.from(Ro(i.spans,e.spanID))};else{if(n&&i.id===n.paragraphID)return void(o&&(yield{paragraph:i,spans:Array.from(Ro(i.spans,void 0,n.spanID))}));o&&(yield{paragraph:i,spans:Array.from(i.spans)})}}}(this.paragraphs,t.start,t.end))},toggleStyleX(t,e){const n=po();if(!n.collapsed){const r=this.paragraphs;!function(t,e){Co(t,e.start),Co(t,e.end),e.start.offsetLeft=e.start.offset,0===e.start.spanIndex||e.start.spanIndex>0&&(e.start.leftSpanIndex=e.start.spanIndex-1,e.start.leftSpanID=yo(e.start.paragraph)[e.start.spanIndex-1].id),e.end.offsetRight=e.end.span.text.length-e.end.offset,e.end.spanIndex>=yo(e.end.paragraph).length||e.end.spanIndex<yo(e.end.paragraph).length-1&&(e.end.rightSpanIndex=e.end.spanIndex+1,e.end.rightSpanID=yo(e.end.paragraph)[e.end.spanIndex+1].id)}(r,n),this.toggleStyle(t,n),n.start.node=void 0,n.end.node=void 0,function(t,e){if(void 0!==e.start.offsetLeft){let t=0;const n=yo(e.start.paragraph);for(let r=void 0===e.start.leftSpanIndex?0:e.start.leftSpanIndex+1;r<n.length;r++){const o=n[r];if(e.start.offsetLeft>=t&&e.start.offsetLeft<=t+o.text.length){e.start.spanIndex=r,e.start.span=o,e.start.spanID=o.id,e.start.offset=e.start.offsetLeft-t;break}t+=o.text.length}}if(void 0!==e.end.offsetRight){let t=0;const n=yo(e.end.paragraph);if(void 0!==e.end.rightSpanID)for(let r=e.start.leftSpanIndex;r<n.length;r++)if(n[r].id===e.end.rightSpanID){e.end.rightSpanIndex=r;break}for(let r=void 0===e.end.rightSpanIndex?n.length-1:e.end.rightSpanIndex-1;r>=0;r--){const o=n[r];if(e.end.offsetRight>=t&&e.end.offsetRight<=t+o.text.length){e.end.spanIndex=r,e.end.span=o,e.end.spanID=o.id,e.end.offset=o.text.length-(e.end.offsetRight-t);break}t+=o.text.length}}delete e.start.offsetLeft,delete e.start.leftSpanIndex,delete e.start.leftSpanID,delete e.end.offsetRight,delete e.end.rightSpanIndex,delete e.end.rightSpanID}(0,n),this.$nextTick((()=>{e||this.$refs.container.focus(),mo(this.$refs.container,n.start,n.end)}))}},toggleStyle(t,e){const n=this.paragraphs;if(e||(e=po()),e.isCollapsed)return;const r=e.start;Co(n,r);const o=e.end;Co(n,o);const i=To(n,r,o,Eo.InPlace);let s,a,l=!0;for(const c of i)for(const e of c.spans)if(e.format&&e.format[t]){l=!1;break}"subscript"===t?(s="superscript",a=!1):"superscript"===t&&(s="subscript",a=!1);for(const c of i)for(const e of c.spans)Object.assign(e,{format:Object.assign(e.format||{},{[t]:l},s&&{[s]:a}||{}),id:fo()})},toggleBullet(){const t=document.getSelection(),e=this.getSpanSelection(t);let n=!0;for(const r of e)if(r.paragraph.bullet){n=!1;break}for(const r of e)r.paragraph.bullet=n},mapContainerOffsetPointerToData(t,e){if(!e.paragraphID){let n=0;for(const r of t)if(e.leftParagraphID&&r.id===e.leftParagraphID)n=0;else{for(const t of r.spans){if(n<=e.offset&&e.offset<n+t.text.length){e.paragraphID=r.id,e.paragraph=r,e.spanID=t.id,e.span=t,e.offset-=n;break}n+=t.text.length}if(e.offset===n&&r.spans.length>0){e.paragraphID=r.id;const t=r.spans[r.spans.length-1];e.spanID=t.id,e.span=t,e.offset=t.text.length}if(e.paragraphID)break}}if(e.paragraphID&&!e.spanID)for(const n of t){if(n.id!==e.paragraphID)continue;let t=0;for(const r of n.spans)if(e.leftSpanID&&r.id===e.leftSpanID)t=0;else{if(t<=e.offset&&e.offset<t+r.text.length){e.spanID=r.id,e.span=r,e.offset-=t;break}t+=r.text.length}if(e.offset===t&&n.spans.length>0){const t=n.spans[n.spans.length-1];e.spanID=t.id,e.span=t,e.offset=t.text.length}break}return e.node=void 0,Co(t,e),e},parseDOM(t){let e=this.paragraphs;const n=po(),r=Do(e,n.start),o=Do(e,n.end);r.spanID&&r.paragraphID||No(this.$refs.container,r),o.spanID&&o.paragraphID||No(this.$refs.container,o);const i=function(t){const e=(t,e)=>{let n=t;return void 0!==n&&(n=n.nodeValue),void 0!==n&&void 0!==e&&(n=e(n)),n},n=[];let r=!1;for(const o of t.childNodes)if(o.nodeType===Node.ELEMENT_NODE)if("DIV"===o.nodeName&&o.attributes["data-id"]){r=!0;const t=[],i={id:o.attributes["data-id"].nodeValue,spans:t};let s;n.push(i);const a=o;for(const n of a.childNodes)if(n.nodeType===Node.ELEMENT_NODE)if("SPAN"===n.nodeName&&n.attributes["data-id"]){const r=n.attributes["data-id"].nodeValue;let o=n.innerText;s&&s.length>0&&(o=s+o,s=void 0);const i=e(n.attributes["data-time"],parseInt),a=e(n.attributes["data-duration"],parseInt),l=e(n.attributes["data-confidence"],parseFloat);t.push({id:r,text:o,time:i,duration:a,confidence:l})}else n.nodeName;else n.nodeType===Node.TEXT_NODE&&(n.nodeValue.length>0&&(t.length>0?t[t.length-1].text+=n.nodeValue.length:s=n.nodeValue),n.nodeValue="");0===t.length&&s&&s.length>0&&t.push(_o(s))}else"BR"===o.nodeName?(console.log("br",o),r=!1,o.remove()):o.remove();else if(o.nodeType===Node.TEXT_NODE&&o.nodeValue.length>0){let t=n.length>0&&r&&n[n.length-1];t||(t={id:fo(),spans:[]},n.push(t)),t.spans.push({id:fo(),text:o.nodeValue}),o.remove()}return n}(this.$refs.container),s=function(t,e){let n=0;for(const r of e)if(n<t.length&&t[n].id===r.id)Po(yo(t[n]),yo(r)),n++;else{let e=!1;for(let o=n;o<t.length;o++)if(t[o].id===r.id){t.splice(n,o-n),t[n].text=r.text,n++,e=!0;break}e||(t.splice(n,0,r),n++)}return t.length>n&&t.splice(n),t}(this.paragraphs||[],i);return this.paragraphs=s,e=s,this.mapContainerOffsetPointerToData(e,r),this.mapContainerOffsetPointerToData(e,o),t&&this.$nextTick((()=>{mo(this.$refs.container,Co(e,r),n.collapsed?null:Co(e,o))})),{paragraphs:s,start:r,end:o,collapsed:n.collapsed}},applyViewChangesNow(t=!0){const{paragraphs:e,start:n,end:r,collapsed:o}=this.parseDOM(t);return this.save(),{start:n,end:r,collapsed:o}},onInput(t){this.applyViewChanges()},errorCaptured(t,e,n){console.debug("ERROR captured:",t,e,n)},async onKeydown(t){if((t.metaKey||t.ctrlKey)&&t.shiftKey&&t.altKey&&"KeyR"===t.code)return this.reset(),t.stopPropagation(),void t.preventDefault();if((t.metaKey||t.ctrlKey)&&"KeyZ"===t.code)return t.stopPropagation(),void t.preventDefault();if((t.metaKey||t.ctrlKey)&&("KeyC"===t.code||"KeyV"===t.code||"KeyX"===t.code||"KeyR"===t.code||"Meta"===t.key||"Control"===t.key))return;if("Escape"===t.code||"Tab"===t.code)return;if("ArrowLeft"===t.key||"ArrowRight"===t.key||"ArrowUp"===t.key||"ArrowDown"===t.key)return void t.shiftKey;if("Dead"===t.key)return;let e=document.getSelection();if(!e.isCollapsed&&!t.ctrlKey&&!t.metaKey&&"Alt"!=t.key&&"Shift"!=t.key){"Delete"!==t.key&&"Backspace"!==t.key&&"Enter"!==t.key||(t.stopPropagation(),t.preventDefault());const n=this.paragraphs;e=po(e);const r=e.start;Co(n,r);const o=e.end;return Co(n,o),o.paragraphID&&o.paragraphID.length>0&&void 0===o.spanID&&n[o.paragraphIndex].spans.length>0&&(o.spanIndex=0,o.offset=0,Co(n,o)),To(n,r,o),"Enter"===t.key?($o(n,r,[xo(),xo()]),void this.$nextTick((()=>{mo(this.$refs.container,vo(Ao(n,r),this.$refs.container))}))):void this.$nextTick((()=>{r.spanID=void 0,r.node=void 0,mo(this.$refs.container,Co(n,r))}))}if("KeyL"===t.code&&(!0===t.metaKey||!0===t.ctrlKey))return this.toggleBullet(),t.stopPropagation(),t.preventDefault(),!1;if(("KeyL"===t.code||"KeyB"===t.code||"KeyI"===t.code||"KeyU"===t.code||"Digit6"===t.code&&!0===t.shiftKey||"Minus"===t.code&&!0===t.shiftKey)&&(!0===t.ctrlKey||!0===t.metaKey)){let e;return"KeyB"===t.code?e="bold":"KeyI"===t.code?e="italic":"KeyU"===t.code?e="underline":"Digit6"===t.code?e="superscript":"Minus"===t.code&&(e="subscript"),this.toggleStyleX(e,!0),t.stopPropagation(),t.preventDefault(),!1}if("Enter"===t.key){if(t.stopPropagation(),t.preventDefault(),this.applyViewChangesNow(),!this.paragraphs)return this.paragraphs=[xo(),xo()],this.applyViewChangesNow(!1),void this.$nextTick((()=>{mo(this.$refs.container,vo(Co(this.paragraphs,{paragraphIndex:1,offset:0}),this.$refs.container))}));this.$nextTick((()=>{const t=this.paragraphs,e=po();e.collapsed&&(Co(t,e.start),$o(t,e.start,[xo(),xo()]),this.$nextTick((()=>{mo(this.$refs.container,vo(Ao(t,e.start),this.$refs.container))})))}))}else if("Backspace"===t.key){const{start:e,end:n,collapsed:r}=this.applyViewChangesNow();if(!r)return void console.debug("warning: range backspace had to be handler elsewhere");if(e.offset>0||e.spanIndex>0)return;t.stopPropagation(),t.preventDefault(),this.$nextTick((()=>{const t=this.paragraphs;this.paragraphs;const e=po().start;Co(t,e);const n=Co(t,{paragraphIndex:e.paragraphIndex,spanIndex:0,offset:0});if(e.paragraphIndex>0){const t=this.paragraphs,r=function(t,e,n){console.assert(void 0!==t,"data not set"),console.assert(e.paragraphIndex>=0,"pointer paragraphIndex missing or invalid");const r=t;let o=e.paragraphIndex,i=e.spanIndex;if(void 0!==i&&-1!==i)if(i>0)i--;else{if(!(o>0))return;o--,i=yo(r[o]).length>0?yo(r[o]).length-1:void 0}else{if(!(o>0))return;o--,i=yo(r[o]).length>0?yo(r[o]).length-1:void 0}return void 0===n&&(n=-1),Co(t,{paragraphIndex:o,spanIndex:i,offset:n})}(t,n),o=To(t,r,e),i=o.length>0&&o[0].id===r.paragraphID?e:r;this.$nextTick((()=>{i.node=void 0,mo(this.$refs.container,i)}))}}))}else if("Delete"===t.key){const{start:e,end:n,collapsed:r}=this.applyViewChangesNow();if(!r)return console.debug("warning: range deletes must be handled elsewhere"),t.stopPropagation(),void t.preventDefault();if(!e||e.spanIndex<e.paragraph.spans.length-1||e.span&&e.offset<e.span.text.length)return;t.stopPropagation(),t.preventDefault(),this.$nextTick((()=>{const t=this.paragraphs,n=this.paragraphs;if(r){const r=n[e.paragraphIndex].spans,o=Co(t,{paragraphIndex:e.paragraphIndex,spanIndex:r.length-1,offset:-1});if(e.paragraphIndex<n.length-1){const t=this.paragraphs;0===e.paragraph.spans.length?(t.splice(e.paragraphIndex,1),e.spanIndex=0,e.paragraphID=0):(To(t,e,Ao(t,o)),void 0===e.spanIndex&&void 0===e.spanID&&(e.spanIndex=0)),this.$nextTick((()=>{e.node=void 0,Co(t,e),mo(this.$refs.container,e)}))}}}))}else if((t.ctrlKey||t.metaKey)&&t.shiftKey&&"KeyH"===t.code){const e=this.getSpanSelection();for(const t of e)for(const e of t.spans)e.highlighted=!1;t.preventDefault(),t.stopPropagation()}else if((t.ctrlKey||t.metaKey)&&"KeyH"===t.code){const e=this.getSpanSelection();for(const t of e)for(const e of t.spans)e.highlighted=!0;t.preventDefault(),t.stopPropagation()}else e.isCollapsed||(console.debug("PREVENT RANGE REPLACE"),t.preventDefault(),t.stopPropagation());return!0},onDragStart(t){t.stopPropagation(),t.preventDefault()},onPaste(t){t.stopPropagation(),t.preventDefault();const{start:e,end:n,collapsed:r}=this.applyViewChangesNow(!1),o=t.clipboardData.getData("application/ruta"),i=t.clipboardData.getData("text/html"),s=t.clipboardData.getData("text/plain");if(0===o.length&&0===i.length&&0===s.length)return;const a=this.paragraphs;if(Co(a,e),r||(Co(a,n),To(a,e,n),e.spanID=void 0,e.node=void 0,Co(a,e),e.node=void 0),o.length>0){console.debug("pasting from RUTA");const t=JSON.parse(o);for(const e of t){e.id=fo();for(const t of e.spans)t.id=fo()}const n=$o(a,e,t);this.$nextTick((()=>{n.end.node=null,mo(this.$refs.container,Co(a,n.end))}))}else if(i.length>0){const t=document.createElement("html");t.innerHTML=i;const n=t.querySelector("head > style");if(n){document.implementation.createHTMLDocument("").body.appendChild(n)}const r=function(t,e){let n=[];if(e)for(const u of e)if(-1===u.selectorText.search(/[#:\[\]>]/g)&&"underline"===u.style.textDecorationLine){const t=u.selectorText.split(",");for(const e of t){const t=e.split(":")[0].split(".");t.shift(),n=t}}const r=[],o=[];let i,s,a={},l=t,c=0;for(;l;){const t=l.childNodes;for(s=t.length;c<s;c++){const e=t[c];if(e.nodeType===Node.TEXT_NODE&&e.nodeValue.length>0){if(0===e.nodeValue.trim().length)continue;i||(i={spans:[],id:fo()},o.push(i)),i.spans.push({text:e.nodeValue,format:Object.assign({},a),id:fo()})}else if(e.nodeType===Node.ELEMENT_NODE){Object.assign({},a);const t=Object.assign({},a);if("B"===e.nodeName||"STRONG"===e.nodeName)a.bold=!0;else if("I"===e.nodeName||"EM"===e.nodeName)a.italic=!0;else if("U"===e.nodeName)a.underline=!0;else if("SUP"===e.nodeName)a.superscript=!0;else if("SUB"===e.nodeName)a.subscript=!0;else if("SPAN"===e.nodeName){for(const r of e.classList)if(-1!==n.indexOf(r)){a.underline=!0;break}}else"P"===e.nodeName?(i={spans:[],id:fo()},o.push(i)):"LI"===e.nodeName&&(i={spans:[],id:fo(),bullet:!0},o.push(i));if(l.childNodes&&l.childNodes.length>0){r.push({node:l,i:c+1,fmt:Object.assign({},t)}),c=0,l=e,s=l.childNodes.length;break}}}if(c>=s){if(!(r.length>0)){l=null;break}{"P"!==l.nodeName&&"LI"!==l.nodeName||(i=void 0);const t=r.pop();c=t.i,l=t.node,a=t.fmt}}}return o}(t.querySelector("body"),n&&n.sheet.cssRules);for(const e of r){e.id=fo();for(const t of e.spans)t.id=fo()}console.debug("pasting formatted text from html source");const o=$o(a,e,r);this.$nextTick((()=>{o.end.node=null,mo(this.$refs.container,Co(a,o.end))}))}else s.length>0&&(console.debug("pasting plaintext"),this.$nextTick((()=>{void 0===e.paragraphIndex&&void 0===e.paragraphID||mo(this.$refs.container,Co(a,e));const t=[],n=s.split("\n");for(const e of n)t.push({id:fo(),spans:[{id:fo(),text:e,format:{}}]});let r;if(0===t.length)a.splice.apply(a,[0,0].concat(t)),r={paragraphID:t[t.length-1].id,spanID:t[t.length-1].spans[0].id,offset:t[t.length-1].spans[0].text.length};else{const n=$o(a,e,t);r=n.end}this.$nextTick((()=>{r.node=null,mo(this.$refs.container,Co(a,r))}))})))},onCut(t){this.onCopy(t);const e=po();if(!e.collapsed){const t=this.paragraphs,n=e.start;Co(t,n);const r=e.end;Co(t,r),To(t,n,r)}},onCopy(t){const e=this.paragraphs,n=po();if(!n.isCollapsed){const r=n.start;Co(e,r);const o=n.end;Co(e,o);const i=To(e,r,o,Eo.Copy);t.clipboardData.setData("application/ruta",JSON.stringify(i));const s=[];for(const t of i){const e=[];for(const n of t.spans)e.push(n.text);s.push(e.join(""))}t.clipboardData.setData("text/plain",s.join("\n")),t.clipboardData.setData("text/html",this.asHTML(i))}t.stopPropagation(),t.preventDefault()}},errorCaptured:(t,e,n)=>(console.debug("EDITOR ERROR CAPTURED",t,e,n),!0)},Vo=["contenteditable"],jo=["data-id","contenteditable","data-time"],Fo=["data-first","data-last","contenteditable","data-id","data-time","data-duration","data-confidence","onClick","title"];Mo.render=function(t,e,n,o,i,s){return sr(),ur("div",{style:{border:"1px solid #ccc"},contenteditable:n.editable,spellcheck:"false",key:i.key,onInput:e[0]||(e[0]=(...t)=>s.onInput&&s.onInput(...t)),onKeydown:e[1]||(e[1]=(...t)=>s.onKeydown&&s.onKeydown(...t)),onPaste:e[2]||(e[2]=(...t)=>s.onPaste&&s.onPaste(...t)),onCut:e[3]||(e[3]=(...t)=>s.onCut&&s.onCut(...t)),onCopy:e[4]||(e[4]=(...t)=>s.onCopy&&s.onCopy(...t)),onSelectstart:e[5]||(e[5]=(...t)=>s.selectStart&&s.selectStart(...t)),onMouseup:e[6]||(e[6]=(...t)=>s.selectEnd&&s.selectEnd(...t)),onDragstart:e[7]||(e[7]=(...t)=>s.onDragStart&&s.onDragStart(...t)),ref:"container",class:"transcript"},[(sr(!0),ur(tr,null,Dr(i.paragraphs,((t,e)=>(sr(),ur("div",{"data-id":t.id,key:t.id,contenteditable:n.editable,class:a([{"list-item":t.bullet},"paragraph"]),"data-time":t.spans.length>0?(t.spans[0].time/1e3).toFixed(2):""},[(sr(!0),ur(tr,null,Dr(t.spans,((e,o)=>(sr(),ur("span",{key:e.id,"data-first":0==o,"data-last":o>=t.spans.length-1,contenteditable:n.editable,"data-id":e.id,"data-time":e.time,"data-duration":e.duration,"data-confidence":e.confidence,class:a(["span token",{selected:e.time<=n.time&&n.time<e.time+e.duration,past:e.time+e.duration<=n.time,highlighted:e.highlighted,bold:e.format&&e.format.bold,italic:e.format&&e.format.italic,underline:e.format&&e.format.underline,superscript:e.format&&e.format.superscript,subscript:e.format&&e.format.subscript}]),onClick:t=>s.spanSelected(e,t),style:r(n.showConfidence?`opacity: ${Math.pow(e.confidence,.5)/2+.5};`:""),title:n.showConfidence?`Confidence: ${e.confidence}`:""},l(e.text),15,Fo)))),128))],10,jo)))),128))],40,Vo)},Mo.__scopeId="data-v-6532f2d2";var Lo={value:()=>{}};function Uo(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new Ko(r)}function Ko(t){this._=t}function Bo(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function Wo(t,e){for(var n,r=0,o=t.length;r<o;++r)if((n=t[r]).name===e)return n.value}function Ho(t,e,n){for(var r=0,o=t.length;r<o;++r)if(t[r].name===e){t[r]=Lo,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}Ko.prototype=Uo.prototype={constructor:Ko,on:function(t,e){var n,r=this._,o=Bo(t+"",r),i=-1,s=o.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++i<s;)if(n=(t=o[i]).type)r[n]=Ho(r[n],t.name,e);else if(null==e)for(n in r)r[n]=Ho(r[n],t.name,null);return this}for(;++i<s;)if((n=(t=o[i]).type)&&(n=Wo(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Ko(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,o=new Array(n),i=0;i<n;++i)o[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=0,n=(r=this._[t]).length;i<n;++i)r[i].value.apply(e,o)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],o=0,i=r.length;o<i;++o)r[o].value.apply(e,n)}};var Xo="http://www.w3.org/1999/xhtml",qo={svg:"http://www.w3.org/2000/svg",xhtml:Xo,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function zo(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),qo.hasOwnProperty(e)?{space:qo[e],local:t}:t}function Yo(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Xo&&e.documentElement.namespaceURI===Xo?e.createElement(t):e.createElementNS(n,t)}}function Go(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Jo(t){var e=zo(t);return(e.local?Go:Yo)(e)}function Zo(){}function Qo(t){return null==t?Zo:function(){return this.querySelector(t)}}function ti(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}function ei(){return[]}function ni(t){return null==t?ei:function(){return this.querySelectorAll(t)}}function ri(t){return function(){return this.matches(t)}}function oi(t){return function(e){return e.matches(t)}}var ii=Array.prototype.find;function si(){return this.firstElementChild}var ai=Array.prototype.filter;function li(){return Array.from(this.children)}function ci(t){return new Array(t.length)}function ui(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function fi(t){return function(){return t}}function di(t,e,n,r,o,i){for(var s,a=0,l=e.length,c=i.length;a<c;++a)(s=e[a])?(s.__data__=i[a],r[a]=s):n[a]=new ui(t,i[a]);for(;a<l;++a)(s=e[a])&&(o[a]=s)}function pi(t,e,n,r,o,i,s){var a,l,c,u=new Map,f=e.length,d=i.length,p=new Array(f);for(a=0;a<f;++a)(l=e[a])&&(p[a]=c=s.call(l,l.__data__,a,e)+"",u.has(c)?o[a]=l:u.set(c,l));for(a=0;a<d;++a)c=s.call(t,i[a],a,i)+"",(l=u.get(c))?(r[a]=l,l.__data__=i[a],u.delete(c)):n[a]=new ui(t,i[a]);for(a=0;a<f;++a)(l=e[a])&&u.get(p[a])===l&&(o[a]=l)}function hi(t){return t.__data__}function gi(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function vi(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function mi(t){return function(){this.removeAttribute(t)}}function yi(t){return function(){this.removeAttributeNS(t.space,t.local)}}function bi(t,e){return function(){this.setAttribute(t,e)}}function _i(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function xi(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function wi(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Ii(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function ki(t){return function(){this.style.removeProperty(t)}}function Si(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Di(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function Ni(t,e){return t.style.getPropertyValue(e)||Ii(t).getComputedStyle(t,null).getPropertyValue(e)}function Ci(t){return function(){delete this[t]}}function Ai(t,e){return function(){this[t]=e}}function Ei(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function Oi(t){return t.trim().split(/^|\s+/)}function Ti(t){return t.classList||new $i(t)}function $i(t){this._node=t,this._names=Oi(t.getAttribute("class")||"")}function Pi(t,e){for(var n=Ti(t),r=-1,o=e.length;++r<o;)n.add(e[r])}function Ri(t,e){for(var n=Ti(t),r=-1,o=e.length;++r<o;)n.remove(e[r])}function Mi(t){return function(){Pi(this,t)}}function Vi(t){return function(){Ri(this,t)}}function ji(t,e){return function(){(e.apply(this,arguments)?Pi:Ri)(this,t)}}function Fi(){this.textContent=""}function Li(t){return function(){this.textContent=t}}function Ui(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function Ki(){this.innerHTML=""}function Bi(t){return function(){this.innerHTML=t}}function Wi(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function Hi(){this.nextSibling&&this.parentNode.appendChild(this)}function Xi(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function qi(){return null}function zi(){var t=this.parentNode;t&&t.removeChild(this)}function Yi(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Gi(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Ji(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function Zi(t){return function(){var e=this.__on;if(e){for(var n,r=0,o=-1,i=e.length;r<i;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++o]=n:this.removeEventListener(n.type,n.listener,n.options);++o?e.length=o:delete this.__on}}}function Qi(t,e,n){return function(){var r,o=this.__on,i=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(o)for(var s=0,a=o.length;s<a;++s)if((r=o[s]).type===t.type&&r.name===t.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=i,r.options=n),void(r.value=e);this.addEventListener(t.type,i,n),r={type:t.type,name:t.name,value:e,listener:i,options:n},o?o.push(r):this.__on=[r]}}function ts(t,e,n){var r=Ii(t),o=r.CustomEvent;"function"==typeof o?o=new o(e,n):(o=r.document.createEvent("Event"),n?(o.initEvent(e,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(e,!1,!1)),t.dispatchEvent(o)}function es(t,e){return function(){return ts(this,t,e)}}function ns(t,e){return function(){return ts(this,t,e.apply(this,arguments))}}ui.prototype={constructor:ui,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}},$i.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var rs=[null];function os(t,e){this._groups=t,this._parents=e}function is(){return new os([[document.documentElement]],rs)}function ss(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function as(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function ls(){}os.prototype=is.prototype={constructor:os,select:function(t){"function"!=typeof t&&(t=Qo(t));for(var e=this._groups,n=e.length,r=new Array(n),o=0;o<n;++o)for(var i,s,a=e[o],l=a.length,c=r[o]=new Array(l),u=0;u<l;++u)(i=a[u])&&(s=t.call(i,i.__data__,u,a))&&("__data__"in i&&(s.__data__=i.__data__),c[u]=s);return new os(r,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return ti(t.apply(this,arguments))}}(t):ni(t);for(var e=this._groups,n=e.length,r=[],o=[],i=0;i<n;++i)for(var s,a=e[i],l=a.length,c=0;c<l;++c)(s=a[c])&&(r.push(t.call(s,s.__data__,c,a)),o.push(s));return new os(r,o)},selectChild:function(t){return this.select(null==t?si:function(t){return function(){return ii.call(this.children,t)}}("function"==typeof t?t:oi(t)))},selectChildren:function(t){return this.selectAll(null==t?li:function(t){return function(){return ai.call(this.children,t)}}("function"==typeof t?t:oi(t)))},filter:function(t){"function"!=typeof t&&(t=ri(t));for(var e=this._groups,n=e.length,r=new Array(n),o=0;o<n;++o)for(var i,s=e[o],a=s.length,l=r[o]=[],c=0;c<a;++c)(i=s[c])&&t.call(i,i.__data__,c,s)&&l.push(i);return new os(r,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,hi);var n=e?pi:di,r=this._parents,o=this._groups;"function"!=typeof t&&(t=fi(t));for(var i=o.length,s=new Array(i),a=new Array(i),l=new Array(i),c=0;c<i;++c){var u=r[c],f=o[c],d=f.length,p=gi(t.call(u,u&&u.__data__,c,r)),h=p.length,g=a[c]=new Array(h),v=s[c]=new Array(h),m=l[c]=new Array(d);n(u,f,g,v,m,p,e);for(var y,b,_=0,x=0;_<h;++_)if(y=g[_]){for(_>=x&&(x=_+1);!(b=v[x])&&++x<h;);y._next=b||null}}return(s=new os(s,r))._enter=a,s._exit=l,s},enter:function(){return new os(this._enter||this._groups.map(ci),this._parents)},exit:function(){return new os(this._exit||this._groups.map(ci),this._parents)},join:function(t,e,n){var r=this.enter(),o=this,i=this.exit();return"function"==typeof t?(r=t(r))&&(r=r.selection()):r=r.append(t+""),null!=e&&(o=e(o))&&(o=o.selection()),null==n?i.remove():n(i),r&&o?r.merge(o).order():o},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,o=n.length,i=r.length,s=Math.min(o,i),a=new Array(o),l=0;l<s;++l)for(var c,u=n[l],f=r[l],d=u.length,p=a[l]=new Array(d),h=0;h<d;++h)(c=u[h]||f[h])&&(p[h]=c);for(;l<o;++l)a[l]=n[l];return new os(a,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,o=t[e],i=o.length-1,s=o[i];--i>=0;)(r=o[i])&&(s&&4^r.compareDocumentPosition(s)&&s.parentNode.insertBefore(r,s),s=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=vi);for(var n=this._groups,r=n.length,o=new Array(r),i=0;i<r;++i){for(var s,a=n[i],l=a.length,c=o[i]=new Array(l),u=0;u<l;++u)(s=a[u])&&(c[u]=s);c.sort(e)}return new os(o,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],o=0,i=r.length;o<i;++o){var s=r[o];if(s)return s}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var o,i=e[n],s=0,a=i.length;s<a;++s)(o=i[s])&&t.call(o,o.__data__,s,i);return this},attr:function(t,e){var n=zo(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?yi:mi:"function"==typeof e?n.local?wi:xi:n.local?_i:bi)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?ki:"function"==typeof e?Di:Si)(t,e,null==n?"":n)):Ni(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?Ci:"function"==typeof e?Ei:Ai)(t,e)):this.node()[t]},classed:function(t,e){var n=Oi(t+"");if(arguments.length<2){for(var r=Ti(this.node()),o=-1,i=n.length;++o<i;)if(!r.contains(n[o]))return!1;return!0}return this.each(("function"==typeof e?ji:e?Mi:Vi)(n,e))},text:function(t){return arguments.length?this.each(null==t?Fi:("function"==typeof t?Ui:Li)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?Ki:("function"==typeof t?Wi:Bi)(t)):this.node().innerHTML},raise:function(){return this.each(Hi)},lower:function(){return this.each(Xi)},append:function(t){var e="function"==typeof t?t:Jo(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:Jo(t),r=null==e?qi:"function"==typeof e?e:Qo(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(zi)},clone:function(t){return this.select(t?Gi:Yi)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,o,i=Ji(t+""),s=i.length;if(!(arguments.length<2)){for(a=e?Qi:Zi,r=0;r<s;++r)this.each(a(i[r],e,n));return this}var a=this.node().__on;if(a)for(var l,c=0,u=a.length;c<u;++c)for(r=0,l=a[c];r<s;++r)if((o=i[r]).type===l.type&&o.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?ns:es)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r,o=t[e],i=0,s=o.length;i<s;++i)(r=o[i])&&(yield r)}};var cs=1/.7,us="\\s*([+-]?\\d+)\\s*",fs="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",ds="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ps=/^#([0-9a-f]{3,8})$/,hs=new RegExp("^rgb\\("+[us,us,us]+"\\)$"),gs=new RegExp("^rgb\\("+[ds,ds,ds]+"\\)$"),vs=new RegExp("^rgba\\("+[us,us,us,fs]+"\\)$"),ms=new RegExp("^rgba\\("+[ds,ds,ds,fs]+"\\)$"),ys=new RegExp("^hsl\\("+[fs,ds,ds]+"\\)$"),bs=new RegExp("^hsla\\("+[fs,ds,ds,fs]+"\\)$"),_s={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function xs(){return this.rgb().formatHex()}function ws(){return this.rgb().formatRgb()}function Is(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=ps.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?ks(e):3===n?new Cs(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?Ss(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?Ss(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=hs.exec(t))?new Cs(e[1],e[2],e[3],1):(e=gs.exec(t))?new Cs(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=vs.exec(t))?Ss(e[1],e[2],e[3],e[4]):(e=ms.exec(t))?Ss(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=ys.exec(t))?Ts(e[1],e[2]/100,e[3]/100,1):(e=bs.exec(t))?Ts(e[1],e[2]/100,e[3]/100,e[4]):_s.hasOwnProperty(t)?ks(_s[t]):"transparent"===t?new Cs(NaN,NaN,NaN,0):null}function ks(t){return new Cs(t>>16&255,t>>8&255,255&t,1)}function Ss(t,e,n,r){return r<=0&&(t=e=n=NaN),new Cs(t,e,n,r)}function Ds(t){return t instanceof ls||(t=Is(t)),t?new Cs((t=t.rgb()).r,t.g,t.b,t.opacity):new Cs}function Ns(t,e,n,r){return 1===arguments.length?Ds(t):new Cs(t,e,n,null==r?1:r)}function Cs(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function As(){return"#"+Os(this.r)+Os(this.g)+Os(this.b)}function Es(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function Os(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function Ts(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Ps(t,e,n,r)}function $s(t){if(t instanceof Ps)return new Ps(t.h,t.s,t.l,t.opacity);if(t instanceof ls||(t=Is(t)),!t)return new Ps;if(t instanceof Ps)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,o=Math.min(e,n,r),i=Math.max(e,n,r),s=NaN,a=i-o,l=(i+o)/2;return a?(s=e===i?(n-r)/a+6*(n<r):n===i?(r-e)/a+2:(e-n)/a+4,a/=l<.5?i+o:2-i-o,s*=60):a=l>0&&l<1?0:s,new Ps(s,a,l,t.opacity)}function Ps(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Rs(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}ss(ls,Is,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:xs,formatHex:xs,formatHsl:function(){return $s(this).formatHsl()},formatRgb:ws,toString:ws}),ss(Cs,Ns,as(ls,{brighter:function(t){return t=null==t?cs:Math.pow(cs,t),new Cs(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Cs(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:As,formatHex:As,formatRgb:Es,toString:Es})),ss(Ps,(function(t,e,n,r){return 1===arguments.length?$s(t):new Ps(t,e,n,null==r?1:r)}),as(ls,{brighter:function(t){return t=null==t?cs:Math.pow(cs,t),new Ps(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Ps(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,o=2*n-r;return new Cs(Rs(t>=240?t-240:t+120,o,r),Rs(t,o,r),Rs(t<120?t+240:t-120,o,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var Ms=t=>()=>t;function Vs(t){return 1==(t=+t)?js:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):Ms(isNaN(e)?n:e)}}function js(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):Ms(isNaN(t)?e:t)}var Fs=function t(e){var n=Vs(e);function r(t,e){var r=n((t=Ns(t)).r,(e=Ns(e)).r),o=n(t.g,e.g),i=n(t.b,e.b),s=js(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=o(e),t.b=i(e),t.opacity=s(e),t+""}}return r.gamma=t,r}(1);function Ls(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var Us=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ks=new RegExp(Us.source,"g");function Bs(t,e){var n,r,o,i=Us.lastIndex=Ks.lastIndex=0,s=-1,a=[],l=[];for(t+="",e+="";(n=Us.exec(t))&&(r=Ks.exec(e));)(o=r.index)>i&&(o=e.slice(i,o),a[s]?a[s]+=o:a[++s]=o),(n=n[0])===(r=r[0])?a[s]?a[s]+=r:a[++s]=r:(a[++s]=null,l.push({i:s,x:Ls(n,r)})),i=Ks.lastIndex;return i<e.length&&(o=e.slice(i),a[s]?a[s]+=o:a[++s]=o),a.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var n,r=0;r<e;++r)a[(n=l[r]).i]=n.x(t);return a.join("")})}var Ws,Hs=180/Math.PI,Xs={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function qs(t,e,n,r,o,i){var s,a,l;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(l=t*n+e*r)&&(n-=t*l,r-=e*l),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,l/=a),t*r<e*n&&(t=-t,e=-e,l=-l,s=-s),{translateX:o,translateY:i,rotate:Math.atan2(e,t)*Hs,skewX:Math.atan(l)*Hs,scaleX:s,scaleY:a}}function zs(t,e,n,r){function o(t){return t.length?t.pop()+" ":""}return function(i,s){var a=[],l=[];return i=t(i),s=t(s),function(t,r,o,i,s,a){if(t!==o||r!==i){var l=s.push("translate(",null,e,null,n);a.push({i:l-4,x:Ls(t,o)},{i:l-2,x:Ls(r,i)})}else(o||i)&&s.push("translate("+o+e+i+n)}(i.translateX,i.translateY,s.translateX,s.translateY,a,l),function(t,e,n,i){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),i.push({i:n.push(o(n)+"rotate(",null,r)-2,x:Ls(t,e)})):e&&n.push(o(n)+"rotate("+e+r)}(i.rotate,s.rotate,a,l),function(t,e,n,i){t!==e?i.push({i:n.push(o(n)+"skewX(",null,r)-2,x:Ls(t,e)}):e&&n.push(o(n)+"skewX("+e+r)}(i.skewX,s.skewX,a,l),function(t,e,n,r,i,s){if(t!==n||e!==r){var a=i.push(o(i)+"scale(",null,",",null,")");s.push({i:a-4,x:Ls(t,n)},{i:a-2,x:Ls(e,r)})}else 1===n&&1===r||i.push(o(i)+"scale("+n+","+r+")")}(i.scaleX,i.scaleY,s.scaleX,s.scaleY,a,l),i=s=null,function(t){for(var e,n=-1,r=l.length;++n<r;)a[(e=l[n]).i]=e.x(t);return a.join("")}}}var Ys,Gs,Js=zs((function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Xs:qs(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),Zs=zs((function(t){return null==t?Xs:(Ws||(Ws=document.createElementNS("http://www.w3.org/2000/svg","g")),Ws.setAttribute("transform",t),(t=Ws.transform.baseVal.consolidate())?qs((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):Xs)}),", ",")",")"),Qs=0,ta=0,ea=0,na=0,ra=0,oa=0,ia="object"==typeof performance&&performance.now?performance:Date,sa="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function aa(){return ra||(sa(la),ra=ia.now()+oa)}function la(){ra=0}function ca(){this._call=this._time=this._next=null}function ua(t,e,n){var r=new ca;return r.restart(t,e,n),r}function fa(){ra=(na=ia.now())+oa,Qs=ta=0;try{!function(){aa(),++Qs;for(var t,e=Ys;e;)(t=ra-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Qs}()}finally{Qs=0,function(){var t,e,n=Ys,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Ys=e);Gs=t,pa(r)}(),ra=0}}function da(){var t=ia.now(),e=t-na;e>1e3&&(oa-=e,na=t)}function pa(t){Qs||(ta&&(ta=clearTimeout(ta)),t-ra>24?(t<1/0&&(ta=setTimeout(fa,t-ia.now()-oa)),ea&&(ea=clearInterval(ea))):(ea||(na=ia.now(),ea=setInterval(da,1e3)),Qs=1,sa(fa)))}function ha(t,e,n){var r=new ca;return e=null==e?0:+e,r.restart((n=>{r.stop(),t(n+e)}),e,n),r}ca.prototype=ua.prototype={constructor:ca,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?aa():+n)+(null==e?0:+e),this._next||Gs===this||(Gs?Gs._next=this:Ys=this,Gs=this),this._call=t,this._time=n,pa()},stop:function(){this._call&&(this._call=null,this._time=1/0,pa())}};var ga=Uo("start","end","cancel","interrupt"),va=[];function ma(t,e,n,r,o,i){var s=t.__transition;if(s){if(n in s)return}else t.__transition={};!function(t,e,n){var r,o=t.__transition;function i(t){n.state=1,n.timer.restart(s,n.delay,n.time),n.delay<=t&&s(t-n.delay)}function s(i){var c,u,f,d;if(1!==n.state)return l();for(c in o)if((d=o[c]).name===n.name){if(3===d.state)return ha(s);4===d.state?(d.state=6,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete o[c]):+c<e&&(d.state=6,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete o[c])}if(ha((function(){3===n.state&&(n.state=4,n.timer.restart(a,n.delay,n.time),a(i))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(f=n.tween.length),c=0,u=-1;c<f;++c)(d=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(r[++u]=d);r.length=u+1}}function a(e){for(var o=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(l),n.state=5,1),i=-1,s=r.length;++i<s;)r[i].call(t,o);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),l())}function l(){for(var r in n.state=6,n.timer.stop(),delete o[e],o)return;delete t.__transition}o[e]=n,n.timer=ua(i,0,n.time)}(t,n,{name:e,index:r,group:o,on:ga,tween:va,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:0})}function ya(t,e){var n=_a(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function ba(t,e){var n=_a(t,e);if(n.state>3)throw new Error("too late; already running");return n}function _a(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function xa(t,e){var n,r;return function(){var o=ba(this,t),i=o.tween;if(i!==n)for(var s=0,a=(r=n=i).length;s<a;++s)if(r[s].name===e){(r=r.slice()).splice(s,1);break}o.tween=r}}function wa(t,e,n){var r,o;if("function"!=typeof n)throw new Error;return function(){var i=ba(this,t),s=i.tween;if(s!==r){o=(r=s).slice();for(var a={name:e,value:n},l=0,c=o.length;l<c;++l)if(o[l].name===e){o[l]=a;break}l===c&&o.push(a)}i.tween=o}}function Ia(t,e,n){var r=t._id;return t.each((function(){var t=ba(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return _a(t,r).value[e]}}function ka(t,e){var n;return("number"==typeof e?Ls:e instanceof Is?Fs:(n=Is(e))?(e=n,Fs):Bs)(t,e)}function Sa(t){return function(){this.removeAttribute(t)}}function Da(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Na(t,e,n){var r,o,i=n+"";return function(){var s=this.getAttribute(t);return s===i?null:s===r?o:o=e(r=s,n)}}function Ca(t,e,n){var r,o,i=n+"";return function(){var s=this.getAttributeNS(t.space,t.local);return s===i?null:s===r?o:o=e(r=s,n)}}function Aa(t,e,n){var r,o,i;return function(){var s,a,l=n(this);if(null!=l)return(s=this.getAttribute(t))===(a=l+"")?null:s===r&&a===o?i:(o=a,i=e(r=s,l));this.removeAttribute(t)}}function Ea(t,e,n){var r,o,i;return function(){var s,a,l=n(this);if(null!=l)return(s=this.getAttributeNS(t.space,t.local))===(a=l+"")?null:s===r&&a===o?i:(o=a,i=e(r=s,l));this.removeAttributeNS(t.space,t.local)}}function Oa(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Ta(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function $a(t,e){var n,r;function o(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&Ta(t,o)),n}return o._value=e,o}function Pa(t,e){var n,r;function o(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&Oa(t,o)),n}return o._value=e,o}function Ra(t,e){return function(){ya(this,t).delay=+e.apply(this,arguments)}}function Ma(t,e){return e=+e,function(){ya(this,t).delay=e}}function Va(t,e){return function(){ba(this,t).duration=+e.apply(this,arguments)}}function ja(t,e){return e=+e,function(){ba(this,t).duration=e}}function Fa(t,e){if("function"!=typeof e)throw new Error;return function(){ba(this,t).ease=e}}function La(t,e,n){var r,o,i=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?ya:ba;return function(){var s=i(this,t),a=s.on;a!==r&&(o=(r=a).copy()).on(e,n),s.on=o}}var Ua=is.prototype.constructor;function Ka(t){return function(){this.style.removeProperty(t)}}function Ba(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function Wa(t,e,n){var r,o;function i(){var i=e.apply(this,arguments);return i!==o&&(r=(o=i)&&Ba(t,i,n)),r}return i._value=e,i}function Ha(t){return function(e){this.textContent=t.call(this,e)}}function Xa(t){var e,n;function r(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&Ha(r)),e}return r._value=t,r}var qa=0;function za(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function Ya(){return++qa}var Ga=is.prototype;za.prototype={constructor:za,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=Qo(t));for(var r=this._groups,o=r.length,i=new Array(o),s=0;s<o;++s)for(var a,l,c=r[s],u=c.length,f=i[s]=new Array(u),d=0;d<u;++d)(a=c[d])&&(l=t.call(a,a.__data__,d,c))&&("__data__"in a&&(l.__data__=a.__data__),f[d]=l,ma(f[d],e,n,d,f,_a(a,n)));return new za(i,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=ni(t));for(var r=this._groups,o=r.length,i=[],s=[],a=0;a<o;++a)for(var l,c=r[a],u=c.length,f=0;f<u;++f)if(l=c[f]){for(var d,p=t.call(l,l.__data__,f,c),h=_a(l,n),g=0,v=p.length;g<v;++g)(d=p[g])&&ma(d,e,n,g,p,h);i.push(p),s.push(l)}return new za(i,s,e,n)},selectChild:Ga.selectChild,selectChildren:Ga.selectChildren,filter:function(t){"function"!=typeof t&&(t=ri(t));for(var e=this._groups,n=e.length,r=new Array(n),o=0;o<n;++o)for(var i,s=e[o],a=s.length,l=r[o]=[],c=0;c<a;++c)(i=s[c])&&t.call(i,i.__data__,c,s)&&l.push(i);return new za(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,o=n.length,i=Math.min(r,o),s=new Array(r),a=0;a<i;++a)for(var l,c=e[a],u=n[a],f=c.length,d=s[a]=new Array(f),p=0;p<f;++p)(l=c[p]||u[p])&&(d[p]=l);for(;a<r;++a)s[a]=e[a];return new za(s,this._parents,this._name,this._id)},selection:function(){return new Ua(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=Ya(),r=this._groups,o=r.length,i=0;i<o;++i)for(var s,a=r[i],l=a.length,c=0;c<l;++c)if(s=a[c]){var u=_a(s,e);ma(s,t,n,c,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new za(r,this._parents,t,n)},call:Ga.call,nodes:Ga.nodes,node:Ga.node,size:Ga.size,empty:Ga.empty,each:Ga.each,on:function(t,e){var n=this._id;return arguments.length<2?_a(this.node(),n).on.on(t):this.each(La(n,t,e))},attr:function(t,e){var n=zo(t),r="transform"===n?Zs:ka;return this.attrTween(t,"function"==typeof e?(n.local?Ea:Aa)(n,r,Ia(this,"attr."+t,e)):null==e?(n.local?Da:Sa)(n):(n.local?Ca:Na)(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=zo(t);return this.tween(n,(r.local?$a:Pa)(r,e))},style:function(t,e,n){var r="transform"==(t+="")?Js:ka;return null==e?this.styleTween(t,function(t,e){var n,r,o;return function(){var i=Ni(this,t),s=(this.style.removeProperty(t),Ni(this,t));return i===s?null:i===n&&s===r?o:o=e(n=i,r=s)}}(t,r)).on("end.style."+t,Ka(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var r,o,i;return function(){var s=Ni(this,t),a=n(this),l=a+"";return null==a&&(this.style.removeProperty(t),l=a=Ni(this,t)),s===l?null:s===r&&l===o?i:(o=l,i=e(r=s,a))}}(t,r,Ia(this,"style."+t,e))).each(function(t,e){var n,r,o,i,s="style."+e,a="end."+s;return function(){var l=ba(this,t),c=l.on,u=null==l.value[s]?i||(i=Ka(e)):void 0;c===n&&o===u||(r=(n=c).copy()).on(a,o=u),l.on=r}}(this._id,t)):this.styleTween(t,function(t,e,n){var r,o,i=n+"";return function(){var s=Ni(this,t);return s===i?null:s===r?o:o=e(r=s,n)}}(t,r,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,Wa(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(Ia(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,Xa(t))},remove:function(){return this.on("end.remove",(t=this._id,function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}));var t},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,o=_a(this.node(),n).tween,i=0,s=o.length;i<s;++i)if((r=o[i]).name===t)return r.value;return null}return this.each((null==e?xa:wa)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Ra:Ma)(e,t)):_a(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Va:ja)(e,t)):_a(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(Fa(e,t)):_a(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw new Error;ba(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,r=n._id,o=n.size();return new Promise((function(i,s){var a={value:s},l={value:function(){0==--o&&i()}};n.each((function(){var n=ba(this,r),o=n.on;o!==t&&((e=(t=o).copy())._.cancel.push(a),e._.interrupt.push(a),e._.end.push(l)),n.on=e})),0===o&&i()}))},[Symbol.iterator]:Ga[Symbol.iterator]};var Ja={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function Za(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}is.prototype.interrupt=function(t){return this.each((function(){!function(t,e){var n,r,o,i=t.__transition,s=!0;if(i){for(o in e=null==e?null:e+"",i)(n=i[o]).name===e?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete i[o]):s=!1;s&&delete t.__transition}}(this,t)}))},is.prototype.transition=function(t){var e,n;t instanceof za?(e=t._id,t=t._name):(e=Ya(),(n=Ja).time=aa(),t=null==t?null:t+"");for(var r=this._groups,o=r.length,i=0;i<o;++i)for(var s,a=r[i],l=a.length,c=0;c<l;++c)(s=a[c])&&ma(s,t,e,c,a,n||Za(s,e));return new za(r,this._parents,t,e)};const Qa={props:{modelValue:[Int16Array,Int32Array,Array],time:Number,duration:Number,selection:Object},data:()=>({waveform:void 0,svg:void 0,data:void 0}),async mounted(){this.$options.watch.modelValue.call(this,this.modelValue),this.resizeCheckInterval=setInterval((()=>{null==this.currentWidth||null==this.currentHeight||!this.$refs.svg||this.currentWidth==this.$refs.svg.clientWidth&&this.currentHeight==this.$refs.svg.clientHeight||this.draw()}),2e3)},watch:{modelValue(t){if(t)if(t instanceof Int16Array){const e=new Float32Array(t);this.data=e.map((t=>t/32768))}else t instanceof Float32Array||t instanceof Array&&t.length>0&&"number"==typeof t[0]&&t[0]>=-1&&t[0]<=1?this.data=t:this.data=void 0;else this.data=void 0;this.draw()},time(t){}},methods:{click(t){const e=t.offsetX/this.$refs.svg.clientWidth*this.duration;this.$emit("update:time",e)},draw(t,e){const n=this.data;t=t||this.$refs.svg.clientWidth,e=e||this.$refs.svg.clientHeight,this.currentWidth=t,this.currentHeight=e;const r="string"==typeof(o=this.$refs.svg)?new os([[document.querySelector(o)]],[document.documentElement]):new os([[o]],rs);var o;if(!n)return void r.selectAll("*").remove();r.attr("height",e).attr("width",t);const i=function(t,e){var n=Math.round(t.length/e),r=[];const o=Math.min(n,1e3);for(var i=0;i<e;i++){for(var s=0,a=0,l=0;l<o&&!(i*n+l>=t.length);l++){var c=t[i*n+l];c>0?s+=c:a+=c}r.push([a/o,s/o])}return r}(n,1200);let s=0;for(const c of i)s+=-c[0]+c[1];s/=2*i.length;const a=.1*e/s,l=t/i.length;r.selectAll("rect").data(i).attr("x",(function(e,n){return n/i.length*t})).attr("y",(function(t,n){return.5*e-a*t[1]})).attr("width",l).attr("height",(function(t){return a*(t[1]-t[0])})).enter().append("rect").style("stroke","#342a40").style("stroke-width","0").style("fill","rgba(0,0,0,0.3)").attr("x",(function(e,n){return n/i.length*t})).attr("y",(function(t,n){return.5*e-a*t[1]})).attr("width",l).attr("height",(function(t){return a*(t[1]-t[0])})).exit().remove()}}},tl={ref:"svg",style:{"-border":"1px solid red",width:"100%",height:"100%"}};Qa.render=function(t,e,n,o,i,s){return sr(),ur("div",{onClick:e[0]||(e[0]=(...t)=>s.click&&s.click(...t))},[(sr(),ur("svg",tl,null,512)),n.selection?(sr(),ur("div",{key:0,style:r([{position:"absolute",top:"0px",height:"100%",left:"0px","background-color":"#fffb","pointer-events":"none","border-left":"1px solid blue","border-right":"1px solid blue"},{left:n.selection.start/n.duration*100+"%",width:(n.selection.end-n.selection.start)/n.duration*100+"%"}])},null,4)):xr("",!0),mr("div",{style:r([{position:"absolute",top:"0px",height:"100%",width:"0px",border:"1px solid red",left:"0px"},{left:n.time/n.duration*100+"%"}]),ref:"head"},null,4)])},Qa.__scopeId="data-v-af4cf048";class el{constructor(t){this.init(t)}init(t){this.close(),this.context=new AudioContext,this.context.onstatechange=t?()=>{t(this)}:()=>{t&&t||this.onstatechange(this)}}close(){this.context&&(this.context.close(),this.context=void 0)}resume(){this.context.resume()}get suspended(){return"suspended"===this.context.state}onstatechange(t){console.log("audio context state changed:",t.context.state)}async decodeAudioFileData(t){const e=await this.decodeAudioFileBuffer(t),n=this.bufferData(e);return{data:this.Float32ArrayToInt16Array(n),sampleRate:e.sampleRate,length:e.length,duration:e.duration,numberOfChannels:e.numberOfChannels}}async fetchAndDecodeAudioFile(t){const e=await this.fetchAudioFileAndDecode(t),n=this.bufferData(e);return{data:this.Float32ArrayToInt16Array(n),sampleRate:e.sampleRate,length:e.length,duration:e.duration,numberOfChannels:e.numberOfChannels}}async fetchAudioFileAndDecode(t){const e=await fetch(t);return await this.decodeAudioFileBuffer(await e.arrayBuffer())}async decodeAudioFileBuffer(t){const e=this.context;return await e.decodeAudioData(t)}Float32ArrayToInt16Array(t){return Int16Array.from(t.map((t=>32768*t)))}bufferData(t,{channel:e=0}={}){return t.getChannelData(e)}}var nl={components:{TranscriptEditor:Mo,Waveform:Qa},props:{transcript:{type:Object,default:{paragraphs:{}}},duration:{type:Number},url:{type:String},name:{},waveform:[Int16Array,Int32Array,Array,String],previewVideo:{type:Boolean,default:!0},onSave:{type:Function,default:async()=>console.log("onSave not implemented")},editable:{type:Boolean,default:!0}},data:()=>({position:0,selected:void 0,playing:!1,loaded:!1,isVideo:!1,_url:void 0,_duration:void 0,_waveform:void 0,pending_waveform:void 0,pending_duration:void 0,video_duration:void 0,saving:!1,version:0,lastSavedVersion:0,autoSave:!1,autoSaveInterval:null,decoderSuspended:!1,decodingAudio:!1,showConfidence:!1}),async mounted(){this.$options.watch.waveform.call(this,this.waveform),this.autoSaveInterval=window.setInterval(this.saveAuto,5e3),window.addEventListener("keydown",this.onGlobalKeydown),this.decoder=new el((t=>{this.decoderSuspended=this.decoder.suspended,this.decoder.suspended&&console.log("audio decoder suspended")})),this.decoderSuspended=this.decoder.suspended},beforeUnmount(){this.autoSaveInterval&&window.clearInterval(this.autoSaveInterval),window.removeEventListener("keydown",this.onGlobalKeydown)},watch:{position(t){},transcript:{handler(t,e){},deep:!0},duration(t){this._duration=t},url(t){this._url=t},async waveform(t){if("string"==typeof t){const{data:e,duration:n}=await this.decodeAudioWaveform(t);this._waveform=e}else if(t instanceof File){const{data:e,duration:n}=await this.decoder.decodeAudioFileData(await t.arrayBuffer());this._waveform=e}else this._waveform=t}},computed:{synced(){return this.lastSavedVersion===this.version}},methods:{msToTime:function(t,{ms:e=!1,hours:n=!0}={}){if(null==t||isNaN(t))return`${n?"--:":""}--:--${e?".---":""}`;function r(t,e){return("00"+t).slice(-(e=e||2))}var o=t%1e3,i=(t=(t-o)/1e3)%60,s=(t=(t-i)/60)%60,a=(t-s)/60;return(a||n?r(a)+":":"")+r(s)+":"+r(i)+(e?"."+r(o,3):"")},toggleAutoSave(){this.autoSave=!this.autoSave},async save(){if(this.onSave&&this.editable){const t=this.version;this.saving=!0,await this.onSave(this.transcript),console.log("saved",this.transcript),this.lastSavedVersion=t,this.saving=!1}},saveAuto(){this.autoSave&&this.save()},async decodeAudioWaveform(t){try{return this.decodingAudio=!0,this.decoder.suspended&&await this.decoder.resume(),t instanceof File?await this.decoder.decodeAudioFileData(await t.arrayBuffer()):await this.decoder.fetchAndDecodeAudioFile(t)}catch(e){throw e}finally{this.decodingAudio=!1}},async load({url:t,waveform:e,duration:n}){"string"==typeof e||e instanceof File?this.pending_waveform=(async()=>{const{data:t,duration:n}=await this.decodeAudioWaveform(e);return t})():null===e?this._waveform=[]:void 0!==e&&(this.pending_waveform=(async()=>e)()),n&&(this.pending_duration=n),void 0!==t?(this._url=t,t&&0!==t.length||(this.video_duration=void 0)):this.pending_waveform&&(this._waveform=await this.pending_waveform,this.pending_waveform=void 0)},waveformLoading(){this._waveform=void 0,this.loaded=!1},onPlay(){this.playing=!0,this.animationFrameID=requestAnimationFrame(this.updatePosition)},onPause(){this.playing=!1,this.animationFrameID&&(cancelAnimationFrame(this.animationFrameID),this.animationFrameID=void 0)},onEnded(){this.onPause()},updatePosition(t){this.position=1e3*this.$refs.video.currentTime,this.animationFrameID=requestAnimationFrame(this.updatePosition)},durationChanged(){const t=this.$refs.video;this._duration=1e3*t.duration,this.video_duration=1e3*t.duration},async onDataLoaded(){const t=this.$refs.video;t&&(this.isVideo=t.videoWidth>0&&t.videoHeight>0),this.pending_duration&&(this.pending_duration=void 0),this.pending_waveform&&(this._waveform=await this.pending_waveform,this.pending_waveform=void 0),this.loaded=!0},onEmpty(){this.loaded=!1,this.isVideo=!1},onGlobalKeydown(t){"s"!==t.key||!0!==t.ctrlKey&&!0!==t.metaKey||(t.preventDefault(),this.save()),("Space"===t.code&&!0===t.ctrlKey||"Escape"==t.code)&&(t.preventDefault(),this.$refs.video.paused?this.$refs.video.play():this.$refs.video.pause())},transcriptUpdated(t){this.version+=1},setPosition(t){void 0!==t&&(this.$refs.video.currentTime=t/1e3,this.$emit("setPosition",t))},timeUpdate(t){this.position=1e3*this.$refs.video.currentTime},toggleShowConfidence(){this.showConfidence=!this.showConfidence}}};const rl=t=>(Le="data-v-b1db3c7a",t=t(),Le=null,t),ol={class:"editor-wrapper"},il={key:0,class:"header"},sl={class:"btn-group me-2",role:"group"},al={key:0,class:"spinner-border spinner-border-sm",role:"status"},ll={key:1,class:"bi bi-check-lg",title:"Saglabāts"},cl={key:2,class:"bi bi-asterisk",title:"Ir nesaglabātas izmaiņas"},ul=_r(" Saglabāt "),fl=_r(" 5s "),dl={class:"btn-group me-2",role:"group"},pl=[rl((()=>mr("i",{class:"bi bi-type-bold"},null,-1)))],hl=[rl((()=>mr("i",{class:"bi bi-type-italic"},null,-1)))],gl=[rl((()=>mr("i",{class:"bi bi-type-underline"},null,-1)))],vl=[rl((()=>mr("i",{class:"bi"},[_r("x"),mr("sup",null,"2")],-1)))],ml=[rl((()=>mr("i",{class:"bi"},[_r("x"),mr("sub",null,"2")],-1)))],yl=[rl((()=>mr("i",{class:"bi bi-list-ul"},null,-1)))],bl={class:"footer"},_l=["src"],xl={class:"waveform-and-buttons"},wl={key:1,class:"waveform-loading"},Il=[rl((()=>mr("div",{class:"text-center",style:{position:"relative",top:"calc(50% - 1rem)"}},[mr("div",{class:"spinner-grow",role:"status"}),mr("div",{style:{position:"relative",display:"inline-block",top:"-0.5rem",left:"0.5rem"}}," Loading... ")],-1)))],kl={class:"controls"},Sl={key:0,class:"btn-group pe-2",role:"group"},Dl=[rl((()=>mr("i",{class:"bi bi-play-fill"},null,-1)))],Nl=[rl((()=>mr("i",{class:"bi bi-pause-fill"},null,-1)))],Cl={style:{"font-variant-numeric":"tabular-nums"}};async function Al(t){const e=await async function(t){const e=new AudioContext,n=await e.decodeAudioData(t);return e.close(),n}(t),n=function(t,{channel:e=0}={}){return t.getChannelData(e)}(e);return{data:(r=n,Int16Array.from(r.map((t=>32768*t)))),sampleRate:e.sampleRate,length:e.length,duration:e.duration,numberOfChannels:e.numberOfChannels};var r}nl.render=function(t,e,n,r,o,i){const s=Jn("TranscriptEditor"),c=Jn("Waveform");return sr(),ur("div",ol,[Nr(t.$slots,"default",{},void 0,!0),this.editable?(sr(),ur("div",il,[mr("div",sl,[mr("button",{class:"btn btn-outline-primary",onClick:e[0]||(e[0]=t=>i.save())},[o.saving?(sr(),ur("div",al)):i.synced?(sr(),ur("i",ll)):(sr(),ur("i",cl)),ul]),mr("button",{class:a("btn "+(o.autoSave?"btn-primary":"btn-outline-primary")),onClick:e[1]||(e[1]=(...t)=>i.toggleAutoSave&&i.toggleAutoSave(...t)),title:"Automātiski sagalabāt katras 5s"},[mr("i",{class:a("bi bi-toggle-"+(o.autoSave?"on":"off"))},null,2),fl],2)]),mr("div",dl,[mr("button",{class:"btn btn-outline-primary",onClick:e[2]||(e[2]=e=>t.$refs.transcript.toggleStyleX("bold"))},pl),mr("button",{class:"btn btn-outline-primary",onClick:e[3]||(e[3]=e=>t.$refs.transcript.toggleStyleX("italic"))},hl),mr("button",{class:"btn btn-outline-primary",onClick:e[4]||(e[4]=e=>t.$refs.transcript.toggleStyleX("underline"))},gl),mr("button",{class:"btn btn-outline-primary",onClick:e[5]||(e[5]=e=>t.$refs.transcript.toggleStyleX("superscript"))},vl),mr("button",{class:"btn btn-outline-primary",onClick:e[6]||(e[6]=e=>t.$refs.transcript.toggleStyleX("subscript"))},ml),mr("button",{class:"btn btn-outline-primary",onClick:e[7]||(e[7]=e=>t.$refs.transcript.toggleBullet())},yl)])])):xr("",!0),yr(s,{class:"main transcript-editor",ref:"transcript",modelValue:n.transcript,"onUpdate:modelValue":[e[8]||(e[8]=t=>n.transcript=t),i.transcriptUpdated],time:o.position,"onUpdate:time":i.setPosition,onSelected:e[9]||(e[9]=t=>o.selected=t),editable:n.editable,"show-confidence":this.showConfidence},null,8,["modelValue","onUpdate:modelValue","time","onUpdate:time","editable","show-confidence"]),mr("div",bl,[mr("div",{class:a(["media-panel",{video:o.isVideo&&n.previewVideo}])},[mr("video",{playsinline:"",src:o._url,ref:"video",onTimeupdate:e[10]||(e[10]=(...t)=>i.timeUpdate&&i.timeUpdate(...t)),onLoadeddata:e[11]||(e[11]=(...t)=>i.onDataLoaded&&i.onDataLoaded(...t)),onLoadstart:e[12]||(e[12]=(...t)=>i.onDataLoaded&&i.onDataLoaded(...t)),onEmptied:e[13]||(e[13]=(...t)=>i.onEmpty&&i.onEmpty(...t)),onDurationchange:e[14]||(e[14]=(...t)=>i.durationChanged&&i.durationChanged(...t)),onPlay:e[15]||(e[15]=(...t)=>i.onPlay&&i.onPlay(...t)),onPause:e[16]||(e[16]=(...t)=>i.onPause&&i.onPause(...t)),onEnded:e[17]||(e[17]=(...t)=>i.onEnded&&i.onEnded(...t))},null,40,_l),mr("div",xl,[mr("div",null,[null!=o._waveform?(sr(),fr(c,{key:0,class:"waveform",modelValue:o._waveform,"onUpdate:modelValue":e[18]||(e[18]=t=>o._waveform=t),time:o.position,"onUpdate:time":[e[19]||(e[19]=t=>o.position=t),i.setPosition],duration:o._duration,selection:o.selected},null,8,["modelValue","time","onUpdate:time","duration","selection"])):(sr(),ur("div",wl,Il))]),mr("div",kl,[o.loaded?(sr(),ur("div",Sl,[o.playing?(sr(),ur("button",{key:1,class:"btn btn-primary",onClick:e[21]||(e[21]=e=>t.$refs.video.pause())},Nl)):(sr(),ur("button",{key:0,class:"btn btn-primary",onClick:e[20]||(e[20]=e=>t.$refs.video.play())},Dl))])):xr("",!0),mr("span",Cl,l(i.msToTime(o.position))+" / "+l(i.msToTime(o.video_duration)),1)])])],2)])])},nl.__scopeId="data-v-b1db3c7a";var El={components:{Editor:nl},props:{},data:()=>({transcript:{},waveform:[],duration:0,url:void 0}),async mounted(){},unmounted(){this.url&&this.url.length>0&&this.url.startsWith("blob:")&&URL.revokeObjectURL(this.url)},watch:{},methods:{async load({audio:t,transcript:e,file:n,waveform:r}){if(null!=r&&r instanceof ArrayBuffer){r=(await Al(r)).data}if("string"==typeof t){this.$refs.editor.waveformLoading(),this.url&&this.url.length>0&&this.url.startsWith("blob:")&&URL.revokeObjectURL(this.url);const e=t;void 0===r&&(r=t),this.$refs.editor.load({url:e,waveform:r})}else if(t instanceof File){this.$refs.editor.waveformLoading(),this.url&&this.url.length>0&&this.url.startsWith("blob:")&&URL.revokeObjectURL(this.url);const e=URL.createObjectURL(t);void 0===r&&(r=t),this.$refs.editor.load({url:e,waveform:r})}else if(t instanceof ArrayBuffer){this.$refs.editor.waveformLoading();const e=URL.createObjectURL(n||new Blob([t])),o=await Al(t);void 0===r&&(r=o.data),this.$refs.editor.load({url:e,waveform:r,duration:1e3*o.duration})}else null===t?(this.url&&this.url.length>0&&this.url.startsWith("blob:")&&URL.revokeObjectURL(this.url),void 0===r&&(r=null),this.$refs.editor.load({url:"",waveform:r,duration:0})):r&&this.$refs.editor.load({waveform:r});if(e)if("string"==typeof e){const t=await fetch(e);this.transcript=await t.json()}else e instanceof File?this.transcript=JSON.parse(await e.text()):this.transcript=e},async onSetPosition(t){console.debug("on set position:",t)},async onSave(t){console.log("on save transcript:",t)},async save(t){console.log("save transcript not implemented, transcript:",t)}}};El.render=function(t,e,n,r,o,i){const s=Jn("Editor");return sr(),fr(s,{class:"",transcript:o.transcript,waveform:o.waveform,duration:o.duration,url:o.url,onSave:i.onSave,onSetPosition:i.onSetPosition,ref:"editor"},null,8,["transcript","waveform","duration","url","onSave","onSetPosition"])};function Ol(t="#app"){return lo(El).mount(t)}export default Ol;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicnV0YS5lcy5qcyIsInNvdXJjZXMiOlsiLi4vLi4vbm9kZV9tb2R1bGVzL0B2dWUvc2hhcmVkL2Rpc3Qvc2hhcmVkLmVzbS1idW5kbGVyLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL0B2dWUvcmVhY3Rpdml0eS9kaXN0L3JlYWN0aXZpdHkuZXNtLWJ1bmRsZXIuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvQHZ1ZS9ydW50aW1lLWNvcmUvZGlzdC9ydW50aW1lLWNvcmUuZXNtLWJ1bmRsZXIuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvQHZ1ZS9ydW50aW1lLWRvbS9kaXN0L3J1bnRpbWUtZG9tLmVzbS1idW5kbGVyLmpzIiwiLi4vLi4vc3JjL2NvbXBvbmVudHMvZWRpdG9yLmpzIiwiLi4vLi4vc3JjL2NvbXBvbmVudHMvVHJhbnNjcmlwdEVkaXRvci52dWUiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtZGlzcGF0Y2gvc3JjL2Rpc3BhdGNoLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvbmFtZXNwYWNlcy5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9kMy1zZWxlY3Rpb24vc3JjL25hbWVzcGFjZS5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9kMy1zZWxlY3Rpb24vc3JjL2NyZWF0b3IuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtc2VsZWN0aW9uL3NyYy9zZWxlY3Rvci5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9kMy1zZWxlY3Rpb24vc3JjL2FycmF5LmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvc2VsZWN0b3JBbGwuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtc2VsZWN0aW9uL3NyYy9tYXRjaGVyLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvc2VsZWN0aW9uL3NlbGVjdENoaWxkLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvc2VsZWN0aW9uL3NlbGVjdENoaWxkcmVuLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvc2VsZWN0aW9uL3NwYXJzZS5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9kMy1zZWxlY3Rpb24vc3JjL3NlbGVjdGlvbi9lbnRlci5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9kMy1zZWxlY3Rpb24vc3JjL2NvbnN0YW50LmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvc2VsZWN0aW9uL2RhdGEuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtc2VsZWN0aW9uL3NyYy9zZWxlY3Rpb24vc29ydC5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9kMy1zZWxlY3Rpb24vc3JjL3NlbGVjdGlvbi9hdHRyLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvd2luZG93LmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvc2VsZWN0aW9uL3N0eWxlLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvc2VsZWN0aW9uL3Byb3BlcnR5LmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvc2VsZWN0aW9uL2NsYXNzZWQuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtc2VsZWN0aW9uL3NyYy9zZWxlY3Rpb24vdGV4dC5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9kMy1zZWxlY3Rpb24vc3JjL3NlbGVjdGlvbi9odG1sLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvc2VsZWN0aW9uL3JhaXNlLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvc2VsZWN0aW9uL2xvd2VyLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvc2VsZWN0aW9uL2luc2VydC5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9kMy1zZWxlY3Rpb24vc3JjL3NlbGVjdGlvbi9yZW1vdmUuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtc2VsZWN0aW9uL3NyYy9zZWxlY3Rpb24vY2xvbmUuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtc2VsZWN0aW9uL3NyYy9zZWxlY3Rpb24vb24uanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtc2VsZWN0aW9uL3NyYy9zZWxlY3Rpb24vZGlzcGF0Y2guanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtc2VsZWN0aW9uL3NyYy9zZWxlY3Rpb24vaW5kZXguanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtY29sb3Ivc3JjL2RlZmluZS5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9kMy1jb2xvci9zcmMvY29sb3IuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtc2VsZWN0aW9uL3NyYy9zZWxlY3Rpb24vc2VsZWN0LmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvc2VsZWN0aW9uL3NlbGVjdEFsbC5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9kMy1zZWxlY3Rpb24vc3JjL3NlbGVjdGlvbi9maWx0ZXIuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtc2VsZWN0aW9uL3NyYy9zZWxlY3Rpb24vZXhpdC5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9kMy1zZWxlY3Rpb24vc3JjL3NlbGVjdGlvbi9qb2luLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvc2VsZWN0aW9uL21lcmdlLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvc2VsZWN0aW9uL29yZGVyLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvc2VsZWN0aW9uL2NhbGwuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtc2VsZWN0aW9uL3NyYy9zZWxlY3Rpb24vbm9kZXMuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtc2VsZWN0aW9uL3NyYy9zZWxlY3Rpb24vbm9kZS5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9kMy1zZWxlY3Rpb24vc3JjL3NlbGVjdGlvbi9zaXplLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvc2VsZWN0aW9uL2VtcHR5LmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvc2VsZWN0aW9uL2VhY2guanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtc2VsZWN0aW9uL3NyYy9zZWxlY3Rpb24vYXBwZW5kLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvc2VsZWN0aW9uL2RhdHVtLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvc2VsZWN0aW9uL2l0ZXJhdG9yLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLWludGVycG9sYXRlL3NyYy9jb25zdGFudC5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9kMy1pbnRlcnBvbGF0ZS9zcmMvY29sb3IuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtaW50ZXJwb2xhdGUvc3JjL3JnYi5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9kMy1pbnRlcnBvbGF0ZS9zcmMvbnVtYmVyLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLWludGVycG9sYXRlL3NyYy9zdHJpbmcuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtaW50ZXJwb2xhdGUvc3JjL3RyYW5zZm9ybS9kZWNvbXBvc2UuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtaW50ZXJwb2xhdGUvc3JjL3RyYW5zZm9ybS9wYXJzZS5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9kMy1pbnRlcnBvbGF0ZS9zcmMvdHJhbnNmb3JtL2luZGV4LmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXRpbWVyL3NyYy90aW1lci5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9kMy10aW1lci9zcmMvdGltZW91dC5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9kMy10cmFuc2l0aW9uL3NyYy90cmFuc2l0aW9uL3NjaGVkdWxlLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXRyYW5zaXRpb24vc3JjL3RyYW5zaXRpb24vdHdlZW4uanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtdHJhbnNpdGlvbi9zcmMvdHJhbnNpdGlvbi9pbnRlcnBvbGF0ZS5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9kMy10cmFuc2l0aW9uL3NyYy90cmFuc2l0aW9uL2F0dHIuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtdHJhbnNpdGlvbi9zcmMvdHJhbnNpdGlvbi9hdHRyVHdlZW4uanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtdHJhbnNpdGlvbi9zcmMvdHJhbnNpdGlvbi9kZWxheS5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9kMy10cmFuc2l0aW9uL3NyYy90cmFuc2l0aW9uL2R1cmF0aW9uLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXRyYW5zaXRpb24vc3JjL3RyYW5zaXRpb24vZWFzZS5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9kMy10cmFuc2l0aW9uL3NyYy90cmFuc2l0aW9uL29uLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXRyYW5zaXRpb24vc3JjL3RyYW5zaXRpb24vc2VsZWN0aW9uLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXRyYW5zaXRpb24vc3JjL3RyYW5zaXRpb24vc3R5bGUuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtdHJhbnNpdGlvbi9zcmMvdHJhbnNpdGlvbi9zdHlsZVR3ZWVuLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXRyYW5zaXRpb24vc3JjL3RyYW5zaXRpb24vdGV4dFR3ZWVuLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXRyYW5zaXRpb24vc3JjL3RyYW5zaXRpb24vaW5kZXguanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtdHJhbnNpdGlvbi9zcmMvdHJhbnNpdGlvbi9zZWxlY3QuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtdHJhbnNpdGlvbi9zcmMvdHJhbnNpdGlvbi9zZWxlY3RBbGwuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtdHJhbnNpdGlvbi9zcmMvdHJhbnNpdGlvbi9maWx0ZXIuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtdHJhbnNpdGlvbi9zcmMvdHJhbnNpdGlvbi9tZXJnZS5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9kMy10cmFuc2l0aW9uL3NyYy90cmFuc2l0aW9uL3RyYW5zaXRpb24uanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtdHJhbnNpdGlvbi9zcmMvdHJhbnNpdGlvbi90ZXh0LmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXRyYW5zaXRpb24vc3JjL3RyYW5zaXRpb24vcmVtb3ZlLmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXRyYW5zaXRpb24vc3JjL3RyYW5zaXRpb24vZWFzZVZhcnlpbmcuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtdHJhbnNpdGlvbi9zcmMvdHJhbnNpdGlvbi9lbmQuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtdHJhbnNpdGlvbi9zcmMvc2VsZWN0aW9uL3RyYW5zaXRpb24uanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtZWFzZS9zcmMvY3ViaWMuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtdHJhbnNpdGlvbi9zcmMvc2VsZWN0aW9uL2luZGV4LmpzIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXRyYW5zaXRpb24vc3JjL3NlbGVjdGlvbi9pbnRlcnJ1cHQuanMiLCIuLi8uLi9ub2RlX21vZHVsZXMvZDMtdHJhbnNpdGlvbi9zcmMvaW50ZXJydXB0LmpzIiwiLi4vLi4vc3JjL2NvbXBvbmVudHMvV2F2ZWZvcm0udnVlIiwiLi4vLi4vbm9kZV9tb2R1bGVzL2QzLXNlbGVjdGlvbi9zcmMvc2VsZWN0LmpzIiwiLi4vLi4vc3JjL2NvbXBvbmVudHMvYXVkaW8uanMiLCIuLi8uLi9zcmMvY29tcG9uZW50cy9FZGl0b3IudnVlIiwiLi4vLi4vc3JjL2NvbXBvbmVudHMvdXRpbHMuanMiLCIuLi8uLi9zcmMvYXVkaW8uanMiLCIuLi8uLi9zcmMvRWRpdG9yV2l0aE1lZGlhTG9hZGVyLnZ1ZSIsIi4uLy4uL3NyYy9saWIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIE1ha2UgYSBtYXAgYW5kIHJldHVybiBhIGZ1bmN0aW9uIGZvciBjaGVja2luZyBpZiBhIGtleVxyXG4gKiBpcyBpbiB0aGF0IG1hcC5cclxuICogSU1QT1JUQU5UOiBhbGwgY2FsbHMgb2YgdGhpcyBmdW5jdGlvbiBtdXN0IGJlIHByZWZpeGVkIHdpdGhcclxuICogXFwvXFwqI1xcX1xcX1BVUkVcXF9cXF9cXCpcXC9cclxuICogU28gdGhhdCByb2xsdXAgY2FuIHRyZWUtc2hha2UgdGhlbSBpZiBuZWNlc3NhcnkuXHJcbiAqL1xyXG5mdW5jdGlvbiBtYWtlTWFwKHN0ciwgZXhwZWN0c0xvd2VyQ2FzZSkge1xyXG4gICAgY29uc3QgbWFwID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcclxuICAgIGNvbnN0IGxpc3QgPSBzdHIuc3BsaXQoJywnKTtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIG1hcFtsaXN0W2ldXSA9IHRydWU7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZXhwZWN0c0xvd2VyQ2FzZSA/IHZhbCA9PiAhIW1hcFt2YWwudG9Mb3dlckNhc2UoKV0gOiB2YWwgPT4gISFtYXBbdmFsXTtcclxufVxuXG4vKipcclxuICogZGV2IG9ubHkgZmxhZyAtPiBuYW1lIG1hcHBpbmdcclxuICovXHJcbmNvbnN0IFBhdGNoRmxhZ05hbWVzID0ge1xyXG4gICAgWzEgLyogVEVYVCAqL106IGBURVhUYCxcclxuICAgIFsyIC8qIENMQVNTICovXTogYENMQVNTYCxcclxuICAgIFs0IC8qIFNUWUxFICovXTogYFNUWUxFYCxcclxuICAgIFs4IC8qIFBST1BTICovXTogYFBST1BTYCxcclxuICAgIFsxNiAvKiBGVUxMX1BST1BTICovXTogYEZVTExfUFJPUFNgLFxyXG4gICAgWzMyIC8qIEhZRFJBVEVfRVZFTlRTICovXTogYEhZRFJBVEVfRVZFTlRTYCxcclxuICAgIFs2NCAvKiBTVEFCTEVfRlJBR01FTlQgKi9dOiBgU1RBQkxFX0ZSQUdNRU5UYCxcclxuICAgIFsxMjggLyogS0VZRURfRlJBR01FTlQgKi9dOiBgS0VZRURfRlJBR01FTlRgLFxyXG4gICAgWzI1NiAvKiBVTktFWUVEX0ZSQUdNRU5UICovXTogYFVOS0VZRURfRlJBR01FTlRgLFxyXG4gICAgWzUxMiAvKiBORUVEX1BBVENIICovXTogYE5FRURfUEFUQ0hgLFxyXG4gICAgWzEwMjQgLyogRFlOQU1JQ19TTE9UUyAqL106IGBEWU5BTUlDX1NMT1RTYCxcclxuICAgIFsyMDQ4IC8qIERFVl9ST09UX0ZSQUdNRU5UICovXTogYERFVl9ST09UX0ZSQUdNRU5UYCxcclxuICAgIFstMSAvKiBIT0lTVEVEICovXTogYEhPSVNURURgLFxyXG4gICAgWy0yIC8qIEJBSUwgKi9dOiBgQkFJTGBcclxufTtcblxuLyoqXHJcbiAqIERldiBvbmx5XHJcbiAqL1xyXG5jb25zdCBzbG90RmxhZ3NUZXh0ID0ge1xyXG4gICAgWzEgLyogU1RBQkxFICovXTogJ1NUQUJMRScsXHJcbiAgICBbMiAvKiBEWU5BTUlDICovXTogJ0RZTkFNSUMnLFxyXG4gICAgWzMgLyogRk9SV0FSREVEICovXTogJ0ZPUldBUkRFRCdcclxufTtcblxuY29uc3QgR0xPQkFMU19XSElURV9MSVNURUQgPSAnSW5maW5pdHksdW5kZWZpbmVkLE5hTixpc0Zpbml0ZSxpc05hTixwYXJzZUZsb2F0LHBhcnNlSW50LGRlY29kZVVSSSwnICtcclxuICAgICdkZWNvZGVVUklDb21wb25lbnQsZW5jb2RlVVJJLGVuY29kZVVSSUNvbXBvbmVudCxNYXRoLE51bWJlcixEYXRlLEFycmF5LCcgK1xyXG4gICAgJ09iamVjdCxCb29sZWFuLFN0cmluZyxSZWdFeHAsTWFwLFNldCxKU09OLEludGwsQmlnSW50JztcclxuY29uc3QgaXNHbG9iYWxseVdoaXRlbGlzdGVkID0gLyojX19QVVJFX18qLyBtYWtlTWFwKEdMT0JBTFNfV0hJVEVfTElTVEVEKTtcblxuY29uc3QgcmFuZ2UgPSAyO1xyXG5mdW5jdGlvbiBnZW5lcmF0ZUNvZGVGcmFtZShzb3VyY2UsIHN0YXJ0ID0gMCwgZW5kID0gc291cmNlLmxlbmd0aCkge1xyXG4gICAgLy8gU3BsaXQgdGhlIGNvbnRlbnQgaW50byBpbmRpdmlkdWFsIGxpbmVzIGJ1dCBjYXB0dXJlIHRoZSBuZXdsaW5lIHNlcXVlbmNlXHJcbiAgICAvLyB0aGF0IHNlcGFyYXRlZCBlYWNoIGxpbmUuIFRoaXMgaXMgaW1wb3J0YW50IGJlY2F1c2UgdGhlIGFjdHVhbCBzZXF1ZW5jZSBpc1xyXG4gICAgLy8gbmVlZGVkIHRvIHByb3Blcmx5IHRha2UgaW50byBhY2NvdW50IHRoZSBmdWxsIGxpbmUgbGVuZ3RoIGZvciBvZmZzZXRcclxuICAgIC8vIGNvbXBhcmlzb25cclxuICAgIGxldCBsaW5lcyA9IHNvdXJjZS5zcGxpdCgvKFxccj9cXG4pLyk7XHJcbiAgICAvLyBTZXBhcmF0ZSB0aGUgbGluZXMgYW5kIG5ld2xpbmUgc2VxdWVuY2VzIGludG8gc2VwYXJhdGUgYXJyYXlzIGZvciBlYXNpZXIgcmVmZXJlbmNpbmdcclxuICAgIGNvbnN0IG5ld2xpbmVTZXF1ZW5jZXMgPSBsaW5lcy5maWx0ZXIoKF8sIGlkeCkgPT4gaWR4ICUgMiA9PT0gMSk7XHJcbiAgICBsaW5lcyA9IGxpbmVzLmZpbHRlcigoXywgaWR4KSA9PiBpZHggJSAyID09PSAwKTtcclxuICAgIGxldCBjb3VudCA9IDA7XHJcbiAgICBjb25zdCByZXMgPSBbXTtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBjb3VudCArPVxyXG4gICAgICAgICAgICBsaW5lc1tpXS5sZW5ndGggK1xyXG4gICAgICAgICAgICAgICAgKChuZXdsaW5lU2VxdWVuY2VzW2ldICYmIG5ld2xpbmVTZXF1ZW5jZXNbaV0ubGVuZ3RoKSB8fCAwKTtcclxuICAgICAgICBpZiAoY291bnQgPj0gc3RhcnQpIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgaiA9IGkgLSByYW5nZTsgaiA8PSBpICsgcmFuZ2UgfHwgZW5kID4gY291bnQ7IGorKykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGogPCAwIHx8IGogPj0gbGluZXMubGVuZ3RoKVxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbGluZSA9IGogKyAxO1xyXG4gICAgICAgICAgICAgICAgcmVzLnB1c2goYCR7bGluZX0keycgJy5yZXBlYXQoTWF0aC5tYXgoMyAtIFN0cmluZyhsaW5lKS5sZW5ndGgsIDApKX18ICAke2xpbmVzW2pdfWApO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbGluZUxlbmd0aCA9IGxpbmVzW2pdLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5ld0xpbmVTZXFMZW5ndGggPSAobmV3bGluZVNlcXVlbmNlc1tqXSAmJiBuZXdsaW5lU2VxdWVuY2VzW2pdLmxlbmd0aCkgfHwgMDtcclxuICAgICAgICAgICAgICAgIGlmIChqID09PSBpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gcHVzaCB1bmRlcmxpbmVcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBwYWQgPSBzdGFydCAtIChjb3VudCAtIChsaW5lTGVuZ3RoICsgbmV3TGluZVNlcUxlbmd0aCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGxlbmd0aCA9IE1hdGgubWF4KDEsIGVuZCA+IGNvdW50ID8gbGluZUxlbmd0aCAtIHBhZCA6IGVuZCAtIHN0YXJ0KTtcclxuICAgICAgICAgICAgICAgICAgICByZXMucHVzaChgICAgfCAgYCArICcgJy5yZXBlYXQocGFkKSArICdeJy5yZXBlYXQobGVuZ3RoKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChqID4gaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlbmQgPiBjb3VudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBsZW5ndGggPSBNYXRoLm1heChNYXRoLm1pbihlbmQgLSBjb3VudCwgbGluZUxlbmd0aCksIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXMucHVzaChgICAgfCAgYCArICdeJy5yZXBlYXQobGVuZ3RoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNvdW50ICs9IGxpbmVMZW5ndGggKyBuZXdMaW5lU2VxTGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiByZXMuam9pbignXFxuJyk7XHJcbn1cblxuLyoqXHJcbiAqIE9uIHRoZSBjbGllbnQgd2Ugb25seSBuZWVkIHRvIG9mZmVyIHNwZWNpYWwgY2FzZXMgZm9yIGJvb2xlYW4gYXR0cmlidXRlcyB0aGF0XHJcbiAqIGhhdmUgZGlmZmVyZW50IG5hbWVzIGZyb20gdGhlaXIgY29ycmVzcG9uZGluZyBkb20gcHJvcGVydGllczpcclxuICogLSBpdGVtc2NvcGUgLT4gTi9BXHJcbiAqIC0gYWxsb3dmdWxsc2NyZWVuIC0+IGFsbG93RnVsbHNjcmVlblxyXG4gKiAtIGZvcm1ub3ZhbGlkYXRlIC0+IGZvcm1Ob1ZhbGlkYXRlXHJcbiAqIC0gaXNtYXAgLT4gaXNNYXBcclxuICogLSBub21vZHVsZSAtPiBub01vZHVsZVxyXG4gKiAtIG5vdmFsaWRhdGUgLT4gbm9WYWxpZGF0ZVxyXG4gKiAtIHJlYWRvbmx5IC0+IHJlYWRPbmx5XHJcbiAqL1xyXG5jb25zdCBzcGVjaWFsQm9vbGVhbkF0dHJzID0gYGl0ZW1zY29wZSxhbGxvd2Z1bGxzY3JlZW4sZm9ybW5vdmFsaWRhdGUsaXNtYXAsbm9tb2R1bGUsbm92YWxpZGF0ZSxyZWFkb25seWA7XHJcbmNvbnN0IGlzU3BlY2lhbEJvb2xlYW5BdHRyID0gLyojX19QVVJFX18qLyBtYWtlTWFwKHNwZWNpYWxCb29sZWFuQXR0cnMpO1xyXG4vKipcclxuICogVGhlIGZ1bGwgbGlzdCBpcyBuZWVkZWQgZHVyaW5nIFNTUiB0byBwcm9kdWNlIHRoZSBjb3JyZWN0IGluaXRpYWwgbWFya3VwLlxyXG4gKi9cclxuY29uc3QgaXNCb29sZWFuQXR0ciA9IC8qI19fUFVSRV9fKi8gbWFrZU1hcChzcGVjaWFsQm9vbGVhbkF0dHJzICtcclxuICAgIGAsYXN5bmMsYXV0b2ZvY3VzLGF1dG9wbGF5LGNvbnRyb2xzLGRlZmF1bHQsZGVmZXIsZGlzYWJsZWQsaGlkZGVuLGAgK1xyXG4gICAgYGxvb3Asb3BlbixyZXF1aXJlZCxyZXZlcnNlZCxzY29wZWQsc2VhbWxlc3MsYCArXHJcbiAgICBgY2hlY2tlZCxtdXRlZCxtdWx0aXBsZSxzZWxlY3RlZGApO1xyXG4vKipcclxuICogQm9vbGVhbiBhdHRyaWJ1dGVzIHNob3VsZCBiZSBpbmNsdWRlZCBpZiB0aGUgdmFsdWUgaXMgdHJ1dGh5IG9yICcnLlxyXG4gKiBlLmcuIGA8c2VsZWN0IG11bHRpcGxlPmAgY29tcGlsZXMgdG8gYHsgbXVsdGlwbGU6ICcnIH1gXHJcbiAqL1xyXG5mdW5jdGlvbiBpbmNsdWRlQm9vbGVhbkF0dHIodmFsdWUpIHtcclxuICAgIHJldHVybiAhIXZhbHVlIHx8IHZhbHVlID09PSAnJztcclxufVxyXG5jb25zdCB1bnNhZmVBdHRyQ2hhclJFID0gL1s+Lz1cIidcXHUwMDA5XFx1MDAwYVxcdTAwMGNcXHUwMDIwXS87XHJcbmNvbnN0IGF0dHJWYWxpZGF0aW9uQ2FjaGUgPSB7fTtcclxuZnVuY3Rpb24gaXNTU1JTYWZlQXR0ck5hbWUobmFtZSkge1xyXG4gICAgaWYgKGF0dHJWYWxpZGF0aW9uQ2FjaGUuaGFzT3duUHJvcGVydHkobmFtZSkpIHtcclxuICAgICAgICByZXR1cm4gYXR0clZhbGlkYXRpb25DYWNoZVtuYW1lXTtcclxuICAgIH1cclxuICAgIGNvbnN0IGlzVW5zYWZlID0gdW5zYWZlQXR0ckNoYXJSRS50ZXN0KG5hbWUpO1xyXG4gICAgaWYgKGlzVW5zYWZlKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihgdW5zYWZlIGF0dHJpYnV0ZSBuYW1lOiAke25hbWV9YCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gKGF0dHJWYWxpZGF0aW9uQ2FjaGVbbmFtZV0gPSAhaXNVbnNhZmUpO1xyXG59XHJcbmNvbnN0IHByb3BzVG9BdHRyTWFwID0ge1xyXG4gICAgYWNjZXB0Q2hhcnNldDogJ2FjY2VwdC1jaGFyc2V0JyxcclxuICAgIGNsYXNzTmFtZTogJ2NsYXNzJyxcclxuICAgIGh0bWxGb3I6ICdmb3InLFxyXG4gICAgaHR0cEVxdWl2OiAnaHR0cC1lcXVpdidcclxufTtcclxuLyoqXHJcbiAqIENTUyBwcm9wZXJ0aWVzIHRoYXQgYWNjZXB0IHBsYWluIG51bWJlcnNcclxuICovXHJcbmNvbnN0IGlzTm9Vbml0TnVtZXJpY1N0eWxlUHJvcCA9IC8qI19fUFVSRV9fKi8gbWFrZU1hcChgYW5pbWF0aW9uLWl0ZXJhdGlvbi1jb3VudCxib3JkZXItaW1hZ2Utb3V0c2V0LGJvcmRlci1pbWFnZS1zbGljZSxgICtcclxuICAgIGBib3JkZXItaW1hZ2Utd2lkdGgsYm94LWZsZXgsYm94LWZsZXgtZ3JvdXAsYm94LW9yZGluYWwtZ3JvdXAsY29sdW1uLWNvdW50LGAgK1xyXG4gICAgYGNvbHVtbnMsZmxleCxmbGV4LWdyb3csZmxleC1wb3NpdGl2ZSxmbGV4LXNocmluayxmbGV4LW5lZ2F0aXZlLGZsZXgtb3JkZXIsYCArXHJcbiAgICBgZ3JpZC1yb3csZ3JpZC1yb3ctZW5kLGdyaWQtcm93LXNwYW4sZ3JpZC1yb3ctc3RhcnQsZ3JpZC1jb2x1bW4sYCArXHJcbiAgICBgZ3JpZC1jb2x1bW4tZW5kLGdyaWQtY29sdW1uLXNwYW4sZ3JpZC1jb2x1bW4tc3RhcnQsZm9udC13ZWlnaHQsbGluZS1jbGFtcCxgICtcclxuICAgIGBsaW5lLWhlaWdodCxvcGFjaXR5LG9yZGVyLG9ycGhhbnMsdGFiLXNpemUsd2lkb3dzLHotaW5kZXgsem9vbSxgICtcclxuICAgIC8vIFNWR1xyXG4gICAgYGZpbGwtb3BhY2l0eSxmbG9vZC1vcGFjaXR5LHN0b3Atb3BhY2l0eSxzdHJva2UtZGFzaGFycmF5LHN0cm9rZS1kYXNob2Zmc2V0LGAgK1xyXG4gICAgYHN0cm9rZS1taXRlcmxpbWl0LHN0cm9rZS1vcGFjaXR5LHN0cm9rZS13aWR0aGApO1xyXG4vKipcclxuICogS25vd24gYXR0cmlidXRlcywgdGhpcyBpcyB1c2VkIGZvciBzdHJpbmdpZmljYXRpb24gb2YgcnVudGltZSBzdGF0aWMgbm9kZXNcclxuICogc28gdGhhdCB3ZSBkb24ndCBzdHJpbmdpZnkgYmluZGluZ3MgdGhhdCBjYW5ub3QgYmUgc2V0IGZyb20gSFRNTC5cclxuICogRG9uJ3QgYWxzbyBmb3JnZXQgdG8gYWxsb3cgYGRhdGEtKmAgYW5kIGBhcmlhLSpgIVxyXG4gKiBHZW5lcmF0ZWQgZnJvbSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9IVE1ML0F0dHJpYnV0ZXNcclxuICovXHJcbmNvbnN0IGlzS25vd25IdG1sQXR0ciA9IC8qI19fUFVSRV9fKi8gbWFrZU1hcChgYWNjZXB0LGFjY2VwdC1jaGFyc2V0LGFjY2Vzc2tleSxhY3Rpb24sYWxpZ24sYWxsb3csYWx0LGFzeW5jLGAgK1xyXG4gICAgYGF1dG9jYXBpdGFsaXplLGF1dG9jb21wbGV0ZSxhdXRvZm9jdXMsYXV0b3BsYXksYmFja2dyb3VuZCxiZ2NvbG9yLGAgK1xyXG4gICAgYGJvcmRlcixidWZmZXJlZCxjYXB0dXJlLGNoYWxsZW5nZSxjaGFyc2V0LGNoZWNrZWQsY2l0ZSxjbGFzcyxjb2RlLGAgK1xyXG4gICAgYGNvZGViYXNlLGNvbG9yLGNvbHMsY29sc3Bhbixjb250ZW50LGNvbnRlbnRlZGl0YWJsZSxjb250ZXh0bWVudSxjb250cm9scyxgICtcclxuICAgIGBjb29yZHMsY3Jvc3NvcmlnaW4sY3NwLGRhdGEsZGF0ZXRpbWUsZGVjb2RpbmcsZGVmYXVsdCxkZWZlcixkaXIsZGlybmFtZSxgICtcclxuICAgIGBkaXNhYmxlZCxkb3dubG9hZCxkcmFnZ2FibGUsZHJvcHpvbmUsZW5jdHlwZSxlbnRlcmtleWhpbnQsZm9yLGZvcm0sYCArXHJcbiAgICBgZm9ybWFjdGlvbixmb3JtZW5jdHlwZSxmb3JtbWV0aG9kLGZvcm1ub3ZhbGlkYXRlLGZvcm10YXJnZXQsaGVhZGVycyxgICtcclxuICAgIGBoZWlnaHQsaGlkZGVuLGhpZ2gsaHJlZixocmVmbGFuZyxodHRwLWVxdWl2LGljb24saWQsaW1wb3J0YW5jZSxpbnRlZ3JpdHksYCArXHJcbiAgICBgaXNtYXAsaXRlbXByb3Asa2V5dHlwZSxraW5kLGxhYmVsLGxhbmcsbGFuZ3VhZ2UsbG9hZGluZyxsaXN0LGxvb3AsbG93LGAgK1xyXG4gICAgYG1hbmlmZXN0LG1heCxtYXhsZW5ndGgsbWlubGVuZ3RoLG1lZGlhLG1pbixtdWx0aXBsZSxtdXRlZCxuYW1lLG5vdmFsaWRhdGUsYCArXHJcbiAgICBgb3BlbixvcHRpbXVtLHBhdHRlcm4scGluZyxwbGFjZWhvbGRlcixwb3N0ZXIscHJlbG9hZCxyYWRpb2dyb3VwLHJlYWRvbmx5LGAgK1xyXG4gICAgYHJlZmVycmVycG9saWN5LHJlbCxyZXF1aXJlZCxyZXZlcnNlZCxyb3dzLHJvd3NwYW4sc2FuZGJveCxzY29wZSxzY29wZWQsYCArXHJcbiAgICBgc2VsZWN0ZWQsc2hhcGUsc2l6ZSxzaXplcyxzbG90LHNwYW4sc3BlbGxjaGVjayxzcmMsc3JjZG9jLHNyY2xhbmcsc3Jjc2V0LGAgK1xyXG4gICAgYHN0YXJ0LHN0ZXAsc3R5bGUsc3VtbWFyeSx0YWJpbmRleCx0YXJnZXQsdGl0bGUsdHJhbnNsYXRlLHR5cGUsdXNlbWFwLGAgK1xyXG4gICAgYHZhbHVlLHdpZHRoLHdyYXBgKTtcclxuLyoqXHJcbiAqIEdlbmVyYXRlZCBmcm9tIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL1NWRy9BdHRyaWJ1dGVcclxuICovXHJcbmNvbnN0IGlzS25vd25TdmdBdHRyID0gLyojX19QVVJFX18qLyBtYWtlTWFwKGB4bWxucyxhY2NlbnQtaGVpZ2h0LGFjY3VtdWxhdGUsYWRkaXRpdmUsYWxpZ25tZW50LWJhc2VsaW5lLGFscGhhYmV0aWMsYW1wbGl0dWRlLGAgK1xyXG4gICAgYGFyYWJpYy1mb3JtLGFzY2VudCxhdHRyaWJ1dGVOYW1lLGF0dHJpYnV0ZVR5cGUsYXppbXV0aCxiYXNlRnJlcXVlbmN5LGAgK1xyXG4gICAgYGJhc2VsaW5lLXNoaWZ0LGJhc2VQcm9maWxlLGJib3gsYmVnaW4sYmlhcyxieSxjYWxjTW9kZSxjYXAtaGVpZ2h0LGNsYXNzLGAgK1xyXG4gICAgYGNsaXAsY2xpcFBhdGhVbml0cyxjbGlwLXBhdGgsY2xpcC1ydWxlLGNvbG9yLGNvbG9yLWludGVycG9sYXRpb24sYCArXHJcbiAgICBgY29sb3ItaW50ZXJwb2xhdGlvbi1maWx0ZXJzLGNvbG9yLXByb2ZpbGUsY29sb3ItcmVuZGVyaW5nLGAgK1xyXG4gICAgYGNvbnRlbnRTY3JpcHRUeXBlLGNvbnRlbnRTdHlsZVR5cGUsY3Jvc3NvcmlnaW4sY3Vyc29yLGN4LGN5LGQsZGVjZWxlcmF0ZSxgICtcclxuICAgIGBkZXNjZW50LGRpZmZ1c2VDb25zdGFudCxkaXJlY3Rpb24sZGlzcGxheSxkaXZpc29yLGRvbWluYW50LWJhc2VsaW5lLGR1cixkeCxgICtcclxuICAgIGBkeSxlZGdlTW9kZSxlbGV2YXRpb24sZW5hYmxlLWJhY2tncm91bmQsZW5kLGV4cG9uZW50LGZpbGwsZmlsbC1vcGFjaXR5LGAgK1xyXG4gICAgYGZpbGwtcnVsZSxmaWx0ZXIsZmlsdGVyUmVzLGZpbHRlclVuaXRzLGZsb29kLWNvbG9yLGZsb29kLW9wYWNpdHksYCArXHJcbiAgICBgZm9udC1mYW1pbHksZm9udC1zaXplLGZvbnQtc2l6ZS1hZGp1c3QsZm9udC1zdHJldGNoLGZvbnQtc3R5bGUsYCArXHJcbiAgICBgZm9udC12YXJpYW50LGZvbnQtd2VpZ2h0LGZvcm1hdCxmcm9tLGZyLGZ4LGZ5LGcxLGcyLGdseXBoLW5hbWUsYCArXHJcbiAgICBgZ2x5cGgtb3JpZW50YXRpb24taG9yaXpvbnRhbCxnbHlwaC1vcmllbnRhdGlvbi12ZXJ0aWNhbCxnbHlwaFJlZixgICtcclxuICAgIGBncmFkaWVudFRyYW5zZm9ybSxncmFkaWVudFVuaXRzLGhhbmdpbmcsaGVpZ2h0LGhyZWYsaHJlZmxhbmcsaG9yaXotYWR2LXgsYCArXHJcbiAgICBgaG9yaXotb3JpZ2luLXgsaWQsaWRlb2dyYXBoaWMsaW1hZ2UtcmVuZGVyaW5nLGluLGluMixpbnRlcmNlcHQsayxrMSxrMixrMyxgICtcclxuICAgIGBrNCxrZXJuZWxNYXRyaXgsa2VybmVsVW5pdExlbmd0aCxrZXJuaW5nLGtleVBvaW50cyxrZXlTcGxpbmVzLGtleVRpbWVzLGAgK1xyXG4gICAgYGxhbmcsbGVuZ3RoQWRqdXN0LGxldHRlci1zcGFjaW5nLGxpZ2h0aW5nLWNvbG9yLGxpbWl0aW5nQ29uZUFuZ2xlLGxvY2FsLGAgK1xyXG4gICAgYG1hcmtlci1lbmQsbWFya2VyLW1pZCxtYXJrZXItc3RhcnQsbWFya2VySGVpZ2h0LG1hcmtlclVuaXRzLG1hcmtlcldpZHRoLGAgK1xyXG4gICAgYG1hc2ssbWFza0NvbnRlbnRVbml0cyxtYXNrVW5pdHMsbWF0aGVtYXRpY2FsLG1heCxtZWRpYSxtZXRob2QsbWluLG1vZGUsYCArXHJcbiAgICBgbmFtZSxudW1PY3RhdmVzLG9mZnNldCxvcGFjaXR5LG9wZXJhdG9yLG9yZGVyLG9yaWVudCxvcmllbnRhdGlvbixvcmlnaW4sYCArXHJcbiAgICBgb3ZlcmZsb3csb3ZlcmxpbmUtcG9zaXRpb24sb3ZlcmxpbmUtdGhpY2tuZXNzLHBhbm9zZS0xLHBhaW50LW9yZGVyLHBhdGgsYCArXHJcbiAgICBgcGF0aExlbmd0aCxwYXR0ZXJuQ29udGVudFVuaXRzLHBhdHRlcm5UcmFuc2Zvcm0scGF0dGVyblVuaXRzLHBpbmcsYCArXHJcbiAgICBgcG9pbnRlci1ldmVudHMscG9pbnRzLHBvaW50c0F0WCxwb2ludHNBdFkscG9pbnRzQXRaLHByZXNlcnZlQWxwaGEsYCArXHJcbiAgICBgcHJlc2VydmVBc3BlY3RSYXRpbyxwcmltaXRpdmVVbml0cyxyLHJhZGl1cyxyZWZlcnJlclBvbGljeSxyZWZYLHJlZlkscmVsLGAgK1xyXG4gICAgYHJlbmRlcmluZy1pbnRlbnQscmVwZWF0Q291bnQscmVwZWF0RHVyLHJlcXVpcmVkRXh0ZW5zaW9ucyxyZXF1aXJlZEZlYXR1cmVzLGAgK1xyXG4gICAgYHJlc3RhcnQscmVzdWx0LHJvdGF0ZSxyeCxyeSxzY2FsZSxzZWVkLHNoYXBlLXJlbmRlcmluZyxzbG9wZSxzcGFjaW5nLGAgK1xyXG4gICAgYHNwZWN1bGFyQ29uc3RhbnQsc3BlY3VsYXJFeHBvbmVudCxzcGVlZCxzcHJlYWRNZXRob2Qsc3RhcnRPZmZzZXQsYCArXHJcbiAgICBgc3RkRGV2aWF0aW9uLHN0ZW1oLHN0ZW12LHN0aXRjaFRpbGVzLHN0b3AtY29sb3Isc3RvcC1vcGFjaXR5LGAgK1xyXG4gICAgYHN0cmlrZXRocm91Z2gtcG9zaXRpb24sc3RyaWtldGhyb3VnaC10aGlja25lc3Msc3RyaW5nLHN0cm9rZSxgICtcclxuICAgIGBzdHJva2UtZGFzaGFycmF5LHN0cm9rZS1kYXNob2Zmc2V0LHN0cm9rZS1saW5lY2FwLHN0cm9rZS1saW5lam9pbixgICtcclxuICAgIGBzdHJva2UtbWl0ZXJsaW1pdCxzdHJva2Utb3BhY2l0eSxzdHJva2Utd2lkdGgsc3R5bGUsc3VyZmFjZVNjYWxlLGAgK1xyXG4gICAgYHN5c3RlbUxhbmd1YWdlLHRhYmluZGV4LHRhYmxlVmFsdWVzLHRhcmdldCx0YXJnZXRYLHRhcmdldFksdGV4dC1hbmNob3IsYCArXHJcbiAgICBgdGV4dC1kZWNvcmF0aW9uLHRleHQtcmVuZGVyaW5nLHRleHRMZW5ndGgsdG8sdHJhbnNmb3JtLHRyYW5zZm9ybS1vcmlnaW4sYCArXHJcbiAgICBgdHlwZSx1MSx1Mix1bmRlcmxpbmUtcG9zaXRpb24sdW5kZXJsaW5lLXRoaWNrbmVzcyx1bmljb2RlLHVuaWNvZGUtYmlkaSxgICtcclxuICAgIGB1bmljb2RlLXJhbmdlLHVuaXRzLXBlci1lbSx2LWFscGhhYmV0aWMsdi1oYW5naW5nLHYtaWRlb2dyYXBoaWMsYCArXHJcbiAgICBgdi1tYXRoZW1hdGljYWwsdmFsdWVzLHZlY3Rvci1lZmZlY3QsdmVyc2lvbix2ZXJ0LWFkdi15LHZlcnQtb3JpZ2luLXgsYCArXHJcbiAgICBgdmVydC1vcmlnaW4teSx2aWV3Qm94LHZpZXdUYXJnZXQsdmlzaWJpbGl0eSx3aWR0aCx3aWR0aHMsd29yZC1zcGFjaW5nLGAgK1xyXG4gICAgYHdyaXRpbmctbW9kZSx4LHgtaGVpZ2h0LHgxLHgyLHhDaGFubmVsU2VsZWN0b3IseGxpbms6YWN0dWF0ZSx4bGluazphcmNyb2xlLGAgK1xyXG4gICAgYHhsaW5rOmhyZWYseGxpbms6cm9sZSx4bGluazpzaG93LHhsaW5rOnRpdGxlLHhsaW5rOnR5cGUseG1sOmJhc2UseG1sOmxhbmcsYCArXHJcbiAgICBgeG1sOnNwYWNlLHkseTEseTIseUNoYW5uZWxTZWxlY3Rvcix6LHpvb21BbmRQYW5gKTtcblxuZnVuY3Rpb24gbm9ybWFsaXplU3R5bGUodmFsdWUpIHtcclxuICAgIGlmIChpc0FycmF5KHZhbHVlKSkge1xyXG4gICAgICAgIGNvbnN0IHJlcyA9IHt9O1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdmFsdWUubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgY29uc3QgaXRlbSA9IHZhbHVlW2ldO1xyXG4gICAgICAgICAgICBjb25zdCBub3JtYWxpemVkID0gaXNTdHJpbmcoaXRlbSlcclxuICAgICAgICAgICAgICAgID8gcGFyc2VTdHJpbmdTdHlsZShpdGVtKVxyXG4gICAgICAgICAgICAgICAgOiBub3JtYWxpemVTdHlsZShpdGVtKTtcclxuICAgICAgICAgICAgaWYgKG5vcm1hbGl6ZWQpIHtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IGluIG5vcm1hbGl6ZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXNba2V5XSA9IG5vcm1hbGl6ZWRba2V5XTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoaXNTdHJpbmcodmFsdWUpKSB7XHJcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoaXNPYmplY3QodmFsdWUpKSB7XHJcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgfVxyXG59XHJcbmNvbnN0IGxpc3REZWxpbWl0ZXJSRSA9IC87KD8hW14oXSpcXCkpL2c7XHJcbmNvbnN0IHByb3BlcnR5RGVsaW1pdGVyUkUgPSAvOiguKykvO1xyXG5mdW5jdGlvbiBwYXJzZVN0cmluZ1N0eWxlKGNzc1RleHQpIHtcclxuICAgIGNvbnN0IHJldCA9IHt9O1xyXG4gICAgY3NzVGV4dC5zcGxpdChsaXN0RGVsaW1pdGVyUkUpLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgaWYgKGl0ZW0pIHtcclxuICAgICAgICAgICAgY29uc3QgdG1wID0gaXRlbS5zcGxpdChwcm9wZXJ0eURlbGltaXRlclJFKTtcclxuICAgICAgICAgICAgdG1wLmxlbmd0aCA+IDEgJiYgKHJldFt0bXBbMF0udHJpbSgpXSA9IHRtcFsxXS50cmltKCkpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHJldDtcclxufVxyXG5mdW5jdGlvbiBzdHJpbmdpZnlTdHlsZShzdHlsZXMpIHtcclxuICAgIGxldCByZXQgPSAnJztcclxuICAgIGlmICghc3R5bGVzIHx8IGlzU3RyaW5nKHN0eWxlcykpIHtcclxuICAgICAgICByZXR1cm4gcmV0O1xyXG4gICAgfVxyXG4gICAgZm9yIChjb25zdCBrZXkgaW4gc3R5bGVzKSB7XHJcbiAgICAgICAgY29uc3QgdmFsdWUgPSBzdHlsZXNba2V5XTtcclxuICAgICAgICBjb25zdCBub3JtYWxpemVkS2V5ID0ga2V5LnN0YXJ0c1dpdGgoYC0tYCkgPyBrZXkgOiBoeXBoZW5hdGUoa2V5KTtcclxuICAgICAgICBpZiAoaXNTdHJpbmcodmFsdWUpIHx8XHJcbiAgICAgICAgICAgICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInICYmIGlzTm9Vbml0TnVtZXJpY1N0eWxlUHJvcChub3JtYWxpemVkS2V5KSkpIHtcclxuICAgICAgICAgICAgLy8gb25seSByZW5kZXIgdmFsaWQgdmFsdWVzXHJcbiAgICAgICAgICAgIHJldCArPSBgJHtub3JtYWxpemVkS2V5fToke3ZhbHVlfTtgO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiByZXQ7XHJcbn1cclxuZnVuY3Rpb24gbm9ybWFsaXplQ2xhc3ModmFsdWUpIHtcclxuICAgIGxldCByZXMgPSAnJztcclxuICAgIGlmIChpc1N0cmluZyh2YWx1ZSkpIHtcclxuICAgICAgICByZXMgPSB2YWx1ZTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGlzQXJyYXkodmFsdWUpKSB7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB2YWx1ZS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBjb25zdCBub3JtYWxpemVkID0gbm9ybWFsaXplQ2xhc3ModmFsdWVbaV0pO1xyXG4gICAgICAgICAgICBpZiAobm9ybWFsaXplZCkge1xyXG4gICAgICAgICAgICAgICAgcmVzICs9IG5vcm1hbGl6ZWQgKyAnICc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChpc09iamVjdCh2YWx1ZSkpIHtcclxuICAgICAgICBmb3IgKGNvbnN0IG5hbWUgaW4gdmFsdWUpIHtcclxuICAgICAgICAgICAgaWYgKHZhbHVlW25hbWVdKSB7XHJcbiAgICAgICAgICAgICAgICByZXMgKz0gbmFtZSArICcgJztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiByZXMudHJpbSgpO1xyXG59XHJcbmZ1bmN0aW9uIG5vcm1hbGl6ZVByb3BzKHByb3BzKSB7XHJcbiAgICBpZiAoIXByb3BzKVxyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgbGV0IHsgY2xhc3M6IGtsYXNzLCBzdHlsZSB9ID0gcHJvcHM7XHJcbiAgICBpZiAoa2xhc3MgJiYgIWlzU3RyaW5nKGtsYXNzKSkge1xyXG4gICAgICAgIHByb3BzLmNsYXNzID0gbm9ybWFsaXplQ2xhc3Moa2xhc3MpO1xyXG4gICAgfVxyXG4gICAgaWYgKHN0eWxlKSB7XHJcbiAgICAgICAgcHJvcHMuc3R5bGUgPSBub3JtYWxpemVTdHlsZShzdHlsZSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcHJvcHM7XHJcbn1cblxuLy8gVGhlc2UgdGFnIGNvbmZpZ3MgYXJlIHNoYXJlZCBiZXR3ZWVuIGNvbXBpbGVyLWRvbSBhbmQgcnVudGltZS1kb20sIHNvIHRoZXlcclxuLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSFRNTC9FbGVtZW50XHJcbmNvbnN0IEhUTUxfVEFHUyA9ICdodG1sLGJvZHksYmFzZSxoZWFkLGxpbmssbWV0YSxzdHlsZSx0aXRsZSxhZGRyZXNzLGFydGljbGUsYXNpZGUsZm9vdGVyLCcgK1xyXG4gICAgJ2hlYWRlcixoMSxoMixoMyxoNCxoNSxoNixuYXYsc2VjdGlvbixkaXYsZGQsZGwsZHQsZmlnY2FwdGlvbiwnICtcclxuICAgICdmaWd1cmUscGljdHVyZSxocixpbWcsbGksbWFpbixvbCxwLHByZSx1bCxhLGIsYWJicixiZGksYmRvLGJyLGNpdGUsY29kZSwnICtcclxuICAgICdkYXRhLGRmbixlbSxpLGtiZCxtYXJrLHEscnAscnQscnVieSxzLHNhbXAsc21hbGwsc3BhbixzdHJvbmcsc3ViLHN1cCwnICtcclxuICAgICd0aW1lLHUsdmFyLHdicixhcmVhLGF1ZGlvLG1hcCx0cmFjayx2aWRlbyxlbWJlZCxvYmplY3QscGFyYW0sc291cmNlLCcgK1xyXG4gICAgJ2NhbnZhcyxzY3JpcHQsbm9zY3JpcHQsZGVsLGlucyxjYXB0aW9uLGNvbCxjb2xncm91cCx0YWJsZSx0aGVhZCx0Ym9keSx0ZCwnICtcclxuICAgICd0aCx0cixidXR0b24sZGF0YWxpc3QsZmllbGRzZXQsZm9ybSxpbnB1dCxsYWJlbCxsZWdlbmQsbWV0ZXIsb3B0Z3JvdXAsJyArXHJcbiAgICAnb3B0aW9uLG91dHB1dCxwcm9ncmVzcyxzZWxlY3QsdGV4dGFyZWEsZGV0YWlscyxkaWFsb2csbWVudSwnICtcclxuICAgICdzdW1tYXJ5LHRlbXBsYXRlLGJsb2NrcXVvdGUsaWZyYW1lLHRmb290JztcclxuLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvU1ZHL0VsZW1lbnRcclxuY29uc3QgU1ZHX1RBR1MgPSAnc3ZnLGFuaW1hdGUsYW5pbWF0ZU1vdGlvbixhbmltYXRlVHJhbnNmb3JtLGNpcmNsZSxjbGlwUGF0aCxjb2xvci1wcm9maWxlLCcgK1xyXG4gICAgJ2RlZnMsZGVzYyxkaXNjYXJkLGVsbGlwc2UsZmVCbGVuZCxmZUNvbG9yTWF0cml4LGZlQ29tcG9uZW50VHJhbnNmZXIsJyArXHJcbiAgICAnZmVDb21wb3NpdGUsZmVDb252b2x2ZU1hdHJpeCxmZURpZmZ1c2VMaWdodGluZyxmZURpc3BsYWNlbWVudE1hcCwnICtcclxuICAgICdmZURpc3RhbmNlTGlnaHQsZmVEcm9wU2hhZG93LGZlRmxvb2QsZmVGdW5jQSxmZUZ1bmNCLGZlRnVuY0csZmVGdW5jUiwnICtcclxuICAgICdmZUdhdXNzaWFuQmx1cixmZUltYWdlLGZlTWVyZ2UsZmVNZXJnZU5vZGUsZmVNb3JwaG9sb2d5LGZlT2Zmc2V0LCcgK1xyXG4gICAgJ2ZlUG9pbnRMaWdodCxmZVNwZWN1bGFyTGlnaHRpbmcsZmVTcG90TGlnaHQsZmVUaWxlLGZlVHVyYnVsZW5jZSxmaWx0ZXIsJyArXHJcbiAgICAnZm9yZWlnbk9iamVjdCxnLGhhdGNoLGhhdGNocGF0aCxpbWFnZSxsaW5lLGxpbmVhckdyYWRpZW50LG1hcmtlcixtYXNrLCcgK1xyXG4gICAgJ21lc2gsbWVzaGdyYWRpZW50LG1lc2hwYXRjaCxtZXNocm93LG1ldGFkYXRhLG1wYXRoLHBhdGgscGF0dGVybiwnICtcclxuICAgICdwb2x5Z29uLHBvbHlsaW5lLHJhZGlhbEdyYWRpZW50LHJlY3Qsc2V0LHNvbGlkY29sb3Isc3RvcCxzd2l0Y2gsc3ltYm9sLCcgK1xyXG4gICAgJ3RleHQsdGV4dFBhdGgsdGl0bGUsdHNwYW4sdW5rbm93bix1c2Usdmlldyc7XHJcbmNvbnN0IFZPSURfVEFHUyA9ICdhcmVhLGJhc2UsYnIsY29sLGVtYmVkLGhyLGltZyxpbnB1dCxsaW5rLG1ldGEscGFyYW0sc291cmNlLHRyYWNrLHdicic7XHJcbi8qKlxyXG4gKiBDb21waWxlciBvbmx5LlxyXG4gKiBEbyBOT1QgdXNlIGluIHJ1bnRpbWUgY29kZSBwYXRocyB1bmxlc3MgYmVoaW5kIGAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJylgIGZsYWcuXHJcbiAqL1xyXG5jb25zdCBpc0hUTUxUYWcgPSAvKiNfX1BVUkVfXyovIG1ha2VNYXAoSFRNTF9UQUdTKTtcclxuLyoqXHJcbiAqIENvbXBpbGVyIG9ubHkuXHJcbiAqIERvIE5PVCB1c2UgaW4gcnVudGltZSBjb2RlIHBhdGhzIHVubGVzcyBiZWhpbmQgYChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKWAgZmxhZy5cclxuICovXHJcbmNvbnN0IGlzU1ZHVGFnID0gLyojX19QVVJFX18qLyBtYWtlTWFwKFNWR19UQUdTKTtcclxuLyoqXHJcbiAqIENvbXBpbGVyIG9ubHkuXHJcbiAqIERvIE5PVCB1c2UgaW4gcnVudGltZSBjb2RlIHBhdGhzIHVubGVzcyBiZWhpbmQgYChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKWAgZmxhZy5cclxuICovXHJcbmNvbnN0IGlzVm9pZFRhZyA9IC8qI19fUFVSRV9fKi8gbWFrZU1hcChWT0lEX1RBR1MpO1xuXG5jb25zdCBlc2NhcGVSRSA9IC9bXCInJjw+XS87XHJcbmZ1bmN0aW9uIGVzY2FwZUh0bWwoc3RyaW5nKSB7XHJcbiAgICBjb25zdCBzdHIgPSAnJyArIHN0cmluZztcclxuICAgIGNvbnN0IG1hdGNoID0gZXNjYXBlUkUuZXhlYyhzdHIpO1xyXG4gICAgaWYgKCFtYXRjaCkge1xyXG4gICAgICAgIHJldHVybiBzdHI7XHJcbiAgICB9XHJcbiAgICBsZXQgaHRtbCA9ICcnO1xyXG4gICAgbGV0IGVzY2FwZWQ7XHJcbiAgICBsZXQgaW5kZXg7XHJcbiAgICBsZXQgbGFzdEluZGV4ID0gMDtcclxuICAgIGZvciAoaW5kZXggPSBtYXRjaC5pbmRleDsgaW5kZXggPCBzdHIubGVuZ3RoOyBpbmRleCsrKSB7XHJcbiAgICAgICAgc3dpdGNoIChzdHIuY2hhckNvZGVBdChpbmRleCkpIHtcclxuICAgICAgICAgICAgY2FzZSAzNDogLy8gXCJcclxuICAgICAgICAgICAgICAgIGVzY2FwZWQgPSAnJnF1b3Q7JztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDM4OiAvLyAmXHJcbiAgICAgICAgICAgICAgICBlc2NhcGVkID0gJyZhbXA7JztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDM5OiAvLyAnXHJcbiAgICAgICAgICAgICAgICBlc2NhcGVkID0gJyYjMzk7JztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDYwOiAvLyA8XHJcbiAgICAgICAgICAgICAgICBlc2NhcGVkID0gJyZsdDsnO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgNjI6IC8vID5cclxuICAgICAgICAgICAgICAgIGVzY2FwZWQgPSAnJmd0Oyc7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAobGFzdEluZGV4ICE9PSBpbmRleCkge1xyXG4gICAgICAgICAgICBodG1sICs9IHN0ci5zbGljZShsYXN0SW5kZXgsIGluZGV4KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGFzdEluZGV4ID0gaW5kZXggKyAxO1xyXG4gICAgICAgIGh0bWwgKz0gZXNjYXBlZDtcclxuICAgIH1cclxuICAgIHJldHVybiBsYXN0SW5kZXggIT09IGluZGV4ID8gaHRtbCArIHN0ci5zbGljZShsYXN0SW5kZXgsIGluZGV4KSA6IGh0bWw7XHJcbn1cclxuLy8gaHR0cHM6Ly93d3cudzMub3JnL1RSL2h0bWw1Mi9zeW50YXguaHRtbCNjb21tZW50c1xyXG5jb25zdCBjb21tZW50U3RyaXBSRSA9IC9eLT8+fDwhLS18LS0+fC0tIT58PCEtJC9nO1xyXG5mdW5jdGlvbiBlc2NhcGVIdG1sQ29tbWVudChzcmMpIHtcclxuICAgIHJldHVybiBzcmMucmVwbGFjZShjb21tZW50U3RyaXBSRSwgJycpO1xyXG59XG5cbmZ1bmN0aW9uIGxvb3NlQ29tcGFyZUFycmF5cyhhLCBiKSB7XHJcbiAgICBpZiAoYS5sZW5ndGggIT09IGIubGVuZ3RoKVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIGxldCBlcXVhbCA9IHRydWU7XHJcbiAgICBmb3IgKGxldCBpID0gMDsgZXF1YWwgJiYgaSA8IGEubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBlcXVhbCA9IGxvb3NlRXF1YWwoYVtpXSwgYltpXSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZXF1YWw7XHJcbn1cclxuZnVuY3Rpb24gbG9vc2VFcXVhbChhLCBiKSB7XHJcbiAgICBpZiAoYSA9PT0gYilcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIGxldCBhVmFsaWRUeXBlID0gaXNEYXRlKGEpO1xyXG4gICAgbGV0IGJWYWxpZFR5cGUgPSBpc0RhdGUoYik7XHJcbiAgICBpZiAoYVZhbGlkVHlwZSB8fCBiVmFsaWRUeXBlKSB7XHJcbiAgICAgICAgcmV0dXJuIGFWYWxpZFR5cGUgJiYgYlZhbGlkVHlwZSA/IGEuZ2V0VGltZSgpID09PSBiLmdldFRpbWUoKSA6IGZhbHNlO1xyXG4gICAgfVxyXG4gICAgYVZhbGlkVHlwZSA9IGlzQXJyYXkoYSk7XHJcbiAgICBiVmFsaWRUeXBlID0gaXNBcnJheShiKTtcclxuICAgIGlmIChhVmFsaWRUeXBlIHx8IGJWYWxpZFR5cGUpIHtcclxuICAgICAgICByZXR1cm4gYVZhbGlkVHlwZSAmJiBiVmFsaWRUeXBlID8gbG9vc2VDb21wYXJlQXJyYXlzKGEsIGIpIDogZmFsc2U7XHJcbiAgICB9XHJcbiAgICBhVmFsaWRUeXBlID0gaXNPYmplY3QoYSk7XHJcbiAgICBiVmFsaWRUeXBlID0gaXNPYmplY3QoYik7XHJcbiAgICBpZiAoYVZhbGlkVHlwZSB8fCBiVmFsaWRUeXBlKSB7XHJcbiAgICAgICAgLyogaXN0YW5idWwgaWdub3JlIGlmOiB0aGlzIGlmIHdpbGwgcHJvYmFibHkgbmV2ZXIgYmUgY2FsbGVkICovXHJcbiAgICAgICAgaWYgKCFhVmFsaWRUeXBlIHx8ICFiVmFsaWRUeXBlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgYUtleXNDb3VudCA9IE9iamVjdC5rZXlzKGEpLmxlbmd0aDtcclxuICAgICAgICBjb25zdCBiS2V5c0NvdW50ID0gT2JqZWN0LmtleXMoYikubGVuZ3RoO1xyXG4gICAgICAgIGlmIChhS2V5c0NvdW50ICE9PSBiS2V5c0NvdW50KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gYSkge1xyXG4gICAgICAgICAgICBjb25zdCBhSGFzS2V5ID0gYS5oYXNPd25Qcm9wZXJ0eShrZXkpO1xyXG4gICAgICAgICAgICBjb25zdCBiSGFzS2V5ID0gYi5oYXNPd25Qcm9wZXJ0eShrZXkpO1xyXG4gICAgICAgICAgICBpZiAoKGFIYXNLZXkgJiYgIWJIYXNLZXkpIHx8XHJcbiAgICAgICAgICAgICAgICAoIWFIYXNLZXkgJiYgYkhhc0tleSkgfHxcclxuICAgICAgICAgICAgICAgICFsb29zZUVxdWFsKGFba2V5XSwgYltrZXldKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIFN0cmluZyhhKSA9PT0gU3RyaW5nKGIpO1xyXG59XHJcbmZ1bmN0aW9uIGxvb3NlSW5kZXhPZihhcnIsIHZhbCkge1xyXG4gICAgcmV0dXJuIGFyci5maW5kSW5kZXgoaXRlbSA9PiBsb29zZUVxdWFsKGl0ZW0sIHZhbCkpO1xyXG59XG5cbi8qKlxyXG4gKiBGb3IgY29udmVydGluZyB7eyBpbnRlcnBvbGF0aW9uIH19IHZhbHVlcyB0byBkaXNwbGF5ZWQgc3RyaW5ncy5cclxuICogQHByaXZhdGVcclxuICovXHJcbmNvbnN0IHRvRGlzcGxheVN0cmluZyA9ICh2YWwpID0+IHtcclxuICAgIHJldHVybiBpc1N0cmluZyh2YWwpXHJcbiAgICAgICAgPyB2YWxcclxuICAgICAgICA6IHZhbCA9PSBudWxsXHJcbiAgICAgICAgICAgID8gJydcclxuICAgICAgICAgICAgOiBpc0FycmF5KHZhbCkgfHxcclxuICAgICAgICAgICAgICAgIChpc09iamVjdCh2YWwpICYmXHJcbiAgICAgICAgICAgICAgICAgICAgKHZhbC50b1N0cmluZyA9PT0gb2JqZWN0VG9TdHJpbmcgfHwgIWlzRnVuY3Rpb24odmFsLnRvU3RyaW5nKSkpXHJcbiAgICAgICAgICAgICAgICA/IEpTT04uc3RyaW5naWZ5KHZhbCwgcmVwbGFjZXIsIDIpXHJcbiAgICAgICAgICAgICAgICA6IFN0cmluZyh2YWwpO1xyXG59O1xyXG5jb25zdCByZXBsYWNlciA9IChfa2V5LCB2YWwpID0+IHtcclxuICAgIC8vIGNhbid0IHVzZSBpc1JlZiBoZXJlIHNpbmNlIEB2dWUvc2hhcmVkIGhhcyBubyBkZXBzXHJcbiAgICBpZiAodmFsICYmIHZhbC5fX3ZfaXNSZWYpIHtcclxuICAgICAgICByZXR1cm4gcmVwbGFjZXIoX2tleSwgdmFsLnZhbHVlKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGlzTWFwKHZhbCkpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBbYE1hcCgke3ZhbC5zaXplfSlgXTogWy4uLnZhbC5lbnRyaWVzKCldLnJlZHVjZSgoZW50cmllcywgW2tleSwgdmFsXSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgZW50cmllc1tgJHtrZXl9ID0+YF0gPSB2YWw7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZW50cmllcztcclxuICAgICAgICAgICAgfSwge30pXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGlzU2V0KHZhbCkpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBbYFNldCgke3ZhbC5zaXplfSlgXTogWy4uLnZhbC52YWx1ZXMoKV1cclxuICAgICAgICB9O1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoaXNPYmplY3QodmFsKSAmJiAhaXNBcnJheSh2YWwpICYmICFpc1BsYWluT2JqZWN0KHZhbCkpIHtcclxuICAgICAgICByZXR1cm4gU3RyaW5nKHZhbCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdmFsO1xyXG59O1xuXG5jb25zdCBFTVBUWV9PQkogPSAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJylcclxuICAgID8gT2JqZWN0LmZyZWV6ZSh7fSlcclxuICAgIDoge307XHJcbmNvbnN0IEVNUFRZX0FSUiA9IChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSA/IE9iamVjdC5mcmVlemUoW10pIDogW107XHJcbmNvbnN0IE5PT1AgPSAoKSA9PiB7IH07XHJcbi8qKlxyXG4gKiBBbHdheXMgcmV0dXJuIGZhbHNlLlxyXG4gKi9cclxuY29uc3QgTk8gPSAoKSA9PiBmYWxzZTtcclxuY29uc3Qgb25SRSA9IC9eb25bXmEtel0vO1xyXG5jb25zdCBpc09uID0gKGtleSkgPT4gb25SRS50ZXN0KGtleSk7XHJcbmNvbnN0IGlzTW9kZWxMaXN0ZW5lciA9IChrZXkpID0+IGtleS5zdGFydHNXaXRoKCdvblVwZGF0ZTonKTtcclxuY29uc3QgZXh0ZW5kID0gT2JqZWN0LmFzc2lnbjtcclxuY29uc3QgcmVtb3ZlID0gKGFyciwgZWwpID0+IHtcclxuICAgIGNvbnN0IGkgPSBhcnIuaW5kZXhPZihlbCk7XHJcbiAgICBpZiAoaSA+IC0xKSB7XHJcbiAgICAgICAgYXJyLnNwbGljZShpLCAxKTtcclxuICAgIH1cclxufTtcclxuY29uc3QgaGFzT3duUHJvcGVydHkgPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5O1xyXG5jb25zdCBoYXNPd24gPSAodmFsLCBrZXkpID0+IGhhc093blByb3BlcnR5LmNhbGwodmFsLCBrZXkpO1xyXG5jb25zdCBpc0FycmF5ID0gQXJyYXkuaXNBcnJheTtcclxuY29uc3QgaXNNYXAgPSAodmFsKSA9PiB0b1R5cGVTdHJpbmcodmFsKSA9PT0gJ1tvYmplY3QgTWFwXSc7XHJcbmNvbnN0IGlzU2V0ID0gKHZhbCkgPT4gdG9UeXBlU3RyaW5nKHZhbCkgPT09ICdbb2JqZWN0IFNldF0nO1xyXG5jb25zdCBpc0RhdGUgPSAodmFsKSA9PiB2YWwgaW5zdGFuY2VvZiBEYXRlO1xyXG5jb25zdCBpc0Z1bmN0aW9uID0gKHZhbCkgPT4gdHlwZW9mIHZhbCA9PT0gJ2Z1bmN0aW9uJztcclxuY29uc3QgaXNTdHJpbmcgPSAodmFsKSA9PiB0eXBlb2YgdmFsID09PSAnc3RyaW5nJztcclxuY29uc3QgaXNTeW1ib2wgPSAodmFsKSA9PiB0eXBlb2YgdmFsID09PSAnc3ltYm9sJztcclxuY29uc3QgaXNPYmplY3QgPSAodmFsKSA9PiB2YWwgIT09IG51bGwgJiYgdHlwZW9mIHZhbCA9PT0gJ29iamVjdCc7XHJcbmNvbnN0IGlzUHJvbWlzZSA9ICh2YWwpID0+IHtcclxuICAgIHJldHVybiBpc09iamVjdCh2YWwpICYmIGlzRnVuY3Rpb24odmFsLnRoZW4pICYmIGlzRnVuY3Rpb24odmFsLmNhdGNoKTtcclxufTtcclxuY29uc3Qgb2JqZWN0VG9TdHJpbmcgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO1xyXG5jb25zdCB0b1R5cGVTdHJpbmcgPSAodmFsdWUpID0+IG9iamVjdFRvU3RyaW5nLmNhbGwodmFsdWUpO1xyXG5jb25zdCB0b1Jhd1R5cGUgPSAodmFsdWUpID0+IHtcclxuICAgIC8vIGV4dHJhY3QgXCJSYXdUeXBlXCIgZnJvbSBzdHJpbmdzIGxpa2UgXCJbb2JqZWN0IFJhd1R5cGVdXCJcclxuICAgIHJldHVybiB0b1R5cGVTdHJpbmcodmFsdWUpLnNsaWNlKDgsIC0xKTtcclxufTtcclxuY29uc3QgaXNQbGFpbk9iamVjdCA9ICh2YWwpID0+IHRvVHlwZVN0cmluZyh2YWwpID09PSAnW29iamVjdCBPYmplY3RdJztcclxuY29uc3QgaXNJbnRlZ2VyS2V5ID0gKGtleSkgPT4gaXNTdHJpbmcoa2V5KSAmJlxyXG4gICAga2V5ICE9PSAnTmFOJyAmJlxyXG4gICAga2V5WzBdICE9PSAnLScgJiZcclxuICAgICcnICsgcGFyc2VJbnQoa2V5LCAxMCkgPT09IGtleTtcclxuY29uc3QgaXNSZXNlcnZlZFByb3AgPSAvKiNfX1BVUkVfXyovIG1ha2VNYXAoXHJcbi8vIHRoZSBsZWFkaW5nIGNvbW1hIGlzIGludGVudGlvbmFsIHNvIGVtcHR5IHN0cmluZyBcIlwiIGlzIGFsc28gaW5jbHVkZWRcclxuJyxrZXkscmVmLHJlZl9mb3IscmVmX2tleSwnICtcclxuICAgICdvblZub2RlQmVmb3JlTW91bnQsb25Wbm9kZU1vdW50ZWQsJyArXHJcbiAgICAnb25Wbm9kZUJlZm9yZVVwZGF0ZSxvblZub2RlVXBkYXRlZCwnICtcclxuICAgICdvblZub2RlQmVmb3JlVW5tb3VudCxvblZub2RlVW5tb3VudGVkJyk7XHJcbmNvbnN0IGlzQnVpbHRJbkRpcmVjdGl2ZSA9IC8qI19fUFVSRV9fKi8gbWFrZU1hcCgnYmluZCxjbG9hayxlbHNlLWlmLGVsc2UsZm9yLGh0bWwsaWYsbW9kZWwsb24sb25jZSxwcmUsc2hvdyxzbG90LHRleHQsbWVtbycpO1xyXG5jb25zdCBjYWNoZVN0cmluZ0Z1bmN0aW9uID0gKGZuKSA9PiB7XHJcbiAgICBjb25zdCBjYWNoZSA9IE9iamVjdC5jcmVhdGUobnVsbCk7XHJcbiAgICByZXR1cm4gKChzdHIpID0+IHtcclxuICAgICAgICBjb25zdCBoaXQgPSBjYWNoZVtzdHJdO1xyXG4gICAgICAgIHJldHVybiBoaXQgfHwgKGNhY2hlW3N0cl0gPSBmbihzdHIpKTtcclxuICAgIH0pO1xyXG59O1xyXG5jb25zdCBjYW1lbGl6ZVJFID0gLy0oXFx3KS9nO1xyXG4vKipcclxuICogQHByaXZhdGVcclxuICovXHJcbmNvbnN0IGNhbWVsaXplID0gY2FjaGVTdHJpbmdGdW5jdGlvbigoc3RyKSA9PiB7XHJcbiAgICByZXR1cm4gc3RyLnJlcGxhY2UoY2FtZWxpemVSRSwgKF8sIGMpID0+IChjID8gYy50b1VwcGVyQ2FzZSgpIDogJycpKTtcclxufSk7XHJcbmNvbnN0IGh5cGhlbmF0ZVJFID0gL1xcQihbQS1aXSkvZztcclxuLyoqXHJcbiAqIEBwcml2YXRlXHJcbiAqL1xyXG5jb25zdCBoeXBoZW5hdGUgPSBjYWNoZVN0cmluZ0Z1bmN0aW9uKChzdHIpID0+IHN0ci5yZXBsYWNlKGh5cGhlbmF0ZVJFLCAnLSQxJykudG9Mb3dlckNhc2UoKSk7XHJcbi8qKlxyXG4gKiBAcHJpdmF0ZVxyXG4gKi9cclxuY29uc3QgY2FwaXRhbGl6ZSA9IGNhY2hlU3RyaW5nRnVuY3Rpb24oKHN0cikgPT4gc3RyLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgc3RyLnNsaWNlKDEpKTtcclxuLyoqXHJcbiAqIEBwcml2YXRlXHJcbiAqL1xyXG5jb25zdCB0b0hhbmRsZXJLZXkgPSBjYWNoZVN0cmluZ0Z1bmN0aW9uKChzdHIpID0+IHN0ciA/IGBvbiR7Y2FwaXRhbGl6ZShzdHIpfWAgOiBgYCk7XHJcbi8vIGNvbXBhcmUgd2hldGhlciBhIHZhbHVlIGhhcyBjaGFuZ2VkLCBhY2NvdW50aW5nIGZvciBOYU4uXHJcbmNvbnN0IGhhc0NoYW5nZWQgPSAodmFsdWUsIG9sZFZhbHVlKSA9PiAhT2JqZWN0LmlzKHZhbHVlLCBvbGRWYWx1ZSk7XHJcbmNvbnN0IGludm9rZUFycmF5Rm5zID0gKGZucywgYXJnKSA9PiB7XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGZucy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGZuc1tpXShhcmcpO1xyXG4gICAgfVxyXG59O1xyXG5jb25zdCBkZWYgPSAob2JqLCBrZXksIHZhbHVlKSA9PiB7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHtcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXHJcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICAgICAgdmFsdWVcclxuICAgIH0pO1xyXG59O1xyXG5jb25zdCB0b051bWJlciA9ICh2YWwpID0+IHtcclxuICAgIGNvbnN0IG4gPSBwYXJzZUZsb2F0KHZhbCk7XHJcbiAgICByZXR1cm4gaXNOYU4obikgPyB2YWwgOiBuO1xyXG59O1xyXG5sZXQgX2dsb2JhbFRoaXM7XHJcbmNvbnN0IGdldEdsb2JhbFRoaXMgPSAoKSA9PiB7XHJcbiAgICByZXR1cm4gKF9nbG9iYWxUaGlzIHx8XHJcbiAgICAgICAgKF9nbG9iYWxUaGlzID1cclxuICAgICAgICAgICAgdHlwZW9mIGdsb2JhbFRoaXMgIT09ICd1bmRlZmluZWQnXHJcbiAgICAgICAgICAgICAgICA/IGdsb2JhbFRoaXNcclxuICAgICAgICAgICAgICAgIDogdHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnXHJcbiAgICAgICAgICAgICAgICAgICAgPyBzZWxmXHJcbiAgICAgICAgICAgICAgICAgICAgOiB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICA/IHdpbmRvd1xyXG4gICAgICAgICAgICAgICAgICAgICAgICA6IHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IGdsb2JhbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiB7fSkpO1xyXG59O1xuXG5leHBvcnQgeyBFTVBUWV9BUlIsIEVNUFRZX09CSiwgTk8sIE5PT1AsIFBhdGNoRmxhZ05hbWVzLCBjYW1lbGl6ZSwgY2FwaXRhbGl6ZSwgZGVmLCBlc2NhcGVIdG1sLCBlc2NhcGVIdG1sQ29tbWVudCwgZXh0ZW5kLCBnZW5lcmF0ZUNvZGVGcmFtZSwgZ2V0R2xvYmFsVGhpcywgaGFzQ2hhbmdlZCwgaGFzT3duLCBoeXBoZW5hdGUsIGluY2x1ZGVCb29sZWFuQXR0ciwgaW52b2tlQXJyYXlGbnMsIGlzQXJyYXksIGlzQm9vbGVhbkF0dHIsIGlzQnVpbHRJbkRpcmVjdGl2ZSwgaXNEYXRlLCBpc0Z1bmN0aW9uLCBpc0dsb2JhbGx5V2hpdGVsaXN0ZWQsIGlzSFRNTFRhZywgaXNJbnRlZ2VyS2V5LCBpc0tub3duSHRtbEF0dHIsIGlzS25vd25TdmdBdHRyLCBpc01hcCwgaXNNb2RlbExpc3RlbmVyLCBpc05vVW5pdE51bWVyaWNTdHlsZVByb3AsIGlzT2JqZWN0LCBpc09uLCBpc1BsYWluT2JqZWN0LCBpc1Byb21pc2UsIGlzUmVzZXJ2ZWRQcm9wLCBpc1NTUlNhZmVBdHRyTmFtZSwgaXNTVkdUYWcsIGlzU2V0LCBpc1NwZWNpYWxCb29sZWFuQXR0ciwgaXNTdHJpbmcsIGlzU3ltYm9sLCBpc1ZvaWRUYWcsIGxvb3NlRXF1YWwsIGxvb3NlSW5kZXhPZiwgbWFrZU1hcCwgbm9ybWFsaXplQ2xhc3MsIG5vcm1hbGl6ZVByb3BzLCBub3JtYWxpemVTdHlsZSwgb2JqZWN0VG9TdHJpbmcsIHBhcnNlU3RyaW5nU3R5bGUsIHByb3BzVG9BdHRyTWFwLCByZW1vdmUsIHNsb3RGbGFnc1RleHQsIHN0cmluZ2lmeVN0eWxlLCB0b0Rpc3BsYXlTdHJpbmcsIHRvSGFuZGxlcktleSwgdG9OdW1iZXIsIHRvUmF3VHlwZSwgdG9UeXBlU3RyaW5nIH07XG4iLCJpbXBvcnQgeyBleHRlbmQsIGlzQXJyYXksIGlzTWFwLCBpc0ludGVnZXJLZXksIGlzU3ltYm9sLCBoYXNPd24sIGlzT2JqZWN0LCBoYXNDaGFuZ2VkLCBtYWtlTWFwLCBjYXBpdGFsaXplLCB0b1Jhd1R5cGUsIGRlZiwgaXNGdW5jdGlvbiwgTk9PUCB9IGZyb20gJ0B2dWUvc2hhcmVkJztcblxuZnVuY3Rpb24gd2Fybihtc2csIC4uLmFyZ3MpIHtcclxuICAgIGNvbnNvbGUud2FybihgW1Z1ZSB3YXJuXSAke21zZ31gLCAuLi5hcmdzKTtcclxufVxuXG5sZXQgYWN0aXZlRWZmZWN0U2NvcGU7XHJcbmNsYXNzIEVmZmVjdFNjb3BlIHtcclxuICAgIGNvbnN0cnVjdG9yKGRldGFjaGVkID0gZmFsc2UpIHtcclxuICAgICAgICB0aGlzLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5lZmZlY3RzID0gW107XHJcbiAgICAgICAgdGhpcy5jbGVhbnVwcyA9IFtdO1xyXG4gICAgICAgIGlmICghZGV0YWNoZWQgJiYgYWN0aXZlRWZmZWN0U2NvcGUpIHtcclxuICAgICAgICAgICAgdGhpcy5wYXJlbnQgPSBhY3RpdmVFZmZlY3RTY29wZTtcclxuICAgICAgICAgICAgdGhpcy5pbmRleCA9XHJcbiAgICAgICAgICAgICAgICAoYWN0aXZlRWZmZWN0U2NvcGUuc2NvcGVzIHx8IChhY3RpdmVFZmZlY3RTY29wZS5zY29wZXMgPSBbXSkpLnB1c2godGhpcykgLSAxO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJ1bihmbikge1xyXG4gICAgICAgIGlmICh0aGlzLmFjdGl2ZSkge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgYWN0aXZlRWZmZWN0U2NvcGUgPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZuKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZmluYWxseSB7XHJcbiAgICAgICAgICAgICAgICBhY3RpdmVFZmZlY3RTY29wZSA9IHRoaXMucGFyZW50O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgICAgICB3YXJuKGBjYW5ub3QgcnVuIGFuIGluYWN0aXZlIGVmZmVjdCBzY29wZS5gKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBvbigpIHtcclxuICAgICAgICBhY3RpdmVFZmZlY3RTY29wZSA9IHRoaXM7XHJcbiAgICB9XHJcbiAgICBvZmYoKSB7XHJcbiAgICAgICAgYWN0aXZlRWZmZWN0U2NvcGUgPSB0aGlzLnBhcmVudDtcclxuICAgIH1cclxuICAgIHN0b3AoZnJvbVBhcmVudCkge1xyXG4gICAgICAgIGlmICh0aGlzLmFjdGl2ZSkge1xyXG4gICAgICAgICAgICBsZXQgaSwgbDtcclxuICAgICAgICAgICAgZm9yIChpID0gMCwgbCA9IHRoaXMuZWZmZWN0cy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZWZmZWN0c1tpXS5zdG9wKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZm9yIChpID0gMCwgbCA9IHRoaXMuY2xlYW51cHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNsZWFudXBzW2ldKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRoaXMuc2NvcGVzKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGkgPSAwLCBsID0gdGhpcy5zY29wZXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zY29wZXNbaV0uc3RvcCh0cnVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBuZXN0ZWQgc2NvcGUsIGRlcmVmZXJlbmNlIGZyb20gcGFyZW50IHRvIGF2b2lkIG1lbW9yeSBsZWFrc1xyXG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQgJiYgIWZyb21QYXJlbnQpIHtcclxuICAgICAgICAgICAgICAgIC8vIG9wdGltaXplZCBPKDEpIHJlbW92YWxcclxuICAgICAgICAgICAgICAgIGNvbnN0IGxhc3QgPSB0aGlzLnBhcmVudC5zY29wZXMucG9wKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAobGFzdCAmJiBsYXN0ICE9PSB0aGlzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQuc2NvcGVzW3RoaXMuaW5kZXhdID0gbGFzdDtcclxuICAgICAgICAgICAgICAgICAgICBsYXN0LmluZGV4ID0gdGhpcy5pbmRleDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBlZmZlY3RTY29wZShkZXRhY2hlZCkge1xyXG4gICAgcmV0dXJuIG5ldyBFZmZlY3RTY29wZShkZXRhY2hlZCk7XHJcbn1cclxuZnVuY3Rpb24gcmVjb3JkRWZmZWN0U2NvcGUoZWZmZWN0LCBzY29wZSA9IGFjdGl2ZUVmZmVjdFNjb3BlKSB7XHJcbiAgICBpZiAoc2NvcGUgJiYgc2NvcGUuYWN0aXZlKSB7XHJcbiAgICAgICAgc2NvcGUuZWZmZWN0cy5wdXNoKGVmZmVjdCk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gZ2V0Q3VycmVudFNjb3BlKCkge1xyXG4gICAgcmV0dXJuIGFjdGl2ZUVmZmVjdFNjb3BlO1xyXG59XHJcbmZ1bmN0aW9uIG9uU2NvcGVEaXNwb3NlKGZuKSB7XHJcbiAgICBpZiAoYWN0aXZlRWZmZWN0U2NvcGUpIHtcclxuICAgICAgICBhY3RpdmVFZmZlY3RTY29wZS5jbGVhbnVwcy5wdXNoKGZuKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgIHdhcm4oYG9uU2NvcGVEaXNwb3NlKCkgaXMgY2FsbGVkIHdoZW4gdGhlcmUgaXMgbm8gYWN0aXZlIGVmZmVjdCBzY29wZWAgK1xyXG4gICAgICAgICAgICBgIHRvIGJlIGFzc29jaWF0ZWQgd2l0aC5gKTtcclxuICAgIH1cclxufVxuXG5jb25zdCBjcmVhdGVEZXAgPSAoZWZmZWN0cykgPT4ge1xyXG4gICAgY29uc3QgZGVwID0gbmV3IFNldChlZmZlY3RzKTtcclxuICAgIGRlcC53ID0gMDtcclxuICAgIGRlcC5uID0gMDtcclxuICAgIHJldHVybiBkZXA7XHJcbn07XHJcbmNvbnN0IHdhc1RyYWNrZWQgPSAoZGVwKSA9PiAoZGVwLncgJiB0cmFja09wQml0KSA+IDA7XHJcbmNvbnN0IG5ld1RyYWNrZWQgPSAoZGVwKSA9PiAoZGVwLm4gJiB0cmFja09wQml0KSA+IDA7XHJcbmNvbnN0IGluaXREZXBNYXJrZXJzID0gKHsgZGVwcyB9KSA9PiB7XHJcbiAgICBpZiAoZGVwcy5sZW5ndGgpIHtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRlcHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgZGVwc1tpXS53IHw9IHRyYWNrT3BCaXQ7IC8vIHNldCB3YXMgdHJhY2tlZFxyXG4gICAgICAgIH1cclxuICAgIH1cclxufTtcclxuY29uc3QgZmluYWxpemVEZXBNYXJrZXJzID0gKGVmZmVjdCkgPT4ge1xyXG4gICAgY29uc3QgeyBkZXBzIH0gPSBlZmZlY3Q7XHJcbiAgICBpZiAoZGVwcy5sZW5ndGgpIHtcclxuICAgICAgICBsZXQgcHRyID0gMDtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRlcHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgY29uc3QgZGVwID0gZGVwc1tpXTtcclxuICAgICAgICAgICAgaWYgKHdhc1RyYWNrZWQoZGVwKSAmJiAhbmV3VHJhY2tlZChkZXApKSB7XHJcbiAgICAgICAgICAgICAgICBkZXAuZGVsZXRlKGVmZmVjdCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBkZXBzW3B0cisrXSA9IGRlcDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBjbGVhciBiaXRzXHJcbiAgICAgICAgICAgIGRlcC53ICY9IH50cmFja09wQml0O1xyXG4gICAgICAgICAgICBkZXAubiAmPSB+dHJhY2tPcEJpdDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZGVwcy5sZW5ndGggPSBwdHI7XHJcbiAgICB9XHJcbn07XG5cbmNvbnN0IHRhcmdldE1hcCA9IG5ldyBXZWFrTWFwKCk7XHJcbi8vIFRoZSBudW1iZXIgb2YgZWZmZWN0cyBjdXJyZW50bHkgYmVpbmcgdHJhY2tlZCByZWN1cnNpdmVseS5cclxubGV0IGVmZmVjdFRyYWNrRGVwdGggPSAwO1xyXG5sZXQgdHJhY2tPcEJpdCA9IDE7XHJcbi8qKlxyXG4gKiBUaGUgYml0d2lzZSB0cmFjayBtYXJrZXJzIHN1cHBvcnQgYXQgbW9zdCAzMCBsZXZlbHMgb2YgcmVjdXJzaW9uLlxyXG4gKiBUaGlzIHZhbHVlIGlzIGNob3NlbiB0byBlbmFibGUgbW9kZXJuIEpTIGVuZ2luZXMgdG8gdXNlIGEgU01JIG9uIGFsbCBwbGF0Zm9ybXMuXHJcbiAqIFdoZW4gcmVjdXJzaW9uIGRlcHRoIGlzIGdyZWF0ZXIsIGZhbGwgYmFjayB0byB1c2luZyBhIGZ1bGwgY2xlYW51cC5cclxuICovXHJcbmNvbnN0IG1heE1hcmtlckJpdHMgPSAzMDtcclxubGV0IGFjdGl2ZUVmZmVjdDtcclxuY29uc3QgSVRFUkFURV9LRVkgPSBTeW1ib2woKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpID8gJ2l0ZXJhdGUnIDogJycpO1xyXG5jb25zdCBNQVBfS0VZX0lURVJBVEVfS0VZID0gU3ltYm9sKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSA/ICdNYXAga2V5IGl0ZXJhdGUnIDogJycpO1xyXG5jbGFzcyBSZWFjdGl2ZUVmZmVjdCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihmbiwgc2NoZWR1bGVyID0gbnVsbCwgc2NvcGUpIHtcclxuICAgICAgICB0aGlzLmZuID0gZm47XHJcbiAgICAgICAgdGhpcy5zY2hlZHVsZXIgPSBzY2hlZHVsZXI7XHJcbiAgICAgICAgdGhpcy5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuZGVwcyA9IFtdO1xyXG4gICAgICAgIHRoaXMucGFyZW50ID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIHJlY29yZEVmZmVjdFNjb3BlKHRoaXMsIHNjb3BlKTtcclxuICAgIH1cclxuICAgIHJ1bigpIHtcclxuICAgICAgICBpZiAoIXRoaXMuYWN0aXZlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmZuKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBwYXJlbnQgPSBhY3RpdmVFZmZlY3Q7XHJcbiAgICAgICAgbGV0IGxhc3RTaG91bGRUcmFjayA9IHNob3VsZFRyYWNrO1xyXG4gICAgICAgIHdoaWxlIChwYXJlbnQpIHtcclxuICAgICAgICAgICAgaWYgKHBhcmVudCA9PT0gdGhpcykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHBhcmVudCA9IHBhcmVudC5wYXJlbnQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIHRoaXMucGFyZW50ID0gYWN0aXZlRWZmZWN0O1xyXG4gICAgICAgICAgICBhY3RpdmVFZmZlY3QgPSB0aGlzO1xyXG4gICAgICAgICAgICBzaG91bGRUcmFjayA9IHRydWU7XHJcbiAgICAgICAgICAgIHRyYWNrT3BCaXQgPSAxIDw8ICsrZWZmZWN0VHJhY2tEZXB0aDtcclxuICAgICAgICAgICAgaWYgKGVmZmVjdFRyYWNrRGVwdGggPD0gbWF4TWFya2VyQml0cykge1xyXG4gICAgICAgICAgICAgICAgaW5pdERlcE1hcmtlcnModGhpcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjbGVhbnVwRWZmZWN0KHRoaXMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmZuKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZpbmFsbHkge1xyXG4gICAgICAgICAgICBpZiAoZWZmZWN0VHJhY2tEZXB0aCA8PSBtYXhNYXJrZXJCaXRzKSB7XHJcbiAgICAgICAgICAgICAgICBmaW5hbGl6ZURlcE1hcmtlcnModGhpcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdHJhY2tPcEJpdCA9IDEgPDwgLS1lZmZlY3RUcmFja0RlcHRoO1xyXG4gICAgICAgICAgICBhY3RpdmVFZmZlY3QgPSB0aGlzLnBhcmVudDtcclxuICAgICAgICAgICAgc2hvdWxkVHJhY2sgPSBsYXN0U2hvdWxkVHJhY2s7XHJcbiAgICAgICAgICAgIHRoaXMucGFyZW50ID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHN0b3AoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuYWN0aXZlKSB7XHJcbiAgICAgICAgICAgIGNsZWFudXBFZmZlY3QodGhpcyk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm9uU3RvcCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vblN0b3AoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBjbGVhbnVwRWZmZWN0KGVmZmVjdCkge1xyXG4gICAgY29uc3QgeyBkZXBzIH0gPSBlZmZlY3Q7XHJcbiAgICBpZiAoZGVwcy5sZW5ndGgpIHtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRlcHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgZGVwc1tpXS5kZWxldGUoZWZmZWN0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZGVwcy5sZW5ndGggPSAwO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGVmZmVjdChmbiwgb3B0aW9ucykge1xyXG4gICAgaWYgKGZuLmVmZmVjdCkge1xyXG4gICAgICAgIGZuID0gZm4uZWZmZWN0LmZuO1xyXG4gICAgfVxyXG4gICAgY29uc3QgX2VmZmVjdCA9IG5ldyBSZWFjdGl2ZUVmZmVjdChmbik7XHJcbiAgICBpZiAob3B0aW9ucykge1xyXG4gICAgICAgIGV4dGVuZChfZWZmZWN0LCBvcHRpb25zKTtcclxuICAgICAgICBpZiAob3B0aW9ucy5zY29wZSlcclxuICAgICAgICAgICAgcmVjb3JkRWZmZWN0U2NvcGUoX2VmZmVjdCwgb3B0aW9ucy5zY29wZSk7XHJcbiAgICB9XHJcbiAgICBpZiAoIW9wdGlvbnMgfHwgIW9wdGlvbnMubGF6eSkge1xyXG4gICAgICAgIF9lZmZlY3QucnVuKCk7XHJcbiAgICB9XHJcbiAgICBjb25zdCBydW5uZXIgPSBfZWZmZWN0LnJ1bi5iaW5kKF9lZmZlY3QpO1xyXG4gICAgcnVubmVyLmVmZmVjdCA9IF9lZmZlY3Q7XHJcbiAgICByZXR1cm4gcnVubmVyO1xyXG59XHJcbmZ1bmN0aW9uIHN0b3AocnVubmVyKSB7XHJcbiAgICBydW5uZXIuZWZmZWN0LnN0b3AoKTtcclxufVxyXG5sZXQgc2hvdWxkVHJhY2sgPSB0cnVlO1xyXG5jb25zdCB0cmFja1N0YWNrID0gW107XHJcbmZ1bmN0aW9uIHBhdXNlVHJhY2tpbmcoKSB7XHJcbiAgICB0cmFja1N0YWNrLnB1c2goc2hvdWxkVHJhY2spO1xyXG4gICAgc2hvdWxkVHJhY2sgPSBmYWxzZTtcclxufVxyXG5mdW5jdGlvbiBlbmFibGVUcmFja2luZygpIHtcclxuICAgIHRyYWNrU3RhY2sucHVzaChzaG91bGRUcmFjayk7XHJcbiAgICBzaG91bGRUcmFjayA9IHRydWU7XHJcbn1cclxuZnVuY3Rpb24gcmVzZXRUcmFja2luZygpIHtcclxuICAgIGNvbnN0IGxhc3QgPSB0cmFja1N0YWNrLnBvcCgpO1xyXG4gICAgc2hvdWxkVHJhY2sgPSBsYXN0ID09PSB1bmRlZmluZWQgPyB0cnVlIDogbGFzdDtcclxufVxyXG5mdW5jdGlvbiB0cmFjayh0YXJnZXQsIHR5cGUsIGtleSkge1xyXG4gICAgaWYgKHNob3VsZFRyYWNrICYmIGFjdGl2ZUVmZmVjdCkge1xyXG4gICAgICAgIGxldCBkZXBzTWFwID0gdGFyZ2V0TWFwLmdldCh0YXJnZXQpO1xyXG4gICAgICAgIGlmICghZGVwc01hcCkge1xyXG4gICAgICAgICAgICB0YXJnZXRNYXAuc2V0KHRhcmdldCwgKGRlcHNNYXAgPSBuZXcgTWFwKCkpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGRlcCA9IGRlcHNNYXAuZ2V0KGtleSk7XHJcbiAgICAgICAgaWYgKCFkZXApIHtcclxuICAgICAgICAgICAgZGVwc01hcC5zZXQoa2V5LCAoZGVwID0gY3JlYXRlRGVwKCkpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgZXZlbnRJbmZvID0gKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpXHJcbiAgICAgICAgICAgID8geyBlZmZlY3Q6IGFjdGl2ZUVmZmVjdCwgdGFyZ2V0LCB0eXBlLCBrZXkgfVxyXG4gICAgICAgICAgICA6IHVuZGVmaW5lZDtcclxuICAgICAgICB0cmFja0VmZmVjdHMoZGVwLCBldmVudEluZm8pO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHRyYWNrRWZmZWN0cyhkZXAsIGRlYnVnZ2VyRXZlbnRFeHRyYUluZm8pIHtcclxuICAgIGxldCBzaG91bGRUcmFjayA9IGZhbHNlO1xyXG4gICAgaWYgKGVmZmVjdFRyYWNrRGVwdGggPD0gbWF4TWFya2VyQml0cykge1xyXG4gICAgICAgIGlmICghbmV3VHJhY2tlZChkZXApKSB7XHJcbiAgICAgICAgICAgIGRlcC5uIHw9IHRyYWNrT3BCaXQ7IC8vIHNldCBuZXdseSB0cmFja2VkXHJcbiAgICAgICAgICAgIHNob3VsZFRyYWNrID0gIXdhc1RyYWNrZWQoZGVwKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICAvLyBGdWxsIGNsZWFudXAgbW9kZS5cclxuICAgICAgICBzaG91bGRUcmFjayA9ICFkZXAuaGFzKGFjdGl2ZUVmZmVjdCk7XHJcbiAgICB9XHJcbiAgICBpZiAoc2hvdWxkVHJhY2spIHtcclxuICAgICAgICBkZXAuYWRkKGFjdGl2ZUVmZmVjdCk7XHJcbiAgICAgICAgYWN0aXZlRWZmZWN0LmRlcHMucHVzaChkZXApO1xyXG4gICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiYgYWN0aXZlRWZmZWN0Lm9uVHJhY2spIHtcclxuICAgICAgICAgICAgYWN0aXZlRWZmZWN0Lm9uVHJhY2soT2JqZWN0LmFzc2lnbih7XHJcbiAgICAgICAgICAgICAgICBlZmZlY3Q6IGFjdGl2ZUVmZmVjdFxyXG4gICAgICAgICAgICB9LCBkZWJ1Z2dlckV2ZW50RXh0cmFJbmZvKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHRyaWdnZXIodGFyZ2V0LCB0eXBlLCBrZXksIG5ld1ZhbHVlLCBvbGRWYWx1ZSwgb2xkVGFyZ2V0KSB7XHJcbiAgICBjb25zdCBkZXBzTWFwID0gdGFyZ2V0TWFwLmdldCh0YXJnZXQpO1xyXG4gICAgaWYgKCFkZXBzTWFwKSB7XHJcbiAgICAgICAgLy8gbmV2ZXIgYmVlbiB0cmFja2VkXHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgbGV0IGRlcHMgPSBbXTtcclxuICAgIGlmICh0eXBlID09PSBcImNsZWFyXCIgLyogQ0xFQVIgKi8pIHtcclxuICAgICAgICAvLyBjb2xsZWN0aW9uIGJlaW5nIGNsZWFyZWRcclxuICAgICAgICAvLyB0cmlnZ2VyIGFsbCBlZmZlY3RzIGZvciB0YXJnZXRcclxuICAgICAgICBkZXBzID0gWy4uLmRlcHNNYXAudmFsdWVzKCldO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoa2V5ID09PSAnbGVuZ3RoJyAmJiBpc0FycmF5KHRhcmdldCkpIHtcclxuICAgICAgICBkZXBzTWFwLmZvckVhY2goKGRlcCwga2V5KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChrZXkgPT09ICdsZW5ndGgnIHx8IGtleSA+PSBuZXdWYWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgZGVwcy5wdXNoKGRlcCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIC8vIHNjaGVkdWxlIHJ1bnMgZm9yIFNFVCB8IEFERCB8IERFTEVURVxyXG4gICAgICAgIGlmIChrZXkgIT09IHZvaWQgMCkge1xyXG4gICAgICAgICAgICBkZXBzLnB1c2goZGVwc01hcC5nZXQoa2V5KSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGFsc28gcnVuIGZvciBpdGVyYXRpb24ga2V5IG9uIEFERCB8IERFTEVURSB8IE1hcC5TRVRcclxuICAgICAgICBzd2l0Y2ggKHR5cGUpIHtcclxuICAgICAgICAgICAgY2FzZSBcImFkZFwiIC8qIEFERCAqLzpcclxuICAgICAgICAgICAgICAgIGlmICghaXNBcnJheSh0YXJnZXQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVwcy5wdXNoKGRlcHNNYXAuZ2V0KElURVJBVEVfS0VZKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzTWFwKHRhcmdldCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVwcy5wdXNoKGRlcHNNYXAuZ2V0KE1BUF9LRVlfSVRFUkFURV9LRVkpKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChpc0ludGVnZXJLZXkoa2V5KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIG5ldyBpbmRleCBhZGRlZCB0byBhcnJheSAtPiBsZW5ndGggY2hhbmdlc1xyXG4gICAgICAgICAgICAgICAgICAgIGRlcHMucHVzaChkZXBzTWFwLmdldCgnbGVuZ3RoJykpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgXCJkZWxldGVcIiAvKiBERUxFVEUgKi86XHJcbiAgICAgICAgICAgICAgICBpZiAoIWlzQXJyYXkodGFyZ2V0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRlcHMucHVzaChkZXBzTWFwLmdldChJVEVSQVRFX0tFWSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpc01hcCh0YXJnZXQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlcHMucHVzaChkZXBzTWFwLmdldChNQVBfS0VZX0lURVJBVEVfS0VZKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgXCJzZXRcIiAvKiBTRVQgKi86XHJcbiAgICAgICAgICAgICAgICBpZiAoaXNNYXAodGFyZ2V0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRlcHMucHVzaChkZXBzTWFwLmdldChJVEVSQVRFX0tFWSkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgY29uc3QgZXZlbnRJbmZvID0gKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpXHJcbiAgICAgICAgPyB7IHRhcmdldCwgdHlwZSwga2V5LCBuZXdWYWx1ZSwgb2xkVmFsdWUsIG9sZFRhcmdldCB9XHJcbiAgICAgICAgOiB1bmRlZmluZWQ7XHJcbiAgICBpZiAoZGVwcy5sZW5ndGggPT09IDEpIHtcclxuICAgICAgICBpZiAoZGVwc1swXSkge1xyXG4gICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgICAgICB0cmlnZ2VyRWZmZWN0cyhkZXBzWzBdLCBldmVudEluZm8pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdHJpZ2dlckVmZmVjdHMoZGVwc1swXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBjb25zdCBlZmZlY3RzID0gW107XHJcbiAgICAgICAgZm9yIChjb25zdCBkZXAgb2YgZGVwcykge1xyXG4gICAgICAgICAgICBpZiAoZGVwKSB7XHJcbiAgICAgICAgICAgICAgICBlZmZlY3RzLnB1c2goLi4uZGVwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgIHRyaWdnZXJFZmZlY3RzKGNyZWF0ZURlcChlZmZlY3RzKSwgZXZlbnRJbmZvKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRyaWdnZXJFZmZlY3RzKGNyZWF0ZURlcChlZmZlY3RzKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHRyaWdnZXJFZmZlY3RzKGRlcCwgZGVidWdnZXJFdmVudEV4dHJhSW5mbykge1xyXG4gICAgLy8gc3ByZWFkIGludG8gYXJyYXkgZm9yIHN0YWJpbGl6YXRpb25cclxuICAgIGZvciAoY29uc3QgZWZmZWN0IG9mIGlzQXJyYXkoZGVwKSA/IGRlcCA6IFsuLi5kZXBdKSB7XHJcbiAgICAgICAgaWYgKGVmZmVjdCAhPT0gYWN0aXZlRWZmZWN0IHx8IGVmZmVjdC5hbGxvd1JlY3Vyc2UpIHtcclxuICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiBlZmZlY3Qub25UcmlnZ2VyKSB7XHJcbiAgICAgICAgICAgICAgICBlZmZlY3Qub25UcmlnZ2VyKGV4dGVuZCh7IGVmZmVjdCB9LCBkZWJ1Z2dlckV2ZW50RXh0cmFJbmZvKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGVmZmVjdC5zY2hlZHVsZXIpIHtcclxuICAgICAgICAgICAgICAgIGVmZmVjdC5zY2hlZHVsZXIoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGVmZmVjdC5ydW4oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxuXG5jb25zdCBpc05vblRyYWNrYWJsZUtleXMgPSAvKiNfX1BVUkVfXyovIG1ha2VNYXAoYF9fcHJvdG9fXyxfX3ZfaXNSZWYsX19pc1Z1ZWApO1xyXG5jb25zdCBidWlsdEluU3ltYm9scyA9IG5ldyBTZXQoT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoU3ltYm9sKVxyXG4gICAgLm1hcChrZXkgPT4gU3ltYm9sW2tleV0pXHJcbiAgICAuZmlsdGVyKGlzU3ltYm9sKSk7XHJcbmNvbnN0IGdldCA9IC8qI19fUFVSRV9fKi8gY3JlYXRlR2V0dGVyKCk7XHJcbmNvbnN0IHNoYWxsb3dHZXQgPSAvKiNfX1BVUkVfXyovIGNyZWF0ZUdldHRlcihmYWxzZSwgdHJ1ZSk7XHJcbmNvbnN0IHJlYWRvbmx5R2V0ID0gLyojX19QVVJFX18qLyBjcmVhdGVHZXR0ZXIodHJ1ZSk7XHJcbmNvbnN0IHNoYWxsb3dSZWFkb25seUdldCA9IC8qI19fUFVSRV9fKi8gY3JlYXRlR2V0dGVyKHRydWUsIHRydWUpO1xyXG5jb25zdCBhcnJheUluc3RydW1lbnRhdGlvbnMgPSAvKiNfX1BVUkVfXyovIGNyZWF0ZUFycmF5SW5zdHJ1bWVudGF0aW9ucygpO1xyXG5mdW5jdGlvbiBjcmVhdGVBcnJheUluc3RydW1lbnRhdGlvbnMoKSB7XHJcbiAgICBjb25zdCBpbnN0cnVtZW50YXRpb25zID0ge307XHJcbiAgICBbJ2luY2x1ZGVzJywgJ2luZGV4T2YnLCAnbGFzdEluZGV4T2YnXS5mb3JFYWNoKGtleSA9PiB7XHJcbiAgICAgICAgaW5zdHJ1bWVudGF0aW9uc1trZXldID0gZnVuY3Rpb24gKC4uLmFyZ3MpIHtcclxuICAgICAgICAgICAgY29uc3QgYXJyID0gdG9SYXcodGhpcyk7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwLCBsID0gdGhpcy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHRyYWNrKGFyciwgXCJnZXRcIiAvKiBHRVQgKi8sIGkgKyAnJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gd2UgcnVuIHRoZSBtZXRob2QgdXNpbmcgdGhlIG9yaWdpbmFsIGFyZ3MgZmlyc3QgKHdoaWNoIG1heSBiZSByZWFjdGl2ZSlcclxuICAgICAgICAgICAgY29uc3QgcmVzID0gYXJyW2tleV0oLi4uYXJncyk7XHJcbiAgICAgICAgICAgIGlmIChyZXMgPT09IC0xIHx8IHJlcyA9PT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgICAgIC8vIGlmIHRoYXQgZGlkbid0IHdvcmssIHJ1biBpdCBhZ2FpbiB1c2luZyByYXcgdmFsdWVzLlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGFycltrZXldKC4uLmFyZ3MubWFwKHRvUmF3KSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH0pO1xyXG4gICAgWydwdXNoJywgJ3BvcCcsICdzaGlmdCcsICd1bnNoaWZ0JywgJ3NwbGljZSddLmZvckVhY2goa2V5ID0+IHtcclxuICAgICAgICBpbnN0cnVtZW50YXRpb25zW2tleV0gPSBmdW5jdGlvbiAoLi4uYXJncykge1xyXG4gICAgICAgICAgICBwYXVzZVRyYWNraW5nKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlcyA9IHRvUmF3KHRoaXMpW2tleV0uYXBwbHkodGhpcywgYXJncyk7XHJcbiAgICAgICAgICAgIHJlc2V0VHJhY2tpbmcoKTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcztcclxuICAgICAgICB9O1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gaW5zdHJ1bWVudGF0aW9ucztcclxufVxyXG5mdW5jdGlvbiBjcmVhdGVHZXR0ZXIoaXNSZWFkb25seSA9IGZhbHNlLCBzaGFsbG93ID0gZmFsc2UpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiBnZXQodGFyZ2V0LCBrZXksIHJlY2VpdmVyKSB7XHJcbiAgICAgICAgaWYgKGtleSA9PT0gXCJfX3ZfaXNSZWFjdGl2ZVwiIC8qIElTX1JFQUNUSVZFICovKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAhaXNSZWFkb25seTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoa2V5ID09PSBcIl9fdl9pc1JlYWRvbmx5XCIgLyogSVNfUkVBRE9OTFkgKi8pIHtcclxuICAgICAgICAgICAgcmV0dXJuIGlzUmVhZG9ubHk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGtleSA9PT0gXCJfX3ZfaXNTaGFsbG93XCIgLyogSVNfU0hBTExPVyAqLykge1xyXG4gICAgICAgICAgICByZXR1cm4gc2hhbGxvdztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoa2V5ID09PSBcIl9fdl9yYXdcIiAvKiBSQVcgKi8gJiZcclxuICAgICAgICAgICAgcmVjZWl2ZXIgPT09XHJcbiAgICAgICAgICAgICAgICAoaXNSZWFkb25seVxyXG4gICAgICAgICAgICAgICAgICAgID8gc2hhbGxvd1xyXG4gICAgICAgICAgICAgICAgICAgICAgICA/IHNoYWxsb3dSZWFkb25seU1hcFxyXG4gICAgICAgICAgICAgICAgICAgICAgICA6IHJlYWRvbmx5TWFwXHJcbiAgICAgICAgICAgICAgICAgICAgOiBzaGFsbG93XHJcbiAgICAgICAgICAgICAgICAgICAgICAgID8gc2hhbGxvd1JlYWN0aXZlTWFwXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDogcmVhY3RpdmVNYXApLmdldCh0YXJnZXQpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0YXJnZXQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHRhcmdldElzQXJyYXkgPSBpc0FycmF5KHRhcmdldCk7XHJcbiAgICAgICAgaWYgKCFpc1JlYWRvbmx5ICYmIHRhcmdldElzQXJyYXkgJiYgaGFzT3duKGFycmF5SW5zdHJ1bWVudGF0aW9ucywga2V5KSkge1xyXG4gICAgICAgICAgICByZXR1cm4gUmVmbGVjdC5nZXQoYXJyYXlJbnN0cnVtZW50YXRpb25zLCBrZXksIHJlY2VpdmVyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgcmVzID0gUmVmbGVjdC5nZXQodGFyZ2V0LCBrZXksIHJlY2VpdmVyKTtcclxuICAgICAgICBpZiAoaXNTeW1ib2woa2V5KSA/IGJ1aWx0SW5TeW1ib2xzLmhhcyhrZXkpIDogaXNOb25UcmFja2FibGVLZXlzKGtleSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCFpc1JlYWRvbmx5KSB7XHJcbiAgICAgICAgICAgIHRyYWNrKHRhcmdldCwgXCJnZXRcIiAvKiBHRVQgKi8sIGtleSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChzaGFsbG93KSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChpc1JlZihyZXMpKSB7XHJcbiAgICAgICAgICAgIC8vIHJlZiB1bndyYXBwaW5nIC0gZG9lcyBub3QgYXBwbHkgZm9yIEFycmF5ICsgaW50ZWdlciBrZXkuXHJcbiAgICAgICAgICAgIGNvbnN0IHNob3VsZFVud3JhcCA9ICF0YXJnZXRJc0FycmF5IHx8ICFpc0ludGVnZXJLZXkoa2V5KTtcclxuICAgICAgICAgICAgcmV0dXJuIHNob3VsZFVud3JhcCA/IHJlcy52YWx1ZSA6IHJlcztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGlzT2JqZWN0KHJlcykpIHtcclxuICAgICAgICAgICAgLy8gQ29udmVydCByZXR1cm5lZCB2YWx1ZSBpbnRvIGEgcHJveHkgYXMgd2VsbC4gd2UgZG8gdGhlIGlzT2JqZWN0IGNoZWNrXHJcbiAgICAgICAgICAgIC8vIGhlcmUgdG8gYXZvaWQgaW52YWxpZCB2YWx1ZSB3YXJuaW5nLiBBbHNvIG5lZWQgdG8gbGF6eSBhY2Nlc3MgcmVhZG9ubHlcclxuICAgICAgICAgICAgLy8gYW5kIHJlYWN0aXZlIGhlcmUgdG8gYXZvaWQgY2lyY3VsYXIgZGVwZW5kZW5jeS5cclxuICAgICAgICAgICAgcmV0dXJuIGlzUmVhZG9ubHkgPyByZWFkb25seShyZXMpIDogcmVhY3RpdmUocmVzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlcztcclxuICAgIH07XHJcbn1cclxuY29uc3Qgc2V0ID0gLyojX19QVVJFX18qLyBjcmVhdGVTZXR0ZXIoKTtcclxuY29uc3Qgc2hhbGxvd1NldCA9IC8qI19fUFVSRV9fKi8gY3JlYXRlU2V0dGVyKHRydWUpO1xyXG5mdW5jdGlvbiBjcmVhdGVTZXR0ZXIoc2hhbGxvdyA9IGZhbHNlKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gc2V0KHRhcmdldCwga2V5LCB2YWx1ZSwgcmVjZWl2ZXIpIHtcclxuICAgICAgICBsZXQgb2xkVmFsdWUgPSB0YXJnZXRba2V5XTtcclxuICAgICAgICBpZiAoaXNSZWFkb25seShvbGRWYWx1ZSkgJiYgaXNSZWYob2xkVmFsdWUpICYmICFpc1JlZih2YWx1ZSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXNoYWxsb3cgJiYgIWlzUmVhZG9ubHkodmFsdWUpKSB7XHJcbiAgICAgICAgICAgIGlmICghaXNTaGFsbG93KHZhbHVlKSkge1xyXG4gICAgICAgICAgICAgICAgdmFsdWUgPSB0b1Jhdyh2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICBvbGRWYWx1ZSA9IHRvUmF3KG9sZFZhbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoIWlzQXJyYXkodGFyZ2V0KSAmJiBpc1JlZihvbGRWYWx1ZSkgJiYgIWlzUmVmKHZhbHVlKSkge1xyXG4gICAgICAgICAgICAgICAgb2xkVmFsdWUudmFsdWUgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGhhZEtleSA9IGlzQXJyYXkodGFyZ2V0KSAmJiBpc0ludGVnZXJLZXkoa2V5KVxyXG4gICAgICAgICAgICA/IE51bWJlcihrZXkpIDwgdGFyZ2V0Lmxlbmd0aFxyXG4gICAgICAgICAgICA6IGhhc093bih0YXJnZXQsIGtleSk7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gUmVmbGVjdC5zZXQodGFyZ2V0LCBrZXksIHZhbHVlLCByZWNlaXZlcik7XHJcbiAgICAgICAgLy8gZG9uJ3QgdHJpZ2dlciBpZiB0YXJnZXQgaXMgc29tZXRoaW5nIHVwIGluIHRoZSBwcm90b3R5cGUgY2hhaW4gb2Ygb3JpZ2luYWxcclxuICAgICAgICBpZiAodGFyZ2V0ID09PSB0b1JhdyhyZWNlaXZlcikpIHtcclxuICAgICAgICAgICAgaWYgKCFoYWRLZXkpIHtcclxuICAgICAgICAgICAgICAgIHRyaWdnZXIodGFyZ2V0LCBcImFkZFwiIC8qIEFERCAqLywga2V5LCB2YWx1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoaGFzQ2hhbmdlZCh2YWx1ZSwgb2xkVmFsdWUpKSB7XHJcbiAgICAgICAgICAgICAgICB0cmlnZ2VyKHRhcmdldCwgXCJzZXRcIiAvKiBTRVQgKi8sIGtleSwgdmFsdWUsIG9sZFZhbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfTtcclxufVxyXG5mdW5jdGlvbiBkZWxldGVQcm9wZXJ0eSh0YXJnZXQsIGtleSkge1xyXG4gICAgY29uc3QgaGFkS2V5ID0gaGFzT3duKHRhcmdldCwga2V5KTtcclxuICAgIGNvbnN0IG9sZFZhbHVlID0gdGFyZ2V0W2tleV07XHJcbiAgICBjb25zdCByZXN1bHQgPSBSZWZsZWN0LmRlbGV0ZVByb3BlcnR5KHRhcmdldCwga2V5KTtcclxuICAgIGlmIChyZXN1bHQgJiYgaGFkS2V5KSB7XHJcbiAgICAgICAgdHJpZ2dlcih0YXJnZXQsIFwiZGVsZXRlXCIgLyogREVMRVRFICovLCBrZXksIHVuZGVmaW5lZCwgb2xkVmFsdWUpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG5mdW5jdGlvbiBoYXModGFyZ2V0LCBrZXkpIHtcclxuICAgIGNvbnN0IHJlc3VsdCA9IFJlZmxlY3QuaGFzKHRhcmdldCwga2V5KTtcclxuICAgIGlmICghaXNTeW1ib2woa2V5KSB8fCAhYnVpbHRJblN5bWJvbHMuaGFzKGtleSkpIHtcclxuICAgICAgICB0cmFjayh0YXJnZXQsIFwiaGFzXCIgLyogSEFTICovLCBrZXkpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG5mdW5jdGlvbiBvd25LZXlzKHRhcmdldCkge1xyXG4gICAgdHJhY2sodGFyZ2V0LCBcIml0ZXJhdGVcIiAvKiBJVEVSQVRFICovLCBpc0FycmF5KHRhcmdldCkgPyAnbGVuZ3RoJyA6IElURVJBVEVfS0VZKTtcclxuICAgIHJldHVybiBSZWZsZWN0Lm93bktleXModGFyZ2V0KTtcclxufVxyXG5jb25zdCBtdXRhYmxlSGFuZGxlcnMgPSB7XHJcbiAgICBnZXQsXHJcbiAgICBzZXQsXHJcbiAgICBkZWxldGVQcm9wZXJ0eSxcclxuICAgIGhhcyxcclxuICAgIG93bktleXNcclxufTtcclxuY29uc3QgcmVhZG9ubHlIYW5kbGVycyA9IHtcclxuICAgIGdldDogcmVhZG9ubHlHZXQsXHJcbiAgICBzZXQodGFyZ2V0LCBrZXkpIHtcclxuICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihgU2V0IG9wZXJhdGlvbiBvbiBrZXkgXCIke1N0cmluZyhrZXkpfVwiIGZhaWxlZDogdGFyZ2V0IGlzIHJlYWRvbmx5LmAsIHRhcmdldCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfSxcclxuICAgIGRlbGV0ZVByb3BlcnR5KHRhcmdldCwga2V5KSB7XHJcbiAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLndhcm4oYERlbGV0ZSBvcGVyYXRpb24gb24ga2V5IFwiJHtTdHJpbmcoa2V5KX1cIiBmYWlsZWQ6IHRhcmdldCBpcyByZWFkb25seS5gLCB0YXJnZXQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxufTtcclxuY29uc3Qgc2hhbGxvd1JlYWN0aXZlSGFuZGxlcnMgPSAvKiNfX1BVUkVfXyovIGV4dGVuZCh7fSwgbXV0YWJsZUhhbmRsZXJzLCB7XHJcbiAgICBnZXQ6IHNoYWxsb3dHZXQsXHJcbiAgICBzZXQ6IHNoYWxsb3dTZXRcclxufSk7XHJcbi8vIFByb3BzIGhhbmRsZXJzIGFyZSBzcGVjaWFsIGluIHRoZSBzZW5zZSB0aGF0IGl0IHNob3VsZCBub3QgdW53cmFwIHRvcC1sZXZlbFxyXG4vLyByZWZzIChpbiBvcmRlciB0byBhbGxvdyByZWZzIHRvIGJlIGV4cGxpY2l0bHkgcGFzc2VkIGRvd24pLCBidXQgc2hvdWxkXHJcbi8vIHJldGFpbiB0aGUgcmVhY3Rpdml0eSBvZiB0aGUgbm9ybWFsIHJlYWRvbmx5IG9iamVjdC5cclxuY29uc3Qgc2hhbGxvd1JlYWRvbmx5SGFuZGxlcnMgPSAvKiNfX1BVUkVfXyovIGV4dGVuZCh7fSwgcmVhZG9ubHlIYW5kbGVycywge1xyXG4gICAgZ2V0OiBzaGFsbG93UmVhZG9ubHlHZXRcclxufSk7XG5cbmNvbnN0IHRvU2hhbGxvdyA9ICh2YWx1ZSkgPT4gdmFsdWU7XHJcbmNvbnN0IGdldFByb3RvID0gKHYpID0+IFJlZmxlY3QuZ2V0UHJvdG90eXBlT2Yodik7XHJcbmZ1bmN0aW9uIGdldCQxKHRhcmdldCwga2V5LCBpc1JlYWRvbmx5ID0gZmFsc2UsIGlzU2hhbGxvdyA9IGZhbHNlKSB7XHJcbiAgICAvLyAjMTc3MjogcmVhZG9ubHkocmVhY3RpdmUoTWFwKSkgc2hvdWxkIHJldHVybiByZWFkb25seSArIHJlYWN0aXZlIHZlcnNpb25cclxuICAgIC8vIG9mIHRoZSB2YWx1ZVxyXG4gICAgdGFyZ2V0ID0gdGFyZ2V0W1wiX192X3Jhd1wiIC8qIFJBVyAqL107XHJcbiAgICBjb25zdCByYXdUYXJnZXQgPSB0b1Jhdyh0YXJnZXQpO1xyXG4gICAgY29uc3QgcmF3S2V5ID0gdG9SYXcoa2V5KTtcclxuICAgIGlmIChrZXkgIT09IHJhd0tleSkge1xyXG4gICAgICAgICFpc1JlYWRvbmx5ICYmIHRyYWNrKHJhd1RhcmdldCwgXCJnZXRcIiAvKiBHRVQgKi8sIGtleSk7XHJcbiAgICB9XHJcbiAgICAhaXNSZWFkb25seSAmJiB0cmFjayhyYXdUYXJnZXQsIFwiZ2V0XCIgLyogR0VUICovLCByYXdLZXkpO1xyXG4gICAgY29uc3QgeyBoYXMgfSA9IGdldFByb3RvKHJhd1RhcmdldCk7XHJcbiAgICBjb25zdCB3cmFwID0gaXNTaGFsbG93ID8gdG9TaGFsbG93IDogaXNSZWFkb25seSA/IHRvUmVhZG9ubHkgOiB0b1JlYWN0aXZlO1xyXG4gICAgaWYgKGhhcy5jYWxsKHJhd1RhcmdldCwga2V5KSkge1xyXG4gICAgICAgIHJldHVybiB3cmFwKHRhcmdldC5nZXQoa2V5KSk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChoYXMuY2FsbChyYXdUYXJnZXQsIHJhd0tleSkpIHtcclxuICAgICAgICByZXR1cm4gd3JhcCh0YXJnZXQuZ2V0KHJhd0tleSkpO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAodGFyZ2V0ICE9PSByYXdUYXJnZXQpIHtcclxuICAgICAgICAvLyAjMzYwMiByZWFkb25seShyZWFjdGl2ZShNYXApKVxyXG4gICAgICAgIC8vIGVuc3VyZSB0aGF0IHRoZSBuZXN0ZWQgcmVhY3RpdmUgYE1hcGAgY2FuIGRvIHRyYWNraW5nIGZvciBpdHNlbGZcclxuICAgICAgICB0YXJnZXQuZ2V0KGtleSk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gaGFzJDEoa2V5LCBpc1JlYWRvbmx5ID0gZmFsc2UpIHtcclxuICAgIGNvbnN0IHRhcmdldCA9IHRoaXNbXCJfX3ZfcmF3XCIgLyogUkFXICovXTtcclxuICAgIGNvbnN0IHJhd1RhcmdldCA9IHRvUmF3KHRhcmdldCk7XHJcbiAgICBjb25zdCByYXdLZXkgPSB0b1JhdyhrZXkpO1xyXG4gICAgaWYgKGtleSAhPT0gcmF3S2V5KSB7XHJcbiAgICAgICAgIWlzUmVhZG9ubHkgJiYgdHJhY2socmF3VGFyZ2V0LCBcImhhc1wiIC8qIEhBUyAqLywga2V5KTtcclxuICAgIH1cclxuICAgICFpc1JlYWRvbmx5ICYmIHRyYWNrKHJhd1RhcmdldCwgXCJoYXNcIiAvKiBIQVMgKi8sIHJhd0tleSk7XHJcbiAgICByZXR1cm4ga2V5ID09PSByYXdLZXlcclxuICAgICAgICA/IHRhcmdldC5oYXMoa2V5KVxyXG4gICAgICAgIDogdGFyZ2V0LmhhcyhrZXkpIHx8IHRhcmdldC5oYXMocmF3S2V5KTtcclxufVxyXG5mdW5jdGlvbiBzaXplKHRhcmdldCwgaXNSZWFkb25seSA9IGZhbHNlKSB7XHJcbiAgICB0YXJnZXQgPSB0YXJnZXRbXCJfX3ZfcmF3XCIgLyogUkFXICovXTtcclxuICAgICFpc1JlYWRvbmx5ICYmIHRyYWNrKHRvUmF3KHRhcmdldCksIFwiaXRlcmF0ZVwiIC8qIElURVJBVEUgKi8sIElURVJBVEVfS0VZKTtcclxuICAgIHJldHVybiBSZWZsZWN0LmdldCh0YXJnZXQsICdzaXplJywgdGFyZ2V0KTtcclxufVxyXG5mdW5jdGlvbiBhZGQodmFsdWUpIHtcclxuICAgIHZhbHVlID0gdG9SYXcodmFsdWUpO1xyXG4gICAgY29uc3QgdGFyZ2V0ID0gdG9SYXcodGhpcyk7XHJcbiAgICBjb25zdCBwcm90byA9IGdldFByb3RvKHRhcmdldCk7XHJcbiAgICBjb25zdCBoYWRLZXkgPSBwcm90by5oYXMuY2FsbCh0YXJnZXQsIHZhbHVlKTtcclxuICAgIGlmICghaGFkS2V5KSB7XHJcbiAgICAgICAgdGFyZ2V0LmFkZCh2YWx1ZSk7XHJcbiAgICAgICAgdHJpZ2dlcih0YXJnZXQsIFwiYWRkXCIgLyogQUREICovLCB2YWx1ZSwgdmFsdWUpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRoaXM7XHJcbn1cclxuZnVuY3Rpb24gc2V0JDEoa2V5LCB2YWx1ZSkge1xyXG4gICAgdmFsdWUgPSB0b1Jhdyh2YWx1ZSk7XHJcbiAgICBjb25zdCB0YXJnZXQgPSB0b1Jhdyh0aGlzKTtcclxuICAgIGNvbnN0IHsgaGFzLCBnZXQgfSA9IGdldFByb3RvKHRhcmdldCk7XHJcbiAgICBsZXQgaGFkS2V5ID0gaGFzLmNhbGwodGFyZ2V0LCBrZXkpO1xyXG4gICAgaWYgKCFoYWRLZXkpIHtcclxuICAgICAgICBrZXkgPSB0b1JhdyhrZXkpO1xyXG4gICAgICAgIGhhZEtleSA9IGhhcy5jYWxsKHRhcmdldCwga2V5KTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgIGNoZWNrSWRlbnRpdHlLZXlzKHRhcmdldCwgaGFzLCBrZXkpO1xyXG4gICAgfVxyXG4gICAgY29uc3Qgb2xkVmFsdWUgPSBnZXQuY2FsbCh0YXJnZXQsIGtleSk7XHJcbiAgICB0YXJnZXQuc2V0KGtleSwgdmFsdWUpO1xyXG4gICAgaWYgKCFoYWRLZXkpIHtcclxuICAgICAgICB0cmlnZ2VyKHRhcmdldCwgXCJhZGRcIiAvKiBBREQgKi8sIGtleSwgdmFsdWUpO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoaGFzQ2hhbmdlZCh2YWx1ZSwgb2xkVmFsdWUpKSB7XHJcbiAgICAgICAgdHJpZ2dlcih0YXJnZXQsIFwic2V0XCIgLyogU0VUICovLCBrZXksIHZhbHVlLCBvbGRWYWx1ZSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGhpcztcclxufVxyXG5mdW5jdGlvbiBkZWxldGVFbnRyeShrZXkpIHtcclxuICAgIGNvbnN0IHRhcmdldCA9IHRvUmF3KHRoaXMpO1xyXG4gICAgY29uc3QgeyBoYXMsIGdldCB9ID0gZ2V0UHJvdG8odGFyZ2V0KTtcclxuICAgIGxldCBoYWRLZXkgPSBoYXMuY2FsbCh0YXJnZXQsIGtleSk7XHJcbiAgICBpZiAoIWhhZEtleSkge1xyXG4gICAgICAgIGtleSA9IHRvUmF3KGtleSk7XHJcbiAgICAgICAgaGFkS2V5ID0gaGFzLmNhbGwodGFyZ2V0LCBrZXkpO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgY2hlY2tJZGVudGl0eUtleXModGFyZ2V0LCBoYXMsIGtleSk7XHJcbiAgICB9XHJcbiAgICBjb25zdCBvbGRWYWx1ZSA9IGdldCA/IGdldC5jYWxsKHRhcmdldCwga2V5KSA6IHVuZGVmaW5lZDtcclxuICAgIC8vIGZvcndhcmQgdGhlIG9wZXJhdGlvbiBiZWZvcmUgcXVldWVpbmcgcmVhY3Rpb25zXHJcbiAgICBjb25zdCByZXN1bHQgPSB0YXJnZXQuZGVsZXRlKGtleSk7XHJcbiAgICBpZiAoaGFkS2V5KSB7XHJcbiAgICAgICAgdHJpZ2dlcih0YXJnZXQsIFwiZGVsZXRlXCIgLyogREVMRVRFICovLCBrZXksIHVuZGVmaW5lZCwgb2xkVmFsdWUpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG5mdW5jdGlvbiBjbGVhcigpIHtcclxuICAgIGNvbnN0IHRhcmdldCA9IHRvUmF3KHRoaXMpO1xyXG4gICAgY29uc3QgaGFkSXRlbXMgPSB0YXJnZXQuc2l6ZSAhPT0gMDtcclxuICAgIGNvbnN0IG9sZFRhcmdldCA9IChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKVxyXG4gICAgICAgID8gaXNNYXAodGFyZ2V0KVxyXG4gICAgICAgICAgICA/IG5ldyBNYXAodGFyZ2V0KVxyXG4gICAgICAgICAgICA6IG5ldyBTZXQodGFyZ2V0KVxyXG4gICAgICAgIDogdW5kZWZpbmVkO1xyXG4gICAgLy8gZm9yd2FyZCB0aGUgb3BlcmF0aW9uIGJlZm9yZSBxdWV1ZWluZyByZWFjdGlvbnNcclxuICAgIGNvbnN0IHJlc3VsdCA9IHRhcmdldC5jbGVhcigpO1xyXG4gICAgaWYgKGhhZEl0ZW1zKSB7XHJcbiAgICAgICAgdHJpZ2dlcih0YXJnZXQsIFwiY2xlYXJcIiAvKiBDTEVBUiAqLywgdW5kZWZpbmVkLCB1bmRlZmluZWQsIG9sZFRhcmdldCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcbmZ1bmN0aW9uIGNyZWF0ZUZvckVhY2goaXNSZWFkb25seSwgaXNTaGFsbG93KSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gZm9yRWFjaChjYWxsYmFjaywgdGhpc0FyZykge1xyXG4gICAgICAgIGNvbnN0IG9ic2VydmVkID0gdGhpcztcclxuICAgICAgICBjb25zdCB0YXJnZXQgPSBvYnNlcnZlZFtcIl9fdl9yYXdcIiAvKiBSQVcgKi9dO1xyXG4gICAgICAgIGNvbnN0IHJhd1RhcmdldCA9IHRvUmF3KHRhcmdldCk7XHJcbiAgICAgICAgY29uc3Qgd3JhcCA9IGlzU2hhbGxvdyA/IHRvU2hhbGxvdyA6IGlzUmVhZG9ubHkgPyB0b1JlYWRvbmx5IDogdG9SZWFjdGl2ZTtcclxuICAgICAgICAhaXNSZWFkb25seSAmJiB0cmFjayhyYXdUYXJnZXQsIFwiaXRlcmF0ZVwiIC8qIElURVJBVEUgKi8sIElURVJBVEVfS0VZKTtcclxuICAgICAgICByZXR1cm4gdGFyZ2V0LmZvckVhY2goKHZhbHVlLCBrZXkpID0+IHtcclxuICAgICAgICAgICAgLy8gaW1wb3J0YW50OiBtYWtlIHN1cmUgdGhlIGNhbGxiYWNrIGlzXHJcbiAgICAgICAgICAgIC8vIDEuIGludm9rZWQgd2l0aCB0aGUgcmVhY3RpdmUgbWFwIGFzIGB0aGlzYCBhbmQgM3JkIGFyZ1xyXG4gICAgICAgICAgICAvLyAyLiB0aGUgdmFsdWUgcmVjZWl2ZWQgc2hvdWxkIGJlIGEgY29ycmVzcG9uZGluZyByZWFjdGl2ZS9yZWFkb25seS5cclxuICAgICAgICAgICAgcmV0dXJuIGNhbGxiYWNrLmNhbGwodGhpc0FyZywgd3JhcCh2YWx1ZSksIHdyYXAoa2V5KSwgb2JzZXJ2ZWQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxufVxyXG5mdW5jdGlvbiBjcmVhdGVJdGVyYWJsZU1ldGhvZChtZXRob2QsIGlzUmVhZG9ubHksIGlzU2hhbGxvdykge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uICguLi5hcmdzKSB7XHJcbiAgICAgICAgY29uc3QgdGFyZ2V0ID0gdGhpc1tcIl9fdl9yYXdcIiAvKiBSQVcgKi9dO1xyXG4gICAgICAgIGNvbnN0IHJhd1RhcmdldCA9IHRvUmF3KHRhcmdldCk7XHJcbiAgICAgICAgY29uc3QgdGFyZ2V0SXNNYXAgPSBpc01hcChyYXdUYXJnZXQpO1xyXG4gICAgICAgIGNvbnN0IGlzUGFpciA9IG1ldGhvZCA9PT0gJ2VudHJpZXMnIHx8IChtZXRob2QgPT09IFN5bWJvbC5pdGVyYXRvciAmJiB0YXJnZXRJc01hcCk7XHJcbiAgICAgICAgY29uc3QgaXNLZXlPbmx5ID0gbWV0aG9kID09PSAna2V5cycgJiYgdGFyZ2V0SXNNYXA7XHJcbiAgICAgICAgY29uc3QgaW5uZXJJdGVyYXRvciA9IHRhcmdldFttZXRob2RdKC4uLmFyZ3MpO1xyXG4gICAgICAgIGNvbnN0IHdyYXAgPSBpc1NoYWxsb3cgPyB0b1NoYWxsb3cgOiBpc1JlYWRvbmx5ID8gdG9SZWFkb25seSA6IHRvUmVhY3RpdmU7XHJcbiAgICAgICAgIWlzUmVhZG9ubHkgJiZcclxuICAgICAgICAgICAgdHJhY2socmF3VGFyZ2V0LCBcIml0ZXJhdGVcIiAvKiBJVEVSQVRFICovLCBpc0tleU9ubHkgPyBNQVBfS0VZX0lURVJBVEVfS0VZIDogSVRFUkFURV9LRVkpO1xyXG4gICAgICAgIC8vIHJldHVybiBhIHdyYXBwZWQgaXRlcmF0b3Igd2hpY2ggcmV0dXJucyBvYnNlcnZlZCB2ZXJzaW9ucyBvZiB0aGVcclxuICAgICAgICAvLyB2YWx1ZXMgZW1pdHRlZCBmcm9tIHRoZSByZWFsIGl0ZXJhdG9yXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgLy8gaXRlcmF0b3IgcHJvdG9jb2xcclxuICAgICAgICAgICAgbmV4dCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHsgdmFsdWUsIGRvbmUgfSA9IGlubmVySXRlcmF0b3IubmV4dCgpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRvbmVcclxuICAgICAgICAgICAgICAgICAgICA/IHsgdmFsdWUsIGRvbmUgfVxyXG4gICAgICAgICAgICAgICAgICAgIDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogaXNQYWlyID8gW3dyYXAodmFsdWVbMF0pLCB3cmFwKHZhbHVlWzFdKV0gOiB3cmFwKHZhbHVlKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZG9uZVxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIC8vIGl0ZXJhYmxlIHByb3RvY29sXHJcbiAgICAgICAgICAgIFtTeW1ib2wuaXRlcmF0b3JdKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfTtcclxufVxyXG5mdW5jdGlvbiBjcmVhdGVSZWFkb25seU1ldGhvZCh0eXBlKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKC4uLmFyZ3MpIHtcclxuICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGtleSA9IGFyZ3NbMF0gPyBgb24ga2V5IFwiJHthcmdzWzBdfVwiIGAgOiBgYDtcclxuICAgICAgICAgICAgY29uc29sZS53YXJuKGAke2NhcGl0YWxpemUodHlwZSl9IG9wZXJhdGlvbiAke2tleX1mYWlsZWQ6IHRhcmdldCBpcyByZWFkb25seS5gLCB0b1Jhdyh0aGlzKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0eXBlID09PSBcImRlbGV0ZVwiIC8qIERFTEVURSAqLyA/IGZhbHNlIDogdGhpcztcclxuICAgIH07XHJcbn1cclxuZnVuY3Rpb24gY3JlYXRlSW5zdHJ1bWVudGF0aW9ucygpIHtcclxuICAgIGNvbnN0IG11dGFibGVJbnN0cnVtZW50YXRpb25zID0ge1xyXG4gICAgICAgIGdldChrZXkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGdldCQxKHRoaXMsIGtleSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBnZXQgc2l6ZSgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHNpemUodGhpcyk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBoYXM6IGhhcyQxLFxyXG4gICAgICAgIGFkZCxcclxuICAgICAgICBzZXQ6IHNldCQxLFxyXG4gICAgICAgIGRlbGV0ZTogZGVsZXRlRW50cnksXHJcbiAgICAgICAgY2xlYXIsXHJcbiAgICAgICAgZm9yRWFjaDogY3JlYXRlRm9yRWFjaChmYWxzZSwgZmFsc2UpXHJcbiAgICB9O1xyXG4gICAgY29uc3Qgc2hhbGxvd0luc3RydW1lbnRhdGlvbnMgPSB7XHJcbiAgICAgICAgZ2V0KGtleSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZ2V0JDEodGhpcywga2V5LCBmYWxzZSwgdHJ1ZSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBnZXQgc2l6ZSgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHNpemUodGhpcyk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBoYXM6IGhhcyQxLFxyXG4gICAgICAgIGFkZCxcclxuICAgICAgICBzZXQ6IHNldCQxLFxyXG4gICAgICAgIGRlbGV0ZTogZGVsZXRlRW50cnksXHJcbiAgICAgICAgY2xlYXIsXHJcbiAgICAgICAgZm9yRWFjaDogY3JlYXRlRm9yRWFjaChmYWxzZSwgdHJ1ZSlcclxuICAgIH07XHJcbiAgICBjb25zdCByZWFkb25seUluc3RydW1lbnRhdGlvbnMgPSB7XHJcbiAgICAgICAgZ2V0KGtleSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZ2V0JDEodGhpcywga2V5LCB0cnVlKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGdldCBzaXplKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gc2l6ZSh0aGlzLCB0cnVlKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGhhcyhrZXkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGhhcyQxLmNhbGwodGhpcywga2V5LCB0cnVlKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGFkZDogY3JlYXRlUmVhZG9ubHlNZXRob2QoXCJhZGRcIiAvKiBBREQgKi8pLFxyXG4gICAgICAgIHNldDogY3JlYXRlUmVhZG9ubHlNZXRob2QoXCJzZXRcIiAvKiBTRVQgKi8pLFxyXG4gICAgICAgIGRlbGV0ZTogY3JlYXRlUmVhZG9ubHlNZXRob2QoXCJkZWxldGVcIiAvKiBERUxFVEUgKi8pLFxyXG4gICAgICAgIGNsZWFyOiBjcmVhdGVSZWFkb25seU1ldGhvZChcImNsZWFyXCIgLyogQ0xFQVIgKi8pLFxyXG4gICAgICAgIGZvckVhY2g6IGNyZWF0ZUZvckVhY2godHJ1ZSwgZmFsc2UpXHJcbiAgICB9O1xyXG4gICAgY29uc3Qgc2hhbGxvd1JlYWRvbmx5SW5zdHJ1bWVudGF0aW9ucyA9IHtcclxuICAgICAgICBnZXQoa2V5KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBnZXQkMSh0aGlzLCBrZXksIHRydWUsIHRydWUpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZ2V0IHNpemUoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBzaXplKHRoaXMsIHRydWUpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgaGFzKGtleSkge1xyXG4gICAgICAgICAgICByZXR1cm4gaGFzJDEuY2FsbCh0aGlzLCBrZXksIHRydWUpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgYWRkOiBjcmVhdGVSZWFkb25seU1ldGhvZChcImFkZFwiIC8qIEFERCAqLyksXHJcbiAgICAgICAgc2V0OiBjcmVhdGVSZWFkb25seU1ldGhvZChcInNldFwiIC8qIFNFVCAqLyksXHJcbiAgICAgICAgZGVsZXRlOiBjcmVhdGVSZWFkb25seU1ldGhvZChcImRlbGV0ZVwiIC8qIERFTEVURSAqLyksXHJcbiAgICAgICAgY2xlYXI6IGNyZWF0ZVJlYWRvbmx5TWV0aG9kKFwiY2xlYXJcIiAvKiBDTEVBUiAqLyksXHJcbiAgICAgICAgZm9yRWFjaDogY3JlYXRlRm9yRWFjaCh0cnVlLCB0cnVlKVxyXG4gICAgfTtcclxuICAgIGNvbnN0IGl0ZXJhdG9yTWV0aG9kcyA9IFsna2V5cycsICd2YWx1ZXMnLCAnZW50cmllcycsIFN5bWJvbC5pdGVyYXRvcl07XHJcbiAgICBpdGVyYXRvck1ldGhvZHMuZm9yRWFjaChtZXRob2QgPT4ge1xyXG4gICAgICAgIG11dGFibGVJbnN0cnVtZW50YXRpb25zW21ldGhvZF0gPSBjcmVhdGVJdGVyYWJsZU1ldGhvZChtZXRob2QsIGZhbHNlLCBmYWxzZSk7XHJcbiAgICAgICAgcmVhZG9ubHlJbnN0cnVtZW50YXRpb25zW21ldGhvZF0gPSBjcmVhdGVJdGVyYWJsZU1ldGhvZChtZXRob2QsIHRydWUsIGZhbHNlKTtcclxuICAgICAgICBzaGFsbG93SW5zdHJ1bWVudGF0aW9uc1ttZXRob2RdID0gY3JlYXRlSXRlcmFibGVNZXRob2QobWV0aG9kLCBmYWxzZSwgdHJ1ZSk7XHJcbiAgICAgICAgc2hhbGxvd1JlYWRvbmx5SW5zdHJ1bWVudGF0aW9uc1ttZXRob2RdID0gY3JlYXRlSXRlcmFibGVNZXRob2QobWV0aG9kLCB0cnVlLCB0cnVlKTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIFtcclxuICAgICAgICBtdXRhYmxlSW5zdHJ1bWVudGF0aW9ucyxcclxuICAgICAgICByZWFkb25seUluc3RydW1lbnRhdGlvbnMsXHJcbiAgICAgICAgc2hhbGxvd0luc3RydW1lbnRhdGlvbnMsXHJcbiAgICAgICAgc2hhbGxvd1JlYWRvbmx5SW5zdHJ1bWVudGF0aW9uc1xyXG4gICAgXTtcclxufVxyXG5jb25zdCBbbXV0YWJsZUluc3RydW1lbnRhdGlvbnMsIHJlYWRvbmx5SW5zdHJ1bWVudGF0aW9ucywgc2hhbGxvd0luc3RydW1lbnRhdGlvbnMsIHNoYWxsb3dSZWFkb25seUluc3RydW1lbnRhdGlvbnNdID0gLyogI19fUFVSRV9fKi8gY3JlYXRlSW5zdHJ1bWVudGF0aW9ucygpO1xyXG5mdW5jdGlvbiBjcmVhdGVJbnN0cnVtZW50YXRpb25HZXR0ZXIoaXNSZWFkb25seSwgc2hhbGxvdykge1xyXG4gICAgY29uc3QgaW5zdHJ1bWVudGF0aW9ucyA9IHNoYWxsb3dcclxuICAgICAgICA/IGlzUmVhZG9ubHlcclxuICAgICAgICAgICAgPyBzaGFsbG93UmVhZG9ubHlJbnN0cnVtZW50YXRpb25zXHJcbiAgICAgICAgICAgIDogc2hhbGxvd0luc3RydW1lbnRhdGlvbnNcclxuICAgICAgICA6IGlzUmVhZG9ubHlcclxuICAgICAgICAgICAgPyByZWFkb25seUluc3RydW1lbnRhdGlvbnNcclxuICAgICAgICAgICAgOiBtdXRhYmxlSW5zdHJ1bWVudGF0aW9ucztcclxuICAgIHJldHVybiAodGFyZ2V0LCBrZXksIHJlY2VpdmVyKSA9PiB7XHJcbiAgICAgICAgaWYgKGtleSA9PT0gXCJfX3ZfaXNSZWFjdGl2ZVwiIC8qIElTX1JFQUNUSVZFICovKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAhaXNSZWFkb25seTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoa2V5ID09PSBcIl9fdl9pc1JlYWRvbmx5XCIgLyogSVNfUkVBRE9OTFkgKi8pIHtcclxuICAgICAgICAgICAgcmV0dXJuIGlzUmVhZG9ubHk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGtleSA9PT0gXCJfX3ZfcmF3XCIgLyogUkFXICovKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0YXJnZXQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBSZWZsZWN0LmdldChoYXNPd24oaW5zdHJ1bWVudGF0aW9ucywga2V5KSAmJiBrZXkgaW4gdGFyZ2V0XHJcbiAgICAgICAgICAgID8gaW5zdHJ1bWVudGF0aW9uc1xyXG4gICAgICAgICAgICA6IHRhcmdldCwga2V5LCByZWNlaXZlcik7XHJcbiAgICB9O1xyXG59XHJcbmNvbnN0IG11dGFibGVDb2xsZWN0aW9uSGFuZGxlcnMgPSB7XHJcbiAgICBnZXQ6IC8qI19fUFVSRV9fKi8gY3JlYXRlSW5zdHJ1bWVudGF0aW9uR2V0dGVyKGZhbHNlLCBmYWxzZSlcclxufTtcclxuY29uc3Qgc2hhbGxvd0NvbGxlY3Rpb25IYW5kbGVycyA9IHtcclxuICAgIGdldDogLyojX19QVVJFX18qLyBjcmVhdGVJbnN0cnVtZW50YXRpb25HZXR0ZXIoZmFsc2UsIHRydWUpXHJcbn07XHJcbmNvbnN0IHJlYWRvbmx5Q29sbGVjdGlvbkhhbmRsZXJzID0ge1xyXG4gICAgZ2V0OiAvKiNfX1BVUkVfXyovIGNyZWF0ZUluc3RydW1lbnRhdGlvbkdldHRlcih0cnVlLCBmYWxzZSlcclxufTtcclxuY29uc3Qgc2hhbGxvd1JlYWRvbmx5Q29sbGVjdGlvbkhhbmRsZXJzID0ge1xyXG4gICAgZ2V0OiAvKiNfX1BVUkVfXyovIGNyZWF0ZUluc3RydW1lbnRhdGlvbkdldHRlcih0cnVlLCB0cnVlKVxyXG59O1xyXG5mdW5jdGlvbiBjaGVja0lkZW50aXR5S2V5cyh0YXJnZXQsIGhhcywga2V5KSB7XHJcbiAgICBjb25zdCByYXdLZXkgPSB0b1JhdyhrZXkpO1xyXG4gICAgaWYgKHJhd0tleSAhPT0ga2V5ICYmIGhhcy5jYWxsKHRhcmdldCwgcmF3S2V5KSkge1xyXG4gICAgICAgIGNvbnN0IHR5cGUgPSB0b1Jhd1R5cGUodGFyZ2V0KTtcclxuICAgICAgICBjb25zb2xlLndhcm4oYFJlYWN0aXZlICR7dHlwZX0gY29udGFpbnMgYm90aCB0aGUgcmF3IGFuZCByZWFjdGl2ZSBgICtcclxuICAgICAgICAgICAgYHZlcnNpb25zIG9mIHRoZSBzYW1lIG9iamVjdCR7dHlwZSA9PT0gYE1hcGAgPyBgIGFzIGtleXNgIDogYGB9LCBgICtcclxuICAgICAgICAgICAgYHdoaWNoIGNhbiBsZWFkIHRvIGluY29uc2lzdGVuY2llcy4gYCArXHJcbiAgICAgICAgICAgIGBBdm9pZCBkaWZmZXJlbnRpYXRpbmcgYmV0d2VlbiB0aGUgcmF3IGFuZCByZWFjdGl2ZSB2ZXJzaW9ucyBgICtcclxuICAgICAgICAgICAgYG9mIGFuIG9iamVjdCBhbmQgb25seSB1c2UgdGhlIHJlYWN0aXZlIHZlcnNpb24gaWYgcG9zc2libGUuYCk7XHJcbiAgICB9XHJcbn1cblxuY29uc3QgcmVhY3RpdmVNYXAgPSBuZXcgV2Vha01hcCgpO1xyXG5jb25zdCBzaGFsbG93UmVhY3RpdmVNYXAgPSBuZXcgV2Vha01hcCgpO1xyXG5jb25zdCByZWFkb25seU1hcCA9IG5ldyBXZWFrTWFwKCk7XHJcbmNvbnN0IHNoYWxsb3dSZWFkb25seU1hcCA9IG5ldyBXZWFrTWFwKCk7XHJcbmZ1bmN0aW9uIHRhcmdldFR5cGVNYXAocmF3VHlwZSkge1xyXG4gICAgc3dpdGNoIChyYXdUeXBlKSB7XHJcbiAgICAgICAgY2FzZSAnT2JqZWN0JzpcclxuICAgICAgICBjYXNlICdBcnJheSc6XHJcbiAgICAgICAgICAgIHJldHVybiAxIC8qIENPTU1PTiAqLztcclxuICAgICAgICBjYXNlICdNYXAnOlxyXG4gICAgICAgIGNhc2UgJ1NldCc6XHJcbiAgICAgICAgY2FzZSAnV2Vha01hcCc6XHJcbiAgICAgICAgY2FzZSAnV2Vha1NldCc6XHJcbiAgICAgICAgICAgIHJldHVybiAyIC8qIENPTExFQ1RJT04gKi87XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgcmV0dXJuIDAgLyogSU5WQUxJRCAqLztcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBnZXRUYXJnZXRUeXBlKHZhbHVlKSB7XHJcbiAgICByZXR1cm4gdmFsdWVbXCJfX3Zfc2tpcFwiIC8qIFNLSVAgKi9dIHx8ICFPYmplY3QuaXNFeHRlbnNpYmxlKHZhbHVlKVxyXG4gICAgICAgID8gMCAvKiBJTlZBTElEICovXHJcbiAgICAgICAgOiB0YXJnZXRUeXBlTWFwKHRvUmF3VHlwZSh2YWx1ZSkpO1xyXG59XHJcbmZ1bmN0aW9uIHJlYWN0aXZlKHRhcmdldCkge1xyXG4gICAgLy8gaWYgdHJ5aW5nIHRvIG9ic2VydmUgYSByZWFkb25seSBwcm94eSwgcmV0dXJuIHRoZSByZWFkb25seSB2ZXJzaW9uLlxyXG4gICAgaWYgKGlzUmVhZG9ubHkodGFyZ2V0KSkge1xyXG4gICAgICAgIHJldHVybiB0YXJnZXQ7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gY3JlYXRlUmVhY3RpdmVPYmplY3QodGFyZ2V0LCBmYWxzZSwgbXV0YWJsZUhhbmRsZXJzLCBtdXRhYmxlQ29sbGVjdGlvbkhhbmRsZXJzLCByZWFjdGl2ZU1hcCk7XHJcbn1cclxuLyoqXHJcbiAqIFJldHVybiBhIHNoYWxsb3dseS1yZWFjdGl2ZSBjb3B5IG9mIHRoZSBvcmlnaW5hbCBvYmplY3QsIHdoZXJlIG9ubHkgdGhlIHJvb3RcclxuICogbGV2ZWwgcHJvcGVydGllcyBhcmUgcmVhY3RpdmUuIEl0IGFsc28gZG9lcyBub3QgYXV0by11bndyYXAgcmVmcyAoZXZlbiBhdCB0aGVcclxuICogcm9vdCBsZXZlbCkuXHJcbiAqL1xyXG5mdW5jdGlvbiBzaGFsbG93UmVhY3RpdmUodGFyZ2V0KSB7XHJcbiAgICByZXR1cm4gY3JlYXRlUmVhY3RpdmVPYmplY3QodGFyZ2V0LCBmYWxzZSwgc2hhbGxvd1JlYWN0aXZlSGFuZGxlcnMsIHNoYWxsb3dDb2xsZWN0aW9uSGFuZGxlcnMsIHNoYWxsb3dSZWFjdGl2ZU1hcCk7XHJcbn1cclxuLyoqXHJcbiAqIENyZWF0ZXMgYSByZWFkb25seSBjb3B5IG9mIHRoZSBvcmlnaW5hbCBvYmplY3QuIE5vdGUgdGhlIHJldHVybmVkIGNvcHkgaXMgbm90XHJcbiAqIG1hZGUgcmVhY3RpdmUsIGJ1dCBgcmVhZG9ubHlgIGNhbiBiZSBjYWxsZWQgb24gYW4gYWxyZWFkeSByZWFjdGl2ZSBvYmplY3QuXHJcbiAqL1xyXG5mdW5jdGlvbiByZWFkb25seSh0YXJnZXQpIHtcclxuICAgIHJldHVybiBjcmVhdGVSZWFjdGl2ZU9iamVjdCh0YXJnZXQsIHRydWUsIHJlYWRvbmx5SGFuZGxlcnMsIHJlYWRvbmx5Q29sbGVjdGlvbkhhbmRsZXJzLCByZWFkb25seU1hcCk7XHJcbn1cclxuLyoqXHJcbiAqIFJldHVybnMgYSByZWFjdGl2ZS1jb3B5IG9mIHRoZSBvcmlnaW5hbCBvYmplY3QsIHdoZXJlIG9ubHkgdGhlIHJvb3QgbGV2ZWxcclxuICogcHJvcGVydGllcyBhcmUgcmVhZG9ubHksIGFuZCBkb2VzIE5PVCB1bndyYXAgcmVmcyBub3IgcmVjdXJzaXZlbHkgY29udmVydFxyXG4gKiByZXR1cm5lZCBwcm9wZXJ0aWVzLlxyXG4gKiBUaGlzIGlzIHVzZWQgZm9yIGNyZWF0aW5nIHRoZSBwcm9wcyBwcm94eSBvYmplY3QgZm9yIHN0YXRlZnVsIGNvbXBvbmVudHMuXHJcbiAqL1xyXG5mdW5jdGlvbiBzaGFsbG93UmVhZG9ubHkodGFyZ2V0KSB7XHJcbiAgICByZXR1cm4gY3JlYXRlUmVhY3RpdmVPYmplY3QodGFyZ2V0LCB0cnVlLCBzaGFsbG93UmVhZG9ubHlIYW5kbGVycywgc2hhbGxvd1JlYWRvbmx5Q29sbGVjdGlvbkhhbmRsZXJzLCBzaGFsbG93UmVhZG9ubHlNYXApO1xyXG59XHJcbmZ1bmN0aW9uIGNyZWF0ZVJlYWN0aXZlT2JqZWN0KHRhcmdldCwgaXNSZWFkb25seSwgYmFzZUhhbmRsZXJzLCBjb2xsZWN0aW9uSGFuZGxlcnMsIHByb3h5TWFwKSB7XHJcbiAgICBpZiAoIWlzT2JqZWN0KHRhcmdldCkpIHtcclxuICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihgdmFsdWUgY2Fubm90IGJlIG1hZGUgcmVhY3RpdmU6ICR7U3RyaW5nKHRhcmdldCl9YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0YXJnZXQ7XHJcbiAgICB9XHJcbiAgICAvLyB0YXJnZXQgaXMgYWxyZWFkeSBhIFByb3h5LCByZXR1cm4gaXQuXHJcbiAgICAvLyBleGNlcHRpb246IGNhbGxpbmcgcmVhZG9ubHkoKSBvbiBhIHJlYWN0aXZlIG9iamVjdFxyXG4gICAgaWYgKHRhcmdldFtcIl9fdl9yYXdcIiAvKiBSQVcgKi9dICYmXHJcbiAgICAgICAgIShpc1JlYWRvbmx5ICYmIHRhcmdldFtcIl9fdl9pc1JlYWN0aXZlXCIgLyogSVNfUkVBQ1RJVkUgKi9dKSkge1xyXG4gICAgICAgIHJldHVybiB0YXJnZXQ7XHJcbiAgICB9XHJcbiAgICAvLyB0YXJnZXQgYWxyZWFkeSBoYXMgY29ycmVzcG9uZGluZyBQcm94eVxyXG4gICAgY29uc3QgZXhpc3RpbmdQcm94eSA9IHByb3h5TWFwLmdldCh0YXJnZXQpO1xyXG4gICAgaWYgKGV4aXN0aW5nUHJveHkpIHtcclxuICAgICAgICByZXR1cm4gZXhpc3RpbmdQcm94eTtcclxuICAgIH1cclxuICAgIC8vIG9ubHkgYSB3aGl0ZWxpc3Qgb2YgdmFsdWUgdHlwZXMgY2FuIGJlIG9ic2VydmVkLlxyXG4gICAgY29uc3QgdGFyZ2V0VHlwZSA9IGdldFRhcmdldFR5cGUodGFyZ2V0KTtcclxuICAgIGlmICh0YXJnZXRUeXBlID09PSAwIC8qIElOVkFMSUQgKi8pIHtcclxuICAgICAgICByZXR1cm4gdGFyZ2V0O1xyXG4gICAgfVxyXG4gICAgY29uc3QgcHJveHkgPSBuZXcgUHJveHkodGFyZ2V0LCB0YXJnZXRUeXBlID09PSAyIC8qIENPTExFQ1RJT04gKi8gPyBjb2xsZWN0aW9uSGFuZGxlcnMgOiBiYXNlSGFuZGxlcnMpO1xyXG4gICAgcHJveHlNYXAuc2V0KHRhcmdldCwgcHJveHkpO1xyXG4gICAgcmV0dXJuIHByb3h5O1xyXG59XHJcbmZ1bmN0aW9uIGlzUmVhY3RpdmUodmFsdWUpIHtcclxuICAgIGlmIChpc1JlYWRvbmx5KHZhbHVlKSkge1xyXG4gICAgICAgIHJldHVybiBpc1JlYWN0aXZlKHZhbHVlW1wiX192X3Jhd1wiIC8qIFJBVyAqL10pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuICEhKHZhbHVlICYmIHZhbHVlW1wiX192X2lzUmVhY3RpdmVcIiAvKiBJU19SRUFDVElWRSAqL10pO1xyXG59XHJcbmZ1bmN0aW9uIGlzUmVhZG9ubHkodmFsdWUpIHtcclxuICAgIHJldHVybiAhISh2YWx1ZSAmJiB2YWx1ZVtcIl9fdl9pc1JlYWRvbmx5XCIgLyogSVNfUkVBRE9OTFkgKi9dKTtcclxufVxyXG5mdW5jdGlvbiBpc1NoYWxsb3codmFsdWUpIHtcclxuICAgIHJldHVybiAhISh2YWx1ZSAmJiB2YWx1ZVtcIl9fdl9pc1NoYWxsb3dcIiAvKiBJU19TSEFMTE9XICovXSk7XHJcbn1cclxuZnVuY3Rpb24gaXNQcm94eSh2YWx1ZSkge1xyXG4gICAgcmV0dXJuIGlzUmVhY3RpdmUodmFsdWUpIHx8IGlzUmVhZG9ubHkodmFsdWUpO1xyXG59XHJcbmZ1bmN0aW9uIHRvUmF3KG9ic2VydmVkKSB7XHJcbiAgICBjb25zdCByYXcgPSBvYnNlcnZlZCAmJiBvYnNlcnZlZFtcIl9fdl9yYXdcIiAvKiBSQVcgKi9dO1xyXG4gICAgcmV0dXJuIHJhdyA/IHRvUmF3KHJhdykgOiBvYnNlcnZlZDtcclxufVxyXG5mdW5jdGlvbiBtYXJrUmF3KHZhbHVlKSB7XHJcbiAgICBkZWYodmFsdWUsIFwiX192X3NraXBcIiAvKiBTS0lQICovLCB0cnVlKTtcclxuICAgIHJldHVybiB2YWx1ZTtcclxufVxyXG5jb25zdCB0b1JlYWN0aXZlID0gKHZhbHVlKSA9PiBpc09iamVjdCh2YWx1ZSkgPyByZWFjdGl2ZSh2YWx1ZSkgOiB2YWx1ZTtcclxuY29uc3QgdG9SZWFkb25seSA9ICh2YWx1ZSkgPT4gaXNPYmplY3QodmFsdWUpID8gcmVhZG9ubHkodmFsdWUpIDogdmFsdWU7XG5cbmZ1bmN0aW9uIHRyYWNrUmVmVmFsdWUocmVmKSB7XHJcbiAgICBpZiAoc2hvdWxkVHJhY2sgJiYgYWN0aXZlRWZmZWN0KSB7XHJcbiAgICAgICAgcmVmID0gdG9SYXcocmVmKTtcclxuICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgIHRyYWNrRWZmZWN0cyhyZWYuZGVwIHx8IChyZWYuZGVwID0gY3JlYXRlRGVwKCkpLCB7XHJcbiAgICAgICAgICAgICAgICB0YXJnZXQ6IHJlZixcclxuICAgICAgICAgICAgICAgIHR5cGU6IFwiZ2V0XCIgLyogR0VUICovLFxyXG4gICAgICAgICAgICAgICAga2V5OiAndmFsdWUnXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdHJhY2tFZmZlY3RzKHJlZi5kZXAgfHwgKHJlZi5kZXAgPSBjcmVhdGVEZXAoKSkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiB0cmlnZ2VyUmVmVmFsdWUocmVmLCBuZXdWYWwpIHtcclxuICAgIHJlZiA9IHRvUmF3KHJlZik7XHJcbiAgICBpZiAocmVmLmRlcCkge1xyXG4gICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgdHJpZ2dlckVmZmVjdHMocmVmLmRlcCwge1xyXG4gICAgICAgICAgICAgICAgdGFyZ2V0OiByZWYsXHJcbiAgICAgICAgICAgICAgICB0eXBlOiBcInNldFwiIC8qIFNFVCAqLyxcclxuICAgICAgICAgICAgICAgIGtleTogJ3ZhbHVlJyxcclxuICAgICAgICAgICAgICAgIG5ld1ZhbHVlOiBuZXdWYWxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0cmlnZ2VyRWZmZWN0cyhyZWYuZGVwKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gaXNSZWYocikge1xyXG4gICAgcmV0dXJuICEhKHIgJiYgci5fX3ZfaXNSZWYgPT09IHRydWUpO1xyXG59XHJcbmZ1bmN0aW9uIHJlZih2YWx1ZSkge1xyXG4gICAgcmV0dXJuIGNyZWF0ZVJlZih2YWx1ZSwgZmFsc2UpO1xyXG59XHJcbmZ1bmN0aW9uIHNoYWxsb3dSZWYodmFsdWUpIHtcclxuICAgIHJldHVybiBjcmVhdGVSZWYodmFsdWUsIHRydWUpO1xyXG59XHJcbmZ1bmN0aW9uIGNyZWF0ZVJlZihyYXdWYWx1ZSwgc2hhbGxvdykge1xyXG4gICAgaWYgKGlzUmVmKHJhd1ZhbHVlKSkge1xyXG4gICAgICAgIHJldHVybiByYXdWYWx1ZTtcclxuICAgIH1cclxuICAgIHJldHVybiBuZXcgUmVmSW1wbChyYXdWYWx1ZSwgc2hhbGxvdyk7XHJcbn1cclxuY2xhc3MgUmVmSW1wbCB7XHJcbiAgICBjb25zdHJ1Y3Rvcih2YWx1ZSwgX192X2lzU2hhbGxvdykge1xyXG4gICAgICAgIHRoaXMuX192X2lzU2hhbGxvdyA9IF9fdl9pc1NoYWxsb3c7XHJcbiAgICAgICAgdGhpcy5kZXAgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgdGhpcy5fX3ZfaXNSZWYgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuX3Jhd1ZhbHVlID0gX192X2lzU2hhbGxvdyA/IHZhbHVlIDogdG9SYXcodmFsdWUpO1xyXG4gICAgICAgIHRoaXMuX3ZhbHVlID0gX192X2lzU2hhbGxvdyA/IHZhbHVlIDogdG9SZWFjdGl2ZSh2YWx1ZSk7XHJcbiAgICB9XHJcbiAgICBnZXQgdmFsdWUoKSB7XHJcbiAgICAgICAgdHJhY2tSZWZWYWx1ZSh0aGlzKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5fdmFsdWU7XHJcbiAgICB9XHJcbiAgICBzZXQgdmFsdWUobmV3VmFsKSB7XHJcbiAgICAgICAgbmV3VmFsID0gdGhpcy5fX3ZfaXNTaGFsbG93ID8gbmV3VmFsIDogdG9SYXcobmV3VmFsKTtcclxuICAgICAgICBpZiAoaGFzQ2hhbmdlZChuZXdWYWwsIHRoaXMuX3Jhd1ZhbHVlKSkge1xyXG4gICAgICAgICAgICB0aGlzLl9yYXdWYWx1ZSA9IG5ld1ZhbDtcclxuICAgICAgICAgICAgdGhpcy5fdmFsdWUgPSB0aGlzLl9fdl9pc1NoYWxsb3cgPyBuZXdWYWwgOiB0b1JlYWN0aXZlKG5ld1ZhbCk7XHJcbiAgICAgICAgICAgIHRyaWdnZXJSZWZWYWx1ZSh0aGlzLCBuZXdWYWwpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiB0cmlnZ2VyUmVmKHJlZikge1xyXG4gICAgdHJpZ2dlclJlZlZhbHVlKHJlZiwgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpID8gcmVmLnZhbHVlIDogdm9pZCAwKTtcclxufVxyXG5mdW5jdGlvbiB1bnJlZihyZWYpIHtcclxuICAgIHJldHVybiBpc1JlZihyZWYpID8gcmVmLnZhbHVlIDogcmVmO1xyXG59XHJcbmNvbnN0IHNoYWxsb3dVbndyYXBIYW5kbGVycyA9IHtcclxuICAgIGdldDogKHRhcmdldCwga2V5LCByZWNlaXZlcikgPT4gdW5yZWYoUmVmbGVjdC5nZXQodGFyZ2V0LCBrZXksIHJlY2VpdmVyKSksXHJcbiAgICBzZXQ6ICh0YXJnZXQsIGtleSwgdmFsdWUsIHJlY2VpdmVyKSA9PiB7XHJcbiAgICAgICAgY29uc3Qgb2xkVmFsdWUgPSB0YXJnZXRba2V5XTtcclxuICAgICAgICBpZiAoaXNSZWYob2xkVmFsdWUpICYmICFpc1JlZih2YWx1ZSkpIHtcclxuICAgICAgICAgICAgb2xkVmFsdWUudmFsdWUgPSB2YWx1ZTtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gUmVmbGVjdC5zZXQodGFyZ2V0LCBrZXksIHZhbHVlLCByZWNlaXZlcik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG5mdW5jdGlvbiBwcm94eVJlZnMob2JqZWN0V2l0aFJlZnMpIHtcclxuICAgIHJldHVybiBpc1JlYWN0aXZlKG9iamVjdFdpdGhSZWZzKVxyXG4gICAgICAgID8gb2JqZWN0V2l0aFJlZnNcclxuICAgICAgICA6IG5ldyBQcm94eShvYmplY3RXaXRoUmVmcywgc2hhbGxvd1Vud3JhcEhhbmRsZXJzKTtcclxufVxyXG5jbGFzcyBDdXN0b21SZWZJbXBsIHtcclxuICAgIGNvbnN0cnVjdG9yKGZhY3RvcnkpIHtcclxuICAgICAgICB0aGlzLmRlcCA9IHVuZGVmaW5lZDtcclxuICAgICAgICB0aGlzLl9fdl9pc1JlZiA9IHRydWU7XHJcbiAgICAgICAgY29uc3QgeyBnZXQsIHNldCB9ID0gZmFjdG9yeSgoKSA9PiB0cmFja1JlZlZhbHVlKHRoaXMpLCAoKSA9PiB0cmlnZ2VyUmVmVmFsdWUodGhpcykpO1xyXG4gICAgICAgIHRoaXMuX2dldCA9IGdldDtcclxuICAgICAgICB0aGlzLl9zZXQgPSBzZXQ7XHJcbiAgICB9XHJcbiAgICBnZXQgdmFsdWUoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2dldCgpO1xyXG4gICAgfVxyXG4gICAgc2V0IHZhbHVlKG5ld1ZhbCkge1xyXG4gICAgICAgIHRoaXMuX3NldChuZXdWYWwpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGN1c3RvbVJlZihmYWN0b3J5KSB7XHJcbiAgICByZXR1cm4gbmV3IEN1c3RvbVJlZkltcGwoZmFjdG9yeSk7XHJcbn1cclxuZnVuY3Rpb24gdG9SZWZzKG9iamVjdCkge1xyXG4gICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiAhaXNQcm94eShvYmplY3QpKSB7XHJcbiAgICAgICAgY29uc29sZS53YXJuKGB0b1JlZnMoKSBleHBlY3RzIGEgcmVhY3RpdmUgb2JqZWN0IGJ1dCByZWNlaXZlZCBhIHBsYWluIG9uZS5gKTtcclxuICAgIH1cclxuICAgIGNvbnN0IHJldCA9IGlzQXJyYXkob2JqZWN0KSA/IG5ldyBBcnJheShvYmplY3QubGVuZ3RoKSA6IHt9O1xyXG4gICAgZm9yIChjb25zdCBrZXkgaW4gb2JqZWN0KSB7XHJcbiAgICAgICAgcmV0W2tleV0gPSB0b1JlZihvYmplY3QsIGtleSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmV0O1xyXG59XHJcbmNsYXNzIE9iamVjdFJlZkltcGwge1xyXG4gICAgY29uc3RydWN0b3IoX29iamVjdCwgX2tleSwgX2RlZmF1bHRWYWx1ZSkge1xyXG4gICAgICAgIHRoaXMuX29iamVjdCA9IF9vYmplY3Q7XHJcbiAgICAgICAgdGhpcy5fa2V5ID0gX2tleTtcclxuICAgICAgICB0aGlzLl9kZWZhdWx0VmFsdWUgPSBfZGVmYXVsdFZhbHVlO1xyXG4gICAgICAgIHRoaXMuX192X2lzUmVmID0gdHJ1ZTtcclxuICAgIH1cclxuICAgIGdldCB2YWx1ZSgpIHtcclxuICAgICAgICBjb25zdCB2YWwgPSB0aGlzLl9vYmplY3RbdGhpcy5fa2V5XTtcclxuICAgICAgICByZXR1cm4gdmFsID09PSB1bmRlZmluZWQgPyB0aGlzLl9kZWZhdWx0VmFsdWUgOiB2YWw7XHJcbiAgICB9XHJcbiAgICBzZXQgdmFsdWUobmV3VmFsKSB7XHJcbiAgICAgICAgdGhpcy5fb2JqZWN0W3RoaXMuX2tleV0gPSBuZXdWYWw7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gdG9SZWYob2JqZWN0LCBrZXksIGRlZmF1bHRWYWx1ZSkge1xyXG4gICAgY29uc3QgdmFsID0gb2JqZWN0W2tleV07XHJcbiAgICByZXR1cm4gaXNSZWYodmFsKVxyXG4gICAgICAgID8gdmFsXHJcbiAgICAgICAgOiBuZXcgT2JqZWN0UmVmSW1wbChvYmplY3QsIGtleSwgZGVmYXVsdFZhbHVlKTtcclxufVxuXG5jbGFzcyBDb21wdXRlZFJlZkltcGwge1xyXG4gICAgY29uc3RydWN0b3IoZ2V0dGVyLCBfc2V0dGVyLCBpc1JlYWRvbmx5LCBpc1NTUikge1xyXG4gICAgICAgIHRoaXMuX3NldHRlciA9IF9zZXR0ZXI7XHJcbiAgICAgICAgdGhpcy5kZXAgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgdGhpcy5fX3ZfaXNSZWYgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuX2RpcnR5ID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLmVmZmVjdCA9IG5ldyBSZWFjdGl2ZUVmZmVjdChnZXR0ZXIsICgpID0+IHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLl9kaXJ0eSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZGlydHkgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdHJpZ2dlclJlZlZhbHVlKHRoaXMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5lZmZlY3QuY29tcHV0ZWQgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuZWZmZWN0LmFjdGl2ZSA9IHRoaXMuX2NhY2hlYWJsZSA9ICFpc1NTUjtcclxuICAgICAgICB0aGlzW1wiX192X2lzUmVhZG9ubHlcIiAvKiBJU19SRUFET05MWSAqL10gPSBpc1JlYWRvbmx5O1xyXG4gICAgfVxyXG4gICAgZ2V0IHZhbHVlKCkge1xyXG4gICAgICAgIC8vIHRoZSBjb21wdXRlZCByZWYgbWF5IGdldCB3cmFwcGVkIGJ5IG90aGVyIHByb3hpZXMgZS5nLiByZWFkb25seSgpICMzMzc2XHJcbiAgICAgICAgY29uc3Qgc2VsZiA9IHRvUmF3KHRoaXMpO1xyXG4gICAgICAgIHRyYWNrUmVmVmFsdWUoc2VsZik7XHJcbiAgICAgICAgaWYgKHNlbGYuX2RpcnR5IHx8ICFzZWxmLl9jYWNoZWFibGUpIHtcclxuICAgICAgICAgICAgc2VsZi5fZGlydHkgPSBmYWxzZTtcclxuICAgICAgICAgICAgc2VsZi5fdmFsdWUgPSBzZWxmLmVmZmVjdC5ydW4oKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHNlbGYuX3ZhbHVlO1xyXG4gICAgfVxyXG4gICAgc2V0IHZhbHVlKG5ld1ZhbHVlKSB7XHJcbiAgICAgICAgdGhpcy5fc2V0dGVyKG5ld1ZhbHVlKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBjb21wdXRlZChnZXR0ZXJPck9wdGlvbnMsIGRlYnVnT3B0aW9ucywgaXNTU1IgPSBmYWxzZSkge1xyXG4gICAgbGV0IGdldHRlcjtcclxuICAgIGxldCBzZXR0ZXI7XHJcbiAgICBjb25zdCBvbmx5R2V0dGVyID0gaXNGdW5jdGlvbihnZXR0ZXJPck9wdGlvbnMpO1xyXG4gICAgaWYgKG9ubHlHZXR0ZXIpIHtcclxuICAgICAgICBnZXR0ZXIgPSBnZXR0ZXJPck9wdGlvbnM7XHJcbiAgICAgICAgc2V0dGVyID0gKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpXHJcbiAgICAgICAgICAgID8gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCdXcml0ZSBvcGVyYXRpb24gZmFpbGVkOiBjb21wdXRlZCB2YWx1ZSBpcyByZWFkb25seScpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIDogTk9PUDtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIGdldHRlciA9IGdldHRlck9yT3B0aW9ucy5nZXQ7XHJcbiAgICAgICAgc2V0dGVyID0gZ2V0dGVyT3JPcHRpb25zLnNldDtcclxuICAgIH1cclxuICAgIGNvbnN0IGNSZWYgPSBuZXcgQ29tcHV0ZWRSZWZJbXBsKGdldHRlciwgc2V0dGVyLCBvbmx5R2V0dGVyIHx8ICFzZXR0ZXIsIGlzU1NSKTtcclxuICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiYgZGVidWdPcHRpb25zICYmICFpc1NTUikge1xyXG4gICAgICAgIGNSZWYuZWZmZWN0Lm9uVHJhY2sgPSBkZWJ1Z09wdGlvbnMub25UcmFjaztcclxuICAgICAgICBjUmVmLmVmZmVjdC5vblRyaWdnZXIgPSBkZWJ1Z09wdGlvbnMub25UcmlnZ2VyO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGNSZWY7XHJcbn1cblxudmFyIF9hO1xyXG5jb25zdCB0aWNrID0gUHJvbWlzZS5yZXNvbHZlKCk7XHJcbmNvbnN0IHF1ZXVlID0gW107XHJcbmxldCBxdWV1ZWQgPSBmYWxzZTtcclxuY29uc3Qgc2NoZWR1bGVyID0gKGZuKSA9PiB7XHJcbiAgICBxdWV1ZS5wdXNoKGZuKTtcclxuICAgIGlmICghcXVldWVkKSB7XHJcbiAgICAgICAgcXVldWVkID0gdHJ1ZTtcclxuICAgICAgICB0aWNrLnRoZW4oZmx1c2gpO1xyXG4gICAgfVxyXG59O1xyXG5jb25zdCBmbHVzaCA9ICgpID0+IHtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcXVldWUubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBxdWV1ZVtpXSgpO1xyXG4gICAgfVxyXG4gICAgcXVldWUubGVuZ3RoID0gMDtcclxuICAgIHF1ZXVlZCA9IGZhbHNlO1xyXG59O1xyXG5jbGFzcyBEZWZlcnJlZENvbXB1dGVkUmVmSW1wbCB7XHJcbiAgICBjb25zdHJ1Y3RvcihnZXR0ZXIpIHtcclxuICAgICAgICB0aGlzLmRlcCA9IHVuZGVmaW5lZDtcclxuICAgICAgICB0aGlzLl9kaXJ0eSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5fX3ZfaXNSZWYgPSB0cnVlO1xyXG4gICAgICAgIHRoaXNbX2FdID0gdHJ1ZTtcclxuICAgICAgICBsZXQgY29tcGFyZVRhcmdldDtcclxuICAgICAgICBsZXQgaGFzQ29tcGFyZVRhcmdldCA9IGZhbHNlO1xyXG4gICAgICAgIGxldCBzY2hlZHVsZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmVmZmVjdCA9IG5ldyBSZWFjdGl2ZUVmZmVjdChnZXR0ZXIsIChjb21wdXRlZFRyaWdnZXIpID0+IHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZGVwKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY29tcHV0ZWRUcmlnZ2VyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29tcGFyZVRhcmdldCA9IHRoaXMuX3ZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGhhc0NvbXBhcmVUYXJnZXQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoIXNjaGVkdWxlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlVG9Db21wYXJlID0gaGFzQ29tcGFyZVRhcmdldCA/IGNvbXBhcmVUYXJnZXQgOiB0aGlzLl92YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICBzY2hlZHVsZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGhhc0NvbXBhcmVUYXJnZXQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBzY2hlZHVsZXIoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5lZmZlY3QuYWN0aXZlICYmIHRoaXMuX2dldCgpICE9PSB2YWx1ZVRvQ29tcGFyZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJpZ2dlclJlZlZhbHVlKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjaGVkdWxlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gY2hhaW5lZCB1cHN0cmVhbSBjb21wdXRlZHMgYXJlIG5vdGlmaWVkIHN5bmNocm9ub3VzbHkgdG8gZW5zdXJlXHJcbiAgICAgICAgICAgICAgICAvLyB2YWx1ZSBpbnZhbGlkYXRpb24gaW4gY2FzZSBvZiBzeW5jIGFjY2Vzczsgbm9ybWFsIGVmZmVjdHMgYXJlXHJcbiAgICAgICAgICAgICAgICAvLyBkZWZlcnJlZCB0byBiZSB0cmlnZ2VyZWQgaW4gc2NoZWR1bGVyLlxyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHRoaXMuZGVwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUuY29tcHV0ZWQgaW5zdGFuY2VvZiBEZWZlcnJlZENvbXB1dGVkUmVmSW1wbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLnNjaGVkdWxlcih0cnVlIC8qIGNvbXB1dGVkVHJpZ2dlciAqLyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuX2RpcnR5ID0gdHJ1ZTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmVmZmVjdC5jb21wdXRlZCA9IHRoaXM7XHJcbiAgICB9XHJcbiAgICBfZ2V0KCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9kaXJ0eSkge1xyXG4gICAgICAgICAgICB0aGlzLl9kaXJ0eSA9IGZhbHNlO1xyXG4gICAgICAgICAgICByZXR1cm4gKHRoaXMuX3ZhbHVlID0gdGhpcy5lZmZlY3QucnVuKCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5fdmFsdWU7XHJcbiAgICB9XHJcbiAgICBnZXQgdmFsdWUoKSB7XHJcbiAgICAgICAgdHJhY2tSZWZWYWx1ZSh0aGlzKTtcclxuICAgICAgICAvLyB0aGUgY29tcHV0ZWQgcmVmIG1heSBnZXQgd3JhcHBlZCBieSBvdGhlciBwcm94aWVzIGUuZy4gcmVhZG9ubHkoKSAjMzM3NlxyXG4gICAgICAgIHJldHVybiB0b1Jhdyh0aGlzKS5fZ2V0KCk7XHJcbiAgICB9XHJcbn1cclxuX2EgPSBcIl9fdl9pc1JlYWRvbmx5XCIgLyogSVNfUkVBRE9OTFkgKi87XHJcbmZ1bmN0aW9uIGRlZmVycmVkQ29tcHV0ZWQoZ2V0dGVyKSB7XHJcbiAgICByZXR1cm4gbmV3IERlZmVycmVkQ29tcHV0ZWRSZWZJbXBsKGdldHRlcik7XHJcbn1cblxuZXhwb3J0IHsgRWZmZWN0U2NvcGUsIElURVJBVEVfS0VZLCBSZWFjdGl2ZUVmZmVjdCwgY29tcHV0ZWQsIGN1c3RvbVJlZiwgZGVmZXJyZWRDb21wdXRlZCwgZWZmZWN0LCBlZmZlY3RTY29wZSwgZW5hYmxlVHJhY2tpbmcsIGdldEN1cnJlbnRTY29wZSwgaXNQcm94eSwgaXNSZWFjdGl2ZSwgaXNSZWFkb25seSwgaXNSZWYsIGlzU2hhbGxvdywgbWFya1Jhdywgb25TY29wZURpc3Bvc2UsIHBhdXNlVHJhY2tpbmcsIHByb3h5UmVmcywgcmVhY3RpdmUsIHJlYWRvbmx5LCByZWYsIHJlc2V0VHJhY2tpbmcsIHNoYWxsb3dSZWFjdGl2ZSwgc2hhbGxvd1JlYWRvbmx5LCBzaGFsbG93UmVmLCBzdG9wLCB0b1JhdywgdG9SZWYsIHRvUmVmcywgdHJhY2ssIHRyaWdnZXIsIHRyaWdnZXJSZWYsIHVucmVmIH07XG4iLCJpbXBvcnQgeyBwYXVzZVRyYWNraW5nLCByZXNldFRyYWNraW5nLCBpc1JlZiwgdG9SYXcsIGlzU2hhbGxvdyBhcyBpc1NoYWxsb3ckMSwgaXNSZWFjdGl2ZSwgUmVhY3RpdmVFZmZlY3QsIHJlZiwgcmVhY3RpdmUsIHNoYWxsb3dSZWFjdGl2ZSwgdHJpZ2dlciwgaXNQcm94eSwgc2hhbGxvd1JlYWRvbmx5LCB0cmFjaywgRWZmZWN0U2NvcGUsIG1hcmtSYXcsIHByb3h5UmVmcywgY29tcHV0ZWQgYXMgY29tcHV0ZWQkMSwgaXNSZWFkb25seSB9IGZyb20gJ0B2dWUvcmVhY3Rpdml0eSc7XG5leHBvcnQgeyBFZmZlY3RTY29wZSwgUmVhY3RpdmVFZmZlY3QsIGN1c3RvbVJlZiwgZWZmZWN0LCBlZmZlY3RTY29wZSwgZ2V0Q3VycmVudFNjb3BlLCBpc1Byb3h5LCBpc1JlYWN0aXZlLCBpc1JlYWRvbmx5LCBpc1JlZiwgaXNTaGFsbG93LCBtYXJrUmF3LCBvblNjb3BlRGlzcG9zZSwgcHJveHlSZWZzLCByZWFjdGl2ZSwgcmVhZG9ubHksIHJlZiwgc2hhbGxvd1JlYWN0aXZlLCBzaGFsbG93UmVhZG9ubHksIHNoYWxsb3dSZWYsIHN0b3AsIHRvUmF3LCB0b1JlZiwgdG9SZWZzLCB0cmlnZ2VyUmVmLCB1bnJlZiB9IGZyb20gJ0B2dWUvcmVhY3Rpdml0eSc7XG5pbXBvcnQgeyBpc1N0cmluZywgaXNGdW5jdGlvbiwgaXNQcm9taXNlLCBpc0FycmF5LCBOT09QLCBnZXRHbG9iYWxUaGlzLCBleHRlbmQsIEVNUFRZX09CSiwgdG9IYW5kbGVyS2V5LCB0b051bWJlciwgaHlwaGVuYXRlLCBjYW1lbGl6ZSwgaXNPbiwgaGFzT3duLCBpc01vZGVsTGlzdGVuZXIsIGhhc0NoYW5nZWQsIHJlbW92ZSwgaXNPYmplY3QsIGlzU2V0LCBpc01hcCwgaXNQbGFpbk9iamVjdCwgaW52b2tlQXJyYXlGbnMsIGRlZiwgaXNSZXNlcnZlZFByb3AsIEVNUFRZX0FSUiwgY2FwaXRhbGl6ZSwgdG9SYXdUeXBlLCBtYWtlTWFwLCBpc0J1aWx0SW5EaXJlY3RpdmUsIE5PLCBub3JtYWxpemVDbGFzcywgbm9ybWFsaXplU3R5bGUsIGlzR2xvYmFsbHlXaGl0ZWxpc3RlZCB9IGZyb20gJ0B2dWUvc2hhcmVkJztcbmV4cG9ydCB7IGNhbWVsaXplLCBjYXBpdGFsaXplLCBub3JtYWxpemVDbGFzcywgbm9ybWFsaXplUHJvcHMsIG5vcm1hbGl6ZVN0eWxlLCB0b0Rpc3BsYXlTdHJpbmcsIHRvSGFuZGxlcktleSB9IGZyb20gJ0B2dWUvc2hhcmVkJztcblxuY29uc3Qgc3RhY2sgPSBbXTtcclxuZnVuY3Rpb24gcHVzaFdhcm5pbmdDb250ZXh0KHZub2RlKSB7XHJcbiAgICBzdGFjay5wdXNoKHZub2RlKTtcclxufVxyXG5mdW5jdGlvbiBwb3BXYXJuaW5nQ29udGV4dCgpIHtcclxuICAgIHN0YWNrLnBvcCgpO1xyXG59XHJcbmZ1bmN0aW9uIHdhcm4obXNnLCAuLi5hcmdzKSB7XHJcbiAgICAvLyBhdm9pZCBwcm9wcyBmb3JtYXR0aW5nIG9yIHdhcm4gaGFuZGxlciB0cmFja2luZyBkZXBzIHRoYXQgbWlnaHQgYmUgbXV0YXRlZFxyXG4gICAgLy8gZHVyaW5nIHBhdGNoLCBsZWFkaW5nIHRvIGluZmluaXRlIHJlY3Vyc2lvbi5cclxuICAgIHBhdXNlVHJhY2tpbmcoKTtcclxuICAgIGNvbnN0IGluc3RhbmNlID0gc3RhY2subGVuZ3RoID8gc3RhY2tbc3RhY2subGVuZ3RoIC0gMV0uY29tcG9uZW50IDogbnVsbDtcclxuICAgIGNvbnN0IGFwcFdhcm5IYW5kbGVyID0gaW5zdGFuY2UgJiYgaW5zdGFuY2UuYXBwQ29udGV4dC5jb25maWcud2FybkhhbmRsZXI7XHJcbiAgICBjb25zdCB0cmFjZSA9IGdldENvbXBvbmVudFRyYWNlKCk7XHJcbiAgICBpZiAoYXBwV2FybkhhbmRsZXIpIHtcclxuICAgICAgICBjYWxsV2l0aEVycm9ySGFuZGxpbmcoYXBwV2FybkhhbmRsZXIsIGluc3RhbmNlLCAxMSAvKiBBUFBfV0FSTl9IQU5ETEVSICovLCBbXHJcbiAgICAgICAgICAgIG1zZyArIGFyZ3Muam9pbignJyksXHJcbiAgICAgICAgICAgIGluc3RhbmNlICYmIGluc3RhbmNlLnByb3h5LFxyXG4gICAgICAgICAgICB0cmFjZVxyXG4gICAgICAgICAgICAgICAgLm1hcCgoeyB2bm9kZSB9KSA9PiBgYXQgPCR7Zm9ybWF0Q29tcG9uZW50TmFtZShpbnN0YW5jZSwgdm5vZGUudHlwZSl9PmApXHJcbiAgICAgICAgICAgICAgICAuam9pbignXFxuJyksXHJcbiAgICAgICAgICAgIHRyYWNlXHJcbiAgICAgICAgXSk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBjb25zdCB3YXJuQXJncyA9IFtgW1Z1ZSB3YXJuXTogJHttc2d9YCwgLi4uYXJnc107XHJcbiAgICAgICAgLyogaXN0YW5idWwgaWdub3JlIGlmICovXHJcbiAgICAgICAgaWYgKHRyYWNlLmxlbmd0aCAmJlxyXG4gICAgICAgICAgICAvLyBhdm9pZCBzcGFtbWluZyBjb25zb2xlIGR1cmluZyB0ZXN0c1xyXG4gICAgICAgICAgICAhZmFsc2UpIHtcclxuICAgICAgICAgICAgd2FybkFyZ3MucHVzaChgXFxuYCwgLi4uZm9ybWF0VHJhY2UodHJhY2UpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc29sZS53YXJuKC4uLndhcm5BcmdzKTtcclxuICAgIH1cclxuICAgIHJlc2V0VHJhY2tpbmcoKTtcclxufVxyXG5mdW5jdGlvbiBnZXRDb21wb25lbnRUcmFjZSgpIHtcclxuICAgIGxldCBjdXJyZW50Vk5vZGUgPSBzdGFja1tzdGFjay5sZW5ndGggLSAxXTtcclxuICAgIGlmICghY3VycmVudFZOb2RlKSB7XHJcbiAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgfVxyXG4gICAgLy8gd2UgY2FuJ3QganVzdCB1c2UgdGhlIHN0YWNrIGJlY2F1c2UgaXQgd2lsbCBiZSBpbmNvbXBsZXRlIGR1cmluZyB1cGRhdGVzXHJcbiAgICAvLyB0aGF0IGRpZCBub3Qgc3RhcnQgZnJvbSB0aGUgcm9vdC4gUmUtY29uc3RydWN0IHRoZSBwYXJlbnQgY2hhaW4gdXNpbmdcclxuICAgIC8vIGluc3RhbmNlIHBhcmVudCBwb2ludGVycy5cclxuICAgIGNvbnN0IG5vcm1hbGl6ZWRTdGFjayA9IFtdO1xyXG4gICAgd2hpbGUgKGN1cnJlbnRWTm9kZSkge1xyXG4gICAgICAgIGNvbnN0IGxhc3QgPSBub3JtYWxpemVkU3RhY2tbMF07XHJcbiAgICAgICAgaWYgKGxhc3QgJiYgbGFzdC52bm9kZSA9PT0gY3VycmVudFZOb2RlKSB7XHJcbiAgICAgICAgICAgIGxhc3QucmVjdXJzZUNvdW50Kys7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBub3JtYWxpemVkU3RhY2sucHVzaCh7XHJcbiAgICAgICAgICAgICAgICB2bm9kZTogY3VycmVudFZOb2RlLFxyXG4gICAgICAgICAgICAgICAgcmVjdXJzZUNvdW50OiAwXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBwYXJlbnRJbnN0YW5jZSA9IGN1cnJlbnRWTm9kZS5jb21wb25lbnQgJiYgY3VycmVudFZOb2RlLmNvbXBvbmVudC5wYXJlbnQ7XHJcbiAgICAgICAgY3VycmVudFZOb2RlID0gcGFyZW50SW5zdGFuY2UgJiYgcGFyZW50SW5zdGFuY2Uudm5vZGU7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbm9ybWFsaXplZFN0YWNrO1xyXG59XHJcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXHJcbmZ1bmN0aW9uIGZvcm1hdFRyYWNlKHRyYWNlKSB7XHJcbiAgICBjb25zdCBsb2dzID0gW107XHJcbiAgICB0cmFjZS5mb3JFYWNoKChlbnRyeSwgaSkgPT4ge1xyXG4gICAgICAgIGxvZ3MucHVzaCguLi4oaSA9PT0gMCA/IFtdIDogW2BcXG5gXSksIC4uLmZvcm1hdFRyYWNlRW50cnkoZW50cnkpKTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIGxvZ3M7XHJcbn1cclxuZnVuY3Rpb24gZm9ybWF0VHJhY2VFbnRyeSh7IHZub2RlLCByZWN1cnNlQ291bnQgfSkge1xyXG4gICAgY29uc3QgcG9zdGZpeCA9IHJlY3Vyc2VDb3VudCA+IDAgPyBgLi4uICgke3JlY3Vyc2VDb3VudH0gcmVjdXJzaXZlIGNhbGxzKWAgOiBgYDtcclxuICAgIGNvbnN0IGlzUm9vdCA9IHZub2RlLmNvbXBvbmVudCA/IHZub2RlLmNvbXBvbmVudC5wYXJlbnQgPT0gbnVsbCA6IGZhbHNlO1xyXG4gICAgY29uc3Qgb3BlbiA9IGAgYXQgPCR7Zm9ybWF0Q29tcG9uZW50TmFtZSh2bm9kZS5jb21wb25lbnQsIHZub2RlLnR5cGUsIGlzUm9vdCl9YDtcclxuICAgIGNvbnN0IGNsb3NlID0gYD5gICsgcG9zdGZpeDtcclxuICAgIHJldHVybiB2bm9kZS5wcm9wc1xyXG4gICAgICAgID8gW29wZW4sIC4uLmZvcm1hdFByb3BzKHZub2RlLnByb3BzKSwgY2xvc2VdXHJcbiAgICAgICAgOiBbb3BlbiArIGNsb3NlXTtcclxufVxyXG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xyXG5mdW5jdGlvbiBmb3JtYXRQcm9wcyhwcm9wcykge1xyXG4gICAgY29uc3QgcmVzID0gW107XHJcbiAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXMocHJvcHMpO1xyXG4gICAga2V5cy5zbGljZSgwLCAzKS5mb3JFYWNoKGtleSA9PiB7XHJcbiAgICAgICAgcmVzLnB1c2goLi4uZm9ybWF0UHJvcChrZXksIHByb3BzW2tleV0pKTtcclxuICAgIH0pO1xyXG4gICAgaWYgKGtleXMubGVuZ3RoID4gMykge1xyXG4gICAgICAgIHJlcy5wdXNoKGAgLi4uYCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzO1xyXG59XHJcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXHJcbmZ1bmN0aW9uIGZvcm1hdFByb3Aoa2V5LCB2YWx1ZSwgcmF3KSB7XHJcbiAgICBpZiAoaXNTdHJpbmcodmFsdWUpKSB7XHJcbiAgICAgICAgdmFsdWUgPSBKU09OLnN0cmluZ2lmeSh2YWx1ZSk7XHJcbiAgICAgICAgcmV0dXJuIHJhdyA/IHZhbHVlIDogW2Ake2tleX09JHt2YWx1ZX1gXTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicgfHxcclxuICAgICAgICB0eXBlb2YgdmFsdWUgPT09ICdib29sZWFuJyB8fFxyXG4gICAgICAgIHZhbHVlID09IG51bGwpIHtcclxuICAgICAgICByZXR1cm4gcmF3ID8gdmFsdWUgOiBbYCR7a2V5fT0ke3ZhbHVlfWBdO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoaXNSZWYodmFsdWUpKSB7XHJcbiAgICAgICAgdmFsdWUgPSBmb3JtYXRQcm9wKGtleSwgdG9SYXcodmFsdWUudmFsdWUpLCB0cnVlKTtcclxuICAgICAgICByZXR1cm4gcmF3ID8gdmFsdWUgOiBbYCR7a2V5fT1SZWY8YCwgdmFsdWUsIGA+YF07XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChpc0Z1bmN0aW9uKHZhbHVlKSkge1xyXG4gICAgICAgIHJldHVybiBbYCR7a2V5fT1mbiR7dmFsdWUubmFtZSA/IGA8JHt2YWx1ZS5uYW1lfT5gIDogYGB9YF07XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICB2YWx1ZSA9IHRvUmF3KHZhbHVlKTtcclxuICAgICAgICByZXR1cm4gcmF3ID8gdmFsdWUgOiBbYCR7a2V5fT1gLCB2YWx1ZV07XHJcbiAgICB9XHJcbn1cblxuY29uc3QgRXJyb3JUeXBlU3RyaW5ncyA9IHtcclxuICAgIFtcInNwXCIgLyogU0VSVkVSX1BSRUZFVENIICovXTogJ3NlcnZlclByZWZldGNoIGhvb2snLFxyXG4gICAgW1wiYmNcIiAvKiBCRUZPUkVfQ1JFQVRFICovXTogJ2JlZm9yZUNyZWF0ZSBob29rJyxcclxuICAgIFtcImNcIiAvKiBDUkVBVEVEICovXTogJ2NyZWF0ZWQgaG9vaycsXHJcbiAgICBbXCJibVwiIC8qIEJFRk9SRV9NT1VOVCAqL106ICdiZWZvcmVNb3VudCBob29rJyxcclxuICAgIFtcIm1cIiAvKiBNT1VOVEVEICovXTogJ21vdW50ZWQgaG9vaycsXHJcbiAgICBbXCJidVwiIC8qIEJFRk9SRV9VUERBVEUgKi9dOiAnYmVmb3JlVXBkYXRlIGhvb2snLFxyXG4gICAgW1widVwiIC8qIFVQREFURUQgKi9dOiAndXBkYXRlZCcsXHJcbiAgICBbXCJidW1cIiAvKiBCRUZPUkVfVU5NT1VOVCAqL106ICdiZWZvcmVVbm1vdW50IGhvb2snLFxyXG4gICAgW1widW1cIiAvKiBVTk1PVU5URUQgKi9dOiAndW5tb3VudGVkIGhvb2snLFxyXG4gICAgW1wiYVwiIC8qIEFDVElWQVRFRCAqL106ICdhY3RpdmF0ZWQgaG9vaycsXHJcbiAgICBbXCJkYVwiIC8qIERFQUNUSVZBVEVEICovXTogJ2RlYWN0aXZhdGVkIGhvb2snLFxyXG4gICAgW1wiZWNcIiAvKiBFUlJPUl9DQVBUVVJFRCAqL106ICdlcnJvckNhcHR1cmVkIGhvb2snLFxyXG4gICAgW1wicnRjXCIgLyogUkVOREVSX1RSQUNLRUQgKi9dOiAncmVuZGVyVHJhY2tlZCBob29rJyxcclxuICAgIFtcInJ0Z1wiIC8qIFJFTkRFUl9UUklHR0VSRUQgKi9dOiAncmVuZGVyVHJpZ2dlcmVkIGhvb2snLFxyXG4gICAgWzAgLyogU0VUVVBfRlVOQ1RJT04gKi9dOiAnc2V0dXAgZnVuY3Rpb24nLFxyXG4gICAgWzEgLyogUkVOREVSX0ZVTkNUSU9OICovXTogJ3JlbmRlciBmdW5jdGlvbicsXHJcbiAgICBbMiAvKiBXQVRDSF9HRVRURVIgKi9dOiAnd2F0Y2hlciBnZXR0ZXInLFxyXG4gICAgWzMgLyogV0FUQ0hfQ0FMTEJBQ0sgKi9dOiAnd2F0Y2hlciBjYWxsYmFjaycsXHJcbiAgICBbNCAvKiBXQVRDSF9DTEVBTlVQICovXTogJ3dhdGNoZXIgY2xlYW51cCBmdW5jdGlvbicsXHJcbiAgICBbNSAvKiBOQVRJVkVfRVZFTlRfSEFORExFUiAqL106ICduYXRpdmUgZXZlbnQgaGFuZGxlcicsXHJcbiAgICBbNiAvKiBDT01QT05FTlRfRVZFTlRfSEFORExFUiAqL106ICdjb21wb25lbnQgZXZlbnQgaGFuZGxlcicsXHJcbiAgICBbNyAvKiBWTk9ERV9IT09LICovXTogJ3Zub2RlIGhvb2snLFxyXG4gICAgWzggLyogRElSRUNUSVZFX0hPT0sgKi9dOiAnZGlyZWN0aXZlIGhvb2snLFxyXG4gICAgWzkgLyogVFJBTlNJVElPTl9IT09LICovXTogJ3RyYW5zaXRpb24gaG9vaycsXHJcbiAgICBbMTAgLyogQVBQX0VSUk9SX0hBTkRMRVIgKi9dOiAnYXBwIGVycm9ySGFuZGxlcicsXHJcbiAgICBbMTEgLyogQVBQX1dBUk5fSEFORExFUiAqL106ICdhcHAgd2FybkhhbmRsZXInLFxyXG4gICAgWzEyIC8qIEZVTkNUSU9OX1JFRiAqL106ICdyZWYgZnVuY3Rpb24nLFxyXG4gICAgWzEzIC8qIEFTWU5DX0NPTVBPTkVOVF9MT0FERVIgKi9dOiAnYXN5bmMgY29tcG9uZW50IGxvYWRlcicsXHJcbiAgICBbMTQgLyogU0NIRURVTEVSICovXTogJ3NjaGVkdWxlciBmbHVzaC4gVGhpcyBpcyBsaWtlbHkgYSBWdWUgaW50ZXJuYWxzIGJ1Zy4gJyArXHJcbiAgICAgICAgJ1BsZWFzZSBvcGVuIGFuIGlzc3VlIGF0IGh0dHBzOi8vbmV3LWlzc3VlLnZ1ZWpzLm9yZy8/cmVwbz12dWVqcy9jb3JlJ1xyXG59O1xyXG5mdW5jdGlvbiBjYWxsV2l0aEVycm9ySGFuZGxpbmcoZm4sIGluc3RhbmNlLCB0eXBlLCBhcmdzKSB7XHJcbiAgICBsZXQgcmVzO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICByZXMgPSBhcmdzID8gZm4oLi4uYXJncykgOiBmbigpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGVycikge1xyXG4gICAgICAgIGhhbmRsZUVycm9yKGVyciwgaW5zdGFuY2UsIHR5cGUpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlcztcclxufVxyXG5mdW5jdGlvbiBjYWxsV2l0aEFzeW5jRXJyb3JIYW5kbGluZyhmbiwgaW5zdGFuY2UsIHR5cGUsIGFyZ3MpIHtcclxuICAgIGlmIChpc0Z1bmN0aW9uKGZuKSkge1xyXG4gICAgICAgIGNvbnN0IHJlcyA9IGNhbGxXaXRoRXJyb3JIYW5kbGluZyhmbiwgaW5zdGFuY2UsIHR5cGUsIGFyZ3MpO1xyXG4gICAgICAgIGlmIChyZXMgJiYgaXNQcm9taXNlKHJlcykpIHtcclxuICAgICAgICAgICAgcmVzLmNhdGNoKGVyciA9PiB7XHJcbiAgICAgICAgICAgICAgICBoYW5kbGVFcnJvcihlcnIsIGluc3RhbmNlLCB0eXBlKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXM7XHJcbiAgICB9XHJcbiAgICBjb25zdCB2YWx1ZXMgPSBbXTtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZm4ubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICB2YWx1ZXMucHVzaChjYWxsV2l0aEFzeW5jRXJyb3JIYW5kbGluZyhmbltpXSwgaW5zdGFuY2UsIHR5cGUsIGFyZ3MpKTtcclxuICAgIH1cclxuICAgIHJldHVybiB2YWx1ZXM7XHJcbn1cclxuZnVuY3Rpb24gaGFuZGxlRXJyb3IoZXJyLCBpbnN0YW5jZSwgdHlwZSwgdGhyb3dJbkRldiA9IHRydWUpIHtcclxuICAgIGNvbnN0IGNvbnRleHRWTm9kZSA9IGluc3RhbmNlID8gaW5zdGFuY2Uudm5vZGUgOiBudWxsO1xyXG4gICAgaWYgKGluc3RhbmNlKSB7XHJcbiAgICAgICAgbGV0IGN1ciA9IGluc3RhbmNlLnBhcmVudDtcclxuICAgICAgICAvLyB0aGUgZXhwb3NlZCBpbnN0YW5jZSBpcyB0aGUgcmVuZGVyIHByb3h5IHRvIGtlZXAgaXQgY29uc2lzdGVudCB3aXRoIDIueFxyXG4gICAgICAgIGNvbnN0IGV4cG9zZWRJbnN0YW5jZSA9IGluc3RhbmNlLnByb3h5O1xyXG4gICAgICAgIC8vIGluIHByb2R1Y3Rpb24gdGhlIGhvb2sgcmVjZWl2ZXMgb25seSB0aGUgZXJyb3IgY29kZVxyXG4gICAgICAgIGNvbnN0IGVycm9ySW5mbyA9IChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSA/IEVycm9yVHlwZVN0cmluZ3NbdHlwZV0gOiB0eXBlO1xyXG4gICAgICAgIHdoaWxlIChjdXIpIHtcclxuICAgICAgICAgICAgY29uc3QgZXJyb3JDYXB0dXJlZEhvb2tzID0gY3VyLmVjO1xyXG4gICAgICAgICAgICBpZiAoZXJyb3JDYXB0dXJlZEhvb2tzKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGVycm9yQ2FwdHVyZWRIb29rcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlcnJvckNhcHR1cmVkSG9va3NbaV0oZXJyLCBleHBvc2VkSW5zdGFuY2UsIGVycm9ySW5mbykgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY3VyID0gY3VyLnBhcmVudDtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gYXBwLWxldmVsIGhhbmRsaW5nXHJcbiAgICAgICAgY29uc3QgYXBwRXJyb3JIYW5kbGVyID0gaW5zdGFuY2UuYXBwQ29udGV4dC5jb25maWcuZXJyb3JIYW5kbGVyO1xyXG4gICAgICAgIGlmIChhcHBFcnJvckhhbmRsZXIpIHtcclxuICAgICAgICAgICAgY2FsbFdpdGhFcnJvckhhbmRsaW5nKGFwcEVycm9ySGFuZGxlciwgbnVsbCwgMTAgLyogQVBQX0VSUk9SX0hBTkRMRVIgKi8sIFtlcnIsIGV4cG9zZWRJbnN0YW5jZSwgZXJyb3JJbmZvXSk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBsb2dFcnJvcihlcnIsIHR5cGUsIGNvbnRleHRWTm9kZSwgdGhyb3dJbkRldik7XHJcbn1cclxuZnVuY3Rpb24gbG9nRXJyb3IoZXJyLCB0eXBlLCBjb250ZXh0Vk5vZGUsIHRocm93SW5EZXYgPSB0cnVlKSB7XHJcbiAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgY29uc3QgaW5mbyA9IEVycm9yVHlwZVN0cmluZ3NbdHlwZV07XHJcbiAgICAgICAgaWYgKGNvbnRleHRWTm9kZSkge1xyXG4gICAgICAgICAgICBwdXNoV2FybmluZ0NvbnRleHQoY29udGV4dFZOb2RlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgd2FybihgVW5oYW5kbGVkIGVycm9yJHtpbmZvID8gYCBkdXJpbmcgZXhlY3V0aW9uIG9mICR7aW5mb31gIDogYGB9YCk7XHJcbiAgICAgICAgaWYgKGNvbnRleHRWTm9kZSkge1xyXG4gICAgICAgICAgICBwb3BXYXJuaW5nQ29udGV4dCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBjcmFzaCBpbiBkZXYgYnkgZGVmYXVsdCBzbyBpdCdzIG1vcmUgbm90aWNlYWJsZVxyXG4gICAgICAgIGlmICh0aHJvd0luRGV2KSB7XHJcbiAgICAgICAgICAgIHRocm93IGVycjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICAvLyByZWNvdmVyIGluIHByb2QgdG8gcmVkdWNlIHRoZSBpbXBhY3Qgb24gZW5kLXVzZXJcclxuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbiAgICB9XHJcbn1cblxubGV0IGlzRmx1c2hpbmcgPSBmYWxzZTtcclxubGV0IGlzRmx1c2hQZW5kaW5nID0gZmFsc2U7XHJcbmNvbnN0IHF1ZXVlID0gW107XHJcbmxldCBmbHVzaEluZGV4ID0gMDtcclxuY29uc3QgcGVuZGluZ1ByZUZsdXNoQ2JzID0gW107XHJcbmxldCBhY3RpdmVQcmVGbHVzaENicyA9IG51bGw7XHJcbmxldCBwcmVGbHVzaEluZGV4ID0gMDtcclxuY29uc3QgcGVuZGluZ1Bvc3RGbHVzaENicyA9IFtdO1xyXG5sZXQgYWN0aXZlUG9zdEZsdXNoQ2JzID0gbnVsbDtcclxubGV0IHBvc3RGbHVzaEluZGV4ID0gMDtcclxuY29uc3QgcmVzb2x2ZWRQcm9taXNlID0gUHJvbWlzZS5yZXNvbHZlKCk7XHJcbmxldCBjdXJyZW50Rmx1c2hQcm9taXNlID0gbnVsbDtcclxubGV0IGN1cnJlbnRQcmVGbHVzaFBhcmVudEpvYiA9IG51bGw7XHJcbmNvbnN0IFJFQ1VSU0lPTl9MSU1JVCA9IDEwMDtcclxuZnVuY3Rpb24gbmV4dFRpY2soZm4pIHtcclxuICAgIGNvbnN0IHAgPSBjdXJyZW50Rmx1c2hQcm9taXNlIHx8IHJlc29sdmVkUHJvbWlzZTtcclxuICAgIHJldHVybiBmbiA/IHAudGhlbih0aGlzID8gZm4uYmluZCh0aGlzKSA6IGZuKSA6IHA7XHJcbn1cclxuLy8gIzI3NjhcclxuLy8gVXNlIGJpbmFyeS1zZWFyY2ggdG8gZmluZCBhIHN1aXRhYmxlIHBvc2l0aW9uIGluIHRoZSBxdWV1ZSxcclxuLy8gc28gdGhhdCB0aGUgcXVldWUgbWFpbnRhaW5zIHRoZSBpbmNyZWFzaW5nIG9yZGVyIG9mIGpvYidzIGlkLFxyXG4vLyB3aGljaCBjYW4gcHJldmVudCB0aGUgam9iIGZyb20gYmVpbmcgc2tpcHBlZCBhbmQgYWxzbyBjYW4gYXZvaWQgcmVwZWF0ZWQgcGF0Y2hpbmcuXHJcbmZ1bmN0aW9uIGZpbmRJbnNlcnRpb25JbmRleChpZCkge1xyXG4gICAgLy8gdGhlIHN0YXJ0IGluZGV4IHNob3VsZCBiZSBgZmx1c2hJbmRleCArIDFgXHJcbiAgICBsZXQgc3RhcnQgPSBmbHVzaEluZGV4ICsgMTtcclxuICAgIGxldCBlbmQgPSBxdWV1ZS5sZW5ndGg7XHJcbiAgICB3aGlsZSAoc3RhcnQgPCBlbmQpIHtcclxuICAgICAgICBjb25zdCBtaWRkbGUgPSAoc3RhcnQgKyBlbmQpID4+PiAxO1xyXG4gICAgICAgIGNvbnN0IG1pZGRsZUpvYklkID0gZ2V0SWQocXVldWVbbWlkZGxlXSk7XHJcbiAgICAgICAgbWlkZGxlSm9iSWQgPCBpZCA/IChzdGFydCA9IG1pZGRsZSArIDEpIDogKGVuZCA9IG1pZGRsZSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gc3RhcnQ7XHJcbn1cclxuZnVuY3Rpb24gcXVldWVKb2Ioam9iKSB7XHJcbiAgICAvLyB0aGUgZGVkdXBlIHNlYXJjaCB1c2VzIHRoZSBzdGFydEluZGV4IGFyZ3VtZW50IG9mIEFycmF5LmluY2x1ZGVzKClcclxuICAgIC8vIGJ5IGRlZmF1bHQgdGhlIHNlYXJjaCBpbmRleCBpbmNsdWRlcyB0aGUgY3VycmVudCBqb2IgdGhhdCBpcyBiZWluZyBydW5cclxuICAgIC8vIHNvIGl0IGNhbm5vdCByZWN1cnNpdmVseSB0cmlnZ2VyIGl0c2VsZiBhZ2Fpbi5cclxuICAgIC8vIGlmIHRoZSBqb2IgaXMgYSB3YXRjaCgpIGNhbGxiYWNrLCB0aGUgc2VhcmNoIHdpbGwgc3RhcnQgd2l0aCBhICsxIGluZGV4IHRvXHJcbiAgICAvLyBhbGxvdyBpdCByZWN1cnNpdmVseSB0cmlnZ2VyIGl0c2VsZiAtIGl0IGlzIHRoZSB1c2VyJ3MgcmVzcG9uc2liaWxpdHkgdG9cclxuICAgIC8vIGVuc3VyZSBpdCBkb2Vzbid0IGVuZCB1cCBpbiBhbiBpbmZpbml0ZSBsb29wLlxyXG4gICAgaWYgKCghcXVldWUubGVuZ3RoIHx8XHJcbiAgICAgICAgIXF1ZXVlLmluY2x1ZGVzKGpvYiwgaXNGbHVzaGluZyAmJiBqb2IuYWxsb3dSZWN1cnNlID8gZmx1c2hJbmRleCArIDEgOiBmbHVzaEluZGV4KSkgJiZcclxuICAgICAgICBqb2IgIT09IGN1cnJlbnRQcmVGbHVzaFBhcmVudEpvYikge1xyXG4gICAgICAgIGlmIChqb2IuaWQgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBxdWV1ZS5wdXNoKGpvYik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBxdWV1ZS5zcGxpY2UoZmluZEluc2VydGlvbkluZGV4KGpvYi5pZCksIDAsIGpvYik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHF1ZXVlRmx1c2goKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBxdWV1ZUZsdXNoKCkge1xyXG4gICAgaWYgKCFpc0ZsdXNoaW5nICYmICFpc0ZsdXNoUGVuZGluZykge1xyXG4gICAgICAgIGlzRmx1c2hQZW5kaW5nID0gdHJ1ZTtcclxuICAgICAgICBjdXJyZW50Rmx1c2hQcm9taXNlID0gcmVzb2x2ZWRQcm9taXNlLnRoZW4oZmx1c2hKb2JzKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBpbnZhbGlkYXRlSm9iKGpvYikge1xyXG4gICAgY29uc3QgaSA9IHF1ZXVlLmluZGV4T2Yoam9iKTtcclxuICAgIGlmIChpID4gZmx1c2hJbmRleCkge1xyXG4gICAgICAgIHF1ZXVlLnNwbGljZShpLCAxKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBxdWV1ZUNiKGNiLCBhY3RpdmVRdWV1ZSwgcGVuZGluZ1F1ZXVlLCBpbmRleCkge1xyXG4gICAgaWYgKCFpc0FycmF5KGNiKSkge1xyXG4gICAgICAgIGlmICghYWN0aXZlUXVldWUgfHxcclxuICAgICAgICAgICAgIWFjdGl2ZVF1ZXVlLmluY2x1ZGVzKGNiLCBjYi5hbGxvd1JlY3Vyc2UgPyBpbmRleCArIDEgOiBpbmRleCkpIHtcclxuICAgICAgICAgICAgcGVuZGluZ1F1ZXVlLnB1c2goY2IpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIC8vIGlmIGNiIGlzIGFuIGFycmF5LCBpdCBpcyBhIGNvbXBvbmVudCBsaWZlY3ljbGUgaG9vayB3aGljaCBjYW4gb25seSBiZVxyXG4gICAgICAgIC8vIHRyaWdnZXJlZCBieSBhIGpvYiwgd2hpY2ggaXMgYWxyZWFkeSBkZWR1cGVkIGluIHRoZSBtYWluIHF1ZXVlLCBzb1xyXG4gICAgICAgIC8vIHdlIGNhbiBza2lwIGR1cGxpY2F0ZSBjaGVjayBoZXJlIHRvIGltcHJvdmUgcGVyZlxyXG4gICAgICAgIHBlbmRpbmdRdWV1ZS5wdXNoKC4uLmNiKTtcclxuICAgIH1cclxuICAgIHF1ZXVlRmx1c2goKTtcclxufVxyXG5mdW5jdGlvbiBxdWV1ZVByZUZsdXNoQ2IoY2IpIHtcclxuICAgIHF1ZXVlQ2IoY2IsIGFjdGl2ZVByZUZsdXNoQ2JzLCBwZW5kaW5nUHJlRmx1c2hDYnMsIHByZUZsdXNoSW5kZXgpO1xyXG59XHJcbmZ1bmN0aW9uIHF1ZXVlUG9zdEZsdXNoQ2IoY2IpIHtcclxuICAgIHF1ZXVlQ2IoY2IsIGFjdGl2ZVBvc3RGbHVzaENicywgcGVuZGluZ1Bvc3RGbHVzaENicywgcG9zdEZsdXNoSW5kZXgpO1xyXG59XHJcbmZ1bmN0aW9uIGZsdXNoUHJlRmx1c2hDYnMoc2VlbiwgcGFyZW50Sm9iID0gbnVsbCkge1xyXG4gICAgaWYgKHBlbmRpbmdQcmVGbHVzaENicy5sZW5ndGgpIHtcclxuICAgICAgICBjdXJyZW50UHJlRmx1c2hQYXJlbnRKb2IgPSBwYXJlbnRKb2I7XHJcbiAgICAgICAgYWN0aXZlUHJlRmx1c2hDYnMgPSBbLi4ubmV3IFNldChwZW5kaW5nUHJlRmx1c2hDYnMpXTtcclxuICAgICAgICBwZW5kaW5nUHJlRmx1c2hDYnMubGVuZ3RoID0gMDtcclxuICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgIHNlZW4gPSBzZWVuIHx8IG5ldyBNYXAoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yIChwcmVGbHVzaEluZGV4ID0gMDsgcHJlRmx1c2hJbmRleCA8IGFjdGl2ZVByZUZsdXNoQ2JzLmxlbmd0aDsgcHJlRmx1c2hJbmRleCsrKSB7XHJcbiAgICAgICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiZcclxuICAgICAgICAgICAgICAgIGNoZWNrUmVjdXJzaXZlVXBkYXRlcyhzZWVuLCBhY3RpdmVQcmVGbHVzaENic1twcmVGbHVzaEluZGV4XSkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGFjdGl2ZVByZUZsdXNoQ2JzW3ByZUZsdXNoSW5kZXhdKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGFjdGl2ZVByZUZsdXNoQ2JzID0gbnVsbDtcclxuICAgICAgICBwcmVGbHVzaEluZGV4ID0gMDtcclxuICAgICAgICBjdXJyZW50UHJlRmx1c2hQYXJlbnRKb2IgPSBudWxsO1xyXG4gICAgICAgIC8vIHJlY3Vyc2l2ZWx5IGZsdXNoIHVudGlsIGl0IGRyYWluc1xyXG4gICAgICAgIGZsdXNoUHJlRmx1c2hDYnMoc2VlbiwgcGFyZW50Sm9iKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBmbHVzaFBvc3RGbHVzaENicyhzZWVuKSB7XHJcbiAgICBpZiAocGVuZGluZ1Bvc3RGbHVzaENicy5sZW5ndGgpIHtcclxuICAgICAgICBjb25zdCBkZWR1cGVkID0gWy4uLm5ldyBTZXQocGVuZGluZ1Bvc3RGbHVzaENicyldO1xyXG4gICAgICAgIHBlbmRpbmdQb3N0Rmx1c2hDYnMubGVuZ3RoID0gMDtcclxuICAgICAgICAvLyAjMTk0NyBhbHJlYWR5IGhhcyBhY3RpdmUgcXVldWUsIG5lc3RlZCBmbHVzaFBvc3RGbHVzaENicyBjYWxsXHJcbiAgICAgICAgaWYgKGFjdGl2ZVBvc3RGbHVzaENicykge1xyXG4gICAgICAgICAgICBhY3RpdmVQb3N0Rmx1c2hDYnMucHVzaCguLi5kZWR1cGVkKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBhY3RpdmVQb3N0Rmx1c2hDYnMgPSBkZWR1cGVkO1xyXG4gICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgc2VlbiA9IHNlZW4gfHwgbmV3IE1hcCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBhY3RpdmVQb3N0Rmx1c2hDYnMuc29ydCgoYSwgYikgPT4gZ2V0SWQoYSkgLSBnZXRJZChiKSk7XHJcbiAgICAgICAgZm9yIChwb3N0Rmx1c2hJbmRleCA9IDA7IHBvc3RGbHVzaEluZGV4IDwgYWN0aXZlUG9zdEZsdXNoQ2JzLmxlbmd0aDsgcG9zdEZsdXNoSW5kZXgrKykge1xyXG4gICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmXHJcbiAgICAgICAgICAgICAgICBjaGVja1JlY3Vyc2l2ZVVwZGF0ZXMoc2VlbiwgYWN0aXZlUG9zdEZsdXNoQ2JzW3Bvc3RGbHVzaEluZGV4XSkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGFjdGl2ZVBvc3RGbHVzaENic1twb3N0Rmx1c2hJbmRleF0oKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgYWN0aXZlUG9zdEZsdXNoQ2JzID0gbnVsbDtcclxuICAgICAgICBwb3N0Rmx1c2hJbmRleCA9IDA7XHJcbiAgICB9XHJcbn1cclxuY29uc3QgZ2V0SWQgPSAoam9iKSA9PiBqb2IuaWQgPT0gbnVsbCA/IEluZmluaXR5IDogam9iLmlkO1xyXG5mdW5jdGlvbiBmbHVzaEpvYnMoc2Vlbikge1xyXG4gICAgaXNGbHVzaFBlbmRpbmcgPSBmYWxzZTtcclxuICAgIGlzRmx1c2hpbmcgPSB0cnVlO1xyXG4gICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgIHNlZW4gPSBzZWVuIHx8IG5ldyBNYXAoKTtcclxuICAgIH1cclxuICAgIGZsdXNoUHJlRmx1c2hDYnMoc2Vlbik7XHJcbiAgICAvLyBTb3J0IHF1ZXVlIGJlZm9yZSBmbHVzaC5cclxuICAgIC8vIFRoaXMgZW5zdXJlcyB0aGF0OlxyXG4gICAgLy8gMS4gQ29tcG9uZW50cyBhcmUgdXBkYXRlZCBmcm9tIHBhcmVudCB0byBjaGlsZC4gKGJlY2F1c2UgcGFyZW50IGlzIGFsd2F5c1xyXG4gICAgLy8gICAgY3JlYXRlZCBiZWZvcmUgdGhlIGNoaWxkIHNvIGl0cyByZW5kZXIgZWZmZWN0IHdpbGwgaGF2ZSBzbWFsbGVyXHJcbiAgICAvLyAgICBwcmlvcml0eSBudW1iZXIpXHJcbiAgICAvLyAyLiBJZiBhIGNvbXBvbmVudCBpcyB1bm1vdW50ZWQgZHVyaW5nIGEgcGFyZW50IGNvbXBvbmVudCdzIHVwZGF0ZSxcclxuICAgIC8vICAgIGl0cyB1cGRhdGUgY2FuIGJlIHNraXBwZWQuXHJcbiAgICBxdWV1ZS5zb3J0KChhLCBiKSA9PiBnZXRJZChhKSAtIGdldElkKGIpKTtcclxuICAgIC8vIGNvbmRpdGlvbmFsIHVzYWdlIG9mIGNoZWNrUmVjdXJzaXZlVXBkYXRlIG11c3QgYmUgZGV0ZXJtaW5lZCBvdXQgb2ZcclxuICAgIC8vIHRyeSAuLi4gY2F0Y2ggYmxvY2sgc2luY2UgUm9sbHVwIGJ5IGRlZmF1bHQgZGUtb3B0aW1pemVzIHRyZWVzaGFraW5nXHJcbiAgICAvLyBpbnNpZGUgdHJ5LWNhdGNoLiBUaGlzIGNhbiBsZWF2ZSBhbGwgd2FybmluZyBjb2RlIHVuc2hha2VkLiBBbHRob3VnaFxyXG4gICAgLy8gdGhleSB3b3VsZCBnZXQgZXZlbnR1YWxseSBzaGFrZW4gYnkgYSBtaW5pZmllciBsaWtlIHRlcnNlciwgc29tZSBtaW5pZmllcnNcclxuICAgIC8vIHdvdWxkIGZhaWwgdG8gZG8gdGhhdCAoZS5nLiBodHRwczovL2dpdGh1Yi5jb20vZXZhbncvZXNidWlsZC9pc3N1ZXMvMTYxMClcclxuICAgIGNvbnN0IGNoZWNrID0gKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpXHJcbiAgICAgICAgPyAoam9iKSA9PiBjaGVja1JlY3Vyc2l2ZVVwZGF0ZXMoc2Vlbiwgam9iKVxyXG4gICAgICAgIDogTk9PUDtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgZm9yIChmbHVzaEluZGV4ID0gMDsgZmx1c2hJbmRleCA8IHF1ZXVlLmxlbmd0aDsgZmx1c2hJbmRleCsrKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGpvYiA9IHF1ZXVlW2ZsdXNoSW5kZXhdO1xyXG4gICAgICAgICAgICBpZiAoam9iICYmIGpvYi5hY3RpdmUgIT09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmIGNoZWNrKGpvYikpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGBydW5uaW5nOmAsIGpvYi5pZClcclxuICAgICAgICAgICAgICAgIGNhbGxXaXRoRXJyb3JIYW5kbGluZyhqb2IsIG51bGwsIDE0IC8qIFNDSEVEVUxFUiAqLyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBmaW5hbGx5IHtcclxuICAgICAgICBmbHVzaEluZGV4ID0gMDtcclxuICAgICAgICBxdWV1ZS5sZW5ndGggPSAwO1xyXG4gICAgICAgIGZsdXNoUG9zdEZsdXNoQ2JzKHNlZW4pO1xyXG4gICAgICAgIGlzRmx1c2hpbmcgPSBmYWxzZTtcclxuICAgICAgICBjdXJyZW50Rmx1c2hQcm9taXNlID0gbnVsbDtcclxuICAgICAgICAvLyBzb21lIHBvc3RGbHVzaENiIHF1ZXVlZCBqb2JzIVxyXG4gICAgICAgIC8vIGtlZXAgZmx1c2hpbmcgdW50aWwgaXQgZHJhaW5zLlxyXG4gICAgICAgIGlmIChxdWV1ZS5sZW5ndGggfHxcclxuICAgICAgICAgICAgcGVuZGluZ1ByZUZsdXNoQ2JzLmxlbmd0aCB8fFxyXG4gICAgICAgICAgICBwZW5kaW5nUG9zdEZsdXNoQ2JzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBmbHVzaEpvYnMoc2Vlbik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGNoZWNrUmVjdXJzaXZlVXBkYXRlcyhzZWVuLCBmbikge1xyXG4gICAgaWYgKCFzZWVuLmhhcyhmbikpIHtcclxuICAgICAgICBzZWVuLnNldChmbiwgMSk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBjb25zdCBjb3VudCA9IHNlZW4uZ2V0KGZuKTtcclxuICAgICAgICBpZiAoY291bnQgPiBSRUNVUlNJT05fTElNSVQpIHtcclxuICAgICAgICAgICAgY29uc3QgaW5zdGFuY2UgPSBmbi5vd25lckluc3RhbmNlO1xyXG4gICAgICAgICAgICBjb25zdCBjb21wb25lbnROYW1lID0gaW5zdGFuY2UgJiYgZ2V0Q29tcG9uZW50TmFtZShpbnN0YW5jZS50eXBlKTtcclxuICAgICAgICAgICAgd2FybihgTWF4aW11bSByZWN1cnNpdmUgdXBkYXRlcyBleGNlZWRlZCR7Y29tcG9uZW50TmFtZSA/IGAgaW4gY29tcG9uZW50IDwke2NvbXBvbmVudE5hbWV9PmAgOiBgYH0uIGAgK1xyXG4gICAgICAgICAgICAgICAgYFRoaXMgbWVhbnMgeW91IGhhdmUgYSByZWFjdGl2ZSBlZmZlY3QgdGhhdCBpcyBtdXRhdGluZyBpdHMgb3duIGAgK1xyXG4gICAgICAgICAgICAgICAgYGRlcGVuZGVuY2llcyBhbmQgdGh1cyByZWN1cnNpdmVseSB0cmlnZ2VyaW5nIGl0c2VsZi4gUG9zc2libGUgc291cmNlcyBgICtcclxuICAgICAgICAgICAgICAgIGBpbmNsdWRlIGNvbXBvbmVudCB0ZW1wbGF0ZSwgcmVuZGVyIGZ1bmN0aW9uLCB1cGRhdGVkIGhvb2sgb3IgYCArXHJcbiAgICAgICAgICAgICAgICBgd2F0Y2hlciBzb3VyY2UgZnVuY3Rpb24uYCk7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgc2Vlbi5zZXQoZm4sIGNvdW50ICsgMSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XG5cbi8qIGVzbGludC1kaXNhYmxlIG5vLXJlc3RyaWN0ZWQtZ2xvYmFscyAqL1xyXG5sZXQgaXNIbXJVcGRhdGluZyA9IGZhbHNlO1xyXG5jb25zdCBobXJEaXJ0eUNvbXBvbmVudHMgPSBuZXcgU2V0KCk7XHJcbi8vIEV4cG9zZSB0aGUgSE1SIHJ1bnRpbWUgb24gdGhlIGdsb2JhbCBvYmplY3RcclxuLy8gVGhpcyBtYWtlcyBpdCBlbnRpcmVseSB0cmVlLXNoYWthYmxlIHdpdGhvdXQgcG9sbHV0aW5nIHRoZSBleHBvcnRzIGFuZCBtYWtlc1xyXG4vLyBpdCBlYXNpZXIgdG8gYmUgdXNlZCBpbiB0b29saW5ncyBsaWtlIHZ1ZS1sb2FkZXJcclxuLy8gTm90ZTogZm9yIGEgY29tcG9uZW50IHRvIGJlIGVsaWdpYmxlIGZvciBITVIgaXQgYWxzbyBuZWVkcyB0aGUgX19obXJJZCBvcHRpb25cclxuLy8gdG8gYmUgc2V0IHNvIHRoYXQgaXRzIGluc3RhbmNlcyBjYW4gYmUgcmVnaXN0ZXJlZCAvIHJlbW92ZWQuXHJcbmlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgIGdldEdsb2JhbFRoaXMoKS5fX1ZVRV9ITVJfUlVOVElNRV9fID0ge1xyXG4gICAgICAgIGNyZWF0ZVJlY29yZDogdHJ5V3JhcChjcmVhdGVSZWNvcmQpLFxyXG4gICAgICAgIHJlcmVuZGVyOiB0cnlXcmFwKHJlcmVuZGVyKSxcclxuICAgICAgICByZWxvYWQ6IHRyeVdyYXAocmVsb2FkKVxyXG4gICAgfTtcclxufVxyXG5jb25zdCBtYXAgPSBuZXcgTWFwKCk7XHJcbmZ1bmN0aW9uIHJlZ2lzdGVySE1SKGluc3RhbmNlKSB7XHJcbiAgICBjb25zdCBpZCA9IGluc3RhbmNlLnR5cGUuX19obXJJZDtcclxuICAgIGxldCByZWNvcmQgPSBtYXAuZ2V0KGlkKTtcclxuICAgIGlmICghcmVjb3JkKSB7XHJcbiAgICAgICAgY3JlYXRlUmVjb3JkKGlkLCBpbnN0YW5jZS50eXBlKTtcclxuICAgICAgICByZWNvcmQgPSBtYXAuZ2V0KGlkKTtcclxuICAgIH1cclxuICAgIHJlY29yZC5pbnN0YW5jZXMuYWRkKGluc3RhbmNlKTtcclxufVxyXG5mdW5jdGlvbiB1bnJlZ2lzdGVySE1SKGluc3RhbmNlKSB7XHJcbiAgICBtYXAuZ2V0KGluc3RhbmNlLnR5cGUuX19obXJJZCkuaW5zdGFuY2VzLmRlbGV0ZShpbnN0YW5jZSk7XHJcbn1cclxuZnVuY3Rpb24gY3JlYXRlUmVjb3JkKGlkLCBpbml0aWFsRGVmKSB7XHJcbiAgICBpZiAobWFwLmhhcyhpZCkpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBtYXAuc2V0KGlkLCB7XHJcbiAgICAgICAgaW5pdGlhbERlZjogbm9ybWFsaXplQ2xhc3NDb21wb25lbnQoaW5pdGlhbERlZiksXHJcbiAgICAgICAgaW5zdGFuY2VzOiBuZXcgU2V0KClcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHRydWU7XHJcbn1cclxuZnVuY3Rpb24gbm9ybWFsaXplQ2xhc3NDb21wb25lbnQoY29tcG9uZW50KSB7XHJcbiAgICByZXR1cm4gaXNDbGFzc0NvbXBvbmVudChjb21wb25lbnQpID8gY29tcG9uZW50Ll9fdmNjT3B0cyA6IGNvbXBvbmVudDtcclxufVxyXG5mdW5jdGlvbiByZXJlbmRlcihpZCwgbmV3UmVuZGVyKSB7XHJcbiAgICBjb25zdCByZWNvcmQgPSBtYXAuZ2V0KGlkKTtcclxuICAgIGlmICghcmVjb3JkKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgLy8gdXBkYXRlIGluaXRpYWwgcmVjb3JkIChmb3Igbm90LXlldC1yZW5kZXJlZCBjb21wb25lbnQpXHJcbiAgICByZWNvcmQuaW5pdGlhbERlZi5yZW5kZXIgPSBuZXdSZW5kZXI7XHJcbiAgICBbLi4ucmVjb3JkLmluc3RhbmNlc10uZm9yRWFjaChpbnN0YW5jZSA9PiB7XHJcbiAgICAgICAgaWYgKG5ld1JlbmRlcikge1xyXG4gICAgICAgICAgICBpbnN0YW5jZS5yZW5kZXIgPSBuZXdSZW5kZXI7XHJcbiAgICAgICAgICAgIG5vcm1hbGl6ZUNsYXNzQ29tcG9uZW50KGluc3RhbmNlLnR5cGUpLnJlbmRlciA9IG5ld1JlbmRlcjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaW5zdGFuY2UucmVuZGVyQ2FjaGUgPSBbXTtcclxuICAgICAgICAvLyB0aGlzIGZsYWcgZm9yY2VzIGNoaWxkIGNvbXBvbmVudHMgd2l0aCBzbG90IGNvbnRlbnQgdG8gdXBkYXRlXHJcbiAgICAgICAgaXNIbXJVcGRhdGluZyA9IHRydWU7XHJcbiAgICAgICAgaW5zdGFuY2UudXBkYXRlKCk7XHJcbiAgICAgICAgaXNIbXJVcGRhdGluZyA9IGZhbHNlO1xyXG4gICAgfSk7XHJcbn1cclxuZnVuY3Rpb24gcmVsb2FkKGlkLCBuZXdDb21wKSB7XHJcbiAgICBjb25zdCByZWNvcmQgPSBtYXAuZ2V0KGlkKTtcclxuICAgIGlmICghcmVjb3JkKVxyXG4gICAgICAgIHJldHVybjtcclxuICAgIG5ld0NvbXAgPSBub3JtYWxpemVDbGFzc0NvbXBvbmVudChuZXdDb21wKTtcclxuICAgIC8vIHVwZGF0ZSBpbml0aWFsIGRlZiAoZm9yIG5vdC15ZXQtcmVuZGVyZWQgY29tcG9uZW50cylcclxuICAgIHVwZGF0ZUNvbXBvbmVudERlZihyZWNvcmQuaW5pdGlhbERlZiwgbmV3Q29tcCk7XHJcbiAgICAvLyBjcmVhdGUgYSBzbmFwc2hvdCB3aGljaCBhdm9pZHMgdGhlIHNldCBiZWluZyBtdXRhdGVkIGR1cmluZyB1cGRhdGVzXHJcbiAgICBjb25zdCBpbnN0YW5jZXMgPSBbLi4ucmVjb3JkLmluc3RhbmNlc107XHJcbiAgICBmb3IgKGNvbnN0IGluc3RhbmNlIG9mIGluc3RhbmNlcykge1xyXG4gICAgICAgIGNvbnN0IG9sZENvbXAgPSBub3JtYWxpemVDbGFzc0NvbXBvbmVudChpbnN0YW5jZS50eXBlKTtcclxuICAgICAgICBpZiAoIWhtckRpcnR5Q29tcG9uZW50cy5oYXMob2xkQ29tcCkpIHtcclxuICAgICAgICAgICAgLy8gMS4gVXBkYXRlIGV4aXN0aW5nIGNvbXAgZGVmaW5pdGlvbiB0byBtYXRjaCBuZXcgb25lXHJcbiAgICAgICAgICAgIGlmIChvbGRDb21wICE9PSByZWNvcmQuaW5pdGlhbERlZikge1xyXG4gICAgICAgICAgICAgICAgdXBkYXRlQ29tcG9uZW50RGVmKG9sZENvbXAsIG5ld0NvbXApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIDIuIG1hcmsgZGVmaW5pdGlvbiBkaXJ0eS4gVGhpcyBmb3JjZXMgdGhlIHJlbmRlcmVyIHRvIHJlcGxhY2UgdGhlXHJcbiAgICAgICAgICAgIC8vIGNvbXBvbmVudCBvbiBwYXRjaC5cclxuICAgICAgICAgICAgaG1yRGlydHlDb21wb25lbnRzLmFkZChvbGRDb21wKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gMy4gaW52YWxpZGF0ZSBvcHRpb25zIHJlc29sdXRpb24gY2FjaGVcclxuICAgICAgICBpbnN0YW5jZS5hcHBDb250ZXh0Lm9wdGlvbnNDYWNoZS5kZWxldGUoaW5zdGFuY2UudHlwZSk7XHJcbiAgICAgICAgLy8gNC4gYWN0dWFsbHkgdXBkYXRlXHJcbiAgICAgICAgaWYgKGluc3RhbmNlLmNlUmVsb2FkKSB7XHJcbiAgICAgICAgICAgIC8vIGN1c3RvbSBlbGVtZW50XHJcbiAgICAgICAgICAgIGhtckRpcnR5Q29tcG9uZW50cy5hZGQob2xkQ29tcCk7XHJcbiAgICAgICAgICAgIGluc3RhbmNlLmNlUmVsb2FkKG5ld0NvbXAuc3R5bGVzKTtcclxuICAgICAgICAgICAgaG1yRGlydHlDb21wb25lbnRzLmRlbGV0ZShvbGRDb21wKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoaW5zdGFuY2UucGFyZW50KSB7XHJcbiAgICAgICAgICAgIC8vIDQuIEZvcmNlIHRoZSBwYXJlbnQgaW5zdGFuY2UgdG8gcmUtcmVuZGVyLiBUaGlzIHdpbGwgY2F1c2UgYWxsIHVwZGF0ZWRcclxuICAgICAgICAgICAgLy8gY29tcG9uZW50cyB0byBiZSB1bm1vdW50ZWQgYW5kIHJlLW1vdW50ZWQuIFF1ZXVlIHRoZSB1cGRhdGUgc28gdGhhdCB3ZVxyXG4gICAgICAgICAgICAvLyBkb24ndCBlbmQgdXAgZm9yY2luZyB0aGUgc2FtZSBwYXJlbnQgdG8gcmUtcmVuZGVyIG11bHRpcGxlIHRpbWVzLlxyXG4gICAgICAgICAgICBxdWV1ZUpvYihpbnN0YW5jZS5wYXJlbnQudXBkYXRlKTtcclxuICAgICAgICAgICAgLy8gaW5zdGFuY2UgaXMgdGhlIGlubmVyIGNvbXBvbmVudCBvZiBhbiBhc3luYyBjdXN0b20gZWxlbWVudFxyXG4gICAgICAgICAgICAvLyBpbnZva2UgdG8gcmVzZXQgc3R5bGVzXHJcbiAgICAgICAgICAgIGlmIChpbnN0YW5jZS5wYXJlbnQudHlwZS5fX2FzeW5jTG9hZGVyICYmXHJcbiAgICAgICAgICAgICAgICBpbnN0YW5jZS5wYXJlbnQuY2VSZWxvYWQpIHtcclxuICAgICAgICAgICAgICAgIGluc3RhbmNlLnBhcmVudC5jZVJlbG9hZChuZXdDb21wLnN0eWxlcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoaW5zdGFuY2UuYXBwQ29udGV4dC5yZWxvYWQpIHtcclxuICAgICAgICAgICAgLy8gcm9vdCBpbnN0YW5jZSBtb3VudGVkIHZpYSBjcmVhdGVBcHAoKSBoYXMgYSByZWxvYWQgbWV0aG9kXHJcbiAgICAgICAgICAgIGluc3RhbmNlLmFwcENvbnRleHQucmVsb2FkKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgICAgIC8vIHJvb3QgaW5zdGFuY2UgaW5zaWRlIHRyZWUgY3JlYXRlZCB2aWEgcmF3IHJlbmRlcigpLiBGb3JjZSByZWxvYWQuXHJcbiAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUud2FybignW0hNUl0gUm9vdCBvciBtYW51YWxseSBtb3VudGVkIGluc3RhbmNlIG1vZGlmaWVkLiBGdWxsIHJlbG9hZCByZXF1aXJlZC4nKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyA1LiBtYWtlIHN1cmUgdG8gY2xlYW51cCBkaXJ0eSBobXIgY29tcG9uZW50cyBhZnRlciB1cGRhdGVcclxuICAgIHF1ZXVlUG9zdEZsdXNoQ2IoKCkgPT4ge1xyXG4gICAgICAgIGZvciAoY29uc3QgaW5zdGFuY2Ugb2YgaW5zdGFuY2VzKSB7XHJcbiAgICAgICAgICAgIGhtckRpcnR5Q29tcG9uZW50cy5kZWxldGUobm9ybWFsaXplQ2xhc3NDb21wb25lbnQoaW5zdGFuY2UudHlwZSkpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59XHJcbmZ1bmN0aW9uIHVwZGF0ZUNvbXBvbmVudERlZihvbGRDb21wLCBuZXdDb21wKSB7XHJcbiAgICBleHRlbmQob2xkQ29tcCwgbmV3Q29tcCk7XHJcbiAgICBmb3IgKGNvbnN0IGtleSBpbiBvbGRDb21wKSB7XHJcbiAgICAgICAgaWYgKGtleSAhPT0gJ19fZmlsZScgJiYgIShrZXkgaW4gbmV3Q29tcCkpIHtcclxuICAgICAgICAgICAgZGVsZXRlIG9sZENvbXBba2V5XTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gdHJ5V3JhcChmbikge1xyXG4gICAgcmV0dXJuIChpZCwgYXJnKSA9PiB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgcmV0dXJuIGZuKGlkLCBhcmcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGUpO1xyXG4gICAgICAgICAgICBjb25zb2xlLndhcm4oYFtITVJdIFNvbWV0aGluZyB3ZW50IHdyb25nIGR1cmluZyBWdWUgY29tcG9uZW50IGhvdC1yZWxvYWQuIGAgK1xyXG4gICAgICAgICAgICAgICAgYEZ1bGwgcmVsb2FkIHJlcXVpcmVkLmApO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn1cblxubGV0IGRldnRvb2xzO1xyXG5sZXQgYnVmZmVyID0gW107XHJcbmxldCBkZXZ0b29sc05vdEluc3RhbGxlZCA9IGZhbHNlO1xyXG5mdW5jdGlvbiBlbWl0KGV2ZW50LCAuLi5hcmdzKSB7XHJcbiAgICBpZiAoZGV2dG9vbHMpIHtcclxuICAgICAgICBkZXZ0b29scy5lbWl0KGV2ZW50LCAuLi5hcmdzKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKCFkZXZ0b29sc05vdEluc3RhbGxlZCkge1xyXG4gICAgICAgIGJ1ZmZlci5wdXNoKHsgZXZlbnQsIGFyZ3MgfSk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gc2V0RGV2dG9vbHNIb29rKGhvb2ssIHRhcmdldCkge1xyXG4gICAgdmFyIF9hLCBfYjtcclxuICAgIGRldnRvb2xzID0gaG9vaztcclxuICAgIGlmIChkZXZ0b29scykge1xyXG4gICAgICAgIGRldnRvb2xzLmVuYWJsZWQgPSB0cnVlO1xyXG4gICAgICAgIGJ1ZmZlci5mb3JFYWNoKCh7IGV2ZW50LCBhcmdzIH0pID0+IGRldnRvb2xzLmVtaXQoZXZlbnQsIC4uLmFyZ3MpKTtcclxuICAgICAgICBidWZmZXIgPSBbXTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKFxyXG4gICAgLy8gaGFuZGxlIGxhdGUgZGV2dG9vbHMgaW5qZWN0aW9uIC0gb25seSBkbyB0aGlzIGlmIHdlIGFyZSBpbiBhbiBhY3R1YWxcclxuICAgIC8vIGJyb3dzZXIgZW52aXJvbm1lbnQgdG8gYXZvaWQgdGhlIHRpbWVyIGhhbmRsZSBzdGFsbGluZyB0ZXN0IHJ1bm5lciBleGl0XHJcbiAgICAvLyAoIzQ4MTUpXHJcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcmVzdHJpY3RlZC1nbG9iYWxzXHJcbiAgICB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJlxyXG4gICAgICAgIC8vIHNvbWUgZW52cyBtb2NrIHdpbmRvdyBidXQgbm90IGZ1bGx5XHJcbiAgICAgICAgd2luZG93LkhUTUxFbGVtZW50ICYmXHJcbiAgICAgICAgLy8gYWxzbyBleGNsdWRlIGpzZG9tXHJcbiAgICAgICAgISgoX2IgPSAoX2EgPSB3aW5kb3cubmF2aWdhdG9yKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EudXNlckFnZW50KSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IuaW5jbHVkZXMoJ2pzZG9tJykpKSB7XHJcbiAgICAgICAgY29uc3QgcmVwbGF5ID0gKHRhcmdldC5fX1ZVRV9ERVZUT09MU19IT09LX1JFUExBWV9fID1cclxuICAgICAgICAgICAgdGFyZ2V0Ll9fVlVFX0RFVlRPT0xTX0hPT0tfUkVQTEFZX18gfHwgW10pO1xyXG4gICAgICAgIHJlcGxheS5wdXNoKChuZXdIb29rKSA9PiB7XHJcbiAgICAgICAgICAgIHNldERldnRvb2xzSG9vayhuZXdIb29rLCB0YXJnZXQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8vIGNsZWFyIGJ1ZmZlciBhZnRlciAzcyAtIHRoZSB1c2VyIHByb2JhYmx5IGRvZXNuJ3QgaGF2ZSBkZXZ0b29scyBpbnN0YWxsZWRcclxuICAgICAgICAvLyBhdCBhbGwsIGFuZCBrZWVwaW5nIHRoZSBidWZmZXIgd2lsbCBjYXVzZSBtZW1vcnkgbGVha3MgKCM0NzM4KVxyXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoIWRldnRvb2xzKSB7XHJcbiAgICAgICAgICAgICAgICB0YXJnZXQuX19WVUVfREVWVE9PTFNfSE9PS19SRVBMQVlfXyA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBkZXZ0b29sc05vdEluc3RhbGxlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBidWZmZXIgPSBbXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIDMwMDApO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgLy8gbm9uLWJyb3dzZXIgZW52LCBhc3N1bWUgbm90IGluc3RhbGxlZFxyXG4gICAgICAgIGRldnRvb2xzTm90SW5zdGFsbGVkID0gdHJ1ZTtcclxuICAgICAgICBidWZmZXIgPSBbXTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBkZXZ0b29sc0luaXRBcHAoYXBwLCB2ZXJzaW9uKSB7XHJcbiAgICBlbWl0KFwiYXBwOmluaXRcIiAvKiBBUFBfSU5JVCAqLywgYXBwLCB2ZXJzaW9uLCB7XHJcbiAgICAgICAgRnJhZ21lbnQsXHJcbiAgICAgICAgVGV4dCxcclxuICAgICAgICBDb21tZW50LFxyXG4gICAgICAgIFN0YXRpY1xyXG4gICAgfSk7XHJcbn1cclxuZnVuY3Rpb24gZGV2dG9vbHNVbm1vdW50QXBwKGFwcCkge1xyXG4gICAgZW1pdChcImFwcDp1bm1vdW50XCIgLyogQVBQX1VOTU9VTlQgKi8sIGFwcCk7XHJcbn1cclxuY29uc3QgZGV2dG9vbHNDb21wb25lbnRBZGRlZCA9IC8qI19fUFVSRV9fKi8gY3JlYXRlRGV2dG9vbHNDb21wb25lbnRIb29rKFwiY29tcG9uZW50OmFkZGVkXCIgLyogQ09NUE9ORU5UX0FEREVEICovKTtcclxuY29uc3QgZGV2dG9vbHNDb21wb25lbnRVcGRhdGVkID0gXHJcbi8qI19fUFVSRV9fKi8gY3JlYXRlRGV2dG9vbHNDb21wb25lbnRIb29rKFwiY29tcG9uZW50OnVwZGF0ZWRcIiAvKiBDT01QT05FTlRfVVBEQVRFRCAqLyk7XHJcbmNvbnN0IGRldnRvb2xzQ29tcG9uZW50UmVtb3ZlZCA9IFxyXG4vKiNfX1BVUkVfXyovIGNyZWF0ZURldnRvb2xzQ29tcG9uZW50SG9vayhcImNvbXBvbmVudDpyZW1vdmVkXCIgLyogQ09NUE9ORU5UX1JFTU9WRUQgKi8pO1xyXG5mdW5jdGlvbiBjcmVhdGVEZXZ0b29sc0NvbXBvbmVudEhvb2soaG9vaykge1xyXG4gICAgcmV0dXJuIChjb21wb25lbnQpID0+IHtcclxuICAgICAgICBlbWl0KGhvb2ssIGNvbXBvbmVudC5hcHBDb250ZXh0LmFwcCwgY29tcG9uZW50LnVpZCwgY29tcG9uZW50LnBhcmVudCA/IGNvbXBvbmVudC5wYXJlbnQudWlkIDogdW5kZWZpbmVkLCBjb21wb25lbnQpO1xyXG4gICAgfTtcclxufVxyXG5jb25zdCBkZXZ0b29sc1BlcmZTdGFydCA9IC8qI19fUFVSRV9fKi8gY3JlYXRlRGV2dG9vbHNQZXJmb3JtYW5jZUhvb2soXCJwZXJmOnN0YXJ0XCIgLyogUEVSRk9STUFOQ0VfU1RBUlQgKi8pO1xyXG5jb25zdCBkZXZ0b29sc1BlcmZFbmQgPSAvKiNfX1BVUkVfXyovIGNyZWF0ZURldnRvb2xzUGVyZm9ybWFuY2VIb29rKFwicGVyZjplbmRcIiAvKiBQRVJGT1JNQU5DRV9FTkQgKi8pO1xyXG5mdW5jdGlvbiBjcmVhdGVEZXZ0b29sc1BlcmZvcm1hbmNlSG9vayhob29rKSB7XHJcbiAgICByZXR1cm4gKGNvbXBvbmVudCwgdHlwZSwgdGltZSkgPT4ge1xyXG4gICAgICAgIGVtaXQoaG9vaywgY29tcG9uZW50LmFwcENvbnRleHQuYXBwLCBjb21wb25lbnQudWlkLCBjb21wb25lbnQsIHR5cGUsIHRpbWUpO1xyXG4gICAgfTtcclxufVxyXG5mdW5jdGlvbiBkZXZ0b29sc0NvbXBvbmVudEVtaXQoY29tcG9uZW50LCBldmVudCwgcGFyYW1zKSB7XHJcbiAgICBlbWl0KFwiY29tcG9uZW50OmVtaXRcIiAvKiBDT01QT05FTlRfRU1JVCAqLywgY29tcG9uZW50LmFwcENvbnRleHQuYXBwLCBjb21wb25lbnQsIGV2ZW50LCBwYXJhbXMpO1xyXG59XG5cbmZ1bmN0aW9uIGVtaXQkMShpbnN0YW5jZSwgZXZlbnQsIC4uLnJhd0FyZ3MpIHtcclxuICAgIGNvbnN0IHByb3BzID0gaW5zdGFuY2Uudm5vZGUucHJvcHMgfHwgRU1QVFlfT0JKO1xyXG4gICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgIGNvbnN0IHsgZW1pdHNPcHRpb25zLCBwcm9wc09wdGlvbnM6IFtwcm9wc09wdGlvbnNdIH0gPSBpbnN0YW5jZTtcclxuICAgICAgICBpZiAoZW1pdHNPcHRpb25zKSB7XHJcbiAgICAgICAgICAgIGlmICghKGV2ZW50IGluIGVtaXRzT3B0aW9ucykgJiZcclxuICAgICAgICAgICAgICAgICEoZmFsc2UgKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFwcm9wc09wdGlvbnMgfHwgISh0b0hhbmRsZXJLZXkoZXZlbnQpIGluIHByb3BzT3B0aW9ucykpIHtcclxuICAgICAgICAgICAgICAgICAgICB3YXJuKGBDb21wb25lbnQgZW1pdHRlZCBldmVudCBcIiR7ZXZlbnR9XCIgYnV0IGl0IGlzIG5laXRoZXIgZGVjbGFyZWQgaW4gYCArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGB0aGUgZW1pdHMgb3B0aW9uIG5vciBhcyBhbiBcIiR7dG9IYW5kbGVyS2V5KGV2ZW50KX1cIiBwcm9wLmApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdmFsaWRhdG9yID0gZW1pdHNPcHRpb25zW2V2ZW50XTtcclxuICAgICAgICAgICAgICAgIGlmIChpc0Z1bmN0aW9uKHZhbGlkYXRvcikpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpc1ZhbGlkID0gdmFsaWRhdG9yKC4uLnJhd0FyZ3MpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghaXNWYWxpZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3YXJuKGBJbnZhbGlkIGV2ZW50IGFyZ3VtZW50czogZXZlbnQgdmFsaWRhdGlvbiBmYWlsZWQgZm9yIGV2ZW50IFwiJHtldmVudH1cIi5gKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBsZXQgYXJncyA9IHJhd0FyZ3M7XHJcbiAgICBjb25zdCBpc01vZGVsTGlzdGVuZXIgPSBldmVudC5zdGFydHNXaXRoKCd1cGRhdGU6Jyk7XHJcbiAgICAvLyBmb3Igdi1tb2RlbCB1cGRhdGU6eHh4IGV2ZW50cywgYXBwbHkgbW9kaWZpZXJzIG9uIGFyZ3NcclxuICAgIGNvbnN0IG1vZGVsQXJnID0gaXNNb2RlbExpc3RlbmVyICYmIGV2ZW50LnNsaWNlKDcpO1xyXG4gICAgaWYgKG1vZGVsQXJnICYmIG1vZGVsQXJnIGluIHByb3BzKSB7XHJcbiAgICAgICAgY29uc3QgbW9kaWZpZXJzS2V5ID0gYCR7bW9kZWxBcmcgPT09ICdtb2RlbFZhbHVlJyA/ICdtb2RlbCcgOiBtb2RlbEFyZ31Nb2RpZmllcnNgO1xyXG4gICAgICAgIGNvbnN0IHsgbnVtYmVyLCB0cmltIH0gPSBwcm9wc1ttb2RpZmllcnNLZXldIHx8IEVNUFRZX09CSjtcclxuICAgICAgICBpZiAodHJpbSkge1xyXG4gICAgICAgICAgICBhcmdzID0gcmF3QXJncy5tYXAoYSA9PiBhLnRyaW0oKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKG51bWJlcikge1xyXG4gICAgICAgICAgICBhcmdzID0gcmF3QXJncy5tYXAodG9OdW1iZXIpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgfHwgX19WVUVfUFJPRF9ERVZUT09MU19fKSB7XHJcbiAgICAgICAgZGV2dG9vbHNDb21wb25lbnRFbWl0KGluc3RhbmNlLCBldmVudCwgYXJncyk7XHJcbiAgICB9XHJcbiAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgY29uc3QgbG93ZXJDYXNlRXZlbnQgPSBldmVudC50b0xvd2VyQ2FzZSgpO1xyXG4gICAgICAgIGlmIChsb3dlckNhc2VFdmVudCAhPT0gZXZlbnQgJiYgcHJvcHNbdG9IYW5kbGVyS2V5KGxvd2VyQ2FzZUV2ZW50KV0pIHtcclxuICAgICAgICAgICAgd2FybihgRXZlbnQgXCIke2xvd2VyQ2FzZUV2ZW50fVwiIGlzIGVtaXR0ZWQgaW4gY29tcG9uZW50IGAgK1xyXG4gICAgICAgICAgICAgICAgYCR7Zm9ybWF0Q29tcG9uZW50TmFtZShpbnN0YW5jZSwgaW5zdGFuY2UudHlwZSl9IGJ1dCB0aGUgaGFuZGxlciBpcyByZWdpc3RlcmVkIGZvciBcIiR7ZXZlbnR9XCIuIGAgK1xyXG4gICAgICAgICAgICAgICAgYE5vdGUgdGhhdCBIVE1MIGF0dHJpYnV0ZXMgYXJlIGNhc2UtaW5zZW5zaXRpdmUgYW5kIHlvdSBjYW5ub3QgdXNlIGAgK1xyXG4gICAgICAgICAgICAgICAgYHYtb24gdG8gbGlzdGVuIHRvIGNhbWVsQ2FzZSBldmVudHMgd2hlbiB1c2luZyBpbi1ET00gdGVtcGxhdGVzLiBgICtcclxuICAgICAgICAgICAgICAgIGBZb3Ugc2hvdWxkIHByb2JhYmx5IHVzZSBcIiR7aHlwaGVuYXRlKGV2ZW50KX1cIiBpbnN0ZWFkIG9mIFwiJHtldmVudH1cIi5gKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBsZXQgaGFuZGxlck5hbWU7XHJcbiAgICBsZXQgaGFuZGxlciA9IHByb3BzWyhoYW5kbGVyTmFtZSA9IHRvSGFuZGxlcktleShldmVudCkpXSB8fFxyXG4gICAgICAgIC8vIGFsc28gdHJ5IGNhbWVsQ2FzZSBldmVudCBoYW5kbGVyICgjMjI0OSlcclxuICAgICAgICBwcm9wc1soaGFuZGxlck5hbWUgPSB0b0hhbmRsZXJLZXkoY2FtZWxpemUoZXZlbnQpKSldO1xyXG4gICAgLy8gZm9yIHYtbW9kZWwgdXBkYXRlOnh4eCBldmVudHMsIGFsc28gdHJpZ2dlciBrZWJhYi1jYXNlIGVxdWl2YWxlbnRcclxuICAgIC8vIGZvciBwcm9wcyBwYXNzZWQgdmlhIGtlYmFiLWNhc2VcclxuICAgIGlmICghaGFuZGxlciAmJiBpc01vZGVsTGlzdGVuZXIpIHtcclxuICAgICAgICBoYW5kbGVyID0gcHJvcHNbKGhhbmRsZXJOYW1lID0gdG9IYW5kbGVyS2V5KGh5cGhlbmF0ZShldmVudCkpKV07XHJcbiAgICB9XHJcbiAgICBpZiAoaGFuZGxlcikge1xyXG4gICAgICAgIGNhbGxXaXRoQXN5bmNFcnJvckhhbmRsaW5nKGhhbmRsZXIsIGluc3RhbmNlLCA2IC8qIENPTVBPTkVOVF9FVkVOVF9IQU5ETEVSICovLCBhcmdzKTtcclxuICAgIH1cclxuICAgIGNvbnN0IG9uY2VIYW5kbGVyID0gcHJvcHNbaGFuZGxlck5hbWUgKyBgT25jZWBdO1xyXG4gICAgaWYgKG9uY2VIYW5kbGVyKSB7XHJcbiAgICAgICAgaWYgKCFpbnN0YW5jZS5lbWl0dGVkKSB7XHJcbiAgICAgICAgICAgIGluc3RhbmNlLmVtaXR0ZWQgPSB7fTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoaW5zdGFuY2UuZW1pdHRlZFtoYW5kbGVyTmFtZV0pIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpbnN0YW5jZS5lbWl0dGVkW2hhbmRsZXJOYW1lXSA9IHRydWU7XHJcbiAgICAgICAgY2FsbFdpdGhBc3luY0Vycm9ySGFuZGxpbmcob25jZUhhbmRsZXIsIGluc3RhbmNlLCA2IC8qIENPTVBPTkVOVF9FVkVOVF9IQU5ETEVSICovLCBhcmdzKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBub3JtYWxpemVFbWl0c09wdGlvbnMoY29tcCwgYXBwQ29udGV4dCwgYXNNaXhpbiA9IGZhbHNlKSB7XHJcbiAgICBjb25zdCBjYWNoZSA9IGFwcENvbnRleHQuZW1pdHNDYWNoZTtcclxuICAgIGNvbnN0IGNhY2hlZCA9IGNhY2hlLmdldChjb21wKTtcclxuICAgIGlmIChjYWNoZWQgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHJldHVybiBjYWNoZWQ7XHJcbiAgICB9XHJcbiAgICBjb25zdCByYXcgPSBjb21wLmVtaXRzO1xyXG4gICAgbGV0IG5vcm1hbGl6ZWQgPSB7fTtcclxuICAgIC8vIGFwcGx5IG1peGluL2V4dGVuZHMgcHJvcHNcclxuICAgIGxldCBoYXNFeHRlbmRzID0gZmFsc2U7XHJcbiAgICBpZiAoX19WVUVfT1BUSU9OU19BUElfXyAmJiAhaXNGdW5jdGlvbihjb21wKSkge1xyXG4gICAgICAgIGNvbnN0IGV4dGVuZEVtaXRzID0gKHJhdykgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBub3JtYWxpemVkRnJvbUV4dGVuZCA9IG5vcm1hbGl6ZUVtaXRzT3B0aW9ucyhyYXcsIGFwcENvbnRleHQsIHRydWUpO1xyXG4gICAgICAgICAgICBpZiAobm9ybWFsaXplZEZyb21FeHRlbmQpIHtcclxuICAgICAgICAgICAgICAgIGhhc0V4dGVuZHMgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgZXh0ZW5kKG5vcm1hbGl6ZWQsIG5vcm1hbGl6ZWRGcm9tRXh0ZW5kKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgaWYgKCFhc01peGluICYmIGFwcENvbnRleHQubWl4aW5zLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBhcHBDb250ZXh0Lm1peGlucy5mb3JFYWNoKGV4dGVuZEVtaXRzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGNvbXAuZXh0ZW5kcykge1xyXG4gICAgICAgICAgICBleHRlbmRFbWl0cyhjb21wLmV4dGVuZHMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY29tcC5taXhpbnMpIHtcclxuICAgICAgICAgICAgY29tcC5taXhpbnMuZm9yRWFjaChleHRlbmRFbWl0cyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYgKCFyYXcgJiYgIWhhc0V4dGVuZHMpIHtcclxuICAgICAgICBjYWNoZS5zZXQoY29tcCwgbnVsbCk7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgICBpZiAoaXNBcnJheShyYXcpKSB7XHJcbiAgICAgICAgcmF3LmZvckVhY2goa2V5ID0+IChub3JtYWxpemVkW2tleV0gPSBudWxsKSk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBleHRlbmQobm9ybWFsaXplZCwgcmF3KTtcclxuICAgIH1cclxuICAgIGNhY2hlLnNldChjb21wLCBub3JtYWxpemVkKTtcclxuICAgIHJldHVybiBub3JtYWxpemVkO1xyXG59XHJcbi8vIENoZWNrIGlmIGFuIGluY29taW5nIHByb3Aga2V5IGlzIGEgZGVjbGFyZWQgZW1pdCBldmVudCBsaXN0ZW5lci5cclxuLy8gZS5nLiBXaXRoIGBlbWl0czogeyBjbGljazogbnVsbCB9YCwgcHJvcHMgbmFtZWQgYG9uQ2xpY2tgIGFuZCBgb25jbGlja2AgYXJlXHJcbi8vIGJvdGggY29uc2lkZXJlZCBtYXRjaGVkIGxpc3RlbmVycy5cclxuZnVuY3Rpb24gaXNFbWl0TGlzdGVuZXIob3B0aW9ucywga2V5KSB7XHJcbiAgICBpZiAoIW9wdGlvbnMgfHwgIWlzT24oa2V5KSkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIGtleSA9IGtleS5zbGljZSgyKS5yZXBsYWNlKC9PbmNlJC8sICcnKTtcclxuICAgIHJldHVybiAoaGFzT3duKG9wdGlvbnMsIGtleVswXS50b0xvd2VyQ2FzZSgpICsga2V5LnNsaWNlKDEpKSB8fFxyXG4gICAgICAgIGhhc093bihvcHRpb25zLCBoeXBoZW5hdGUoa2V5KSkgfHxcclxuICAgICAgICBoYXNPd24ob3B0aW9ucywga2V5KSk7XHJcbn1cblxuLyoqXHJcbiAqIG1hcmsgdGhlIGN1cnJlbnQgcmVuZGVyaW5nIGluc3RhbmNlIGZvciBhc3NldCByZXNvbHV0aW9uIChlLmcuXHJcbiAqIHJlc29sdmVDb21wb25lbnQsIHJlc29sdmVEaXJlY3RpdmUpIGR1cmluZyByZW5kZXJcclxuICovXHJcbmxldCBjdXJyZW50UmVuZGVyaW5nSW5zdGFuY2UgPSBudWxsO1xyXG5sZXQgY3VycmVudFNjb3BlSWQgPSBudWxsO1xyXG4vKipcclxuICogTm90ZTogcmVuZGVyaW5nIGNhbGxzIG1heWJlIG5lc3RlZC4gVGhlIGZ1bmN0aW9uIHJldHVybnMgdGhlIHBhcmVudCByZW5kZXJpbmdcclxuICogaW5zdGFuY2UgaWYgcHJlc2VudCwgd2hpY2ggc2hvdWxkIGJlIHJlc3RvcmVkIGFmdGVyIHRoZSByZW5kZXIgaXMgZG9uZTpcclxuICpcclxuICogYGBganNcclxuICogY29uc3QgcHJldiA9IHNldEN1cnJlbnRSZW5kZXJpbmdJbnN0YW5jZShpKVxyXG4gKiAvLyAuLi5yZW5kZXJcclxuICogc2V0Q3VycmVudFJlbmRlcmluZ0luc3RhbmNlKHByZXYpXHJcbiAqIGBgYFxyXG4gKi9cclxuZnVuY3Rpb24gc2V0Q3VycmVudFJlbmRlcmluZ0luc3RhbmNlKGluc3RhbmNlKSB7XHJcbiAgICBjb25zdCBwcmV2ID0gY3VycmVudFJlbmRlcmluZ0luc3RhbmNlO1xyXG4gICAgY3VycmVudFJlbmRlcmluZ0luc3RhbmNlID0gaW5zdGFuY2U7XHJcbiAgICBjdXJyZW50U2NvcGVJZCA9IChpbnN0YW5jZSAmJiBpbnN0YW5jZS50eXBlLl9fc2NvcGVJZCkgfHwgbnVsbDtcclxuICAgIHJldHVybiBwcmV2O1xyXG59XHJcbi8qKlxyXG4gKiBTZXQgc2NvcGUgaWQgd2hlbiBjcmVhdGluZyBob2lzdGVkIHZub2Rlcy5cclxuICogQHByaXZhdGUgY29tcGlsZXIgaGVscGVyXHJcbiAqL1xyXG5mdW5jdGlvbiBwdXNoU2NvcGVJZChpZCkge1xyXG4gICAgY3VycmVudFNjb3BlSWQgPSBpZDtcclxufVxyXG4vKipcclxuICogVGVjaG5pY2FsbHkgd2Ugbm8gbG9uZ2VyIG5lZWQgdGhpcyBhZnRlciAzLjAuOCBidXQgd2UgbmVlZCB0byBrZWVwIHRoZSBzYW1lXHJcbiAqIEFQSSBmb3IgYmFja3dhcmRzIGNvbXBhdCB3LyBjb2RlIGdlbmVyYXRlZCBieSBjb21waWxlcnMuXHJcbiAqIEBwcml2YXRlXHJcbiAqL1xyXG5mdW5jdGlvbiBwb3BTY29wZUlkKCkge1xyXG4gICAgY3VycmVudFNjb3BlSWQgPSBudWxsO1xyXG59XHJcbi8qKlxyXG4gKiBPbmx5IGZvciBiYWNrd2FyZHMgY29tcGF0XHJcbiAqIEBwcml2YXRlXHJcbiAqL1xyXG5jb25zdCB3aXRoU2NvcGVJZCA9IChfaWQpID0+IHdpdGhDdHg7XHJcbi8qKlxyXG4gKiBXcmFwIGEgc2xvdCBmdW5jdGlvbiB0byBtZW1vaXplIGN1cnJlbnQgcmVuZGVyaW5nIGluc3RhbmNlXHJcbiAqIEBwcml2YXRlIGNvbXBpbGVyIGhlbHBlclxyXG4gKi9cclxuZnVuY3Rpb24gd2l0aEN0eChmbiwgY3R4ID0gY3VycmVudFJlbmRlcmluZ0luc3RhbmNlLCBpc05vblNjb3BlZFNsb3QgLy8gZmFsc2Ugb25seVxyXG4pIHtcclxuICAgIGlmICghY3R4KVxyXG4gICAgICAgIHJldHVybiBmbjtcclxuICAgIC8vIGFscmVhZHkgbm9ybWFsaXplZFxyXG4gICAgaWYgKGZuLl9uKSB7XHJcbiAgICAgICAgcmV0dXJuIGZuO1xyXG4gICAgfVxyXG4gICAgY29uc3QgcmVuZGVyRm5XaXRoQ29udGV4dCA9ICguLi5hcmdzKSA9PiB7XHJcbiAgICAgICAgLy8gSWYgYSB1c2VyIGNhbGxzIGEgY29tcGlsZWQgc2xvdCBpbnNpZGUgYSB0ZW1wbGF0ZSBleHByZXNzaW9uICgjMTc0NSksIGl0XHJcbiAgICAgICAgLy8gY2FuIG1lc3MgdXAgYmxvY2sgdHJhY2tpbmcsIHNvIGJ5IGRlZmF1bHQgd2UgZGlzYWJsZSBibG9jayB0cmFja2luZyBhbmRcclxuICAgICAgICAvLyBmb3JjZSBiYWlsIG91dCB3aGVuIGludm9raW5nIGEgY29tcGlsZWQgc2xvdCAoaW5kaWNhdGVkIGJ5IHRoZSAuX2QgZmxhZykuXHJcbiAgICAgICAgLy8gVGhpcyBpc24ndCBuZWNlc3NhcnkgaWYgcmVuZGVyaW5nIGEgY29tcGlsZWQgYDxzbG90PmAsIHNvIHdlIGZsaXAgdGhlXHJcbiAgICAgICAgLy8gLl9kIGZsYWcgb2ZmIHdoZW4gaW52b2tpbmcgdGhlIHdyYXBwZWQgZm4gaW5zaWRlIGByZW5kZXJTbG90YC5cclxuICAgICAgICBpZiAocmVuZGVyRm5XaXRoQ29udGV4dC5fZCkge1xyXG4gICAgICAgICAgICBzZXRCbG9ja1RyYWNraW5nKC0xKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgcHJldkluc3RhbmNlID0gc2V0Q3VycmVudFJlbmRlcmluZ0luc3RhbmNlKGN0eCk7XHJcbiAgICAgICAgY29uc3QgcmVzID0gZm4oLi4uYXJncyk7XHJcbiAgICAgICAgc2V0Q3VycmVudFJlbmRlcmluZ0luc3RhbmNlKHByZXZJbnN0YW5jZSk7XHJcbiAgICAgICAgaWYgKHJlbmRlckZuV2l0aENvbnRleHQuX2QpIHtcclxuICAgICAgICAgICAgc2V0QmxvY2tUcmFja2luZygxKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB8fCBfX1ZVRV9QUk9EX0RFVlRPT0xTX18pIHtcclxuICAgICAgICAgICAgZGV2dG9vbHNDb21wb25lbnRVcGRhdGVkKGN0eCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXM7XHJcbiAgICB9O1xyXG4gICAgLy8gbWFyayBub3JtYWxpemVkIHRvIGF2b2lkIGR1cGxpY2F0ZWQgd3JhcHBpbmdcclxuICAgIHJlbmRlckZuV2l0aENvbnRleHQuX24gPSB0cnVlO1xyXG4gICAgLy8gbWFyayB0aGlzIGFzIGNvbXBpbGVkIGJ5IGRlZmF1bHRcclxuICAgIC8vIHRoaXMgaXMgdXNlZCBpbiB2bm9kZS50cyAtPiBub3JtYWxpemVDaGlsZHJlbigpIHRvIHNldCB0aGUgc2xvdFxyXG4gICAgLy8gcmVuZGVyaW5nIGZsYWcuXHJcbiAgICByZW5kZXJGbldpdGhDb250ZXh0Ll9jID0gdHJ1ZTtcclxuICAgIC8vIGRpc2FibGUgYmxvY2sgdHJhY2tpbmcgYnkgZGVmYXVsdFxyXG4gICAgcmVuZGVyRm5XaXRoQ29udGV4dC5fZCA9IHRydWU7XHJcbiAgICByZXR1cm4gcmVuZGVyRm5XaXRoQ29udGV4dDtcclxufVxuXG4vKipcclxuICogZGV2IG9ubHkgZmxhZyB0byB0cmFjayB3aGV0aGVyICRhdHRycyB3YXMgdXNlZCBkdXJpbmcgcmVuZGVyLlxyXG4gKiBJZiAkYXR0cnMgd2FzIHVzZWQgZHVyaW5nIHJlbmRlciB0aGVuIHRoZSB3YXJuaW5nIGZvciBmYWlsZWQgYXR0cnNcclxuICogZmFsbHRocm91Z2ggY2FuIGJlIHN1cHByZXNzZWQuXHJcbiAqL1xyXG5sZXQgYWNjZXNzZWRBdHRycyA9IGZhbHNlO1xyXG5mdW5jdGlvbiBtYXJrQXR0cnNBY2Nlc3NlZCgpIHtcclxuICAgIGFjY2Vzc2VkQXR0cnMgPSB0cnVlO1xyXG59XHJcbmZ1bmN0aW9uIHJlbmRlckNvbXBvbmVudFJvb3QoaW5zdGFuY2UpIHtcclxuICAgIGNvbnN0IHsgdHlwZTogQ29tcG9uZW50LCB2bm9kZSwgcHJveHksIHdpdGhQcm94eSwgcHJvcHMsIHByb3BzT3B0aW9uczogW3Byb3BzT3B0aW9uc10sIHNsb3RzLCBhdHRycywgZW1pdCwgcmVuZGVyLCByZW5kZXJDYWNoZSwgZGF0YSwgc2V0dXBTdGF0ZSwgY3R4LCBpbmhlcml0QXR0cnMgfSA9IGluc3RhbmNlO1xyXG4gICAgbGV0IHJlc3VsdDtcclxuICAgIGxldCBmYWxsdGhyb3VnaEF0dHJzO1xyXG4gICAgY29uc3QgcHJldiA9IHNldEN1cnJlbnRSZW5kZXJpbmdJbnN0YW5jZShpbnN0YW5jZSk7XHJcbiAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgYWNjZXNzZWRBdHRycyA9IGZhbHNlO1xyXG4gICAgfVxyXG4gICAgdHJ5IHtcclxuICAgICAgICBpZiAodm5vZGUuc2hhcGVGbGFnICYgNCAvKiBTVEFURUZVTF9DT01QT05FTlQgKi8pIHtcclxuICAgICAgICAgICAgLy8gd2l0aFByb3h5IGlzIGEgcHJveHkgd2l0aCBhIGRpZmZlcmVudCBgaGFzYCB0cmFwIG9ubHkgZm9yXHJcbiAgICAgICAgICAgIC8vIHJ1bnRpbWUtY29tcGlsZWQgcmVuZGVyIGZ1bmN0aW9ucyB1c2luZyBgd2l0aGAgYmxvY2suXHJcbiAgICAgICAgICAgIGNvbnN0IHByb3h5VG9Vc2UgPSB3aXRoUHJveHkgfHwgcHJveHk7XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IG5vcm1hbGl6ZVZOb2RlKHJlbmRlci5jYWxsKHByb3h5VG9Vc2UsIHByb3h5VG9Vc2UsIHJlbmRlckNhY2hlLCBwcm9wcywgc2V0dXBTdGF0ZSwgZGF0YSwgY3R4KSk7XHJcbiAgICAgICAgICAgIGZhbGx0aHJvdWdoQXR0cnMgPSBhdHRycztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIGZ1bmN0aW9uYWxcclxuICAgICAgICAgICAgY29uc3QgcmVuZGVyID0gQ29tcG9uZW50O1xyXG4gICAgICAgICAgICAvLyBpbiBkZXYsIG1hcmsgYXR0cnMgYWNjZXNzZWQgaWYgb3B0aW9uYWwgcHJvcHMgKGF0dHJzID09PSBwcm9wcylcclxuICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiBhdHRycyA9PT0gcHJvcHMpIHtcclxuICAgICAgICAgICAgICAgIG1hcmtBdHRyc0FjY2Vzc2VkKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmVzdWx0ID0gbm9ybWFsaXplVk5vZGUocmVuZGVyLmxlbmd0aCA+IDFcclxuICAgICAgICAgICAgICAgID8gcmVuZGVyKHByb3BzLCAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJylcclxuICAgICAgICAgICAgICAgICAgICA/IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZ2V0IGF0dHJzKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFya0F0dHJzQWNjZXNzZWQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhdHRycztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2xvdHMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVtaXRcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgOiB7IGF0dHJzLCBzbG90cywgZW1pdCB9KVxyXG4gICAgICAgICAgICAgICAgOiByZW5kZXIocHJvcHMsIG51bGwgLyogd2Uga25vdyBpdCBkb2Vzbid0IG5lZWQgaXQgKi8pKTtcclxuICAgICAgICAgICAgZmFsbHRocm91Z2hBdHRycyA9IENvbXBvbmVudC5wcm9wc1xyXG4gICAgICAgICAgICAgICAgPyBhdHRyc1xyXG4gICAgICAgICAgICAgICAgOiBnZXRGdW5jdGlvbmFsRmFsbHRocm91Z2goYXR0cnMpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGNhdGNoIChlcnIpIHtcclxuICAgICAgICBibG9ja1N0YWNrLmxlbmd0aCA9IDA7XHJcbiAgICAgICAgaGFuZGxlRXJyb3IoZXJyLCBpbnN0YW5jZSwgMSAvKiBSRU5ERVJfRlVOQ1RJT04gKi8pO1xyXG4gICAgICAgIHJlc3VsdCA9IGNyZWF0ZVZOb2RlKENvbW1lbnQpO1xyXG4gICAgfVxyXG4gICAgLy8gYXR0ciBtZXJnaW5nXHJcbiAgICAvLyBpbiBkZXYgbW9kZSwgY29tbWVudHMgYXJlIHByZXNlcnZlZCwgYW5kIGl0J3MgcG9zc2libGUgZm9yIGEgdGVtcGxhdGVcclxuICAgIC8vIHRvIGhhdmUgY29tbWVudHMgYWxvbmcgc2lkZSB0aGUgcm9vdCBlbGVtZW50IHdoaWNoIG1ha2VzIGl0IGEgZnJhZ21lbnRcclxuICAgIGxldCByb290ID0gcmVzdWx0O1xyXG4gICAgbGV0IHNldFJvb3QgPSB1bmRlZmluZWQ7XHJcbiAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmXHJcbiAgICAgICAgcmVzdWx0LnBhdGNoRmxhZyA+IDAgJiZcclxuICAgICAgICByZXN1bHQucGF0Y2hGbGFnICYgMjA0OCAvKiBERVZfUk9PVF9GUkFHTUVOVCAqLykge1xyXG4gICAgICAgIFtyb290LCBzZXRSb290XSA9IGdldENoaWxkUm9vdChyZXN1bHQpO1xyXG4gICAgfVxyXG4gICAgaWYgKGZhbGx0aHJvdWdoQXR0cnMgJiYgaW5oZXJpdEF0dHJzICE9PSBmYWxzZSkge1xyXG4gICAgICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhmYWxsdGhyb3VnaEF0dHJzKTtcclxuICAgICAgICBjb25zdCB7IHNoYXBlRmxhZyB9ID0gcm9vdDtcclxuICAgICAgICBpZiAoa2V5cy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgaWYgKHNoYXBlRmxhZyAmICgxIC8qIEVMRU1FTlQgKi8gfCA2IC8qIENPTVBPTkVOVCAqLykpIHtcclxuICAgICAgICAgICAgICAgIGlmIChwcm9wc09wdGlvbnMgJiYga2V5cy5zb21lKGlzTW9kZWxMaXN0ZW5lcikpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBJZiBhIHYtbW9kZWwgbGlzdGVuZXIgKG9uVXBkYXRlOnh4eCkgaGFzIGEgY29ycmVzcG9uZGluZyBkZWNsYXJlZFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHByb3AsIGl0IGluZGljYXRlcyB0aGlzIGNvbXBvbmVudCBleHBlY3RzIHRvIGhhbmRsZSB2LW1vZGVsIGFuZFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGl0IHNob3VsZCBub3QgZmFsbHRocm91Z2guXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gcmVsYXRlZDogIzE1NDMsICMxNjQzLCAjMTk4OVxyXG4gICAgICAgICAgICAgICAgICAgIGZhbGx0aHJvdWdoQXR0cnMgPSBmaWx0ZXJNb2RlbExpc3RlbmVycyhmYWxsdGhyb3VnaEF0dHJzLCBwcm9wc09wdGlvbnMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcm9vdCA9IGNsb25lVk5vZGUocm9vdCwgZmFsbHRocm91Z2hBdHRycyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmICFhY2Nlc3NlZEF0dHJzICYmIHJvb3QudHlwZSAhPT0gQ29tbWVudCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgYWxsQXR0cnMgPSBPYmplY3Qua2V5cyhhdHRycyk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBldmVudEF0dHJzID0gW107XHJcbiAgICAgICAgICAgICAgICBjb25zdCBleHRyYUF0dHJzID0gW107XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMCwgbCA9IGFsbEF0dHJzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGtleSA9IGFsbEF0dHJzW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpc09uKGtleSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWdub3JlIHYtbW9kZWwgaGFuZGxlcnMgd2hlbiB0aGV5IGZhaWwgdG8gZmFsbHRocm91Z2hcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc01vZGVsTGlzdGVuZXIoa2V5KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVtb3ZlIGBvbmAsIGxvd2VyY2FzZSBmaXJzdCBsZXR0ZXIgdG8gcmVmbGVjdCBldmVudCBjYXNpbmdcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFjY3VyYXRlbHlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50QXR0cnMucHVzaChrZXlbMl0udG9Mb3dlckNhc2UoKSArIGtleS5zbGljZSgzKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4dHJhQXR0cnMucHVzaChrZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChleHRyYUF0dHJzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHdhcm4oYEV4dHJhbmVvdXMgbm9uLXByb3BzIGF0dHJpYnV0ZXMgKGAgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBgJHtleHRyYUF0dHJzLmpvaW4oJywgJyl9KSBgICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYHdlcmUgcGFzc2VkIHRvIGNvbXBvbmVudCBidXQgY291bGQgbm90IGJlIGF1dG9tYXRpY2FsbHkgaW5oZXJpdGVkIGAgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBgYmVjYXVzZSBjb21wb25lbnQgcmVuZGVycyBmcmFnbWVudCBvciB0ZXh0IHJvb3Qgbm9kZXMuYCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoZXZlbnRBdHRycy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICB3YXJuKGBFeHRyYW5lb3VzIG5vbi1lbWl0cyBldmVudCBsaXN0ZW5lcnMgKGAgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBgJHtldmVudEF0dHJzLmpvaW4oJywgJyl9KSBgICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYHdlcmUgcGFzc2VkIHRvIGNvbXBvbmVudCBidXQgY291bGQgbm90IGJlIGF1dG9tYXRpY2FsbHkgaW5oZXJpdGVkIGAgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBgYmVjYXVzZSBjb21wb25lbnQgcmVuZGVycyBmcmFnbWVudCBvciB0ZXh0IHJvb3Qgbm9kZXMuIGAgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBgSWYgdGhlIGxpc3RlbmVyIGlzIGludGVuZGVkIHRvIGJlIGEgY29tcG9uZW50IGN1c3RvbSBldmVudCBsaXN0ZW5lciBvbmx5LCBgICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYGRlY2xhcmUgaXQgdXNpbmcgdGhlIFwiZW1pdHNcIiBvcHRpb24uYCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyBpbmhlcml0IGRpcmVjdGl2ZXNcclxuICAgIGlmICh2bm9kZS5kaXJzKSB7XHJcbiAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiAhaXNFbGVtZW50Um9vdChyb290KSkge1xyXG4gICAgICAgICAgICB3YXJuKGBSdW50aW1lIGRpcmVjdGl2ZSB1c2VkIG9uIGNvbXBvbmVudCB3aXRoIG5vbi1lbGVtZW50IHJvb3Qgbm9kZS4gYCArXHJcbiAgICAgICAgICAgICAgICBgVGhlIGRpcmVjdGl2ZXMgd2lsbCBub3QgZnVuY3Rpb24gYXMgaW50ZW5kZWQuYCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJvb3QuZGlycyA9IHJvb3QuZGlycyA/IHJvb3QuZGlycy5jb25jYXQodm5vZGUuZGlycykgOiB2bm9kZS5kaXJzO1xyXG4gICAgfVxyXG4gICAgLy8gaW5oZXJpdCB0cmFuc2l0aW9uIGRhdGFcclxuICAgIGlmICh2bm9kZS50cmFuc2l0aW9uKSB7XHJcbiAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiAhaXNFbGVtZW50Um9vdChyb290KSkge1xyXG4gICAgICAgICAgICB3YXJuKGBDb21wb25lbnQgaW5zaWRlIDxUcmFuc2l0aW9uPiByZW5kZXJzIG5vbi1lbGVtZW50IHJvb3Qgbm9kZSBgICtcclxuICAgICAgICAgICAgICAgIGB0aGF0IGNhbm5vdCBiZSBhbmltYXRlZC5gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcm9vdC50cmFuc2l0aW9uID0gdm5vZGUudHJhbnNpdGlvbjtcclxuICAgIH1cclxuICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiYgc2V0Um9vdCkge1xyXG4gICAgICAgIHNldFJvb3Qocm9vdCk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICByZXN1bHQgPSByb290O1xyXG4gICAgfVxyXG4gICAgc2V0Q3VycmVudFJlbmRlcmluZ0luc3RhbmNlKHByZXYpO1xyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG4vKipcclxuICogZGV2IG9ubHlcclxuICogSW4gZGV2IG1vZGUsIHRlbXBsYXRlIHJvb3QgbGV2ZWwgY29tbWVudHMgYXJlIHJlbmRlcmVkLCB3aGljaCB0dXJucyB0aGVcclxuICogdGVtcGxhdGUgaW50byBhIGZyYWdtZW50IHJvb3QsIGJ1dCB3ZSBuZWVkIHRvIGxvY2F0ZSB0aGUgc2luZ2xlIGVsZW1lbnRcclxuICogcm9vdCBmb3IgYXR0cnMgYW5kIHNjb3BlIGlkIHByb2Nlc3NpbmcuXHJcbiAqL1xyXG5jb25zdCBnZXRDaGlsZFJvb3QgPSAodm5vZGUpID0+IHtcclxuICAgIGNvbnN0IHJhd0NoaWxkcmVuID0gdm5vZGUuY2hpbGRyZW47XHJcbiAgICBjb25zdCBkeW5hbWljQ2hpbGRyZW4gPSB2bm9kZS5keW5hbWljQ2hpbGRyZW47XHJcbiAgICBjb25zdCBjaGlsZFJvb3QgPSBmaWx0ZXJTaW5nbGVSb290KHJhd0NoaWxkcmVuKTtcclxuICAgIGlmICghY2hpbGRSb290KSB7XHJcbiAgICAgICAgcmV0dXJuIFt2bm9kZSwgdW5kZWZpbmVkXTtcclxuICAgIH1cclxuICAgIGNvbnN0IGluZGV4ID0gcmF3Q2hpbGRyZW4uaW5kZXhPZihjaGlsZFJvb3QpO1xyXG4gICAgY29uc3QgZHluYW1pY0luZGV4ID0gZHluYW1pY0NoaWxkcmVuID8gZHluYW1pY0NoaWxkcmVuLmluZGV4T2YoY2hpbGRSb290KSA6IC0xO1xyXG4gICAgY29uc3Qgc2V0Um9vdCA9ICh1cGRhdGVkUm9vdCkgPT4ge1xyXG4gICAgICAgIHJhd0NoaWxkcmVuW2luZGV4XSA9IHVwZGF0ZWRSb290O1xyXG4gICAgICAgIGlmIChkeW5hbWljQ2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgaWYgKGR5bmFtaWNJbmRleCA+IC0xKSB7XHJcbiAgICAgICAgICAgICAgICBkeW5hbWljQ2hpbGRyZW5bZHluYW1pY0luZGV4XSA9IHVwZGF0ZWRSb290O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHVwZGF0ZWRSb290LnBhdGNoRmxhZyA+IDApIHtcclxuICAgICAgICAgICAgICAgIHZub2RlLmR5bmFtaWNDaGlsZHJlbiA9IFsuLi5keW5hbWljQ2hpbGRyZW4sIHVwZGF0ZWRSb290XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICByZXR1cm4gW25vcm1hbGl6ZVZOb2RlKGNoaWxkUm9vdCksIHNldFJvb3RdO1xyXG59O1xyXG5mdW5jdGlvbiBmaWx0ZXJTaW5nbGVSb290KGNoaWxkcmVuKSB7XHJcbiAgICBsZXQgc2luZ2xlUm9vdDtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBjb25zdCBjaGlsZCA9IGNoaWxkcmVuW2ldO1xyXG4gICAgICAgIGlmIChpc1ZOb2RlKGNoaWxkKSkge1xyXG4gICAgICAgICAgICAvLyBpZ25vcmUgdXNlciBjb21tZW50XHJcbiAgICAgICAgICAgIGlmIChjaGlsZC50eXBlICE9PSBDb21tZW50IHx8IGNoaWxkLmNoaWxkcmVuID09PSAndi1pZicpIHtcclxuICAgICAgICAgICAgICAgIGlmIChzaW5nbGVSb290KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gaGFzIG1vcmUgdGhhbiAxIG5vbi1jb21tZW50IGNoaWxkLCByZXR1cm4gbm93XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2luZ2xlUm9vdCA9IGNoaWxkO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHNpbmdsZVJvb3Q7XHJcbn1cclxuY29uc3QgZ2V0RnVuY3Rpb25hbEZhbGx0aHJvdWdoID0gKGF0dHJzKSA9PiB7XHJcbiAgICBsZXQgcmVzO1xyXG4gICAgZm9yIChjb25zdCBrZXkgaW4gYXR0cnMpIHtcclxuICAgICAgICBpZiAoa2V5ID09PSAnY2xhc3MnIHx8IGtleSA9PT0gJ3N0eWxlJyB8fCBpc09uKGtleSkpIHtcclxuICAgICAgICAgICAgKHJlcyB8fCAocmVzID0ge30pKVtrZXldID0gYXR0cnNba2V5XTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzO1xyXG59O1xyXG5jb25zdCBmaWx0ZXJNb2RlbExpc3RlbmVycyA9IChhdHRycywgcHJvcHMpID0+IHtcclxuICAgIGNvbnN0IHJlcyA9IHt9O1xyXG4gICAgZm9yIChjb25zdCBrZXkgaW4gYXR0cnMpIHtcclxuICAgICAgICBpZiAoIWlzTW9kZWxMaXN0ZW5lcihrZXkpIHx8ICEoa2V5LnNsaWNlKDkpIGluIHByb3BzKSkge1xyXG4gICAgICAgICAgICByZXNba2V5XSA9IGF0dHJzW2tleV07XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlcztcclxufTtcclxuY29uc3QgaXNFbGVtZW50Um9vdCA9ICh2bm9kZSkgPT4ge1xyXG4gICAgcmV0dXJuICh2bm9kZS5zaGFwZUZsYWcgJiAoNiAvKiBDT01QT05FTlQgKi8gfCAxIC8qIEVMRU1FTlQgKi8pIHx8XHJcbiAgICAgICAgdm5vZGUudHlwZSA9PT0gQ29tbWVudCAvLyBwb3RlbnRpYWwgdi1pZiBicmFuY2ggc3dpdGNoXHJcbiAgICApO1xyXG59O1xyXG5mdW5jdGlvbiBzaG91bGRVcGRhdGVDb21wb25lbnQocHJldlZOb2RlLCBuZXh0Vk5vZGUsIG9wdGltaXplZCkge1xyXG4gICAgY29uc3QgeyBwcm9wczogcHJldlByb3BzLCBjaGlsZHJlbjogcHJldkNoaWxkcmVuLCBjb21wb25lbnQgfSA9IHByZXZWTm9kZTtcclxuICAgIGNvbnN0IHsgcHJvcHM6IG5leHRQcm9wcywgY2hpbGRyZW46IG5leHRDaGlsZHJlbiwgcGF0Y2hGbGFnIH0gPSBuZXh0Vk5vZGU7XHJcbiAgICBjb25zdCBlbWl0cyA9IGNvbXBvbmVudC5lbWl0c09wdGlvbnM7XHJcbiAgICAvLyBQYXJlbnQgY29tcG9uZW50J3MgcmVuZGVyIGZ1bmN0aW9uIHdhcyBob3QtdXBkYXRlZC4gU2luY2UgdGhpcyBtYXkgaGF2ZVxyXG4gICAgLy8gY2F1c2VkIHRoZSBjaGlsZCBjb21wb25lbnQncyBzbG90cyBjb250ZW50IHRvIGhhdmUgY2hhbmdlZCwgd2UgbmVlZCB0b1xyXG4gICAgLy8gZm9yY2UgdGhlIGNoaWxkIHRvIHVwZGF0ZSBhcyB3ZWxsLlxyXG4gICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiAocHJldkNoaWxkcmVuIHx8IG5leHRDaGlsZHJlbikgJiYgaXNIbXJVcGRhdGluZykge1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgLy8gZm9yY2UgY2hpbGQgdXBkYXRlIGZvciBydW50aW1lIGRpcmVjdGl2ZSBvciB0cmFuc2l0aW9uIG9uIGNvbXBvbmVudCB2bm9kZS5cclxuICAgIGlmIChuZXh0Vk5vZGUuZGlycyB8fCBuZXh0Vk5vZGUudHJhbnNpdGlvbikge1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgaWYgKG9wdGltaXplZCAmJiBwYXRjaEZsYWcgPj0gMCkge1xyXG4gICAgICAgIGlmIChwYXRjaEZsYWcgJiAxMDI0IC8qIERZTkFNSUNfU0xPVFMgKi8pIHtcclxuICAgICAgICAgICAgLy8gc2xvdCBjb250ZW50IHRoYXQgcmVmZXJlbmNlcyB2YWx1ZXMgdGhhdCBtaWdodCBoYXZlIGNoYW5nZWQsXHJcbiAgICAgICAgICAgIC8vIGUuZy4gaW4gYSB2LWZvclxyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHBhdGNoRmxhZyAmIDE2IC8qIEZVTExfUFJPUFMgKi8pIHtcclxuICAgICAgICAgICAgaWYgKCFwcmV2UHJvcHMpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAhIW5leHRQcm9wcztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBwcmVzZW5jZSBvZiB0aGlzIGZsYWcgaW5kaWNhdGVzIHByb3BzIGFyZSBhbHdheXMgbm9uLW51bGxcclxuICAgICAgICAgICAgcmV0dXJuIGhhc1Byb3BzQ2hhbmdlZChwcmV2UHJvcHMsIG5leHRQcm9wcywgZW1pdHMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChwYXRjaEZsYWcgJiA4IC8qIFBST1BTICovKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGR5bmFtaWNQcm9wcyA9IG5leHRWTm9kZS5keW5hbWljUHJvcHM7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZHluYW1pY1Byb3BzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBrZXkgPSBkeW5hbWljUHJvcHNbaV07XHJcbiAgICAgICAgICAgICAgICBpZiAobmV4dFByb3BzW2tleV0gIT09IHByZXZQcm9wc1trZXldICYmXHJcbiAgICAgICAgICAgICAgICAgICAgIWlzRW1pdExpc3RlbmVyKGVtaXRzLCBrZXkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICAvLyB0aGlzIHBhdGggaXMgb25seSB0YWtlbiBieSBtYW51YWxseSB3cml0dGVuIHJlbmRlciBmdW5jdGlvbnNcclxuICAgICAgICAvLyBzbyBwcmVzZW5jZSBvZiBhbnkgY2hpbGRyZW4gbGVhZHMgdG8gYSBmb3JjZWQgdXBkYXRlXHJcbiAgICAgICAgaWYgKHByZXZDaGlsZHJlbiB8fCBuZXh0Q2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgaWYgKCFuZXh0Q2hpbGRyZW4gfHwgIW5leHRDaGlsZHJlbi4kc3RhYmxlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocHJldlByb3BzID09PSBuZXh0UHJvcHMpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXByZXZQcm9wcykge1xyXG4gICAgICAgICAgICByZXR1cm4gISFuZXh0UHJvcHM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghbmV4dFByb3BzKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gaGFzUHJvcHNDaGFuZ2VkKHByZXZQcm9wcywgbmV4dFByb3BzLCBlbWl0cyk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbn1cclxuZnVuY3Rpb24gaGFzUHJvcHNDaGFuZ2VkKHByZXZQcm9wcywgbmV4dFByb3BzLCBlbWl0c09wdGlvbnMpIHtcclxuICAgIGNvbnN0IG5leHRLZXlzID0gT2JqZWN0LmtleXMobmV4dFByb3BzKTtcclxuICAgIGlmIChuZXh0S2V5cy5sZW5ndGggIT09IE9iamVjdC5rZXlzKHByZXZQcm9wcykubGVuZ3RoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5leHRLZXlzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgY29uc3Qga2V5ID0gbmV4dEtleXNbaV07XHJcbiAgICAgICAgaWYgKG5leHRQcm9wc1trZXldICE9PSBwcmV2UHJvcHNba2V5XSAmJlxyXG4gICAgICAgICAgICAhaXNFbWl0TGlzdGVuZXIoZW1pdHNPcHRpb25zLCBrZXkpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBmYWxzZTtcclxufVxyXG5mdW5jdGlvbiB1cGRhdGVIT0NIb3N0RWwoeyB2bm9kZSwgcGFyZW50IH0sIGVsIC8vIEhvc3ROb2RlXHJcbikge1xyXG4gICAgd2hpbGUgKHBhcmVudCAmJiBwYXJlbnQuc3ViVHJlZSA9PT0gdm5vZGUpIHtcclxuICAgICAgICAodm5vZGUgPSBwYXJlbnQudm5vZGUpLmVsID0gZWw7XHJcbiAgICAgICAgcGFyZW50ID0gcGFyZW50LnBhcmVudDtcclxuICAgIH1cclxufVxuXG5jb25zdCBpc1N1c3BlbnNlID0gKHR5cGUpID0+IHR5cGUuX19pc1N1c3BlbnNlO1xyXG4vLyBTdXNwZW5zZSBleHBvc2VzIGEgY29tcG9uZW50LWxpa2UgQVBJLCBhbmQgaXMgdHJlYXRlZCBsaWtlIGEgY29tcG9uZW50XHJcbi8vIGluIHRoZSBjb21waWxlciwgYnV0IGludGVybmFsbHkgaXQncyBhIHNwZWNpYWwgYnVpbHQtaW4gdHlwZSB0aGF0IGhvb2tzXHJcbi8vIGRpcmVjdGx5IGludG8gdGhlIHJlbmRlcmVyLlxyXG5jb25zdCBTdXNwZW5zZUltcGwgPSB7XHJcbiAgICBuYW1lOiAnU3VzcGVuc2UnLFxyXG4gICAgLy8gSW4gb3JkZXIgdG8gbWFrZSBTdXNwZW5zZSB0cmVlLXNoYWthYmxlLCB3ZSBuZWVkIHRvIGF2b2lkIGltcG9ydGluZyBpdFxyXG4gICAgLy8gZGlyZWN0bHkgaW4gdGhlIHJlbmRlcmVyLiBUaGUgcmVuZGVyZXIgY2hlY2tzIGZvciB0aGUgX19pc1N1c3BlbnNlIGZsYWdcclxuICAgIC8vIG9uIGEgdm5vZGUncyB0eXBlIGFuZCBjYWxscyB0aGUgYHByb2Nlc3NgIG1ldGhvZCwgcGFzc2luZyBpbiByZW5kZXJlclxyXG4gICAgLy8gaW50ZXJuYWxzLlxyXG4gICAgX19pc1N1c3BlbnNlOiB0cnVlLFxyXG4gICAgcHJvY2VzcyhuMSwgbjIsIGNvbnRhaW5lciwgYW5jaG9yLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCBpc1NWRywgc2xvdFNjb3BlSWRzLCBvcHRpbWl6ZWQsIFxyXG4gICAgLy8gcGxhdGZvcm0tc3BlY2lmaWMgaW1wbCBwYXNzZWQgZnJvbSByZW5kZXJlclxyXG4gICAgcmVuZGVyZXJJbnRlcm5hbHMpIHtcclxuICAgICAgICBpZiAobjEgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBtb3VudFN1c3BlbnNlKG4yLCBjb250YWluZXIsIGFuY2hvciwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkLCByZW5kZXJlckludGVybmFscyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBwYXRjaFN1c3BlbnNlKG4xLCBuMiwgY29udGFpbmVyLCBhbmNob3IsIHBhcmVudENvbXBvbmVudCwgaXNTVkcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkLCByZW5kZXJlckludGVybmFscyk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGh5ZHJhdGU6IGh5ZHJhdGVTdXNwZW5zZSxcclxuICAgIGNyZWF0ZTogY3JlYXRlU3VzcGVuc2VCb3VuZGFyeSxcclxuICAgIG5vcm1hbGl6ZTogbm9ybWFsaXplU3VzcGVuc2VDaGlsZHJlblxyXG59O1xyXG4vLyBGb3JjZS1jYXN0ZWQgcHVibGljIHR5cGluZyBmb3IgaCBhbmQgVFNYIHByb3BzIGluZmVyZW5jZVxyXG5jb25zdCBTdXNwZW5zZSA9IChTdXNwZW5zZUltcGwgKTtcclxuZnVuY3Rpb24gdHJpZ2dlckV2ZW50KHZub2RlLCBuYW1lKSB7XHJcbiAgICBjb25zdCBldmVudExpc3RlbmVyID0gdm5vZGUucHJvcHMgJiYgdm5vZGUucHJvcHNbbmFtZV07XHJcbiAgICBpZiAoaXNGdW5jdGlvbihldmVudExpc3RlbmVyKSkge1xyXG4gICAgICAgIGV2ZW50TGlzdGVuZXIoKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBtb3VudFN1c3BlbnNlKHZub2RlLCBjb250YWluZXIsIGFuY2hvciwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkLCByZW5kZXJlckludGVybmFscykge1xyXG4gICAgY29uc3QgeyBwOiBwYXRjaCwgbzogeyBjcmVhdGVFbGVtZW50IH0gfSA9IHJlbmRlcmVySW50ZXJuYWxzO1xyXG4gICAgY29uc3QgaGlkZGVuQ29udGFpbmVyID0gY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICBjb25zdCBzdXNwZW5zZSA9ICh2bm9kZS5zdXNwZW5zZSA9IGNyZWF0ZVN1c3BlbnNlQm91bmRhcnkodm5vZGUsIHBhcmVudFN1c3BlbnNlLCBwYXJlbnRDb21wb25lbnQsIGNvbnRhaW5lciwgaGlkZGVuQ29udGFpbmVyLCBhbmNob3IsIGlzU1ZHLCBzbG90U2NvcGVJZHMsIG9wdGltaXplZCwgcmVuZGVyZXJJbnRlcm5hbHMpKTtcclxuICAgIC8vIHN0YXJ0IG1vdW50aW5nIHRoZSBjb250ZW50IHN1YnRyZWUgaW4gYW4gb2ZmLWRvbSBjb250YWluZXJcclxuICAgIHBhdGNoKG51bGwsIChzdXNwZW5zZS5wZW5kaW5nQnJhbmNoID0gdm5vZGUuc3NDb250ZW50KSwgaGlkZGVuQ29udGFpbmVyLCBudWxsLCBwYXJlbnRDb21wb25lbnQsIHN1c3BlbnNlLCBpc1NWRywgc2xvdFNjb3BlSWRzKTtcclxuICAgIC8vIG5vdyBjaGVjayBpZiB3ZSBoYXZlIGVuY291bnRlcmVkIGFueSBhc3luYyBkZXBzXHJcbiAgICBpZiAoc3VzcGVuc2UuZGVwcyA+IDApIHtcclxuICAgICAgICAvLyBoYXMgYXN5bmNcclxuICAgICAgICAvLyBpbnZva2UgQGZhbGxiYWNrIGV2ZW50XHJcbiAgICAgICAgdHJpZ2dlckV2ZW50KHZub2RlLCAnb25QZW5kaW5nJyk7XHJcbiAgICAgICAgdHJpZ2dlckV2ZW50KHZub2RlLCAnb25GYWxsYmFjaycpO1xyXG4gICAgICAgIC8vIG1vdW50IHRoZSBmYWxsYmFjayB0cmVlXHJcbiAgICAgICAgcGF0Y2gobnVsbCwgdm5vZGUuc3NGYWxsYmFjaywgY29udGFpbmVyLCBhbmNob3IsIHBhcmVudENvbXBvbmVudCwgbnVsbCwgLy8gZmFsbGJhY2sgdHJlZSB3aWxsIG5vdCBoYXZlIHN1c3BlbnNlIGNvbnRleHRcclxuICAgICAgICBpc1NWRywgc2xvdFNjb3BlSWRzKTtcclxuICAgICAgICBzZXRBY3RpdmVCcmFuY2goc3VzcGVuc2UsIHZub2RlLnNzRmFsbGJhY2spO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgLy8gU3VzcGVuc2UgaGFzIG5vIGFzeW5jIGRlcHMuIEp1c3QgcmVzb2x2ZS5cclxuICAgICAgICBzdXNwZW5zZS5yZXNvbHZlKCk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gcGF0Y2hTdXNwZW5zZShuMSwgbjIsIGNvbnRhaW5lciwgYW5jaG9yLCBwYXJlbnRDb21wb25lbnQsIGlzU1ZHLCBzbG90U2NvcGVJZHMsIG9wdGltaXplZCwgeyBwOiBwYXRjaCwgdW06IHVubW91bnQsIG86IHsgY3JlYXRlRWxlbWVudCB9IH0pIHtcclxuICAgIGNvbnN0IHN1c3BlbnNlID0gKG4yLnN1c3BlbnNlID0gbjEuc3VzcGVuc2UpO1xyXG4gICAgc3VzcGVuc2Uudm5vZGUgPSBuMjtcclxuICAgIG4yLmVsID0gbjEuZWw7XHJcbiAgICBjb25zdCBuZXdCcmFuY2ggPSBuMi5zc0NvbnRlbnQ7XHJcbiAgICBjb25zdCBuZXdGYWxsYmFjayA9IG4yLnNzRmFsbGJhY2s7XHJcbiAgICBjb25zdCB7IGFjdGl2ZUJyYW5jaCwgcGVuZGluZ0JyYW5jaCwgaXNJbkZhbGxiYWNrLCBpc0h5ZHJhdGluZyB9ID0gc3VzcGVuc2U7XHJcbiAgICBpZiAocGVuZGluZ0JyYW5jaCkge1xyXG4gICAgICAgIHN1c3BlbnNlLnBlbmRpbmdCcmFuY2ggPSBuZXdCcmFuY2g7XHJcbiAgICAgICAgaWYgKGlzU2FtZVZOb2RlVHlwZShuZXdCcmFuY2gsIHBlbmRpbmdCcmFuY2gpKSB7XHJcbiAgICAgICAgICAgIC8vIHNhbWUgcm9vdCB0eXBlIGJ1dCBjb250ZW50IG1heSBoYXZlIGNoYW5nZWQuXHJcbiAgICAgICAgICAgIHBhdGNoKHBlbmRpbmdCcmFuY2gsIG5ld0JyYW5jaCwgc3VzcGVuc2UuaGlkZGVuQ29udGFpbmVyLCBudWxsLCBwYXJlbnRDb21wb25lbnQsIHN1c3BlbnNlLCBpc1NWRywgc2xvdFNjb3BlSWRzLCBvcHRpbWl6ZWQpO1xyXG4gICAgICAgICAgICBpZiAoc3VzcGVuc2UuZGVwcyA8PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBzdXNwZW5zZS5yZXNvbHZlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoaXNJbkZhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgICAgICBwYXRjaChhY3RpdmVCcmFuY2gsIG5ld0ZhbGxiYWNrLCBjb250YWluZXIsIGFuY2hvciwgcGFyZW50Q29tcG9uZW50LCBudWxsLCAvLyBmYWxsYmFjayB0cmVlIHdpbGwgbm90IGhhdmUgc3VzcGVuc2UgY29udGV4dFxyXG4gICAgICAgICAgICAgICAgaXNTVkcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKTtcclxuICAgICAgICAgICAgICAgIHNldEFjdGl2ZUJyYW5jaChzdXNwZW5zZSwgbmV3RmFsbGJhY2spO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyB0b2dnbGVkIGJlZm9yZSBwZW5kaW5nIHRyZWUgaXMgcmVzb2x2ZWRcclxuICAgICAgICAgICAgc3VzcGVuc2UucGVuZGluZ0lkKys7XHJcbiAgICAgICAgICAgIGlmIChpc0h5ZHJhdGluZykge1xyXG4gICAgICAgICAgICAgICAgLy8gaWYgdG9nZ2xlZCBiZWZvcmUgaHlkcmF0aW9uIGlzIGZpbmlzaGVkLCB0aGUgY3VycmVudCBET00gdHJlZSBpc1xyXG4gICAgICAgICAgICAgICAgLy8gbm8gbG9uZ2VyIHZhbGlkLiBzZXQgaXQgYXMgdGhlIGFjdGl2ZSBicmFuY2ggc28gaXQgd2lsbCBiZSB1bm1vdW50ZWRcclxuICAgICAgICAgICAgICAgIC8vIHdoZW4gcmVzb2x2ZWRcclxuICAgICAgICAgICAgICAgIHN1c3BlbnNlLmlzSHlkcmF0aW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBzdXNwZW5zZS5hY3RpdmVCcmFuY2ggPSBwZW5kaW5nQnJhbmNoO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdW5tb3VudChwZW5kaW5nQnJhbmNoLCBwYXJlbnRDb21wb25lbnQsIHN1c3BlbnNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBpbmNyZW1lbnQgcGVuZGluZyBJRC4gdGhpcyBpcyB1c2VkIHRvIGludmFsaWRhdGUgYXN5bmMgY2FsbGJhY2tzXHJcbiAgICAgICAgICAgIC8vIHJlc2V0IHN1c3BlbnNlIHN0YXRlXHJcbiAgICAgICAgICAgIHN1c3BlbnNlLmRlcHMgPSAwO1xyXG4gICAgICAgICAgICAvLyBkaXNjYXJkIGVmZmVjdHMgZnJvbSBwZW5kaW5nIGJyYW5jaFxyXG4gICAgICAgICAgICBzdXNwZW5zZS5lZmZlY3RzLmxlbmd0aCA9IDA7XHJcbiAgICAgICAgICAgIC8vIGRpc2NhcmQgcHJldmlvdXMgY29udGFpbmVyXHJcbiAgICAgICAgICAgIHN1c3BlbnNlLmhpZGRlbkNvbnRhaW5lciA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgICBpZiAoaXNJbkZhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBhbHJlYWR5IGluIGZhbGxiYWNrIHN0YXRlXHJcbiAgICAgICAgICAgICAgICBwYXRjaChudWxsLCBuZXdCcmFuY2gsIHN1c3BlbnNlLmhpZGRlbkNvbnRhaW5lciwgbnVsbCwgcGFyZW50Q29tcG9uZW50LCBzdXNwZW5zZSwgaXNTVkcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKTtcclxuICAgICAgICAgICAgICAgIGlmIChzdXNwZW5zZS5kZXBzIDw9IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBzdXNwZW5zZS5yZXNvbHZlKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBwYXRjaChhY3RpdmVCcmFuY2gsIG5ld0ZhbGxiYWNrLCBjb250YWluZXIsIGFuY2hvciwgcGFyZW50Q29tcG9uZW50LCBudWxsLCAvLyBmYWxsYmFjayB0cmVlIHdpbGwgbm90IGhhdmUgc3VzcGVuc2UgY29udGV4dFxyXG4gICAgICAgICAgICAgICAgICAgIGlzU1ZHLCBzbG90U2NvcGVJZHMsIG9wdGltaXplZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0QWN0aXZlQnJhbmNoKHN1c3BlbnNlLCBuZXdGYWxsYmFjayk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoYWN0aXZlQnJhbmNoICYmIGlzU2FtZVZOb2RlVHlwZShuZXdCcmFuY2gsIGFjdGl2ZUJyYW5jaCkpIHtcclxuICAgICAgICAgICAgICAgIC8vIHRvZ2dsZWQgXCJiYWNrXCIgdG8gY3VycmVudCBhY3RpdmUgYnJhbmNoXHJcbiAgICAgICAgICAgICAgICBwYXRjaChhY3RpdmVCcmFuY2gsIG5ld0JyYW5jaCwgY29udGFpbmVyLCBhbmNob3IsIHBhcmVudENvbXBvbmVudCwgc3VzcGVuc2UsIGlzU1ZHLCBzbG90U2NvcGVJZHMsIG9wdGltaXplZCk7XHJcbiAgICAgICAgICAgICAgICAvLyBmb3JjZSByZXNvbHZlXHJcbiAgICAgICAgICAgICAgICBzdXNwZW5zZS5yZXNvbHZlKHRydWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gc3dpdGNoZWQgdG8gYSAzcmQgYnJhbmNoXHJcbiAgICAgICAgICAgICAgICBwYXRjaChudWxsLCBuZXdCcmFuY2gsIHN1c3BlbnNlLmhpZGRlbkNvbnRhaW5lciwgbnVsbCwgcGFyZW50Q29tcG9uZW50LCBzdXNwZW5zZSwgaXNTVkcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKTtcclxuICAgICAgICAgICAgICAgIGlmIChzdXNwZW5zZS5kZXBzIDw9IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBzdXNwZW5zZS5yZXNvbHZlKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBpZiAoYWN0aXZlQnJhbmNoICYmIGlzU2FtZVZOb2RlVHlwZShuZXdCcmFuY2gsIGFjdGl2ZUJyYW5jaCkpIHtcclxuICAgICAgICAgICAgLy8gcm9vdCBkaWQgbm90IGNoYW5nZSwganVzdCBub3JtYWwgcGF0Y2hcclxuICAgICAgICAgICAgcGF0Y2goYWN0aXZlQnJhbmNoLCBuZXdCcmFuY2gsIGNvbnRhaW5lciwgYW5jaG9yLCBwYXJlbnRDb21wb25lbnQsIHN1c3BlbnNlLCBpc1NWRywgc2xvdFNjb3BlSWRzLCBvcHRpbWl6ZWQpO1xyXG4gICAgICAgICAgICBzZXRBY3RpdmVCcmFuY2goc3VzcGVuc2UsIG5ld0JyYW5jaCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyByb290IG5vZGUgdG9nZ2xlZFxyXG4gICAgICAgICAgICAvLyBpbnZva2UgQHBlbmRpbmcgZXZlbnRcclxuICAgICAgICAgICAgdHJpZ2dlckV2ZW50KG4yLCAnb25QZW5kaW5nJyk7XHJcbiAgICAgICAgICAgIC8vIG1vdW50IHBlbmRpbmcgYnJhbmNoIGluIG9mZi1kb20gY29udGFpbmVyXHJcbiAgICAgICAgICAgIHN1c3BlbnNlLnBlbmRpbmdCcmFuY2ggPSBuZXdCcmFuY2g7XHJcbiAgICAgICAgICAgIHN1c3BlbnNlLnBlbmRpbmdJZCsrO1xyXG4gICAgICAgICAgICBwYXRjaChudWxsLCBuZXdCcmFuY2gsIHN1c3BlbnNlLmhpZGRlbkNvbnRhaW5lciwgbnVsbCwgcGFyZW50Q29tcG9uZW50LCBzdXNwZW5zZSwgaXNTVkcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKTtcclxuICAgICAgICAgICAgaWYgKHN1c3BlbnNlLmRlcHMgPD0gMCkge1xyXG4gICAgICAgICAgICAgICAgLy8gaW5jb21pbmcgYnJhbmNoIGhhcyBubyBhc3luYyBkZXBzLCByZXNvbHZlIG5vdy5cclxuICAgICAgICAgICAgICAgIHN1c3BlbnNlLnJlc29sdmUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHsgdGltZW91dCwgcGVuZGluZ0lkIH0gPSBzdXNwZW5zZTtcclxuICAgICAgICAgICAgICAgIGlmICh0aW1lb3V0ID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3VzcGVuc2UucGVuZGluZ0lkID09PSBwZW5kaW5nSWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1c3BlbnNlLmZhbGxiYWNrKG5ld0ZhbGxiYWNrKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sIHRpbWVvdXQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodGltZW91dCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHN1c3BlbnNlLmZhbGxiYWNrKG5ld0ZhbGxiYWNrKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5sZXQgaGFzV2FybmVkID0gZmFsc2U7XHJcbmZ1bmN0aW9uIGNyZWF0ZVN1c3BlbnNlQm91bmRhcnkodm5vZGUsIHBhcmVudCwgcGFyZW50Q29tcG9uZW50LCBjb250YWluZXIsIGhpZGRlbkNvbnRhaW5lciwgYW5jaG9yLCBpc1NWRywgc2xvdFNjb3BlSWRzLCBvcHRpbWl6ZWQsIHJlbmRlcmVySW50ZXJuYWxzLCBpc0h5ZHJhdGluZyA9IGZhbHNlKSB7XHJcbiAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgaWYgKi9cclxuICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiYgIWZhbHNlICYmICFoYXNXYXJuZWQpIHtcclxuICAgICAgICBoYXNXYXJuZWQgPSB0cnVlO1xyXG4gICAgICAgIC8vIEB0cy1pZ25vcmUgYGNvbnNvbGUuaW5mb2AgY2Fubm90IGJlIG51bGwgZXJyb3JcclxuICAgICAgICBjb25zb2xlW2NvbnNvbGUuaW5mbyA/ICdpbmZvJyA6ICdsb2cnXShgPFN1c3BlbnNlPiBpcyBhbiBleHBlcmltZW50YWwgZmVhdHVyZSBhbmQgaXRzIEFQSSB3aWxsIGxpa2VseSBjaGFuZ2UuYCk7XHJcbiAgICB9XHJcbiAgICBjb25zdCB7IHA6IHBhdGNoLCBtOiBtb3ZlLCB1bTogdW5tb3VudCwgbjogbmV4dCwgbzogeyBwYXJlbnROb2RlLCByZW1vdmUgfSB9ID0gcmVuZGVyZXJJbnRlcm5hbHM7XHJcbiAgICBjb25zdCB0aW1lb3V0ID0gdG9OdW1iZXIodm5vZGUucHJvcHMgJiYgdm5vZGUucHJvcHMudGltZW91dCk7XHJcbiAgICBjb25zdCBzdXNwZW5zZSA9IHtcclxuICAgICAgICB2bm9kZSxcclxuICAgICAgICBwYXJlbnQsXHJcbiAgICAgICAgcGFyZW50Q29tcG9uZW50LFxyXG4gICAgICAgIGlzU1ZHLFxyXG4gICAgICAgIGNvbnRhaW5lcixcclxuICAgICAgICBoaWRkZW5Db250YWluZXIsXHJcbiAgICAgICAgYW5jaG9yLFxyXG4gICAgICAgIGRlcHM6IDAsXHJcbiAgICAgICAgcGVuZGluZ0lkOiAwLFxyXG4gICAgICAgIHRpbWVvdXQ6IHR5cGVvZiB0aW1lb3V0ID09PSAnbnVtYmVyJyA/IHRpbWVvdXQgOiAtMSxcclxuICAgICAgICBhY3RpdmVCcmFuY2g6IG51bGwsXHJcbiAgICAgICAgcGVuZGluZ0JyYW5jaDogbnVsbCxcclxuICAgICAgICBpc0luRmFsbGJhY2s6IHRydWUsXHJcbiAgICAgICAgaXNIeWRyYXRpbmcsXHJcbiAgICAgICAgaXNVbm1vdW50ZWQ6IGZhbHNlLFxyXG4gICAgICAgIGVmZmVjdHM6IFtdLFxyXG4gICAgICAgIHJlc29sdmUocmVzdW1lID0gZmFsc2UpIHtcclxuICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFyZXN1bWUgJiYgIXN1c3BlbnNlLnBlbmRpbmdCcmFuY2gpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYHN1c3BlbnNlLnJlc29sdmUoKSBpcyBjYWxsZWQgd2l0aG91dCBhIHBlbmRpbmcgYnJhbmNoLmApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHN1c3BlbnNlLmlzVW5tb3VudGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBzdXNwZW5zZS5yZXNvbHZlKCkgaXMgY2FsbGVkIG9uIGFuIGFscmVhZHkgdW5tb3VudGVkIHN1c3BlbnNlIGJvdW5kYXJ5LmApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IHsgdm5vZGUsIGFjdGl2ZUJyYW5jaCwgcGVuZGluZ0JyYW5jaCwgcGVuZGluZ0lkLCBlZmZlY3RzLCBwYXJlbnRDb21wb25lbnQsIGNvbnRhaW5lciB9ID0gc3VzcGVuc2U7XHJcbiAgICAgICAgICAgIGlmIChzdXNwZW5zZS5pc0h5ZHJhdGluZykge1xyXG4gICAgICAgICAgICAgICAgc3VzcGVuc2UuaXNIeWRyYXRpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmICghcmVzdW1lKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBkZWxheUVudGVyID0gYWN0aXZlQnJhbmNoICYmXHJcbiAgICAgICAgICAgICAgICAgICAgcGVuZGluZ0JyYW5jaC50cmFuc2l0aW9uICYmXHJcbiAgICAgICAgICAgICAgICAgICAgcGVuZGluZ0JyYW5jaC50cmFuc2l0aW9uLm1vZGUgPT09ICdvdXQtaW4nO1xyXG4gICAgICAgICAgICAgICAgaWYgKGRlbGF5RW50ZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICBhY3RpdmVCcmFuY2gudHJhbnNpdGlvbi5hZnRlckxlYXZlID0gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocGVuZGluZ0lkID09PSBzdXNwZW5zZS5wZW5kaW5nSWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vdmUocGVuZGluZ0JyYW5jaCwgY29udGFpbmVyLCBhbmNob3IsIDAgLyogRU5URVIgKi8pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIHRoaXMgaXMgaW5pdGlhbCBhbmNob3Igb24gbW91bnRcclxuICAgICAgICAgICAgICAgIGxldCB7IGFuY2hvciB9ID0gc3VzcGVuc2U7XHJcbiAgICAgICAgICAgICAgICAvLyB1bm1vdW50IGN1cnJlbnQgYWN0aXZlIHRyZWVcclxuICAgICAgICAgICAgICAgIGlmIChhY3RpdmVCcmFuY2gpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBpZiB0aGUgZmFsbGJhY2sgdHJlZSB3YXMgbW91bnRlZCwgaXQgbWF5IGhhdmUgYmVlbiBtb3ZlZFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGFzIHBhcnQgb2YgYSBwYXJlbnQgc3VzcGVuc2UuIGdldCB0aGUgbGF0ZXN0IGFuY2hvciBmb3IgaW5zZXJ0aW9uXHJcbiAgICAgICAgICAgICAgICAgICAgYW5jaG9yID0gbmV4dChhY3RpdmVCcmFuY2gpO1xyXG4gICAgICAgICAgICAgICAgICAgIHVubW91bnQoYWN0aXZlQnJhbmNoLCBwYXJlbnRDb21wb25lbnQsIHN1c3BlbnNlLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICghZGVsYXlFbnRlcikge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIG1vdmUgY29udGVudCBmcm9tIG9mZi1kb20gY29udGFpbmVyIHRvIGFjdHVhbCBjb250YWluZXJcclxuICAgICAgICAgICAgICAgICAgICBtb3ZlKHBlbmRpbmdCcmFuY2gsIGNvbnRhaW5lciwgYW5jaG9yLCAwIC8qIEVOVEVSICovKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzZXRBY3RpdmVCcmFuY2goc3VzcGVuc2UsIHBlbmRpbmdCcmFuY2gpO1xyXG4gICAgICAgICAgICBzdXNwZW5zZS5wZW5kaW5nQnJhbmNoID0gbnVsbDtcclxuICAgICAgICAgICAgc3VzcGVuc2UuaXNJbkZhbGxiYWNrID0gZmFsc2U7XHJcbiAgICAgICAgICAgIC8vIGZsdXNoIGJ1ZmZlcmVkIGVmZmVjdHNcclxuICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlcmUgaXMgYSBwZW5kaW5nIHBhcmVudCBzdXNwZW5zZVxyXG4gICAgICAgICAgICBsZXQgcGFyZW50ID0gc3VzcGVuc2UucGFyZW50O1xyXG4gICAgICAgICAgICBsZXQgaGFzVW5yZXNvbHZlZEFuY2VzdG9yID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHdoaWxlIChwYXJlbnQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChwYXJlbnQucGVuZGluZ0JyYW5jaCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGZvdW5kIGEgcGVuZGluZyBwYXJlbnQgc3VzcGVuc2UsIG1lcmdlIGJ1ZmZlcmVkIHBvc3Qgam9ic1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGludG8gdGhhdCBwYXJlbnRcclxuICAgICAgICAgICAgICAgICAgICBwYXJlbnQuZWZmZWN0cy5wdXNoKC4uLmVmZmVjdHMpO1xyXG4gICAgICAgICAgICAgICAgICAgIGhhc1VucmVzb2x2ZWRBbmNlc3RvciA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBwYXJlbnQgPSBwYXJlbnQucGFyZW50O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIG5vIHBlbmRpbmcgcGFyZW50IHN1c3BlbnNlLCBmbHVzaCBhbGwgam9ic1xyXG4gICAgICAgICAgICBpZiAoIWhhc1VucmVzb2x2ZWRBbmNlc3Rvcikge1xyXG4gICAgICAgICAgICAgICAgcXVldWVQb3N0Rmx1c2hDYihlZmZlY3RzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzdXNwZW5zZS5lZmZlY3RzID0gW107XHJcbiAgICAgICAgICAgIC8vIGludm9rZSBAcmVzb2x2ZSBldmVudFxyXG4gICAgICAgICAgICB0cmlnZ2VyRXZlbnQodm5vZGUsICdvblJlc29sdmUnKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGZhbGxiYWNrKGZhbGxiYWNrVk5vZGUpIHtcclxuICAgICAgICAgICAgaWYgKCFzdXNwZW5zZS5wZW5kaW5nQnJhbmNoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgeyB2bm9kZSwgYWN0aXZlQnJhbmNoLCBwYXJlbnRDb21wb25lbnQsIGNvbnRhaW5lciwgaXNTVkcgfSA9IHN1c3BlbnNlO1xyXG4gICAgICAgICAgICAvLyBpbnZva2UgQGZhbGxiYWNrIGV2ZW50XHJcbiAgICAgICAgICAgIHRyaWdnZXJFdmVudCh2bm9kZSwgJ29uRmFsbGJhY2snKTtcclxuICAgICAgICAgICAgY29uc3QgYW5jaG9yID0gbmV4dChhY3RpdmVCcmFuY2gpO1xyXG4gICAgICAgICAgICBjb25zdCBtb3VudEZhbGxiYWNrID0gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFzdXNwZW5zZS5pc0luRmFsbGJhY2spIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyBtb3VudCB0aGUgZmFsbGJhY2sgdHJlZVxyXG4gICAgICAgICAgICAgICAgcGF0Y2gobnVsbCwgZmFsbGJhY2tWTm9kZSwgY29udGFpbmVyLCBhbmNob3IsIHBhcmVudENvbXBvbmVudCwgbnVsbCwgLy8gZmFsbGJhY2sgdHJlZSB3aWxsIG5vdCBoYXZlIHN1c3BlbnNlIGNvbnRleHRcclxuICAgICAgICAgICAgICAgIGlzU1ZHLCBzbG90U2NvcGVJZHMsIG9wdGltaXplZCk7XHJcbiAgICAgICAgICAgICAgICBzZXRBY3RpdmVCcmFuY2goc3VzcGVuc2UsIGZhbGxiYWNrVk5vZGUpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBjb25zdCBkZWxheUVudGVyID0gZmFsbGJhY2tWTm9kZS50cmFuc2l0aW9uICYmIGZhbGxiYWNrVk5vZGUudHJhbnNpdGlvbi5tb2RlID09PSAnb3V0LWluJztcclxuICAgICAgICAgICAgaWYgKGRlbGF5RW50ZXIpIHtcclxuICAgICAgICAgICAgICAgIGFjdGl2ZUJyYW5jaC50cmFuc2l0aW9uLmFmdGVyTGVhdmUgPSBtb3VudEZhbGxiYWNrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHN1c3BlbnNlLmlzSW5GYWxsYmFjayA9IHRydWU7XHJcbiAgICAgICAgICAgIC8vIHVubW91bnQgY3VycmVudCBhY3RpdmUgYnJhbmNoXHJcbiAgICAgICAgICAgIHVubW91bnQoYWN0aXZlQnJhbmNoLCBwYXJlbnRDb21wb25lbnQsIG51bGwsIC8vIG5vIHN1c3BlbnNlIHNvIHVubW91bnQgaG9va3MgZmlyZSBub3dcclxuICAgICAgICAgICAgdHJ1ZSAvLyBzaG91bGRSZW1vdmVcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgaWYgKCFkZWxheUVudGVyKSB7XHJcbiAgICAgICAgICAgICAgICBtb3VudEZhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIG1vdmUoY29udGFpbmVyLCBhbmNob3IsIHR5cGUpIHtcclxuICAgICAgICAgICAgc3VzcGVuc2UuYWN0aXZlQnJhbmNoICYmXHJcbiAgICAgICAgICAgICAgICBtb3ZlKHN1c3BlbnNlLmFjdGl2ZUJyYW5jaCwgY29udGFpbmVyLCBhbmNob3IsIHR5cGUpO1xyXG4gICAgICAgICAgICBzdXNwZW5zZS5jb250YWluZXIgPSBjb250YWluZXI7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBuZXh0KCkge1xyXG4gICAgICAgICAgICByZXR1cm4gc3VzcGVuc2UuYWN0aXZlQnJhbmNoICYmIG5leHQoc3VzcGVuc2UuYWN0aXZlQnJhbmNoKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHJlZ2lzdGVyRGVwKGluc3RhbmNlLCBzZXR1cFJlbmRlckVmZmVjdCkge1xyXG4gICAgICAgICAgICBjb25zdCBpc0luUGVuZGluZ1N1c3BlbnNlID0gISFzdXNwZW5zZS5wZW5kaW5nQnJhbmNoO1xyXG4gICAgICAgICAgICBpZiAoaXNJblBlbmRpbmdTdXNwZW5zZSkge1xyXG4gICAgICAgICAgICAgICAgc3VzcGVuc2UuZGVwcysrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IGh5ZHJhdGVkRWwgPSBpbnN0YW5jZS52bm9kZS5lbDtcclxuICAgICAgICAgICAgaW5zdGFuY2VcclxuICAgICAgICAgICAgICAgIC5hc3luY0RlcC5jYXRjaChlcnIgPT4ge1xyXG4gICAgICAgICAgICAgICAgaGFuZGxlRXJyb3IoZXJyLCBpbnN0YW5jZSwgMCAvKiBTRVRVUF9GVU5DVElPTiAqLyk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAudGhlbihhc3luY1NldHVwUmVzdWx0ID0+IHtcclxuICAgICAgICAgICAgICAgIC8vIHJldHJ5IHdoZW4gdGhlIHNldHVwKCkgcHJvbWlzZSByZXNvbHZlcy5cclxuICAgICAgICAgICAgICAgIC8vIGNvbXBvbmVudCBtYXkgaGF2ZSBiZWVuIHVubW91bnRlZCBiZWZvcmUgcmVzb2x2ZS5cclxuICAgICAgICAgICAgICAgIGlmIChpbnN0YW5jZS5pc1VubW91bnRlZCB8fFxyXG4gICAgICAgICAgICAgICAgICAgIHN1c3BlbnNlLmlzVW5tb3VudGVkIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgc3VzcGVuc2UucGVuZGluZ0lkICE9PSBpbnN0YW5jZS5zdXNwZW5zZUlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gcmV0cnkgZnJvbSB0aGlzIGNvbXBvbmVudFxyXG4gICAgICAgICAgICAgICAgaW5zdGFuY2UuYXN5bmNSZXNvbHZlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB7IHZub2RlIH0gPSBpbnN0YW5jZTtcclxuICAgICAgICAgICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgICAgICBwdXNoV2FybmluZ0NvbnRleHQodm5vZGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaGFuZGxlU2V0dXBSZXN1bHQoaW5zdGFuY2UsIGFzeW5jU2V0dXBSZXN1bHQsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIGlmIChoeWRyYXRlZEVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gdm5vZGUgbWF5IGhhdmUgYmVlbiByZXBsYWNlZCBpZiBhbiB1cGRhdGUgaGFwcGVuZWQgYmVmb3JlIHRoZVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGFzeW5jIGRlcCBpcyByZXNvbHZlZC5cclxuICAgICAgICAgICAgICAgICAgICB2bm9kZS5lbCA9IGh5ZHJhdGVkRWw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBwbGFjZWhvbGRlciA9ICFoeWRyYXRlZEVsICYmIGluc3RhbmNlLnN1YlRyZWUuZWw7XHJcbiAgICAgICAgICAgICAgICBzZXR1cFJlbmRlckVmZmVjdChpbnN0YW5jZSwgdm5vZGUsIFxyXG4gICAgICAgICAgICAgICAgLy8gY29tcG9uZW50IG1heSBoYXZlIGJlZW4gbW92ZWQgYmVmb3JlIHJlc29sdmUuXHJcbiAgICAgICAgICAgICAgICAvLyBpZiB0aGlzIGlzIG5vdCBhIGh5ZHJhdGlvbiwgaW5zdGFuY2Uuc3ViVHJlZSB3aWxsIGJlIHRoZSBjb21tZW50XHJcbiAgICAgICAgICAgICAgICAvLyBwbGFjZWhvbGRlci5cclxuICAgICAgICAgICAgICAgIHBhcmVudE5vZGUoaHlkcmF0ZWRFbCB8fCBpbnN0YW5jZS5zdWJUcmVlLmVsKSwgXHJcbiAgICAgICAgICAgICAgICAvLyBhbmNob3Igd2lsbCBub3QgYmUgdXNlZCBpZiB0aGlzIGlzIGh5ZHJhdGlvbiwgc28gb25seSBuZWVkIHRvXHJcbiAgICAgICAgICAgICAgICAvLyBjb25zaWRlciB0aGUgY29tbWVudCBwbGFjZWhvbGRlciBjYXNlLlxyXG4gICAgICAgICAgICAgICAgaHlkcmF0ZWRFbCA/IG51bGwgOiBuZXh0KGluc3RhbmNlLnN1YlRyZWUpLCBzdXNwZW5zZSwgaXNTVkcsIG9wdGltaXplZCk7XHJcbiAgICAgICAgICAgICAgICBpZiAocGxhY2Vob2xkZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZW1vdmUocGxhY2Vob2xkZXIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdXBkYXRlSE9DSG9zdEVsKGluc3RhbmNlLCB2bm9kZS5lbCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcG9wV2FybmluZ0NvbnRleHQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIG9ubHkgZGVjcmVhc2UgZGVwcyBjb3VudCBpZiBzdXNwZW5zZSBpcyBub3QgYWxyZWFkeSByZXNvbHZlZFxyXG4gICAgICAgICAgICAgICAgaWYgKGlzSW5QZW5kaW5nU3VzcGVuc2UgJiYgLS1zdXNwZW5zZS5kZXBzID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3VzcGVuc2UucmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHVubW91bnQocGFyZW50U3VzcGVuc2UsIGRvUmVtb3ZlKSB7XHJcbiAgICAgICAgICAgIHN1c3BlbnNlLmlzVW5tb3VudGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgaWYgKHN1c3BlbnNlLmFjdGl2ZUJyYW5jaCkge1xyXG4gICAgICAgICAgICAgICAgdW5tb3VudChzdXNwZW5zZS5hY3RpdmVCcmFuY2gsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIGRvUmVtb3ZlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoc3VzcGVuc2UucGVuZGluZ0JyYW5jaCkge1xyXG4gICAgICAgICAgICAgICAgdW5tb3VudChzdXNwZW5zZS5wZW5kaW5nQnJhbmNoLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCBkb1JlbW92ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIHN1c3BlbnNlO1xyXG59XHJcbmZ1bmN0aW9uIGh5ZHJhdGVTdXNwZW5zZShub2RlLCB2bm9kZSwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkLCByZW5kZXJlckludGVybmFscywgaHlkcmF0ZU5vZGUpIHtcclxuICAgIC8qIGVzbGludC1kaXNhYmxlIG5vLXJlc3RyaWN0ZWQtZ2xvYmFscyAqL1xyXG4gICAgY29uc3Qgc3VzcGVuc2UgPSAodm5vZGUuc3VzcGVuc2UgPSBjcmVhdGVTdXNwZW5zZUJvdW5kYXJ5KHZub2RlLCBwYXJlbnRTdXNwZW5zZSwgcGFyZW50Q29tcG9uZW50LCBub2RlLnBhcmVudE5vZGUsIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpLCBudWxsLCBpc1NWRywgc2xvdFNjb3BlSWRzLCBvcHRpbWl6ZWQsIHJlbmRlcmVySW50ZXJuYWxzLCB0cnVlIC8qIGh5ZHJhdGluZyAqLykpO1xyXG4gICAgLy8gdGhlcmUgYXJlIHR3byBwb3NzaWJsZSBzY2VuYXJpb3MgZm9yIHNlcnZlci1yZW5kZXJlZCBzdXNwZW5zZTpcclxuICAgIC8vIC0gc3VjY2Vzczogc3NyIGNvbnRlbnQgc2hvdWxkIGJlIGZ1bGx5IHJlc29sdmVkXHJcbiAgICAvLyAtIGZhaWx1cmU6IHNzciBjb250ZW50IHNob3VsZCBiZSB0aGUgZmFsbGJhY2sgYnJhbmNoLlxyXG4gICAgLy8gaG93ZXZlciwgb24gdGhlIGNsaWVudCB3ZSBkb24ndCByZWFsbHkga25vdyBpZiBpdCBoYXMgZmFpbGVkIG9yIG5vdFxyXG4gICAgLy8gYXR0ZW1wdCB0byBoeWRyYXRlIHRoZSBET00gYXNzdW1pbmcgaXQgaGFzIHN1Y2NlZWRlZCwgYnV0IHdlIHN0aWxsXHJcbiAgICAvLyBuZWVkIHRvIGNvbnN0cnVjdCBhIHN1c3BlbnNlIGJvdW5kYXJ5IGZpcnN0XHJcbiAgICBjb25zdCByZXN1bHQgPSBoeWRyYXRlTm9kZShub2RlLCAoc3VzcGVuc2UucGVuZGluZ0JyYW5jaCA9IHZub2RlLnNzQ29udGVudCksIHBhcmVudENvbXBvbmVudCwgc3VzcGVuc2UsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKTtcclxuICAgIGlmIChzdXNwZW5zZS5kZXBzID09PSAwKSB7XHJcbiAgICAgICAgc3VzcGVuc2UucmVzb2x2ZSgpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIC8qIGVzbGludC1lbmFibGUgbm8tcmVzdHJpY3RlZC1nbG9iYWxzICovXHJcbn1cclxuZnVuY3Rpb24gbm9ybWFsaXplU3VzcGVuc2VDaGlsZHJlbih2bm9kZSkge1xyXG4gICAgY29uc3QgeyBzaGFwZUZsYWcsIGNoaWxkcmVuIH0gPSB2bm9kZTtcclxuICAgIGNvbnN0IGlzU2xvdENoaWxkcmVuID0gc2hhcGVGbGFnICYgMzIgLyogU0xPVFNfQ0hJTERSRU4gKi87XHJcbiAgICB2bm9kZS5zc0NvbnRlbnQgPSBub3JtYWxpemVTdXNwZW5zZVNsb3QoaXNTbG90Q2hpbGRyZW4gPyBjaGlsZHJlbi5kZWZhdWx0IDogY2hpbGRyZW4pO1xyXG4gICAgdm5vZGUuc3NGYWxsYmFjayA9IGlzU2xvdENoaWxkcmVuXHJcbiAgICAgICAgPyBub3JtYWxpemVTdXNwZW5zZVNsb3QoY2hpbGRyZW4uZmFsbGJhY2spXHJcbiAgICAgICAgOiBjcmVhdGVWTm9kZShDb21tZW50KTtcclxufVxyXG5mdW5jdGlvbiBub3JtYWxpemVTdXNwZW5zZVNsb3Qocykge1xyXG4gICAgbGV0IGJsb2NrO1xyXG4gICAgaWYgKGlzRnVuY3Rpb24ocykpIHtcclxuICAgICAgICBjb25zdCB0cmFja0Jsb2NrID0gaXNCbG9ja1RyZWVFbmFibGVkICYmIHMuX2M7XHJcbiAgICAgICAgaWYgKHRyYWNrQmxvY2spIHtcclxuICAgICAgICAgICAgLy8gZGlzYWJsZVRyYWNraW5nOiBmYWxzZVxyXG4gICAgICAgICAgICAvLyBhbGxvdyBibG9jayB0cmFja2luZyBmb3IgY29tcGlsZWQgc2xvdHNcclxuICAgICAgICAgICAgLy8gKHNlZSAuL2NvbXBvbmVudFJlbmRlckNvbnRleHQudHMpXHJcbiAgICAgICAgICAgIHMuX2QgPSBmYWxzZTtcclxuICAgICAgICAgICAgb3BlbkJsb2NrKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHMgPSBzKCk7XHJcbiAgICAgICAgaWYgKHRyYWNrQmxvY2spIHtcclxuICAgICAgICAgICAgcy5fZCA9IHRydWU7XHJcbiAgICAgICAgICAgIGJsb2NrID0gY3VycmVudEJsb2NrO1xyXG4gICAgICAgICAgICBjbG9zZUJsb2NrKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYgKGlzQXJyYXkocykpIHtcclxuICAgICAgICBjb25zdCBzaW5nbGVDaGlsZCA9IGZpbHRlclNpbmdsZVJvb3Qocyk7XHJcbiAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiAhc2luZ2xlQ2hpbGQpIHtcclxuICAgICAgICAgICAgd2FybihgPFN1c3BlbnNlPiBzbG90cyBleHBlY3QgYSBzaW5nbGUgcm9vdCBub2RlLmApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBzID0gc2luZ2xlQ2hpbGQ7XHJcbiAgICB9XHJcbiAgICBzID0gbm9ybWFsaXplVk5vZGUocyk7XHJcbiAgICBpZiAoYmxvY2sgJiYgIXMuZHluYW1pY0NoaWxkcmVuKSB7XHJcbiAgICAgICAgcy5keW5hbWljQ2hpbGRyZW4gPSBibG9jay5maWx0ZXIoYyA9PiBjICE9PSBzKTtcclxuICAgIH1cclxuICAgIHJldHVybiBzO1xyXG59XHJcbmZ1bmN0aW9uIHF1ZXVlRWZmZWN0V2l0aFN1c3BlbnNlKGZuLCBzdXNwZW5zZSkge1xyXG4gICAgaWYgKHN1c3BlbnNlICYmIHN1c3BlbnNlLnBlbmRpbmdCcmFuY2gpIHtcclxuICAgICAgICBpZiAoaXNBcnJheShmbikpIHtcclxuICAgICAgICAgICAgc3VzcGVuc2UuZWZmZWN0cy5wdXNoKC4uLmZuKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHN1c3BlbnNlLmVmZmVjdHMucHVzaChmbik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgcXVldWVQb3N0Rmx1c2hDYihmbik7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gc2V0QWN0aXZlQnJhbmNoKHN1c3BlbnNlLCBicmFuY2gpIHtcclxuICAgIHN1c3BlbnNlLmFjdGl2ZUJyYW5jaCA9IGJyYW5jaDtcclxuICAgIGNvbnN0IHsgdm5vZGUsIHBhcmVudENvbXBvbmVudCB9ID0gc3VzcGVuc2U7XHJcbiAgICBjb25zdCBlbCA9ICh2bm9kZS5lbCA9IGJyYW5jaC5lbCk7XHJcbiAgICAvLyBpbiBjYXNlIHN1c3BlbnNlIGlzIHRoZSByb290IG5vZGUgb2YgYSBjb21wb25lbnQsXHJcbiAgICAvLyByZWN1cnNpdmVseSB1cGRhdGUgdGhlIEhPQyBlbFxyXG4gICAgaWYgKHBhcmVudENvbXBvbmVudCAmJiBwYXJlbnRDb21wb25lbnQuc3ViVHJlZSA9PT0gdm5vZGUpIHtcclxuICAgICAgICBwYXJlbnRDb21wb25lbnQudm5vZGUuZWwgPSBlbDtcclxuICAgICAgICB1cGRhdGVIT0NIb3N0RWwocGFyZW50Q29tcG9uZW50LCBlbCk7XHJcbiAgICB9XHJcbn1cblxuZnVuY3Rpb24gcHJvdmlkZShrZXksIHZhbHVlKSB7XHJcbiAgICBpZiAoIWN1cnJlbnRJbnN0YW5jZSkge1xyXG4gICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgd2FybihgcHJvdmlkZSgpIGNhbiBvbmx5IGJlIHVzZWQgaW5zaWRlIHNldHVwKCkuYCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgbGV0IHByb3ZpZGVzID0gY3VycmVudEluc3RhbmNlLnByb3ZpZGVzO1xyXG4gICAgICAgIC8vIGJ5IGRlZmF1bHQgYW4gaW5zdGFuY2UgaW5oZXJpdHMgaXRzIHBhcmVudCdzIHByb3ZpZGVzIG9iamVjdFxyXG4gICAgICAgIC8vIGJ1dCB3aGVuIGl0IG5lZWRzIHRvIHByb3ZpZGUgdmFsdWVzIG9mIGl0cyBvd24sIGl0IGNyZWF0ZXMgaXRzXHJcbiAgICAgICAgLy8gb3duIHByb3ZpZGVzIG9iamVjdCB1c2luZyBwYXJlbnQgcHJvdmlkZXMgb2JqZWN0IGFzIHByb3RvdHlwZS5cclxuICAgICAgICAvLyB0aGlzIHdheSBpbiBgaW5qZWN0YCB3ZSBjYW4gc2ltcGx5IGxvb2sgdXAgaW5qZWN0aW9ucyBmcm9tIGRpcmVjdFxyXG4gICAgICAgIC8vIHBhcmVudCBhbmQgbGV0IHRoZSBwcm90b3R5cGUgY2hhaW4gZG8gdGhlIHdvcmsuXHJcbiAgICAgICAgY29uc3QgcGFyZW50UHJvdmlkZXMgPSBjdXJyZW50SW5zdGFuY2UucGFyZW50ICYmIGN1cnJlbnRJbnN0YW5jZS5wYXJlbnQucHJvdmlkZXM7XHJcbiAgICAgICAgaWYgKHBhcmVudFByb3ZpZGVzID09PSBwcm92aWRlcykge1xyXG4gICAgICAgICAgICBwcm92aWRlcyA9IGN1cnJlbnRJbnN0YW5jZS5wcm92aWRlcyA9IE9iamVjdC5jcmVhdGUocGFyZW50UHJvdmlkZXMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBUUyBkb2Vzbid0IGFsbG93IHN5bWJvbCBhcyBpbmRleCB0eXBlXHJcbiAgICAgICAgcHJvdmlkZXNba2V5XSA9IHZhbHVlO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGluamVjdChrZXksIGRlZmF1bHRWYWx1ZSwgdHJlYXREZWZhdWx0QXNGYWN0b3J5ID0gZmFsc2UpIHtcclxuICAgIC8vIGZhbGxiYWNrIHRvIGBjdXJyZW50UmVuZGVyaW5nSW5zdGFuY2VgIHNvIHRoYXQgdGhpcyBjYW4gYmUgY2FsbGVkIGluXHJcbiAgICAvLyBhIGZ1bmN0aW9uYWwgY29tcG9uZW50XHJcbiAgICBjb25zdCBpbnN0YW5jZSA9IGN1cnJlbnRJbnN0YW5jZSB8fCBjdXJyZW50UmVuZGVyaW5nSW5zdGFuY2U7XHJcbiAgICBpZiAoaW5zdGFuY2UpIHtcclxuICAgICAgICAvLyAjMjQwMFxyXG4gICAgICAgIC8vIHRvIHN1cHBvcnQgYGFwcC51c2VgIHBsdWdpbnMsXHJcbiAgICAgICAgLy8gZmFsbGJhY2sgdG8gYXBwQ29udGV4dCdzIGBwcm92aWRlc2AgaWYgdGhlIGluc3RhbmNlIGlzIGF0IHJvb3RcclxuICAgICAgICBjb25zdCBwcm92aWRlcyA9IGluc3RhbmNlLnBhcmVudCA9PSBudWxsXHJcbiAgICAgICAgICAgID8gaW5zdGFuY2Uudm5vZGUuYXBwQ29udGV4dCAmJiBpbnN0YW5jZS52bm9kZS5hcHBDb250ZXh0LnByb3ZpZGVzXHJcbiAgICAgICAgICAgIDogaW5zdGFuY2UucGFyZW50LnByb3ZpZGVzO1xyXG4gICAgICAgIGlmIChwcm92aWRlcyAmJiBrZXkgaW4gcHJvdmlkZXMpIHtcclxuICAgICAgICAgICAgLy8gVFMgZG9lc24ndCBhbGxvdyBzeW1ib2wgYXMgaW5kZXggdHlwZVxyXG4gICAgICAgICAgICByZXR1cm4gcHJvdmlkZXNba2V5XTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRyZWF0RGVmYXVsdEFzRmFjdG9yeSAmJiBpc0Z1bmN0aW9uKGRlZmF1bHRWYWx1ZSlcclxuICAgICAgICAgICAgICAgID8gZGVmYXVsdFZhbHVlLmNhbGwoaW5zdGFuY2UucHJveHkpXHJcbiAgICAgICAgICAgICAgICA6IGRlZmF1bHRWYWx1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgIHdhcm4oYGluamVjdGlvbiBcIiR7U3RyaW5nKGtleSl9XCIgbm90IGZvdW5kLmApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2UgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgIHdhcm4oYGluamVjdCgpIGNhbiBvbmx5IGJlIHVzZWQgaW5zaWRlIHNldHVwKCkgb3IgZnVuY3Rpb25hbCBjb21wb25lbnRzLmApO1xyXG4gICAgfVxyXG59XG5cbi8vIFNpbXBsZSBlZmZlY3QuXHJcbmZ1bmN0aW9uIHdhdGNoRWZmZWN0KGVmZmVjdCwgb3B0aW9ucykge1xyXG4gICAgcmV0dXJuIGRvV2F0Y2goZWZmZWN0LCBudWxsLCBvcHRpb25zKTtcclxufVxyXG5mdW5jdGlvbiB3YXRjaFBvc3RFZmZlY3QoZWZmZWN0LCBvcHRpb25zKSB7XHJcbiAgICByZXR1cm4gZG9XYXRjaChlZmZlY3QsIG51bGwsICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJylcclxuICAgICAgICA/IE9iamVjdC5hc3NpZ24ob3B0aW9ucyB8fCB7fSwgeyBmbHVzaDogJ3Bvc3QnIH0pXHJcbiAgICAgICAgOiB7IGZsdXNoOiAncG9zdCcgfSkpO1xyXG59XHJcbmZ1bmN0aW9uIHdhdGNoU3luY0VmZmVjdChlZmZlY3QsIG9wdGlvbnMpIHtcclxuICAgIHJldHVybiBkb1dhdGNoKGVmZmVjdCwgbnVsbCwgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKVxyXG4gICAgICAgID8gT2JqZWN0LmFzc2lnbihvcHRpb25zIHx8IHt9LCB7IGZsdXNoOiAnc3luYycgfSlcclxuICAgICAgICA6IHsgZmx1c2g6ICdzeW5jJyB9KSk7XHJcbn1cclxuLy8gaW5pdGlhbCB2YWx1ZSBmb3Igd2F0Y2hlcnMgdG8gdHJpZ2dlciBvbiB1bmRlZmluZWQgaW5pdGlhbCB2YWx1ZXNcclxuY29uc3QgSU5JVElBTF9XQVRDSEVSX1ZBTFVFID0ge307XHJcbi8vIGltcGxlbWVudGF0aW9uXHJcbmZ1bmN0aW9uIHdhdGNoKHNvdXJjZSwgY2IsIG9wdGlvbnMpIHtcclxuICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiYgIWlzRnVuY3Rpb24oY2IpKSB7XHJcbiAgICAgICAgd2FybihgXFxgd2F0Y2goZm4sIG9wdGlvbnM/KVxcYCBzaWduYXR1cmUgaGFzIGJlZW4gbW92ZWQgdG8gYSBzZXBhcmF0ZSBBUEkuIGAgK1xyXG4gICAgICAgICAgICBgVXNlIFxcYHdhdGNoRWZmZWN0KGZuLCBvcHRpb25zPylcXGAgaW5zdGVhZC4gXFxgd2F0Y2hcXGAgbm93IG9ubHkgYCArXHJcbiAgICAgICAgICAgIGBzdXBwb3J0cyBcXGB3YXRjaChzb3VyY2UsIGNiLCBvcHRpb25zPykgc2lnbmF0dXJlLmApO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGRvV2F0Y2goc291cmNlLCBjYiwgb3B0aW9ucyk7XHJcbn1cclxuZnVuY3Rpb24gZG9XYXRjaChzb3VyY2UsIGNiLCB7IGltbWVkaWF0ZSwgZGVlcCwgZmx1c2gsIG9uVHJhY2ssIG9uVHJpZ2dlciB9ID0gRU1QVFlfT0JKKSB7XHJcbiAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmICFjYikge1xyXG4gICAgICAgIGlmIChpbW1lZGlhdGUgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICB3YXJuKGB3YXRjaCgpIFwiaW1tZWRpYXRlXCIgb3B0aW9uIGlzIG9ubHkgcmVzcGVjdGVkIHdoZW4gdXNpbmcgdGhlIGAgK1xyXG4gICAgICAgICAgICAgICAgYHdhdGNoKHNvdXJjZSwgY2FsbGJhY2ssIG9wdGlvbnM/KSBzaWduYXR1cmUuYCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChkZWVwICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgd2Fybihgd2F0Y2goKSBcImRlZXBcIiBvcHRpb24gaXMgb25seSByZXNwZWN0ZWQgd2hlbiB1c2luZyB0aGUgYCArXHJcbiAgICAgICAgICAgICAgICBgd2F0Y2goc291cmNlLCBjYWxsYmFjaywgb3B0aW9ucz8pIHNpZ25hdHVyZS5gKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBjb25zdCB3YXJuSW52YWxpZFNvdXJjZSA9IChzKSA9PiB7XHJcbiAgICAgICAgd2FybihgSW52YWxpZCB3YXRjaCBzb3VyY2U6IGAsIHMsIGBBIHdhdGNoIHNvdXJjZSBjYW4gb25seSBiZSBhIGdldHRlci9lZmZlY3QgZnVuY3Rpb24sIGEgcmVmLCBgICtcclxuICAgICAgICAgICAgYGEgcmVhY3RpdmUgb2JqZWN0LCBvciBhbiBhcnJheSBvZiB0aGVzZSB0eXBlcy5gKTtcclxuICAgIH07XHJcbiAgICBjb25zdCBpbnN0YW5jZSA9IGN1cnJlbnRJbnN0YW5jZTtcclxuICAgIGxldCBnZXR0ZXI7XHJcbiAgICBsZXQgZm9yY2VUcmlnZ2VyID0gZmFsc2U7XHJcbiAgICBsZXQgaXNNdWx0aVNvdXJjZSA9IGZhbHNlO1xyXG4gICAgaWYgKGlzUmVmKHNvdXJjZSkpIHtcclxuICAgICAgICBnZXR0ZXIgPSAoKSA9PiBzb3VyY2UudmFsdWU7XHJcbiAgICAgICAgZm9yY2VUcmlnZ2VyID0gaXNTaGFsbG93JDEoc291cmNlKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGlzUmVhY3RpdmUoc291cmNlKSkge1xyXG4gICAgICAgIGdldHRlciA9ICgpID0+IHNvdXJjZTtcclxuICAgICAgICBkZWVwID0gdHJ1ZTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGlzQXJyYXkoc291cmNlKSkge1xyXG4gICAgICAgIGlzTXVsdGlTb3VyY2UgPSB0cnVlO1xyXG4gICAgICAgIGZvcmNlVHJpZ2dlciA9IHNvdXJjZS5zb21lKGlzUmVhY3RpdmUpO1xyXG4gICAgICAgIGdldHRlciA9ICgpID0+IHNvdXJjZS5tYXAocyA9PiB7XHJcbiAgICAgICAgICAgIGlmIChpc1JlZihzKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHMudmFsdWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoaXNSZWFjdGl2ZShzKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRyYXZlcnNlKHMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGlzRnVuY3Rpb24ocykpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjYWxsV2l0aEVycm9ySGFuZGxpbmcocywgaW5zdGFuY2UsIDIgLyogV0FUQ0hfR0VUVEVSICovKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiB3YXJuSW52YWxpZFNvdXJjZShzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoaXNGdW5jdGlvbihzb3VyY2UpKSB7XHJcbiAgICAgICAgaWYgKGNiKSB7XHJcbiAgICAgICAgICAgIC8vIGdldHRlciB3aXRoIGNiXHJcbiAgICAgICAgICAgIGdldHRlciA9ICgpID0+IGNhbGxXaXRoRXJyb3JIYW5kbGluZyhzb3VyY2UsIGluc3RhbmNlLCAyIC8qIFdBVENIX0dFVFRFUiAqLyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBubyBjYiAtPiBzaW1wbGUgZWZmZWN0XHJcbiAgICAgICAgICAgIGdldHRlciA9ICgpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChpbnN0YW5jZSAmJiBpbnN0YW5jZS5pc1VubW91bnRlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChjbGVhbnVwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2xlYW51cCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNhbGxXaXRoQXN5bmNFcnJvckhhbmRsaW5nKHNvdXJjZSwgaW5zdGFuY2UsIDMgLyogV0FUQ0hfQ0FMTEJBQ0sgKi8sIFtvbkNsZWFudXBdKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBnZXR0ZXIgPSBOT09QO1xyXG4gICAgICAgIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiB3YXJuSW52YWxpZFNvdXJjZShzb3VyY2UpO1xyXG4gICAgfVxyXG4gICAgaWYgKGNiICYmIGRlZXApIHtcclxuICAgICAgICBjb25zdCBiYXNlR2V0dGVyID0gZ2V0dGVyO1xyXG4gICAgICAgIGdldHRlciA9ICgpID0+IHRyYXZlcnNlKGJhc2VHZXR0ZXIoKSk7XHJcbiAgICB9XHJcbiAgICBsZXQgY2xlYW51cDtcclxuICAgIGxldCBvbkNsZWFudXAgPSAoZm4pID0+IHtcclxuICAgICAgICBjbGVhbnVwID0gZWZmZWN0Lm9uU3RvcCA9ICgpID0+IHtcclxuICAgICAgICAgICAgY2FsbFdpdGhFcnJvckhhbmRsaW5nKGZuLCBpbnN0YW5jZSwgNCAvKiBXQVRDSF9DTEVBTlVQICovKTtcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuICAgIC8vIGluIFNTUiB0aGVyZSBpcyBubyBuZWVkIHRvIHNldHVwIGFuIGFjdHVhbCBlZmZlY3QsIGFuZCBpdCBzaG91bGQgYmUgbm9vcFxyXG4gICAgLy8gdW5sZXNzIGl0J3MgZWFnZXJcclxuICAgIGlmIChpc0luU1NSQ29tcG9uZW50U2V0dXApIHtcclxuICAgICAgICAvLyB3ZSB3aWxsIGFsc28gbm90IGNhbGwgdGhlIGludmFsaWRhdGUgY2FsbGJhY2sgKCsgcnVubmVyIGlzIG5vdCBzZXQgdXApXHJcbiAgICAgICAgb25DbGVhbnVwID0gTk9PUDtcclxuICAgICAgICBpZiAoIWNiKSB7XHJcbiAgICAgICAgICAgIGdldHRlcigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChpbW1lZGlhdGUpIHtcclxuICAgICAgICAgICAgY2FsbFdpdGhBc3luY0Vycm9ySGFuZGxpbmcoY2IsIGluc3RhbmNlLCAzIC8qIFdBVENIX0NBTExCQUNLICovLCBbXHJcbiAgICAgICAgICAgICAgICBnZXR0ZXIoKSxcclxuICAgICAgICAgICAgICAgIGlzTXVsdGlTb3VyY2UgPyBbXSA6IHVuZGVmaW5lZCxcclxuICAgICAgICAgICAgICAgIG9uQ2xlYW51cFxyXG4gICAgICAgICAgICBdKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIE5PT1A7XHJcbiAgICB9XHJcbiAgICBsZXQgb2xkVmFsdWUgPSBpc011bHRpU291cmNlID8gW10gOiBJTklUSUFMX1dBVENIRVJfVkFMVUU7XHJcbiAgICBjb25zdCBqb2IgPSAoKSA9PiB7XHJcbiAgICAgICAgaWYgKCFlZmZlY3QuYWN0aXZlKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGNiKSB7XHJcbiAgICAgICAgICAgIC8vIHdhdGNoKHNvdXJjZSwgY2IpXHJcbiAgICAgICAgICAgIGNvbnN0IG5ld1ZhbHVlID0gZWZmZWN0LnJ1bigpO1xyXG4gICAgICAgICAgICBpZiAoZGVlcCB8fFxyXG4gICAgICAgICAgICAgICAgZm9yY2VUcmlnZ2VyIHx8XHJcbiAgICAgICAgICAgICAgICAoaXNNdWx0aVNvdXJjZVxyXG4gICAgICAgICAgICAgICAgICAgID8gbmV3VmFsdWUuc29tZSgodiwgaSkgPT4gaGFzQ2hhbmdlZCh2LCBvbGRWYWx1ZVtpXSkpXHJcbiAgICAgICAgICAgICAgICAgICAgOiBoYXNDaGFuZ2VkKG5ld1ZhbHVlLCBvbGRWYWx1ZSkpIHx8XHJcbiAgICAgICAgICAgICAgICAoZmFsc2UgICkpIHtcclxuICAgICAgICAgICAgICAgIC8vIGNsZWFudXAgYmVmb3JlIHJ1bm5pbmcgY2IgYWdhaW5cclxuICAgICAgICAgICAgICAgIGlmIChjbGVhbnVwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2xlYW51cCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY2FsbFdpdGhBc3luY0Vycm9ySGFuZGxpbmcoY2IsIGluc3RhbmNlLCAzIC8qIFdBVENIX0NBTExCQUNLICovLCBbXHJcbiAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWUsXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gcGFzcyB1bmRlZmluZWQgYXMgdGhlIG9sZCB2YWx1ZSB3aGVuIGl0J3MgY2hhbmdlZCBmb3IgdGhlIGZpcnN0IHRpbWVcclxuICAgICAgICAgICAgICAgICAgICBvbGRWYWx1ZSA9PT0gSU5JVElBTF9XQVRDSEVSX1ZBTFVFID8gdW5kZWZpbmVkIDogb2xkVmFsdWUsXHJcbiAgICAgICAgICAgICAgICAgICAgb25DbGVhbnVwXHJcbiAgICAgICAgICAgICAgICBdKTtcclxuICAgICAgICAgICAgICAgIG9sZFZhbHVlID0gbmV3VmFsdWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIHdhdGNoRWZmZWN0XHJcbiAgICAgICAgICAgIGVmZmVjdC5ydW4oKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLy8gaW1wb3J0YW50OiBtYXJrIHRoZSBqb2IgYXMgYSB3YXRjaGVyIGNhbGxiYWNrIHNvIHRoYXQgc2NoZWR1bGVyIGtub3dzXHJcbiAgICAvLyBpdCBpcyBhbGxvd2VkIHRvIHNlbGYtdHJpZ2dlciAoIzE3MjcpXHJcbiAgICBqb2IuYWxsb3dSZWN1cnNlID0gISFjYjtcclxuICAgIGxldCBzY2hlZHVsZXI7XHJcbiAgICBpZiAoZmx1c2ggPT09ICdzeW5jJykge1xyXG4gICAgICAgIHNjaGVkdWxlciA9IGpvYjsgLy8gdGhlIHNjaGVkdWxlciBmdW5jdGlvbiBnZXRzIGNhbGxlZCBkaXJlY3RseVxyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoZmx1c2ggPT09ICdwb3N0Jykge1xyXG4gICAgICAgIHNjaGVkdWxlciA9ICgpID0+IHF1ZXVlUG9zdFJlbmRlckVmZmVjdChqb2IsIGluc3RhbmNlICYmIGluc3RhbmNlLnN1c3BlbnNlKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIC8vIGRlZmF1bHQ6ICdwcmUnXHJcbiAgICAgICAgc2NoZWR1bGVyID0gKCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoIWluc3RhbmNlIHx8IGluc3RhbmNlLmlzTW91bnRlZCkge1xyXG4gICAgICAgICAgICAgICAgcXVldWVQcmVGbHVzaENiKGpvYik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyB3aXRoICdwcmUnIG9wdGlvbiwgdGhlIGZpcnN0IGNhbGwgbXVzdCBoYXBwZW4gYmVmb3JlXHJcbiAgICAgICAgICAgICAgICAvLyB0aGUgY29tcG9uZW50IGlzIG1vdW50ZWQgc28gaXQgaXMgY2FsbGVkIHN5bmNocm9ub3VzbHkuXHJcbiAgICAgICAgICAgICAgICBqb2IoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbiAgICBjb25zdCBlZmZlY3QgPSBuZXcgUmVhY3RpdmVFZmZlY3QoZ2V0dGVyLCBzY2hlZHVsZXIpO1xyXG4gICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgIGVmZmVjdC5vblRyYWNrID0gb25UcmFjaztcclxuICAgICAgICBlZmZlY3Qub25UcmlnZ2VyID0gb25UcmlnZ2VyO1xyXG4gICAgfVxyXG4gICAgLy8gaW5pdGlhbCBydW5cclxuICAgIGlmIChjYikge1xyXG4gICAgICAgIGlmIChpbW1lZGlhdGUpIHtcclxuICAgICAgICAgICAgam9iKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBvbGRWYWx1ZSA9IGVmZmVjdC5ydW4oKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChmbHVzaCA9PT0gJ3Bvc3QnKSB7XHJcbiAgICAgICAgcXVldWVQb3N0UmVuZGVyRWZmZWN0KGVmZmVjdC5ydW4uYmluZChlZmZlY3QpLCBpbnN0YW5jZSAmJiBpbnN0YW5jZS5zdXNwZW5zZSk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBlZmZlY3QucnVuKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gKCkgPT4ge1xyXG4gICAgICAgIGVmZmVjdC5zdG9wKCk7XHJcbiAgICAgICAgaWYgKGluc3RhbmNlICYmIGluc3RhbmNlLnNjb3BlKSB7XHJcbiAgICAgICAgICAgIHJlbW92ZShpbnN0YW5jZS5zY29wZS5lZmZlY3RzLCBlZmZlY3QpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn1cclxuLy8gdGhpcy4kd2F0Y2hcclxuZnVuY3Rpb24gaW5zdGFuY2VXYXRjaChzb3VyY2UsIHZhbHVlLCBvcHRpb25zKSB7XHJcbiAgICBjb25zdCBwdWJsaWNUaGlzID0gdGhpcy5wcm94eTtcclxuICAgIGNvbnN0IGdldHRlciA9IGlzU3RyaW5nKHNvdXJjZSlcclxuICAgICAgICA/IHNvdXJjZS5pbmNsdWRlcygnLicpXHJcbiAgICAgICAgICAgID8gY3JlYXRlUGF0aEdldHRlcihwdWJsaWNUaGlzLCBzb3VyY2UpXHJcbiAgICAgICAgICAgIDogKCkgPT4gcHVibGljVGhpc1tzb3VyY2VdXHJcbiAgICAgICAgOiBzb3VyY2UuYmluZChwdWJsaWNUaGlzLCBwdWJsaWNUaGlzKTtcclxuICAgIGxldCBjYjtcclxuICAgIGlmIChpc0Z1bmN0aW9uKHZhbHVlKSkge1xyXG4gICAgICAgIGNiID0gdmFsdWU7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBjYiA9IHZhbHVlLmhhbmRsZXI7XHJcbiAgICAgICAgb3B0aW9ucyA9IHZhbHVlO1xyXG4gICAgfVxyXG4gICAgY29uc3QgY3VyID0gY3VycmVudEluc3RhbmNlO1xyXG4gICAgc2V0Q3VycmVudEluc3RhbmNlKHRoaXMpO1xyXG4gICAgY29uc3QgcmVzID0gZG9XYXRjaChnZXR0ZXIsIGNiLmJpbmQocHVibGljVGhpcyksIG9wdGlvbnMpO1xyXG4gICAgaWYgKGN1cikge1xyXG4gICAgICAgIHNldEN1cnJlbnRJbnN0YW5jZShjdXIpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgdW5zZXRDdXJyZW50SW5zdGFuY2UoKTtcclxuICAgIH1cclxuICAgIHJldHVybiByZXM7XHJcbn1cclxuZnVuY3Rpb24gY3JlYXRlUGF0aEdldHRlcihjdHgsIHBhdGgpIHtcclxuICAgIGNvbnN0IHNlZ21lbnRzID0gcGF0aC5zcGxpdCgnLicpO1xyXG4gICAgcmV0dXJuICgpID0+IHtcclxuICAgICAgICBsZXQgY3VyID0gY3R4O1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2VnbWVudHMubGVuZ3RoICYmIGN1cjsgaSsrKSB7XHJcbiAgICAgICAgICAgIGN1ciA9IGN1cltzZWdtZW50c1tpXV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBjdXI7XHJcbiAgICB9O1xyXG59XHJcbmZ1bmN0aW9uIHRyYXZlcnNlKHZhbHVlLCBzZWVuKSB7XHJcbiAgICBpZiAoIWlzT2JqZWN0KHZhbHVlKSB8fCB2YWx1ZVtcIl9fdl9za2lwXCIgLyogU0tJUCAqL10pIHtcclxuICAgICAgICByZXR1cm4gdmFsdWU7XHJcbiAgICB9XHJcbiAgICBzZWVuID0gc2VlbiB8fCBuZXcgU2V0KCk7XHJcbiAgICBpZiAoc2Vlbi5oYXModmFsdWUpKSB7XHJcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgfVxyXG4gICAgc2Vlbi5hZGQodmFsdWUpO1xyXG4gICAgaWYgKGlzUmVmKHZhbHVlKSkge1xyXG4gICAgICAgIHRyYXZlcnNlKHZhbHVlLnZhbHVlLCBzZWVuKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGlzQXJyYXkodmFsdWUpKSB7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB2YWx1ZS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB0cmF2ZXJzZSh2YWx1ZVtpXSwgc2Vlbik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoaXNTZXQodmFsdWUpIHx8IGlzTWFwKHZhbHVlKSkge1xyXG4gICAgICAgIHZhbHVlLmZvckVhY2goKHYpID0+IHtcclxuICAgICAgICAgICAgdHJhdmVyc2Uodiwgc2Vlbik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChpc1BsYWluT2JqZWN0KHZhbHVlKSkge1xyXG4gICAgICAgIGZvciAoY29uc3Qga2V5IGluIHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHRyYXZlcnNlKHZhbHVlW2tleV0sIHNlZW4pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiB2YWx1ZTtcclxufVxuXG5mdW5jdGlvbiB1c2VUcmFuc2l0aW9uU3RhdGUoKSB7XHJcbiAgICBjb25zdCBzdGF0ZSA9IHtcclxuICAgICAgICBpc01vdW50ZWQ6IGZhbHNlLFxyXG4gICAgICAgIGlzTGVhdmluZzogZmFsc2UsXHJcbiAgICAgICAgaXNVbm1vdW50aW5nOiBmYWxzZSxcclxuICAgICAgICBsZWF2aW5nVk5vZGVzOiBuZXcgTWFwKClcclxuICAgIH07XHJcbiAgICBvbk1vdW50ZWQoKCkgPT4ge1xyXG4gICAgICAgIHN0YXRlLmlzTW91bnRlZCA9IHRydWU7XHJcbiAgICB9KTtcclxuICAgIG9uQmVmb3JlVW5tb3VudCgoKSA9PiB7XHJcbiAgICAgICAgc3RhdGUuaXNVbm1vdW50aW5nID0gdHJ1ZTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHN0YXRlO1xyXG59XHJcbmNvbnN0IFRyYW5zaXRpb25Ib29rVmFsaWRhdG9yID0gW0Z1bmN0aW9uLCBBcnJheV07XHJcbmNvbnN0IEJhc2VUcmFuc2l0aW9uSW1wbCA9IHtcclxuICAgIG5hbWU6IGBCYXNlVHJhbnNpdGlvbmAsXHJcbiAgICBwcm9wczoge1xyXG4gICAgICAgIG1vZGU6IFN0cmluZyxcclxuICAgICAgICBhcHBlYXI6IEJvb2xlYW4sXHJcbiAgICAgICAgcGVyc2lzdGVkOiBCb29sZWFuLFxyXG4gICAgICAgIC8vIGVudGVyXHJcbiAgICAgICAgb25CZWZvcmVFbnRlcjogVHJhbnNpdGlvbkhvb2tWYWxpZGF0b3IsXHJcbiAgICAgICAgb25FbnRlcjogVHJhbnNpdGlvbkhvb2tWYWxpZGF0b3IsXHJcbiAgICAgICAgb25BZnRlckVudGVyOiBUcmFuc2l0aW9uSG9va1ZhbGlkYXRvcixcclxuICAgICAgICBvbkVudGVyQ2FuY2VsbGVkOiBUcmFuc2l0aW9uSG9va1ZhbGlkYXRvcixcclxuICAgICAgICAvLyBsZWF2ZVxyXG4gICAgICAgIG9uQmVmb3JlTGVhdmU6IFRyYW5zaXRpb25Ib29rVmFsaWRhdG9yLFxyXG4gICAgICAgIG9uTGVhdmU6IFRyYW5zaXRpb25Ib29rVmFsaWRhdG9yLFxyXG4gICAgICAgIG9uQWZ0ZXJMZWF2ZTogVHJhbnNpdGlvbkhvb2tWYWxpZGF0b3IsXHJcbiAgICAgICAgb25MZWF2ZUNhbmNlbGxlZDogVHJhbnNpdGlvbkhvb2tWYWxpZGF0b3IsXHJcbiAgICAgICAgLy8gYXBwZWFyXHJcbiAgICAgICAgb25CZWZvcmVBcHBlYXI6IFRyYW5zaXRpb25Ib29rVmFsaWRhdG9yLFxyXG4gICAgICAgIG9uQXBwZWFyOiBUcmFuc2l0aW9uSG9va1ZhbGlkYXRvcixcclxuICAgICAgICBvbkFmdGVyQXBwZWFyOiBUcmFuc2l0aW9uSG9va1ZhbGlkYXRvcixcclxuICAgICAgICBvbkFwcGVhckNhbmNlbGxlZDogVHJhbnNpdGlvbkhvb2tWYWxpZGF0b3JcclxuICAgIH0sXHJcbiAgICBzZXR1cChwcm9wcywgeyBzbG90cyB9KSB7XHJcbiAgICAgICAgY29uc3QgaW5zdGFuY2UgPSBnZXRDdXJyZW50SW5zdGFuY2UoKTtcclxuICAgICAgICBjb25zdCBzdGF0ZSA9IHVzZVRyYW5zaXRpb25TdGF0ZSgpO1xyXG4gICAgICAgIGxldCBwcmV2VHJhbnNpdGlvbktleTtcclxuICAgICAgICByZXR1cm4gKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjaGlsZHJlbiA9IHNsb3RzLmRlZmF1bHQgJiYgZ2V0VHJhbnNpdGlvblJhd0NoaWxkcmVuKHNsb3RzLmRlZmF1bHQoKSwgdHJ1ZSk7XHJcbiAgICAgICAgICAgIGlmICghY2hpbGRyZW4gfHwgIWNoaWxkcmVuLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIHdhcm4gbXVsdGlwbGUgZWxlbWVudHNcclxuICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiBjaGlsZHJlbi5sZW5ndGggPiAxKSB7XHJcbiAgICAgICAgICAgICAgICB3YXJuKCc8dHJhbnNpdGlvbj4gY2FuIG9ubHkgYmUgdXNlZCBvbiBhIHNpbmdsZSBlbGVtZW50IG9yIGNvbXBvbmVudC4gVXNlICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8dHJhbnNpdGlvbi1ncm91cD4gZm9yIGxpc3RzLicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIHRoZXJlJ3Mgbm8gbmVlZCB0byB0cmFjayByZWFjdGl2aXR5IGZvciB0aGVzZSBwcm9wcyBzbyB1c2UgdGhlIHJhd1xyXG4gICAgICAgICAgICAvLyBwcm9wcyBmb3IgYSBiaXQgYmV0dGVyIHBlcmZcclxuICAgICAgICAgICAgY29uc3QgcmF3UHJvcHMgPSB0b1Jhdyhwcm9wcyk7XHJcbiAgICAgICAgICAgIGNvbnN0IHsgbW9kZSB9ID0gcmF3UHJvcHM7XHJcbiAgICAgICAgICAgIC8vIGNoZWNrIG1vZGVcclxuICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJlxyXG4gICAgICAgICAgICAgICAgbW9kZSAmJlxyXG4gICAgICAgICAgICAgICAgbW9kZSAhPT0gJ2luLW91dCcgJiYgbW9kZSAhPT0gJ291dC1pbicgJiYgbW9kZSAhPT0gJ2RlZmF1bHQnKSB7XHJcbiAgICAgICAgICAgICAgICB3YXJuKGBpbnZhbGlkIDx0cmFuc2l0aW9uPiBtb2RlOiAke21vZGV9YCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gYXQgdGhpcyBwb2ludCBjaGlsZHJlbiBoYXMgYSBndWFyYW50ZWVkIGxlbmd0aCBvZiAxLlxyXG4gICAgICAgICAgICBjb25zdCBjaGlsZCA9IGNoaWxkcmVuWzBdO1xyXG4gICAgICAgICAgICBpZiAoc3RhdGUuaXNMZWF2aW5nKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZW1wdHlQbGFjZWhvbGRlcihjaGlsZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gaW4gdGhlIGNhc2Ugb2YgPHRyYW5zaXRpb24+PGtlZXAtYWxpdmUvPjwvdHJhbnNpdGlvbj4sIHdlIG5lZWQgdG9cclxuICAgICAgICAgICAgLy8gY29tcGFyZSB0aGUgdHlwZSBvZiB0aGUga2VwdC1hbGl2ZSBjaGlsZHJlbi5cclxuICAgICAgICAgICAgY29uc3QgaW5uZXJDaGlsZCA9IGdldEtlZXBBbGl2ZUNoaWxkKGNoaWxkKTtcclxuICAgICAgICAgICAgaWYgKCFpbm5lckNoaWxkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZW1wdHlQbGFjZWhvbGRlcihjaGlsZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgZW50ZXJIb29rcyA9IHJlc29sdmVUcmFuc2l0aW9uSG9va3MoaW5uZXJDaGlsZCwgcmF3UHJvcHMsIHN0YXRlLCBpbnN0YW5jZSk7XHJcbiAgICAgICAgICAgIHNldFRyYW5zaXRpb25Ib29rcyhpbm5lckNoaWxkLCBlbnRlckhvb2tzKTtcclxuICAgICAgICAgICAgY29uc3Qgb2xkQ2hpbGQgPSBpbnN0YW5jZS5zdWJUcmVlO1xyXG4gICAgICAgICAgICBjb25zdCBvbGRJbm5lckNoaWxkID0gb2xkQ2hpbGQgJiYgZ2V0S2VlcEFsaXZlQ2hpbGQob2xkQ2hpbGQpO1xyXG4gICAgICAgICAgICBsZXQgdHJhbnNpdGlvbktleUNoYW5nZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgY29uc3QgeyBnZXRUcmFuc2l0aW9uS2V5IH0gPSBpbm5lckNoaWxkLnR5cGU7XHJcbiAgICAgICAgICAgIGlmIChnZXRUcmFuc2l0aW9uS2V5KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBrZXkgPSBnZXRUcmFuc2l0aW9uS2V5KCk7XHJcbiAgICAgICAgICAgICAgICBpZiAocHJldlRyYW5zaXRpb25LZXkgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHByZXZUcmFuc2l0aW9uS2V5ID0ga2V5O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoa2V5ICE9PSBwcmV2VHJhbnNpdGlvbktleSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHByZXZUcmFuc2l0aW9uS2V5ID0ga2V5O1xyXG4gICAgICAgICAgICAgICAgICAgIHRyYW5zaXRpb25LZXlDaGFuZ2VkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBoYW5kbGUgbW9kZVxyXG4gICAgICAgICAgICBpZiAob2xkSW5uZXJDaGlsZCAmJlxyXG4gICAgICAgICAgICAgICAgb2xkSW5uZXJDaGlsZC50eXBlICE9PSBDb21tZW50ICYmXHJcbiAgICAgICAgICAgICAgICAoIWlzU2FtZVZOb2RlVHlwZShpbm5lckNoaWxkLCBvbGRJbm5lckNoaWxkKSB8fCB0cmFuc2l0aW9uS2V5Q2hhbmdlZCkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGxlYXZpbmdIb29rcyA9IHJlc29sdmVUcmFuc2l0aW9uSG9va3Mob2xkSW5uZXJDaGlsZCwgcmF3UHJvcHMsIHN0YXRlLCBpbnN0YW5jZSk7XHJcbiAgICAgICAgICAgICAgICAvLyB1cGRhdGUgb2xkIHRyZWUncyBob29rcyBpbiBjYXNlIG9mIGR5bmFtaWMgdHJhbnNpdGlvblxyXG4gICAgICAgICAgICAgICAgc2V0VHJhbnNpdGlvbkhvb2tzKG9sZElubmVyQ2hpbGQsIGxlYXZpbmdIb29rcyk7XHJcbiAgICAgICAgICAgICAgICAvLyBzd2l0Y2hpbmcgYmV0d2VlbiBkaWZmZXJlbnQgdmlld3NcclxuICAgICAgICAgICAgICAgIGlmIChtb2RlID09PSAnb3V0LWluJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmlzTGVhdmluZyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gcmV0dXJuIHBsYWNlaG9sZGVyIG5vZGUgYW5kIHF1ZXVlIHVwZGF0ZSB3aGVuIGxlYXZlIGZpbmlzaGVzXHJcbiAgICAgICAgICAgICAgICAgICAgbGVhdmluZ0hvb2tzLmFmdGVyTGVhdmUgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlLmlzTGVhdmluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZS51cGRhdGUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBlbXB0eVBsYWNlaG9sZGVyKGNoaWxkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKG1vZGUgPT09ICdpbi1vdXQnICYmIGlubmVyQ2hpbGQudHlwZSAhPT0gQ29tbWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxlYXZpbmdIb29rcy5kZWxheUxlYXZlID0gKGVsLCBlYXJseVJlbW92ZSwgZGVsYXllZExlYXZlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGxlYXZpbmdWTm9kZXNDYWNoZSA9IGdldExlYXZpbmdOb2Rlc0ZvclR5cGUoc3RhdGUsIG9sZElubmVyQ2hpbGQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZWF2aW5nVk5vZGVzQ2FjaGVbU3RyaW5nKG9sZElubmVyQ2hpbGQua2V5KV0gPSBvbGRJbm5lckNoaWxkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBlYXJseSByZW1vdmFsIGNhbGxiYWNrXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsLl9sZWF2ZUNiID0gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWFybHlSZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsLl9sZWF2ZUNiID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGVudGVySG9va3MuZGVsYXllZExlYXZlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbnRlckhvb2tzLmRlbGF5ZWRMZWF2ZSA9IGRlbGF5ZWRMZWF2ZTtcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBjaGlsZDtcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG59O1xyXG4vLyBleHBvcnQgdGhlIHB1YmxpYyB0eXBlIGZvciBoL3RzeCBpbmZlcmVuY2VcclxuLy8gYWxzbyB0byBhdm9pZCBpbmxpbmUgaW1wb3J0KCkgaW4gZ2VuZXJhdGVkIGQudHMgZmlsZXNcclxuY29uc3QgQmFzZVRyYW5zaXRpb24gPSBCYXNlVHJhbnNpdGlvbkltcGw7XHJcbmZ1bmN0aW9uIGdldExlYXZpbmdOb2Rlc0ZvclR5cGUoc3RhdGUsIHZub2RlKSB7XHJcbiAgICBjb25zdCB7IGxlYXZpbmdWTm9kZXMgfSA9IHN0YXRlO1xyXG4gICAgbGV0IGxlYXZpbmdWTm9kZXNDYWNoZSA9IGxlYXZpbmdWTm9kZXMuZ2V0KHZub2RlLnR5cGUpO1xyXG4gICAgaWYgKCFsZWF2aW5nVk5vZGVzQ2FjaGUpIHtcclxuICAgICAgICBsZWF2aW5nVk5vZGVzQ2FjaGUgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xyXG4gICAgICAgIGxlYXZpbmdWTm9kZXMuc2V0KHZub2RlLnR5cGUsIGxlYXZpbmdWTm9kZXNDYWNoZSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbGVhdmluZ1ZOb2Rlc0NhY2hlO1xyXG59XHJcbi8vIFRoZSB0cmFuc2l0aW9uIGhvb2tzIGFyZSBhdHRhY2hlZCB0byB0aGUgdm5vZGUgYXMgdm5vZGUudHJhbnNpdGlvblxyXG4vLyBhbmQgd2lsbCBiZSBjYWxsZWQgYXQgYXBwcm9wcmlhdGUgdGltaW5nIGluIHRoZSByZW5kZXJlci5cclxuZnVuY3Rpb24gcmVzb2x2ZVRyYW5zaXRpb25Ib29rcyh2bm9kZSwgcHJvcHMsIHN0YXRlLCBpbnN0YW5jZSkge1xyXG4gICAgY29uc3QgeyBhcHBlYXIsIG1vZGUsIHBlcnNpc3RlZCA9IGZhbHNlLCBvbkJlZm9yZUVudGVyLCBvbkVudGVyLCBvbkFmdGVyRW50ZXIsIG9uRW50ZXJDYW5jZWxsZWQsIG9uQmVmb3JlTGVhdmUsIG9uTGVhdmUsIG9uQWZ0ZXJMZWF2ZSwgb25MZWF2ZUNhbmNlbGxlZCwgb25CZWZvcmVBcHBlYXIsIG9uQXBwZWFyLCBvbkFmdGVyQXBwZWFyLCBvbkFwcGVhckNhbmNlbGxlZCB9ID0gcHJvcHM7XHJcbiAgICBjb25zdCBrZXkgPSBTdHJpbmcodm5vZGUua2V5KTtcclxuICAgIGNvbnN0IGxlYXZpbmdWTm9kZXNDYWNoZSA9IGdldExlYXZpbmdOb2Rlc0ZvclR5cGUoc3RhdGUsIHZub2RlKTtcclxuICAgIGNvbnN0IGNhbGxIb29rID0gKGhvb2ssIGFyZ3MpID0+IHtcclxuICAgICAgICBob29rICYmXHJcbiAgICAgICAgICAgIGNhbGxXaXRoQXN5bmNFcnJvckhhbmRsaW5nKGhvb2ssIGluc3RhbmNlLCA5IC8qIFRSQU5TSVRJT05fSE9PSyAqLywgYXJncyk7XHJcbiAgICB9O1xyXG4gICAgY29uc3QgaG9va3MgPSB7XHJcbiAgICAgICAgbW9kZSxcclxuICAgICAgICBwZXJzaXN0ZWQsXHJcbiAgICAgICAgYmVmb3JlRW50ZXIoZWwpIHtcclxuICAgICAgICAgICAgbGV0IGhvb2sgPSBvbkJlZm9yZUVudGVyO1xyXG4gICAgICAgICAgICBpZiAoIXN0YXRlLmlzTW91bnRlZCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGFwcGVhcikge1xyXG4gICAgICAgICAgICAgICAgICAgIGhvb2sgPSBvbkJlZm9yZUFwcGVhciB8fCBvbkJlZm9yZUVudGVyO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIGZvciBzYW1lIGVsZW1lbnQgKHYtc2hvdylcclxuICAgICAgICAgICAgaWYgKGVsLl9sZWF2ZUNiKSB7XHJcbiAgICAgICAgICAgICAgICBlbC5fbGVhdmVDYih0cnVlIC8qIGNhbmNlbGxlZCAqLyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gZm9yIHRvZ2dsZWQgZWxlbWVudCB3aXRoIHNhbWUga2V5ICh2LWlmKVxyXG4gICAgICAgICAgICBjb25zdCBsZWF2aW5nVk5vZGUgPSBsZWF2aW5nVk5vZGVzQ2FjaGVba2V5XTtcclxuICAgICAgICAgICAgaWYgKGxlYXZpbmdWTm9kZSAmJlxyXG4gICAgICAgICAgICAgICAgaXNTYW1lVk5vZGVUeXBlKHZub2RlLCBsZWF2aW5nVk5vZGUpICYmXHJcbiAgICAgICAgICAgICAgICBsZWF2aW5nVk5vZGUuZWwuX2xlYXZlQ2IpIHtcclxuICAgICAgICAgICAgICAgIC8vIGZvcmNlIGVhcmx5IHJlbW92YWwgKG5vdCBjYW5jZWxsZWQpXHJcbiAgICAgICAgICAgICAgICBsZWF2aW5nVk5vZGUuZWwuX2xlYXZlQ2IoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYWxsSG9vayhob29rLCBbZWxdKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudGVyKGVsKSB7XHJcbiAgICAgICAgICAgIGxldCBob29rID0gb25FbnRlcjtcclxuICAgICAgICAgICAgbGV0IGFmdGVySG9vayA9IG9uQWZ0ZXJFbnRlcjtcclxuICAgICAgICAgICAgbGV0IGNhbmNlbEhvb2sgPSBvbkVudGVyQ2FuY2VsbGVkO1xyXG4gICAgICAgICAgICBpZiAoIXN0YXRlLmlzTW91bnRlZCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGFwcGVhcikge1xyXG4gICAgICAgICAgICAgICAgICAgIGhvb2sgPSBvbkFwcGVhciB8fCBvbkVudGVyO1xyXG4gICAgICAgICAgICAgICAgICAgIGFmdGVySG9vayA9IG9uQWZ0ZXJBcHBlYXIgfHwgb25BZnRlckVudGVyO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbmNlbEhvb2sgPSBvbkFwcGVhckNhbmNlbGxlZCB8fCBvbkVudGVyQ2FuY2VsbGVkO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGxldCBjYWxsZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgY29uc3QgZG9uZSA9IChlbC5fZW50ZXJDYiA9IChjYW5jZWxsZWQpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChjYWxsZWQpXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgY2FsbGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGlmIChjYW5jZWxsZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYWxsSG9vayhjYW5jZWxIb29rLCBbZWxdKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxIb29rKGFmdGVySG9vaywgW2VsXSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoaG9va3MuZGVsYXllZExlYXZlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaG9va3MuZGVsYXllZExlYXZlKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbC5fZW50ZXJDYiA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGlmIChob29rKSB7XHJcbiAgICAgICAgICAgICAgICBob29rKGVsLCBkb25lKTtcclxuICAgICAgICAgICAgICAgIGlmIChob29rLmxlbmd0aCA8PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZG9uZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZG9uZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBsZWF2ZShlbCwgcmVtb3ZlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGtleSA9IFN0cmluZyh2bm9kZS5rZXkpO1xyXG4gICAgICAgICAgICBpZiAoZWwuX2VudGVyQ2IpIHtcclxuICAgICAgICAgICAgICAgIGVsLl9lbnRlckNiKHRydWUgLyogY2FuY2VsbGVkICovKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoc3RhdGUuaXNVbm1vdW50aW5nKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVtb3ZlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2FsbEhvb2sob25CZWZvcmVMZWF2ZSwgW2VsXSk7XHJcbiAgICAgICAgICAgIGxldCBjYWxsZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgY29uc3QgZG9uZSA9IChlbC5fbGVhdmVDYiA9IChjYW5jZWxsZWQpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChjYWxsZWQpXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgY2FsbGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGNhbmNlbGxlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxIb29rKG9uTGVhdmVDYW5jZWxsZWQsIFtlbF0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FsbEhvb2sob25BZnRlckxlYXZlLCBbZWxdKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsLl9sZWF2ZUNiID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgaWYgKGxlYXZpbmdWTm9kZXNDYWNoZVtrZXldID09PSB2bm9kZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBsZWF2aW5nVk5vZGVzQ2FjaGVba2V5XTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGxlYXZpbmdWTm9kZXNDYWNoZVtrZXldID0gdm5vZGU7XHJcbiAgICAgICAgICAgIGlmIChvbkxlYXZlKSB7XHJcbiAgICAgICAgICAgICAgICBvbkxlYXZlKGVsLCBkb25lKTtcclxuICAgICAgICAgICAgICAgIGlmIChvbkxlYXZlLmxlbmd0aCA8PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZG9uZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZG9uZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBjbG9uZSh2bm9kZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzb2x2ZVRyYW5zaXRpb25Ib29rcyh2bm9kZSwgcHJvcHMsIHN0YXRlLCBpbnN0YW5jZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBob29rcztcclxufVxyXG4vLyB0aGUgcGxhY2Vob2xkZXIgcmVhbGx5IG9ubHkgaGFuZGxlcyBvbmUgc3BlY2lhbCBjYXNlOiBLZWVwQWxpdmVcclxuLy8gaW4gdGhlIGNhc2Ugb2YgYSBLZWVwQWxpdmUgaW4gYSBsZWF2ZSBwaGFzZSB3ZSBuZWVkIHRvIHJldHVybiBhIEtlZXBBbGl2ZVxyXG4vLyBwbGFjZWhvbGRlciB3aXRoIGVtcHR5IGNvbnRlbnQgdG8gYXZvaWQgdGhlIEtlZXBBbGl2ZSBpbnN0YW5jZSBmcm9tIGJlaW5nXHJcbi8vIHVubW91bnRlZC5cclxuZnVuY3Rpb24gZW1wdHlQbGFjZWhvbGRlcih2bm9kZSkge1xyXG4gICAgaWYgKGlzS2VlcEFsaXZlKHZub2RlKSkge1xyXG4gICAgICAgIHZub2RlID0gY2xvbmVWTm9kZSh2bm9kZSk7XHJcbiAgICAgICAgdm5vZGUuY2hpbGRyZW4gPSBudWxsO1xyXG4gICAgICAgIHJldHVybiB2bm9kZTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBnZXRLZWVwQWxpdmVDaGlsZCh2bm9kZSkge1xyXG4gICAgcmV0dXJuIGlzS2VlcEFsaXZlKHZub2RlKVxyXG4gICAgICAgID8gdm5vZGUuY2hpbGRyZW5cclxuICAgICAgICAgICAgPyB2bm9kZS5jaGlsZHJlblswXVxyXG4gICAgICAgICAgICA6IHVuZGVmaW5lZFxyXG4gICAgICAgIDogdm5vZGU7XHJcbn1cclxuZnVuY3Rpb24gc2V0VHJhbnNpdGlvbkhvb2tzKHZub2RlLCBob29rcykge1xyXG4gICAgaWYgKHZub2RlLnNoYXBlRmxhZyAmIDYgLyogQ09NUE9ORU5UICovICYmIHZub2RlLmNvbXBvbmVudCkge1xyXG4gICAgICAgIHNldFRyYW5zaXRpb25Ib29rcyh2bm9kZS5jb21wb25lbnQuc3ViVHJlZSwgaG9va3MpO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAodm5vZGUuc2hhcGVGbGFnICYgMTI4IC8qIFNVU1BFTlNFICovKSB7XHJcbiAgICAgICAgdm5vZGUuc3NDb250ZW50LnRyYW5zaXRpb24gPSBob29rcy5jbG9uZSh2bm9kZS5zc0NvbnRlbnQpO1xyXG4gICAgICAgIHZub2RlLnNzRmFsbGJhY2sudHJhbnNpdGlvbiA9IGhvb2tzLmNsb25lKHZub2RlLnNzRmFsbGJhY2spO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgdm5vZGUudHJhbnNpdGlvbiA9IGhvb2tzO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGdldFRyYW5zaXRpb25SYXdDaGlsZHJlbihjaGlsZHJlbiwga2VlcENvbW1lbnQgPSBmYWxzZSkge1xyXG4gICAgbGV0IHJldCA9IFtdO1xyXG4gICAgbGV0IGtleWVkRnJhZ21lbnRDb3VudCA9IDA7XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgY29uc3QgY2hpbGQgPSBjaGlsZHJlbltpXTtcclxuICAgICAgICAvLyBoYW5kbGUgZnJhZ21lbnQgY2hpbGRyZW4gY2FzZSwgZS5nLiB2LWZvclxyXG4gICAgICAgIGlmIChjaGlsZC50eXBlID09PSBGcmFnbWVudCkge1xyXG4gICAgICAgICAgICBpZiAoY2hpbGQucGF0Y2hGbGFnICYgMTI4IC8qIEtFWUVEX0ZSQUdNRU5UICovKVxyXG4gICAgICAgICAgICAgICAga2V5ZWRGcmFnbWVudENvdW50Kys7XHJcbiAgICAgICAgICAgIHJldCA9IHJldC5jb25jYXQoZ2V0VHJhbnNpdGlvblJhd0NoaWxkcmVuKGNoaWxkLmNoaWxkcmVuLCBrZWVwQ29tbWVudCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBjb21tZW50IHBsYWNlaG9sZGVycyBzaG91bGQgYmUgc2tpcHBlZCwgZS5nLiB2LWlmXHJcbiAgICAgICAgZWxzZSBpZiAoa2VlcENvbW1lbnQgfHwgY2hpbGQudHlwZSAhPT0gQ29tbWVudCkge1xyXG4gICAgICAgICAgICByZXQucHVzaChjaGlsZCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8gIzExMjYgaWYgYSB0cmFuc2l0aW9uIGNoaWxkcmVuIGxpc3QgY29udGFpbnMgbXVsdGlwbGUgc3ViIGZyYWdtZW50cywgdGhlc2VcclxuICAgIC8vIGZyYWdtZW50cyB3aWxsIGJlIG1lcmdlZCBpbnRvIGEgZmxhdCBjaGlsZHJlbiBhcnJheS4gU2luY2UgZWFjaCB2LWZvclxyXG4gICAgLy8gZnJhZ21lbnQgbWF5IGNvbnRhaW4gZGlmZmVyZW50IHN0YXRpYyBiaW5kaW5ncyBpbnNpZGUsIHdlIG5lZWQgdG8gZGUtb3BcclxuICAgIC8vIHRoZXNlIGNoaWxkcmVuIHRvIGZvcmNlIGZ1bGwgZGlmZnMgdG8gZW5zdXJlIGNvcnJlY3QgYmVoYXZpb3IuXHJcbiAgICBpZiAoa2V5ZWRGcmFnbWVudENvdW50ID4gMSkge1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmV0Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHJldFtpXS5wYXRjaEZsYWcgPSAtMiAvKiBCQUlMICovO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiByZXQ7XHJcbn1cblxuLy8gaW1wbGVtZW50YXRpb24sIGNsb3NlIHRvIG5vLW9wXHJcbmZ1bmN0aW9uIGRlZmluZUNvbXBvbmVudChvcHRpb25zKSB7XHJcbiAgICByZXR1cm4gaXNGdW5jdGlvbihvcHRpb25zKSA/IHsgc2V0dXA6IG9wdGlvbnMsIG5hbWU6IG9wdGlvbnMubmFtZSB9IDogb3B0aW9ucztcclxufVxuXG5jb25zdCBpc0FzeW5jV3JhcHBlciA9IChpKSA9PiAhIWkudHlwZS5fX2FzeW5jTG9hZGVyO1xyXG5mdW5jdGlvbiBkZWZpbmVBc3luY0NvbXBvbmVudChzb3VyY2UpIHtcclxuICAgIGlmIChpc0Z1bmN0aW9uKHNvdXJjZSkpIHtcclxuICAgICAgICBzb3VyY2UgPSB7IGxvYWRlcjogc291cmNlIH07XHJcbiAgICB9XHJcbiAgICBjb25zdCB7IGxvYWRlciwgbG9hZGluZ0NvbXBvbmVudCwgZXJyb3JDb21wb25lbnQsIGRlbGF5ID0gMjAwLCB0aW1lb3V0LCAvLyB1bmRlZmluZWQgPSBuZXZlciB0aW1lcyBvdXRcclxuICAgIHN1c3BlbnNpYmxlID0gdHJ1ZSwgb25FcnJvcjogdXNlck9uRXJyb3IgfSA9IHNvdXJjZTtcclxuICAgIGxldCBwZW5kaW5nUmVxdWVzdCA9IG51bGw7XHJcbiAgICBsZXQgcmVzb2x2ZWRDb21wO1xyXG4gICAgbGV0IHJldHJpZXMgPSAwO1xyXG4gICAgY29uc3QgcmV0cnkgPSAoKSA9PiB7XHJcbiAgICAgICAgcmV0cmllcysrO1xyXG4gICAgICAgIHBlbmRpbmdSZXF1ZXN0ID0gbnVsbDtcclxuICAgICAgICByZXR1cm4gbG9hZCgpO1xyXG4gICAgfTtcclxuICAgIGNvbnN0IGxvYWQgPSAoKSA9PiB7XHJcbiAgICAgICAgbGV0IHRoaXNSZXF1ZXN0O1xyXG4gICAgICAgIHJldHVybiAocGVuZGluZ1JlcXVlc3QgfHxcclxuICAgICAgICAgICAgKHRoaXNSZXF1ZXN0ID0gcGVuZGluZ1JlcXVlc3QgPVxyXG4gICAgICAgICAgICAgICAgbG9hZGVyKClcclxuICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZXJyID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBlcnIgPSBlcnIgaW5zdGFuY2VvZiBFcnJvciA/IGVyciA6IG5ldyBFcnJvcihTdHJpbmcoZXJyKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHVzZXJPbkVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB1c2VyUmV0cnkgPSAoKSA9PiByZXNvbHZlKHJldHJ5KCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdXNlckZhaWwgPSAoKSA9PiByZWplY3QoZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJPbkVycm9yKGVyciwgdXNlclJldHJ5LCB1c2VyRmFpbCwgcmV0cmllcyArIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IGVycjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKChjb21wKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXNSZXF1ZXN0ICE9PSBwZW5kaW5nUmVxdWVzdCAmJiBwZW5kaW5nUmVxdWVzdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGVuZGluZ1JlcXVlc3Q7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiYgIWNvbXApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2FybihgQXN5bmMgY29tcG9uZW50IGxvYWRlciByZXNvbHZlZCB0byB1bmRlZmluZWQuIGAgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYElmIHlvdSBhcmUgdXNpbmcgcmV0cnkoKSwgbWFrZSBzdXJlIHRvIHJldHVybiBpdHMgcmV0dXJuIHZhbHVlLmApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAvLyBpbnRlcm9wIG1vZHVsZSBkZWZhdWx0XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbXAgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgKGNvbXAuX19lc01vZHVsZSB8fCBjb21wW1N5bWJvbC50b1N0cmluZ1RhZ10gPT09ICdNb2R1bGUnKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb21wID0gY29tcC5kZWZhdWx0O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmIGNvbXAgJiYgIWlzT2JqZWN0KGNvbXApICYmICFpc0Z1bmN0aW9uKGNvbXApKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBhc3luYyBjb21wb25lbnQgbG9hZCByZXN1bHQ6ICR7Y29tcH1gKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZWRDb21wID0gY29tcDtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29tcDtcclxuICAgICAgICAgICAgICAgIH0pKSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIGRlZmluZUNvbXBvbmVudCh7XHJcbiAgICAgICAgbmFtZTogJ0FzeW5jQ29tcG9uZW50V3JhcHBlcicsXHJcbiAgICAgICAgX19hc3luY0xvYWRlcjogbG9hZCxcclxuICAgICAgICBnZXQgX19hc3luY1Jlc29sdmVkKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzb2x2ZWRDb21wO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2V0dXAoKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGluc3RhbmNlID0gY3VycmVudEluc3RhbmNlO1xyXG4gICAgICAgICAgICAvLyBhbHJlYWR5IHJlc29sdmVkXHJcbiAgICAgICAgICAgIGlmIChyZXNvbHZlZENvbXApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAoKSA9PiBjcmVhdGVJbm5lckNvbXAocmVzb2x2ZWRDb21wLCBpbnN0YW5jZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3Qgb25FcnJvciA9IChlcnIpID0+IHtcclxuICAgICAgICAgICAgICAgIHBlbmRpbmdSZXF1ZXN0ID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGhhbmRsZUVycm9yKGVyciwgaW5zdGFuY2UsIDEzIC8qIEFTWU5DX0NPTVBPTkVOVF9MT0FERVIgKi8sICFlcnJvckNvbXBvbmVudCAvKiBkbyBub3QgdGhyb3cgaW4gZGV2IGlmIHVzZXIgcHJvdmlkZWQgZXJyb3IgY29tcG9uZW50ICovKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgLy8gc3VzcGVuc2UtY29udHJvbGxlZCBvciBTU1IuXHJcbiAgICAgICAgICAgIGlmICgoc3VzcGVuc2libGUgJiYgaW5zdGFuY2Uuc3VzcGVuc2UpIHx8XHJcbiAgICAgICAgICAgICAgICAoaXNJblNTUkNvbXBvbmVudFNldHVwKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGxvYWQoKVxyXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGNvbXAgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoKSA9PiBjcmVhdGVJbm5lckNvbXAoY29tcCwgaW5zdGFuY2UpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZXJyID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBvbkVycm9yKGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICgpID0+IGVycm9yQ29tcG9uZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgID8gY3JlYXRlVk5vZGUoZXJyb3JDb21wb25lbnQsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiBlcnJcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgOiBudWxsO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgbG9hZGVkID0gcmVmKGZhbHNlKTtcclxuICAgICAgICAgICAgY29uc3QgZXJyb3IgPSByZWYoKTtcclxuICAgICAgICAgICAgY29uc3QgZGVsYXllZCA9IHJlZighIWRlbGF5KTtcclxuICAgICAgICAgICAgaWYgKGRlbGF5KSB7XHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBkZWxheWVkLnZhbHVlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9LCBkZWxheSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRpbWVvdXQgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFsb2FkZWQudmFsdWUgJiYgIWVycm9yLnZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVyciA9IG5ldyBFcnJvcihgQXN5bmMgY29tcG9uZW50IHRpbWVkIG91dCBhZnRlciAke3RpbWVvdXR9bXMuYCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uRXJyb3IoZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IudmFsdWUgPSBlcnI7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSwgdGltZW91dCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbG9hZCgpXHJcbiAgICAgICAgICAgICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBsb2FkZWQudmFsdWUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgaWYgKGluc3RhbmNlLnBhcmVudCAmJiBpc0tlZXBBbGl2ZShpbnN0YW5jZS5wYXJlbnQudm5vZGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gcGFyZW50IGlzIGtlZXAtYWxpdmUsIGZvcmNlIHVwZGF0ZSBzbyB0aGUgbG9hZGVkIGNvbXBvbmVudCdzXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gbmFtZSBpcyB0YWtlbiBpbnRvIGFjY291bnRcclxuICAgICAgICAgICAgICAgICAgICBxdWV1ZUpvYihpbnN0YW5jZS5wYXJlbnQudXBkYXRlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5jYXRjaChlcnIgPT4ge1xyXG4gICAgICAgICAgICAgICAgb25FcnJvcihlcnIpO1xyXG4gICAgICAgICAgICAgICAgZXJyb3IudmFsdWUgPSBlcnI7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGxvYWRlZC52YWx1ZSAmJiByZXNvbHZlZENvbXApIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY3JlYXRlSW5uZXJDb21wKHJlc29sdmVkQ29tcCwgaW5zdGFuY2UpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoZXJyb3IudmFsdWUgJiYgZXJyb3JDb21wb25lbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY3JlYXRlVk5vZGUoZXJyb3JDb21wb25lbnQsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yLnZhbHVlXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChsb2FkaW5nQ29tcG9uZW50ICYmICFkZWxheWVkLnZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNyZWF0ZVZOb2RlKGxvYWRpbmdDb21wb25lbnQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59XHJcbmZ1bmN0aW9uIGNyZWF0ZUlubmVyQ29tcChjb21wLCB7IHZub2RlOiB7IHJlZiwgcHJvcHMsIGNoaWxkcmVuIH0gfSkge1xyXG4gICAgY29uc3Qgdm5vZGUgPSBjcmVhdGVWTm9kZShjb21wLCBwcm9wcywgY2hpbGRyZW4pO1xyXG4gICAgLy8gZW5zdXJlIGlubmVyIGNvbXBvbmVudCBpbmhlcml0cyB0aGUgYXN5bmMgd3JhcHBlcidzIHJlZiBvd25lclxyXG4gICAgdm5vZGUucmVmID0gcmVmO1xyXG4gICAgcmV0dXJuIHZub2RlO1xyXG59XG5cbmNvbnN0IGlzS2VlcEFsaXZlID0gKHZub2RlKSA9PiB2bm9kZS50eXBlLl9faXNLZWVwQWxpdmU7XHJcbmNvbnN0IEtlZXBBbGl2ZUltcGwgPSB7XHJcbiAgICBuYW1lOiBgS2VlcEFsaXZlYCxcclxuICAgIC8vIE1hcmtlciBmb3Igc3BlY2lhbCBoYW5kbGluZyBpbnNpZGUgdGhlIHJlbmRlcmVyLiBXZSBhcmUgbm90IHVzaW5nIGEgPT09XHJcbiAgICAvLyBjaGVjayBkaXJlY3RseSBvbiBLZWVwQWxpdmUgaW4gdGhlIHJlbmRlcmVyLCBiZWNhdXNlIGltcG9ydGluZyBpdCBkaXJlY3RseVxyXG4gICAgLy8gd291bGQgcHJldmVudCBpdCBmcm9tIGJlaW5nIHRyZWUtc2hha2VuLlxyXG4gICAgX19pc0tlZXBBbGl2ZTogdHJ1ZSxcclxuICAgIHByb3BzOiB7XHJcbiAgICAgICAgaW5jbHVkZTogW1N0cmluZywgUmVnRXhwLCBBcnJheV0sXHJcbiAgICAgICAgZXhjbHVkZTogW1N0cmluZywgUmVnRXhwLCBBcnJheV0sXHJcbiAgICAgICAgbWF4OiBbU3RyaW5nLCBOdW1iZXJdXHJcbiAgICB9LFxyXG4gICAgc2V0dXAocHJvcHMsIHsgc2xvdHMgfSkge1xyXG4gICAgICAgIGNvbnN0IGluc3RhbmNlID0gZ2V0Q3VycmVudEluc3RhbmNlKCk7XHJcbiAgICAgICAgLy8gS2VlcEFsaXZlIGNvbW11bmljYXRlcyB3aXRoIHRoZSBpbnN0YW50aWF0ZWQgcmVuZGVyZXIgdmlhIHRoZVxyXG4gICAgICAgIC8vIGN0eCB3aGVyZSB0aGUgcmVuZGVyZXIgcGFzc2VzIGluIGl0cyBpbnRlcm5hbHMsXHJcbiAgICAgICAgLy8gYW5kIHRoZSBLZWVwQWxpdmUgaW5zdGFuY2UgZXhwb3NlcyBhY3RpdmF0ZS9kZWFjdGl2YXRlIGltcGxlbWVudGF0aW9ucy5cclxuICAgICAgICAvLyBUaGUgd2hvbGUgcG9pbnQgb2YgdGhpcyBpcyB0byBhdm9pZCBpbXBvcnRpbmcgS2VlcEFsaXZlIGRpcmVjdGx5IGluIHRoZVxyXG4gICAgICAgIC8vIHJlbmRlcmVyIHRvIGZhY2lsaXRhdGUgdHJlZS1zaGFraW5nLlxyXG4gICAgICAgIGNvbnN0IHNoYXJlZENvbnRleHQgPSBpbnN0YW5jZS5jdHg7XHJcbiAgICAgICAgLy8gaWYgdGhlIGludGVybmFsIHJlbmRlcmVyIGlzIG5vdCByZWdpc3RlcmVkLCBpdCBpbmRpY2F0ZXMgdGhhdCB0aGlzIGlzIHNlcnZlci1zaWRlIHJlbmRlcmluZyxcclxuICAgICAgICAvLyBmb3IgS2VlcEFsaXZlLCB3ZSBqdXN0IG5lZWQgdG8gcmVuZGVyIGl0cyBjaGlsZHJlblxyXG4gICAgICAgIGlmICghc2hhcmVkQ29udGV4dC5yZW5kZXJlcikge1xyXG4gICAgICAgICAgICByZXR1cm4gc2xvdHMuZGVmYXVsdDtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgY2FjaGUgPSBuZXcgTWFwKCk7XHJcbiAgICAgICAgY29uc3Qga2V5cyA9IG5ldyBTZXQoKTtcclxuICAgICAgICBsZXQgY3VycmVudCA9IG51bGw7XHJcbiAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB8fCBfX1ZVRV9QUk9EX0RFVlRPT0xTX18pIHtcclxuICAgICAgICAgICAgaW5zdGFuY2UuX192X2NhY2hlID0gY2FjaGU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHBhcmVudFN1c3BlbnNlID0gaW5zdGFuY2Uuc3VzcGVuc2U7XHJcbiAgICAgICAgY29uc3QgeyByZW5kZXJlcjogeyBwOiBwYXRjaCwgbTogbW92ZSwgdW06IF91bm1vdW50LCBvOiB7IGNyZWF0ZUVsZW1lbnQgfSB9IH0gPSBzaGFyZWRDb250ZXh0O1xyXG4gICAgICAgIGNvbnN0IHN0b3JhZ2VDb250YWluZXIgPSBjcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICBzaGFyZWRDb250ZXh0LmFjdGl2YXRlID0gKHZub2RlLCBjb250YWluZXIsIGFuY2hvciwgaXNTVkcsIG9wdGltaXplZCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBpbnN0YW5jZSA9IHZub2RlLmNvbXBvbmVudDtcclxuICAgICAgICAgICAgbW92ZSh2bm9kZSwgY29udGFpbmVyLCBhbmNob3IsIDAgLyogRU5URVIgKi8sIHBhcmVudFN1c3BlbnNlKTtcclxuICAgICAgICAgICAgLy8gaW4gY2FzZSBwcm9wcyBoYXZlIGNoYW5nZWRcclxuICAgICAgICAgICAgcGF0Y2goaW5zdGFuY2Uudm5vZGUsIHZub2RlLCBjb250YWluZXIsIGFuY2hvciwgaW5zdGFuY2UsIHBhcmVudFN1c3BlbnNlLCBpc1NWRywgdm5vZGUuc2xvdFNjb3BlSWRzLCBvcHRpbWl6ZWQpO1xyXG4gICAgICAgICAgICBxdWV1ZVBvc3RSZW5kZXJFZmZlY3QoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaW5zdGFuY2UuaXNEZWFjdGl2YXRlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgaWYgKGluc3RhbmNlLmEpIHtcclxuICAgICAgICAgICAgICAgICAgICBpbnZva2VBcnJheUZucyhpbnN0YW5jZS5hKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IHZub2RlSG9vayA9IHZub2RlLnByb3BzICYmIHZub2RlLnByb3BzLm9uVm5vZGVNb3VudGVkO1xyXG4gICAgICAgICAgICAgICAgaWYgKHZub2RlSG9vaykge1xyXG4gICAgICAgICAgICAgICAgICAgIGludm9rZVZOb2RlSG9vayh2bm9kZUhvb2ssIGluc3RhbmNlLnBhcmVudCwgdm5vZGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCBwYXJlbnRTdXNwZW5zZSk7XHJcbiAgICAgICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgfHwgX19WVUVfUFJPRF9ERVZUT09MU19fKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgY29tcG9uZW50cyB0cmVlXHJcbiAgICAgICAgICAgICAgICBkZXZ0b29sc0NvbXBvbmVudEFkZGVkKGluc3RhbmNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgc2hhcmVkQ29udGV4dC5kZWFjdGl2YXRlID0gKHZub2RlKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGluc3RhbmNlID0gdm5vZGUuY29tcG9uZW50O1xyXG4gICAgICAgICAgICBtb3ZlKHZub2RlLCBzdG9yYWdlQ29udGFpbmVyLCBudWxsLCAxIC8qIExFQVZFICovLCBwYXJlbnRTdXNwZW5zZSk7XHJcbiAgICAgICAgICAgIHF1ZXVlUG9zdFJlbmRlckVmZmVjdCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaW5zdGFuY2UuZGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBpbnZva2VBcnJheUZucyhpbnN0YW5jZS5kYSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCB2bm9kZUhvb2sgPSB2bm9kZS5wcm9wcyAmJiB2bm9kZS5wcm9wcy5vblZub2RlVW5tb3VudGVkO1xyXG4gICAgICAgICAgICAgICAgaWYgKHZub2RlSG9vaykge1xyXG4gICAgICAgICAgICAgICAgICAgIGludm9rZVZOb2RlSG9vayh2bm9kZUhvb2ssIGluc3RhbmNlLnBhcmVudCwgdm5vZGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaW5zdGFuY2UuaXNEZWFjdGl2YXRlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIH0sIHBhcmVudFN1c3BlbnNlKTtcclxuICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB8fCBfX1ZVRV9QUk9EX0RFVlRPT0xTX18pIHtcclxuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBjb21wb25lbnRzIHRyZWVcclxuICAgICAgICAgICAgICAgIGRldnRvb2xzQ29tcG9uZW50QWRkZWQoaW5zdGFuY2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICBmdW5jdGlvbiB1bm1vdW50KHZub2RlKSB7XHJcbiAgICAgICAgICAgIC8vIHJlc2V0IHRoZSBzaGFwZUZsYWcgc28gaXQgY2FuIGJlIHByb3Blcmx5IHVubW91bnRlZFxyXG4gICAgICAgICAgICByZXNldFNoYXBlRmxhZyh2bm9kZSk7XHJcbiAgICAgICAgICAgIF91bm1vdW50KHZub2RlLCBpbnN0YW5jZSwgcGFyZW50U3VzcGVuc2UsIHRydWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBwcnVuZUNhY2hlKGZpbHRlcikge1xyXG4gICAgICAgICAgICBjYWNoZS5mb3JFYWNoKCh2bm9kZSwga2V5KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuYW1lID0gZ2V0Q29tcG9uZW50TmFtZSh2bm9kZS50eXBlKTtcclxuICAgICAgICAgICAgICAgIGlmIChuYW1lICYmICghZmlsdGVyIHx8ICFmaWx0ZXIobmFtZSkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJ1bmVDYWNoZUVudHJ5KGtleSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBwcnVuZUNhY2hlRW50cnkoa2V5KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNhY2hlZCA9IGNhY2hlLmdldChrZXkpO1xyXG4gICAgICAgICAgICBpZiAoIWN1cnJlbnQgfHwgY2FjaGVkLnR5cGUgIT09IGN1cnJlbnQudHlwZSkge1xyXG4gICAgICAgICAgICAgICAgdW5tb3VudChjYWNoZWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGN1cnJlbnQpIHtcclxuICAgICAgICAgICAgICAgIC8vIGN1cnJlbnQgYWN0aXZlIGluc3RhbmNlIHNob3VsZCBubyBsb25nZXIgYmUga2VwdC1hbGl2ZS5cclxuICAgICAgICAgICAgICAgIC8vIHdlIGNhbid0IHVubW91bnQgaXQgbm93IGJ1dCBpdCBtaWdodCBiZSBsYXRlciwgc28gcmVzZXQgaXRzIGZsYWcgbm93LlxyXG4gICAgICAgICAgICAgICAgcmVzZXRTaGFwZUZsYWcoY3VycmVudCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2FjaGUuZGVsZXRlKGtleSk7XHJcbiAgICAgICAgICAgIGtleXMuZGVsZXRlKGtleSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIHBydW5lIGNhY2hlIG9uIGluY2x1ZGUvZXhjbHVkZSBwcm9wIGNoYW5nZVxyXG4gICAgICAgIHdhdGNoKCgpID0+IFtwcm9wcy5pbmNsdWRlLCBwcm9wcy5leGNsdWRlXSwgKFtpbmNsdWRlLCBleGNsdWRlXSkgPT4ge1xyXG4gICAgICAgICAgICBpbmNsdWRlICYmIHBydW5lQ2FjaGUobmFtZSA9PiBtYXRjaGVzKGluY2x1ZGUsIG5hbWUpKTtcclxuICAgICAgICAgICAgZXhjbHVkZSAmJiBwcnVuZUNhY2hlKG5hbWUgPT4gIW1hdGNoZXMoZXhjbHVkZSwgbmFtZSkpO1xyXG4gICAgICAgIH0sIFxyXG4gICAgICAgIC8vIHBydW5lIHBvc3QtcmVuZGVyIGFmdGVyIGBjdXJyZW50YCBoYXMgYmVlbiB1cGRhdGVkXHJcbiAgICAgICAgeyBmbHVzaDogJ3Bvc3QnLCBkZWVwOiB0cnVlIH0pO1xyXG4gICAgICAgIC8vIGNhY2hlIHN1YiB0cmVlIGFmdGVyIHJlbmRlclxyXG4gICAgICAgIGxldCBwZW5kaW5nQ2FjaGVLZXkgPSBudWxsO1xyXG4gICAgICAgIGNvbnN0IGNhY2hlU3VidHJlZSA9ICgpID0+IHtcclxuICAgICAgICAgICAgLy8gZml4ICMxNjIxLCB0aGUgcGVuZGluZ0NhY2hlS2V5IGNvdWxkIGJlIDBcclxuICAgICAgICAgICAgaWYgKHBlbmRpbmdDYWNoZUtleSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBjYWNoZS5zZXQocGVuZGluZ0NhY2hlS2V5LCBnZXRJbm5lckNoaWxkKGluc3RhbmNlLnN1YlRyZWUpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgb25Nb3VudGVkKGNhY2hlU3VidHJlZSk7XHJcbiAgICAgICAgb25VcGRhdGVkKGNhY2hlU3VidHJlZSk7XHJcbiAgICAgICAgb25CZWZvcmVVbm1vdW50KCgpID0+IHtcclxuICAgICAgICAgICAgY2FjaGUuZm9yRWFjaChjYWNoZWQgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgeyBzdWJUcmVlLCBzdXNwZW5zZSB9ID0gaW5zdGFuY2U7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB2bm9kZSA9IGdldElubmVyQ2hpbGQoc3ViVHJlZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2FjaGVkLnR5cGUgPT09IHZub2RlLnR5cGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBjdXJyZW50IGluc3RhbmNlIHdpbGwgYmUgdW5tb3VudGVkIGFzIHBhcnQgb2Yga2VlcC1hbGl2ZSdzIHVubW91bnRcclxuICAgICAgICAgICAgICAgICAgICByZXNldFNoYXBlRmxhZyh2bm9kZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gYnV0IGludm9rZSBpdHMgZGVhY3RpdmF0ZWQgaG9vayBoZXJlXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGEgPSB2bm9kZS5jb21wb25lbnQuZGE7XHJcbiAgICAgICAgICAgICAgICAgICAgZGEgJiYgcXVldWVQb3N0UmVuZGVyRWZmZWN0KGRhLCBzdXNwZW5zZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdW5tb3VudChjYWNoZWQpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gKCkgPT4ge1xyXG4gICAgICAgICAgICBwZW5kaW5nQ2FjaGVLZXkgPSBudWxsO1xyXG4gICAgICAgICAgICBpZiAoIXNsb3RzLmRlZmF1bHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IGNoaWxkcmVuID0gc2xvdHMuZGVmYXVsdCgpO1xyXG4gICAgICAgICAgICBjb25zdCByYXdWTm9kZSA9IGNoaWxkcmVuWzBdO1xyXG4gICAgICAgICAgICBpZiAoY2hpbGRyZW4ubGVuZ3RoID4gMSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHdhcm4oYEtlZXBBbGl2ZSBzaG91bGQgY29udGFpbiBleGFjdGx5IG9uZSBjb21wb25lbnQgY2hpbGQuYCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjdXJyZW50ID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjaGlsZHJlbjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmICghaXNWTm9kZShyYXdWTm9kZSkgfHxcclxuICAgICAgICAgICAgICAgICghKHJhd1ZOb2RlLnNoYXBlRmxhZyAmIDQgLyogU1RBVEVGVUxfQ09NUE9ORU5UICovKSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICEocmF3Vk5vZGUuc2hhcGVGbGFnICYgMTI4IC8qIFNVU1BFTlNFICovKSkpIHtcclxuICAgICAgICAgICAgICAgIGN1cnJlbnQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJhd1ZOb2RlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGxldCB2bm9kZSA9IGdldElubmVyQ2hpbGQocmF3Vk5vZGUpO1xyXG4gICAgICAgICAgICBjb25zdCBjb21wID0gdm5vZGUudHlwZTtcclxuICAgICAgICAgICAgLy8gZm9yIGFzeW5jIGNvbXBvbmVudHMsIG5hbWUgY2hlY2sgc2hvdWxkIGJlIGJhc2VkIGluIGl0cyBsb2FkZWRcclxuICAgICAgICAgICAgLy8gaW5uZXIgY29tcG9uZW50IGlmIGF2YWlsYWJsZVxyXG4gICAgICAgICAgICBjb25zdCBuYW1lID0gZ2V0Q29tcG9uZW50TmFtZShpc0FzeW5jV3JhcHBlcih2bm9kZSlcclxuICAgICAgICAgICAgICAgID8gdm5vZGUudHlwZS5fX2FzeW5jUmVzb2x2ZWQgfHwge31cclxuICAgICAgICAgICAgICAgIDogY29tcCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHsgaW5jbHVkZSwgZXhjbHVkZSwgbWF4IH0gPSBwcm9wcztcclxuICAgICAgICAgICAgaWYgKChpbmNsdWRlICYmICghbmFtZSB8fCAhbWF0Y2hlcyhpbmNsdWRlLCBuYW1lKSkpIHx8XHJcbiAgICAgICAgICAgICAgICAoZXhjbHVkZSAmJiBuYW1lICYmIG1hdGNoZXMoZXhjbHVkZSwgbmFtZSkpKSB7XHJcbiAgICAgICAgICAgICAgICBjdXJyZW50ID0gdm5vZGU7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmF3Vk5vZGU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3Qga2V5ID0gdm5vZGUua2V5ID09IG51bGwgPyBjb21wIDogdm5vZGUua2V5O1xyXG4gICAgICAgICAgICBjb25zdCBjYWNoZWRWTm9kZSA9IGNhY2hlLmdldChrZXkpO1xyXG4gICAgICAgICAgICAvLyBjbG9uZSB2bm9kZSBpZiBpdCdzIHJldXNlZCBiZWNhdXNlIHdlIGFyZSBnb2luZyB0byBtdXRhdGUgaXRcclxuICAgICAgICAgICAgaWYgKHZub2RlLmVsKSB7XHJcbiAgICAgICAgICAgICAgICB2bm9kZSA9IGNsb25lVk5vZGUodm5vZGUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHJhd1ZOb2RlLnNoYXBlRmxhZyAmIDEyOCAvKiBTVVNQRU5TRSAqLykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJhd1ZOb2RlLnNzQ29udGVudCA9IHZub2RlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vICMxNTEzIGl0J3MgcG9zc2libGUgZm9yIHRoZSByZXR1cm5lZCB2bm9kZSB0byBiZSBjbG9uZWQgZHVlIHRvIGF0dHJcclxuICAgICAgICAgICAgLy8gZmFsbHRocm91Z2ggb3Igc2NvcGVJZCwgc28gdGhlIHZub2RlIGhlcmUgbWF5IG5vdCBiZSB0aGUgZmluYWwgdm5vZGVcclxuICAgICAgICAgICAgLy8gdGhhdCBpcyBtb3VudGVkLiBJbnN0ZWFkIG9mIGNhY2hpbmcgaXQgZGlyZWN0bHksIHdlIHN0b3JlIHRoZSBwZW5kaW5nXHJcbiAgICAgICAgICAgIC8vIGtleSBhbmQgY2FjaGUgYGluc3RhbmNlLnN1YlRyZWVgICh0aGUgbm9ybWFsaXplZCB2bm9kZSkgaW5cclxuICAgICAgICAgICAgLy8gYmVmb3JlTW91bnQvYmVmb3JlVXBkYXRlIGhvb2tzLlxyXG4gICAgICAgICAgICBwZW5kaW5nQ2FjaGVLZXkgPSBrZXk7XHJcbiAgICAgICAgICAgIGlmIChjYWNoZWRWTm9kZSkge1xyXG4gICAgICAgICAgICAgICAgLy8gY29weSBvdmVyIG1vdW50ZWQgc3RhdGVcclxuICAgICAgICAgICAgICAgIHZub2RlLmVsID0gY2FjaGVkVk5vZGUuZWw7XHJcbiAgICAgICAgICAgICAgICB2bm9kZS5jb21wb25lbnQgPSBjYWNoZWRWTm9kZS5jb21wb25lbnQ7XHJcbiAgICAgICAgICAgICAgICBpZiAodm5vZGUudHJhbnNpdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHJlY3Vyc2l2ZWx5IHVwZGF0ZSB0cmFuc2l0aW9uIGhvb2tzIG9uIHN1YlRyZWVcclxuICAgICAgICAgICAgICAgICAgICBzZXRUcmFuc2l0aW9uSG9va3Modm5vZGUsIHZub2RlLnRyYW5zaXRpb24pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gYXZvaWQgdm5vZGUgYmVpbmcgbW91bnRlZCBhcyBmcmVzaFxyXG4gICAgICAgICAgICAgICAgdm5vZGUuc2hhcGVGbGFnIHw9IDUxMiAvKiBDT01QT05FTlRfS0VQVF9BTElWRSAqLztcclxuICAgICAgICAgICAgICAgIC8vIG1ha2UgdGhpcyBrZXkgdGhlIGZyZXNoZXN0XHJcbiAgICAgICAgICAgICAgICBrZXlzLmRlbGV0ZShrZXkpO1xyXG4gICAgICAgICAgICAgICAga2V5cy5hZGQoa2V5KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGtleXMuYWRkKGtleSk7XHJcbiAgICAgICAgICAgICAgICAvLyBwcnVuZSBvbGRlc3QgZW50cnlcclxuICAgICAgICAgICAgICAgIGlmIChtYXggJiYga2V5cy5zaXplID4gcGFyc2VJbnQobWF4LCAxMCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBwcnVuZUNhY2hlRW50cnkoa2V5cy52YWx1ZXMoKS5uZXh0KCkudmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIGF2b2lkIHZub2RlIGJlaW5nIHVubW91bnRlZFxyXG4gICAgICAgICAgICB2bm9kZS5zaGFwZUZsYWcgfD0gMjU2IC8qIENPTVBPTkVOVF9TSE9VTERfS0VFUF9BTElWRSAqLztcclxuICAgICAgICAgICAgY3VycmVudCA9IHZub2RlO1xyXG4gICAgICAgICAgICByZXR1cm4gcmF3Vk5vZGU7XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxufTtcclxuLy8gZXhwb3J0IHRoZSBwdWJsaWMgdHlwZSBmb3IgaC90c3ggaW5mZXJlbmNlXHJcbi8vIGFsc28gdG8gYXZvaWQgaW5saW5lIGltcG9ydCgpIGluIGdlbmVyYXRlZCBkLnRzIGZpbGVzXHJcbmNvbnN0IEtlZXBBbGl2ZSA9IEtlZXBBbGl2ZUltcGw7XHJcbmZ1bmN0aW9uIG1hdGNoZXMocGF0dGVybiwgbmFtZSkge1xyXG4gICAgaWYgKGlzQXJyYXkocGF0dGVybikpIHtcclxuICAgICAgICByZXR1cm4gcGF0dGVybi5zb21lKChwKSA9PiBtYXRjaGVzKHAsIG5hbWUpKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGlzU3RyaW5nKHBhdHRlcm4pKSB7XHJcbiAgICAgICAgcmV0dXJuIHBhdHRlcm4uc3BsaXQoJywnKS5pbmNsdWRlcyhuYW1lKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKHBhdHRlcm4udGVzdCkge1xyXG4gICAgICAgIHJldHVybiBwYXR0ZXJuLnRlc3QobmFtZSk7XHJcbiAgICB9XHJcbiAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG59XHJcbmZ1bmN0aW9uIG9uQWN0aXZhdGVkKGhvb2ssIHRhcmdldCkge1xyXG4gICAgcmVnaXN0ZXJLZWVwQWxpdmVIb29rKGhvb2ssIFwiYVwiIC8qIEFDVElWQVRFRCAqLywgdGFyZ2V0KTtcclxufVxyXG5mdW5jdGlvbiBvbkRlYWN0aXZhdGVkKGhvb2ssIHRhcmdldCkge1xyXG4gICAgcmVnaXN0ZXJLZWVwQWxpdmVIb29rKGhvb2ssIFwiZGFcIiAvKiBERUFDVElWQVRFRCAqLywgdGFyZ2V0KTtcclxufVxyXG5mdW5jdGlvbiByZWdpc3RlcktlZXBBbGl2ZUhvb2soaG9vaywgdHlwZSwgdGFyZ2V0ID0gY3VycmVudEluc3RhbmNlKSB7XHJcbiAgICAvLyBjYWNoZSB0aGUgZGVhY3RpdmF0ZSBicmFuY2ggY2hlY2sgd3JhcHBlciBmb3IgaW5qZWN0ZWQgaG9va3Mgc28gdGhlIHNhbWVcclxuICAgIC8vIGhvb2sgY2FuIGJlIHByb3Blcmx5IGRlZHVwZWQgYnkgdGhlIHNjaGVkdWxlci4gXCJfX3dkY1wiIHN0YW5kcyBmb3IgXCJ3aXRoXHJcbiAgICAvLyBkZWFjdGl2YXRpb24gY2hlY2tcIi5cclxuICAgIGNvbnN0IHdyYXBwZWRIb29rID0gaG9vay5fX3dkYyB8fFxyXG4gICAgICAgIChob29rLl9fd2RjID0gKCkgPT4ge1xyXG4gICAgICAgICAgICAvLyBvbmx5IGZpcmUgdGhlIGhvb2sgaWYgdGhlIHRhcmdldCBpbnN0YW5jZSBpcyBOT1QgaW4gYSBkZWFjdGl2YXRlZCBicmFuY2guXHJcbiAgICAgICAgICAgIGxldCBjdXJyZW50ID0gdGFyZ2V0O1xyXG4gICAgICAgICAgICB3aGlsZSAoY3VycmVudCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnQuaXNEZWFjdGl2YXRlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGN1cnJlbnQgPSBjdXJyZW50LnBhcmVudDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gaG9vaygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgaW5qZWN0SG9vayh0eXBlLCB3cmFwcGVkSG9vaywgdGFyZ2V0KTtcclxuICAgIC8vIEluIGFkZGl0aW9uIHRvIHJlZ2lzdGVyaW5nIGl0IG9uIHRoZSB0YXJnZXQgaW5zdGFuY2UsIHdlIHdhbGsgdXAgdGhlIHBhcmVudFxyXG4gICAgLy8gY2hhaW4gYW5kIHJlZ2lzdGVyIGl0IG9uIGFsbCBhbmNlc3RvciBpbnN0YW5jZXMgdGhhdCBhcmUga2VlcC1hbGl2ZSByb290cy5cclxuICAgIC8vIFRoaXMgYXZvaWRzIHRoZSBuZWVkIHRvIHdhbGsgdGhlIGVudGlyZSBjb21wb25lbnQgdHJlZSB3aGVuIGludm9raW5nIHRoZXNlXHJcbiAgICAvLyBob29rcywgYW5kIG1vcmUgaW1wb3J0YW50bHksIGF2b2lkcyB0aGUgbmVlZCB0byB0cmFjayBjaGlsZCBjb21wb25lbnRzIGluXHJcbiAgICAvLyBhcnJheXMuXHJcbiAgICBpZiAodGFyZ2V0KSB7XHJcbiAgICAgICAgbGV0IGN1cnJlbnQgPSB0YXJnZXQucGFyZW50O1xyXG4gICAgICAgIHdoaWxlIChjdXJyZW50ICYmIGN1cnJlbnQucGFyZW50KSB7XHJcbiAgICAgICAgICAgIGlmIChpc0tlZXBBbGl2ZShjdXJyZW50LnBhcmVudC52bm9kZSkpIHtcclxuICAgICAgICAgICAgICAgIGluamVjdFRvS2VlcEFsaXZlUm9vdCh3cmFwcGVkSG9vaywgdHlwZSwgdGFyZ2V0LCBjdXJyZW50KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjdXJyZW50ID0gY3VycmVudC5wYXJlbnQ7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGluamVjdFRvS2VlcEFsaXZlUm9vdChob29rLCB0eXBlLCB0YXJnZXQsIGtlZXBBbGl2ZVJvb3QpIHtcclxuICAgIC8vIGluamVjdEhvb2sgd3JhcHMgdGhlIG9yaWdpbmFsIGZvciBlcnJvciBoYW5kbGluZywgc28gbWFrZSBzdXJlIHRvIHJlbW92ZVxyXG4gICAgLy8gdGhlIHdyYXBwZWQgdmVyc2lvbi5cclxuICAgIGNvbnN0IGluamVjdGVkID0gaW5qZWN0SG9vayh0eXBlLCBob29rLCBrZWVwQWxpdmVSb290LCB0cnVlIC8qIHByZXBlbmQgKi8pO1xyXG4gICAgb25Vbm1vdW50ZWQoKCkgPT4ge1xyXG4gICAgICAgIHJlbW92ZShrZWVwQWxpdmVSb290W3R5cGVdLCBpbmplY3RlZCk7XHJcbiAgICB9LCB0YXJnZXQpO1xyXG59XHJcbmZ1bmN0aW9uIHJlc2V0U2hhcGVGbGFnKHZub2RlKSB7XHJcbiAgICBsZXQgc2hhcGVGbGFnID0gdm5vZGUuc2hhcGVGbGFnO1xyXG4gICAgaWYgKHNoYXBlRmxhZyAmIDI1NiAvKiBDT01QT05FTlRfU0hPVUxEX0tFRVBfQUxJVkUgKi8pIHtcclxuICAgICAgICBzaGFwZUZsYWcgLT0gMjU2IC8qIENPTVBPTkVOVF9TSE9VTERfS0VFUF9BTElWRSAqLztcclxuICAgIH1cclxuICAgIGlmIChzaGFwZUZsYWcgJiA1MTIgLyogQ09NUE9ORU5UX0tFUFRfQUxJVkUgKi8pIHtcclxuICAgICAgICBzaGFwZUZsYWcgLT0gNTEyIC8qIENPTVBPTkVOVF9LRVBUX0FMSVZFICovO1xyXG4gICAgfVxyXG4gICAgdm5vZGUuc2hhcGVGbGFnID0gc2hhcGVGbGFnO1xyXG59XHJcbmZ1bmN0aW9uIGdldElubmVyQ2hpbGQodm5vZGUpIHtcclxuICAgIHJldHVybiB2bm9kZS5zaGFwZUZsYWcgJiAxMjggLyogU1VTUEVOU0UgKi8gPyB2bm9kZS5zc0NvbnRlbnQgOiB2bm9kZTtcclxufVxuXG5mdW5jdGlvbiBpbmplY3RIb29rKHR5cGUsIGhvb2ssIHRhcmdldCA9IGN1cnJlbnRJbnN0YW5jZSwgcHJlcGVuZCA9IGZhbHNlKSB7XHJcbiAgICBpZiAodGFyZ2V0KSB7XHJcbiAgICAgICAgY29uc3QgaG9va3MgPSB0YXJnZXRbdHlwZV0gfHwgKHRhcmdldFt0eXBlXSA9IFtdKTtcclxuICAgICAgICAvLyBjYWNoZSB0aGUgZXJyb3IgaGFuZGxpbmcgd3JhcHBlciBmb3IgaW5qZWN0ZWQgaG9va3Mgc28gdGhlIHNhbWUgaG9va1xyXG4gICAgICAgIC8vIGNhbiBiZSBwcm9wZXJseSBkZWR1cGVkIGJ5IHRoZSBzY2hlZHVsZXIuIFwiX193ZWhcIiBzdGFuZHMgZm9yIFwid2l0aCBlcnJvclxyXG4gICAgICAgIC8vIGhhbmRsaW5nXCIuXHJcbiAgICAgICAgY29uc3Qgd3JhcHBlZEhvb2sgPSBob29rLl9fd2VoIHx8XHJcbiAgICAgICAgICAgIChob29rLl9fd2VoID0gKC4uLmFyZ3MpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmICh0YXJnZXQuaXNVbm1vdW50ZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyBkaXNhYmxlIHRyYWNraW5nIGluc2lkZSBhbGwgbGlmZWN5Y2xlIGhvb2tzXHJcbiAgICAgICAgICAgICAgICAvLyBzaW5jZSB0aGV5IGNhbiBwb3RlbnRpYWxseSBiZSBjYWxsZWQgaW5zaWRlIGVmZmVjdHMuXHJcbiAgICAgICAgICAgICAgICBwYXVzZVRyYWNraW5nKCk7XHJcbiAgICAgICAgICAgICAgICAvLyBTZXQgY3VycmVudEluc3RhbmNlIGR1cmluZyBob29rIGludm9jYXRpb24uXHJcbiAgICAgICAgICAgICAgICAvLyBUaGlzIGFzc3VtZXMgdGhlIGhvb2sgZG9lcyBub3Qgc3luY2hyb25vdXNseSB0cmlnZ2VyIG90aGVyIGhvb2tzLCB3aGljaFxyXG4gICAgICAgICAgICAgICAgLy8gY2FuIG9ubHkgYmUgZmFsc2Ugd2hlbiB0aGUgdXNlciBkb2VzIHNvbWV0aGluZyByZWFsbHkgZnVua3kuXHJcbiAgICAgICAgICAgICAgICBzZXRDdXJyZW50SW5zdGFuY2UodGFyZ2V0KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHJlcyA9IGNhbGxXaXRoQXN5bmNFcnJvckhhbmRsaW5nKGhvb2ssIHRhcmdldCwgdHlwZSwgYXJncyk7XHJcbiAgICAgICAgICAgICAgICB1bnNldEN1cnJlbnRJbnN0YW5jZSgpO1xyXG4gICAgICAgICAgICAgICAgcmVzZXRUcmFja2luZygpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcztcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgaWYgKHByZXBlbmQpIHtcclxuICAgICAgICAgICAgaG9va3MudW5zaGlmdCh3cmFwcGVkSG9vayk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBob29rcy5wdXNoKHdyYXBwZWRIb29rKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHdyYXBwZWRIb29rO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgY29uc3QgYXBpTmFtZSA9IHRvSGFuZGxlcktleShFcnJvclR5cGVTdHJpbmdzW3R5cGVdLnJlcGxhY2UoLyBob29rJC8sICcnKSk7XHJcbiAgICAgICAgd2FybihgJHthcGlOYW1lfSBpcyBjYWxsZWQgd2hlbiB0aGVyZSBpcyBubyBhY3RpdmUgY29tcG9uZW50IGluc3RhbmNlIHRvIGJlIGAgK1xyXG4gICAgICAgICAgICBgYXNzb2NpYXRlZCB3aXRoLiBgICtcclxuICAgICAgICAgICAgYExpZmVjeWNsZSBpbmplY3Rpb24gQVBJcyBjYW4gb25seSBiZSB1c2VkIGR1cmluZyBleGVjdXRpb24gb2Ygc2V0dXAoKS5gICtcclxuICAgICAgICAgICAgKGAgSWYgeW91IGFyZSB1c2luZyBhc3luYyBzZXR1cCgpLCBtYWtlIHN1cmUgdG8gcmVnaXN0ZXIgbGlmZWN5Y2xlIGAgK1xyXG4gICAgICAgICAgICAgICAgICAgIGBob29rcyBiZWZvcmUgdGhlIGZpcnN0IGF3YWl0IHN0YXRlbWVudC5gXHJcbiAgICAgICAgICAgICAgICApKTtcclxuICAgIH1cclxufVxyXG5jb25zdCBjcmVhdGVIb29rID0gKGxpZmVjeWNsZSkgPT4gKGhvb2ssIHRhcmdldCA9IGN1cnJlbnRJbnN0YW5jZSkgPT4gXHJcbi8vIHBvc3QtY3JlYXRlIGxpZmVjeWNsZSByZWdpc3RyYXRpb25zIGFyZSBub29wcyBkdXJpbmcgU1NSIChleGNlcHQgZm9yIHNlcnZlclByZWZldGNoKVxyXG4oIWlzSW5TU1JDb21wb25lbnRTZXR1cCB8fCBsaWZlY3ljbGUgPT09IFwic3BcIiAvKiBTRVJWRVJfUFJFRkVUQ0ggKi8pICYmXHJcbiAgICBpbmplY3RIb29rKGxpZmVjeWNsZSwgaG9vaywgdGFyZ2V0KTtcclxuY29uc3Qgb25CZWZvcmVNb3VudCA9IGNyZWF0ZUhvb2soXCJibVwiIC8qIEJFRk9SRV9NT1VOVCAqLyk7XHJcbmNvbnN0IG9uTW91bnRlZCA9IGNyZWF0ZUhvb2soXCJtXCIgLyogTU9VTlRFRCAqLyk7XHJcbmNvbnN0IG9uQmVmb3JlVXBkYXRlID0gY3JlYXRlSG9vayhcImJ1XCIgLyogQkVGT1JFX1VQREFURSAqLyk7XHJcbmNvbnN0IG9uVXBkYXRlZCA9IGNyZWF0ZUhvb2soXCJ1XCIgLyogVVBEQVRFRCAqLyk7XHJcbmNvbnN0IG9uQmVmb3JlVW5tb3VudCA9IGNyZWF0ZUhvb2soXCJidW1cIiAvKiBCRUZPUkVfVU5NT1VOVCAqLyk7XHJcbmNvbnN0IG9uVW5tb3VudGVkID0gY3JlYXRlSG9vayhcInVtXCIgLyogVU5NT1VOVEVEICovKTtcclxuY29uc3Qgb25TZXJ2ZXJQcmVmZXRjaCA9IGNyZWF0ZUhvb2soXCJzcFwiIC8qIFNFUlZFUl9QUkVGRVRDSCAqLyk7XHJcbmNvbnN0IG9uUmVuZGVyVHJpZ2dlcmVkID0gY3JlYXRlSG9vayhcInJ0Z1wiIC8qIFJFTkRFUl9UUklHR0VSRUQgKi8pO1xyXG5jb25zdCBvblJlbmRlclRyYWNrZWQgPSBjcmVhdGVIb29rKFwicnRjXCIgLyogUkVOREVSX1RSQUNLRUQgKi8pO1xyXG5mdW5jdGlvbiBvbkVycm9yQ2FwdHVyZWQoaG9vaywgdGFyZ2V0ID0gY3VycmVudEluc3RhbmNlKSB7XHJcbiAgICBpbmplY3RIb29rKFwiZWNcIiAvKiBFUlJPUl9DQVBUVVJFRCAqLywgaG9vaywgdGFyZ2V0KTtcclxufVxuXG5mdW5jdGlvbiBjcmVhdGVEdXBsaWNhdGVDaGVja2VyKCkge1xyXG4gICAgY29uc3QgY2FjaGUgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xyXG4gICAgcmV0dXJuICh0eXBlLCBrZXkpID0+IHtcclxuICAgICAgICBpZiAoY2FjaGVba2V5XSkge1xyXG4gICAgICAgICAgICB3YXJuKGAke3R5cGV9IHByb3BlcnR5IFwiJHtrZXl9XCIgaXMgYWxyZWFkeSBkZWZpbmVkIGluICR7Y2FjaGVba2V5XX0uYCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBjYWNoZVtrZXldID0gdHlwZTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59XHJcbmxldCBzaG91bGRDYWNoZUFjY2VzcyA9IHRydWU7XHJcbmZ1bmN0aW9uIGFwcGx5T3B0aW9ucyhpbnN0YW5jZSkge1xyXG4gICAgY29uc3Qgb3B0aW9ucyA9IHJlc29sdmVNZXJnZWRPcHRpb25zKGluc3RhbmNlKTtcclxuICAgIGNvbnN0IHB1YmxpY1RoaXMgPSBpbnN0YW5jZS5wcm94eTtcclxuICAgIGNvbnN0IGN0eCA9IGluc3RhbmNlLmN0eDtcclxuICAgIC8vIGRvIG5vdCBjYWNoZSBwcm9wZXJ0eSBhY2Nlc3Mgb24gcHVibGljIHByb3h5IGR1cmluZyBzdGF0ZSBpbml0aWFsaXphdGlvblxyXG4gICAgc2hvdWxkQ2FjaGVBY2Nlc3MgPSBmYWxzZTtcclxuICAgIC8vIGNhbGwgYmVmb3JlQ3JlYXRlIGZpcnN0IGJlZm9yZSBhY2Nlc3Npbmcgb3RoZXIgb3B0aW9ucyBzaW5jZVxyXG4gICAgLy8gdGhlIGhvb2sgbWF5IG11dGF0ZSByZXNvbHZlZCBvcHRpb25zICgjMjc5MSlcclxuICAgIGlmIChvcHRpb25zLmJlZm9yZUNyZWF0ZSkge1xyXG4gICAgICAgIGNhbGxIb29rKG9wdGlvbnMuYmVmb3JlQ3JlYXRlLCBpbnN0YW5jZSwgXCJiY1wiIC8qIEJFRk9SRV9DUkVBVEUgKi8pO1xyXG4gICAgfVxyXG4gICAgY29uc3QgeyBcclxuICAgIC8vIHN0YXRlXHJcbiAgICBkYXRhOiBkYXRhT3B0aW9ucywgY29tcHV0ZWQ6IGNvbXB1dGVkT3B0aW9ucywgbWV0aG9kcywgd2F0Y2g6IHdhdGNoT3B0aW9ucywgcHJvdmlkZTogcHJvdmlkZU9wdGlvbnMsIGluamVjdDogaW5qZWN0T3B0aW9ucywgXHJcbiAgICAvLyBsaWZlY3ljbGVcclxuICAgIGNyZWF0ZWQsIGJlZm9yZU1vdW50LCBtb3VudGVkLCBiZWZvcmVVcGRhdGUsIHVwZGF0ZWQsIGFjdGl2YXRlZCwgZGVhY3RpdmF0ZWQsIGJlZm9yZURlc3Ryb3ksIGJlZm9yZVVubW91bnQsIGRlc3Ryb3llZCwgdW5tb3VudGVkLCByZW5kZXIsIHJlbmRlclRyYWNrZWQsIHJlbmRlclRyaWdnZXJlZCwgZXJyb3JDYXB0dXJlZCwgc2VydmVyUHJlZmV0Y2gsIFxyXG4gICAgLy8gcHVibGljIEFQSVxyXG4gICAgZXhwb3NlLCBpbmhlcml0QXR0cnMsIFxyXG4gICAgLy8gYXNzZXRzXHJcbiAgICBjb21wb25lbnRzLCBkaXJlY3RpdmVzLCBmaWx0ZXJzIH0gPSBvcHRpb25zO1xyXG4gICAgY29uc3QgY2hlY2tEdXBsaWNhdGVQcm9wZXJ0aWVzID0gKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpID8gY3JlYXRlRHVwbGljYXRlQ2hlY2tlcigpIDogbnVsbDtcclxuICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICBjb25zdCBbcHJvcHNPcHRpb25zXSA9IGluc3RhbmNlLnByb3BzT3B0aW9ucztcclxuICAgICAgICBpZiAocHJvcHNPcHRpb25zKSB7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IGluIHByb3BzT3B0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgY2hlY2tEdXBsaWNhdGVQcm9wZXJ0aWVzKFwiUHJvcHNcIiAvKiBQUk9QUyAqLywga2V5KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8vIG9wdGlvbnMgaW5pdGlhbGl6YXRpb24gb3JkZXIgKHRvIGJlIGNvbnNpc3RlbnQgd2l0aCBWdWUgMik6XHJcbiAgICAvLyAtIHByb3BzIChhbHJlYWR5IGRvbmUgb3V0c2lkZSBvZiB0aGlzIGZ1bmN0aW9uKVxyXG4gICAgLy8gLSBpbmplY3RcclxuICAgIC8vIC0gbWV0aG9kc1xyXG4gICAgLy8gLSBkYXRhIChkZWZlcnJlZCBzaW5jZSBpdCByZWxpZXMgb24gYHRoaXNgIGFjY2VzcylcclxuICAgIC8vIC0gY29tcHV0ZWRcclxuICAgIC8vIC0gd2F0Y2ggKGRlZmVycmVkIHNpbmNlIGl0IHJlbGllcyBvbiBgdGhpc2AgYWNjZXNzKVxyXG4gICAgaWYgKGluamVjdE9wdGlvbnMpIHtcclxuICAgICAgICByZXNvbHZlSW5qZWN0aW9ucyhpbmplY3RPcHRpb25zLCBjdHgsIGNoZWNrRHVwbGljYXRlUHJvcGVydGllcywgaW5zdGFuY2UuYXBwQ29udGV4dC5jb25maWcudW53cmFwSW5qZWN0ZWRSZWYpO1xyXG4gICAgfVxyXG4gICAgaWYgKG1ldGhvZHMpIHtcclxuICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBtZXRob2RzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1ldGhvZEhhbmRsZXIgPSBtZXRob2RzW2tleV07XHJcbiAgICAgICAgICAgIGlmIChpc0Z1bmN0aW9uKG1ldGhvZEhhbmRsZXIpKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBJbiBkZXYgbW9kZSwgd2UgdXNlIHRoZSBgY3JlYXRlUmVuZGVyQ29udGV4dGAgZnVuY3Rpb24gdG8gZGVmaW5lXHJcbiAgICAgICAgICAgICAgICAvLyBtZXRob2RzIHRvIHRoZSBwcm94eSB0YXJnZXQsIGFuZCB0aG9zZSBhcmUgcmVhZC1vbmx5IGJ1dFxyXG4gICAgICAgICAgICAgICAgLy8gcmVjb25maWd1cmFibGUsIHNvIGl0IG5lZWRzIHRvIGJlIHJlZGVmaW5lZCBoZXJlXHJcbiAgICAgICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGN0eCwga2V5LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBtZXRob2RIYW5kbGVyLmJpbmQocHVibGljVGhpcyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgd3JpdGFibGU6IHRydWVcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGN0eFtrZXldID0gbWV0aG9kSGFuZGxlci5iaW5kKHB1YmxpY1RoaXMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoZWNrRHVwbGljYXRlUHJvcGVydGllcyhcIk1ldGhvZHNcIiAvKiBNRVRIT0RTICovLCBrZXkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgICAgICAgICAgd2FybihgTWV0aG9kIFwiJHtrZXl9XCIgaGFzIHR5cGUgXCIke3R5cGVvZiBtZXRob2RIYW5kbGVyfVwiIGluIHRoZSBjb21wb25lbnQgZGVmaW5pdGlvbi4gYCArXHJcbiAgICAgICAgICAgICAgICAgICAgYERpZCB5b3UgcmVmZXJlbmNlIHRoZSBmdW5jdGlvbiBjb3JyZWN0bHk/YCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAoZGF0YU9wdGlvbnMpIHtcclxuICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmICFpc0Z1bmN0aW9uKGRhdGFPcHRpb25zKSkge1xyXG4gICAgICAgICAgICB3YXJuKGBUaGUgZGF0YSBvcHRpb24gbXVzdCBiZSBhIGZ1bmN0aW9uLiBgICtcclxuICAgICAgICAgICAgICAgIGBQbGFpbiBvYmplY3QgdXNhZ2UgaXMgbm8gbG9uZ2VyIHN1cHBvcnRlZC5gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgZGF0YSA9IGRhdGFPcHRpb25zLmNhbGwocHVibGljVGhpcywgcHVibGljVGhpcyk7XHJcbiAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiBpc1Byb21pc2UoZGF0YSkpIHtcclxuICAgICAgICAgICAgd2FybihgZGF0YSgpIHJldHVybmVkIGEgUHJvbWlzZSAtIG5vdGUgZGF0YSgpIGNhbm5vdCBiZSBhc3luYzsgSWYgeW91IGAgK1xyXG4gICAgICAgICAgICAgICAgYGludGVuZCB0byBwZXJmb3JtIGRhdGEgZmV0Y2hpbmcgYmVmb3JlIGNvbXBvbmVudCByZW5kZXJzLCB1c2UgYCArXHJcbiAgICAgICAgICAgICAgICBgYXN5bmMgc2V0dXAoKSArIDxTdXNwZW5zZT4uYCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghaXNPYmplY3QoZGF0YSkpIHtcclxuICAgICAgICAgICAgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmIHdhcm4oYGRhdGEoKSBzaG91bGQgcmV0dXJuIGFuIG9iamVjdC5gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGluc3RhbmNlLmRhdGEgPSByZWFjdGl2ZShkYXRhKTtcclxuICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoZWNrRHVwbGljYXRlUHJvcGVydGllcyhcIkRhdGFcIiAvKiBEQVRBICovLCBrZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGV4cG9zZSBkYXRhIG9uIGN0eCBkdXJpbmcgZGV2XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGtleVswXSAhPT0gJyQnICYmIGtleVswXSAhPT0gJ18nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjdHgsIGtleSwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldDogKCkgPT4gZGF0YVtrZXldLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0OiBOT09QXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8vIHN0YXRlIGluaXRpYWxpemF0aW9uIGNvbXBsZXRlIGF0IHRoaXMgcG9pbnQgLSBzdGFydCBjYWNoaW5nIGFjY2Vzc1xyXG4gICAgc2hvdWxkQ2FjaGVBY2Nlc3MgPSB0cnVlO1xyXG4gICAgaWYgKGNvbXB1dGVkT3B0aW9ucykge1xyXG4gICAgICAgIGZvciAoY29uc3Qga2V5IGluIGNvbXB1dGVkT3B0aW9ucykge1xyXG4gICAgICAgICAgICBjb25zdCBvcHQgPSBjb21wdXRlZE9wdGlvbnNba2V5XTtcclxuICAgICAgICAgICAgY29uc3QgZ2V0ID0gaXNGdW5jdGlvbihvcHQpXHJcbiAgICAgICAgICAgICAgICA/IG9wdC5iaW5kKHB1YmxpY1RoaXMsIHB1YmxpY1RoaXMpXHJcbiAgICAgICAgICAgICAgICA6IGlzRnVuY3Rpb24ob3B0LmdldClcclxuICAgICAgICAgICAgICAgICAgICA/IG9wdC5nZXQuYmluZChwdWJsaWNUaGlzLCBwdWJsaWNUaGlzKVxyXG4gICAgICAgICAgICAgICAgICAgIDogTk9PUDtcclxuICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiBnZXQgPT09IE5PT1ApIHtcclxuICAgICAgICAgICAgICAgIHdhcm4oYENvbXB1dGVkIHByb3BlcnR5IFwiJHtrZXl9XCIgaGFzIG5vIGdldHRlci5gKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCBzZXQgPSAhaXNGdW5jdGlvbihvcHQpICYmIGlzRnVuY3Rpb24ob3B0LnNldClcclxuICAgICAgICAgICAgICAgID8gb3B0LnNldC5iaW5kKHB1YmxpY1RoaXMpXHJcbiAgICAgICAgICAgICAgICA6IChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKVxyXG4gICAgICAgICAgICAgICAgICAgID8gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3YXJuKGBXcml0ZSBvcGVyYXRpb24gZmFpbGVkOiBjb21wdXRlZCBwcm9wZXJ0eSBcIiR7a2V5fVwiIGlzIHJlYWRvbmx5LmApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICA6IE5PT1A7XHJcbiAgICAgICAgICAgIGNvbnN0IGMgPSBjb21wdXRlZCh7XHJcbiAgICAgICAgICAgICAgICBnZXQsXHJcbiAgICAgICAgICAgICAgICBzZXRcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjdHgsIGtleSwge1xyXG4gICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGdldDogKCkgPT4gYy52YWx1ZSxcclxuICAgICAgICAgICAgICAgIHNldDogdiA9PiAoYy52YWx1ZSA9IHYpXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgICAgICBjaGVja0R1cGxpY2F0ZVByb3BlcnRpZXMoXCJDb21wdXRlZFwiIC8qIENPTVBVVEVEICovLCBrZXkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYgKHdhdGNoT3B0aW9ucykge1xyXG4gICAgICAgIGZvciAoY29uc3Qga2V5IGluIHdhdGNoT3B0aW9ucykge1xyXG4gICAgICAgICAgICBjcmVhdGVXYXRjaGVyKHdhdGNoT3B0aW9uc1trZXldLCBjdHgsIHB1YmxpY1RoaXMsIGtleSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYgKHByb3ZpZGVPcHRpb25zKSB7XHJcbiAgICAgICAgY29uc3QgcHJvdmlkZXMgPSBpc0Z1bmN0aW9uKHByb3ZpZGVPcHRpb25zKVxyXG4gICAgICAgICAgICA/IHByb3ZpZGVPcHRpb25zLmNhbGwocHVibGljVGhpcylcclxuICAgICAgICAgICAgOiBwcm92aWRlT3B0aW9ucztcclxuICAgICAgICBSZWZsZWN0Lm93bktleXMocHJvdmlkZXMpLmZvckVhY2goa2V5ID0+IHtcclxuICAgICAgICAgICAgcHJvdmlkZShrZXksIHByb3ZpZGVzW2tleV0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgaWYgKGNyZWF0ZWQpIHtcclxuICAgICAgICBjYWxsSG9vayhjcmVhdGVkLCBpbnN0YW5jZSwgXCJjXCIgLyogQ1JFQVRFRCAqLyk7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiByZWdpc3RlckxpZmVjeWNsZUhvb2socmVnaXN0ZXIsIGhvb2spIHtcclxuICAgICAgICBpZiAoaXNBcnJheShob29rKSkge1xyXG4gICAgICAgICAgICBob29rLmZvckVhY2goX2hvb2sgPT4gcmVnaXN0ZXIoX2hvb2suYmluZChwdWJsaWNUaGlzKSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChob29rKSB7XHJcbiAgICAgICAgICAgIHJlZ2lzdGVyKGhvb2suYmluZChwdWJsaWNUaGlzKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmVnaXN0ZXJMaWZlY3ljbGVIb29rKG9uQmVmb3JlTW91bnQsIGJlZm9yZU1vdW50KTtcclxuICAgIHJlZ2lzdGVyTGlmZWN5Y2xlSG9vayhvbk1vdW50ZWQsIG1vdW50ZWQpO1xyXG4gICAgcmVnaXN0ZXJMaWZlY3ljbGVIb29rKG9uQmVmb3JlVXBkYXRlLCBiZWZvcmVVcGRhdGUpO1xyXG4gICAgcmVnaXN0ZXJMaWZlY3ljbGVIb29rKG9uVXBkYXRlZCwgdXBkYXRlZCk7XHJcbiAgICByZWdpc3RlckxpZmVjeWNsZUhvb2sob25BY3RpdmF0ZWQsIGFjdGl2YXRlZCk7XHJcbiAgICByZWdpc3RlckxpZmVjeWNsZUhvb2sob25EZWFjdGl2YXRlZCwgZGVhY3RpdmF0ZWQpO1xyXG4gICAgcmVnaXN0ZXJMaWZlY3ljbGVIb29rKG9uRXJyb3JDYXB0dXJlZCwgZXJyb3JDYXB0dXJlZCk7XHJcbiAgICByZWdpc3RlckxpZmVjeWNsZUhvb2sob25SZW5kZXJUcmFja2VkLCByZW5kZXJUcmFja2VkKTtcclxuICAgIHJlZ2lzdGVyTGlmZWN5Y2xlSG9vayhvblJlbmRlclRyaWdnZXJlZCwgcmVuZGVyVHJpZ2dlcmVkKTtcclxuICAgIHJlZ2lzdGVyTGlmZWN5Y2xlSG9vayhvbkJlZm9yZVVubW91bnQsIGJlZm9yZVVubW91bnQpO1xyXG4gICAgcmVnaXN0ZXJMaWZlY3ljbGVIb29rKG9uVW5tb3VudGVkLCB1bm1vdW50ZWQpO1xyXG4gICAgcmVnaXN0ZXJMaWZlY3ljbGVIb29rKG9uU2VydmVyUHJlZmV0Y2gsIHNlcnZlclByZWZldGNoKTtcclxuICAgIGlmIChpc0FycmF5KGV4cG9zZSkpIHtcclxuICAgICAgICBpZiAoZXhwb3NlLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBjb25zdCBleHBvc2VkID0gaW5zdGFuY2UuZXhwb3NlZCB8fCAoaW5zdGFuY2UuZXhwb3NlZCA9IHt9KTtcclxuICAgICAgICAgICAgZXhwb3NlLmZvckVhY2goa2V5ID0+IHtcclxuICAgICAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvc2VkLCBrZXksIHtcclxuICAgICAgICAgICAgICAgICAgICBnZXQ6ICgpID0+IHB1YmxpY1RoaXNba2V5XSxcclxuICAgICAgICAgICAgICAgICAgICBzZXQ6IHZhbCA9PiAocHVibGljVGhpc1trZXldID0gdmFsKVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICghaW5zdGFuY2UuZXhwb3NlZCkge1xyXG4gICAgICAgICAgICBpbnN0YW5jZS5leHBvc2VkID0ge307XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8gb3B0aW9ucyB0aGF0IGFyZSBoYW5kbGVkIHdoZW4gY3JlYXRpbmcgdGhlIGluc3RhbmNlIGJ1dCBhbHNvIG5lZWQgdG8gYmVcclxuICAgIC8vIGFwcGxpZWQgZnJvbSBtaXhpbnNcclxuICAgIGlmIChyZW5kZXIgJiYgaW5zdGFuY2UucmVuZGVyID09PSBOT09QKSB7XHJcbiAgICAgICAgaW5zdGFuY2UucmVuZGVyID0gcmVuZGVyO1xyXG4gICAgfVxyXG4gICAgaWYgKGluaGVyaXRBdHRycyAhPSBudWxsKSB7XHJcbiAgICAgICAgaW5zdGFuY2UuaW5oZXJpdEF0dHJzID0gaW5oZXJpdEF0dHJzO1xyXG4gICAgfVxyXG4gICAgLy8gYXNzZXQgb3B0aW9ucy5cclxuICAgIGlmIChjb21wb25lbnRzKVxyXG4gICAgICAgIGluc3RhbmNlLmNvbXBvbmVudHMgPSBjb21wb25lbnRzO1xyXG4gICAgaWYgKGRpcmVjdGl2ZXMpXHJcbiAgICAgICAgaW5zdGFuY2UuZGlyZWN0aXZlcyA9IGRpcmVjdGl2ZXM7XHJcbn1cclxuZnVuY3Rpb24gcmVzb2x2ZUluamVjdGlvbnMoaW5qZWN0T3B0aW9ucywgY3R4LCBjaGVja0R1cGxpY2F0ZVByb3BlcnRpZXMgPSBOT09QLCB1bndyYXBSZWYgPSBmYWxzZSkge1xyXG4gICAgaWYgKGlzQXJyYXkoaW5qZWN0T3B0aW9ucykpIHtcclxuICAgICAgICBpbmplY3RPcHRpb25zID0gbm9ybWFsaXplSW5qZWN0KGluamVjdE9wdGlvbnMpO1xyXG4gICAgfVxyXG4gICAgZm9yIChjb25zdCBrZXkgaW4gaW5qZWN0T3B0aW9ucykge1xyXG4gICAgICAgIGNvbnN0IG9wdCA9IGluamVjdE9wdGlvbnNba2V5XTtcclxuICAgICAgICBsZXQgaW5qZWN0ZWQ7XHJcbiAgICAgICAgaWYgKGlzT2JqZWN0KG9wdCkpIHtcclxuICAgICAgICAgICAgaWYgKCdkZWZhdWx0JyBpbiBvcHQpIHtcclxuICAgICAgICAgICAgICAgIGluamVjdGVkID0gaW5qZWN0KG9wdC5mcm9tIHx8IGtleSwgb3B0LmRlZmF1bHQsIHRydWUgLyogdHJlYXQgZGVmYXVsdCBmdW5jdGlvbiBhcyBmYWN0b3J5ICovKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGluamVjdGVkID0gaW5qZWN0KG9wdC5mcm9tIHx8IGtleSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGluamVjdGVkID0gaW5qZWN0KG9wdCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChpc1JlZihpbmplY3RlZCkpIHtcclxuICAgICAgICAgICAgLy8gVE9ETyByZW1vdmUgdGhlIGNoZWNrIGluIDMuM1xyXG4gICAgICAgICAgICBpZiAodW53cmFwUmVmKSB7XHJcbiAgICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoY3R4LCBrZXksIHtcclxuICAgICAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBnZXQ6ICgpID0+IGluamVjdGVkLnZhbHVlLFxyXG4gICAgICAgICAgICAgICAgICAgIHNldDogdiA9PiAoaW5qZWN0ZWQudmFsdWUgPSB2KVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgd2FybihgaW5qZWN0ZWQgcHJvcGVydHkgXCIke2tleX1cIiBpcyBhIHJlZiBhbmQgd2lsbCBiZSBhdXRvLXVud3JhcHBlZCBgICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYGFuZCBubyBsb25nZXIgbmVlZHMgXFxgLnZhbHVlXFxgIGluIHRoZSBuZXh0IG1pbm9yIHJlbGVhc2UuIGAgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBgVG8gb3B0LWluIHRvIHRoZSBuZXcgYmVoYXZpb3Igbm93LCBgICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYHNldCBcXGBhcHAuY29uZmlnLnVud3JhcEluamVjdGVkUmVmID0gdHJ1ZVxcYCAodGhpcyBjb25maWcgaXMgYCArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGB0ZW1wb3JhcnkgYW5kIHdpbGwgbm90IGJlIG5lZWRlZCBpbiB0aGUgZnV0dXJlLilgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGN0eFtrZXldID0gaW5qZWN0ZWQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGN0eFtrZXldID0gaW5qZWN0ZWQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgY2hlY2tEdXBsaWNhdGVQcm9wZXJ0aWVzKFwiSW5qZWN0XCIgLyogSU5KRUNUICovLCBrZXkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBjYWxsSG9vayhob29rLCBpbnN0YW5jZSwgdHlwZSkge1xyXG4gICAgY2FsbFdpdGhBc3luY0Vycm9ySGFuZGxpbmcoaXNBcnJheShob29rKVxyXG4gICAgICAgID8gaG9vay5tYXAoaCA9PiBoLmJpbmQoaW5zdGFuY2UucHJveHkpKVxyXG4gICAgICAgIDogaG9vay5iaW5kKGluc3RhbmNlLnByb3h5KSwgaW5zdGFuY2UsIHR5cGUpO1xyXG59XHJcbmZ1bmN0aW9uIGNyZWF0ZVdhdGNoZXIocmF3LCBjdHgsIHB1YmxpY1RoaXMsIGtleSkge1xyXG4gICAgY29uc3QgZ2V0dGVyID0ga2V5LmluY2x1ZGVzKCcuJylcclxuICAgICAgICA/IGNyZWF0ZVBhdGhHZXR0ZXIocHVibGljVGhpcywga2V5KVxyXG4gICAgICAgIDogKCkgPT4gcHVibGljVGhpc1trZXldO1xyXG4gICAgaWYgKGlzU3RyaW5nKHJhdykpIHtcclxuICAgICAgICBjb25zdCBoYW5kbGVyID0gY3R4W3Jhd107XHJcbiAgICAgICAgaWYgKGlzRnVuY3Rpb24oaGFuZGxlcikpIHtcclxuICAgICAgICAgICAgd2F0Y2goZ2V0dGVyLCBoYW5kbGVyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgIHdhcm4oYEludmFsaWQgd2F0Y2ggaGFuZGxlciBzcGVjaWZpZWQgYnkga2V5IFwiJHtyYXd9XCJgLCBoYW5kbGVyKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChpc0Z1bmN0aW9uKHJhdykpIHtcclxuICAgICAgICB3YXRjaChnZXR0ZXIsIHJhdy5iaW5kKHB1YmxpY1RoaXMpKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGlzT2JqZWN0KHJhdykpIHtcclxuICAgICAgICBpZiAoaXNBcnJheShyYXcpKSB7XHJcbiAgICAgICAgICAgIHJhdy5mb3JFYWNoKHIgPT4gY3JlYXRlV2F0Y2hlcihyLCBjdHgsIHB1YmxpY1RoaXMsIGtleSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgY29uc3QgaGFuZGxlciA9IGlzRnVuY3Rpb24ocmF3LmhhbmRsZXIpXHJcbiAgICAgICAgICAgICAgICA/IHJhdy5oYW5kbGVyLmJpbmQocHVibGljVGhpcylcclxuICAgICAgICAgICAgICAgIDogY3R4W3Jhdy5oYW5kbGVyXTtcclxuICAgICAgICAgICAgaWYgKGlzRnVuY3Rpb24oaGFuZGxlcikpIHtcclxuICAgICAgICAgICAgICAgIHdhdGNoKGdldHRlciwgaGFuZGxlciwgcmF3KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgIHdhcm4oYEludmFsaWQgd2F0Y2ggaGFuZGxlciBzcGVjaWZpZWQgYnkga2V5IFwiJHtyYXcuaGFuZGxlcn1cImAsIGhhbmRsZXIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgd2FybihgSW52YWxpZCB3YXRjaCBvcHRpb246IFwiJHtrZXl9XCJgLCByYXcpO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBSZXNvbHZlIG1lcmdlZCBvcHRpb25zIGFuZCBjYWNoZSBpdCBvbiB0aGUgY29tcG9uZW50LlxyXG4gKiBUaGlzIGlzIGRvbmUgb25seSBvbmNlIHBlci1jb21wb25lbnQgc2luY2UgdGhlIG1lcmdpbmcgZG9lcyBub3QgaW52b2x2ZVxyXG4gKiBpbnN0YW5jZXMuXHJcbiAqL1xyXG5mdW5jdGlvbiByZXNvbHZlTWVyZ2VkT3B0aW9ucyhpbnN0YW5jZSkge1xyXG4gICAgY29uc3QgYmFzZSA9IGluc3RhbmNlLnR5cGU7XHJcbiAgICBjb25zdCB7IG1peGlucywgZXh0ZW5kczogZXh0ZW5kc09wdGlvbnMgfSA9IGJhc2U7XHJcbiAgICBjb25zdCB7IG1peGluczogZ2xvYmFsTWl4aW5zLCBvcHRpb25zQ2FjaGU6IGNhY2hlLCBjb25maWc6IHsgb3B0aW9uTWVyZ2VTdHJhdGVnaWVzIH0gfSA9IGluc3RhbmNlLmFwcENvbnRleHQ7XHJcbiAgICBjb25zdCBjYWNoZWQgPSBjYWNoZS5nZXQoYmFzZSk7XHJcbiAgICBsZXQgcmVzb2x2ZWQ7XHJcbiAgICBpZiAoY2FjaGVkKSB7XHJcbiAgICAgICAgcmVzb2x2ZWQgPSBjYWNoZWQ7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICghZ2xvYmFsTWl4aW5zLmxlbmd0aCAmJiAhbWl4aW5zICYmICFleHRlbmRzT3B0aW9ucykge1xyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcmVzb2x2ZWQgPSBiYXNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHJlc29sdmVkID0ge307XHJcbiAgICAgICAgaWYgKGdsb2JhbE1peGlucy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgZ2xvYmFsTWl4aW5zLmZvckVhY2gobSA9PiBtZXJnZU9wdGlvbnMocmVzb2x2ZWQsIG0sIG9wdGlvbk1lcmdlU3RyYXRlZ2llcywgdHJ1ZSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBtZXJnZU9wdGlvbnMocmVzb2x2ZWQsIGJhc2UsIG9wdGlvbk1lcmdlU3RyYXRlZ2llcyk7XHJcbiAgICB9XHJcbiAgICBjYWNoZS5zZXQoYmFzZSwgcmVzb2x2ZWQpO1xyXG4gICAgcmV0dXJuIHJlc29sdmVkO1xyXG59XHJcbmZ1bmN0aW9uIG1lcmdlT3B0aW9ucyh0bywgZnJvbSwgc3RyYXRzLCBhc01peGluID0gZmFsc2UpIHtcclxuICAgIGNvbnN0IHsgbWl4aW5zLCBleHRlbmRzOiBleHRlbmRzT3B0aW9ucyB9ID0gZnJvbTtcclxuICAgIGlmIChleHRlbmRzT3B0aW9ucykge1xyXG4gICAgICAgIG1lcmdlT3B0aW9ucyh0bywgZXh0ZW5kc09wdGlvbnMsIHN0cmF0cywgdHJ1ZSk7XHJcbiAgICB9XHJcbiAgICBpZiAobWl4aW5zKSB7XHJcbiAgICAgICAgbWl4aW5zLmZvckVhY2goKG0pID0+IG1lcmdlT3B0aW9ucyh0bywgbSwgc3RyYXRzLCB0cnVlKSk7XHJcbiAgICB9XHJcbiAgICBmb3IgKGNvbnN0IGtleSBpbiBmcm9tKSB7XHJcbiAgICAgICAgaWYgKGFzTWl4aW4gJiYga2V5ID09PSAnZXhwb3NlJykge1xyXG4gICAgICAgICAgICAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiZcclxuICAgICAgICAgICAgICAgIHdhcm4oYFwiZXhwb3NlXCIgb3B0aW9uIGlzIGlnbm9yZWQgd2hlbiBkZWNsYXJlZCBpbiBtaXhpbnMgb3IgZXh0ZW5kcy4gYCArXHJcbiAgICAgICAgICAgICAgICAgICAgYEl0IHNob3VsZCBvbmx5IGJlIGRlY2xhcmVkIGluIHRoZSBiYXNlIGNvbXBvbmVudCBpdHNlbGYuYCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zdCBzdHJhdCA9IGludGVybmFsT3B0aW9uTWVyZ2VTdHJhdHNba2V5XSB8fCAoc3RyYXRzICYmIHN0cmF0c1trZXldKTtcclxuICAgICAgICAgICAgdG9ba2V5XSA9IHN0cmF0ID8gc3RyYXQodG9ba2V5XSwgZnJvbVtrZXldKSA6IGZyb21ba2V5XTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdG87XHJcbn1cclxuY29uc3QgaW50ZXJuYWxPcHRpb25NZXJnZVN0cmF0cyA9IHtcclxuICAgIGRhdGE6IG1lcmdlRGF0YUZuLFxyXG4gICAgcHJvcHM6IG1lcmdlT2JqZWN0T3B0aW9ucyxcclxuICAgIGVtaXRzOiBtZXJnZU9iamVjdE9wdGlvbnMsXHJcbiAgICAvLyBvYmplY3RzXHJcbiAgICBtZXRob2RzOiBtZXJnZU9iamVjdE9wdGlvbnMsXHJcbiAgICBjb21wdXRlZDogbWVyZ2VPYmplY3RPcHRpb25zLFxyXG4gICAgLy8gbGlmZWN5Y2xlXHJcbiAgICBiZWZvcmVDcmVhdGU6IG1lcmdlQXNBcnJheSxcclxuICAgIGNyZWF0ZWQ6IG1lcmdlQXNBcnJheSxcclxuICAgIGJlZm9yZU1vdW50OiBtZXJnZUFzQXJyYXksXHJcbiAgICBtb3VudGVkOiBtZXJnZUFzQXJyYXksXHJcbiAgICBiZWZvcmVVcGRhdGU6IG1lcmdlQXNBcnJheSxcclxuICAgIHVwZGF0ZWQ6IG1lcmdlQXNBcnJheSxcclxuICAgIGJlZm9yZURlc3Ryb3k6IG1lcmdlQXNBcnJheSxcclxuICAgIGJlZm9yZVVubW91bnQ6IG1lcmdlQXNBcnJheSxcclxuICAgIGRlc3Ryb3llZDogbWVyZ2VBc0FycmF5LFxyXG4gICAgdW5tb3VudGVkOiBtZXJnZUFzQXJyYXksXHJcbiAgICBhY3RpdmF0ZWQ6IG1lcmdlQXNBcnJheSxcclxuICAgIGRlYWN0aXZhdGVkOiBtZXJnZUFzQXJyYXksXHJcbiAgICBlcnJvckNhcHR1cmVkOiBtZXJnZUFzQXJyYXksXHJcbiAgICBzZXJ2ZXJQcmVmZXRjaDogbWVyZ2VBc0FycmF5LFxyXG4gICAgLy8gYXNzZXRzXHJcbiAgICBjb21wb25lbnRzOiBtZXJnZU9iamVjdE9wdGlvbnMsXHJcbiAgICBkaXJlY3RpdmVzOiBtZXJnZU9iamVjdE9wdGlvbnMsXHJcbiAgICAvLyB3YXRjaFxyXG4gICAgd2F0Y2g6IG1lcmdlV2F0Y2hPcHRpb25zLFxyXG4gICAgLy8gcHJvdmlkZSAvIGluamVjdFxyXG4gICAgcHJvdmlkZTogbWVyZ2VEYXRhRm4sXHJcbiAgICBpbmplY3Q6IG1lcmdlSW5qZWN0XHJcbn07XHJcbmZ1bmN0aW9uIG1lcmdlRGF0YUZuKHRvLCBmcm9tKSB7XHJcbiAgICBpZiAoIWZyb20pIHtcclxuICAgICAgICByZXR1cm4gdG87XHJcbiAgICB9XHJcbiAgICBpZiAoIXRvKSB7XHJcbiAgICAgICAgcmV0dXJuIGZyb207XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gbWVyZ2VkRGF0YUZuKCkge1xyXG4gICAgICAgIHJldHVybiAoZXh0ZW5kKShpc0Z1bmN0aW9uKHRvKSA/IHRvLmNhbGwodGhpcywgdGhpcykgOiB0bywgaXNGdW5jdGlvbihmcm9tKSA/IGZyb20uY2FsbCh0aGlzLCB0aGlzKSA6IGZyb20pO1xyXG4gICAgfTtcclxufVxyXG5mdW5jdGlvbiBtZXJnZUluamVjdCh0bywgZnJvbSkge1xyXG4gICAgcmV0dXJuIG1lcmdlT2JqZWN0T3B0aW9ucyhub3JtYWxpemVJbmplY3QodG8pLCBub3JtYWxpemVJbmplY3QoZnJvbSkpO1xyXG59XHJcbmZ1bmN0aW9uIG5vcm1hbGl6ZUluamVjdChyYXcpIHtcclxuICAgIGlmIChpc0FycmF5KHJhdykpIHtcclxuICAgICAgICBjb25zdCByZXMgPSB7fTtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJhdy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICByZXNbcmF3W2ldXSA9IHJhd1tpXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlcztcclxuICAgIH1cclxuICAgIHJldHVybiByYXc7XHJcbn1cclxuZnVuY3Rpb24gbWVyZ2VBc0FycmF5KHRvLCBmcm9tKSB7XHJcbiAgICByZXR1cm4gdG8gPyBbLi4ubmV3IFNldChbXS5jb25jYXQodG8sIGZyb20pKV0gOiBmcm9tO1xyXG59XHJcbmZ1bmN0aW9uIG1lcmdlT2JqZWN0T3B0aW9ucyh0bywgZnJvbSkge1xyXG4gICAgcmV0dXJuIHRvID8gZXh0ZW5kKGV4dGVuZChPYmplY3QuY3JlYXRlKG51bGwpLCB0byksIGZyb20pIDogZnJvbTtcclxufVxyXG5mdW5jdGlvbiBtZXJnZVdhdGNoT3B0aW9ucyh0bywgZnJvbSkge1xyXG4gICAgaWYgKCF0bylcclxuICAgICAgICByZXR1cm4gZnJvbTtcclxuICAgIGlmICghZnJvbSlcclxuICAgICAgICByZXR1cm4gdG87XHJcbiAgICBjb25zdCBtZXJnZWQgPSBleHRlbmQoT2JqZWN0LmNyZWF0ZShudWxsKSwgdG8pO1xyXG4gICAgZm9yIChjb25zdCBrZXkgaW4gZnJvbSkge1xyXG4gICAgICAgIG1lcmdlZFtrZXldID0gbWVyZ2VBc0FycmF5KHRvW2tleV0sIGZyb21ba2V5XSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbWVyZ2VkO1xyXG59XG5cbmZ1bmN0aW9uIGluaXRQcm9wcyhpbnN0YW5jZSwgcmF3UHJvcHMsIGlzU3RhdGVmdWwsIC8vIHJlc3VsdCBvZiBiaXR3aXNlIGZsYWcgY29tcGFyaXNvblxyXG5pc1NTUiA9IGZhbHNlKSB7XHJcbiAgICBjb25zdCBwcm9wcyA9IHt9O1xyXG4gICAgY29uc3QgYXR0cnMgPSB7fTtcclxuICAgIGRlZihhdHRycywgSW50ZXJuYWxPYmplY3RLZXksIDEpO1xyXG4gICAgaW5zdGFuY2UucHJvcHNEZWZhdWx0cyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XHJcbiAgICBzZXRGdWxsUHJvcHMoaW5zdGFuY2UsIHJhd1Byb3BzLCBwcm9wcywgYXR0cnMpO1xyXG4gICAgLy8gZW5zdXJlIGFsbCBkZWNsYXJlZCBwcm9wIGtleXMgYXJlIHByZXNlbnRcclxuICAgIGZvciAoY29uc3Qga2V5IGluIGluc3RhbmNlLnByb3BzT3B0aW9uc1swXSkge1xyXG4gICAgICAgIGlmICghKGtleSBpbiBwcm9wcykpIHtcclxuICAgICAgICAgICAgcHJvcHNba2V5XSA9IHVuZGVmaW5lZDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyB2YWxpZGF0aW9uXHJcbiAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgdmFsaWRhdGVQcm9wcyhyYXdQcm9wcyB8fCB7fSwgcHJvcHMsIGluc3RhbmNlKTtcclxuICAgIH1cclxuICAgIGlmIChpc1N0YXRlZnVsKSB7XHJcbiAgICAgICAgLy8gc3RhdGVmdWxcclxuICAgICAgICBpbnN0YW5jZS5wcm9wcyA9IGlzU1NSID8gcHJvcHMgOiBzaGFsbG93UmVhY3RpdmUocHJvcHMpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgaWYgKCFpbnN0YW5jZS50eXBlLnByb3BzKSB7XHJcbiAgICAgICAgICAgIC8vIGZ1bmN0aW9uYWwgdy8gb3B0aW9uYWwgcHJvcHMsIHByb3BzID09PSBhdHRyc1xyXG4gICAgICAgICAgICBpbnN0YW5jZS5wcm9wcyA9IGF0dHJzO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8gZnVuY3Rpb25hbCB3LyBkZWNsYXJlZCBwcm9wc1xyXG4gICAgICAgICAgICBpbnN0YW5jZS5wcm9wcyA9IHByb3BzO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGluc3RhbmNlLmF0dHJzID0gYXR0cnM7XHJcbn1cclxuZnVuY3Rpb24gdXBkYXRlUHJvcHMoaW5zdGFuY2UsIHJhd1Byb3BzLCByYXdQcmV2UHJvcHMsIG9wdGltaXplZCkge1xyXG4gICAgY29uc3QgeyBwcm9wcywgYXR0cnMsIHZub2RlOiB7IHBhdGNoRmxhZyB9IH0gPSBpbnN0YW5jZTtcclxuICAgIGNvbnN0IHJhd0N1cnJlbnRQcm9wcyA9IHRvUmF3KHByb3BzKTtcclxuICAgIGNvbnN0IFtvcHRpb25zXSA9IGluc3RhbmNlLnByb3BzT3B0aW9ucztcclxuICAgIGxldCBoYXNBdHRyc0NoYW5nZWQgPSBmYWxzZTtcclxuICAgIGlmIChcclxuICAgIC8vIGFsd2F5cyBmb3JjZSBmdWxsIGRpZmYgaW4gZGV2XHJcbiAgICAvLyAtICMxOTQyIGlmIGhtciBpcyBlbmFibGVkIHdpdGggc2ZjIGNvbXBvbmVudFxyXG4gICAgLy8gLSB2aXRlIzg3MiBub24tc2ZjIGNvbXBvbmVudCB1c2VkIGJ5IHNmYyBjb21wb25lbnRcclxuICAgICEoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmXHJcbiAgICAgICAgKGluc3RhbmNlLnR5cGUuX19obXJJZCB8fFxyXG4gICAgICAgICAgICAoaW5zdGFuY2UucGFyZW50ICYmIGluc3RhbmNlLnBhcmVudC50eXBlLl9faG1ySWQpKSkgJiZcclxuICAgICAgICAob3B0aW1pemVkIHx8IHBhdGNoRmxhZyA+IDApICYmXHJcbiAgICAgICAgIShwYXRjaEZsYWcgJiAxNiAvKiBGVUxMX1BST1BTICovKSkge1xyXG4gICAgICAgIGlmIChwYXRjaEZsYWcgJiA4IC8qIFBST1BTICovKSB7XHJcbiAgICAgICAgICAgIC8vIENvbXBpbGVyLWdlbmVyYXRlZCBwcm9wcyAmIG5vIGtleXMgY2hhbmdlLCBqdXN0IHNldCB0aGUgdXBkYXRlZFxyXG4gICAgICAgICAgICAvLyB0aGUgcHJvcHMuXHJcbiAgICAgICAgICAgIGNvbnN0IHByb3BzVG9VcGRhdGUgPSBpbnN0YW5jZS52bm9kZS5keW5hbWljUHJvcHM7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcHJvcHNUb1VwZGF0ZS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgbGV0IGtleSA9IHByb3BzVG9VcGRhdGVbaV07XHJcbiAgICAgICAgICAgICAgICAvLyBQUk9QUyBmbGFnIGd1YXJhbnRlZXMgcmF3UHJvcHMgdG8gYmUgbm9uLW51bGxcclxuICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gcmF3UHJvcHNba2V5XTtcclxuICAgICAgICAgICAgICAgIGlmIChvcHRpb25zKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gYXR0ciAvIHByb3BzIHNlcGFyYXRpb24gd2FzIGRvbmUgb24gaW5pdCBhbmQgd2lsbCBiZSBjb25zaXN0ZW50XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gaW4gdGhpcyBjb2RlIHBhdGgsIHNvIGp1c3QgY2hlY2sgaWYgYXR0cnMgaGF2ZSBpdC5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoaGFzT3duKGF0dHJzLCBrZXkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gYXR0cnNba2V5XSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cnNba2V5XSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzQXR0cnNDaGFuZ2VkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2FtZWxpemVkS2V5ID0gY2FtZWxpemUoa2V5KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcHNbY2FtZWxpemVkS2V5XSA9IHJlc29sdmVQcm9wVmFsdWUob3B0aW9ucywgcmF3Q3VycmVudFByb3BzLCBjYW1lbGl6ZWRLZXksIHZhbHVlLCBpbnN0YW5jZSwgZmFsc2UgLyogaXNBYnNlbnQgKi8pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gYXR0cnNba2V5XSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhdHRyc1trZXldID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhc0F0dHJzQ2hhbmdlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgLy8gZnVsbCBwcm9wcyB1cGRhdGUuXHJcbiAgICAgICAgaWYgKHNldEZ1bGxQcm9wcyhpbnN0YW5jZSwgcmF3UHJvcHMsIHByb3BzLCBhdHRycykpIHtcclxuICAgICAgICAgICAgaGFzQXR0cnNDaGFuZ2VkID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gaW4gY2FzZSBvZiBkeW5hbWljIHByb3BzLCBjaGVjayBpZiB3ZSBuZWVkIHRvIGRlbGV0ZSBrZXlzIGZyb21cclxuICAgICAgICAvLyB0aGUgcHJvcHMgb2JqZWN0XHJcbiAgICAgICAgbGV0IGtlYmFiS2V5O1xyXG4gICAgICAgIGZvciAoY29uc3Qga2V5IGluIHJhd0N1cnJlbnRQcm9wcykge1xyXG4gICAgICAgICAgICBpZiAoIXJhd1Byb3BzIHx8XHJcbiAgICAgICAgICAgICAgICAvLyBmb3IgY2FtZWxDYXNlXHJcbiAgICAgICAgICAgICAgICAoIWhhc093bihyYXdQcm9wcywga2V5KSAmJlxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGl0J3MgcG9zc2libGUgdGhlIG9yaWdpbmFsIHByb3BzIHdhcyBwYXNzZWQgaW4gYXMga2ViYWItY2FzZVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGFuZCBjb252ZXJ0ZWQgdG8gY2FtZWxDYXNlICgjOTU1KVxyXG4gICAgICAgICAgICAgICAgICAgICgoa2ViYWJLZXkgPSBoeXBoZW5hdGUoa2V5KSkgPT09IGtleSB8fCAhaGFzT3duKHJhd1Byb3BzLCBrZWJhYktleSkpKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocmF3UHJldlByb3BzICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGZvciBjYW1lbENhc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgKHJhd1ByZXZQcm9wc1trZXldICE9PSB1bmRlZmluZWQgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGZvciBrZWJhYi1jYXNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYXdQcmV2UHJvcHNba2ViYWJLZXldICE9PSB1bmRlZmluZWQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BzW2tleV0gPSByZXNvbHZlUHJvcFZhbHVlKG9wdGlvbnMsIHJhd0N1cnJlbnRQcm9wcywga2V5LCB1bmRlZmluZWQsIGluc3RhbmNlLCB0cnVlIC8qIGlzQWJzZW50ICovKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBkZWxldGUgcHJvcHNba2V5XTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBpbiB0aGUgY2FzZSBvZiBmdW5jdGlvbmFsIGNvbXBvbmVudCB3L28gcHJvcHMgZGVjbGFyYXRpb24sIHByb3BzIGFuZFxyXG4gICAgICAgIC8vIGF0dHJzIHBvaW50IHRvIHRoZSBzYW1lIG9iamVjdCBzbyBpdCBzaG91bGQgYWxyZWFkeSBoYXZlIGJlZW4gdXBkYXRlZC5cclxuICAgICAgICBpZiAoYXR0cnMgIT09IHJhd0N1cnJlbnRQcm9wcykge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBhdHRycykge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFyYXdQcm9wcyB8fFxyXG4gICAgICAgICAgICAgICAgICAgICghaGFzT3duKHJhd1Byb3BzLCBrZXkpICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICghZmFsc2UgKSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBkZWxldGUgYXR0cnNba2V5XTtcclxuICAgICAgICAgICAgICAgICAgICBoYXNBdHRyc0NoYW5nZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8gdHJpZ2dlciB1cGRhdGVzIGZvciAkYXR0cnMgaW4gY2FzZSBpdCdzIHVzZWQgaW4gY29tcG9uZW50IHNsb3RzXHJcbiAgICBpZiAoaGFzQXR0cnNDaGFuZ2VkKSB7XHJcbiAgICAgICAgdHJpZ2dlcihpbnN0YW5jZSwgXCJzZXRcIiAvKiBTRVQgKi8sICckYXR0cnMnKTtcclxuICAgIH1cclxuICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICB2YWxpZGF0ZVByb3BzKHJhd1Byb3BzIHx8IHt9LCBwcm9wcywgaW5zdGFuY2UpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHNldEZ1bGxQcm9wcyhpbnN0YW5jZSwgcmF3UHJvcHMsIHByb3BzLCBhdHRycykge1xyXG4gICAgY29uc3QgW29wdGlvbnMsIG5lZWRDYXN0S2V5c10gPSBpbnN0YW5jZS5wcm9wc09wdGlvbnM7XHJcbiAgICBsZXQgaGFzQXR0cnNDaGFuZ2VkID0gZmFsc2U7XHJcbiAgICBsZXQgcmF3Q2FzdFZhbHVlcztcclxuICAgIGlmIChyYXdQcm9wcykge1xyXG4gICAgICAgIGZvciAobGV0IGtleSBpbiByYXdQcm9wcykge1xyXG4gICAgICAgICAgICAvLyBrZXksIHJlZiBhcmUgcmVzZXJ2ZWQgYW5kIG5ldmVyIHBhc3NlZCBkb3duXHJcbiAgICAgICAgICAgIGlmIChpc1Jlc2VydmVkUHJvcChrZXkpKSB7XHJcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHJhd1Byb3BzW2tleV07XHJcbiAgICAgICAgICAgIC8vIHByb3Agb3B0aW9uIG5hbWVzIGFyZSBjYW1lbGl6ZWQgZHVyaW5nIG5vcm1hbGl6YXRpb24sIHNvIHRvIHN1cHBvcnRcclxuICAgICAgICAgICAgLy8ga2ViYWIgLT4gY2FtZWwgY29udmVyc2lvbiBoZXJlIHdlIG5lZWQgdG8gY2FtZWxpemUgdGhlIGtleS5cclxuICAgICAgICAgICAgbGV0IGNhbWVsS2V5O1xyXG4gICAgICAgICAgICBpZiAob3B0aW9ucyAmJiBoYXNPd24ob3B0aW9ucywgKGNhbWVsS2V5ID0gY2FtZWxpemUoa2V5KSkpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIW5lZWRDYXN0S2V5cyB8fCAhbmVlZENhc3RLZXlzLmluY2x1ZGVzKGNhbWVsS2V5KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHByb3BzW2NhbWVsS2V5XSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgKHJhd0Nhc3RWYWx1ZXMgfHwgKHJhd0Nhc3RWYWx1ZXMgPSB7fSkpW2NhbWVsS2V5XSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKCFpc0VtaXRMaXN0ZW5lcihpbnN0YW5jZS5lbWl0c09wdGlvbnMsIGtleSkpIHtcclxuICAgICAgICAgICAgICAgIGlmICghKGtleSBpbiBhdHRycykgfHwgdmFsdWUgIT09IGF0dHJzW2tleV0pIHtcclxuICAgICAgICAgICAgICAgICAgICBhdHRyc1trZXldID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgaGFzQXR0cnNDaGFuZ2VkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGlmIChuZWVkQ2FzdEtleXMpIHtcclxuICAgICAgICBjb25zdCByYXdDdXJyZW50UHJvcHMgPSB0b1Jhdyhwcm9wcyk7XHJcbiAgICAgICAgY29uc3QgY2FzdFZhbHVlcyA9IHJhd0Nhc3RWYWx1ZXMgfHwgRU1QVFlfT0JKO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbmVlZENhc3RLZXlzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGtleSA9IG5lZWRDYXN0S2V5c1tpXTtcclxuICAgICAgICAgICAgcHJvcHNba2V5XSA9IHJlc29sdmVQcm9wVmFsdWUob3B0aW9ucywgcmF3Q3VycmVudFByb3BzLCBrZXksIGNhc3RWYWx1ZXNba2V5XSwgaW5zdGFuY2UsICFoYXNPd24oY2FzdFZhbHVlcywga2V5KSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGhhc0F0dHJzQ2hhbmdlZDtcclxufVxyXG5mdW5jdGlvbiByZXNvbHZlUHJvcFZhbHVlKG9wdGlvbnMsIHByb3BzLCBrZXksIHZhbHVlLCBpbnN0YW5jZSwgaXNBYnNlbnQpIHtcclxuICAgIGNvbnN0IG9wdCA9IG9wdGlvbnNba2V5XTtcclxuICAgIGlmIChvcHQgIT0gbnVsbCkge1xyXG4gICAgICAgIGNvbnN0IGhhc0RlZmF1bHQgPSBoYXNPd24ob3B0LCAnZGVmYXVsdCcpO1xyXG4gICAgICAgIC8vIGRlZmF1bHQgdmFsdWVzXHJcbiAgICAgICAgaWYgKGhhc0RlZmF1bHQgJiYgdmFsdWUgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBjb25zdCBkZWZhdWx0VmFsdWUgPSBvcHQuZGVmYXVsdDtcclxuICAgICAgICAgICAgaWYgKG9wdC50eXBlICE9PSBGdW5jdGlvbiAmJiBpc0Z1bmN0aW9uKGRlZmF1bHRWYWx1ZSkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHsgcHJvcHNEZWZhdWx0cyB9ID0gaW5zdGFuY2U7XHJcbiAgICAgICAgICAgICAgICBpZiAoa2V5IGluIHByb3BzRGVmYXVsdHMpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHByb3BzRGVmYXVsdHNba2V5XTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHNldEN1cnJlbnRJbnN0YW5jZShpbnN0YW5jZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBwcm9wc0RlZmF1bHRzW2tleV0gPSBkZWZhdWx0VmFsdWUuY2FsbChudWxsLCBwcm9wcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdW5zZXRDdXJyZW50SW5zdGFuY2UoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHZhbHVlID0gZGVmYXVsdFZhbHVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGJvb2xlYW4gY2FzdGluZ1xyXG4gICAgICAgIGlmIChvcHRbMCAvKiBzaG91bGRDYXN0ICovXSkge1xyXG4gICAgICAgICAgICBpZiAoaXNBYnNlbnQgJiYgIWhhc0RlZmF1bHQpIHtcclxuICAgICAgICAgICAgICAgIHZhbHVlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAob3B0WzEgLyogc2hvdWxkQ2FzdFRydWUgKi9dICYmXHJcbiAgICAgICAgICAgICAgICAodmFsdWUgPT09ICcnIHx8IHZhbHVlID09PSBoeXBoZW5hdGUoa2V5KSkpIHtcclxuICAgICAgICAgICAgICAgIHZhbHVlID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiB2YWx1ZTtcclxufVxyXG5mdW5jdGlvbiBub3JtYWxpemVQcm9wc09wdGlvbnMoY29tcCwgYXBwQ29udGV4dCwgYXNNaXhpbiA9IGZhbHNlKSB7XHJcbiAgICBjb25zdCBjYWNoZSA9IGFwcENvbnRleHQucHJvcHNDYWNoZTtcclxuICAgIGNvbnN0IGNhY2hlZCA9IGNhY2hlLmdldChjb21wKTtcclxuICAgIGlmIChjYWNoZWQpIHtcclxuICAgICAgICByZXR1cm4gY2FjaGVkO1xyXG4gICAgfVxyXG4gICAgY29uc3QgcmF3ID0gY29tcC5wcm9wcztcclxuICAgIGNvbnN0IG5vcm1hbGl6ZWQgPSB7fTtcclxuICAgIGNvbnN0IG5lZWRDYXN0S2V5cyA9IFtdO1xyXG4gICAgLy8gYXBwbHkgbWl4aW4vZXh0ZW5kcyBwcm9wc1xyXG4gICAgbGV0IGhhc0V4dGVuZHMgPSBmYWxzZTtcclxuICAgIGlmIChfX1ZVRV9PUFRJT05TX0FQSV9fICYmICFpc0Z1bmN0aW9uKGNvbXApKSB7XHJcbiAgICAgICAgY29uc3QgZXh0ZW5kUHJvcHMgPSAocmF3KSA9PiB7XHJcbiAgICAgICAgICAgIGhhc0V4dGVuZHMgPSB0cnVlO1xyXG4gICAgICAgICAgICBjb25zdCBbcHJvcHMsIGtleXNdID0gbm9ybWFsaXplUHJvcHNPcHRpb25zKHJhdywgYXBwQ29udGV4dCwgdHJ1ZSk7XHJcbiAgICAgICAgICAgIGV4dGVuZChub3JtYWxpemVkLCBwcm9wcyk7XHJcbiAgICAgICAgICAgIGlmIChrZXlzKVxyXG4gICAgICAgICAgICAgICAgbmVlZENhc3RLZXlzLnB1c2goLi4ua2V5cyk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBpZiAoIWFzTWl4aW4gJiYgYXBwQ29udGV4dC5taXhpbnMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGFwcENvbnRleHQubWl4aW5zLmZvckVhY2goZXh0ZW5kUHJvcHMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY29tcC5leHRlbmRzKSB7XHJcbiAgICAgICAgICAgIGV4dGVuZFByb3BzKGNvbXAuZXh0ZW5kcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChjb21wLm1peGlucykge1xyXG4gICAgICAgICAgICBjb21wLm1peGlucy5mb3JFYWNoKGV4dGVuZFByb3BzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAoIXJhdyAmJiAhaGFzRXh0ZW5kcykge1xyXG4gICAgICAgIGNhY2hlLnNldChjb21wLCBFTVBUWV9BUlIpO1xyXG4gICAgICAgIHJldHVybiBFTVBUWV9BUlI7XHJcbiAgICB9XHJcbiAgICBpZiAoaXNBcnJheShyYXcpKSB7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByYXcubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiAhaXNTdHJpbmcocmF3W2ldKSkge1xyXG4gICAgICAgICAgICAgICAgd2FybihgcHJvcHMgbXVzdCBiZSBzdHJpbmdzIHdoZW4gdXNpbmcgYXJyYXkgc3ludGF4LmAsIHJhd1tpXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3Qgbm9ybWFsaXplZEtleSA9IGNhbWVsaXplKHJhd1tpXSk7XHJcbiAgICAgICAgICAgIGlmICh2YWxpZGF0ZVByb3BOYW1lKG5vcm1hbGl6ZWRLZXkpKSB7XHJcbiAgICAgICAgICAgICAgICBub3JtYWxpemVkW25vcm1hbGl6ZWRLZXldID0gRU1QVFlfT0JKO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAocmF3KSB7XHJcbiAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiAhaXNPYmplY3QocmF3KSkge1xyXG4gICAgICAgICAgICB3YXJuKGBpbnZhbGlkIHByb3BzIG9wdGlvbnNgLCByYXcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiByYXcpIHtcclxuICAgICAgICAgICAgY29uc3Qgbm9ybWFsaXplZEtleSA9IGNhbWVsaXplKGtleSk7XHJcbiAgICAgICAgICAgIGlmICh2YWxpZGF0ZVByb3BOYW1lKG5vcm1hbGl6ZWRLZXkpKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvcHQgPSByYXdba2V5XTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHByb3AgPSAobm9ybWFsaXplZFtub3JtYWxpemVkS2V5XSA9XHJcbiAgICAgICAgICAgICAgICAgICAgaXNBcnJheShvcHQpIHx8IGlzRnVuY3Rpb24ob3B0KSA/IHsgdHlwZTogb3B0IH0gOiBvcHQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHByb3ApIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBib29sZWFuSW5kZXggPSBnZXRUeXBlSW5kZXgoQm9vbGVhbiwgcHJvcC50eXBlKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJpbmdJbmRleCA9IGdldFR5cGVJbmRleChTdHJpbmcsIHByb3AudHlwZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJvcFswIC8qIHNob3VsZENhc3QgKi9dID0gYm9vbGVhbkluZGV4ID4gLTE7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJvcFsxIC8qIHNob3VsZENhc3RUcnVlICovXSA9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0cmluZ0luZGV4IDwgMCB8fCBib29sZWFuSW5kZXggPCBzdHJpbmdJbmRleDtcclxuICAgICAgICAgICAgICAgICAgICAvLyBpZiB0aGUgcHJvcCBuZWVkcyBib29sZWFuIGNhc3Rpbmcgb3IgZGVmYXVsdCB2YWx1ZVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChib29sZWFuSW5kZXggPiAtMSB8fCBoYXNPd24ocHJvcCwgJ2RlZmF1bHQnKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZWVkQ2FzdEtleXMucHVzaChub3JtYWxpemVkS2V5KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBjb25zdCByZXMgPSBbbm9ybWFsaXplZCwgbmVlZENhc3RLZXlzXTtcclxuICAgIGNhY2hlLnNldChjb21wLCByZXMpO1xyXG4gICAgcmV0dXJuIHJlcztcclxufVxyXG5mdW5jdGlvbiB2YWxpZGF0ZVByb3BOYW1lKGtleSkge1xyXG4gICAgaWYgKGtleVswXSAhPT0gJyQnKSB7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICB3YXJuKGBJbnZhbGlkIHByb3AgbmFtZTogXCIke2tleX1cIiBpcyBhIHJlc2VydmVkIHByb3BlcnR5LmApO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG59XHJcbi8vIHVzZSBmdW5jdGlvbiBzdHJpbmcgbmFtZSB0byBjaGVjayB0eXBlIGNvbnN0cnVjdG9yc1xyXG4vLyBzbyB0aGF0IGl0IHdvcmtzIGFjcm9zcyB2bXMgLyBpZnJhbWVzLlxyXG5mdW5jdGlvbiBnZXRUeXBlKGN0b3IpIHtcclxuICAgIGNvbnN0IG1hdGNoID0gY3RvciAmJiBjdG9yLnRvU3RyaW5nKCkubWF0Y2goL15cXHMqZnVuY3Rpb24gKFxcdyspLyk7XHJcbiAgICByZXR1cm4gbWF0Y2ggPyBtYXRjaFsxXSA6IGN0b3IgPT09IG51bGwgPyAnbnVsbCcgOiAnJztcclxufVxyXG5mdW5jdGlvbiBpc1NhbWVUeXBlKGEsIGIpIHtcclxuICAgIHJldHVybiBnZXRUeXBlKGEpID09PSBnZXRUeXBlKGIpO1xyXG59XHJcbmZ1bmN0aW9uIGdldFR5cGVJbmRleCh0eXBlLCBleHBlY3RlZFR5cGVzKSB7XHJcbiAgICBpZiAoaXNBcnJheShleHBlY3RlZFR5cGVzKSkge1xyXG4gICAgICAgIHJldHVybiBleHBlY3RlZFR5cGVzLmZpbmRJbmRleCh0ID0+IGlzU2FtZVR5cGUodCwgdHlwZSkpO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoaXNGdW5jdGlvbihleHBlY3RlZFR5cGVzKSkge1xyXG4gICAgICAgIHJldHVybiBpc1NhbWVUeXBlKGV4cGVjdGVkVHlwZXMsIHR5cGUpID8gMCA6IC0xO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIC0xO1xyXG59XHJcbi8qKlxyXG4gKiBkZXYgb25seVxyXG4gKi9cclxuZnVuY3Rpb24gdmFsaWRhdGVQcm9wcyhyYXdQcm9wcywgcHJvcHMsIGluc3RhbmNlKSB7XHJcbiAgICBjb25zdCByZXNvbHZlZFZhbHVlcyA9IHRvUmF3KHByb3BzKTtcclxuICAgIGNvbnN0IG9wdGlvbnMgPSBpbnN0YW5jZS5wcm9wc09wdGlvbnNbMF07XHJcbiAgICBmb3IgKGNvbnN0IGtleSBpbiBvcHRpb25zKSB7XHJcbiAgICAgICAgbGV0IG9wdCA9IG9wdGlvbnNba2V5XTtcclxuICAgICAgICBpZiAob3B0ID09IG51bGwpXHJcbiAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgIHZhbGlkYXRlUHJvcChrZXksIHJlc29sdmVkVmFsdWVzW2tleV0sIG9wdCwgIWhhc093bihyYXdQcm9wcywga2V5KSAmJiAhaGFzT3duKHJhd1Byb3BzLCBoeXBoZW5hdGUoa2V5KSkpO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBkZXYgb25seVxyXG4gKi9cclxuZnVuY3Rpb24gdmFsaWRhdGVQcm9wKG5hbWUsIHZhbHVlLCBwcm9wLCBpc0Fic2VudCkge1xyXG4gICAgY29uc3QgeyB0eXBlLCByZXF1aXJlZCwgdmFsaWRhdG9yIH0gPSBwcm9wO1xyXG4gICAgLy8gcmVxdWlyZWQhXHJcbiAgICBpZiAocmVxdWlyZWQgJiYgaXNBYnNlbnQpIHtcclxuICAgICAgICB3YXJuKCdNaXNzaW5nIHJlcXVpcmVkIHByb3A6IFwiJyArIG5hbWUgKyAnXCInKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICAvLyBtaXNzaW5nIGJ1dCBvcHRpb25hbFxyXG4gICAgaWYgKHZhbHVlID09IG51bGwgJiYgIXByb3AucmVxdWlyZWQpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICAvLyB0eXBlIGNoZWNrXHJcbiAgICBpZiAodHlwZSAhPSBudWxsICYmIHR5cGUgIT09IHRydWUpIHtcclxuICAgICAgICBsZXQgaXNWYWxpZCA9IGZhbHNlO1xyXG4gICAgICAgIGNvbnN0IHR5cGVzID0gaXNBcnJheSh0eXBlKSA/IHR5cGUgOiBbdHlwZV07XHJcbiAgICAgICAgY29uc3QgZXhwZWN0ZWRUeXBlcyA9IFtdO1xyXG4gICAgICAgIC8vIHZhbHVlIGlzIHZhbGlkIGFzIGxvbmcgYXMgb25lIG9mIHRoZSBzcGVjaWZpZWQgdHlwZXMgbWF0Y2hcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHR5cGVzLmxlbmd0aCAmJiAhaXNWYWxpZDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHsgdmFsaWQsIGV4cGVjdGVkVHlwZSB9ID0gYXNzZXJ0VHlwZSh2YWx1ZSwgdHlwZXNbaV0pO1xyXG4gICAgICAgICAgICBleHBlY3RlZFR5cGVzLnB1c2goZXhwZWN0ZWRUeXBlIHx8ICcnKTtcclxuICAgICAgICAgICAgaXNWYWxpZCA9IHZhbGlkO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIWlzVmFsaWQpIHtcclxuICAgICAgICAgICAgd2FybihnZXRJbnZhbGlkVHlwZU1lc3NhZ2UobmFtZSwgdmFsdWUsIGV4cGVjdGVkVHlwZXMpKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8vIGN1c3RvbSB2YWxpZGF0b3JcclxuICAgIGlmICh2YWxpZGF0b3IgJiYgIXZhbGlkYXRvcih2YWx1ZSkpIHtcclxuICAgICAgICB3YXJuKCdJbnZhbGlkIHByb3A6IGN1c3RvbSB2YWxpZGF0b3IgY2hlY2sgZmFpbGVkIGZvciBwcm9wIFwiJyArIG5hbWUgKyAnXCIuJyk7XHJcbiAgICB9XHJcbn1cclxuY29uc3QgaXNTaW1wbGVUeXBlID0gLyojX19QVVJFX18qLyBtYWtlTWFwKCdTdHJpbmcsTnVtYmVyLEJvb2xlYW4sRnVuY3Rpb24sU3ltYm9sLEJpZ0ludCcpO1xyXG4vKipcclxuICogZGV2IG9ubHlcclxuICovXHJcbmZ1bmN0aW9uIGFzc2VydFR5cGUodmFsdWUsIHR5cGUpIHtcclxuICAgIGxldCB2YWxpZDtcclxuICAgIGNvbnN0IGV4cGVjdGVkVHlwZSA9IGdldFR5cGUodHlwZSk7XHJcbiAgICBpZiAoaXNTaW1wbGVUeXBlKGV4cGVjdGVkVHlwZSkpIHtcclxuICAgICAgICBjb25zdCB0ID0gdHlwZW9mIHZhbHVlO1xyXG4gICAgICAgIHZhbGlkID0gdCA9PT0gZXhwZWN0ZWRUeXBlLnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgICAgLy8gZm9yIHByaW1pdGl2ZSB3cmFwcGVyIG9iamVjdHNcclxuICAgICAgICBpZiAoIXZhbGlkICYmIHQgPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgICAgIHZhbGlkID0gdmFsdWUgaW5zdGFuY2VvZiB0eXBlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGV4cGVjdGVkVHlwZSA9PT0gJ09iamVjdCcpIHtcclxuICAgICAgICB2YWxpZCA9IGlzT2JqZWN0KHZhbHVlKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGV4cGVjdGVkVHlwZSA9PT0gJ0FycmF5Jykge1xyXG4gICAgICAgIHZhbGlkID0gaXNBcnJheSh2YWx1ZSk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChleHBlY3RlZFR5cGUgPT09ICdudWxsJykge1xyXG4gICAgICAgIHZhbGlkID0gdmFsdWUgPT09IG51bGw7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICB2YWxpZCA9IHZhbHVlIGluc3RhbmNlb2YgdHlwZTtcclxuICAgIH1cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgdmFsaWQsXHJcbiAgICAgICAgZXhwZWN0ZWRUeXBlXHJcbiAgICB9O1xyXG59XHJcbi8qKlxyXG4gKiBkZXYgb25seVxyXG4gKi9cclxuZnVuY3Rpb24gZ2V0SW52YWxpZFR5cGVNZXNzYWdlKG5hbWUsIHZhbHVlLCBleHBlY3RlZFR5cGVzKSB7XHJcbiAgICBsZXQgbWVzc2FnZSA9IGBJbnZhbGlkIHByb3A6IHR5cGUgY2hlY2sgZmFpbGVkIGZvciBwcm9wIFwiJHtuYW1lfVwiLmAgK1xyXG4gICAgICAgIGAgRXhwZWN0ZWQgJHtleHBlY3RlZFR5cGVzLm1hcChjYXBpdGFsaXplKS5qb2luKCcgfCAnKX1gO1xyXG4gICAgY29uc3QgZXhwZWN0ZWRUeXBlID0gZXhwZWN0ZWRUeXBlc1swXTtcclxuICAgIGNvbnN0IHJlY2VpdmVkVHlwZSA9IHRvUmF3VHlwZSh2YWx1ZSk7XHJcbiAgICBjb25zdCBleHBlY3RlZFZhbHVlID0gc3R5bGVWYWx1ZSh2YWx1ZSwgZXhwZWN0ZWRUeXBlKTtcclxuICAgIGNvbnN0IHJlY2VpdmVkVmFsdWUgPSBzdHlsZVZhbHVlKHZhbHVlLCByZWNlaXZlZFR5cGUpO1xyXG4gICAgLy8gY2hlY2sgaWYgd2UgbmVlZCB0byBzcGVjaWZ5IGV4cGVjdGVkIHZhbHVlXHJcbiAgICBpZiAoZXhwZWN0ZWRUeXBlcy5sZW5ndGggPT09IDEgJiZcclxuICAgICAgICBpc0V4cGxpY2FibGUoZXhwZWN0ZWRUeXBlKSAmJlxyXG4gICAgICAgICFpc0Jvb2xlYW4oZXhwZWN0ZWRUeXBlLCByZWNlaXZlZFR5cGUpKSB7XHJcbiAgICAgICAgbWVzc2FnZSArPSBgIHdpdGggdmFsdWUgJHtleHBlY3RlZFZhbHVlfWA7XHJcbiAgICB9XHJcbiAgICBtZXNzYWdlICs9IGAsIGdvdCAke3JlY2VpdmVkVHlwZX0gYDtcclxuICAgIC8vIGNoZWNrIGlmIHdlIG5lZWQgdG8gc3BlY2lmeSByZWNlaXZlZCB2YWx1ZVxyXG4gICAgaWYgKGlzRXhwbGljYWJsZShyZWNlaXZlZFR5cGUpKSB7XHJcbiAgICAgICAgbWVzc2FnZSArPSBgd2l0aCB2YWx1ZSAke3JlY2VpdmVkVmFsdWV9LmA7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbWVzc2FnZTtcclxufVxyXG4vKipcclxuICogZGV2IG9ubHlcclxuICovXHJcbmZ1bmN0aW9uIHN0eWxlVmFsdWUodmFsdWUsIHR5cGUpIHtcclxuICAgIGlmICh0eXBlID09PSAnU3RyaW5nJykge1xyXG4gICAgICAgIHJldHVybiBgXCIke3ZhbHVlfVwiYDtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKHR5cGUgPT09ICdOdW1iZXInKSB7XHJcbiAgICAgICAgcmV0dXJuIGAke051bWJlcih2YWx1ZSl9YDtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBgJHt2YWx1ZX1gO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBkZXYgb25seVxyXG4gKi9cclxuZnVuY3Rpb24gaXNFeHBsaWNhYmxlKHR5cGUpIHtcclxuICAgIGNvbnN0IGV4cGxpY2l0VHlwZXMgPSBbJ3N0cmluZycsICdudW1iZXInLCAnYm9vbGVhbiddO1xyXG4gICAgcmV0dXJuIGV4cGxpY2l0VHlwZXMuc29tZShlbGVtID0+IHR5cGUudG9Mb3dlckNhc2UoKSA9PT0gZWxlbSk7XHJcbn1cclxuLyoqXHJcbiAqIGRldiBvbmx5XHJcbiAqL1xyXG5mdW5jdGlvbiBpc0Jvb2xlYW4oLi4uYXJncykge1xyXG4gICAgcmV0dXJuIGFyZ3Muc29tZShlbGVtID0+IGVsZW0udG9Mb3dlckNhc2UoKSA9PT0gJ2Jvb2xlYW4nKTtcclxufVxuXG5jb25zdCBpc0ludGVybmFsS2V5ID0gKGtleSkgPT4ga2V5WzBdID09PSAnXycgfHwga2V5ID09PSAnJHN0YWJsZSc7XHJcbmNvbnN0IG5vcm1hbGl6ZVNsb3RWYWx1ZSA9ICh2YWx1ZSkgPT4gaXNBcnJheSh2YWx1ZSlcclxuICAgID8gdmFsdWUubWFwKG5vcm1hbGl6ZVZOb2RlKVxyXG4gICAgOiBbbm9ybWFsaXplVk5vZGUodmFsdWUpXTtcclxuY29uc3Qgbm9ybWFsaXplU2xvdCA9IChrZXksIHJhd1Nsb3QsIGN0eCkgPT4ge1xyXG4gICAgY29uc3Qgbm9ybWFsaXplZCA9IHdpdGhDdHgoKC4uLmFyZ3MpID0+IHtcclxuICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmIGN1cnJlbnRJbnN0YW5jZSkge1xyXG4gICAgICAgICAgICB3YXJuKGBTbG90IFwiJHtrZXl9XCIgaW52b2tlZCBvdXRzaWRlIG9mIHRoZSByZW5kZXIgZnVuY3Rpb246IGAgK1xyXG4gICAgICAgICAgICAgICAgYHRoaXMgd2lsbCBub3QgdHJhY2sgZGVwZW5kZW5jaWVzIHVzZWQgaW4gdGhlIHNsb3QuIGAgK1xyXG4gICAgICAgICAgICAgICAgYEludm9rZSB0aGUgc2xvdCBmdW5jdGlvbiBpbnNpZGUgdGhlIHJlbmRlciBmdW5jdGlvbiBpbnN0ZWFkLmApO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbm9ybWFsaXplU2xvdFZhbHVlKHJhd1Nsb3QoLi4uYXJncykpO1xyXG4gICAgfSwgY3R4KTtcclxuICAgIG5vcm1hbGl6ZWQuX2MgPSBmYWxzZTtcclxuICAgIHJldHVybiBub3JtYWxpemVkO1xyXG59O1xyXG5jb25zdCBub3JtYWxpemVPYmplY3RTbG90cyA9IChyYXdTbG90cywgc2xvdHMsIGluc3RhbmNlKSA9PiB7XHJcbiAgICBjb25zdCBjdHggPSByYXdTbG90cy5fY3R4O1xyXG4gICAgZm9yIChjb25zdCBrZXkgaW4gcmF3U2xvdHMpIHtcclxuICAgICAgICBpZiAoaXNJbnRlcm5hbEtleShrZXkpKVxyXG4gICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICBjb25zdCB2YWx1ZSA9IHJhd1Nsb3RzW2tleV07XHJcbiAgICAgICAgaWYgKGlzRnVuY3Rpb24odmFsdWUpKSB7XHJcbiAgICAgICAgICAgIHNsb3RzW2tleV0gPSBub3JtYWxpemVTbG90KGtleSwgdmFsdWUsIGN0eCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHZhbHVlICE9IG51bGwpIHtcclxuICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJlxyXG4gICAgICAgICAgICAgICAgIShmYWxzZSApKSB7XHJcbiAgICAgICAgICAgICAgICB3YXJuKGBOb24tZnVuY3Rpb24gdmFsdWUgZW5jb3VudGVyZWQgZm9yIHNsb3QgXCIke2tleX1cIi4gYCArXHJcbiAgICAgICAgICAgICAgICAgICAgYFByZWZlciBmdW5jdGlvbiBzbG90cyBmb3IgYmV0dGVyIHBlcmZvcm1hbmNlLmApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IG5vcm1hbGl6ZWQgPSBub3JtYWxpemVTbG90VmFsdWUodmFsdWUpO1xyXG4gICAgICAgICAgICBzbG90c1trZXldID0gKCkgPT4gbm9ybWFsaXplZDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn07XHJcbmNvbnN0IG5vcm1hbGl6ZVZOb2RlU2xvdHMgPSAoaW5zdGFuY2UsIGNoaWxkcmVuKSA9PiB7XHJcbiAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmXHJcbiAgICAgICAgIWlzS2VlcEFsaXZlKGluc3RhbmNlLnZub2RlKSAmJlxyXG4gICAgICAgICEoZmFsc2UgKSkge1xyXG4gICAgICAgIHdhcm4oYE5vbi1mdW5jdGlvbiB2YWx1ZSBlbmNvdW50ZXJlZCBmb3IgZGVmYXVsdCBzbG90LiBgICtcclxuICAgICAgICAgICAgYFByZWZlciBmdW5jdGlvbiBzbG90cyBmb3IgYmV0dGVyIHBlcmZvcm1hbmNlLmApO1xyXG4gICAgfVxyXG4gICAgY29uc3Qgbm9ybWFsaXplZCA9IG5vcm1hbGl6ZVNsb3RWYWx1ZShjaGlsZHJlbik7XHJcbiAgICBpbnN0YW5jZS5zbG90cy5kZWZhdWx0ID0gKCkgPT4gbm9ybWFsaXplZDtcclxufTtcclxuY29uc3QgaW5pdFNsb3RzID0gKGluc3RhbmNlLCBjaGlsZHJlbikgPT4ge1xyXG4gICAgaWYgKGluc3RhbmNlLnZub2RlLnNoYXBlRmxhZyAmIDMyIC8qIFNMT1RTX0NISUxEUkVOICovKSB7XHJcbiAgICAgICAgY29uc3QgdHlwZSA9IGNoaWxkcmVuLl87XHJcbiAgICAgICAgaWYgKHR5cGUpIHtcclxuICAgICAgICAgICAgLy8gdXNlcnMgY2FuIGdldCB0aGUgc2hhbGxvdyByZWFkb25seSB2ZXJzaW9uIG9mIHRoZSBzbG90cyBvYmplY3QgdGhyb3VnaCBgdGhpcy4kc2xvdHNgLFxyXG4gICAgICAgICAgICAvLyB3ZSBzaG91bGQgYXZvaWQgdGhlIHByb3h5IG9iamVjdCBwb2xsdXRpbmcgdGhlIHNsb3RzIG9mIHRoZSBpbnRlcm5hbCBpbnN0YW5jZVxyXG4gICAgICAgICAgICBpbnN0YW5jZS5zbG90cyA9IHRvUmF3KGNoaWxkcmVuKTtcclxuICAgICAgICAgICAgLy8gbWFrZSBjb21waWxlciBtYXJrZXIgbm9uLWVudW1lcmFibGVcclxuICAgICAgICAgICAgZGVmKGNoaWxkcmVuLCAnXycsIHR5cGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgbm9ybWFsaXplT2JqZWN0U2xvdHMoY2hpbGRyZW4sIChpbnN0YW5jZS5zbG90cyA9IHt9KSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgaW5zdGFuY2Uuc2xvdHMgPSB7fTtcclxuICAgICAgICBpZiAoY2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgbm9ybWFsaXplVk5vZGVTbG90cyhpbnN0YW5jZSwgY2hpbGRyZW4pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGRlZihpbnN0YW5jZS5zbG90cywgSW50ZXJuYWxPYmplY3RLZXksIDEpO1xyXG59O1xyXG5jb25zdCB1cGRhdGVTbG90cyA9IChpbnN0YW5jZSwgY2hpbGRyZW4sIG9wdGltaXplZCkgPT4ge1xyXG4gICAgY29uc3QgeyB2bm9kZSwgc2xvdHMgfSA9IGluc3RhbmNlO1xyXG4gICAgbGV0IG5lZWREZWxldGlvbkNoZWNrID0gdHJ1ZTtcclxuICAgIGxldCBkZWxldGlvbkNvbXBhcmlzb25UYXJnZXQgPSBFTVBUWV9PQko7XHJcbiAgICBpZiAodm5vZGUuc2hhcGVGbGFnICYgMzIgLyogU0xPVFNfQ0hJTERSRU4gKi8pIHtcclxuICAgICAgICBjb25zdCB0eXBlID0gY2hpbGRyZW4uXztcclxuICAgICAgICBpZiAodHlwZSkge1xyXG4gICAgICAgICAgICAvLyBjb21waWxlZCBzbG90cy5cclxuICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiBpc0htclVwZGF0aW5nKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBQYXJlbnQgd2FzIEhNUiB1cGRhdGVkIHNvIHNsb3QgY29udGVudCBtYXkgaGF2ZSBjaGFuZ2VkLlxyXG4gICAgICAgICAgICAgICAgLy8gZm9yY2UgdXBkYXRlIHNsb3RzIGFuZCBtYXJrIGluc3RhbmNlIGZvciBobXIgYXMgd2VsbFxyXG4gICAgICAgICAgICAgICAgZXh0ZW5kKHNsb3RzLCBjaGlsZHJlbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAob3B0aW1pemVkICYmIHR5cGUgPT09IDEgLyogU1RBQkxFICovKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBjb21waWxlZCBBTkQgc3RhYmxlLlxyXG4gICAgICAgICAgICAgICAgLy8gbm8gbmVlZCB0byB1cGRhdGUsIGFuZCBza2lwIHN0YWxlIHNsb3RzIHJlbW92YWwuXHJcbiAgICAgICAgICAgICAgICBuZWVkRGVsZXRpb25DaGVjayA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gY29tcGlsZWQgYnV0IGR5bmFtaWMgKHYtaWYvdi1mb3Igb24gc2xvdHMpIC0gdXBkYXRlIHNsb3RzLCBidXQgc2tpcFxyXG4gICAgICAgICAgICAgICAgLy8gbm9ybWFsaXphdGlvbi5cclxuICAgICAgICAgICAgICAgIGV4dGVuZChzbG90cywgY2hpbGRyZW4pO1xyXG4gICAgICAgICAgICAgICAgLy8gIzI4OTNcclxuICAgICAgICAgICAgICAgIC8vIHdoZW4gcmVuZGVyaW5nIHRoZSBvcHRpbWl6ZWQgc2xvdHMgYnkgbWFudWFsbHkgd3JpdHRlbiByZW5kZXIgZnVuY3Rpb24sXHJcbiAgICAgICAgICAgICAgICAvLyB3ZSBuZWVkIHRvIGRlbGV0ZSB0aGUgYHNsb3RzLl9gIGZsYWcgaWYgbmVjZXNzYXJ5IHRvIG1ha2Ugc3Vic2VxdWVudCB1cGRhdGVzIHJlbGlhYmxlLFxyXG4gICAgICAgICAgICAgICAgLy8gaS5lLiBsZXQgdGhlIGByZW5kZXJTbG90YCBjcmVhdGUgdGhlIGJhaWxlZCBGcmFnbWVudFxyXG4gICAgICAgICAgICAgICAgaWYgKCFvcHRpbWl6ZWQgJiYgdHlwZSA9PT0gMSAvKiBTVEFCTEUgKi8pIHtcclxuICAgICAgICAgICAgICAgICAgICBkZWxldGUgc2xvdHMuXztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgbmVlZERlbGV0aW9uQ2hlY2sgPSAhY2hpbGRyZW4uJHN0YWJsZTtcclxuICAgICAgICAgICAgbm9ybWFsaXplT2JqZWN0U2xvdHMoY2hpbGRyZW4sIHNsb3RzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZGVsZXRpb25Db21wYXJpc29uVGFyZ2V0ID0gY2hpbGRyZW47XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChjaGlsZHJlbikge1xyXG4gICAgICAgIC8vIG5vbiBzbG90IG9iamVjdCBjaGlsZHJlbiAoZGlyZWN0IHZhbHVlKSBwYXNzZWQgdG8gYSBjb21wb25lbnRcclxuICAgICAgICBub3JtYWxpemVWTm9kZVNsb3RzKGluc3RhbmNlLCBjaGlsZHJlbik7XHJcbiAgICAgICAgZGVsZXRpb25Db21wYXJpc29uVGFyZ2V0ID0geyBkZWZhdWx0OiAxIH07XHJcbiAgICB9XHJcbiAgICAvLyBkZWxldGUgc3RhbGUgc2xvdHNcclxuICAgIGlmIChuZWVkRGVsZXRpb25DaGVjaykge1xyXG4gICAgICAgIGZvciAoY29uc3Qga2V5IGluIHNsb3RzKSB7XHJcbiAgICAgICAgICAgIGlmICghaXNJbnRlcm5hbEtleShrZXkpICYmICEoa2V5IGluIGRlbGV0aW9uQ29tcGFyaXNvblRhcmdldCkpIHtcclxuICAgICAgICAgICAgICAgIGRlbGV0ZSBzbG90c1trZXldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xuXG4vKipcclxuUnVudGltZSBoZWxwZXIgZm9yIGFwcGx5aW5nIGRpcmVjdGl2ZXMgdG8gYSB2bm9kZS4gRXhhbXBsZSB1c2FnZTpcclxuXG5jb25zdCBjb21wID0gcmVzb2x2ZUNvbXBvbmVudCgnY29tcCcpXHJcbmNvbnN0IGZvbyA9IHJlc29sdmVEaXJlY3RpdmUoJ2ZvbycpXHJcbmNvbnN0IGJhciA9IHJlc29sdmVEaXJlY3RpdmUoJ2JhcicpXHJcblxucmV0dXJuIHdpdGhEaXJlY3RpdmVzKGgoY29tcCksIFtcclxuICBbZm9vLCB0aGlzLnhdLFxyXG4gIFtiYXIsIHRoaXMueV1cclxuXSlcclxuKi9cclxuZnVuY3Rpb24gdmFsaWRhdGVEaXJlY3RpdmVOYW1lKG5hbWUpIHtcclxuICAgIGlmIChpc0J1aWx0SW5EaXJlY3RpdmUobmFtZSkpIHtcclxuICAgICAgICB3YXJuKCdEbyBub3QgdXNlIGJ1aWx0LWluIGRpcmVjdGl2ZSBpZHMgYXMgY3VzdG9tIGRpcmVjdGl2ZSBpZDogJyArIG5hbWUpO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBBZGRzIGRpcmVjdGl2ZXMgdG8gYSBWTm9kZS5cclxuICovXHJcbmZ1bmN0aW9uIHdpdGhEaXJlY3RpdmVzKHZub2RlLCBkaXJlY3RpdmVzKSB7XHJcbiAgICBjb25zdCBpbnRlcm5hbEluc3RhbmNlID0gY3VycmVudFJlbmRlcmluZ0luc3RhbmNlO1xyXG4gICAgaWYgKGludGVybmFsSW5zdGFuY2UgPT09IG51bGwpIHtcclxuICAgICAgICAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiYgd2Fybihgd2l0aERpcmVjdGl2ZXMgY2FuIG9ubHkgYmUgdXNlZCBpbnNpZGUgcmVuZGVyIGZ1bmN0aW9ucy5gKTtcclxuICAgICAgICByZXR1cm4gdm5vZGU7XHJcbiAgICB9XHJcbiAgICBjb25zdCBpbnN0YW5jZSA9IGludGVybmFsSW5zdGFuY2UucHJveHk7XHJcbiAgICBjb25zdCBiaW5kaW5ncyA9IHZub2RlLmRpcnMgfHwgKHZub2RlLmRpcnMgPSBbXSk7XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRpcmVjdGl2ZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBsZXQgW2RpciwgdmFsdWUsIGFyZywgbW9kaWZpZXJzID0gRU1QVFlfT0JKXSA9IGRpcmVjdGl2ZXNbaV07XHJcbiAgICAgICAgaWYgKGlzRnVuY3Rpb24oZGlyKSkge1xyXG4gICAgICAgICAgICBkaXIgPSB7XHJcbiAgICAgICAgICAgICAgICBtb3VudGVkOiBkaXIsXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkOiBkaXJcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGRpci5kZWVwKSB7XHJcbiAgICAgICAgICAgIHRyYXZlcnNlKHZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgYmluZGluZ3MucHVzaCh7XHJcbiAgICAgICAgICAgIGRpcixcclxuICAgICAgICAgICAgaW5zdGFuY2UsXHJcbiAgICAgICAgICAgIHZhbHVlLFxyXG4gICAgICAgICAgICBvbGRWYWx1ZTogdm9pZCAwLFxyXG4gICAgICAgICAgICBhcmcsXHJcbiAgICAgICAgICAgIG1vZGlmaWVyc1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHZub2RlO1xyXG59XHJcbmZ1bmN0aW9uIGludm9rZURpcmVjdGl2ZUhvb2sodm5vZGUsIHByZXZWTm9kZSwgaW5zdGFuY2UsIG5hbWUpIHtcclxuICAgIGNvbnN0IGJpbmRpbmdzID0gdm5vZGUuZGlycztcclxuICAgIGNvbnN0IG9sZEJpbmRpbmdzID0gcHJldlZOb2RlICYmIHByZXZWTm9kZS5kaXJzO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBiaW5kaW5ncy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGNvbnN0IGJpbmRpbmcgPSBiaW5kaW5nc1tpXTtcclxuICAgICAgICBpZiAob2xkQmluZGluZ3MpIHtcclxuICAgICAgICAgICAgYmluZGluZy5vbGRWYWx1ZSA9IG9sZEJpbmRpbmdzW2ldLnZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgaG9vayA9IGJpbmRpbmcuZGlyW25hbWVdO1xyXG4gICAgICAgIGlmIChob29rKSB7XHJcbiAgICAgICAgICAgIC8vIGRpc2FibGUgdHJhY2tpbmcgaW5zaWRlIGFsbCBsaWZlY3ljbGUgaG9va3NcclxuICAgICAgICAgICAgLy8gc2luY2UgdGhleSBjYW4gcG90ZW50aWFsbHkgYmUgY2FsbGVkIGluc2lkZSBlZmZlY3RzLlxyXG4gICAgICAgICAgICBwYXVzZVRyYWNraW5nKCk7XHJcbiAgICAgICAgICAgIGNhbGxXaXRoQXN5bmNFcnJvckhhbmRsaW5nKGhvb2ssIGluc3RhbmNlLCA4IC8qIERJUkVDVElWRV9IT09LICovLCBbXHJcbiAgICAgICAgICAgICAgICB2bm9kZS5lbCxcclxuICAgICAgICAgICAgICAgIGJpbmRpbmcsXHJcbiAgICAgICAgICAgICAgICB2bm9kZSxcclxuICAgICAgICAgICAgICAgIHByZXZWTm9kZVxyXG4gICAgICAgICAgICBdKTtcclxuICAgICAgICAgICAgcmVzZXRUcmFja2luZygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxuXG5mdW5jdGlvbiBjcmVhdGVBcHBDb250ZXh0KCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBhcHA6IG51bGwsXHJcbiAgICAgICAgY29uZmlnOiB7XHJcbiAgICAgICAgICAgIGlzTmF0aXZlVGFnOiBOTyxcclxuICAgICAgICAgICAgcGVyZm9ybWFuY2U6IGZhbHNlLFxyXG4gICAgICAgICAgICBnbG9iYWxQcm9wZXJ0aWVzOiB7fSxcclxuICAgICAgICAgICAgb3B0aW9uTWVyZ2VTdHJhdGVnaWVzOiB7fSxcclxuICAgICAgICAgICAgZXJyb3JIYW5kbGVyOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICAgIHdhcm5IYW5kbGVyOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICAgIGNvbXBpbGVyT3B0aW9uczoge31cclxuICAgICAgICB9LFxyXG4gICAgICAgIG1peGluczogW10sXHJcbiAgICAgICAgY29tcG9uZW50czoge30sXHJcbiAgICAgICAgZGlyZWN0aXZlczoge30sXHJcbiAgICAgICAgcHJvdmlkZXM6IE9iamVjdC5jcmVhdGUobnVsbCksXHJcbiAgICAgICAgb3B0aW9uc0NhY2hlOiBuZXcgV2Vha01hcCgpLFxyXG4gICAgICAgIHByb3BzQ2FjaGU6IG5ldyBXZWFrTWFwKCksXHJcbiAgICAgICAgZW1pdHNDYWNoZTogbmV3IFdlYWtNYXAoKVxyXG4gICAgfTtcclxufVxyXG5sZXQgdWlkID0gMDtcclxuZnVuY3Rpb24gY3JlYXRlQXBwQVBJKHJlbmRlciwgaHlkcmF0ZSkge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIGNyZWF0ZUFwcChyb290Q29tcG9uZW50LCByb290UHJvcHMgPSBudWxsKSB7XHJcbiAgICAgICAgaWYgKHJvb3RQcm9wcyAhPSBudWxsICYmICFpc09iamVjdChyb290UHJvcHMpKSB7XHJcbiAgICAgICAgICAgIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiB3YXJuKGByb290IHByb3BzIHBhc3NlZCB0byBhcHAubW91bnQoKSBtdXN0IGJlIGFuIG9iamVjdC5gKTtcclxuICAgICAgICAgICAgcm9vdFByb3BzID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgY29udGV4dCA9IGNyZWF0ZUFwcENvbnRleHQoKTtcclxuICAgICAgICBjb25zdCBpbnN0YWxsZWRQbHVnaW5zID0gbmV3IFNldCgpO1xyXG4gICAgICAgIGxldCBpc01vdW50ZWQgPSBmYWxzZTtcclxuICAgICAgICBjb25zdCBhcHAgPSAoY29udGV4dC5hcHAgPSB7XHJcbiAgICAgICAgICAgIF91aWQ6IHVpZCsrLFxyXG4gICAgICAgICAgICBfY29tcG9uZW50OiByb290Q29tcG9uZW50LFxyXG4gICAgICAgICAgICBfcHJvcHM6IHJvb3RQcm9wcyxcclxuICAgICAgICAgICAgX2NvbnRhaW5lcjogbnVsbCxcclxuICAgICAgICAgICAgX2NvbnRleHQ6IGNvbnRleHQsXHJcbiAgICAgICAgICAgIF9pbnN0YW5jZTogbnVsbCxcclxuICAgICAgICAgICAgdmVyc2lvbixcclxuICAgICAgICAgICAgZ2V0IGNvbmZpZygpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjb250ZXh0LmNvbmZpZztcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgc2V0IGNvbmZpZyh2KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgd2FybihgYXBwLmNvbmZpZyBjYW5ub3QgYmUgcmVwbGFjZWQuIE1vZGlmeSBpbmRpdmlkdWFsIG9wdGlvbnMgaW5zdGVhZC5gKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgdXNlKHBsdWdpbiwgLi4ub3B0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGluc3RhbGxlZFBsdWdpbnMuaGFzKHBsdWdpbikpIHtcclxuICAgICAgICAgICAgICAgICAgICAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiYgd2FybihgUGx1Z2luIGhhcyBhbHJlYWR5IGJlZW4gYXBwbGllZCB0byB0YXJnZXQgYXBwLmApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAocGx1Z2luICYmIGlzRnVuY3Rpb24ocGx1Z2luLmluc3RhbGwpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5zdGFsbGVkUGx1Z2lucy5hZGQocGx1Z2luKTtcclxuICAgICAgICAgICAgICAgICAgICBwbHVnaW4uaW5zdGFsbChhcHAsIC4uLm9wdGlvbnMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoaXNGdW5jdGlvbihwbHVnaW4pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5zdGFsbGVkUGx1Z2lucy5hZGQocGx1Z2luKTtcclxuICAgICAgICAgICAgICAgICAgICBwbHVnaW4oYXBwLCAuLi5vcHRpb25zKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHdhcm4oYEEgcGx1Z2luIG11c3QgZWl0aGVyIGJlIGEgZnVuY3Rpb24gb3IgYW4gb2JqZWN0IHdpdGggYW4gXCJpbnN0YWxsXCIgYCArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGBmdW5jdGlvbi5gKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBhcHA7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIG1peGluKG1peGluKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoX19WVUVfT1BUSU9OU19BUElfXykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghY29udGV4dC5taXhpbnMuaW5jbHVkZXMobWl4aW4pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQubWl4aW5zLnB1c2gobWl4aW4pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2FybignTWl4aW4gaGFzIGFscmVhZHkgYmVlbiBhcHBsaWVkIHRvIHRhcmdldCBhcHAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChtaXhpbi5uYW1lID8gYDogJHttaXhpbi5uYW1lfWAgOiAnJykpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHdhcm4oJ01peGlucyBhcmUgb25seSBhdmFpbGFibGUgaW4gYnVpbGRzIHN1cHBvcnRpbmcgT3B0aW9ucyBBUEknKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBhcHA7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGNvbXBvbmVudChuYW1lLCBjb21wb25lbnQpIHtcclxuICAgICAgICAgICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YWxpZGF0ZUNvbXBvbmVudE5hbWUobmFtZSwgY29udGV4dC5jb25maWcpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCFjb21wb25lbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29udGV4dC5jb21wb25lbnRzW25hbWVdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiBjb250ZXh0LmNvbXBvbmVudHNbbmFtZV0pIHtcclxuICAgICAgICAgICAgICAgICAgICB3YXJuKGBDb21wb25lbnQgXCIke25hbWV9XCIgaGFzIGFscmVhZHkgYmVlbiByZWdpc3RlcmVkIGluIHRhcmdldCBhcHAuYCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmNvbXBvbmVudHNbbmFtZV0gPSBjb21wb25lbnQ7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYXBwO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBkaXJlY3RpdmUobmFtZSwgZGlyZWN0aXZlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFsaWRhdGVEaXJlY3RpdmVOYW1lKG5hbWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCFkaXJlY3RpdmUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29udGV4dC5kaXJlY3RpdmVzW25hbWVdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiBjb250ZXh0LmRpcmVjdGl2ZXNbbmFtZV0pIHtcclxuICAgICAgICAgICAgICAgICAgICB3YXJuKGBEaXJlY3RpdmUgXCIke25hbWV9XCIgaGFzIGFscmVhZHkgYmVlbiByZWdpc3RlcmVkIGluIHRhcmdldCBhcHAuYCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmRpcmVjdGl2ZXNbbmFtZV0gPSBkaXJlY3RpdmU7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYXBwO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBtb3VudChyb290Q29udGFpbmVyLCBpc0h5ZHJhdGUsIGlzU1ZHKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWlzTW91bnRlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHZub2RlID0gY3JlYXRlVk5vZGUocm9vdENvbXBvbmVudCwgcm9vdFByb3BzKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyBzdG9yZSBhcHAgY29udGV4dCBvbiB0aGUgcm9vdCBWTm9kZS5cclxuICAgICAgICAgICAgICAgICAgICAvLyB0aGlzIHdpbGwgYmUgc2V0IG9uIHRoZSByb290IGluc3RhbmNlIG9uIGluaXRpYWwgbW91bnQuXHJcbiAgICAgICAgICAgICAgICAgICAgdm5vZGUuYXBwQ29udGV4dCA9IGNvbnRleHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gSE1SIHJvb3QgcmVsb2FkXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0LnJlbG9hZCA9ICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbmRlcihjbG9uZVZOb2RlKHZub2RlKSwgcm9vdENvbnRhaW5lciwgaXNTVkcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNIeWRyYXRlICYmIGh5ZHJhdGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaHlkcmF0ZSh2bm9kZSwgcm9vdENvbnRhaW5lcik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZW5kZXIodm5vZGUsIHJvb3RDb250YWluZXIsIGlzU1ZHKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaXNNb3VudGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBhcHAuX2NvbnRhaW5lciA9IHJvb3RDb250YWluZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgcm9vdENvbnRhaW5lci5fX3Z1ZV9hcHBfXyA9IGFwcDtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHx8IF9fVlVFX1BST0RfREVWVE9PTFNfXykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhcHAuX2luc3RhbmNlID0gdm5vZGUuY29tcG9uZW50O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXZ0b29sc0luaXRBcHAoYXBwLCB2ZXJzaW9uKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldEV4cG9zZVByb3h5KHZub2RlLmNvbXBvbmVudCkgfHwgdm5vZGUuY29tcG9uZW50LnByb3h5O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgd2FybihgQXBwIGhhcyBhbHJlYWR5IGJlZW4gbW91bnRlZC5cXG5gICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYElmIHlvdSB3YW50IHRvIHJlbW91bnQgdGhlIHNhbWUgYXBwLCBtb3ZlIHlvdXIgYXBwIGNyZWF0aW9uIGxvZ2ljIGAgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBgaW50byBhIGZhY3RvcnkgZnVuY3Rpb24gYW5kIGNyZWF0ZSBmcmVzaCBhcHAgaW5zdGFuY2VzIGZvciBlYWNoIGAgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBgbW91bnQgLSBlLmcuIFxcYGNvbnN0IGNyZWF0ZU15QXBwID0gKCkgPT4gY3JlYXRlQXBwKEFwcClcXGBgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgdW5tb3VudCgpIHtcclxuICAgICAgICAgICAgICAgIGlmIChpc01vdW50ZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZW5kZXIobnVsbCwgYXBwLl9jb250YWluZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgfHwgX19WVUVfUFJPRF9ERVZUT09MU19fKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFwcC5faW5zdGFuY2UgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXZ0b29sc1VubW91bnRBcHAoYXBwKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGFwcC5fY29udGFpbmVyLl9fdnVlX2FwcF9fO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgd2FybihgQ2Fubm90IHVubW91bnQgYW4gYXBwIHRoYXQgaXMgbm90IG1vdW50ZWQuYCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHByb3ZpZGUoa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiBrZXkgaW4gY29udGV4dC5wcm92aWRlcykge1xyXG4gICAgICAgICAgICAgICAgICAgIHdhcm4oYEFwcCBhbHJlYWR5IHByb3ZpZGVzIHByb3BlcnR5IHdpdGgga2V5IFwiJHtTdHJpbmcoa2V5KX1cIi4gYCArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGBJdCB3aWxsIGJlIG92ZXJ3cml0dGVuIHdpdGggdGhlIG5ldyB2YWx1ZS5gKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIFR5cGVTY3JpcHQgZG9lc24ndCBhbGxvdyBzeW1ib2xzIGFzIGluZGV4IHR5cGVcclxuICAgICAgICAgICAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9NaWNyb3NvZnQvVHlwZVNjcmlwdC9pc3N1ZXMvMjQ1ODdcclxuICAgICAgICAgICAgICAgIGNvbnRleHQucHJvdmlkZXNba2V5XSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGFwcDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBhcHA7XHJcbiAgICB9O1xyXG59XG5cbi8qKlxyXG4gKiBGdW5jdGlvbiBmb3IgaGFuZGxpbmcgYSB0ZW1wbGF0ZSByZWZcclxuICovXHJcbmZ1bmN0aW9uIHNldFJlZihyYXdSZWYsIG9sZFJhd1JlZiwgcGFyZW50U3VzcGVuc2UsIHZub2RlLCBpc1VubW91bnQgPSBmYWxzZSkge1xyXG4gICAgaWYgKGlzQXJyYXkocmF3UmVmKSkge1xyXG4gICAgICAgIHJhd1JlZi5mb3JFYWNoKChyLCBpKSA9PiBzZXRSZWYociwgb2xkUmF3UmVmICYmIChpc0FycmF5KG9sZFJhd1JlZikgPyBvbGRSYXdSZWZbaV0gOiBvbGRSYXdSZWYpLCBwYXJlbnRTdXNwZW5zZSwgdm5vZGUsIGlzVW5tb3VudCkpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGlmIChpc0FzeW5jV3JhcHBlcih2bm9kZSkgJiYgIWlzVW5tb3VudCkge1xyXG4gICAgICAgIC8vIHdoZW4gbW91bnRpbmcgYXN5bmMgY29tcG9uZW50cywgbm90aGluZyBuZWVkcyB0byBiZSBkb25lLFxyXG4gICAgICAgIC8vIGJlY2F1c2UgdGhlIHRlbXBsYXRlIHJlZiBpcyBmb3J3YXJkZWQgdG8gaW5uZXIgY29tcG9uZW50XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgY29uc3QgcmVmVmFsdWUgPSB2bm9kZS5zaGFwZUZsYWcgJiA0IC8qIFNUQVRFRlVMX0NPTVBPTkVOVCAqL1xyXG4gICAgICAgID8gZ2V0RXhwb3NlUHJveHkodm5vZGUuY29tcG9uZW50KSB8fCB2bm9kZS5jb21wb25lbnQucHJveHlcclxuICAgICAgICA6IHZub2RlLmVsO1xyXG4gICAgY29uc3QgdmFsdWUgPSBpc1VubW91bnQgPyBudWxsIDogcmVmVmFsdWU7XHJcbiAgICBjb25zdCB7IGk6IG93bmVyLCByOiByZWYgfSA9IHJhd1JlZjtcclxuICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiYgIW93bmVyKSB7XHJcbiAgICAgICAgd2FybihgTWlzc2luZyByZWYgb3duZXIgY29udGV4dC4gcmVmIGNhbm5vdCBiZSB1c2VkIG9uIGhvaXN0ZWQgdm5vZGVzLiBgICtcclxuICAgICAgICAgICAgYEEgdm5vZGUgd2l0aCByZWYgbXVzdCBiZSBjcmVhdGVkIGluc2lkZSB0aGUgcmVuZGVyIGZ1bmN0aW9uLmApO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IG9sZFJlZiA9IG9sZFJhd1JlZiAmJiBvbGRSYXdSZWYucjtcclxuICAgIGNvbnN0IHJlZnMgPSBvd25lci5yZWZzID09PSBFTVBUWV9PQkogPyAob3duZXIucmVmcyA9IHt9KSA6IG93bmVyLnJlZnM7XHJcbiAgICBjb25zdCBzZXR1cFN0YXRlID0gb3duZXIuc2V0dXBTdGF0ZTtcclxuICAgIC8vIGR5bmFtaWMgcmVmIGNoYW5nZWQuIHVuc2V0IG9sZCByZWZcclxuICAgIGlmIChvbGRSZWYgIT0gbnVsbCAmJiBvbGRSZWYgIT09IHJlZikge1xyXG4gICAgICAgIGlmIChpc1N0cmluZyhvbGRSZWYpKSB7XHJcbiAgICAgICAgICAgIHJlZnNbb2xkUmVmXSA9IG51bGw7XHJcbiAgICAgICAgICAgIGlmIChoYXNPd24oc2V0dXBTdGF0ZSwgb2xkUmVmKSkge1xyXG4gICAgICAgICAgICAgICAgc2V0dXBTdGF0ZVtvbGRSZWZdID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChpc1JlZihvbGRSZWYpKSB7XHJcbiAgICAgICAgICAgIG9sZFJlZi52YWx1ZSA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYgKGlzRnVuY3Rpb24ocmVmKSkge1xyXG4gICAgICAgIGNhbGxXaXRoRXJyb3JIYW5kbGluZyhyZWYsIG93bmVyLCAxMiAvKiBGVU5DVElPTl9SRUYgKi8sIFt2YWx1ZSwgcmVmc10pO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgY29uc3QgX2lzU3RyaW5nID0gaXNTdHJpbmcocmVmKTtcclxuICAgICAgICBjb25zdCBfaXNSZWYgPSBpc1JlZihyZWYpO1xyXG4gICAgICAgIGlmIChfaXNTdHJpbmcgfHwgX2lzUmVmKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGRvU2V0ID0gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJhd1JlZi5mKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZXhpc3RpbmcgPSBfaXNTdHJpbmcgPyByZWZzW3JlZl0gOiByZWYudmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzVW5tb3VudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpc0FycmF5KGV4aXN0aW5nKSAmJiByZW1vdmUoZXhpc3RpbmcsIHJlZlZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNBcnJheShleGlzdGluZykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfaXNTdHJpbmcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWZzW3JlZl0gPSBbcmVmVmFsdWVdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmLnZhbHVlID0gW3JlZlZhbHVlXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmF3UmVmLmspXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZnNbcmF3UmVmLmtdID0gcmVmLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKCFleGlzdGluZy5pbmNsdWRlcyhyZWZWYWx1ZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4aXN0aW5nLnB1c2gocmVmVmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoX2lzU3RyaW5nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVmc1tyZWZdID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGhhc093bihzZXR1cFN0YXRlLCByZWYpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldHVwU3RhdGVbcmVmXSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGlzUmVmKHJlZikpIHtcclxuICAgICAgICAgICAgICAgICAgICByZWYudmFsdWUgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocmF3UmVmLmspXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZnNbcmF3UmVmLmtdID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgICAgICB3YXJuKCdJbnZhbGlkIHRlbXBsYXRlIHJlZiB0eXBlOicsIHJlZiwgYCgke3R5cGVvZiByZWZ9KWApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBpZiAodmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIGRvU2V0LmlkID0gLTE7XHJcbiAgICAgICAgICAgICAgICBxdWV1ZVBvc3RSZW5kZXJFZmZlY3QoZG9TZXQsIHBhcmVudFN1c3BlbnNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGRvU2V0KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgIHdhcm4oJ0ludmFsaWQgdGVtcGxhdGUgcmVmIHR5cGU6JywgcmVmLCBgKCR7dHlwZW9mIHJlZn0pYCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XG5cbmxldCBoYXNNaXNtYXRjaCA9IGZhbHNlO1xyXG5jb25zdCBpc1NWR0NvbnRhaW5lciA9IChjb250YWluZXIpID0+IC9zdmcvLnRlc3QoY29udGFpbmVyLm5hbWVzcGFjZVVSSSkgJiYgY29udGFpbmVyLnRhZ05hbWUgIT09ICdmb3JlaWduT2JqZWN0JztcclxuY29uc3QgaXNDb21tZW50ID0gKG5vZGUpID0+IG5vZGUubm9kZVR5cGUgPT09IDggLyogQ09NTUVOVCAqLztcclxuLy8gTm90ZTogaHlkcmF0aW9uIGlzIERPTS1zcGVjaWZpY1xyXG4vLyBCdXQgd2UgaGF2ZSB0byBwbGFjZSBpdCBpbiBjb3JlIGR1ZSB0byB0aWdodCBjb3VwbGluZyB3aXRoIGNvcmUgLSBzcGxpdHRpbmdcclxuLy8gaXQgb3V0IGNyZWF0ZXMgYSB0b24gb2YgdW5uZWNlc3NhcnkgY29tcGxleGl0eS5cclxuLy8gSHlkcmF0aW9uIGFsc28gZGVwZW5kcyBvbiBzb21lIHJlbmRlcmVyIGludGVybmFsIGxvZ2ljIHdoaWNoIG5lZWRzIHRvIGJlXHJcbi8vIHBhc3NlZCBpbiB2aWEgYXJndW1lbnRzLlxyXG5mdW5jdGlvbiBjcmVhdGVIeWRyYXRpb25GdW5jdGlvbnMocmVuZGVyZXJJbnRlcm5hbHMpIHtcclxuICAgIGNvbnN0IHsgbXQ6IG1vdW50Q29tcG9uZW50LCBwOiBwYXRjaCwgbzogeyBwYXRjaFByb3AsIG5leHRTaWJsaW5nLCBwYXJlbnROb2RlLCByZW1vdmUsIGluc2VydCwgY3JlYXRlQ29tbWVudCB9IH0gPSByZW5kZXJlckludGVybmFscztcclxuICAgIGNvbnN0IGh5ZHJhdGUgPSAodm5vZGUsIGNvbnRhaW5lcikgPT4ge1xyXG4gICAgICAgIGlmICghY29udGFpbmVyLmhhc0NoaWxkTm9kZXMoKSkge1xyXG4gICAgICAgICAgICAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiZcclxuICAgICAgICAgICAgICAgIHdhcm4oYEF0dGVtcHRpbmcgdG8gaHlkcmF0ZSBleGlzdGluZyBtYXJrdXAgYnV0IGNvbnRhaW5lciBpcyBlbXB0eS4gYCArXHJcbiAgICAgICAgICAgICAgICAgICAgYFBlcmZvcm1pbmcgZnVsbCBtb3VudCBpbnN0ZWFkLmApO1xyXG4gICAgICAgICAgICBwYXRjaChudWxsLCB2bm9kZSwgY29udGFpbmVyKTtcclxuICAgICAgICAgICAgZmx1c2hQb3N0Rmx1c2hDYnMoKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBoYXNNaXNtYXRjaCA9IGZhbHNlO1xyXG4gICAgICAgIGh5ZHJhdGVOb2RlKGNvbnRhaW5lci5maXJzdENoaWxkLCB2bm9kZSwgbnVsbCwgbnVsbCwgbnVsbCk7XHJcbiAgICAgICAgZmx1c2hQb3N0Rmx1c2hDYnMoKTtcclxuICAgICAgICBpZiAoaGFzTWlzbWF0Y2ggJiYgIWZhbHNlKSB7XHJcbiAgICAgICAgICAgIC8vIHRoaXMgZXJyb3Igc2hvdWxkIHNob3cgdXAgaW4gcHJvZHVjdGlvblxyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGBIeWRyYXRpb24gY29tcGxldGVkIGJ1dCBjb250YWlucyBtaXNtYXRjaGVzLmApO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBjb25zdCBoeWRyYXRlTm9kZSA9IChub2RlLCB2bm9kZSwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgc2xvdFNjb3BlSWRzLCBvcHRpbWl6ZWQgPSBmYWxzZSkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGlzRnJhZ21lbnRTdGFydCA9IGlzQ29tbWVudChub2RlKSAmJiBub2RlLmRhdGEgPT09ICdbJztcclxuICAgICAgICBjb25zdCBvbk1pc21hdGNoID0gKCkgPT4gaGFuZGxlTWlzbWF0Y2gobm9kZSwgdm5vZGUsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIHNsb3RTY29wZUlkcywgaXNGcmFnbWVudFN0YXJ0KTtcclxuICAgICAgICBjb25zdCB7IHR5cGUsIHJlZiwgc2hhcGVGbGFnIH0gPSB2bm9kZTtcclxuICAgICAgICBjb25zdCBkb21UeXBlID0gbm9kZS5ub2RlVHlwZTtcclxuICAgICAgICB2bm9kZS5lbCA9IG5vZGU7XHJcbiAgICAgICAgbGV0IG5leHROb2RlID0gbnVsbDtcclxuICAgICAgICBzd2l0Y2ggKHR5cGUpIHtcclxuICAgICAgICAgICAgY2FzZSBUZXh0OlxyXG4gICAgICAgICAgICAgICAgaWYgKGRvbVR5cGUgIT09IDMgLyogVEVYVCAqLykge1xyXG4gICAgICAgICAgICAgICAgICAgIG5leHROb2RlID0gb25NaXNtYXRjaCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUuZGF0YSAhPT0gdm5vZGUuY2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaGFzTWlzbWF0Y2ggPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdhcm4oYEh5ZHJhdGlvbiB0ZXh0IG1pc21hdGNoOmAgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGBcXG4tIENsaWVudDogJHtKU09OLnN0cmluZ2lmeShub2RlLmRhdGEpfWAgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGBcXG4tIFNlcnZlcjogJHtKU09OLnN0cmluZ2lmeSh2bm9kZS5jaGlsZHJlbil9YCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuZGF0YSA9IHZub2RlLmNoaWxkcmVuO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBuZXh0Tm9kZSA9IG5leHRTaWJsaW5nKG5vZGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgQ29tbWVudDpcclxuICAgICAgICAgICAgICAgIGlmIChkb21UeXBlICE9PSA4IC8qIENPTU1FTlQgKi8gfHwgaXNGcmFnbWVudFN0YXJ0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmV4dE5vZGUgPSBvbk1pc21hdGNoKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBuZXh0Tm9kZSA9IG5leHRTaWJsaW5nKG5vZGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgU3RhdGljOlxyXG4gICAgICAgICAgICAgICAgaWYgKGRvbVR5cGUgIT09IDEgLyogRUxFTUVOVCAqLykge1xyXG4gICAgICAgICAgICAgICAgICAgIG5leHROb2RlID0gb25NaXNtYXRjaCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gZGV0ZXJtaW5lIGFuY2hvciwgYWRvcHQgY29udGVudFxyXG4gICAgICAgICAgICAgICAgICAgIG5leHROb2RlID0gbm9kZTtcclxuICAgICAgICAgICAgICAgICAgICAvLyBpZiB0aGUgc3RhdGljIHZub2RlIGhhcyBpdHMgY29udGVudCBzdHJpcHBlZCBkdXJpbmcgYnVpbGQsXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gYWRvcHQgaXQgZnJvbSB0aGUgc2VydmVyLXJlbmRlcmVkIEhUTUwuXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmVlZFRvQWRvcHRDb250ZW50ID0gIXZub2RlLmNoaWxkcmVuLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHZub2RlLnN0YXRpY0NvdW50OyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5lZWRUb0Fkb3B0Q29udGVudClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZub2RlLmNoaWxkcmVuICs9IG5leHROb2RlLm91dGVySFRNTDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkgPT09IHZub2RlLnN0YXRpY0NvdW50IC0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdm5vZGUuYW5jaG9yID0gbmV4dE5vZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV4dE5vZGUgPSBuZXh0U2libGluZyhuZXh0Tm9kZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXh0Tm9kZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIEZyYWdtZW50OlxyXG4gICAgICAgICAgICAgICAgaWYgKCFpc0ZyYWdtZW50U3RhcnQpIHtcclxuICAgICAgICAgICAgICAgICAgICBuZXh0Tm9kZSA9IG9uTWlzbWF0Y2goKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIG5leHROb2RlID0gaHlkcmF0ZUZyYWdtZW50KG5vZGUsIHZub2RlLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCBzbG90U2NvcGVJZHMsIG9wdGltaXplZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIGlmIChzaGFwZUZsYWcgJiAxIC8qIEVMRU1FTlQgKi8pIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZG9tVHlwZSAhPT0gMSAvKiBFTEVNRU5UICovIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZub2RlLnR5cGUudG9Mb3dlckNhc2UoKSAhPT1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUudGFnTmFtZS50b0xvd2VyQ2FzZSgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5leHROb2RlID0gb25NaXNtYXRjaCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV4dE5vZGUgPSBoeWRyYXRlRWxlbWVudChub2RlLCB2bm9kZSwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgc2xvdFNjb3BlSWRzLCBvcHRpbWl6ZWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHNoYXBlRmxhZyAmIDYgLyogQ09NUE9ORU5UICovKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gd2hlbiBzZXR0aW5nIHVwIHRoZSByZW5kZXIgZWZmZWN0LCBpZiB0aGUgaW5pdGlhbCB2bm9kZSBhbHJlYWR5XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gaGFzIC5lbCBzZXQsIHRoZSBjb21wb25lbnQgd2lsbCBwZXJmb3JtIGh5ZHJhdGlvbiBpbnN0ZWFkIG9mIG1vdW50XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gb24gaXRzIHN1Yi10cmVlLlxyXG4gICAgICAgICAgICAgICAgICAgIHZub2RlLnNsb3RTY29wZUlkcyA9IHNsb3RTY29wZUlkcztcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBwYXJlbnROb2RlKG5vZGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIG1vdW50Q29tcG9uZW50KHZub2RlLCBjb250YWluZXIsIG51bGwsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIGlzU1ZHQ29udGFpbmVyKGNvbnRhaW5lciksIG9wdGltaXplZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gY29tcG9uZW50IG1heSBiZSBhc3luYywgc28gaW4gdGhlIGNhc2Ugb2YgZnJhZ21lbnRzIHdlIGNhbm5vdCByZWx5XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gb24gY29tcG9uZW50J3MgcmVuZGVyZWQgb3V0cHV0IHRvIGRldGVybWluZSB0aGUgZW5kIG9mIHRoZSBmcmFnbWVudFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGluc3RlYWQsIHdlIGRvIGEgbG9va2FoZWFkIHRvIGZpbmQgdGhlIGVuZCBhbmNob3Igbm9kZS5cclxuICAgICAgICAgICAgICAgICAgICBuZXh0Tm9kZSA9IGlzRnJhZ21lbnRTdGFydFxyXG4gICAgICAgICAgICAgICAgICAgICAgICA/IGxvY2F0ZUNsb3NpbmdBc3luY0FuY2hvcihub2RlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA6IG5leHRTaWJsaW5nKG5vZGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICMzNzg3XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgY29tcG9uZW50IGlzIGFzeW5jLCBpdCBtYXkgZ2V0IG1vdmVkIC8gdW5tb3VudGVkIGJlZm9yZSBpdHNcclxuICAgICAgICAgICAgICAgICAgICAvLyBpbm5lciBjb21wb25lbnQgaXMgbG9hZGVkLCBzbyB3ZSBuZWVkIHRvIGdpdmUgaXQgYSBwbGFjZWhvbGRlclxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHZub2RlIHRoYXQgbWF0Y2hlcyBpdHMgYWRvcHRlZCBET00uXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzQXN5bmNXcmFwcGVyKHZub2RlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgc3ViVHJlZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzRnJhZ21lbnRTdGFydCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ViVHJlZSA9IGNyZWF0ZVZOb2RlKEZyYWdtZW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YlRyZWUuYW5jaG9yID0gbmV4dE5vZGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IG5leHROb2RlLnByZXZpb3VzU2libGluZ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogY29udGFpbmVyLmxhc3RDaGlsZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YlRyZWUgPVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUubm9kZVR5cGUgPT09IDMgPyBjcmVhdGVUZXh0Vk5vZGUoJycpIDogY3JlYXRlVk5vZGUoJ2RpdicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1YlRyZWUuZWwgPSBub2RlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2bm9kZS5jb21wb25lbnQuc3ViVHJlZSA9IHN1YlRyZWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoc2hhcGVGbGFnICYgNjQgLyogVEVMRVBPUlQgKi8pIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZG9tVHlwZSAhPT0gOCAvKiBDT01NRU5UICovKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5leHROb2RlID0gb25NaXNtYXRjaCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV4dE5vZGUgPSB2bm9kZS50eXBlLmh5ZHJhdGUobm9kZSwgdm5vZGUsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkLCByZW5kZXJlckludGVybmFscywgaHlkcmF0ZUNoaWxkcmVuKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChzaGFwZUZsYWcgJiAxMjggLyogU1VTUEVOU0UgKi8pIHtcclxuICAgICAgICAgICAgICAgICAgICBuZXh0Tm9kZSA9IHZub2RlLnR5cGUuaHlkcmF0ZShub2RlLCB2bm9kZSwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgaXNTVkdDb250YWluZXIocGFyZW50Tm9kZShub2RlKSksIHNsb3RTY29wZUlkcywgb3B0aW1pemVkLCByZW5kZXJlckludGVybmFscywgaHlkcmF0ZU5vZGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgd2FybignSW52YWxpZCBIb3N0Vk5vZGUgdHlwZTonLCB0eXBlLCBgKCR7dHlwZW9mIHR5cGV9KWApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocmVmICE9IG51bGwpIHtcclxuICAgICAgICAgICAgc2V0UmVmKHJlZiwgbnVsbCwgcGFyZW50U3VzcGVuc2UsIHZub2RlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5leHROb2RlO1xyXG4gICAgfTtcclxuICAgIGNvbnN0IGh5ZHJhdGVFbGVtZW50ID0gKGVsLCB2bm9kZSwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgc2xvdFNjb3BlSWRzLCBvcHRpbWl6ZWQpID0+IHtcclxuICAgICAgICBvcHRpbWl6ZWQgPSBvcHRpbWl6ZWQgfHwgISF2bm9kZS5keW5hbWljQ2hpbGRyZW47XHJcbiAgICAgICAgY29uc3QgeyB0eXBlLCBwcm9wcywgcGF0Y2hGbGFnLCBzaGFwZUZsYWcsIGRpcnMgfSA9IHZub2RlO1xyXG4gICAgICAgIC8vICM0MDA2IGZvciBmb3JtIGVsZW1lbnRzIHdpdGggbm9uLXN0cmluZyB2LW1vZGVsIHZhbHVlIGJpbmRpbmdzXHJcbiAgICAgICAgLy8gZS5nLiA8b3B0aW9uIDp2YWx1ZT1cIm9ialwiPiwgPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIDp0cnVlLXZhbHVlPVwiMVwiPlxyXG4gICAgICAgIGNvbnN0IGZvcmNlUGF0Y2hWYWx1ZSA9ICh0eXBlID09PSAnaW5wdXQnICYmIGRpcnMpIHx8IHR5cGUgPT09ICdvcHRpb24nO1xyXG4gICAgICAgIC8vIHNraXAgcHJvcHMgJiBjaGlsZHJlbiBpZiB0aGlzIGlzIGhvaXN0ZWQgc3RhdGljIG5vZGVzXHJcbiAgICAgICAgLy8gIzU0MDUgaW4gZGV2LCBhbHdheXMgaHlkcmF0ZSBjaGlsZHJlbiBmb3IgSE1SXHJcbiAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB8fCBmb3JjZVBhdGNoVmFsdWUgfHwgcGF0Y2hGbGFnICE9PSAtMSAvKiBIT0lTVEVEICovKSB7XHJcbiAgICAgICAgICAgIGlmIChkaXJzKSB7XHJcbiAgICAgICAgICAgICAgICBpbnZva2VEaXJlY3RpdmVIb29rKHZub2RlLCBudWxsLCBwYXJlbnRDb21wb25lbnQsICdjcmVhdGVkJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gcHJvcHNcclxuICAgICAgICAgICAgaWYgKHByb3BzKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZm9yY2VQYXRjaFZhbHVlIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgIW9wdGltaXplZCB8fFxyXG4gICAgICAgICAgICAgICAgICAgIHBhdGNoRmxhZyAmICgxNiAvKiBGVUxMX1BST1BTICovIHwgMzIgLyogSFlEUkFURV9FVkVOVFMgKi8pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gcHJvcHMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKChmb3JjZVBhdGNoVmFsdWUgJiYga2V5LmVuZHNXaXRoKCd2YWx1ZScpKSB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKGlzT24oa2V5KSAmJiAhaXNSZXNlcnZlZFByb3Aoa2V5KSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGNoUHJvcChlbCwga2V5LCBudWxsLCBwcm9wc1trZXldLCBmYWxzZSwgdW5kZWZpbmVkLCBwYXJlbnRDb21wb25lbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAocHJvcHMub25DbGljaykge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIEZhc3QgcGF0aCBmb3IgY2xpY2sgbGlzdGVuZXJzICh3aGljaCBpcyBtb3N0IG9mdGVuKSB0byBhdm9pZFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGl0ZXJhdGluZyB0aHJvdWdoIHByb3BzLlxyXG4gICAgICAgICAgICAgICAgICAgIHBhdGNoUHJvcChlbCwgJ29uQ2xpY2snLCBudWxsLCBwcm9wcy5vbkNsaWNrLCBmYWxzZSwgdW5kZWZpbmVkLCBwYXJlbnRDb21wb25lbnQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIHZub2RlIC8gZGlyZWN0aXZlIGhvb2tzXHJcbiAgICAgICAgICAgIGxldCB2bm9kZUhvb2tzO1xyXG4gICAgICAgICAgICBpZiAoKHZub2RlSG9va3MgPSBwcm9wcyAmJiBwcm9wcy5vblZub2RlQmVmb3JlTW91bnQpKSB7XHJcbiAgICAgICAgICAgICAgICBpbnZva2VWTm9kZUhvb2sodm5vZGVIb29rcywgcGFyZW50Q29tcG9uZW50LCB2bm9kZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGRpcnMpIHtcclxuICAgICAgICAgICAgICAgIGludm9rZURpcmVjdGl2ZUhvb2sodm5vZGUsIG51bGwsIHBhcmVudENvbXBvbmVudCwgJ2JlZm9yZU1vdW50Jyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCh2bm9kZUhvb2tzID0gcHJvcHMgJiYgcHJvcHMub25Wbm9kZU1vdW50ZWQpIHx8IGRpcnMpIHtcclxuICAgICAgICAgICAgICAgIHF1ZXVlRWZmZWN0V2l0aFN1c3BlbnNlKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB2bm9kZUhvb2tzICYmIGludm9rZVZOb2RlSG9vayh2bm9kZUhvb2tzLCBwYXJlbnRDb21wb25lbnQsIHZub2RlKTtcclxuICAgICAgICAgICAgICAgICAgICBkaXJzICYmIGludm9rZURpcmVjdGl2ZUhvb2sodm5vZGUsIG51bGwsIHBhcmVudENvbXBvbmVudCwgJ21vdW50ZWQnKTtcclxuICAgICAgICAgICAgICAgIH0sIHBhcmVudFN1c3BlbnNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBjaGlsZHJlblxyXG4gICAgICAgICAgICBpZiAoc2hhcGVGbGFnICYgMTYgLyogQVJSQVlfQ0hJTERSRU4gKi8gJiZcclxuICAgICAgICAgICAgICAgIC8vIHNraXAgaWYgZWxlbWVudCBoYXMgaW5uZXJIVE1MIC8gdGV4dENvbnRlbnRcclxuICAgICAgICAgICAgICAgICEocHJvcHMgJiYgKHByb3BzLmlubmVySFRNTCB8fCBwcm9wcy50ZXh0Q29udGVudCkpKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgbmV4dCA9IGh5ZHJhdGVDaGlsZHJlbihlbC5maXJzdENoaWxkLCB2bm9kZSwgZWwsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKTtcclxuICAgICAgICAgICAgICAgIGxldCBoYXNXYXJuZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHdoaWxlIChuZXh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaGFzTWlzbWF0Y2ggPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiYgIWhhc1dhcm5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3YXJuKGBIeWRyYXRpb24gY2hpbGRyZW4gbWlzbWF0Y2ggaW4gPCR7dm5vZGUudHlwZX0+OiBgICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGBzZXJ2ZXIgcmVuZGVyZWQgZWxlbWVudCBjb250YWlucyBtb3JlIGNoaWxkIG5vZGVzIHRoYW4gY2xpZW50IHZkb20uYCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhc1dhcm5lZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIFRoZSBTU1JlZCBET00gY29udGFpbnMgbW9yZSBub2RlcyB0aGFuIGl0IHNob3VsZC4gUmVtb3ZlIHRoZW0uXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VyID0gbmV4dDtcclxuICAgICAgICAgICAgICAgICAgICBuZXh0ID0gbmV4dC5uZXh0U2libGluZztcclxuICAgICAgICAgICAgICAgICAgICByZW1vdmUoY3VyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChzaGFwZUZsYWcgJiA4IC8qIFRFWFRfQ0hJTERSRU4gKi8pIHtcclxuICAgICAgICAgICAgICAgIGlmIChlbC50ZXh0Q29udGVudCAhPT0gdm5vZGUuY2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgICAgICAgICBoYXNNaXNtYXRjaCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdhcm4oYEh5ZHJhdGlvbiB0ZXh0IGNvbnRlbnQgbWlzbWF0Y2ggaW4gPCR7dm5vZGUudHlwZX0+OlxcbmAgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYC0gQ2xpZW50OiAke2VsLnRleHRDb250ZW50fVxcbmAgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYC0gU2VydmVyOiAke3Zub2RlLmNoaWxkcmVufWApO1xyXG4gICAgICAgICAgICAgICAgICAgIGVsLnRleHRDb250ZW50ID0gdm5vZGUuY2hpbGRyZW47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGVsLm5leHRTaWJsaW5nO1xyXG4gICAgfTtcclxuICAgIGNvbnN0IGh5ZHJhdGVDaGlsZHJlbiA9IChub2RlLCBwYXJlbnRWTm9kZSwgY29udGFpbmVyLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCBzbG90U2NvcGVJZHMsIG9wdGltaXplZCkgPT4ge1xyXG4gICAgICAgIG9wdGltaXplZCA9IG9wdGltaXplZCB8fCAhIXBhcmVudFZOb2RlLmR5bmFtaWNDaGlsZHJlbjtcclxuICAgICAgICBjb25zdCBjaGlsZHJlbiA9IHBhcmVudFZOb2RlLmNoaWxkcmVuO1xyXG4gICAgICAgIGNvbnN0IGwgPSBjaGlsZHJlbi5sZW5ndGg7XHJcbiAgICAgICAgbGV0IGhhc1dhcm5lZCA9IGZhbHNlO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHZub2RlID0gb3B0aW1pemVkXHJcbiAgICAgICAgICAgICAgICA/IGNoaWxkcmVuW2ldXHJcbiAgICAgICAgICAgICAgICA6IChjaGlsZHJlbltpXSA9IG5vcm1hbGl6ZVZOb2RlKGNoaWxkcmVuW2ldKSk7XHJcbiAgICAgICAgICAgIGlmIChub2RlKSB7XHJcbiAgICAgICAgICAgICAgICBub2RlID0gaHlkcmF0ZU5vZGUobm9kZSwgdm5vZGUsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmICh2bm9kZS50eXBlID09PSBUZXh0ICYmICF2bm9kZS5jaGlsZHJlbikge1xyXG4gICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBoYXNNaXNtYXRjaCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmICFoYXNXYXJuZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICB3YXJuKGBIeWRyYXRpb24gY2hpbGRyZW4gbWlzbWF0Y2ggaW4gPCR7Y29udGFpbmVyLnRhZ05hbWUudG9Mb3dlckNhc2UoKX0+OiBgICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYHNlcnZlciByZW5kZXJlZCBlbGVtZW50IGNvbnRhaW5zIGZld2VyIGNoaWxkIG5vZGVzIHRoYW4gY2xpZW50IHZkb20uYCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaGFzV2FybmVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIHRoZSBTU1JlZCBET00gZGlkbid0IGNvbnRhaW4gZW5vdWdoIG5vZGVzLiBNb3VudCB0aGUgbWlzc2luZyBvbmVzLlxyXG4gICAgICAgICAgICAgICAgcGF0Y2gobnVsbCwgdm5vZGUsIGNvbnRhaW5lciwgbnVsbCwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgaXNTVkdDb250YWluZXIoY29udGFpbmVyKSwgc2xvdFNjb3BlSWRzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbm9kZTtcclxuICAgIH07XHJcbiAgICBjb25zdCBoeWRyYXRlRnJhZ21lbnQgPSAobm9kZSwgdm5vZGUsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKSA9PiB7XHJcbiAgICAgICAgY29uc3QgeyBzbG90U2NvcGVJZHM6IGZyYWdtZW50U2xvdFNjb3BlSWRzIH0gPSB2bm9kZTtcclxuICAgICAgICBpZiAoZnJhZ21lbnRTbG90U2NvcGVJZHMpIHtcclxuICAgICAgICAgICAgc2xvdFNjb3BlSWRzID0gc2xvdFNjb3BlSWRzXHJcbiAgICAgICAgICAgICAgICA/IHNsb3RTY29wZUlkcy5jb25jYXQoZnJhZ21lbnRTbG90U2NvcGVJZHMpXHJcbiAgICAgICAgICAgICAgICA6IGZyYWdtZW50U2xvdFNjb3BlSWRzO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBjb250YWluZXIgPSBwYXJlbnROb2RlKG5vZGUpO1xyXG4gICAgICAgIGNvbnN0IG5leHQgPSBoeWRyYXRlQ2hpbGRyZW4obmV4dFNpYmxpbmcobm9kZSksIHZub2RlLCBjb250YWluZXIsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKTtcclxuICAgICAgICBpZiAobmV4dCAmJiBpc0NvbW1lbnQobmV4dCkgJiYgbmV4dC5kYXRhID09PSAnXScpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5leHRTaWJsaW5nKCh2bm9kZS5hbmNob3IgPSBuZXh0KSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBmcmFnbWVudCBkaWRuJ3QgaHlkcmF0ZSBzdWNjZXNzZnVsbHksIHNpbmNlIHdlIGRpZG4ndCBnZXQgYSBlbmQgYW5jaG9yXHJcbiAgICAgICAgICAgIC8vIGJhY2suIFRoaXMgc2hvdWxkIGhhdmUgbGVkIHRvIG5vZGUvY2hpbGRyZW4gbWlzbWF0Y2ggd2FybmluZ3MuXHJcbiAgICAgICAgICAgIGhhc01pc21hdGNoID0gdHJ1ZTtcclxuICAgICAgICAgICAgLy8gc2luY2UgdGhlIGFuY2hvciBpcyBtaXNzaW5nLCB3ZSBuZWVkIHRvIGNyZWF0ZSBvbmUgYW5kIGluc2VydCBpdFxyXG4gICAgICAgICAgICBpbnNlcnQoKHZub2RlLmFuY2hvciA9IGNyZWF0ZUNvbW1lbnQoYF1gKSksIGNvbnRhaW5lciwgbmV4dCk7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXh0O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBjb25zdCBoYW5kbGVNaXNtYXRjaCA9IChub2RlLCB2bm9kZSwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgc2xvdFNjb3BlSWRzLCBpc0ZyYWdtZW50KSA9PiB7XHJcbiAgICAgICAgaGFzTWlzbWF0Y2ggPSB0cnVlO1xyXG4gICAgICAgIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJlxyXG4gICAgICAgICAgICB3YXJuKGBIeWRyYXRpb24gbm9kZSBtaXNtYXRjaDpcXG4tIENsaWVudCB2bm9kZTpgLCB2bm9kZS50eXBlLCBgXFxuLSBTZXJ2ZXIgcmVuZGVyZWQgRE9NOmAsIG5vZGUsIG5vZGUubm9kZVR5cGUgPT09IDMgLyogVEVYVCAqL1xyXG4gICAgICAgICAgICAgICAgPyBgKHRleHQpYFxyXG4gICAgICAgICAgICAgICAgOiBpc0NvbW1lbnQobm9kZSkgJiYgbm9kZS5kYXRhID09PSAnWydcclxuICAgICAgICAgICAgICAgICAgICA/IGAoc3RhcnQgb2YgZnJhZ21lbnQpYFxyXG4gICAgICAgICAgICAgICAgICAgIDogYGApO1xyXG4gICAgICAgIHZub2RlLmVsID0gbnVsbDtcclxuICAgICAgICBpZiAoaXNGcmFnbWVudCkge1xyXG4gICAgICAgICAgICAvLyByZW1vdmUgZXhjZXNzaXZlIGZyYWdtZW50IG5vZGVzXHJcbiAgICAgICAgICAgIGNvbnN0IGVuZCA9IGxvY2F0ZUNsb3NpbmdBc3luY0FuY2hvcihub2RlKTtcclxuICAgICAgICAgICAgd2hpbGUgKHRydWUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5leHQgPSBuZXh0U2libGluZyhub2RlKTtcclxuICAgICAgICAgICAgICAgIGlmIChuZXh0ICYmIG5leHQgIT09IGVuZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlbW92ZShuZXh0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IG5leHQgPSBuZXh0U2libGluZyhub2RlKTtcclxuICAgICAgICBjb25zdCBjb250YWluZXIgPSBwYXJlbnROb2RlKG5vZGUpO1xyXG4gICAgICAgIHJlbW92ZShub2RlKTtcclxuICAgICAgICBwYXRjaChudWxsLCB2bm9kZSwgY29udGFpbmVyLCBuZXh0LCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCBpc1NWR0NvbnRhaW5lcihjb250YWluZXIpLCBzbG90U2NvcGVJZHMpO1xyXG4gICAgICAgIHJldHVybiBuZXh0O1xyXG4gICAgfTtcclxuICAgIGNvbnN0IGxvY2F0ZUNsb3NpbmdBc3luY0FuY2hvciA9IChub2RlKSA9PiB7XHJcbiAgICAgICAgbGV0IG1hdGNoID0gMDtcclxuICAgICAgICB3aGlsZSAobm9kZSkge1xyXG4gICAgICAgICAgICBub2RlID0gbmV4dFNpYmxpbmcobm9kZSk7XHJcbiAgICAgICAgICAgIGlmIChub2RlICYmIGlzQ29tbWVudChub2RlKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG5vZGUuZGF0YSA9PT0gJ1snKVxyXG4gICAgICAgICAgICAgICAgICAgIG1hdGNoKys7XHJcbiAgICAgICAgICAgICAgICBpZiAobm9kZS5kYXRhID09PSAnXScpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobWF0Y2ggPT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5leHRTaWJsaW5nKG5vZGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2gtLTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5vZGU7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFtoeWRyYXRlLCBoeWRyYXRlTm9kZV07XHJcbn1cblxuLyogZXNsaW50LWRpc2FibGUgbm8tcmVzdHJpY3RlZC1nbG9iYWxzICovXHJcbmxldCBzdXBwb3J0ZWQ7XHJcbmxldCBwZXJmO1xyXG5mdW5jdGlvbiBzdGFydE1lYXN1cmUoaW5zdGFuY2UsIHR5cGUpIHtcclxuICAgIGlmIChpbnN0YW5jZS5hcHBDb250ZXh0LmNvbmZpZy5wZXJmb3JtYW5jZSAmJiBpc1N1cHBvcnRlZCgpKSB7XHJcbiAgICAgICAgcGVyZi5tYXJrKGB2dWUtJHt0eXBlfS0ke2luc3RhbmNlLnVpZH1gKTtcclxuICAgIH1cclxuICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgfHwgX19WVUVfUFJPRF9ERVZUT09MU19fKSB7XHJcbiAgICAgICAgZGV2dG9vbHNQZXJmU3RhcnQoaW5zdGFuY2UsIHR5cGUsIHN1cHBvcnRlZCA/IHBlcmYubm93KCkgOiBEYXRlLm5vdygpKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBlbmRNZWFzdXJlKGluc3RhbmNlLCB0eXBlKSB7XHJcbiAgICBpZiAoaW5zdGFuY2UuYXBwQ29udGV4dC5jb25maWcucGVyZm9ybWFuY2UgJiYgaXNTdXBwb3J0ZWQoKSkge1xyXG4gICAgICAgIGNvbnN0IHN0YXJ0VGFnID0gYHZ1ZS0ke3R5cGV9LSR7aW5zdGFuY2UudWlkfWA7XHJcbiAgICAgICAgY29uc3QgZW5kVGFnID0gc3RhcnRUYWcgKyBgOmVuZGA7XHJcbiAgICAgICAgcGVyZi5tYXJrKGVuZFRhZyk7XHJcbiAgICAgICAgcGVyZi5tZWFzdXJlKGA8JHtmb3JtYXRDb21wb25lbnROYW1lKGluc3RhbmNlLCBpbnN0YW5jZS50eXBlKX0+ICR7dHlwZX1gLCBzdGFydFRhZywgZW5kVGFnKTtcclxuICAgICAgICBwZXJmLmNsZWFyTWFya3Moc3RhcnRUYWcpO1xyXG4gICAgICAgIHBlcmYuY2xlYXJNYXJrcyhlbmRUYWcpO1xyXG4gICAgfVxyXG4gICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB8fCBfX1ZVRV9QUk9EX0RFVlRPT0xTX18pIHtcclxuICAgICAgICBkZXZ0b29sc1BlcmZFbmQoaW5zdGFuY2UsIHR5cGUsIHN1cHBvcnRlZCA/IHBlcmYubm93KCkgOiBEYXRlLm5vdygpKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBpc1N1cHBvcnRlZCgpIHtcclxuICAgIGlmIChzdXBwb3J0ZWQgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHJldHVybiBzdXBwb3J0ZWQ7XHJcbiAgICB9XHJcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgd2luZG93LnBlcmZvcm1hbmNlKSB7XHJcbiAgICAgICAgc3VwcG9ydGVkID0gdHJ1ZTtcclxuICAgICAgICBwZXJmID0gd2luZG93LnBlcmZvcm1hbmNlO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgc3VwcG9ydGVkID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gc3VwcG9ydGVkO1xyXG59XG5cbi8qKlxyXG4gKiBUaGlzIGlzIG9ubHkgY2FsbGVkIGluIGVzbS1idW5kbGVyIGJ1aWxkcy5cclxuICogSXQgaXMgY2FsbGVkIHdoZW4gYSByZW5kZXJlciBpcyBjcmVhdGVkLCBpbiBgYmFzZUNyZWF0ZVJlbmRlcmVyYCBzbyB0aGF0XHJcbiAqIGltcG9ydGluZyBydW50aW1lLWNvcmUgaXMgc2lkZS1lZmZlY3RzIGZyZWUuXHJcbiAqXHJcbiAqIGlzdGFuYnVsLWlnbm9yZS1uZXh0XHJcbiAqL1xyXG5mdW5jdGlvbiBpbml0RmVhdHVyZUZsYWdzKCkge1xyXG4gICAgY29uc3QgbmVlZFdhcm4gPSBbXTtcclxuICAgIGlmICh0eXBlb2YgX19WVUVfT1BUSU9OU19BUElfXyAhPT0gJ2Jvb2xlYW4nKSB7XHJcbiAgICAgICAgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmIG5lZWRXYXJuLnB1c2goYF9fVlVFX09QVElPTlNfQVBJX19gKTtcclxuICAgICAgICBnZXRHbG9iYWxUaGlzKCkuX19WVUVfT1BUSU9OU19BUElfXyA9IHRydWU7XHJcbiAgICB9XHJcbiAgICBpZiAodHlwZW9mIF9fVlVFX1BST0RfREVWVE9PTFNfXyAhPT0gJ2Jvb2xlYW4nKSB7XHJcbiAgICAgICAgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmIG5lZWRXYXJuLnB1c2goYF9fVlVFX1BST0RfREVWVE9PTFNfX2ApO1xyXG4gICAgICAgIGdldEdsb2JhbFRoaXMoKS5fX1ZVRV9QUk9EX0RFVlRPT0xTX18gPSBmYWxzZTtcclxuICAgIH1cclxuICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiYgbmVlZFdhcm4ubGVuZ3RoKSB7XHJcbiAgICAgICAgY29uc3QgbXVsdGkgPSBuZWVkV2Fybi5sZW5ndGggPiAxO1xyXG4gICAgICAgIGNvbnNvbGUud2FybihgRmVhdHVyZSBmbGFnJHttdWx0aSA/IGBzYCA6IGBgfSAke25lZWRXYXJuLmpvaW4oJywgJyl9ICR7bXVsdGkgPyBgYXJlYCA6IGBpc2B9IG5vdCBleHBsaWNpdGx5IGRlZmluZWQuIFlvdSBhcmUgcnVubmluZyB0aGUgZXNtLWJ1bmRsZXIgYnVpbGQgb2YgVnVlLCBgICtcclxuICAgICAgICAgICAgYHdoaWNoIGV4cGVjdHMgdGhlc2UgY29tcGlsZS10aW1lIGZlYXR1cmUgZmxhZ3MgdG8gYmUgZ2xvYmFsbHkgaW5qZWN0ZWQgYCArXHJcbiAgICAgICAgICAgIGB2aWEgdGhlIGJ1bmRsZXIgY29uZmlnIGluIG9yZGVyIHRvIGdldCBiZXR0ZXIgdHJlZS1zaGFraW5nIGluIHRoZSBgICtcclxuICAgICAgICAgICAgYHByb2R1Y3Rpb24gYnVuZGxlLlxcblxcbmAgK1xyXG4gICAgICAgICAgICBgRm9yIG1vcmUgZGV0YWlscywgc2VlIGh0dHBzOi8vbGluay52dWVqcy5vcmcvZmVhdHVyZS1mbGFncy5gKTtcclxuICAgIH1cclxufVxuXG5jb25zdCBxdWV1ZVBvc3RSZW5kZXJFZmZlY3QgPSBxdWV1ZUVmZmVjdFdpdGhTdXNwZW5zZVxyXG4gICAgO1xyXG4vKipcclxuICogVGhlIGNyZWF0ZVJlbmRlcmVyIGZ1bmN0aW9uIGFjY2VwdHMgdHdvIGdlbmVyaWMgYXJndW1lbnRzOlxyXG4gKiBIb3N0Tm9kZSBhbmQgSG9zdEVsZW1lbnQsIGNvcnJlc3BvbmRpbmcgdG8gTm9kZSBhbmQgRWxlbWVudCB0eXBlcyBpbiB0aGVcclxuICogaG9zdCBlbnZpcm9ubWVudC4gRm9yIGV4YW1wbGUsIGZvciBydW50aW1lLWRvbSwgSG9zdE5vZGUgd291bGQgYmUgdGhlIERPTVxyXG4gKiBgTm9kZWAgaW50ZXJmYWNlIGFuZCBIb3N0RWxlbWVudCB3b3VsZCBiZSB0aGUgRE9NIGBFbGVtZW50YCBpbnRlcmZhY2UuXHJcbiAqXHJcbiAqIEN1c3RvbSByZW5kZXJlcnMgY2FuIHBhc3MgaW4gdGhlIHBsYXRmb3JtIHNwZWNpZmljIHR5cGVzIGxpa2UgdGhpczpcclxuICpcclxuICogYGBgIGpzXHJcbiAqIGNvbnN0IHsgcmVuZGVyLCBjcmVhdGVBcHAgfSA9IGNyZWF0ZVJlbmRlcmVyPE5vZGUsIEVsZW1lbnQ+KHtcclxuICogICBwYXRjaFByb3AsXHJcbiAqICAgLi4ubm9kZU9wc1xyXG4gKiB9KVxyXG4gKiBgYGBcclxuICovXHJcbmZ1bmN0aW9uIGNyZWF0ZVJlbmRlcmVyKG9wdGlvbnMpIHtcclxuICAgIHJldHVybiBiYXNlQ3JlYXRlUmVuZGVyZXIob3B0aW9ucyk7XHJcbn1cclxuLy8gU2VwYXJhdGUgQVBJIGZvciBjcmVhdGluZyBoeWRyYXRpb24tZW5hYmxlZCByZW5kZXJlci5cclxuLy8gSHlkcmF0aW9uIGxvZ2ljIGlzIG9ubHkgdXNlZCB3aGVuIGNhbGxpbmcgdGhpcyBmdW5jdGlvbiwgbWFraW5nIGl0XHJcbi8vIHRyZWUtc2hha2FibGUuXHJcbmZ1bmN0aW9uIGNyZWF0ZUh5ZHJhdGlvblJlbmRlcmVyKG9wdGlvbnMpIHtcclxuICAgIHJldHVybiBiYXNlQ3JlYXRlUmVuZGVyZXIob3B0aW9ucywgY3JlYXRlSHlkcmF0aW9uRnVuY3Rpb25zKTtcclxufVxyXG4vLyBpbXBsZW1lbnRhdGlvblxyXG5mdW5jdGlvbiBiYXNlQ3JlYXRlUmVuZGVyZXIob3B0aW9ucywgY3JlYXRlSHlkcmF0aW9uRm5zKSB7XHJcbiAgICAvLyBjb21waWxlLXRpbWUgZmVhdHVyZSBmbGFncyBjaGVja1xyXG4gICAge1xyXG4gICAgICAgIGluaXRGZWF0dXJlRmxhZ3MoKTtcclxuICAgIH1cclxuICAgIGNvbnN0IHRhcmdldCA9IGdldEdsb2JhbFRoaXMoKTtcclxuICAgIHRhcmdldC5fX1ZVRV9fID0gdHJ1ZTtcclxuICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgfHwgX19WVUVfUFJPRF9ERVZUT09MU19fKSB7XHJcbiAgICAgICAgc2V0RGV2dG9vbHNIb29rKHRhcmdldC5fX1ZVRV9ERVZUT09MU19HTE9CQUxfSE9PS19fLCB0YXJnZXQpO1xyXG4gICAgfVxyXG4gICAgY29uc3QgeyBpbnNlcnQ6IGhvc3RJbnNlcnQsIHJlbW92ZTogaG9zdFJlbW92ZSwgcGF0Y2hQcm9wOiBob3N0UGF0Y2hQcm9wLCBjcmVhdGVFbGVtZW50OiBob3N0Q3JlYXRlRWxlbWVudCwgY3JlYXRlVGV4dDogaG9zdENyZWF0ZVRleHQsIGNyZWF0ZUNvbW1lbnQ6IGhvc3RDcmVhdGVDb21tZW50LCBzZXRUZXh0OiBob3N0U2V0VGV4dCwgc2V0RWxlbWVudFRleHQ6IGhvc3RTZXRFbGVtZW50VGV4dCwgcGFyZW50Tm9kZTogaG9zdFBhcmVudE5vZGUsIG5leHRTaWJsaW5nOiBob3N0TmV4dFNpYmxpbmcsIHNldFNjb3BlSWQ6IGhvc3RTZXRTY29wZUlkID0gTk9PUCwgY2xvbmVOb2RlOiBob3N0Q2xvbmVOb2RlLCBpbnNlcnRTdGF0aWNDb250ZW50OiBob3N0SW5zZXJ0U3RhdGljQ29udGVudCB9ID0gb3B0aW9ucztcclxuICAgIC8vIE5vdGU6IGZ1bmN0aW9ucyBpbnNpZGUgdGhpcyBjbG9zdXJlIHNob3VsZCB1c2UgYGNvbnN0IHh4eCA9ICgpID0+IHt9YFxyXG4gICAgLy8gc3R5bGUgaW4gb3JkZXIgdG8gcHJldmVudCBiZWluZyBpbmxpbmVkIGJ5IG1pbmlmaWVycy5cclxuICAgIGNvbnN0IHBhdGNoID0gKG4xLCBuMiwgY29udGFpbmVyLCBhbmNob3IgPSBudWxsLCBwYXJlbnRDb21wb25lbnQgPSBudWxsLCBwYXJlbnRTdXNwZW5zZSA9IG51bGwsIGlzU1ZHID0gZmFsc2UsIHNsb3RTY29wZUlkcyA9IG51bGwsIG9wdGltaXplZCA9IChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiBpc0htclVwZGF0aW5nID8gZmFsc2UgOiAhIW4yLmR5bmFtaWNDaGlsZHJlbikgPT4ge1xyXG4gICAgICAgIGlmIChuMSA9PT0gbjIpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBwYXRjaGluZyAmIG5vdCBzYW1lIHR5cGUsIHVubW91bnQgb2xkIHRyZWVcclxuICAgICAgICBpZiAobjEgJiYgIWlzU2FtZVZOb2RlVHlwZShuMSwgbjIpKSB7XHJcbiAgICAgICAgICAgIGFuY2hvciA9IGdldE5leHRIb3N0Tm9kZShuMSk7XHJcbiAgICAgICAgICAgIHVubW91bnQobjEsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIHRydWUpO1xyXG4gICAgICAgICAgICBuMSA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChuMi5wYXRjaEZsYWcgPT09IC0yIC8qIEJBSUwgKi8pIHtcclxuICAgICAgICAgICAgb3B0aW1pemVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIG4yLmR5bmFtaWNDaGlsZHJlbiA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHsgdHlwZSwgcmVmLCBzaGFwZUZsYWcgfSA9IG4yO1xyXG4gICAgICAgIHN3aXRjaCAodHlwZSkge1xyXG4gICAgICAgICAgICBjYXNlIFRleHQ6XHJcbiAgICAgICAgICAgICAgICBwcm9jZXNzVGV4dChuMSwgbjIsIGNvbnRhaW5lciwgYW5jaG9yKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIENvbW1lbnQ6XHJcbiAgICAgICAgICAgICAgICBwcm9jZXNzQ29tbWVudE5vZGUobjEsIG4yLCBjb250YWluZXIsIGFuY2hvcik7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBTdGF0aWM6XHJcbiAgICAgICAgICAgICAgICBpZiAobjEgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG1vdW50U3RhdGljTm9kZShuMiwgY29udGFpbmVyLCBhbmNob3IsIGlzU1ZHKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHBhdGNoU3RhdGljTm9kZShuMSwgbjIsIGNvbnRhaW5lciwgaXNTVkcpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgRnJhZ21lbnQ6XHJcbiAgICAgICAgICAgICAgICBwcm9jZXNzRnJhZ21lbnQobjEsIG4yLCBjb250YWluZXIsIGFuY2hvciwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgaWYgKHNoYXBlRmxhZyAmIDEgLyogRUxFTUVOVCAqLykge1xyXG4gICAgICAgICAgICAgICAgICAgIHByb2Nlc3NFbGVtZW50KG4xLCBuMiwgY29udGFpbmVyLCBhbmNob3IsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIGlzU1ZHLCBzbG90U2NvcGVJZHMsIG9wdGltaXplZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChzaGFwZUZsYWcgJiA2IC8qIENPTVBPTkVOVCAqLykge1xyXG4gICAgICAgICAgICAgICAgICAgIHByb2Nlc3NDb21wb25lbnQobjEsIG4yLCBjb250YWluZXIsIGFuY2hvciwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHNoYXBlRmxhZyAmIDY0IC8qIFRFTEVQT1JUICovKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZS5wcm9jZXNzKG4xLCBuMiwgY29udGFpbmVyLCBhbmNob3IsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIGlzU1ZHLCBzbG90U2NvcGVJZHMsIG9wdGltaXplZCwgaW50ZXJuYWxzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHNoYXBlRmxhZyAmIDEyOCAvKiBTVVNQRU5TRSAqLykge1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGUucHJvY2VzcyhuMSwgbjIsIGNvbnRhaW5lciwgYW5jaG9yLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCBpc1NWRywgc2xvdFNjb3BlSWRzLCBvcHRpbWl6ZWQsIGludGVybmFscyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgICAgICB3YXJuKCdJbnZhbGlkIFZOb2RlIHR5cGU6JywgdHlwZSwgYCgke3R5cGVvZiB0eXBlfSlgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gc2V0IHJlZlxyXG4gICAgICAgIGlmIChyZWYgIT0gbnVsbCAmJiBwYXJlbnRDb21wb25lbnQpIHtcclxuICAgICAgICAgICAgc2V0UmVmKHJlZiwgbjEgJiYgbjEucmVmLCBwYXJlbnRTdXNwZW5zZSwgbjIgfHwgbjEsICFuMik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGNvbnN0IHByb2Nlc3NUZXh0ID0gKG4xLCBuMiwgY29udGFpbmVyLCBhbmNob3IpID0+IHtcclxuICAgICAgICBpZiAobjEgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBob3N0SW5zZXJ0KChuMi5lbCA9IGhvc3RDcmVhdGVUZXh0KG4yLmNoaWxkcmVuKSksIGNvbnRhaW5lciwgYW5jaG9yKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVsID0gKG4yLmVsID0gbjEuZWwpO1xyXG4gICAgICAgICAgICBpZiAobjIuY2hpbGRyZW4gIT09IG4xLmNoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgICAgICBob3N0U2V0VGV4dChlbCwgbjIuY2hpbGRyZW4pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGNvbnN0IHByb2Nlc3NDb21tZW50Tm9kZSA9IChuMSwgbjIsIGNvbnRhaW5lciwgYW5jaG9yKSA9PiB7XHJcbiAgICAgICAgaWYgKG4xID09IG51bGwpIHtcclxuICAgICAgICAgICAgaG9zdEluc2VydCgobjIuZWwgPSBob3N0Q3JlYXRlQ29tbWVudChuMi5jaGlsZHJlbiB8fCAnJykpLCBjb250YWluZXIsIGFuY2hvcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyB0aGVyZSdzIG5vIHN1cHBvcnQgZm9yIGR5bmFtaWMgY29tbWVudHNcclxuICAgICAgICAgICAgbjIuZWwgPSBuMS5lbDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgY29uc3QgbW91bnRTdGF0aWNOb2RlID0gKG4yLCBjb250YWluZXIsIGFuY2hvciwgaXNTVkcpID0+IHtcclxuICAgICAgICBbbjIuZWwsIG4yLmFuY2hvcl0gPSBob3N0SW5zZXJ0U3RhdGljQ29udGVudChuMi5jaGlsZHJlbiwgY29udGFpbmVyLCBhbmNob3IsIGlzU1ZHLCBuMi5lbCwgbjIuYW5jaG9yKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIERldiAvIEhNUiBvbmx5XHJcbiAgICAgKi9cclxuICAgIGNvbnN0IHBhdGNoU3RhdGljTm9kZSA9IChuMSwgbjIsIGNvbnRhaW5lciwgaXNTVkcpID0+IHtcclxuICAgICAgICAvLyBzdGF0aWMgbm9kZXMgYXJlIG9ubHkgcGF0Y2hlZCBkdXJpbmcgZGV2IGZvciBITVJcclxuICAgICAgICBpZiAobjIuY2hpbGRyZW4gIT09IG4xLmNoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGFuY2hvciA9IGhvc3ROZXh0U2libGluZyhuMS5hbmNob3IpO1xyXG4gICAgICAgICAgICAvLyByZW1vdmUgZXhpc3RpbmdcclxuICAgICAgICAgICAgcmVtb3ZlU3RhdGljTm9kZShuMSk7XHJcbiAgICAgICAgICAgIFtuMi5lbCwgbjIuYW5jaG9yXSA9IGhvc3RJbnNlcnRTdGF0aWNDb250ZW50KG4yLmNoaWxkcmVuLCBjb250YWluZXIsIGFuY2hvciwgaXNTVkcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgbjIuZWwgPSBuMS5lbDtcclxuICAgICAgICAgICAgbjIuYW5jaG9yID0gbjEuYW5jaG9yO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBjb25zdCBtb3ZlU3RhdGljTm9kZSA9ICh7IGVsLCBhbmNob3IgfSwgY29udGFpbmVyLCBuZXh0U2libGluZykgPT4ge1xyXG4gICAgICAgIGxldCBuZXh0O1xyXG4gICAgICAgIHdoaWxlIChlbCAmJiBlbCAhPT0gYW5jaG9yKSB7XHJcbiAgICAgICAgICAgIG5leHQgPSBob3N0TmV4dFNpYmxpbmcoZWwpO1xyXG4gICAgICAgICAgICBob3N0SW5zZXJ0KGVsLCBjb250YWluZXIsIG5leHRTaWJsaW5nKTtcclxuICAgICAgICAgICAgZWwgPSBuZXh0O1xyXG4gICAgICAgIH1cclxuICAgICAgICBob3N0SW5zZXJ0KGFuY2hvciwgY29udGFpbmVyLCBuZXh0U2libGluZyk7XHJcbiAgICB9O1xyXG4gICAgY29uc3QgcmVtb3ZlU3RhdGljTm9kZSA9ICh7IGVsLCBhbmNob3IgfSkgPT4ge1xyXG4gICAgICAgIGxldCBuZXh0O1xyXG4gICAgICAgIHdoaWxlIChlbCAmJiBlbCAhPT0gYW5jaG9yKSB7XHJcbiAgICAgICAgICAgIG5leHQgPSBob3N0TmV4dFNpYmxpbmcoZWwpO1xyXG4gICAgICAgICAgICBob3N0UmVtb3ZlKGVsKTtcclxuICAgICAgICAgICAgZWwgPSBuZXh0O1xyXG4gICAgICAgIH1cclxuICAgICAgICBob3N0UmVtb3ZlKGFuY2hvcik7XHJcbiAgICB9O1xyXG4gICAgY29uc3QgcHJvY2Vzc0VsZW1lbnQgPSAobjEsIG4yLCBjb250YWluZXIsIGFuY2hvciwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKSA9PiB7XHJcbiAgICAgICAgaXNTVkcgPSBpc1NWRyB8fCBuMi50eXBlID09PSAnc3ZnJztcclxuICAgICAgICBpZiAobjEgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBtb3VudEVsZW1lbnQobjIsIGNvbnRhaW5lciwgYW5jaG9yLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCBpc1NWRywgc2xvdFNjb3BlSWRzLCBvcHRpbWl6ZWQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcGF0Y2hFbGVtZW50KG4xLCBuMiwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgY29uc3QgbW91bnRFbGVtZW50ID0gKHZub2RlLCBjb250YWluZXIsIGFuY2hvciwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKSA9PiB7XHJcbiAgICAgICAgbGV0IGVsO1xyXG4gICAgICAgIGxldCB2bm9kZUhvb2s7XHJcbiAgICAgICAgY29uc3QgeyB0eXBlLCBwcm9wcywgc2hhcGVGbGFnLCB0cmFuc2l0aW9uLCBwYXRjaEZsYWcsIGRpcnMgfSA9IHZub2RlO1xyXG4gICAgICAgIGlmICghKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmXHJcbiAgICAgICAgICAgIHZub2RlLmVsICYmXHJcbiAgICAgICAgICAgIGhvc3RDbG9uZU5vZGUgIT09IHVuZGVmaW5lZCAmJlxyXG4gICAgICAgICAgICBwYXRjaEZsYWcgPT09IC0xIC8qIEhPSVNURUQgKi8pIHtcclxuICAgICAgICAgICAgLy8gSWYgYSB2bm9kZSBoYXMgbm9uLW51bGwgZWwsIGl0IG1lYW5zIGl0J3MgYmVpbmcgcmV1c2VkLlxyXG4gICAgICAgICAgICAvLyBPbmx5IHN0YXRpYyB2bm9kZXMgY2FuIGJlIHJldXNlZCwgc28gaXRzIG1vdW50ZWQgRE9NIG5vZGVzIHNob3VsZCBiZVxyXG4gICAgICAgICAgICAvLyBleGFjdGx5IHRoZSBzYW1lLCBhbmQgd2UgY2FuIHNpbXBseSBkbyBhIGNsb25lIGhlcmUuXHJcbiAgICAgICAgICAgIC8vIG9ubHkgZG8gdGhpcyBpbiBwcm9kdWN0aW9uIHNpbmNlIGNsb25lZCB0cmVlcyBjYW5ub3QgYmUgSE1SIHVwZGF0ZWQuXHJcbiAgICAgICAgICAgIGVsID0gdm5vZGUuZWwgPSBob3N0Q2xvbmVOb2RlKHZub2RlLmVsKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGVsID0gdm5vZGUuZWwgPSBob3N0Q3JlYXRlRWxlbWVudCh2bm9kZS50eXBlLCBpc1NWRywgcHJvcHMgJiYgcHJvcHMuaXMsIHByb3BzKTtcclxuICAgICAgICAgICAgLy8gbW91bnQgY2hpbGRyZW4gZmlyc3QsIHNpbmNlIHNvbWUgcHJvcHMgbWF5IHJlbHkgb24gY2hpbGQgY29udGVudFxyXG4gICAgICAgICAgICAvLyBiZWluZyBhbHJlYWR5IHJlbmRlcmVkLCBlLmcuIGA8c2VsZWN0IHZhbHVlPmBcclxuICAgICAgICAgICAgaWYgKHNoYXBlRmxhZyAmIDggLyogVEVYVF9DSElMRFJFTiAqLykge1xyXG4gICAgICAgICAgICAgICAgaG9zdFNldEVsZW1lbnRUZXh0KGVsLCB2bm9kZS5jaGlsZHJlbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoc2hhcGVGbGFnICYgMTYgLyogQVJSQVlfQ0hJTERSRU4gKi8pIHtcclxuICAgICAgICAgICAgICAgIG1vdW50Q2hpbGRyZW4odm5vZGUuY2hpbGRyZW4sIGVsLCBudWxsLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCBpc1NWRyAmJiB0eXBlICE9PSAnZm9yZWlnbk9iamVjdCcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoZGlycykge1xyXG4gICAgICAgICAgICAgICAgaW52b2tlRGlyZWN0aXZlSG9vayh2bm9kZSwgbnVsbCwgcGFyZW50Q29tcG9uZW50LCAnY3JlYXRlZCcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIHByb3BzXHJcbiAgICAgICAgICAgIGlmIChwcm9wcykge1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gcHJvcHMpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoa2V5ICE9PSAndmFsdWUnICYmICFpc1Jlc2VydmVkUHJvcChrZXkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhvc3RQYXRjaFByb3AoZWwsIGtleSwgbnVsbCwgcHJvcHNba2V5XSwgaXNTVkcsIHZub2RlLmNoaWxkcmVuLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCB1bm1vdW50Q2hpbGRyZW4pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgICAgICogU3BlY2lhbCBjYXNlIGZvciBzZXR0aW5nIHZhbHVlIG9uIERPTSBlbGVtZW50czpcclxuICAgICAgICAgICAgICAgICAqIC0gaXQgY2FuIGJlIG9yZGVyLXNlbnNpdGl2ZSAoZS5nLiBzaG91bGQgYmUgc2V0ICphZnRlciogbWluL21heCwgIzIzMjUsICM0MDI0KVxyXG4gICAgICAgICAgICAgICAgICogLSBpdCBuZWVkcyB0byBiZSBmb3JjZWQgKCMxNDcxKVxyXG4gICAgICAgICAgICAgICAgICogIzIzNTMgcHJvcG9zZXMgYWRkaW5nIGFub3RoZXIgcmVuZGVyZXIgb3B0aW9uIHRvIGNvbmZpZ3VyZSB0aGlzLCBidXRcclxuICAgICAgICAgICAgICAgICAqIHRoZSBwcm9wZXJ0aWVzIGFmZmVjdHMgYXJlIHNvIGZpbml0ZSBpdCBpcyB3b3J0aCBzcGVjaWFsIGNhc2luZyBpdFxyXG4gICAgICAgICAgICAgICAgICogaGVyZSB0byByZWR1Y2UgdGhlIGNvbXBsZXhpdHkuIChTcGVjaWFsIGNhc2luZyBpdCBhbHNvIHNob3VsZCBub3RcclxuICAgICAgICAgICAgICAgICAqIGFmZmVjdCBub24tRE9NIHJlbmRlcmVycylcclxuICAgICAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICAgICAgaWYgKCd2YWx1ZScgaW4gcHJvcHMpIHtcclxuICAgICAgICAgICAgICAgICAgICBob3N0UGF0Y2hQcm9wKGVsLCAndmFsdWUnLCBudWxsLCBwcm9wcy52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoKHZub2RlSG9vayA9IHByb3BzLm9uVm5vZGVCZWZvcmVNb3VudCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpbnZva2VWTm9kZUhvb2sodm5vZGVIb29rLCBwYXJlbnRDb21wb25lbnQsIHZub2RlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBzY29wZUlkXHJcbiAgICAgICAgICAgIHNldFNjb3BlSWQoZWwsIHZub2RlLCB2bm9kZS5zY29wZUlkLCBzbG90U2NvcGVJZHMsIHBhcmVudENvbXBvbmVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgfHwgX19WVUVfUFJPRF9ERVZUT09MU19fKSB7XHJcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlbCwgJ19fdm5vZGUnLCB7XHJcbiAgICAgICAgICAgICAgICB2YWx1ZTogdm5vZGUsXHJcbiAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGVsLCAnX192dWVQYXJlbnRDb21wb25lbnQnLCB7XHJcbiAgICAgICAgICAgICAgICB2YWx1ZTogcGFyZW50Q29tcG9uZW50LFxyXG4gICAgICAgICAgICAgICAgZW51bWVyYWJsZTogZmFsc2VcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChkaXJzKSB7XHJcbiAgICAgICAgICAgIGludm9rZURpcmVjdGl2ZUhvb2sodm5vZGUsIG51bGwsIHBhcmVudENvbXBvbmVudCwgJ2JlZm9yZU1vdW50Jyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vICMxNTgzIEZvciBpbnNpZGUgc3VzcGVuc2UgKyBzdXNwZW5zZSBub3QgcmVzb2x2ZWQgY2FzZSwgZW50ZXIgaG9vayBzaG91bGQgY2FsbCB3aGVuIHN1c3BlbnNlIHJlc29sdmVkXHJcbiAgICAgICAgLy8gIzE2ODkgRm9yIGluc2lkZSBzdXNwZW5zZSArIHN1c3BlbnNlIHJlc29sdmVkIGNhc2UsIGp1c3QgY2FsbCBpdFxyXG4gICAgICAgIGNvbnN0IG5lZWRDYWxsVHJhbnNpdGlvbkhvb2tzID0gKCFwYXJlbnRTdXNwZW5zZSB8fCAocGFyZW50U3VzcGVuc2UgJiYgIXBhcmVudFN1c3BlbnNlLnBlbmRpbmdCcmFuY2gpKSAmJlxyXG4gICAgICAgICAgICB0cmFuc2l0aW9uICYmXHJcbiAgICAgICAgICAgICF0cmFuc2l0aW9uLnBlcnNpc3RlZDtcclxuICAgICAgICBpZiAobmVlZENhbGxUcmFuc2l0aW9uSG9va3MpIHtcclxuICAgICAgICAgICAgdHJhbnNpdGlvbi5iZWZvcmVFbnRlcihlbCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGhvc3RJbnNlcnQoZWwsIGNvbnRhaW5lciwgYW5jaG9yKTtcclxuICAgICAgICBpZiAoKHZub2RlSG9vayA9IHByb3BzICYmIHByb3BzLm9uVm5vZGVNb3VudGVkKSB8fFxyXG4gICAgICAgICAgICBuZWVkQ2FsbFRyYW5zaXRpb25Ib29rcyB8fFxyXG4gICAgICAgICAgICBkaXJzKSB7XHJcbiAgICAgICAgICAgIHF1ZXVlUG9zdFJlbmRlckVmZmVjdCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB2bm9kZUhvb2sgJiYgaW52b2tlVk5vZGVIb29rKHZub2RlSG9vaywgcGFyZW50Q29tcG9uZW50LCB2bm9kZSk7XHJcbiAgICAgICAgICAgICAgICBuZWVkQ2FsbFRyYW5zaXRpb25Ib29rcyAmJiB0cmFuc2l0aW9uLmVudGVyKGVsKTtcclxuICAgICAgICAgICAgICAgIGRpcnMgJiYgaW52b2tlRGlyZWN0aXZlSG9vayh2bm9kZSwgbnVsbCwgcGFyZW50Q29tcG9uZW50LCAnbW91bnRlZCcpO1xyXG4gICAgICAgICAgICB9LCBwYXJlbnRTdXNwZW5zZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGNvbnN0IHNldFNjb3BlSWQgPSAoZWwsIHZub2RlLCBzY29wZUlkLCBzbG90U2NvcGVJZHMsIHBhcmVudENvbXBvbmVudCkgPT4ge1xyXG4gICAgICAgIGlmIChzY29wZUlkKSB7XHJcbiAgICAgICAgICAgIGhvc3RTZXRTY29wZUlkKGVsLCBzY29wZUlkKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHNsb3RTY29wZUlkcykge1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNsb3RTY29wZUlkcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgaG9zdFNldFNjb3BlSWQoZWwsIHNsb3RTY29wZUlkc1tpXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHBhcmVudENvbXBvbmVudCkge1xyXG4gICAgICAgICAgICBsZXQgc3ViVHJlZSA9IHBhcmVudENvbXBvbmVudC5zdWJUcmVlO1xyXG4gICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmXHJcbiAgICAgICAgICAgICAgICBzdWJUcmVlLnBhdGNoRmxhZyA+IDAgJiZcclxuICAgICAgICAgICAgICAgIHN1YlRyZWUucGF0Y2hGbGFnICYgMjA0OCAvKiBERVZfUk9PVF9GUkFHTUVOVCAqLykge1xyXG4gICAgICAgICAgICAgICAgc3ViVHJlZSA9XHJcbiAgICAgICAgICAgICAgICAgICAgZmlsdGVyU2luZ2xlUm9vdChzdWJUcmVlLmNoaWxkcmVuKSB8fCBzdWJUcmVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh2bm9kZSA9PT0gc3ViVHJlZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcGFyZW50Vk5vZGUgPSBwYXJlbnRDb21wb25lbnQudm5vZGU7XHJcbiAgICAgICAgICAgICAgICBzZXRTY29wZUlkKGVsLCBwYXJlbnRWTm9kZSwgcGFyZW50Vk5vZGUuc2NvcGVJZCwgcGFyZW50Vk5vZGUuc2xvdFNjb3BlSWRzLCBwYXJlbnRDb21wb25lbnQucGFyZW50KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBjb25zdCBtb3VudENoaWxkcmVuID0gKGNoaWxkcmVuLCBjb250YWluZXIsIGFuY2hvciwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkLCBzdGFydCA9IDApID0+IHtcclxuICAgICAgICBmb3IgKGxldCBpID0gc3RhcnQ7IGkgPCBjaGlsZHJlbi5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBjb25zdCBjaGlsZCA9IChjaGlsZHJlbltpXSA9IG9wdGltaXplZFxyXG4gICAgICAgICAgICAgICAgPyBjbG9uZUlmTW91bnRlZChjaGlsZHJlbltpXSlcclxuICAgICAgICAgICAgICAgIDogbm9ybWFsaXplVk5vZGUoY2hpbGRyZW5baV0pKTtcclxuICAgICAgICAgICAgcGF0Y2gobnVsbCwgY2hpbGQsIGNvbnRhaW5lciwgYW5jaG9yLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCBpc1NWRywgc2xvdFNjb3BlSWRzLCBvcHRpbWl6ZWQpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBjb25zdCBwYXRjaEVsZW1lbnQgPSAobjEsIG4yLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCBpc1NWRywgc2xvdFNjb3BlSWRzLCBvcHRpbWl6ZWQpID0+IHtcclxuICAgICAgICBjb25zdCBlbCA9IChuMi5lbCA9IG4xLmVsKTtcclxuICAgICAgICBsZXQgeyBwYXRjaEZsYWcsIGR5bmFtaWNDaGlsZHJlbiwgZGlycyB9ID0gbjI7XHJcbiAgICAgICAgLy8gIzE0MjYgdGFrZSB0aGUgb2xkIHZub2RlJ3MgcGF0Y2ggZmxhZyBpbnRvIGFjY291bnQgc2luY2UgdXNlciBtYXkgY2xvbmUgYVxyXG4gICAgICAgIC8vIGNvbXBpbGVyLWdlbmVyYXRlZCB2bm9kZSwgd2hpY2ggZGUtb3B0cyB0byBGVUxMX1BST1BTXHJcbiAgICAgICAgcGF0Y2hGbGFnIHw9IG4xLnBhdGNoRmxhZyAmIDE2IC8qIEZVTExfUFJPUFMgKi87XHJcbiAgICAgICAgY29uc3Qgb2xkUHJvcHMgPSBuMS5wcm9wcyB8fCBFTVBUWV9PQko7XHJcbiAgICAgICAgY29uc3QgbmV3UHJvcHMgPSBuMi5wcm9wcyB8fCBFTVBUWV9PQko7XHJcbiAgICAgICAgbGV0IHZub2RlSG9vaztcclxuICAgICAgICAvLyBkaXNhYmxlIHJlY3Vyc2UgaW4gYmVmb3JlVXBkYXRlIGhvb2tzXHJcbiAgICAgICAgcGFyZW50Q29tcG9uZW50ICYmIHRvZ2dsZVJlY3Vyc2UocGFyZW50Q29tcG9uZW50LCBmYWxzZSk7XHJcbiAgICAgICAgaWYgKCh2bm9kZUhvb2sgPSBuZXdQcm9wcy5vblZub2RlQmVmb3JlVXBkYXRlKSkge1xyXG4gICAgICAgICAgICBpbnZva2VWTm9kZUhvb2sodm5vZGVIb29rLCBwYXJlbnRDb21wb25lbnQsIG4yLCBuMSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChkaXJzKSB7XHJcbiAgICAgICAgICAgIGludm9rZURpcmVjdGl2ZUhvb2sobjIsIG4xLCBwYXJlbnRDb21wb25lbnQsICdiZWZvcmVVcGRhdGUnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcGFyZW50Q29tcG9uZW50ICYmIHRvZ2dsZVJlY3Vyc2UocGFyZW50Q29tcG9uZW50LCB0cnVlKTtcclxuICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmIGlzSG1yVXBkYXRpbmcpIHtcclxuICAgICAgICAgICAgLy8gSE1SIHVwZGF0ZWQsIGZvcmNlIGZ1bGwgZGlmZlxyXG4gICAgICAgICAgICBwYXRjaEZsYWcgPSAwO1xyXG4gICAgICAgICAgICBvcHRpbWl6ZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgZHluYW1pY0NoaWxkcmVuID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgYXJlQ2hpbGRyZW5TVkcgPSBpc1NWRyAmJiBuMi50eXBlICE9PSAnZm9yZWlnbk9iamVjdCc7XHJcbiAgICAgICAgaWYgKGR5bmFtaWNDaGlsZHJlbikge1xyXG4gICAgICAgICAgICBwYXRjaEJsb2NrQ2hpbGRyZW4objEuZHluYW1pY0NoaWxkcmVuLCBkeW5hbWljQ2hpbGRyZW4sIGVsLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCBhcmVDaGlsZHJlblNWRywgc2xvdFNjb3BlSWRzKTtcclxuICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiBwYXJlbnRDb21wb25lbnQgJiYgcGFyZW50Q29tcG9uZW50LnR5cGUuX19obXJJZCkge1xyXG4gICAgICAgICAgICAgICAgdHJhdmVyc2VTdGF0aWNDaGlsZHJlbihuMSwgbjIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKCFvcHRpbWl6ZWQpIHtcclxuICAgICAgICAgICAgLy8gZnVsbCBkaWZmXHJcbiAgICAgICAgICAgIHBhdGNoQ2hpbGRyZW4objEsIG4yLCBlbCwgbnVsbCwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgYXJlQ2hpbGRyZW5TVkcsIHNsb3RTY29wZUlkcywgZmFsc2UpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocGF0Y2hGbGFnID4gMCkge1xyXG4gICAgICAgICAgICAvLyB0aGUgcHJlc2VuY2Ugb2YgYSBwYXRjaEZsYWcgbWVhbnMgdGhpcyBlbGVtZW50J3MgcmVuZGVyIGNvZGUgd2FzXHJcbiAgICAgICAgICAgIC8vIGdlbmVyYXRlZCBieSB0aGUgY29tcGlsZXIgYW5kIGNhbiB0YWtlIHRoZSBmYXN0IHBhdGguXHJcbiAgICAgICAgICAgIC8vIGluIHRoaXMgcGF0aCBvbGQgbm9kZSBhbmQgbmV3IG5vZGUgYXJlIGd1YXJhbnRlZWQgdG8gaGF2ZSB0aGUgc2FtZSBzaGFwZVxyXG4gICAgICAgICAgICAvLyAoaS5lLiBhdCB0aGUgZXhhY3Qgc2FtZSBwb3NpdGlvbiBpbiB0aGUgc291cmNlIHRlbXBsYXRlKVxyXG4gICAgICAgICAgICBpZiAocGF0Y2hGbGFnICYgMTYgLyogRlVMTF9QUk9QUyAqLykge1xyXG4gICAgICAgICAgICAgICAgLy8gZWxlbWVudCBwcm9wcyBjb250YWluIGR5bmFtaWMga2V5cywgZnVsbCBkaWZmIG5lZWRlZFxyXG4gICAgICAgICAgICAgICAgcGF0Y2hQcm9wcyhlbCwgbjIsIG9sZFByb3BzLCBuZXdQcm9wcywgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gY2xhc3NcclxuICAgICAgICAgICAgICAgIC8vIHRoaXMgZmxhZyBpcyBtYXRjaGVkIHdoZW4gdGhlIGVsZW1lbnQgaGFzIGR5bmFtaWMgY2xhc3MgYmluZGluZ3MuXHJcbiAgICAgICAgICAgICAgICBpZiAocGF0Y2hGbGFnICYgMiAvKiBDTEFTUyAqLykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvbGRQcm9wcy5jbGFzcyAhPT0gbmV3UHJvcHMuY2xhc3MpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaG9zdFBhdGNoUHJvcChlbCwgJ2NsYXNzJywgbnVsbCwgbmV3UHJvcHMuY2xhc3MsIGlzU1ZHKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyBzdHlsZVxyXG4gICAgICAgICAgICAgICAgLy8gdGhpcyBmbGFnIGlzIG1hdGNoZWQgd2hlbiB0aGUgZWxlbWVudCBoYXMgZHluYW1pYyBzdHlsZSBiaW5kaW5nc1xyXG4gICAgICAgICAgICAgICAgaWYgKHBhdGNoRmxhZyAmIDQgLyogU1RZTEUgKi8pIHtcclxuICAgICAgICAgICAgICAgICAgICBob3N0UGF0Y2hQcm9wKGVsLCAnc3R5bGUnLCBvbGRQcm9wcy5zdHlsZSwgbmV3UHJvcHMuc3R5bGUsIGlzU1ZHKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIHByb3BzXHJcbiAgICAgICAgICAgICAgICAvLyBUaGlzIGZsYWcgaXMgbWF0Y2hlZCB3aGVuIHRoZSBlbGVtZW50IGhhcyBkeW5hbWljIHByb3AvYXR0ciBiaW5kaW5nc1xyXG4gICAgICAgICAgICAgICAgLy8gb3RoZXIgdGhhbiBjbGFzcyBhbmQgc3R5bGUuIFRoZSBrZXlzIG9mIGR5bmFtaWMgcHJvcC9hdHRycyBhcmUgc2F2ZWQgZm9yXHJcbiAgICAgICAgICAgICAgICAvLyBmYXN0ZXIgaXRlcmF0aW9uLlxyXG4gICAgICAgICAgICAgICAgLy8gTm90ZSBkeW5hbWljIGtleXMgbGlrZSA6W2Zvb109XCJiYXJcIiB3aWxsIGNhdXNlIHRoaXMgb3B0aW1pemF0aW9uIHRvXHJcbiAgICAgICAgICAgICAgICAvLyBiYWlsIG91dCBhbmQgZ28gdGhyb3VnaCBhIGZ1bGwgZGlmZiBiZWNhdXNlIHdlIG5lZWQgdG8gdW5zZXQgdGhlIG9sZCBrZXlcclxuICAgICAgICAgICAgICAgIGlmIChwYXRjaEZsYWcgJiA4IC8qIFBST1BTICovKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgdGhlIGZsYWcgaXMgcHJlc2VudCB0aGVuIGR5bmFtaWNQcm9wcyBtdXN0IGJlIG5vbi1udWxsXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJvcHNUb1VwZGF0ZSA9IG4yLmR5bmFtaWNQcm9wcztcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHByb3BzVG9VcGRhdGUubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qga2V5ID0gcHJvcHNUb1VwZGF0ZVtpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJldiA9IG9sZFByb3BzW2tleV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5leHQgPSBuZXdQcm9wc1trZXldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAjMTQ3MSBmb3JjZSBwYXRjaCB2YWx1ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobmV4dCAhPT0gcHJldiB8fCBrZXkgPT09ICd2YWx1ZScpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvc3RQYXRjaFByb3AoZWwsIGtleSwgcHJldiwgbmV4dCwgaXNTVkcsIG4xLmNoaWxkcmVuLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCB1bm1vdW50Q2hpbGRyZW4pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIHRleHRcclxuICAgICAgICAgICAgLy8gVGhpcyBmbGFnIGlzIG1hdGNoZWQgd2hlbiB0aGUgZWxlbWVudCBoYXMgb25seSBkeW5hbWljIHRleHQgY2hpbGRyZW4uXHJcbiAgICAgICAgICAgIGlmIChwYXRjaEZsYWcgJiAxIC8qIFRFWFQgKi8pIHtcclxuICAgICAgICAgICAgICAgIGlmIChuMS5jaGlsZHJlbiAhPT0gbjIuY2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgICAgICAgICBob3N0U2V0RWxlbWVudFRleHQoZWwsIG4yLmNoaWxkcmVuKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICghb3B0aW1pemVkICYmIGR5bmFtaWNDaGlsZHJlbiA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIC8vIHVub3B0aW1pemVkLCBmdWxsIGRpZmZcclxuICAgICAgICAgICAgcGF0Y2hQcm9wcyhlbCwgbjIsIG9sZFByb3BzLCBuZXdQcm9wcywgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoKHZub2RlSG9vayA9IG5ld1Byb3BzLm9uVm5vZGVVcGRhdGVkKSB8fCBkaXJzKSB7XHJcbiAgICAgICAgICAgIHF1ZXVlUG9zdFJlbmRlckVmZmVjdCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB2bm9kZUhvb2sgJiYgaW52b2tlVk5vZGVIb29rKHZub2RlSG9vaywgcGFyZW50Q29tcG9uZW50LCBuMiwgbjEpO1xyXG4gICAgICAgICAgICAgICAgZGlycyAmJiBpbnZva2VEaXJlY3RpdmVIb29rKG4yLCBuMSwgcGFyZW50Q29tcG9uZW50LCAndXBkYXRlZCcpO1xyXG4gICAgICAgICAgICB9LCBwYXJlbnRTdXNwZW5zZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8vIFRoZSBmYXN0IHBhdGggZm9yIGJsb2Nrcy5cclxuICAgIGNvbnN0IHBhdGNoQmxvY2tDaGlsZHJlbiA9IChvbGRDaGlsZHJlbiwgbmV3Q2hpbGRyZW4sIGZhbGxiYWNrQ29udGFpbmVyLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCBpc1NWRywgc2xvdFNjb3BlSWRzKSA9PiB7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuZXdDaGlsZHJlbi5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBjb25zdCBvbGRWTm9kZSA9IG9sZENoaWxkcmVuW2ldO1xyXG4gICAgICAgICAgICBjb25zdCBuZXdWTm9kZSA9IG5ld0NoaWxkcmVuW2ldO1xyXG4gICAgICAgICAgICAvLyBEZXRlcm1pbmUgdGhlIGNvbnRhaW5lciAocGFyZW50IGVsZW1lbnQpIGZvciB0aGUgcGF0Y2guXHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IFxyXG4gICAgICAgICAgICAvLyBvbGRWTm9kZSBtYXkgYmUgYW4gZXJyb3JlZCBhc3luYyBzZXR1cCgpIGNvbXBvbmVudCBpbnNpZGUgU3VzcGVuc2VcclxuICAgICAgICAgICAgLy8gd2hpY2ggd2lsbCBub3QgaGF2ZSBhIG1vdW50ZWQgZWxlbWVudFxyXG4gICAgICAgICAgICBvbGRWTm9kZS5lbCAmJlxyXG4gICAgICAgICAgICAgICAgLy8gLSBJbiB0aGUgY2FzZSBvZiBhIEZyYWdtZW50LCB3ZSBuZWVkIHRvIHByb3ZpZGUgdGhlIGFjdHVhbCBwYXJlbnRcclxuICAgICAgICAgICAgICAgIC8vIG9mIHRoZSBGcmFnbWVudCBpdHNlbGYgc28gaXQgY2FuIG1vdmUgaXRzIGNoaWxkcmVuLlxyXG4gICAgICAgICAgICAgICAgKG9sZFZOb2RlLnR5cGUgPT09IEZyYWdtZW50IHx8XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gLSBJbiB0aGUgY2FzZSBvZiBkaWZmZXJlbnQgbm9kZXMsIHRoZXJlIGlzIGdvaW5nIHRvIGJlIGEgcmVwbGFjZW1lbnRcclxuICAgICAgICAgICAgICAgICAgICAvLyB3aGljaCBhbHNvIHJlcXVpcmVzIHRoZSBjb3JyZWN0IHBhcmVudCBjb250YWluZXJcclxuICAgICAgICAgICAgICAgICAgICAhaXNTYW1lVk5vZGVUeXBlKG9sZFZOb2RlLCBuZXdWTm9kZSkgfHxcclxuICAgICAgICAgICAgICAgICAgICAvLyAtIEluIHRoZSBjYXNlIG9mIGEgY29tcG9uZW50LCBpdCBjb3VsZCBjb250YWluIGFueXRoaW5nLlxyXG4gICAgICAgICAgICAgICAgICAgIG9sZFZOb2RlLnNoYXBlRmxhZyAmICg2IC8qIENPTVBPTkVOVCAqLyB8IDY0IC8qIFRFTEVQT1JUICovKSlcclxuICAgICAgICAgICAgICAgID8gaG9zdFBhcmVudE5vZGUob2xkVk5vZGUuZWwpXHJcbiAgICAgICAgICAgICAgICA6IC8vIEluIG90aGVyIGNhc2VzLCB0aGUgcGFyZW50IGNvbnRhaW5lciBpcyBub3QgYWN0dWFsbHkgdXNlZCBzbyB3ZVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGp1c3QgcGFzcyB0aGUgYmxvY2sgZWxlbWVudCBoZXJlIHRvIGF2b2lkIGEgRE9NIHBhcmVudE5vZGUgY2FsbC5cclxuICAgICAgICAgICAgICAgICAgICBmYWxsYmFja0NvbnRhaW5lcjtcclxuICAgICAgICAgICAgcGF0Y2gob2xkVk5vZGUsIG5ld1ZOb2RlLCBjb250YWluZXIsIG51bGwsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIGlzU1ZHLCBzbG90U2NvcGVJZHMsIHRydWUpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBjb25zdCBwYXRjaFByb3BzID0gKGVsLCB2bm9kZSwgb2xkUHJvcHMsIG5ld1Byb3BzLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCBpc1NWRykgPT4ge1xyXG4gICAgICAgIGlmIChvbGRQcm9wcyAhPT0gbmV3UHJvcHMpIHtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gbmV3UHJvcHMpIHtcclxuICAgICAgICAgICAgICAgIC8vIGVtcHR5IHN0cmluZyBpcyBub3QgdmFsaWQgcHJvcFxyXG4gICAgICAgICAgICAgICAgaWYgKGlzUmVzZXJ2ZWRQcm9wKGtleSkpXHJcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuZXh0ID0gbmV3UHJvcHNba2V5XTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHByZXYgPSBvbGRQcm9wc1trZXldO1xyXG4gICAgICAgICAgICAgICAgLy8gZGVmZXIgcGF0Y2hpbmcgdmFsdWVcclxuICAgICAgICAgICAgICAgIGlmIChuZXh0ICE9PSBwcmV2ICYmIGtleSAhPT0gJ3ZhbHVlJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGhvc3RQYXRjaFByb3AoZWwsIGtleSwgcHJldiwgbmV4dCwgaXNTVkcsIHZub2RlLmNoaWxkcmVuLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCB1bm1vdW50Q2hpbGRyZW4pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChvbGRQcm9wcyAhPT0gRU1QVFlfT0JKKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBvbGRQcm9wcykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghaXNSZXNlcnZlZFByb3Aoa2V5KSAmJiAhKGtleSBpbiBuZXdQcm9wcykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaG9zdFBhdGNoUHJvcChlbCwga2V5LCBvbGRQcm9wc1trZXldLCBudWxsLCBpc1NWRywgdm5vZGUuY2hpbGRyZW4sIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIHVubW91bnRDaGlsZHJlbik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICgndmFsdWUnIGluIG5ld1Byb3BzKSB7XHJcbiAgICAgICAgICAgICAgICBob3N0UGF0Y2hQcm9wKGVsLCAndmFsdWUnLCBvbGRQcm9wcy52YWx1ZSwgbmV3UHJvcHMudmFsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGNvbnN0IHByb2Nlc3NGcmFnbWVudCA9IChuMSwgbjIsIGNvbnRhaW5lciwgYW5jaG9yLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCBpc1NWRywgc2xvdFNjb3BlSWRzLCBvcHRpbWl6ZWQpID0+IHtcclxuICAgICAgICBjb25zdCBmcmFnbWVudFN0YXJ0QW5jaG9yID0gKG4yLmVsID0gbjEgPyBuMS5lbCA6IGhvc3RDcmVhdGVUZXh0KCcnKSk7XHJcbiAgICAgICAgY29uc3QgZnJhZ21lbnRFbmRBbmNob3IgPSAobjIuYW5jaG9yID0gbjEgPyBuMS5hbmNob3IgOiBob3N0Q3JlYXRlVGV4dCgnJykpO1xyXG4gICAgICAgIGxldCB7IHBhdGNoRmxhZywgZHluYW1pY0NoaWxkcmVuLCBzbG90U2NvcGVJZHM6IGZyYWdtZW50U2xvdFNjb3BlSWRzIH0gPSBuMjtcclxuICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmIGlzSG1yVXBkYXRpbmcpIHtcclxuICAgICAgICAgICAgLy8gSE1SIHVwZGF0ZWQsIGZvcmNlIGZ1bGwgZGlmZlxyXG4gICAgICAgICAgICBwYXRjaEZsYWcgPSAwO1xyXG4gICAgICAgICAgICBvcHRpbWl6ZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgZHluYW1pY0NoaWxkcmVuID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gY2hlY2sgaWYgdGhpcyBpcyBhIHNsb3QgZnJhZ21lbnQgd2l0aCA6c2xvdHRlZCBzY29wZSBpZHNcclxuICAgICAgICBpZiAoZnJhZ21lbnRTbG90U2NvcGVJZHMpIHtcclxuICAgICAgICAgICAgc2xvdFNjb3BlSWRzID0gc2xvdFNjb3BlSWRzXHJcbiAgICAgICAgICAgICAgICA/IHNsb3RTY29wZUlkcy5jb25jYXQoZnJhZ21lbnRTbG90U2NvcGVJZHMpXHJcbiAgICAgICAgICAgICAgICA6IGZyYWdtZW50U2xvdFNjb3BlSWRzO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAobjEgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBob3N0SW5zZXJ0KGZyYWdtZW50U3RhcnRBbmNob3IsIGNvbnRhaW5lciwgYW5jaG9yKTtcclxuICAgICAgICAgICAgaG9zdEluc2VydChmcmFnbWVudEVuZEFuY2hvciwgY29udGFpbmVyLCBhbmNob3IpO1xyXG4gICAgICAgICAgICAvLyBhIGZyYWdtZW50IGNhbiBvbmx5IGhhdmUgYXJyYXkgY2hpbGRyZW5cclxuICAgICAgICAgICAgLy8gc2luY2UgdGhleSBhcmUgZWl0aGVyIGdlbmVyYXRlZCBieSB0aGUgY29tcGlsZXIsIG9yIGltcGxpY2l0bHkgY3JlYXRlZFxyXG4gICAgICAgICAgICAvLyBmcm9tIGFycmF5cy5cclxuICAgICAgICAgICAgbW91bnRDaGlsZHJlbihuMi5jaGlsZHJlbiwgY29udGFpbmVyLCBmcmFnbWVudEVuZEFuY2hvciwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGlmIChwYXRjaEZsYWcgPiAwICYmXHJcbiAgICAgICAgICAgICAgICBwYXRjaEZsYWcgJiA2NCAvKiBTVEFCTEVfRlJBR01FTlQgKi8gJiZcclxuICAgICAgICAgICAgICAgIGR5bmFtaWNDaGlsZHJlbiAmJlxyXG4gICAgICAgICAgICAgICAgLy8gIzI3MTUgdGhlIHByZXZpb3VzIGZyYWdtZW50IGNvdWxkJ3ZlIGJlZW4gYSBCQUlMZWQgb25lIGFzIGEgcmVzdWx0XHJcbiAgICAgICAgICAgICAgICAvLyBvZiByZW5kZXJTbG90KCkgd2l0aCBubyB2YWxpZCBjaGlsZHJlblxyXG4gICAgICAgICAgICAgICAgbjEuZHluYW1pY0NoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBhIHN0YWJsZSBmcmFnbWVudCAodGVtcGxhdGUgcm9vdCBvciA8dGVtcGxhdGUgdi1mb3I+KSBkb2Vzbid0IG5lZWQgdG9cclxuICAgICAgICAgICAgICAgIC8vIHBhdGNoIGNoaWxkcmVuIG9yZGVyLCBidXQgaXQgbWF5IGNvbnRhaW4gZHluYW1pY0NoaWxkcmVuLlxyXG4gICAgICAgICAgICAgICAgcGF0Y2hCbG9ja0NoaWxkcmVuKG4xLmR5bmFtaWNDaGlsZHJlbiwgZHluYW1pY0NoaWxkcmVuLCBjb250YWluZXIsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIGlzU1ZHLCBzbG90U2NvcGVJZHMpO1xyXG4gICAgICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiBwYXJlbnRDb21wb25lbnQgJiYgcGFyZW50Q29tcG9uZW50LnR5cGUuX19obXJJZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRyYXZlcnNlU3RhdGljQ2hpbGRyZW4objEsIG4yKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKFxyXG4gICAgICAgICAgICAgICAgLy8gIzIwODAgaWYgdGhlIHN0YWJsZSBmcmFnbWVudCBoYXMgYSBrZXksIGl0J3MgYSA8dGVtcGxhdGUgdi1mb3I+IHRoYXQgbWF5XHJcbiAgICAgICAgICAgICAgICAvLyAgZ2V0IG1vdmVkIGFyb3VuZC4gTWFrZSBzdXJlIGFsbCByb290IGxldmVsIHZub2RlcyBpbmhlcml0IGVsLlxyXG4gICAgICAgICAgICAgICAgLy8gIzIxMzQgb3IgaWYgaXQncyBhIGNvbXBvbmVudCByb290LCBpdCBtYXkgYWxzbyBnZXQgbW92ZWQgYXJvdW5kXHJcbiAgICAgICAgICAgICAgICAvLyBhcyB0aGUgY29tcG9uZW50IGlzIGJlaW5nIG1vdmVkLlxyXG4gICAgICAgICAgICAgICAgbjIua2V5ICE9IG51bGwgfHxcclxuICAgICAgICAgICAgICAgICAgICAocGFyZW50Q29tcG9uZW50ICYmIG4yID09PSBwYXJlbnRDb21wb25lbnQuc3ViVHJlZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0cmF2ZXJzZVN0YXRpY0NoaWxkcmVuKG4xLCBuMiwgdHJ1ZSAvKiBzaGFsbG93ICovKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIGtleWVkIC8gdW5rZXllZCwgb3IgbWFudWFsIGZyYWdtZW50cy5cclxuICAgICAgICAgICAgICAgIC8vIGZvciBrZXllZCAmIHVua2V5ZWQsIHNpbmNlIHRoZXkgYXJlIGNvbXBpbGVyIGdlbmVyYXRlZCBmcm9tIHYtZm9yLFxyXG4gICAgICAgICAgICAgICAgLy8gZWFjaCBjaGlsZCBpcyBndWFyYW50ZWVkIHRvIGJlIGEgYmxvY2sgc28gdGhlIGZyYWdtZW50IHdpbGwgbmV2ZXJcclxuICAgICAgICAgICAgICAgIC8vIGhhdmUgZHluYW1pY0NoaWxkcmVuLlxyXG4gICAgICAgICAgICAgICAgcGF0Y2hDaGlsZHJlbihuMSwgbjIsIGNvbnRhaW5lciwgZnJhZ21lbnRFbmRBbmNob3IsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIGlzU1ZHLCBzbG90U2NvcGVJZHMsIG9wdGltaXplZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgY29uc3QgcHJvY2Vzc0NvbXBvbmVudCA9IChuMSwgbjIsIGNvbnRhaW5lciwgYW5jaG9yLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCBpc1NWRywgc2xvdFNjb3BlSWRzLCBvcHRpbWl6ZWQpID0+IHtcclxuICAgICAgICBuMi5zbG90U2NvcGVJZHMgPSBzbG90U2NvcGVJZHM7XHJcbiAgICAgICAgaWYgKG4xID09IG51bGwpIHtcclxuICAgICAgICAgICAgaWYgKG4yLnNoYXBlRmxhZyAmIDUxMiAvKiBDT01QT05FTlRfS0VQVF9BTElWRSAqLykge1xyXG4gICAgICAgICAgICAgICAgcGFyZW50Q29tcG9uZW50LmN0eC5hY3RpdmF0ZShuMiwgY29udGFpbmVyLCBhbmNob3IsIGlzU1ZHLCBvcHRpbWl6ZWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbW91bnRDb21wb25lbnQobjIsIGNvbnRhaW5lciwgYW5jaG9yLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCBpc1NWRywgb3B0aW1pemVkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdXBkYXRlQ29tcG9uZW50KG4xLCBuMiwgb3B0aW1pemVkKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgY29uc3QgbW91bnRDb21wb25lbnQgPSAoaW5pdGlhbFZOb2RlLCBjb250YWluZXIsIGFuY2hvciwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcsIG9wdGltaXplZCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGluc3RhbmNlID0gKGluaXRpYWxWTm9kZS5jb21wb25lbnQgPSBjcmVhdGVDb21wb25lbnRJbnN0YW5jZShpbml0aWFsVk5vZGUsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UpKTtcclxuICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmIGluc3RhbmNlLnR5cGUuX19obXJJZCkge1xyXG4gICAgICAgICAgICByZWdpc3RlckhNUihpbnN0YW5jZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgcHVzaFdhcm5pbmdDb250ZXh0KGluaXRpYWxWTm9kZSk7XHJcbiAgICAgICAgICAgIHN0YXJ0TWVhc3VyZShpbnN0YW5jZSwgYG1vdW50YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGluamVjdCByZW5kZXJlciBpbnRlcm5hbHMgZm9yIGtlZXBBbGl2ZVxyXG4gICAgICAgIGlmIChpc0tlZXBBbGl2ZShpbml0aWFsVk5vZGUpKSB7XHJcbiAgICAgICAgICAgIGluc3RhbmNlLmN0eC5yZW5kZXJlciA9IGludGVybmFscztcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gcmVzb2x2ZSBwcm9wcyBhbmQgc2xvdHMgZm9yIHNldHVwIGNvbnRleHRcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgIHN0YXJ0TWVhc3VyZShpbnN0YW5jZSwgYGluaXRgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzZXR1cENvbXBvbmVudChpbnN0YW5jZSk7XHJcbiAgICAgICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgIGVuZE1lYXN1cmUoaW5zdGFuY2UsIGBpbml0YCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gc2V0dXAoKSBpcyBhc3luYy4gVGhpcyBjb21wb25lbnQgcmVsaWVzIG9uIGFzeW5jIGxvZ2ljIHRvIGJlIHJlc29sdmVkXHJcbiAgICAgICAgLy8gYmVmb3JlIHByb2NlZWRpbmdcclxuICAgICAgICBpZiAoaW5zdGFuY2UuYXN5bmNEZXApIHtcclxuICAgICAgICAgICAgcGFyZW50U3VzcGVuc2UgJiYgcGFyZW50U3VzcGVuc2UucmVnaXN0ZXJEZXAoaW5zdGFuY2UsIHNldHVwUmVuZGVyRWZmZWN0KTtcclxuICAgICAgICAgICAgLy8gR2l2ZSBpdCBhIHBsYWNlaG9sZGVyIGlmIHRoaXMgaXMgbm90IGh5ZHJhdGlvblxyXG4gICAgICAgICAgICAvLyBUT0RPIGhhbmRsZSBzZWxmLWRlZmluZWQgZmFsbGJhY2tcclxuICAgICAgICAgICAgaWYgKCFpbml0aWFsVk5vZGUuZWwpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHBsYWNlaG9sZGVyID0gKGluc3RhbmNlLnN1YlRyZWUgPSBjcmVhdGVWTm9kZShDb21tZW50KSk7XHJcbiAgICAgICAgICAgICAgICBwcm9jZXNzQ29tbWVudE5vZGUobnVsbCwgcGxhY2Vob2xkZXIsIGNvbnRhaW5lciwgYW5jaG9yKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHNldHVwUmVuZGVyRWZmZWN0KGluc3RhbmNlLCBpbml0aWFsVk5vZGUsIGNvbnRhaW5lciwgYW5jaG9yLCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcsIG9wdGltaXplZCk7XHJcbiAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgICAgICBwb3BXYXJuaW5nQ29udGV4dCgpO1xyXG4gICAgICAgICAgICBlbmRNZWFzdXJlKGluc3RhbmNlLCBgbW91bnRgKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgY29uc3QgdXBkYXRlQ29tcG9uZW50ID0gKG4xLCBuMiwgb3B0aW1pemVkKSA9PiB7XHJcbiAgICAgICAgY29uc3QgaW5zdGFuY2UgPSAobjIuY29tcG9uZW50ID0gbjEuY29tcG9uZW50KTtcclxuICAgICAgICBpZiAoc2hvdWxkVXBkYXRlQ29tcG9uZW50KG4xLCBuMiwgb3B0aW1pemVkKSkge1xyXG4gICAgICAgICAgICBpZiAoaW5zdGFuY2UuYXN5bmNEZXAgJiZcclxuICAgICAgICAgICAgICAgICFpbnN0YW5jZS5hc3luY1Jlc29sdmVkKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBhc3luYyAmIHN0aWxsIHBlbmRpbmcgLSBqdXN0IHVwZGF0ZSBwcm9wcyBhbmQgc2xvdHNcclxuICAgICAgICAgICAgICAgIC8vIHNpbmNlIHRoZSBjb21wb25lbnQncyByZWFjdGl2ZSBlZmZlY3QgZm9yIHJlbmRlciBpc24ndCBzZXQtdXAgeWV0XHJcbiAgICAgICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcHVzaFdhcm5pbmdDb250ZXh0KG4yKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHVwZGF0ZUNvbXBvbmVudFByZVJlbmRlcihpbnN0YW5jZSwgbjIsIG9wdGltaXplZCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcG9wV2FybmluZ0NvbnRleHQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIG5vcm1hbCB1cGRhdGVcclxuICAgICAgICAgICAgICAgIGluc3RhbmNlLm5leHQgPSBuMjtcclxuICAgICAgICAgICAgICAgIC8vIGluIGNhc2UgdGhlIGNoaWxkIGNvbXBvbmVudCBpcyBhbHNvIHF1ZXVlZCwgcmVtb3ZlIGl0IHRvIGF2b2lkXHJcbiAgICAgICAgICAgICAgICAvLyBkb3VibGUgdXBkYXRpbmcgdGhlIHNhbWUgY2hpbGQgY29tcG9uZW50IGluIHRoZSBzYW1lIGZsdXNoLlxyXG4gICAgICAgICAgICAgICAgaW52YWxpZGF0ZUpvYihpbnN0YW5jZS51cGRhdGUpO1xyXG4gICAgICAgICAgICAgICAgLy8gaW5zdGFuY2UudXBkYXRlIGlzIHRoZSByZWFjdGl2ZSBlZmZlY3QuXHJcbiAgICAgICAgICAgICAgICBpbnN0YW5jZS51cGRhdGUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8gbm8gdXBkYXRlIG5lZWRlZC4ganVzdCBjb3B5IG92ZXIgcHJvcGVydGllc1xyXG4gICAgICAgICAgICBuMi5jb21wb25lbnQgPSBuMS5jb21wb25lbnQ7XHJcbiAgICAgICAgICAgIG4yLmVsID0gbjEuZWw7XHJcbiAgICAgICAgICAgIGluc3RhbmNlLnZub2RlID0gbjI7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGNvbnN0IHNldHVwUmVuZGVyRWZmZWN0ID0gKGluc3RhbmNlLCBpbml0aWFsVk5vZGUsIGNvbnRhaW5lciwgYW5jaG9yLCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcsIG9wdGltaXplZCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGNvbXBvbmVudFVwZGF0ZUZuID0gKCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoIWluc3RhbmNlLmlzTW91bnRlZCkge1xyXG4gICAgICAgICAgICAgICAgbGV0IHZub2RlSG9vaztcclxuICAgICAgICAgICAgICAgIGNvbnN0IHsgZWwsIHByb3BzIH0gPSBpbml0aWFsVk5vZGU7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB7IGJtLCBtLCBwYXJlbnQgfSA9IGluc3RhbmNlO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaXNBc3luY1dyYXBwZXJWTm9kZSA9IGlzQXN5bmNXcmFwcGVyKGluaXRpYWxWTm9kZSk7XHJcbiAgICAgICAgICAgICAgICB0b2dnbGVSZWN1cnNlKGluc3RhbmNlLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAvLyBiZWZvcmVNb3VudCBob29rXHJcbiAgICAgICAgICAgICAgICBpZiAoYm0pIHtcclxuICAgICAgICAgICAgICAgICAgICBpbnZva2VBcnJheUZucyhibSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyBvblZub2RlQmVmb3JlTW91bnRcclxuICAgICAgICAgICAgICAgIGlmICghaXNBc3luY1dyYXBwZXJWTm9kZSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICh2bm9kZUhvb2sgPSBwcm9wcyAmJiBwcm9wcy5vblZub2RlQmVmb3JlTW91bnQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaW52b2tlVk5vZGVIb29rKHZub2RlSG9vaywgcGFyZW50LCBpbml0aWFsVk5vZGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdG9nZ2xlUmVjdXJzZShpbnN0YW5jZSwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoZWwgJiYgaHlkcmF0ZU5vZGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyB2bm9kZSBoYXMgYWRvcHRlZCBob3N0IG5vZGUgLSBwZXJmb3JtIGh5ZHJhdGlvbiBpbnN0ZWFkIG9mIG1vdW50LlxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGh5ZHJhdGVTdWJUcmVlID0gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydE1lYXN1cmUoaW5zdGFuY2UsIGByZW5kZXJgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZS5zdWJUcmVlID0gcmVuZGVyQ29tcG9uZW50Um9vdChpbnN0YW5jZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZE1lYXN1cmUoaW5zdGFuY2UsIGByZW5kZXJgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydE1lYXN1cmUoaW5zdGFuY2UsIGBoeWRyYXRlYCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaHlkcmF0ZU5vZGUoZWwsIGluc3RhbmNlLnN1YlRyZWUsIGluc3RhbmNlLCBwYXJlbnRTdXNwZW5zZSwgbnVsbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZE1lYXN1cmUoaW5zdGFuY2UsIGBoeWRyYXRlYCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpc0FzeW5jV3JhcHBlclZOb2RlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGluaXRpYWxWTm9kZS50eXBlLl9fYXN5bmNMb2FkZXIoKS50aGVuKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBub3RlOiB3ZSBhcmUgbW92aW5nIHRoZSByZW5kZXIgY2FsbCBpbnRvIGFuIGFzeW5jIGNhbGxiYWNrLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB3aGljaCBtZWFucyBpdCB3b24ndCB0cmFjayBkZXBlbmRlbmNpZXMgLSBidXQgaXQncyBvayBiZWNhdXNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGEgc2VydmVyLXJlbmRlcmVkIGFzeW5jIHdyYXBwZXIgaXMgYWxyZWFkeSBpbiByZXNvbHZlZCBzdGF0ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBhbmQgaXQgd2lsbCBuZXZlciBuZWVkIHRvIGNoYW5nZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgKCkgPT4gIWluc3RhbmNlLmlzVW5tb3VudGVkICYmIGh5ZHJhdGVTdWJUcmVlKCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaHlkcmF0ZVN1YlRyZWUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0TWVhc3VyZShpbnN0YW5jZSwgYHJlbmRlcmApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzdWJUcmVlID0gKGluc3RhbmNlLnN1YlRyZWUgPSByZW5kZXJDb21wb25lbnRSb290KGluc3RhbmNlKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbmRNZWFzdXJlKGluc3RhbmNlLCBgcmVuZGVyYCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnRNZWFzdXJlKGluc3RhbmNlLCBgcGF0Y2hgKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcGF0Y2gobnVsbCwgc3ViVHJlZSwgY29udGFpbmVyLCBhbmNob3IsIGluc3RhbmNlLCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZW5kTWVhc3VyZShpbnN0YW5jZSwgYHBhdGNoYCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGluaXRpYWxWTm9kZS5lbCA9IHN1YlRyZWUuZWw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyBtb3VudGVkIGhvb2tcclxuICAgICAgICAgICAgICAgIGlmIChtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcXVldWVQb3N0UmVuZGVyRWZmZWN0KG0sIHBhcmVudFN1c3BlbnNlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIG9uVm5vZGVNb3VudGVkXHJcbiAgICAgICAgICAgICAgICBpZiAoIWlzQXN5bmNXcmFwcGVyVk5vZGUgJiZcclxuICAgICAgICAgICAgICAgICAgICAodm5vZGVIb29rID0gcHJvcHMgJiYgcHJvcHMub25Wbm9kZU1vdW50ZWQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2NvcGVkSW5pdGlhbFZOb2RlID0gaW5pdGlhbFZOb2RlO1xyXG4gICAgICAgICAgICAgICAgICAgIHF1ZXVlUG9zdFJlbmRlckVmZmVjdCgoKSA9PiBpbnZva2VWTm9kZUhvb2sodm5vZGVIb29rLCBwYXJlbnQsIHNjb3BlZEluaXRpYWxWTm9kZSksIHBhcmVudFN1c3BlbnNlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIGFjdGl2YXRlZCBob29rIGZvciBrZWVwLWFsaXZlIHJvb3RzLlxyXG4gICAgICAgICAgICAgICAgLy8gIzE3NDIgYWN0aXZhdGVkIGhvb2sgbXVzdCBiZSBhY2Nlc3NlZCBhZnRlciBmaXJzdCByZW5kZXJcclxuICAgICAgICAgICAgICAgIC8vIHNpbmNlIHRoZSBob29rIG1heSBiZSBpbmplY3RlZCBieSBhIGNoaWxkIGtlZXAtYWxpdmVcclxuICAgICAgICAgICAgICAgIGlmIChpbml0aWFsVk5vZGUuc2hhcGVGbGFnICYgMjU2IC8qIENPTVBPTkVOVF9TSE9VTERfS0VFUF9BTElWRSAqLykge1xyXG4gICAgICAgICAgICAgICAgICAgIGluc3RhbmNlLmEgJiYgcXVldWVQb3N0UmVuZGVyRWZmZWN0KGluc3RhbmNlLmEsIHBhcmVudFN1c3BlbnNlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGluc3RhbmNlLmlzTW91bnRlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHx8IF9fVlVFX1BST0RfREVWVE9PTFNfXykge1xyXG4gICAgICAgICAgICAgICAgICAgIGRldnRvb2xzQ29tcG9uZW50QWRkZWQoaW5zdGFuY2UpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gIzI0NTg6IGRlZmVyZW5jZSBtb3VudC1vbmx5IG9iamVjdCBwYXJhbWV0ZXJzIHRvIHByZXZlbnQgbWVtbGVha3NcclxuICAgICAgICAgICAgICAgIGluaXRpYWxWTm9kZSA9IGNvbnRhaW5lciA9IGFuY2hvciA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyB1cGRhdGVDb21wb25lbnRcclxuICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgdHJpZ2dlcmVkIGJ5IG11dGF0aW9uIG9mIGNvbXBvbmVudCdzIG93biBzdGF0ZSAobmV4dDogbnVsbClcclxuICAgICAgICAgICAgICAgIC8vIE9SIHBhcmVudCBjYWxsaW5nIHByb2Nlc3NDb21wb25lbnQgKG5leHQ6IFZOb2RlKVxyXG4gICAgICAgICAgICAgICAgbGV0IHsgbmV4dCwgYnUsIHUsIHBhcmVudCwgdm5vZGUgfSA9IGluc3RhbmNlO1xyXG4gICAgICAgICAgICAgICAgbGV0IG9yaWdpbk5leHQgPSBuZXh0O1xyXG4gICAgICAgICAgICAgICAgbGV0IHZub2RlSG9vaztcclxuICAgICAgICAgICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgICAgICBwdXNoV2FybmluZ0NvbnRleHQobmV4dCB8fCBpbnN0YW5jZS52bm9kZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyBEaXNhbGxvdyBjb21wb25lbnQgZWZmZWN0IHJlY3Vyc2lvbiBkdXJpbmcgcHJlLWxpZmVjeWNsZSBob29rcy5cclxuICAgICAgICAgICAgICAgIHRvZ2dsZVJlY3Vyc2UoaW5zdGFuY2UsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIGlmIChuZXh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmV4dC5lbCA9IHZub2RlLmVsO1xyXG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZUNvbXBvbmVudFByZVJlbmRlcihpbnN0YW5jZSwgbmV4dCwgb3B0aW1pemVkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIG5leHQgPSB2bm9kZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIGJlZm9yZVVwZGF0ZSBob29rXHJcbiAgICAgICAgICAgICAgICBpZiAoYnUpIHtcclxuICAgICAgICAgICAgICAgICAgICBpbnZva2VBcnJheUZucyhidSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyBvblZub2RlQmVmb3JlVXBkYXRlXHJcbiAgICAgICAgICAgICAgICBpZiAoKHZub2RlSG9vayA9IG5leHQucHJvcHMgJiYgbmV4dC5wcm9wcy5vblZub2RlQmVmb3JlVXBkYXRlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGludm9rZVZOb2RlSG9vayh2bm9kZUhvb2ssIHBhcmVudCwgbmV4dCwgdm5vZGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdG9nZ2xlUmVjdXJzZShpbnN0YW5jZSwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAvLyByZW5kZXJcclxuICAgICAgICAgICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgICAgICBzdGFydE1lYXN1cmUoaW5zdGFuY2UsIGByZW5kZXJgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IG5leHRUcmVlID0gcmVuZGVyQ29tcG9uZW50Um9vdChpbnN0YW5jZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZW5kTWVhc3VyZShpbnN0YW5jZSwgYHJlbmRlcmApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgcHJldlRyZWUgPSBpbnN0YW5jZS5zdWJUcmVlO1xyXG4gICAgICAgICAgICAgICAgaW5zdGFuY2Uuc3ViVHJlZSA9IG5leHRUcmVlO1xyXG4gICAgICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0TWVhc3VyZShpbnN0YW5jZSwgYHBhdGNoYCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBwYXRjaChwcmV2VHJlZSwgbmV4dFRyZWUsIFxyXG4gICAgICAgICAgICAgICAgLy8gcGFyZW50IG1heSBoYXZlIGNoYW5nZWQgaWYgaXQncyBpbiBhIHRlbGVwb3J0XHJcbiAgICAgICAgICAgICAgICBob3N0UGFyZW50Tm9kZShwcmV2VHJlZS5lbCksIFxyXG4gICAgICAgICAgICAgICAgLy8gYW5jaG9yIG1heSBoYXZlIGNoYW5nZWQgaWYgaXQncyBpbiBhIGZyYWdtZW50XHJcbiAgICAgICAgICAgICAgICBnZXROZXh0SG9zdE5vZGUocHJldlRyZWUpLCBpbnN0YW5jZSwgcGFyZW50U3VzcGVuc2UsIGlzU1ZHKTtcclxuICAgICAgICAgICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgICAgICBlbmRNZWFzdXJlKGluc3RhbmNlLCBgcGF0Y2hgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIG5leHQuZWwgPSBuZXh0VHJlZS5lbDtcclxuICAgICAgICAgICAgICAgIGlmIChvcmlnaW5OZXh0ID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gc2VsZi10cmlnZ2VyZWQgdXBkYXRlLiBJbiBjYXNlIG9mIEhPQywgdXBkYXRlIHBhcmVudCBjb21wb25lbnRcclxuICAgICAgICAgICAgICAgICAgICAvLyB2bm9kZSBlbC4gSE9DIGlzIGluZGljYXRlZCBieSBwYXJlbnQgaW5zdGFuY2UncyBzdWJUcmVlIHBvaW50aW5nXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gdG8gY2hpbGQgY29tcG9uZW50J3Mgdm5vZGVcclxuICAgICAgICAgICAgICAgICAgICB1cGRhdGVIT0NIb3N0RWwoaW5zdGFuY2UsIG5leHRUcmVlLmVsKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIHVwZGF0ZWQgaG9va1xyXG4gICAgICAgICAgICAgICAgaWYgKHUpIHtcclxuICAgICAgICAgICAgICAgICAgICBxdWV1ZVBvc3RSZW5kZXJFZmZlY3QodSwgcGFyZW50U3VzcGVuc2UpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gb25Wbm9kZVVwZGF0ZWRcclxuICAgICAgICAgICAgICAgIGlmICgodm5vZGVIb29rID0gbmV4dC5wcm9wcyAmJiBuZXh0LnByb3BzLm9uVm5vZGVVcGRhdGVkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHF1ZXVlUG9zdFJlbmRlckVmZmVjdCgoKSA9PiBpbnZva2VWTm9kZUhvb2sodm5vZGVIb29rLCBwYXJlbnQsIG5leHQsIHZub2RlKSwgcGFyZW50U3VzcGVuc2UpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB8fCBfX1ZVRV9QUk9EX0RFVlRPT0xTX18pIHtcclxuICAgICAgICAgICAgICAgICAgICBkZXZ0b29sc0NvbXBvbmVudFVwZGF0ZWQoaW5zdGFuY2UpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHBvcFdhcm5pbmdDb250ZXh0KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIC8vIGNyZWF0ZSByZWFjdGl2ZSBlZmZlY3QgZm9yIHJlbmRlcmluZ1xyXG4gICAgICAgIGNvbnN0IGVmZmVjdCA9IChpbnN0YW5jZS5lZmZlY3QgPSBuZXcgUmVhY3RpdmVFZmZlY3QoY29tcG9uZW50VXBkYXRlRm4sICgpID0+IHF1ZXVlSm9iKGluc3RhbmNlLnVwZGF0ZSksIGluc3RhbmNlLnNjb3BlIC8vIHRyYWNrIGl0IGluIGNvbXBvbmVudCdzIGVmZmVjdCBzY29wZVxyXG4gICAgICAgICkpO1xyXG4gICAgICAgIGNvbnN0IHVwZGF0ZSA9IChpbnN0YW5jZS51cGRhdGUgPSBlZmZlY3QucnVuLmJpbmQoZWZmZWN0KSk7XHJcbiAgICAgICAgdXBkYXRlLmlkID0gaW5zdGFuY2UudWlkO1xyXG4gICAgICAgIC8vIGFsbG93UmVjdXJzZVxyXG4gICAgICAgIC8vICMxODAxLCAjMjA0MyBjb21wb25lbnQgcmVuZGVyIGVmZmVjdHMgc2hvdWxkIGFsbG93IHJlY3Vyc2l2ZSB1cGRhdGVzXHJcbiAgICAgICAgdG9nZ2xlUmVjdXJzZShpbnN0YW5jZSwgdHJ1ZSk7XHJcbiAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgICAgICBlZmZlY3Qub25UcmFjayA9IGluc3RhbmNlLnJ0Y1xyXG4gICAgICAgICAgICAgICAgPyBlID0+IGludm9rZUFycmF5Rm5zKGluc3RhbmNlLnJ0YywgZSlcclxuICAgICAgICAgICAgICAgIDogdm9pZCAwO1xyXG4gICAgICAgICAgICBlZmZlY3Qub25UcmlnZ2VyID0gaW5zdGFuY2UucnRnXHJcbiAgICAgICAgICAgICAgICA/IGUgPT4gaW52b2tlQXJyYXlGbnMoaW5zdGFuY2UucnRnLCBlKVxyXG4gICAgICAgICAgICAgICAgOiB2b2lkIDA7XHJcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmUgKGZvciBzY2hlZHVsZXIpXHJcbiAgICAgICAgICAgIHVwZGF0ZS5vd25lckluc3RhbmNlID0gaW5zdGFuY2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHVwZGF0ZSgpO1xyXG4gICAgfTtcclxuICAgIGNvbnN0IHVwZGF0ZUNvbXBvbmVudFByZVJlbmRlciA9IChpbnN0YW5jZSwgbmV4dFZOb2RlLCBvcHRpbWl6ZWQpID0+IHtcclxuICAgICAgICBuZXh0Vk5vZGUuY29tcG9uZW50ID0gaW5zdGFuY2U7XHJcbiAgICAgICAgY29uc3QgcHJldlByb3BzID0gaW5zdGFuY2Uudm5vZGUucHJvcHM7XHJcbiAgICAgICAgaW5zdGFuY2Uudm5vZGUgPSBuZXh0Vk5vZGU7XHJcbiAgICAgICAgaW5zdGFuY2UubmV4dCA9IG51bGw7XHJcbiAgICAgICAgdXBkYXRlUHJvcHMoaW5zdGFuY2UsIG5leHRWTm9kZS5wcm9wcywgcHJldlByb3BzLCBvcHRpbWl6ZWQpO1xyXG4gICAgICAgIHVwZGF0ZVNsb3RzKGluc3RhbmNlLCBuZXh0Vk5vZGUuY2hpbGRyZW4sIG9wdGltaXplZCk7XHJcbiAgICAgICAgcGF1c2VUcmFja2luZygpO1xyXG4gICAgICAgIC8vIHByb3BzIHVwZGF0ZSBtYXkgaGF2ZSB0cmlnZ2VyZWQgcHJlLWZsdXNoIHdhdGNoZXJzLlxyXG4gICAgICAgIC8vIGZsdXNoIHRoZW0gYmVmb3JlIHRoZSByZW5kZXIgdXBkYXRlLlxyXG4gICAgICAgIGZsdXNoUHJlRmx1c2hDYnModW5kZWZpbmVkLCBpbnN0YW5jZS51cGRhdGUpO1xyXG4gICAgICAgIHJlc2V0VHJhY2tpbmcoKTtcclxuICAgIH07XHJcbiAgICBjb25zdCBwYXRjaENoaWxkcmVuID0gKG4xLCBuMiwgY29udGFpbmVyLCBhbmNob3IsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIGlzU1ZHLCBzbG90U2NvcGVJZHMsIG9wdGltaXplZCA9IGZhbHNlKSA9PiB7XHJcbiAgICAgICAgY29uc3QgYzEgPSBuMSAmJiBuMS5jaGlsZHJlbjtcclxuICAgICAgICBjb25zdCBwcmV2U2hhcGVGbGFnID0gbjEgPyBuMS5zaGFwZUZsYWcgOiAwO1xyXG4gICAgICAgIGNvbnN0IGMyID0gbjIuY2hpbGRyZW47XHJcbiAgICAgICAgY29uc3QgeyBwYXRjaEZsYWcsIHNoYXBlRmxhZyB9ID0gbjI7XHJcbiAgICAgICAgLy8gZmFzdCBwYXRoXHJcbiAgICAgICAgaWYgKHBhdGNoRmxhZyA+IDApIHtcclxuICAgICAgICAgICAgaWYgKHBhdGNoRmxhZyAmIDEyOCAvKiBLRVlFRF9GUkFHTUVOVCAqLykge1xyXG4gICAgICAgICAgICAgICAgLy8gdGhpcyBjb3VsZCBiZSBlaXRoZXIgZnVsbHkta2V5ZWQgb3IgbWl4ZWQgKHNvbWUga2V5ZWQgc29tZSBub3QpXHJcbiAgICAgICAgICAgICAgICAvLyBwcmVzZW5jZSBvZiBwYXRjaEZsYWcgbWVhbnMgY2hpbGRyZW4gYXJlIGd1YXJhbnRlZWQgdG8gYmUgYXJyYXlzXHJcbiAgICAgICAgICAgICAgICBwYXRjaEtleWVkQ2hpbGRyZW4oYzEsIGMyLCBjb250YWluZXIsIGFuY2hvciwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChwYXRjaEZsYWcgJiAyNTYgLyogVU5LRVlFRF9GUkFHTUVOVCAqLykge1xyXG4gICAgICAgICAgICAgICAgLy8gdW5rZXllZFxyXG4gICAgICAgICAgICAgICAgcGF0Y2hVbmtleWVkQ2hpbGRyZW4oYzEsIGMyLCBjb250YWluZXIsIGFuY2hvciwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBjaGlsZHJlbiBoYXMgMyBwb3NzaWJpbGl0aWVzOiB0ZXh0LCBhcnJheSBvciBubyBjaGlsZHJlbi5cclxuICAgICAgICBpZiAoc2hhcGVGbGFnICYgOCAvKiBURVhUX0NISUxEUkVOICovKSB7XHJcbiAgICAgICAgICAgIC8vIHRleHQgY2hpbGRyZW4gZmFzdCBwYXRoXHJcbiAgICAgICAgICAgIGlmIChwcmV2U2hhcGVGbGFnICYgMTYgLyogQVJSQVlfQ0hJTERSRU4gKi8pIHtcclxuICAgICAgICAgICAgICAgIHVubW91bnRDaGlsZHJlbihjMSwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGMyICE9PSBjMSkge1xyXG4gICAgICAgICAgICAgICAgaG9zdFNldEVsZW1lbnRUZXh0KGNvbnRhaW5lciwgYzIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAocHJldlNoYXBlRmxhZyAmIDE2IC8qIEFSUkFZX0NISUxEUkVOICovKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBwcmV2IGNoaWxkcmVuIHdhcyBhcnJheVxyXG4gICAgICAgICAgICAgICAgaWYgKHNoYXBlRmxhZyAmIDE2IC8qIEFSUkFZX0NISUxEUkVOICovKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gdHdvIGFycmF5cywgY2Fubm90IGFzc3VtZSBhbnl0aGluZywgZG8gZnVsbCBkaWZmXHJcbiAgICAgICAgICAgICAgICAgICAgcGF0Y2hLZXllZENoaWxkcmVuKGMxLCBjMiwgY29udGFpbmVyLCBhbmNob3IsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIGlzU1ZHLCBzbG90U2NvcGVJZHMsIG9wdGltaXplZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBubyBuZXcgY2hpbGRyZW4sIGp1c3QgdW5tb3VudCBvbGRcclxuICAgICAgICAgICAgICAgICAgICB1bm1vdW50Q2hpbGRyZW4oYzEsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gcHJldiBjaGlsZHJlbiB3YXMgdGV4dCBPUiBudWxsXHJcbiAgICAgICAgICAgICAgICAvLyBuZXcgY2hpbGRyZW4gaXMgYXJyYXkgT1IgbnVsbFxyXG4gICAgICAgICAgICAgICAgaWYgKHByZXZTaGFwZUZsYWcgJiA4IC8qIFRFWFRfQ0hJTERSRU4gKi8pIHtcclxuICAgICAgICAgICAgICAgICAgICBob3N0U2V0RWxlbWVudFRleHQoY29udGFpbmVyLCAnJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyBtb3VudCBuZXcgaWYgYXJyYXlcclxuICAgICAgICAgICAgICAgIGlmIChzaGFwZUZsYWcgJiAxNiAvKiBBUlJBWV9DSElMRFJFTiAqLykge1xyXG4gICAgICAgICAgICAgICAgICAgIG1vdW50Q2hpbGRyZW4oYzIsIGNvbnRhaW5lciwgYW5jaG9yLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCBpc1NWRywgc2xvdFNjb3BlSWRzLCBvcHRpbWl6ZWQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGNvbnN0IHBhdGNoVW5rZXllZENoaWxkcmVuID0gKGMxLCBjMiwgY29udGFpbmVyLCBhbmNob3IsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIGlzU1ZHLCBzbG90U2NvcGVJZHMsIG9wdGltaXplZCkgPT4ge1xyXG4gICAgICAgIGMxID0gYzEgfHwgRU1QVFlfQVJSO1xyXG4gICAgICAgIGMyID0gYzIgfHwgRU1QVFlfQVJSO1xyXG4gICAgICAgIGNvbnN0IG9sZExlbmd0aCA9IGMxLmxlbmd0aDtcclxuICAgICAgICBjb25zdCBuZXdMZW5ndGggPSBjMi5sZW5ndGg7XHJcbiAgICAgICAgY29uc3QgY29tbW9uTGVuZ3RoID0gTWF0aC5taW4ob2xkTGVuZ3RoLCBuZXdMZW5ndGgpO1xyXG4gICAgICAgIGxldCBpO1xyXG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBjb21tb25MZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBjb25zdCBuZXh0Q2hpbGQgPSAoYzJbaV0gPSBvcHRpbWl6ZWRcclxuICAgICAgICAgICAgICAgID8gY2xvbmVJZk1vdW50ZWQoYzJbaV0pXHJcbiAgICAgICAgICAgICAgICA6IG5vcm1hbGl6ZVZOb2RlKGMyW2ldKSk7XHJcbiAgICAgICAgICAgIHBhdGNoKGMxW2ldLCBuZXh0Q2hpbGQsIGNvbnRhaW5lciwgbnVsbCwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKG9sZExlbmd0aCA+IG5ld0xlbmd0aCkge1xyXG4gICAgICAgICAgICAvLyByZW1vdmUgb2xkXHJcbiAgICAgICAgICAgIHVubW91bnRDaGlsZHJlbihjMSwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgdHJ1ZSwgZmFsc2UsIGNvbW1vbkxlbmd0aCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBtb3VudCBuZXdcclxuICAgICAgICAgICAgbW91bnRDaGlsZHJlbihjMiwgY29udGFpbmVyLCBhbmNob3IsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIGlzU1ZHLCBzbG90U2NvcGVJZHMsIG9wdGltaXplZCwgY29tbW9uTGVuZ3RoKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLy8gY2FuIGJlIGFsbC1rZXllZCBvciBtaXhlZFxyXG4gICAgY29uc3QgcGF0Y2hLZXllZENoaWxkcmVuID0gKGMxLCBjMiwgY29udGFpbmVyLCBwYXJlbnRBbmNob3IsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIGlzU1ZHLCBzbG90U2NvcGVJZHMsIG9wdGltaXplZCkgPT4ge1xyXG4gICAgICAgIGxldCBpID0gMDtcclxuICAgICAgICBjb25zdCBsMiA9IGMyLmxlbmd0aDtcclxuICAgICAgICBsZXQgZTEgPSBjMS5sZW5ndGggLSAxOyAvLyBwcmV2IGVuZGluZyBpbmRleFxyXG4gICAgICAgIGxldCBlMiA9IGwyIC0gMTsgLy8gbmV4dCBlbmRpbmcgaW5kZXhcclxuICAgICAgICAvLyAxLiBzeW5jIGZyb20gc3RhcnRcclxuICAgICAgICAvLyAoYSBiKSBjXHJcbiAgICAgICAgLy8gKGEgYikgZCBlXHJcbiAgICAgICAgd2hpbGUgKGkgPD0gZTEgJiYgaSA8PSBlMikge1xyXG4gICAgICAgICAgICBjb25zdCBuMSA9IGMxW2ldO1xyXG4gICAgICAgICAgICBjb25zdCBuMiA9IChjMltpXSA9IG9wdGltaXplZFxyXG4gICAgICAgICAgICAgICAgPyBjbG9uZUlmTW91bnRlZChjMltpXSlcclxuICAgICAgICAgICAgICAgIDogbm9ybWFsaXplVk5vZGUoYzJbaV0pKTtcclxuICAgICAgICAgICAgaWYgKGlzU2FtZVZOb2RlVHlwZShuMSwgbjIpKSB7XHJcbiAgICAgICAgICAgICAgICBwYXRjaChuMSwgbjIsIGNvbnRhaW5lciwgbnVsbCwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGkrKztcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gMi4gc3luYyBmcm9tIGVuZFxyXG4gICAgICAgIC8vIGEgKGIgYylcclxuICAgICAgICAvLyBkIGUgKGIgYylcclxuICAgICAgICB3aGlsZSAoaSA8PSBlMSAmJiBpIDw9IGUyKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG4xID0gYzFbZTFdO1xyXG4gICAgICAgICAgICBjb25zdCBuMiA9IChjMltlMl0gPSBvcHRpbWl6ZWRcclxuICAgICAgICAgICAgICAgID8gY2xvbmVJZk1vdW50ZWQoYzJbZTJdKVxyXG4gICAgICAgICAgICAgICAgOiBub3JtYWxpemVWTm9kZShjMltlMl0pKTtcclxuICAgICAgICAgICAgaWYgKGlzU2FtZVZOb2RlVHlwZShuMSwgbjIpKSB7XHJcbiAgICAgICAgICAgICAgICBwYXRjaChuMSwgbjIsIGNvbnRhaW5lciwgbnVsbCwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGUxLS07XHJcbiAgICAgICAgICAgIGUyLS07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIDMuIGNvbW1vbiBzZXF1ZW5jZSArIG1vdW50XHJcbiAgICAgICAgLy8gKGEgYilcclxuICAgICAgICAvLyAoYSBiKSBjXHJcbiAgICAgICAgLy8gaSA9IDIsIGUxID0gMSwgZTIgPSAyXHJcbiAgICAgICAgLy8gKGEgYilcclxuICAgICAgICAvLyBjIChhIGIpXHJcbiAgICAgICAgLy8gaSA9IDAsIGUxID0gLTEsIGUyID0gMFxyXG4gICAgICAgIGlmIChpID4gZTEpIHtcclxuICAgICAgICAgICAgaWYgKGkgPD0gZTIpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5leHRQb3MgPSBlMiArIDE7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBhbmNob3IgPSBuZXh0UG9zIDwgbDIgPyBjMltuZXh0UG9zXS5lbCA6IHBhcmVudEFuY2hvcjtcclxuICAgICAgICAgICAgICAgIHdoaWxlIChpIDw9IGUyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcGF0Y2gobnVsbCwgKGMyW2ldID0gb3B0aW1pemVkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgID8gY2xvbmVJZk1vdW50ZWQoYzJbaV0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDogbm9ybWFsaXplVk5vZGUoYzJbaV0pKSwgY29udGFpbmVyLCBhbmNob3IsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIGlzU1ZHLCBzbG90U2NvcGVJZHMsIG9wdGltaXplZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaSsrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIDQuIGNvbW1vbiBzZXF1ZW5jZSArIHVubW91bnRcclxuICAgICAgICAvLyAoYSBiKSBjXHJcbiAgICAgICAgLy8gKGEgYilcclxuICAgICAgICAvLyBpID0gMiwgZTEgPSAyLCBlMiA9IDFcclxuICAgICAgICAvLyBhIChiIGMpXHJcbiAgICAgICAgLy8gKGIgYylcclxuICAgICAgICAvLyBpID0gMCwgZTEgPSAwLCBlMiA9IC0xXHJcbiAgICAgICAgZWxzZSBpZiAoaSA+IGUyKSB7XHJcbiAgICAgICAgICAgIHdoaWxlIChpIDw9IGUxKSB7XHJcbiAgICAgICAgICAgICAgICB1bm1vdW50KGMxW2ldLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgIGkrKztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyA1LiB1bmtub3duIHNlcXVlbmNlXHJcbiAgICAgICAgLy8gW2kgLi4uIGUxICsgMV06IGEgYiBbYyBkIGVdIGYgZ1xyXG4gICAgICAgIC8vIFtpIC4uLiBlMiArIDFdOiBhIGIgW2UgZCBjIGhdIGYgZ1xyXG4gICAgICAgIC8vIGkgPSAyLCBlMSA9IDQsIGUyID0gNVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zdCBzMSA9IGk7IC8vIHByZXYgc3RhcnRpbmcgaW5kZXhcclxuICAgICAgICAgICAgY29uc3QgczIgPSBpOyAvLyBuZXh0IHN0YXJ0aW5nIGluZGV4XHJcbiAgICAgICAgICAgIC8vIDUuMSBidWlsZCBrZXk6aW5kZXggbWFwIGZvciBuZXdDaGlsZHJlblxyXG4gICAgICAgICAgICBjb25zdCBrZXlUb05ld0luZGV4TWFwID0gbmV3IE1hcCgpO1xyXG4gICAgICAgICAgICBmb3IgKGkgPSBzMjsgaSA8PSBlMjsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuZXh0Q2hpbGQgPSAoYzJbaV0gPSBvcHRpbWl6ZWRcclxuICAgICAgICAgICAgICAgICAgICA/IGNsb25lSWZNb3VudGVkKGMyW2ldKVxyXG4gICAgICAgICAgICAgICAgICAgIDogbm9ybWFsaXplVk5vZGUoYzJbaV0pKTtcclxuICAgICAgICAgICAgICAgIGlmIChuZXh0Q2hpbGQua2V5ICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmIGtleVRvTmV3SW5kZXhNYXAuaGFzKG5leHRDaGlsZC5rZXkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdhcm4oYER1cGxpY2F0ZSBrZXlzIGZvdW5kIGR1cmluZyB1cGRhdGU6YCwgSlNPTi5zdHJpbmdpZnkobmV4dENoaWxkLmtleSksIGBNYWtlIHN1cmUga2V5cyBhcmUgdW5pcXVlLmApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBrZXlUb05ld0luZGV4TWFwLnNldChuZXh0Q2hpbGQua2V5LCBpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyA1LjIgbG9vcCB0aHJvdWdoIG9sZCBjaGlsZHJlbiBsZWZ0IHRvIGJlIHBhdGNoZWQgYW5kIHRyeSB0byBwYXRjaFxyXG4gICAgICAgICAgICAvLyBtYXRjaGluZyBub2RlcyAmIHJlbW92ZSBub2RlcyB0aGF0IGFyZSBubyBsb25nZXIgcHJlc2VudFxyXG4gICAgICAgICAgICBsZXQgajtcclxuICAgICAgICAgICAgbGV0IHBhdGNoZWQgPSAwO1xyXG4gICAgICAgICAgICBjb25zdCB0b0JlUGF0Y2hlZCA9IGUyIC0gczIgKyAxO1xyXG4gICAgICAgICAgICBsZXQgbW92ZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgLy8gdXNlZCB0byB0cmFjayB3aGV0aGVyIGFueSBub2RlIGhhcyBtb3ZlZFxyXG4gICAgICAgICAgICBsZXQgbWF4TmV3SW5kZXhTb0ZhciA9IDA7XHJcbiAgICAgICAgICAgIC8vIHdvcmtzIGFzIE1hcDxuZXdJbmRleCwgb2xkSW5kZXg+XHJcbiAgICAgICAgICAgIC8vIE5vdGUgdGhhdCBvbGRJbmRleCBpcyBvZmZzZXQgYnkgKzFcclxuICAgICAgICAgICAgLy8gYW5kIG9sZEluZGV4ID0gMCBpcyBhIHNwZWNpYWwgdmFsdWUgaW5kaWNhdGluZyB0aGUgbmV3IG5vZGUgaGFzXHJcbiAgICAgICAgICAgIC8vIG5vIGNvcnJlc3BvbmRpbmcgb2xkIG5vZGUuXHJcbiAgICAgICAgICAgIC8vIHVzZWQgZm9yIGRldGVybWluaW5nIGxvbmdlc3Qgc3RhYmxlIHN1YnNlcXVlbmNlXHJcbiAgICAgICAgICAgIGNvbnN0IG5ld0luZGV4VG9PbGRJbmRleE1hcCA9IG5ldyBBcnJheSh0b0JlUGF0Y2hlZCk7XHJcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCB0b0JlUGF0Y2hlZDsgaSsrKVxyXG4gICAgICAgICAgICAgICAgbmV3SW5kZXhUb09sZEluZGV4TWFwW2ldID0gMDtcclxuICAgICAgICAgICAgZm9yIChpID0gczE7IGkgPD0gZTE7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcHJldkNoaWxkID0gYzFbaV07XHJcbiAgICAgICAgICAgICAgICBpZiAocGF0Y2hlZCA+PSB0b0JlUGF0Y2hlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGFsbCBuZXcgY2hpbGRyZW4gaGF2ZSBiZWVuIHBhdGNoZWQgc28gdGhpcyBjYW4gb25seSBiZSBhIHJlbW92YWxcclxuICAgICAgICAgICAgICAgICAgICB1bm1vdW50KHByZXZDaGlsZCwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBsZXQgbmV3SW5kZXg7XHJcbiAgICAgICAgICAgICAgICBpZiAocHJldkNoaWxkLmtleSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmV3SW5kZXggPSBrZXlUb05ld0luZGV4TWFwLmdldChwcmV2Q2hpbGQua2V5KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGtleS1sZXNzIG5vZGUsIHRyeSB0byBsb2NhdGUgYSBrZXktbGVzcyBub2RlIG9mIHRoZSBzYW1lIHR5cGVcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGogPSBzMjsgaiA8PSBlMjsgaisrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuZXdJbmRleFRvT2xkSW5kZXhNYXBbaiAtIHMyXSA9PT0gMCAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNTYW1lVk5vZGVUeXBlKHByZXZDaGlsZCwgYzJbal0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdJbmRleCA9IGo7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChuZXdJbmRleCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdW5tb3VudChwcmV2Q2hpbGQsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmV3SW5kZXhUb09sZEluZGV4TWFwW25ld0luZGV4IC0gczJdID0gaSArIDE7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5ld0luZGV4ID49IG1heE5ld0luZGV4U29GYXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWF4TmV3SW5kZXhTb0ZhciA9IG5ld0luZGV4O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbW92ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBwYXRjaChwcmV2Q2hpbGQsIGMyW25ld0luZGV4XSwgY29udGFpbmVyLCBudWxsLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCBpc1NWRywgc2xvdFNjb3BlSWRzLCBvcHRpbWl6ZWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHBhdGNoZWQrKztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyA1LjMgbW92ZSBhbmQgbW91bnRcclxuICAgICAgICAgICAgLy8gZ2VuZXJhdGUgbG9uZ2VzdCBzdGFibGUgc3Vic2VxdWVuY2Ugb25seSB3aGVuIG5vZGVzIGhhdmUgbW92ZWRcclxuICAgICAgICAgICAgY29uc3QgaW5jcmVhc2luZ05ld0luZGV4U2VxdWVuY2UgPSBtb3ZlZFxyXG4gICAgICAgICAgICAgICAgPyBnZXRTZXF1ZW5jZShuZXdJbmRleFRvT2xkSW5kZXhNYXApXHJcbiAgICAgICAgICAgICAgICA6IEVNUFRZX0FSUjtcclxuICAgICAgICAgICAgaiA9IGluY3JlYXNpbmdOZXdJbmRleFNlcXVlbmNlLmxlbmd0aCAtIDE7XHJcbiAgICAgICAgICAgIC8vIGxvb3BpbmcgYmFja3dhcmRzIHNvIHRoYXQgd2UgY2FuIHVzZSBsYXN0IHBhdGNoZWQgbm9kZSBhcyBhbmNob3JcclxuICAgICAgICAgICAgZm9yIChpID0gdG9CZVBhdGNoZWQgLSAxOyBpID49IDA7IGktLSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbmV4dEluZGV4ID0gczIgKyBpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbmV4dENoaWxkID0gYzJbbmV4dEluZGV4XTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGFuY2hvciA9IG5leHRJbmRleCArIDEgPCBsMiA/IGMyW25leHRJbmRleCArIDFdLmVsIDogcGFyZW50QW5jaG9yO1xyXG4gICAgICAgICAgICAgICAgaWYgKG5ld0luZGV4VG9PbGRJbmRleE1hcFtpXSA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIG1vdW50IG5ld1xyXG4gICAgICAgICAgICAgICAgICAgIHBhdGNoKG51bGwsIG5leHRDaGlsZCwgY29udGFpbmVyLCBhbmNob3IsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIGlzU1ZHLCBzbG90U2NvcGVJZHMsIG9wdGltaXplZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChtb3ZlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIG1vdmUgaWY6XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gVGhlcmUgaXMgbm8gc3RhYmxlIHN1YnNlcXVlbmNlIChlLmcuIGEgcmV2ZXJzZSlcclxuICAgICAgICAgICAgICAgICAgICAvLyBPUiBjdXJyZW50IG5vZGUgaXMgbm90IGFtb25nIHRoZSBzdGFibGUgc2VxdWVuY2VcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaiA8IDAgfHwgaSAhPT0gaW5jcmVhc2luZ05ld0luZGV4U2VxdWVuY2Vbal0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbW92ZShuZXh0Q2hpbGQsIGNvbnRhaW5lciwgYW5jaG9yLCAyIC8qIFJFT1JERVIgKi8pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgai0tO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBjb25zdCBtb3ZlID0gKHZub2RlLCBjb250YWluZXIsIGFuY2hvciwgbW92ZVR5cGUsIHBhcmVudFN1c3BlbnNlID0gbnVsbCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IHsgZWwsIHR5cGUsIHRyYW5zaXRpb24sIGNoaWxkcmVuLCBzaGFwZUZsYWcgfSA9IHZub2RlO1xyXG4gICAgICAgIGlmIChzaGFwZUZsYWcgJiA2IC8qIENPTVBPTkVOVCAqLykge1xyXG4gICAgICAgICAgICBtb3ZlKHZub2RlLmNvbXBvbmVudC5zdWJUcmVlLCBjb250YWluZXIsIGFuY2hvciwgbW92ZVR5cGUpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChzaGFwZUZsYWcgJiAxMjggLyogU1VTUEVOU0UgKi8pIHtcclxuICAgICAgICAgICAgdm5vZGUuc3VzcGVuc2UubW92ZShjb250YWluZXIsIGFuY2hvciwgbW92ZVR5cGUpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChzaGFwZUZsYWcgJiA2NCAvKiBURUxFUE9SVCAqLykge1xyXG4gICAgICAgICAgICB0eXBlLm1vdmUodm5vZGUsIGNvbnRhaW5lciwgYW5jaG9yLCBpbnRlcm5hbHMpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0eXBlID09PSBGcmFnbWVudCkge1xyXG4gICAgICAgICAgICBob3N0SW5zZXJ0KGVsLCBjb250YWluZXIsIGFuY2hvcik7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIG1vdmUoY2hpbGRyZW5baV0sIGNvbnRhaW5lciwgYW5jaG9yLCBtb3ZlVHlwZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaG9zdEluc2VydCh2bm9kZS5hbmNob3IsIGNvbnRhaW5lciwgYW5jaG9yKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodHlwZSA9PT0gU3RhdGljKSB7XHJcbiAgICAgICAgICAgIG1vdmVTdGF0aWNOb2RlKHZub2RlLCBjb250YWluZXIsIGFuY2hvcik7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gc2luZ2xlIG5vZGVzXHJcbiAgICAgICAgY29uc3QgbmVlZFRyYW5zaXRpb24gPSBtb3ZlVHlwZSAhPT0gMiAvKiBSRU9SREVSICovICYmXHJcbiAgICAgICAgICAgIHNoYXBlRmxhZyAmIDEgLyogRUxFTUVOVCAqLyAmJlxyXG4gICAgICAgICAgICB0cmFuc2l0aW9uO1xyXG4gICAgICAgIGlmIChuZWVkVHJhbnNpdGlvbikge1xyXG4gICAgICAgICAgICBpZiAobW92ZVR5cGUgPT09IDAgLyogRU5URVIgKi8pIHtcclxuICAgICAgICAgICAgICAgIHRyYW5zaXRpb24uYmVmb3JlRW50ZXIoZWwpO1xyXG4gICAgICAgICAgICAgICAgaG9zdEluc2VydChlbCwgY29udGFpbmVyLCBhbmNob3IpO1xyXG4gICAgICAgICAgICAgICAgcXVldWVQb3N0UmVuZGVyRWZmZWN0KCgpID0+IHRyYW5zaXRpb24uZW50ZXIoZWwpLCBwYXJlbnRTdXNwZW5zZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB7IGxlYXZlLCBkZWxheUxlYXZlLCBhZnRlckxlYXZlIH0gPSB0cmFuc2l0aW9uO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcmVtb3ZlID0gKCkgPT4gaG9zdEluc2VydChlbCwgY29udGFpbmVyLCBhbmNob3IpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcGVyZm9ybUxlYXZlID0gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGxlYXZlKGVsLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhZnRlckxlYXZlICYmIGFmdGVyTGVhdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICBpZiAoZGVsYXlMZWF2ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRlbGF5TGVhdmUoZWwsIHJlbW92ZSwgcGVyZm9ybUxlYXZlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHBlcmZvcm1MZWF2ZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBob3N0SW5zZXJ0KGVsLCBjb250YWluZXIsIGFuY2hvcik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGNvbnN0IHVubW91bnQgPSAodm5vZGUsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIGRvUmVtb3ZlID0gZmFsc2UsIG9wdGltaXplZCA9IGZhbHNlKSA9PiB7XHJcbiAgICAgICAgY29uc3QgeyB0eXBlLCBwcm9wcywgcmVmLCBjaGlsZHJlbiwgZHluYW1pY0NoaWxkcmVuLCBzaGFwZUZsYWcsIHBhdGNoRmxhZywgZGlycyB9ID0gdm5vZGU7XHJcbiAgICAgICAgLy8gdW5zZXQgcmVmXHJcbiAgICAgICAgaWYgKHJlZiAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHNldFJlZihyZWYsIG51bGwsIHBhcmVudFN1c3BlbnNlLCB2bm9kZSwgdHJ1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChzaGFwZUZsYWcgJiAyNTYgLyogQ09NUE9ORU5UX1NIT1VMRF9LRUVQX0FMSVZFICovKSB7XHJcbiAgICAgICAgICAgIHBhcmVudENvbXBvbmVudC5jdHguZGVhY3RpdmF0ZSh2bm9kZSk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3Qgc2hvdWxkSW52b2tlRGlycyA9IHNoYXBlRmxhZyAmIDEgLyogRUxFTUVOVCAqLyAmJiBkaXJzO1xyXG4gICAgICAgIGNvbnN0IHNob3VsZEludm9rZVZub2RlSG9vayA9ICFpc0FzeW5jV3JhcHBlcih2bm9kZSk7XHJcbiAgICAgICAgbGV0IHZub2RlSG9vaztcclxuICAgICAgICBpZiAoc2hvdWxkSW52b2tlVm5vZGVIb29rICYmXHJcbiAgICAgICAgICAgICh2bm9kZUhvb2sgPSBwcm9wcyAmJiBwcm9wcy5vblZub2RlQmVmb3JlVW5tb3VudCkpIHtcclxuICAgICAgICAgICAgaW52b2tlVk5vZGVIb29rKHZub2RlSG9vaywgcGFyZW50Q29tcG9uZW50LCB2bm9kZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChzaGFwZUZsYWcgJiA2IC8qIENPTVBPTkVOVCAqLykge1xyXG4gICAgICAgICAgICB1bm1vdW50Q29tcG9uZW50KHZub2RlLmNvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIGRvUmVtb3ZlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGlmIChzaGFwZUZsYWcgJiAxMjggLyogU1VTUEVOU0UgKi8pIHtcclxuICAgICAgICAgICAgICAgIHZub2RlLnN1c3BlbnNlLnVubW91bnQocGFyZW50U3VzcGVuc2UsIGRvUmVtb3ZlKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoc2hvdWxkSW52b2tlRGlycykge1xyXG4gICAgICAgICAgICAgICAgaW52b2tlRGlyZWN0aXZlSG9vayh2bm9kZSwgbnVsbCwgcGFyZW50Q29tcG9uZW50LCAnYmVmb3JlVW5tb3VudCcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChzaGFwZUZsYWcgJiA2NCAvKiBURUxFUE9SVCAqLykge1xyXG4gICAgICAgICAgICAgICAgdm5vZGUudHlwZS5yZW1vdmUodm5vZGUsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIG9wdGltaXplZCwgaW50ZXJuYWxzLCBkb1JlbW92ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoZHluYW1pY0NoaWxkcmVuICYmXHJcbiAgICAgICAgICAgICAgICAvLyAjMTE1MzogZmFzdCBwYXRoIHNob3VsZCBub3QgYmUgdGFrZW4gZm9yIG5vbi1zdGFibGUgKHYtZm9yKSBmcmFnbWVudHNcclxuICAgICAgICAgICAgICAgICh0eXBlICE9PSBGcmFnbWVudCB8fFxyXG4gICAgICAgICAgICAgICAgICAgIChwYXRjaEZsYWcgPiAwICYmIHBhdGNoRmxhZyAmIDY0IC8qIFNUQUJMRV9GUkFHTUVOVCAqLykpKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBmYXN0IHBhdGggZm9yIGJsb2NrIG5vZGVzOiBvbmx5IG5lZWQgdG8gdW5tb3VudCBkeW5hbWljIGNoaWxkcmVuLlxyXG4gICAgICAgICAgICAgICAgdW5tb3VudENoaWxkcmVuKGR5bmFtaWNDaGlsZHJlbiwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgZmFsc2UsIHRydWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKCh0eXBlID09PSBGcmFnbWVudCAmJlxyXG4gICAgICAgICAgICAgICAgcGF0Y2hGbGFnICZcclxuICAgICAgICAgICAgICAgICAgICAoMTI4IC8qIEtFWUVEX0ZSQUdNRU5UICovIHwgMjU2IC8qIFVOS0VZRURfRlJBR01FTlQgKi8pKSB8fFxyXG4gICAgICAgICAgICAgICAgKCFvcHRpbWl6ZWQgJiYgc2hhcGVGbGFnICYgMTYgLyogQVJSQVlfQ0hJTERSRU4gKi8pKSB7XHJcbiAgICAgICAgICAgICAgICB1bm1vdW50Q2hpbGRyZW4oY2hpbGRyZW4sIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChkb1JlbW92ZSkge1xyXG4gICAgICAgICAgICAgICAgcmVtb3ZlKHZub2RlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoKHNob3VsZEludm9rZVZub2RlSG9vayAmJlxyXG4gICAgICAgICAgICAodm5vZGVIb29rID0gcHJvcHMgJiYgcHJvcHMub25Wbm9kZVVubW91bnRlZCkpIHx8XHJcbiAgICAgICAgICAgIHNob3VsZEludm9rZURpcnMpIHtcclxuICAgICAgICAgICAgcXVldWVQb3N0UmVuZGVyRWZmZWN0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHZub2RlSG9vayAmJiBpbnZva2VWTm9kZUhvb2sodm5vZGVIb29rLCBwYXJlbnRDb21wb25lbnQsIHZub2RlKTtcclxuICAgICAgICAgICAgICAgIHNob3VsZEludm9rZURpcnMgJiZcclxuICAgICAgICAgICAgICAgICAgICBpbnZva2VEaXJlY3RpdmVIb29rKHZub2RlLCBudWxsLCBwYXJlbnRDb21wb25lbnQsICd1bm1vdW50ZWQnKTtcclxuICAgICAgICAgICAgfSwgcGFyZW50U3VzcGVuc2UpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBjb25zdCByZW1vdmUgPSB2bm9kZSA9PiB7XHJcbiAgICAgICAgY29uc3QgeyB0eXBlLCBlbCwgYW5jaG9yLCB0cmFuc2l0aW9uIH0gPSB2bm9kZTtcclxuICAgICAgICBpZiAodHlwZSA9PT0gRnJhZ21lbnQpIHtcclxuICAgICAgICAgICAgcmVtb3ZlRnJhZ21lbnQoZWwsIGFuY2hvcik7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHR5cGUgPT09IFN0YXRpYykge1xyXG4gICAgICAgICAgICByZW1vdmVTdGF0aWNOb2RlKHZub2RlKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBwZXJmb3JtUmVtb3ZlID0gKCkgPT4ge1xyXG4gICAgICAgICAgICBob3N0UmVtb3ZlKGVsKTtcclxuICAgICAgICAgICAgaWYgKHRyYW5zaXRpb24gJiYgIXRyYW5zaXRpb24ucGVyc2lzdGVkICYmIHRyYW5zaXRpb24uYWZ0ZXJMZWF2ZSkge1xyXG4gICAgICAgICAgICAgICAgdHJhbnNpdGlvbi5hZnRlckxlYXZlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIGlmICh2bm9kZS5zaGFwZUZsYWcgJiAxIC8qIEVMRU1FTlQgKi8gJiZcclxuICAgICAgICAgICAgdHJhbnNpdGlvbiAmJlxyXG4gICAgICAgICAgICAhdHJhbnNpdGlvbi5wZXJzaXN0ZWQpIHtcclxuICAgICAgICAgICAgY29uc3QgeyBsZWF2ZSwgZGVsYXlMZWF2ZSB9ID0gdHJhbnNpdGlvbjtcclxuICAgICAgICAgICAgY29uc3QgcGVyZm9ybUxlYXZlID0gKCkgPT4gbGVhdmUoZWwsIHBlcmZvcm1SZW1vdmUpO1xyXG4gICAgICAgICAgICBpZiAoZGVsYXlMZWF2ZSkge1xyXG4gICAgICAgICAgICAgICAgZGVsYXlMZWF2ZSh2bm9kZS5lbCwgcGVyZm9ybVJlbW92ZSwgcGVyZm9ybUxlYXZlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHBlcmZvcm1MZWF2ZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBwZXJmb3JtUmVtb3ZlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGNvbnN0IHJlbW92ZUZyYWdtZW50ID0gKGN1ciwgZW5kKSA9PiB7XHJcbiAgICAgICAgLy8gRm9yIGZyYWdtZW50cywgZGlyZWN0bHkgcmVtb3ZlIGFsbCBjb250YWluZWQgRE9NIG5vZGVzLlxyXG4gICAgICAgIC8vIChmcmFnbWVudCBjaGlsZCBub2RlcyBjYW5ub3QgaGF2ZSB0cmFuc2l0aW9uKVxyXG4gICAgICAgIGxldCBuZXh0O1xyXG4gICAgICAgIHdoaWxlIChjdXIgIT09IGVuZCkge1xyXG4gICAgICAgICAgICBuZXh0ID0gaG9zdE5leHRTaWJsaW5nKGN1cik7XHJcbiAgICAgICAgICAgIGhvc3RSZW1vdmUoY3VyKTtcclxuICAgICAgICAgICAgY3VyID0gbmV4dDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaG9zdFJlbW92ZShlbmQpO1xyXG4gICAgfTtcclxuICAgIGNvbnN0IHVubW91bnRDb21wb25lbnQgPSAoaW5zdGFuY2UsIHBhcmVudFN1c3BlbnNlLCBkb1JlbW92ZSkgPT4ge1xyXG4gICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiYgaW5zdGFuY2UudHlwZS5fX2htcklkKSB7XHJcbiAgICAgICAgICAgIHVucmVnaXN0ZXJITVIoaW5zdGFuY2UpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCB7IGJ1bSwgc2NvcGUsIHVwZGF0ZSwgc3ViVHJlZSwgdW0gfSA9IGluc3RhbmNlO1xyXG4gICAgICAgIC8vIGJlZm9yZVVubW91bnQgaG9va1xyXG4gICAgICAgIGlmIChidW0pIHtcclxuICAgICAgICAgICAgaW52b2tlQXJyYXlGbnMoYnVtKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gc3RvcCBlZmZlY3RzIGluIGNvbXBvbmVudCBzY29wZVxyXG4gICAgICAgIHNjb3BlLnN0b3AoKTtcclxuICAgICAgICAvLyB1cGRhdGUgbWF5IGJlIG51bGwgaWYgYSBjb21wb25lbnQgaXMgdW5tb3VudGVkIGJlZm9yZSBpdHMgYXN5bmNcclxuICAgICAgICAvLyBzZXR1cCBoYXMgcmVzb2x2ZWQuXHJcbiAgICAgICAgaWYgKHVwZGF0ZSkge1xyXG4gICAgICAgICAgICAvLyBzbyB0aGF0IHNjaGVkdWxlciB3aWxsIG5vIGxvbmdlciBpbnZva2UgaXRcclxuICAgICAgICAgICAgdXBkYXRlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB1bm1vdW50KHN1YlRyZWUsIGluc3RhbmNlLCBwYXJlbnRTdXNwZW5zZSwgZG9SZW1vdmUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyB1bm1vdW50ZWQgaG9va1xyXG4gICAgICAgIGlmICh1bSkge1xyXG4gICAgICAgICAgICBxdWV1ZVBvc3RSZW5kZXJFZmZlY3QodW0sIHBhcmVudFN1c3BlbnNlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcXVldWVQb3N0UmVuZGVyRWZmZWN0KCgpID0+IHtcclxuICAgICAgICAgICAgaW5zdGFuY2UuaXNVbm1vdW50ZWQgPSB0cnVlO1xyXG4gICAgICAgIH0sIHBhcmVudFN1c3BlbnNlKTtcclxuICAgICAgICAvLyBBIGNvbXBvbmVudCB3aXRoIGFzeW5jIGRlcCBpbnNpZGUgYSBwZW5kaW5nIHN1c3BlbnNlIGlzIHVubW91bnRlZCBiZWZvcmVcclxuICAgICAgICAvLyBpdHMgYXN5bmMgZGVwIHJlc29sdmVzLiBUaGlzIHNob3VsZCByZW1vdmUgdGhlIGRlcCBmcm9tIHRoZSBzdXNwZW5zZSwgYW5kXHJcbiAgICAgICAgLy8gY2F1c2UgdGhlIHN1c3BlbnNlIHRvIHJlc29sdmUgaW1tZWRpYXRlbHkgaWYgdGhhdCB3YXMgdGhlIGxhc3QgZGVwLlxyXG4gICAgICAgIGlmIChwYXJlbnRTdXNwZW5zZSAmJlxyXG4gICAgICAgICAgICBwYXJlbnRTdXNwZW5zZS5wZW5kaW5nQnJhbmNoICYmXHJcbiAgICAgICAgICAgICFwYXJlbnRTdXNwZW5zZS5pc1VubW91bnRlZCAmJlxyXG4gICAgICAgICAgICBpbnN0YW5jZS5hc3luY0RlcCAmJlxyXG4gICAgICAgICAgICAhaW5zdGFuY2UuYXN5bmNSZXNvbHZlZCAmJlxyXG4gICAgICAgICAgICBpbnN0YW5jZS5zdXNwZW5zZUlkID09PSBwYXJlbnRTdXNwZW5zZS5wZW5kaW5nSWQpIHtcclxuICAgICAgICAgICAgcGFyZW50U3VzcGVuc2UuZGVwcy0tO1xyXG4gICAgICAgICAgICBpZiAocGFyZW50U3VzcGVuc2UuZGVwcyA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgcGFyZW50U3VzcGVuc2UucmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgfHwgX19WVUVfUFJPRF9ERVZUT09MU19fKSB7XHJcbiAgICAgICAgICAgIGRldnRvb2xzQ29tcG9uZW50UmVtb3ZlZChpbnN0YW5jZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGNvbnN0IHVubW91bnRDaGlsZHJlbiA9IChjaGlsZHJlbiwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgZG9SZW1vdmUgPSBmYWxzZSwgb3B0aW1pemVkID0gZmFsc2UsIHN0YXJ0ID0gMCkgPT4ge1xyXG4gICAgICAgIGZvciAobGV0IGkgPSBzdGFydDsgaSA8IGNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHVubW91bnQoY2hpbGRyZW5baV0sIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIGRvUmVtb3ZlLCBvcHRpbWl6ZWQpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBjb25zdCBnZXROZXh0SG9zdE5vZGUgPSB2bm9kZSA9PiB7XHJcbiAgICAgICAgaWYgKHZub2RlLnNoYXBlRmxhZyAmIDYgLyogQ09NUE9ORU5UICovKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBnZXROZXh0SG9zdE5vZGUodm5vZGUuY29tcG9uZW50LnN1YlRyZWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodm5vZGUuc2hhcGVGbGFnICYgMTI4IC8qIFNVU1BFTlNFICovKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB2bm9kZS5zdXNwZW5zZS5uZXh0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBob3N0TmV4dFNpYmxpbmcoKHZub2RlLmFuY2hvciB8fCB2bm9kZS5lbCkpO1xyXG4gICAgfTtcclxuICAgIGNvbnN0IHJlbmRlciA9ICh2bm9kZSwgY29udGFpbmVyLCBpc1NWRykgPT4ge1xyXG4gICAgICAgIGlmICh2bm9kZSA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIGlmIChjb250YWluZXIuX3Zub2RlKSB7XHJcbiAgICAgICAgICAgICAgICB1bm1vdW50KGNvbnRhaW5lci5fdm5vZGUsIG51bGwsIG51bGwsIHRydWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBwYXRjaChjb250YWluZXIuX3Zub2RlIHx8IG51bGwsIHZub2RlLCBjb250YWluZXIsIG51bGwsIG51bGwsIG51bGwsIGlzU1ZHKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZmx1c2hQb3N0Rmx1c2hDYnMoKTtcclxuICAgICAgICBjb250YWluZXIuX3Zub2RlID0gdm5vZGU7XHJcbiAgICB9O1xyXG4gICAgY29uc3QgaW50ZXJuYWxzID0ge1xyXG4gICAgICAgIHA6IHBhdGNoLFxyXG4gICAgICAgIHVtOiB1bm1vdW50LFxyXG4gICAgICAgIG06IG1vdmUsXHJcbiAgICAgICAgcjogcmVtb3ZlLFxyXG4gICAgICAgIG10OiBtb3VudENvbXBvbmVudCxcclxuICAgICAgICBtYzogbW91bnRDaGlsZHJlbixcclxuICAgICAgICBwYzogcGF0Y2hDaGlsZHJlbixcclxuICAgICAgICBwYmM6IHBhdGNoQmxvY2tDaGlsZHJlbixcclxuICAgICAgICBuOiBnZXROZXh0SG9zdE5vZGUsXHJcbiAgICAgICAgbzogb3B0aW9uc1xyXG4gICAgfTtcclxuICAgIGxldCBoeWRyYXRlO1xyXG4gICAgbGV0IGh5ZHJhdGVOb2RlO1xyXG4gICAgaWYgKGNyZWF0ZUh5ZHJhdGlvbkZucykge1xyXG4gICAgICAgIFtoeWRyYXRlLCBoeWRyYXRlTm9kZV0gPSBjcmVhdGVIeWRyYXRpb25GbnMoaW50ZXJuYWxzKTtcclxuICAgIH1cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgcmVuZGVyLFxyXG4gICAgICAgIGh5ZHJhdGUsXHJcbiAgICAgICAgY3JlYXRlQXBwOiBjcmVhdGVBcHBBUEkocmVuZGVyLCBoeWRyYXRlKVxyXG4gICAgfTtcclxufVxyXG5mdW5jdGlvbiB0b2dnbGVSZWN1cnNlKHsgZWZmZWN0LCB1cGRhdGUgfSwgYWxsb3dlZCkge1xyXG4gICAgZWZmZWN0LmFsbG93UmVjdXJzZSA9IHVwZGF0ZS5hbGxvd1JlY3Vyc2UgPSBhbGxvd2VkO1xyXG59XHJcbi8qKlxyXG4gKiAjMTE1NlxyXG4gKiBXaGVuIGEgY29tcG9uZW50IGlzIEhNUi1lbmFibGVkLCB3ZSBuZWVkIHRvIG1ha2Ugc3VyZSB0aGF0IGFsbCBzdGF0aWMgbm9kZXNcclxuICogaW5zaWRlIGEgYmxvY2sgYWxzbyBpbmhlcml0IHRoZSBET00gZWxlbWVudCBmcm9tIHRoZSBwcmV2aW91cyB0cmVlIHNvIHRoYXRcclxuICogSE1SIHVwZGF0ZXMgKHdoaWNoIGFyZSBmdWxsIHVwZGF0ZXMpIGNhbiByZXRyaWV2ZSB0aGUgZWxlbWVudCBmb3IgcGF0Y2hpbmcuXHJcbiAqXHJcbiAqICMyMDgwXHJcbiAqIEluc2lkZSBrZXllZCBgdGVtcGxhdGVgIGZyYWdtZW50IHN0YXRpYyBjaGlsZHJlbiwgaWYgYSBmcmFnbWVudCBpcyBtb3ZlZCxcclxuICogdGhlIGNoaWxkcmVuIHdpbGwgYWx3YXlzIGJlIG1vdmVkLiBUaGVyZWZvcmUsIGluIG9yZGVyIHRvIGVuc3VyZSBjb3JyZWN0IG1vdmVcclxuICogcG9zaXRpb24sIGVsIHNob3VsZCBiZSBpbmhlcml0ZWQgZnJvbSBwcmV2aW91cyBub2Rlcy5cclxuICovXHJcbmZ1bmN0aW9uIHRyYXZlcnNlU3RhdGljQ2hpbGRyZW4objEsIG4yLCBzaGFsbG93ID0gZmFsc2UpIHtcclxuICAgIGNvbnN0IGNoMSA9IG4xLmNoaWxkcmVuO1xyXG4gICAgY29uc3QgY2gyID0gbjIuY2hpbGRyZW47XHJcbiAgICBpZiAoaXNBcnJheShjaDEpICYmIGlzQXJyYXkoY2gyKSkge1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY2gxLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIC8vIHRoaXMgaXMgb25seSBjYWxsZWQgaW4gdGhlIG9wdGltaXplZCBwYXRoIHNvIGFycmF5IGNoaWxkcmVuIGFyZVxyXG4gICAgICAgICAgICAvLyBndWFyYW50ZWVkIHRvIGJlIHZub2Rlc1xyXG4gICAgICAgICAgICBjb25zdCBjMSA9IGNoMVtpXTtcclxuICAgICAgICAgICAgbGV0IGMyID0gY2gyW2ldO1xyXG4gICAgICAgICAgICBpZiAoYzIuc2hhcGVGbGFnICYgMSAvKiBFTEVNRU5UICovICYmICFjMi5keW5hbWljQ2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgICAgIGlmIChjMi5wYXRjaEZsYWcgPD0gMCB8fCBjMi5wYXRjaEZsYWcgPT09IDMyIC8qIEhZRFJBVEVfRVZFTlRTICovKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYzIgPSBjaDJbaV0gPSBjbG9uZUlmTW91bnRlZChjaDJbaV0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGMyLmVsID0gYzEuZWw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoIXNoYWxsb3cpXHJcbiAgICAgICAgICAgICAgICAgICAgdHJhdmVyc2VTdGF0aWNDaGlsZHJlbihjMSwgYzIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIGFsc28gaW5oZXJpdCBmb3IgY29tbWVudCBub2RlcywgYnV0IG5vdCBwbGFjZWhvbGRlcnMgKGUuZy4gdi1pZiB3aGljaFxyXG4gICAgICAgICAgICAvLyB3b3VsZCBoYXZlIHJlY2VpdmVkIC5lbCBkdXJpbmcgYmxvY2sgcGF0Y2gpXHJcbiAgICAgICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiYgYzIudHlwZSA9PT0gQ29tbWVudCAmJiAhYzIuZWwpIHtcclxuICAgICAgICAgICAgICAgIGMyLmVsID0gYzEuZWw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuLy8gaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvTG9uZ2VzdF9pbmNyZWFzaW5nX3N1YnNlcXVlbmNlXHJcbmZ1bmN0aW9uIGdldFNlcXVlbmNlKGFycikge1xyXG4gICAgY29uc3QgcCA9IGFyci5zbGljZSgpO1xyXG4gICAgY29uc3QgcmVzdWx0ID0gWzBdO1xyXG4gICAgbGV0IGksIGosIHUsIHYsIGM7XHJcbiAgICBjb25zdCBsZW4gPSBhcnIubGVuZ3RoO1xyXG4gICAgZm9yIChpID0gMDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgY29uc3QgYXJySSA9IGFycltpXTtcclxuICAgICAgICBpZiAoYXJySSAhPT0gMCkge1xyXG4gICAgICAgICAgICBqID0gcmVzdWx0W3Jlc3VsdC5sZW5ndGggLSAxXTtcclxuICAgICAgICAgICAgaWYgKGFycltqXSA8IGFyckkpIHtcclxuICAgICAgICAgICAgICAgIHBbaV0gPSBqO1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goaSk7XHJcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB1ID0gMDtcclxuICAgICAgICAgICAgdiA9IHJlc3VsdC5sZW5ndGggLSAxO1xyXG4gICAgICAgICAgICB3aGlsZSAodSA8IHYpIHtcclxuICAgICAgICAgICAgICAgIGMgPSAodSArIHYpID4+IDE7XHJcbiAgICAgICAgICAgICAgICBpZiAoYXJyW3Jlc3VsdFtjXV0gPCBhcnJJKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdSA9IGMgKyAxO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdiA9IGM7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGFyckkgPCBhcnJbcmVzdWx0W3VdXSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHUgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcFtpXSA9IHJlc3VsdFt1IC0gMV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXN1bHRbdV0gPSBpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgdSA9IHJlc3VsdC5sZW5ndGg7XHJcbiAgICB2ID0gcmVzdWx0W3UgLSAxXTtcclxuICAgIHdoaWxlICh1LS0gPiAwKSB7XHJcbiAgICAgICAgcmVzdWx0W3VdID0gdjtcclxuICAgICAgICB2ID0gcFt2XTtcclxuICAgIH1cclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cblxuY29uc3QgaXNUZWxlcG9ydCA9ICh0eXBlKSA9PiB0eXBlLl9faXNUZWxlcG9ydDtcclxuY29uc3QgaXNUZWxlcG9ydERpc2FibGVkID0gKHByb3BzKSA9PiBwcm9wcyAmJiAocHJvcHMuZGlzYWJsZWQgfHwgcHJvcHMuZGlzYWJsZWQgPT09ICcnKTtcclxuY29uc3QgaXNUYXJnZXRTVkcgPSAodGFyZ2V0KSA9PiB0eXBlb2YgU1ZHRWxlbWVudCAhPT0gJ3VuZGVmaW5lZCcgJiYgdGFyZ2V0IGluc3RhbmNlb2YgU1ZHRWxlbWVudDtcclxuY29uc3QgcmVzb2x2ZVRhcmdldCA9IChwcm9wcywgc2VsZWN0KSA9PiB7XHJcbiAgICBjb25zdCB0YXJnZXRTZWxlY3RvciA9IHByb3BzICYmIHByb3BzLnRvO1xyXG4gICAgaWYgKGlzU3RyaW5nKHRhcmdldFNlbGVjdG9yKSkge1xyXG4gICAgICAgIGlmICghc2VsZWN0KSB7XHJcbiAgICAgICAgICAgIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJlxyXG4gICAgICAgICAgICAgICAgd2FybihgQ3VycmVudCByZW5kZXJlciBkb2VzIG5vdCBzdXBwb3J0IHN0cmluZyB0YXJnZXQgZm9yIFRlbGVwb3J0cy4gYCArXHJcbiAgICAgICAgICAgICAgICAgICAgYChtaXNzaW5nIHF1ZXJ5U2VsZWN0b3IgcmVuZGVyZXIgb3B0aW9uKWApO1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldCA9IHNlbGVjdCh0YXJnZXRTZWxlY3Rvcik7XHJcbiAgICAgICAgICAgIGlmICghdGFyZ2V0KSB7XHJcbiAgICAgICAgICAgICAgICAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiZcclxuICAgICAgICAgICAgICAgICAgICB3YXJuKGBGYWlsZWQgdG8gbG9jYXRlIFRlbGVwb3J0IHRhcmdldCB3aXRoIHNlbGVjdG9yIFwiJHt0YXJnZXRTZWxlY3Rvcn1cIi4gYCArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGBOb3RlIHRoZSB0YXJnZXQgZWxlbWVudCBtdXN0IGV4aXN0IGJlZm9yZSB0aGUgY29tcG9uZW50IGlzIG1vdW50ZWQgLSBgICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYGkuZS4gdGhlIHRhcmdldCBjYW5ub3QgYmUgcmVuZGVyZWQgYnkgdGhlIGNvbXBvbmVudCBpdHNlbGYsIGFuZCBgICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYGlkZWFsbHkgc2hvdWxkIGJlIG91dHNpZGUgb2YgdGhlIGVudGlyZSBWdWUgY29tcG9uZW50IHRyZWUuYCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRhcmdldDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmICF0YXJnZXRTZWxlY3RvciAmJiAhaXNUZWxlcG9ydERpc2FibGVkKHByb3BzKSkge1xyXG4gICAgICAgICAgICB3YXJuKGBJbnZhbGlkIFRlbGVwb3J0IHRhcmdldDogJHt0YXJnZXRTZWxlY3Rvcn1gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRhcmdldFNlbGVjdG9yO1xyXG4gICAgfVxyXG59O1xyXG5jb25zdCBUZWxlcG9ydEltcGwgPSB7XHJcbiAgICBfX2lzVGVsZXBvcnQ6IHRydWUsXHJcbiAgICBwcm9jZXNzKG4xLCBuMiwgY29udGFpbmVyLCBhbmNob3IsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIGlzU1ZHLCBzbG90U2NvcGVJZHMsIG9wdGltaXplZCwgaW50ZXJuYWxzKSB7XHJcbiAgICAgICAgY29uc3QgeyBtYzogbW91bnRDaGlsZHJlbiwgcGM6IHBhdGNoQ2hpbGRyZW4sIHBiYzogcGF0Y2hCbG9ja0NoaWxkcmVuLCBvOiB7IGluc2VydCwgcXVlcnlTZWxlY3RvciwgY3JlYXRlVGV4dCwgY3JlYXRlQ29tbWVudCB9IH0gPSBpbnRlcm5hbHM7XHJcbiAgICAgICAgY29uc3QgZGlzYWJsZWQgPSBpc1RlbGVwb3J0RGlzYWJsZWQobjIucHJvcHMpO1xyXG4gICAgICAgIGxldCB7IHNoYXBlRmxhZywgY2hpbGRyZW4sIGR5bmFtaWNDaGlsZHJlbiB9ID0gbjI7XHJcbiAgICAgICAgLy8gIzMzMDJcclxuICAgICAgICAvLyBITVIgdXBkYXRlZCwgZm9yY2UgZnVsbCBkaWZmXHJcbiAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiBpc0htclVwZGF0aW5nKSB7XHJcbiAgICAgICAgICAgIG9wdGltaXplZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICBkeW5hbWljQ2hpbGRyZW4gPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAobjEgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAvLyBpbnNlcnQgYW5jaG9ycyBpbiB0aGUgbWFpbiB2aWV3XHJcbiAgICAgICAgICAgIGNvbnN0IHBsYWNlaG9sZGVyID0gKG4yLmVsID0gKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpXHJcbiAgICAgICAgICAgICAgICA/IGNyZWF0ZUNvbW1lbnQoJ3RlbGVwb3J0IHN0YXJ0JylcclxuICAgICAgICAgICAgICAgIDogY3JlYXRlVGV4dCgnJykpO1xyXG4gICAgICAgICAgICBjb25zdCBtYWluQW5jaG9yID0gKG4yLmFuY2hvciA9IChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKVxyXG4gICAgICAgICAgICAgICAgPyBjcmVhdGVDb21tZW50KCd0ZWxlcG9ydCBlbmQnKVxyXG4gICAgICAgICAgICAgICAgOiBjcmVhdGVUZXh0KCcnKSk7XHJcbiAgICAgICAgICAgIGluc2VydChwbGFjZWhvbGRlciwgY29udGFpbmVyLCBhbmNob3IpO1xyXG4gICAgICAgICAgICBpbnNlcnQobWFpbkFuY2hvciwgY29udGFpbmVyLCBhbmNob3IpO1xyXG4gICAgICAgICAgICBjb25zdCB0YXJnZXQgPSAobjIudGFyZ2V0ID0gcmVzb2x2ZVRhcmdldChuMi5wcm9wcywgcXVlcnlTZWxlY3RvcikpO1xyXG4gICAgICAgICAgICBjb25zdCB0YXJnZXRBbmNob3IgPSAobjIudGFyZ2V0QW5jaG9yID0gY3JlYXRlVGV4dCgnJykpO1xyXG4gICAgICAgICAgICBpZiAodGFyZ2V0KSB7XHJcbiAgICAgICAgICAgICAgICBpbnNlcnQodGFyZ2V0QW5jaG9yLCB0YXJnZXQpO1xyXG4gICAgICAgICAgICAgICAgLy8gIzI2NTIgd2UgY291bGQgYmUgdGVsZXBvcnRpbmcgZnJvbSBhIG5vbi1TVkcgdHJlZSBpbnRvIGFuIFNWRyB0cmVlXHJcbiAgICAgICAgICAgICAgICBpc1NWRyA9IGlzU1ZHIHx8IGlzVGFyZ2V0U1ZHKHRhcmdldCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmICFkaXNhYmxlZCkge1xyXG4gICAgICAgICAgICAgICAgd2FybignSW52YWxpZCBUZWxlcG9ydCB0YXJnZXQgb24gbW91bnQ6JywgdGFyZ2V0LCBgKCR7dHlwZW9mIHRhcmdldH0pYCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgbW91bnQgPSAoY29udGFpbmVyLCBhbmNob3IpID0+IHtcclxuICAgICAgICAgICAgICAgIC8vIFRlbGVwb3J0ICphbHdheXMqIGhhcyBBcnJheSBjaGlsZHJlbi4gVGhpcyBpcyBlbmZvcmNlZCBpbiBib3RoIHRoZVxyXG4gICAgICAgICAgICAgICAgLy8gY29tcGlsZXIgYW5kIHZub2RlIGNoaWxkcmVuIG5vcm1hbGl6YXRpb24uXHJcbiAgICAgICAgICAgICAgICBpZiAoc2hhcGVGbGFnICYgMTYgLyogQVJSQVlfQ0hJTERSRU4gKi8pIHtcclxuICAgICAgICAgICAgICAgICAgICBtb3VudENoaWxkcmVuKGNoaWxkcmVuLCBjb250YWluZXIsIGFuY2hvciwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgaXNTVkcsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgaWYgKGRpc2FibGVkKSB7XHJcbiAgICAgICAgICAgICAgICBtb3VudChjb250YWluZXIsIG1haW5BbmNob3IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHRhcmdldCkge1xyXG4gICAgICAgICAgICAgICAgbW91bnQodGFyZ2V0LCB0YXJnZXRBbmNob3IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyB1cGRhdGUgY29udGVudFxyXG4gICAgICAgICAgICBuMi5lbCA9IG4xLmVsO1xyXG4gICAgICAgICAgICBjb25zdCBtYWluQW5jaG9yID0gKG4yLmFuY2hvciA9IG4xLmFuY2hvcik7XHJcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldCA9IChuMi50YXJnZXQgPSBuMS50YXJnZXQpO1xyXG4gICAgICAgICAgICBjb25zdCB0YXJnZXRBbmNob3IgPSAobjIudGFyZ2V0QW5jaG9yID0gbjEudGFyZ2V0QW5jaG9yKTtcclxuICAgICAgICAgICAgY29uc3Qgd2FzRGlzYWJsZWQgPSBpc1RlbGVwb3J0RGlzYWJsZWQobjEucHJvcHMpO1xyXG4gICAgICAgICAgICBjb25zdCBjdXJyZW50Q29udGFpbmVyID0gd2FzRGlzYWJsZWQgPyBjb250YWluZXIgOiB0YXJnZXQ7XHJcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRBbmNob3IgPSB3YXNEaXNhYmxlZCA/IG1haW5BbmNob3IgOiB0YXJnZXRBbmNob3I7XHJcbiAgICAgICAgICAgIGlzU1ZHID0gaXNTVkcgfHwgaXNUYXJnZXRTVkcodGFyZ2V0KTtcclxuICAgICAgICAgICAgaWYgKGR5bmFtaWNDaGlsZHJlbikge1xyXG4gICAgICAgICAgICAgICAgLy8gZmFzdCBwYXRoIHdoZW4gdGhlIHRlbGVwb3J0IGhhcHBlbnMgdG8gYmUgYSBibG9jayByb290XHJcbiAgICAgICAgICAgICAgICBwYXRjaEJsb2NrQ2hpbGRyZW4objEuZHluYW1pY0NoaWxkcmVuLCBkeW5hbWljQ2hpbGRyZW4sIGN1cnJlbnRDb250YWluZXIsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIGlzU1ZHLCBzbG90U2NvcGVJZHMpO1xyXG4gICAgICAgICAgICAgICAgLy8gZXZlbiBpbiBibG9jayB0cmVlIG1vZGUgd2UgbmVlZCB0byBtYWtlIHN1cmUgYWxsIHJvb3QtbGV2ZWwgbm9kZXNcclxuICAgICAgICAgICAgICAgIC8vIGluIHRoZSB0ZWxlcG9ydCBpbmhlcml0IHByZXZpb3VzIERPTSByZWZlcmVuY2VzIHNvIHRoYXQgdGhleSBjYW5cclxuICAgICAgICAgICAgICAgIC8vIGJlIG1vdmVkIGluIGZ1dHVyZSBwYXRjaGVzLlxyXG4gICAgICAgICAgICAgICAgdHJhdmVyc2VTdGF0aWNDaGlsZHJlbihuMSwgbjIsIHRydWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKCFvcHRpbWl6ZWQpIHtcclxuICAgICAgICAgICAgICAgIHBhdGNoQ2hpbGRyZW4objEsIG4yLCBjdXJyZW50Q29udGFpbmVyLCBjdXJyZW50QW5jaG9yLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCBpc1NWRywgc2xvdFNjb3BlSWRzLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGRpc2FibGVkKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXdhc0Rpc2FibGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gZW5hYmxlZCAtPiBkaXNhYmxlZFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIG1vdmUgaW50byBtYWluIGNvbnRhaW5lclxyXG4gICAgICAgICAgICAgICAgICAgIG1vdmVUZWxlcG9ydChuMiwgY29udGFpbmVyLCBtYWluQW5jaG9yLCBpbnRlcm5hbHMsIDEgLyogVE9HR0xFICovKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIHRhcmdldCBjaGFuZ2VkXHJcbiAgICAgICAgICAgICAgICBpZiAoKG4yLnByb3BzICYmIG4yLnByb3BzLnRvKSAhPT0gKG4xLnByb3BzICYmIG4xLnByb3BzLnRvKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5leHRUYXJnZXQgPSAobjIudGFyZ2V0ID0gcmVzb2x2ZVRhcmdldChuMi5wcm9wcywgcXVlcnlTZWxlY3RvcikpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChuZXh0VGFyZ2V0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vdmVUZWxlcG9ydChuMiwgbmV4dFRhcmdldCwgbnVsbCwgaW50ZXJuYWxzLCAwIC8qIFRBUkdFVF9DSEFOR0UgKi8pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2FybignSW52YWxpZCBUZWxlcG9ydCB0YXJnZXQgb24gdXBkYXRlOicsIHRhcmdldCwgYCgke3R5cGVvZiB0YXJnZXR9KWApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHdhc0Rpc2FibGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gZGlzYWJsZWQgLT4gZW5hYmxlZFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIG1vdmUgaW50byB0ZWxlcG9ydCB0YXJnZXRcclxuICAgICAgICAgICAgICAgICAgICBtb3ZlVGVsZXBvcnQobjIsIHRhcmdldCwgdGFyZ2V0QW5jaG9yLCBpbnRlcm5hbHMsIDEgLyogVE9HR0xFICovKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICByZW1vdmUodm5vZGUsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIG9wdGltaXplZCwgeyB1bTogdW5tb3VudCwgbzogeyByZW1vdmU6IGhvc3RSZW1vdmUgfSB9LCBkb1JlbW92ZSkge1xyXG4gICAgICAgIGNvbnN0IHsgc2hhcGVGbGFnLCBjaGlsZHJlbiwgYW5jaG9yLCB0YXJnZXRBbmNob3IsIHRhcmdldCwgcHJvcHMgfSA9IHZub2RlO1xyXG4gICAgICAgIGlmICh0YXJnZXQpIHtcclxuICAgICAgICAgICAgaG9zdFJlbW92ZSh0YXJnZXRBbmNob3IpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBhbiB1bm1vdW50ZWQgdGVsZXBvcnQgc2hvdWxkIGFsd2F5cyByZW1vdmUgaXRzIGNoaWxkcmVuIGlmIG5vdCBkaXNhYmxlZFxyXG4gICAgICAgIGlmIChkb1JlbW92ZSB8fCAhaXNUZWxlcG9ydERpc2FibGVkKHByb3BzKSkge1xyXG4gICAgICAgICAgICBob3N0UmVtb3ZlKGFuY2hvcik7XHJcbiAgICAgICAgICAgIGlmIChzaGFwZUZsYWcgJiAxNiAvKiBBUlJBWV9DSElMRFJFTiAqLykge1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjaGlsZHJlbi5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoaWxkID0gY2hpbGRyZW5baV07XHJcbiAgICAgICAgICAgICAgICAgICAgdW5tb3VudChjaGlsZCwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgdHJ1ZSwgISFjaGlsZC5keW5hbWljQ2hpbGRyZW4pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIG1vdmU6IG1vdmVUZWxlcG9ydCxcclxuICAgIGh5ZHJhdGU6IGh5ZHJhdGVUZWxlcG9ydFxyXG59O1xyXG5mdW5jdGlvbiBtb3ZlVGVsZXBvcnQodm5vZGUsIGNvbnRhaW5lciwgcGFyZW50QW5jaG9yLCB7IG86IHsgaW5zZXJ0IH0sIG06IG1vdmUgfSwgbW92ZVR5cGUgPSAyIC8qIFJFT1JERVIgKi8pIHtcclxuICAgIC8vIG1vdmUgdGFyZ2V0IGFuY2hvciBpZiB0aGlzIGlzIGEgdGFyZ2V0IGNoYW5nZS5cclxuICAgIGlmIChtb3ZlVHlwZSA9PT0gMCAvKiBUQVJHRVRfQ0hBTkdFICovKSB7XHJcbiAgICAgICAgaW5zZXJ0KHZub2RlLnRhcmdldEFuY2hvciwgY29udGFpbmVyLCBwYXJlbnRBbmNob3IpO1xyXG4gICAgfVxyXG4gICAgY29uc3QgeyBlbCwgYW5jaG9yLCBzaGFwZUZsYWcsIGNoaWxkcmVuLCBwcm9wcyB9ID0gdm5vZGU7XHJcbiAgICBjb25zdCBpc1Jlb3JkZXIgPSBtb3ZlVHlwZSA9PT0gMiAvKiBSRU9SREVSICovO1xyXG4gICAgLy8gbW92ZSBtYWluIHZpZXcgYW5jaG9yIGlmIHRoaXMgaXMgYSByZS1vcmRlci5cclxuICAgIGlmIChpc1Jlb3JkZXIpIHtcclxuICAgICAgICBpbnNlcnQoZWwsIGNvbnRhaW5lciwgcGFyZW50QW5jaG9yKTtcclxuICAgIH1cclxuICAgIC8vIGlmIHRoaXMgaXMgYSByZS1vcmRlciBhbmQgdGVsZXBvcnQgaXMgZW5hYmxlZCAoY29udGVudCBpcyBpbiB0YXJnZXQpXHJcbiAgICAvLyBkbyBub3QgbW92ZSBjaGlsZHJlbi4gU28gdGhlIG9wcG9zaXRlIGlzOiBvbmx5IG1vdmUgY2hpbGRyZW4gaWYgdGhpc1xyXG4gICAgLy8gaXMgbm90IGEgcmVvcmRlciwgb3IgdGhlIHRlbGVwb3J0IGlzIGRpc2FibGVkXHJcbiAgICBpZiAoIWlzUmVvcmRlciB8fCBpc1RlbGVwb3J0RGlzYWJsZWQocHJvcHMpKSB7XHJcbiAgICAgICAgLy8gVGVsZXBvcnQgaGFzIGVpdGhlciBBcnJheSBjaGlsZHJlbiBvciBubyBjaGlsZHJlbi5cclxuICAgICAgICBpZiAoc2hhcGVGbGFnICYgMTYgLyogQVJSQVlfQ0hJTERSRU4gKi8pIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjaGlsZHJlbi5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgbW92ZShjaGlsZHJlbltpXSwgY29udGFpbmVyLCBwYXJlbnRBbmNob3IsIDIgLyogUkVPUkRFUiAqLyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyBtb3ZlIG1haW4gdmlldyBhbmNob3IgaWYgdGhpcyBpcyBhIHJlLW9yZGVyLlxyXG4gICAgaWYgKGlzUmVvcmRlcikge1xyXG4gICAgICAgIGluc2VydChhbmNob3IsIGNvbnRhaW5lciwgcGFyZW50QW5jaG9yKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBoeWRyYXRlVGVsZXBvcnQobm9kZSwgdm5vZGUsIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIHNsb3RTY29wZUlkcywgb3B0aW1pemVkLCB7IG86IHsgbmV4dFNpYmxpbmcsIHBhcmVudE5vZGUsIHF1ZXJ5U2VsZWN0b3IgfSB9LCBoeWRyYXRlQ2hpbGRyZW4pIHtcclxuICAgIGNvbnN0IHRhcmdldCA9ICh2bm9kZS50YXJnZXQgPSByZXNvbHZlVGFyZ2V0KHZub2RlLnByb3BzLCBxdWVyeVNlbGVjdG9yKSk7XHJcbiAgICBpZiAodGFyZ2V0KSB7XHJcbiAgICAgICAgLy8gaWYgbXVsdGlwbGUgdGVsZXBvcnRzIHJlbmRlcmVkIHRvIHRoZSBzYW1lIHRhcmdldCBlbGVtZW50LCB3ZSBuZWVkIHRvXHJcbiAgICAgICAgLy8gcGljayB1cCBmcm9tIHdoZXJlIHRoZSBsYXN0IHRlbGVwb3J0IGZpbmlzaGVkIGluc3RlYWQgb2YgdGhlIGZpcnN0IG5vZGVcclxuICAgICAgICBjb25zdCB0YXJnZXROb2RlID0gdGFyZ2V0Ll9scGEgfHwgdGFyZ2V0LmZpcnN0Q2hpbGQ7XHJcbiAgICAgICAgaWYgKHZub2RlLnNoYXBlRmxhZyAmIDE2IC8qIEFSUkFZX0NISUxEUkVOICovKSB7XHJcbiAgICAgICAgICAgIGlmIChpc1RlbGVwb3J0RGlzYWJsZWQodm5vZGUucHJvcHMpKSB7XHJcbiAgICAgICAgICAgICAgICB2bm9kZS5hbmNob3IgPSBoeWRyYXRlQ2hpbGRyZW4obmV4dFNpYmxpbmcobm9kZSksIHZub2RlLCBwYXJlbnROb2RlKG5vZGUpLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlLCBzbG90U2NvcGVJZHMsIG9wdGltaXplZCk7XHJcbiAgICAgICAgICAgICAgICB2bm9kZS50YXJnZXRBbmNob3IgPSB0YXJnZXROb2RlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdm5vZGUuYW5jaG9yID0gbmV4dFNpYmxpbmcobm9kZSk7XHJcbiAgICAgICAgICAgICAgICB2bm9kZS50YXJnZXRBbmNob3IgPSBoeWRyYXRlQ2hpbGRyZW4odGFyZ2V0Tm9kZSwgdm5vZGUsIHRhcmdldCwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgc2xvdFNjb3BlSWRzLCBvcHRpbWl6ZWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRhcmdldC5fbHBhID1cclxuICAgICAgICAgICAgICAgIHZub2RlLnRhcmdldEFuY2hvciAmJiBuZXh0U2libGluZyh2bm9kZS50YXJnZXRBbmNob3IpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiB2bm9kZS5hbmNob3IgJiYgbmV4dFNpYmxpbmcodm5vZGUuYW5jaG9yKTtcclxufVxyXG4vLyBGb3JjZS1jYXN0ZWQgcHVibGljIHR5cGluZyBmb3IgaCBhbmQgVFNYIHByb3BzIGluZmVyZW5jZVxyXG5jb25zdCBUZWxlcG9ydCA9IFRlbGVwb3J0SW1wbDtcblxuY29uc3QgQ09NUE9ORU5UUyA9ICdjb21wb25lbnRzJztcclxuY29uc3QgRElSRUNUSVZFUyA9ICdkaXJlY3RpdmVzJztcclxuLyoqXHJcbiAqIEBwcml2YXRlXHJcbiAqL1xyXG5mdW5jdGlvbiByZXNvbHZlQ29tcG9uZW50KG5hbWUsIG1heWJlU2VsZlJlZmVyZW5jZSkge1xyXG4gICAgcmV0dXJuIHJlc29sdmVBc3NldChDT01QT05FTlRTLCBuYW1lLCB0cnVlLCBtYXliZVNlbGZSZWZlcmVuY2UpIHx8IG5hbWU7XHJcbn1cclxuY29uc3QgTlVMTF9EWU5BTUlDX0NPTVBPTkVOVCA9IFN5bWJvbCgpO1xyXG4vKipcclxuICogQHByaXZhdGVcclxuICovXHJcbmZ1bmN0aW9uIHJlc29sdmVEeW5hbWljQ29tcG9uZW50KGNvbXBvbmVudCkge1xyXG4gICAgaWYgKGlzU3RyaW5nKGNvbXBvbmVudCkpIHtcclxuICAgICAgICByZXR1cm4gcmVzb2x2ZUFzc2V0KENPTVBPTkVOVFMsIGNvbXBvbmVudCwgZmFsc2UpIHx8IGNvbXBvbmVudDtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIC8vIGludmFsaWQgdHlwZXMgd2lsbCBmYWxsdGhyb3VnaCB0byBjcmVhdGVWTm9kZSBhbmQgcmFpc2Ugd2FybmluZ1xyXG4gICAgICAgIHJldHVybiAoY29tcG9uZW50IHx8IE5VTExfRFlOQU1JQ19DT01QT05FTlQpO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBAcHJpdmF0ZVxyXG4gKi9cclxuZnVuY3Rpb24gcmVzb2x2ZURpcmVjdGl2ZShuYW1lKSB7XHJcbiAgICByZXR1cm4gcmVzb2x2ZUFzc2V0KERJUkVDVElWRVMsIG5hbWUpO1xyXG59XHJcbi8vIGltcGxlbWVudGF0aW9uXHJcbmZ1bmN0aW9uIHJlc29sdmVBc3NldCh0eXBlLCBuYW1lLCB3YXJuTWlzc2luZyA9IHRydWUsIG1heWJlU2VsZlJlZmVyZW5jZSA9IGZhbHNlKSB7XHJcbiAgICBjb25zdCBpbnN0YW5jZSA9IGN1cnJlbnRSZW5kZXJpbmdJbnN0YW5jZSB8fCBjdXJyZW50SW5zdGFuY2U7XHJcbiAgICBpZiAoaW5zdGFuY2UpIHtcclxuICAgICAgICBjb25zdCBDb21wb25lbnQgPSBpbnN0YW5jZS50eXBlO1xyXG4gICAgICAgIC8vIGV4cGxpY2l0IHNlbGYgbmFtZSBoYXMgaGlnaGVzdCBwcmlvcml0eVxyXG4gICAgICAgIGlmICh0eXBlID09PSBDT01QT05FTlRTKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHNlbGZOYW1lID0gZ2V0Q29tcG9uZW50TmFtZShDb21wb25lbnQpO1xyXG4gICAgICAgICAgICBpZiAoc2VsZk5hbWUgJiZcclxuICAgICAgICAgICAgICAgIChzZWxmTmFtZSA9PT0gbmFtZSB8fFxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGZOYW1lID09PSBjYW1lbGl6ZShuYW1lKSB8fFxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGZOYW1lID09PSBjYXBpdGFsaXplKGNhbWVsaXplKG5hbWUpKSkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBDb21wb25lbnQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgcmVzID0gXHJcbiAgICAgICAgLy8gbG9jYWwgcmVnaXN0cmF0aW9uXHJcbiAgICAgICAgLy8gY2hlY2sgaW5zdGFuY2VbdHlwZV0gZmlyc3Qgd2hpY2ggaXMgcmVzb2x2ZWQgZm9yIG9wdGlvbnMgQVBJXHJcbiAgICAgICAgcmVzb2x2ZShpbnN0YW5jZVt0eXBlXSB8fCBDb21wb25lbnRbdHlwZV0sIG5hbWUpIHx8XHJcbiAgICAgICAgICAgIC8vIGdsb2JhbCByZWdpc3RyYXRpb25cclxuICAgICAgICAgICAgcmVzb2x2ZShpbnN0YW5jZS5hcHBDb250ZXh0W3R5cGVdLCBuYW1lKTtcclxuICAgICAgICBpZiAoIXJlcyAmJiBtYXliZVNlbGZSZWZlcmVuY2UpIHtcclxuICAgICAgICAgICAgLy8gZmFsbGJhY2sgdG8gaW1wbGljaXQgc2VsZi1yZWZlcmVuY2VcclxuICAgICAgICAgICAgcmV0dXJuIENvbXBvbmVudDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiB3YXJuTWlzc2luZyAmJiAhcmVzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGV4dHJhID0gdHlwZSA9PT0gQ09NUE9ORU5UU1xyXG4gICAgICAgICAgICAgICAgPyBgXFxuSWYgdGhpcyBpcyBhIG5hdGl2ZSBjdXN0b20gZWxlbWVudCwgbWFrZSBzdXJlIHRvIGV4Y2x1ZGUgaXQgZnJvbSBgICtcclxuICAgICAgICAgICAgICAgICAgICBgY29tcG9uZW50IHJlc29sdXRpb24gdmlhIGNvbXBpbGVyT3B0aW9ucy5pc0N1c3RvbUVsZW1lbnQuYFxyXG4gICAgICAgICAgICAgICAgOiBgYDtcclxuICAgICAgICAgICAgd2FybihgRmFpbGVkIHRvIHJlc29sdmUgJHt0eXBlLnNsaWNlKDAsIC0xKX06ICR7bmFtZX0ke2V4dHJhfWApO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgd2FybihgcmVzb2x2ZSR7Y2FwaXRhbGl6ZSh0eXBlLnNsaWNlKDAsIC0xKSl9IGAgK1xyXG4gICAgICAgICAgICBgY2FuIG9ubHkgYmUgdXNlZCBpbiByZW5kZXIoKSBvciBzZXR1cCgpLmApO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHJlc29sdmUocmVnaXN0cnksIG5hbWUpIHtcclxuICAgIHJldHVybiAocmVnaXN0cnkgJiZcclxuICAgICAgICAocmVnaXN0cnlbbmFtZV0gfHxcclxuICAgICAgICAgICAgcmVnaXN0cnlbY2FtZWxpemUobmFtZSldIHx8XHJcbiAgICAgICAgICAgIHJlZ2lzdHJ5W2NhcGl0YWxpemUoY2FtZWxpemUobmFtZSkpXSkpO1xyXG59XG5cbmNvbnN0IEZyYWdtZW50ID0gU3ltYm9sKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSA/ICdGcmFnbWVudCcgOiB1bmRlZmluZWQpO1xyXG5jb25zdCBUZXh0ID0gU3ltYm9sKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSA/ICdUZXh0JyA6IHVuZGVmaW5lZCk7XHJcbmNvbnN0IENvbW1lbnQgPSBTeW1ib2woKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpID8gJ0NvbW1lbnQnIDogdW5kZWZpbmVkKTtcclxuY29uc3QgU3RhdGljID0gU3ltYm9sKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSA/ICdTdGF0aWMnIDogdW5kZWZpbmVkKTtcclxuLy8gU2luY2Ugdi1pZiBhbmQgdi1mb3IgYXJlIHRoZSB0d28gcG9zc2libGUgd2F5cyBub2RlIHN0cnVjdHVyZSBjYW4gZHluYW1pY2FsbHlcclxuLy8gY2hhbmdlLCBvbmNlIHdlIGNvbnNpZGVyIHYtaWYgYnJhbmNoZXMgYW5kIGVhY2ggdi1mb3IgZnJhZ21lbnQgYSBibG9jaywgd2VcclxuLy8gY2FuIGRpdmlkZSBhIHRlbXBsYXRlIGludG8gbmVzdGVkIGJsb2NrcywgYW5kIHdpdGhpbiBlYWNoIGJsb2NrIHRoZSBub2RlXHJcbi8vIHN0cnVjdHVyZSB3b3VsZCBiZSBzdGFibGUuIFRoaXMgYWxsb3dzIHVzIHRvIHNraXAgbW9zdCBjaGlsZHJlbiBkaWZmaW5nXHJcbi8vIGFuZCBvbmx5IHdvcnJ5IGFib3V0IHRoZSBkeW5hbWljIG5vZGVzIChpbmRpY2F0ZWQgYnkgcGF0Y2ggZmxhZ3MpLlxyXG5jb25zdCBibG9ja1N0YWNrID0gW107XHJcbmxldCBjdXJyZW50QmxvY2sgPSBudWxsO1xyXG4vKipcclxuICogT3BlbiBhIGJsb2NrLlxyXG4gKiBUaGlzIG11c3QgYmUgY2FsbGVkIGJlZm9yZSBgY3JlYXRlQmxvY2tgLiBJdCBjYW5ub3QgYmUgcGFydCBvZiBgY3JlYXRlQmxvY2tgXHJcbiAqIGJlY2F1c2UgdGhlIGNoaWxkcmVuIG9mIHRoZSBibG9jayBhcmUgZXZhbHVhdGVkIGJlZm9yZSBgY3JlYXRlQmxvY2tgIGl0c2VsZlxyXG4gKiBpcyBjYWxsZWQuIFRoZSBnZW5lcmF0ZWQgY29kZSB0eXBpY2FsbHkgbG9va3MgbGlrZSB0aGlzOlxyXG4gKlxyXG4gKiBgYGBqc1xyXG4gKiBmdW5jdGlvbiByZW5kZXIoKSB7XHJcbiAqICAgcmV0dXJuIChvcGVuQmxvY2soKSxjcmVhdGVCbG9jaygnZGl2JywgbnVsbCwgWy4uLl0pKVxyXG4gKiB9XHJcbiAqIGBgYFxyXG4gKiBkaXNhYmxlVHJhY2tpbmcgaXMgdHJ1ZSB3aGVuIGNyZWF0aW5nIGEgdi1mb3IgZnJhZ21lbnQgYmxvY2ssIHNpbmNlIGEgdi1mb3JcclxuICogZnJhZ21lbnQgYWx3YXlzIGRpZmZzIGl0cyBjaGlsZHJlbi5cclxuICpcclxuICogQHByaXZhdGVcclxuICovXHJcbmZ1bmN0aW9uIG9wZW5CbG9jayhkaXNhYmxlVHJhY2tpbmcgPSBmYWxzZSkge1xyXG4gICAgYmxvY2tTdGFjay5wdXNoKChjdXJyZW50QmxvY2sgPSBkaXNhYmxlVHJhY2tpbmcgPyBudWxsIDogW10pKTtcclxufVxyXG5mdW5jdGlvbiBjbG9zZUJsb2NrKCkge1xyXG4gICAgYmxvY2tTdGFjay5wb3AoKTtcclxuICAgIGN1cnJlbnRCbG9jayA9IGJsb2NrU3RhY2tbYmxvY2tTdGFjay5sZW5ndGggLSAxXSB8fCBudWxsO1xyXG59XHJcbi8vIFdoZXRoZXIgd2Ugc2hvdWxkIGJlIHRyYWNraW5nIGR5bmFtaWMgY2hpbGQgbm9kZXMgaW5zaWRlIGEgYmxvY2suXHJcbi8vIE9ubHkgdHJhY2tzIHdoZW4gdGhpcyB2YWx1ZSBpcyA+IDBcclxuLy8gV2UgYXJlIG5vdCB1c2luZyBhIHNpbXBsZSBib29sZWFuIGJlY2F1c2UgdGhpcyB2YWx1ZSBtYXkgbmVlZCB0byBiZVxyXG4vLyBpbmNyZW1lbnRlZC9kZWNyZW1lbnRlZCBieSBuZXN0ZWQgdXNhZ2Ugb2Ygdi1vbmNlIChzZWUgYmVsb3cpXHJcbmxldCBpc0Jsb2NrVHJlZUVuYWJsZWQgPSAxO1xyXG4vKipcclxuICogQmxvY2sgdHJhY2tpbmcgc29tZXRpbWVzIG5lZWRzIHRvIGJlIGRpc2FibGVkLCBmb3IgZXhhbXBsZSBkdXJpbmcgdGhlXHJcbiAqIGNyZWF0aW9uIG9mIGEgdHJlZSB0aGF0IG5lZWRzIHRvIGJlIGNhY2hlZCBieSB2LW9uY2UuIFRoZSBjb21waWxlciBnZW5lcmF0ZXNcclxuICogY29kZSBsaWtlIHRoaXM6XHJcbiAqXHJcbiAqIGBgYCBqc1xyXG4gKiBfY2FjaGVbMV0gfHwgKFxyXG4gKiAgIHNldEJsb2NrVHJhY2tpbmcoLTEpLFxyXG4gKiAgIF9jYWNoZVsxXSA9IGNyZWF0ZVZOb2RlKC4uLiksXHJcbiAqICAgc2V0QmxvY2tUcmFja2luZygxKSxcclxuICogICBfY2FjaGVbMV1cclxuICogKVxyXG4gKiBgYGBcclxuICpcclxuICogQHByaXZhdGVcclxuICovXHJcbmZ1bmN0aW9uIHNldEJsb2NrVHJhY2tpbmcodmFsdWUpIHtcclxuICAgIGlzQmxvY2tUcmVlRW5hYmxlZCArPSB2YWx1ZTtcclxufVxyXG5mdW5jdGlvbiBzZXR1cEJsb2NrKHZub2RlKSB7XHJcbiAgICAvLyBzYXZlIGN1cnJlbnQgYmxvY2sgY2hpbGRyZW4gb24gdGhlIGJsb2NrIHZub2RlXHJcbiAgICB2bm9kZS5keW5hbWljQ2hpbGRyZW4gPVxyXG4gICAgICAgIGlzQmxvY2tUcmVlRW5hYmxlZCA+IDAgPyBjdXJyZW50QmxvY2sgfHwgRU1QVFlfQVJSIDogbnVsbDtcclxuICAgIC8vIGNsb3NlIGJsb2NrXHJcbiAgICBjbG9zZUJsb2NrKCk7XHJcbiAgICAvLyBhIGJsb2NrIGlzIGFsd2F5cyBnb2luZyB0byBiZSBwYXRjaGVkLCBzbyB0cmFjayBpdCBhcyBhIGNoaWxkIG9mIGl0c1xyXG4gICAgLy8gcGFyZW50IGJsb2NrXHJcbiAgICBpZiAoaXNCbG9ja1RyZWVFbmFibGVkID4gMCAmJiBjdXJyZW50QmxvY2spIHtcclxuICAgICAgICBjdXJyZW50QmxvY2sucHVzaCh2bm9kZSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdm5vZGU7XHJcbn1cclxuLyoqXHJcbiAqIEBwcml2YXRlXHJcbiAqL1xyXG5mdW5jdGlvbiBjcmVhdGVFbGVtZW50QmxvY2sodHlwZSwgcHJvcHMsIGNoaWxkcmVuLCBwYXRjaEZsYWcsIGR5bmFtaWNQcm9wcywgc2hhcGVGbGFnKSB7XHJcbiAgICByZXR1cm4gc2V0dXBCbG9jayhjcmVhdGVCYXNlVk5vZGUodHlwZSwgcHJvcHMsIGNoaWxkcmVuLCBwYXRjaEZsYWcsIGR5bmFtaWNQcm9wcywgc2hhcGVGbGFnLCB0cnVlIC8qIGlzQmxvY2sgKi8pKTtcclxufVxyXG4vKipcclxuICogQ3JlYXRlIGEgYmxvY2sgcm9vdCB2bm9kZS4gVGFrZXMgdGhlIHNhbWUgZXhhY3QgYXJndW1lbnRzIGFzIGBjcmVhdGVWTm9kZWAuXHJcbiAqIEEgYmxvY2sgcm9vdCBrZWVwcyB0cmFjayBvZiBkeW5hbWljIG5vZGVzIHdpdGhpbiB0aGUgYmxvY2sgaW4gdGhlXHJcbiAqIGBkeW5hbWljQ2hpbGRyZW5gIGFycmF5LlxyXG4gKlxyXG4gKiBAcHJpdmF0ZVxyXG4gKi9cclxuZnVuY3Rpb24gY3JlYXRlQmxvY2sodHlwZSwgcHJvcHMsIGNoaWxkcmVuLCBwYXRjaEZsYWcsIGR5bmFtaWNQcm9wcykge1xyXG4gICAgcmV0dXJuIHNldHVwQmxvY2soY3JlYXRlVk5vZGUodHlwZSwgcHJvcHMsIGNoaWxkcmVuLCBwYXRjaEZsYWcsIGR5bmFtaWNQcm9wcywgdHJ1ZSAvKiBpc0Jsb2NrOiBwcmV2ZW50IGEgYmxvY2sgZnJvbSB0cmFja2luZyBpdHNlbGYgKi8pKTtcclxufVxyXG5mdW5jdGlvbiBpc1ZOb2RlKHZhbHVlKSB7XHJcbiAgICByZXR1cm4gdmFsdWUgPyB2YWx1ZS5fX3ZfaXNWTm9kZSA9PT0gdHJ1ZSA6IGZhbHNlO1xyXG59XHJcbmZ1bmN0aW9uIGlzU2FtZVZOb2RlVHlwZShuMSwgbjIpIHtcclxuICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiZcclxuICAgICAgICBuMi5zaGFwZUZsYWcgJiA2IC8qIENPTVBPTkVOVCAqLyAmJlxyXG4gICAgICAgIGhtckRpcnR5Q29tcG9uZW50cy5oYXMobjIudHlwZSkpIHtcclxuICAgICAgICAvLyBITVIgb25seTogaWYgdGhlIGNvbXBvbmVudCBoYXMgYmVlbiBob3QtdXBkYXRlZCwgZm9yY2UgYSByZWxvYWQuXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG4xLnR5cGUgPT09IG4yLnR5cGUgJiYgbjEua2V5ID09PSBuMi5rZXk7XHJcbn1cclxubGV0IHZub2RlQXJnc1RyYW5zZm9ybWVyO1xyXG4vKipcclxuICogSW50ZXJuYWwgQVBJIGZvciByZWdpc3RlcmluZyBhbiBhcmd1bWVudHMgdHJhbnNmb3JtIGZvciBjcmVhdGVWTm9kZVxyXG4gKiB1c2VkIGZvciBjcmVhdGluZyBzdHVicyBpbiB0aGUgdGVzdC11dGlsc1xyXG4gKiBJdCBpcyAqaW50ZXJuYWwqIGJ1dCBuZWVkcyB0byBiZSBleHBvc2VkIGZvciB0ZXN0LXV0aWxzIHRvIHBpY2sgdXAgcHJvcGVyXHJcbiAqIHR5cGluZ3NcclxuICovXHJcbmZ1bmN0aW9uIHRyYW5zZm9ybVZOb2RlQXJncyh0cmFuc2Zvcm1lcikge1xyXG4gICAgdm5vZGVBcmdzVHJhbnNmb3JtZXIgPSB0cmFuc2Zvcm1lcjtcclxufVxyXG5jb25zdCBjcmVhdGVWTm9kZVdpdGhBcmdzVHJhbnNmb3JtID0gKC4uLmFyZ3MpID0+IHtcclxuICAgIHJldHVybiBfY3JlYXRlVk5vZGUoLi4uKHZub2RlQXJnc1RyYW5zZm9ybWVyXHJcbiAgICAgICAgPyB2bm9kZUFyZ3NUcmFuc2Zvcm1lcihhcmdzLCBjdXJyZW50UmVuZGVyaW5nSW5zdGFuY2UpXHJcbiAgICAgICAgOiBhcmdzKSk7XHJcbn07XHJcbmNvbnN0IEludGVybmFsT2JqZWN0S2V5ID0gYF9fdkludGVybmFsYDtcclxuY29uc3Qgbm9ybWFsaXplS2V5ID0gKHsga2V5IH0pID0+IGtleSAhPSBudWxsID8ga2V5IDogbnVsbDtcclxuY29uc3Qgbm9ybWFsaXplUmVmID0gKHsgcmVmLCByZWZfa2V5LCByZWZfZm9yIH0pID0+IHtcclxuICAgIHJldHVybiAocmVmICE9IG51bGxcclxuICAgICAgICA/IGlzU3RyaW5nKHJlZikgfHwgaXNSZWYocmVmKSB8fCBpc0Z1bmN0aW9uKHJlZilcclxuICAgICAgICAgICAgPyB7IGk6IGN1cnJlbnRSZW5kZXJpbmdJbnN0YW5jZSwgcjogcmVmLCBrOiByZWZfa2V5LCBmOiAhIXJlZl9mb3IgfVxyXG4gICAgICAgICAgICA6IHJlZlxyXG4gICAgICAgIDogbnVsbCk7XHJcbn07XHJcbmZ1bmN0aW9uIGNyZWF0ZUJhc2VWTm9kZSh0eXBlLCBwcm9wcyA9IG51bGwsIGNoaWxkcmVuID0gbnVsbCwgcGF0Y2hGbGFnID0gMCwgZHluYW1pY1Byb3BzID0gbnVsbCwgc2hhcGVGbGFnID0gdHlwZSA9PT0gRnJhZ21lbnQgPyAwIDogMSAvKiBFTEVNRU5UICovLCBpc0Jsb2NrTm9kZSA9IGZhbHNlLCBuZWVkRnVsbENoaWxkcmVuTm9ybWFsaXphdGlvbiA9IGZhbHNlKSB7XHJcbiAgICBjb25zdCB2bm9kZSA9IHtcclxuICAgICAgICBfX3ZfaXNWTm9kZTogdHJ1ZSxcclxuICAgICAgICBfX3Zfc2tpcDogdHJ1ZSxcclxuICAgICAgICB0eXBlLFxyXG4gICAgICAgIHByb3BzLFxyXG4gICAgICAgIGtleTogcHJvcHMgJiYgbm9ybWFsaXplS2V5KHByb3BzKSxcclxuICAgICAgICByZWY6IHByb3BzICYmIG5vcm1hbGl6ZVJlZihwcm9wcyksXHJcbiAgICAgICAgc2NvcGVJZDogY3VycmVudFNjb3BlSWQsXHJcbiAgICAgICAgc2xvdFNjb3BlSWRzOiBudWxsLFxyXG4gICAgICAgIGNoaWxkcmVuLFxyXG4gICAgICAgIGNvbXBvbmVudDogbnVsbCxcclxuICAgICAgICBzdXNwZW5zZTogbnVsbCxcclxuICAgICAgICBzc0NvbnRlbnQ6IG51bGwsXHJcbiAgICAgICAgc3NGYWxsYmFjazogbnVsbCxcclxuICAgICAgICBkaXJzOiBudWxsLFxyXG4gICAgICAgIHRyYW5zaXRpb246IG51bGwsXHJcbiAgICAgICAgZWw6IG51bGwsXHJcbiAgICAgICAgYW5jaG9yOiBudWxsLFxyXG4gICAgICAgIHRhcmdldDogbnVsbCxcclxuICAgICAgICB0YXJnZXRBbmNob3I6IG51bGwsXHJcbiAgICAgICAgc3RhdGljQ291bnQ6IDAsXHJcbiAgICAgICAgc2hhcGVGbGFnLFxyXG4gICAgICAgIHBhdGNoRmxhZyxcclxuICAgICAgICBkeW5hbWljUHJvcHMsXHJcbiAgICAgICAgZHluYW1pY0NoaWxkcmVuOiBudWxsLFxyXG4gICAgICAgIGFwcENvbnRleHQ6IG51bGxcclxuICAgIH07XHJcbiAgICBpZiAobmVlZEZ1bGxDaGlsZHJlbk5vcm1hbGl6YXRpb24pIHtcclxuICAgICAgICBub3JtYWxpemVDaGlsZHJlbih2bm9kZSwgY2hpbGRyZW4pO1xyXG4gICAgICAgIC8vIG5vcm1hbGl6ZSBzdXNwZW5zZSBjaGlsZHJlblxyXG4gICAgICAgIGlmIChzaGFwZUZsYWcgJiAxMjggLyogU1VTUEVOU0UgKi8pIHtcclxuICAgICAgICAgICAgdHlwZS5ub3JtYWxpemUodm5vZGUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGNoaWxkcmVuKSB7XHJcbiAgICAgICAgLy8gY29tcGlsZWQgZWxlbWVudCB2bm9kZSAtIGlmIGNoaWxkcmVuIGlzIHBhc3NlZCwgb25seSBwb3NzaWJsZSB0eXBlcyBhcmVcclxuICAgICAgICAvLyBzdHJpbmcgb3IgQXJyYXkuXHJcbiAgICAgICAgdm5vZGUuc2hhcGVGbGFnIHw9IGlzU3RyaW5nKGNoaWxkcmVuKVxyXG4gICAgICAgICAgICA/IDggLyogVEVYVF9DSElMRFJFTiAqL1xyXG4gICAgICAgICAgICA6IDE2IC8qIEFSUkFZX0NISUxEUkVOICovO1xyXG4gICAgfVxyXG4gICAgLy8gdmFsaWRhdGUga2V5XHJcbiAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmIHZub2RlLmtleSAhPT0gdm5vZGUua2V5KSB7XHJcbiAgICAgICAgd2FybihgVk5vZGUgY3JlYXRlZCB3aXRoIGludmFsaWQga2V5IChOYU4pLiBWTm9kZSB0eXBlOmAsIHZub2RlLnR5cGUpO1xyXG4gICAgfVxyXG4gICAgLy8gdHJhY2sgdm5vZGUgZm9yIGJsb2NrIHRyZWVcclxuICAgIGlmIChpc0Jsb2NrVHJlZUVuYWJsZWQgPiAwICYmXHJcbiAgICAgICAgLy8gYXZvaWQgYSBibG9jayBub2RlIGZyb20gdHJhY2tpbmcgaXRzZWxmXHJcbiAgICAgICAgIWlzQmxvY2tOb2RlICYmXHJcbiAgICAgICAgLy8gaGFzIGN1cnJlbnQgcGFyZW50IGJsb2NrXHJcbiAgICAgICAgY3VycmVudEJsb2NrICYmXHJcbiAgICAgICAgLy8gcHJlc2VuY2Ugb2YgYSBwYXRjaCBmbGFnIGluZGljYXRlcyB0aGlzIG5vZGUgbmVlZHMgcGF0Y2hpbmcgb24gdXBkYXRlcy5cclxuICAgICAgICAvLyBjb21wb25lbnQgbm9kZXMgYWxzbyBzaG91bGQgYWx3YXlzIGJlIHBhdGNoZWQsIGJlY2F1c2UgZXZlbiBpZiB0aGVcclxuICAgICAgICAvLyBjb21wb25lbnQgZG9lc24ndCBuZWVkIHRvIHVwZGF0ZSwgaXQgbmVlZHMgdG8gcGVyc2lzdCB0aGUgaW5zdGFuY2Ugb24gdG9cclxuICAgICAgICAvLyB0aGUgbmV4dCB2bm9kZSBzbyB0aGF0IGl0IGNhbiBiZSBwcm9wZXJseSB1bm1vdW50ZWQgbGF0ZXIuXHJcbiAgICAgICAgKHZub2RlLnBhdGNoRmxhZyA+IDAgfHwgc2hhcGVGbGFnICYgNiAvKiBDT01QT05FTlQgKi8pICYmXHJcbiAgICAgICAgLy8gdGhlIEVWRU5UUyBmbGFnIGlzIG9ubHkgZm9yIGh5ZHJhdGlvbiBhbmQgaWYgaXQgaXMgdGhlIG9ubHkgZmxhZywgdGhlXHJcbiAgICAgICAgLy8gdm5vZGUgc2hvdWxkIG5vdCBiZSBjb25zaWRlcmVkIGR5bmFtaWMgZHVlIHRvIGhhbmRsZXIgY2FjaGluZy5cclxuICAgICAgICB2bm9kZS5wYXRjaEZsYWcgIT09IDMyIC8qIEhZRFJBVEVfRVZFTlRTICovKSB7XHJcbiAgICAgICAgY3VycmVudEJsb2NrLnB1c2godm5vZGUpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHZub2RlO1xyXG59XHJcbmNvbnN0IGNyZWF0ZVZOb2RlID0gKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSA/IGNyZWF0ZVZOb2RlV2l0aEFyZ3NUcmFuc2Zvcm0gOiBfY3JlYXRlVk5vZGUpO1xyXG5mdW5jdGlvbiBfY3JlYXRlVk5vZGUodHlwZSwgcHJvcHMgPSBudWxsLCBjaGlsZHJlbiA9IG51bGwsIHBhdGNoRmxhZyA9IDAsIGR5bmFtaWNQcm9wcyA9IG51bGwsIGlzQmxvY2tOb2RlID0gZmFsc2UpIHtcclxuICAgIGlmICghdHlwZSB8fCB0eXBlID09PSBOVUxMX0RZTkFNSUNfQ09NUE9ORU5UKSB7XHJcbiAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiAhdHlwZSkge1xyXG4gICAgICAgICAgICB3YXJuKGBJbnZhbGlkIHZub2RlIHR5cGUgd2hlbiBjcmVhdGluZyB2bm9kZTogJHt0eXBlfS5gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdHlwZSA9IENvbW1lbnQ7XHJcbiAgICB9XHJcbiAgICBpZiAoaXNWTm9kZSh0eXBlKSkge1xyXG4gICAgICAgIC8vIGNyZWF0ZVZOb2RlIHJlY2VpdmluZyBhbiBleGlzdGluZyB2bm9kZS4gVGhpcyBoYXBwZW5zIGluIGNhc2VzIGxpa2VcclxuICAgICAgICAvLyA8Y29tcG9uZW50IDppcz1cInZub2RlXCIvPlxyXG4gICAgICAgIC8vICMyMDc4IG1ha2Ugc3VyZSB0byBtZXJnZSByZWZzIGR1cmluZyB0aGUgY2xvbmUgaW5zdGVhZCBvZiBvdmVyd3JpdGluZyBpdFxyXG4gICAgICAgIGNvbnN0IGNsb25lZCA9IGNsb25lVk5vZGUodHlwZSwgcHJvcHMsIHRydWUgLyogbWVyZ2VSZWY6IHRydWUgKi8pO1xyXG4gICAgICAgIGlmIChjaGlsZHJlbikge1xyXG4gICAgICAgICAgICBub3JtYWxpemVDaGlsZHJlbihjbG9uZWQsIGNoaWxkcmVuKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGNsb25lZDtcclxuICAgIH1cclxuICAgIC8vIGNsYXNzIGNvbXBvbmVudCBub3JtYWxpemF0aW9uLlxyXG4gICAgaWYgKGlzQ2xhc3NDb21wb25lbnQodHlwZSkpIHtcclxuICAgICAgICB0eXBlID0gdHlwZS5fX3ZjY09wdHM7XHJcbiAgICB9XHJcbiAgICAvLyBjbGFzcyAmIHN0eWxlIG5vcm1hbGl6YXRpb24uXHJcbiAgICBpZiAocHJvcHMpIHtcclxuICAgICAgICAvLyBmb3IgcmVhY3RpdmUgb3IgcHJveHkgb2JqZWN0cywgd2UgbmVlZCB0byBjbG9uZSBpdCB0byBlbmFibGUgbXV0YXRpb24uXHJcbiAgICAgICAgcHJvcHMgPSBndWFyZFJlYWN0aXZlUHJvcHMocHJvcHMpO1xyXG4gICAgICAgIGxldCB7IGNsYXNzOiBrbGFzcywgc3R5bGUgfSA9IHByb3BzO1xyXG4gICAgICAgIGlmIChrbGFzcyAmJiAhaXNTdHJpbmcoa2xhc3MpKSB7XHJcbiAgICAgICAgICAgIHByb3BzLmNsYXNzID0gbm9ybWFsaXplQ2xhc3Moa2xhc3MpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoaXNPYmplY3Qoc3R5bGUpKSB7XHJcbiAgICAgICAgICAgIC8vIHJlYWN0aXZlIHN0YXRlIG9iamVjdHMgbmVlZCB0byBiZSBjbG9uZWQgc2luY2UgdGhleSBhcmUgbGlrZWx5IHRvIGJlXHJcbiAgICAgICAgICAgIC8vIG11dGF0ZWRcclxuICAgICAgICAgICAgaWYgKGlzUHJveHkoc3R5bGUpICYmICFpc0FycmF5KHN0eWxlKSkge1xyXG4gICAgICAgICAgICAgICAgc3R5bGUgPSBleHRlbmQoe30sIHN0eWxlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBwcm9wcy5zdHlsZSA9IG5vcm1hbGl6ZVN0eWxlKHN0eWxlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyBlbmNvZGUgdGhlIHZub2RlIHR5cGUgaW5mb3JtYXRpb24gaW50byBhIGJpdG1hcFxyXG4gICAgY29uc3Qgc2hhcGVGbGFnID0gaXNTdHJpbmcodHlwZSlcclxuICAgICAgICA/IDEgLyogRUxFTUVOVCAqL1xyXG4gICAgICAgIDogaXNTdXNwZW5zZSh0eXBlKVxyXG4gICAgICAgICAgICA/IDEyOCAvKiBTVVNQRU5TRSAqL1xyXG4gICAgICAgICAgICA6IGlzVGVsZXBvcnQodHlwZSlcclxuICAgICAgICAgICAgICAgID8gNjQgLyogVEVMRVBPUlQgKi9cclxuICAgICAgICAgICAgICAgIDogaXNPYmplY3QodHlwZSlcclxuICAgICAgICAgICAgICAgICAgICA/IDQgLyogU1RBVEVGVUxfQ09NUE9ORU5UICovXHJcbiAgICAgICAgICAgICAgICAgICAgOiBpc0Z1bmN0aW9uKHR5cGUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgID8gMiAvKiBGVU5DVElPTkFMX0NPTVBPTkVOVCAqL1xyXG4gICAgICAgICAgICAgICAgICAgICAgICA6IDA7XHJcbiAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmIHNoYXBlRmxhZyAmIDQgLyogU1RBVEVGVUxfQ09NUE9ORU5UICovICYmIGlzUHJveHkodHlwZSkpIHtcclxuICAgICAgICB0eXBlID0gdG9SYXcodHlwZSk7XHJcbiAgICAgICAgd2FybihgVnVlIHJlY2VpdmVkIGEgQ29tcG9uZW50IHdoaWNoIHdhcyBtYWRlIGEgcmVhY3RpdmUgb2JqZWN0LiBUaGlzIGNhbiBgICtcclxuICAgICAgICAgICAgYGxlYWQgdG8gdW5uZWNlc3NhcnkgcGVyZm9ybWFuY2Ugb3ZlcmhlYWQsIGFuZCBzaG91bGQgYmUgYXZvaWRlZCBieSBgICtcclxuICAgICAgICAgICAgYG1hcmtpbmcgdGhlIGNvbXBvbmVudCB3aXRoIFxcYG1hcmtSYXdcXGAgb3IgdXNpbmcgXFxgc2hhbGxvd1JlZlxcYCBgICtcclxuICAgICAgICAgICAgYGluc3RlYWQgb2YgXFxgcmVmXFxgLmAsIGBcXG5Db21wb25lbnQgdGhhdCB3YXMgbWFkZSByZWFjdGl2ZTogYCwgdHlwZSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gY3JlYXRlQmFzZVZOb2RlKHR5cGUsIHByb3BzLCBjaGlsZHJlbiwgcGF0Y2hGbGFnLCBkeW5hbWljUHJvcHMsIHNoYXBlRmxhZywgaXNCbG9ja05vZGUsIHRydWUpO1xyXG59XHJcbmZ1bmN0aW9uIGd1YXJkUmVhY3RpdmVQcm9wcyhwcm9wcykge1xyXG4gICAgaWYgKCFwcm9wcylcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIHJldHVybiBpc1Byb3h5KHByb3BzKSB8fCBJbnRlcm5hbE9iamVjdEtleSBpbiBwcm9wc1xyXG4gICAgICAgID8gZXh0ZW5kKHt9LCBwcm9wcylcclxuICAgICAgICA6IHByb3BzO1xyXG59XHJcbmZ1bmN0aW9uIGNsb25lVk5vZGUodm5vZGUsIGV4dHJhUHJvcHMsIG1lcmdlUmVmID0gZmFsc2UpIHtcclxuICAgIC8vIFRoaXMgaXMgaW50ZW50aW9uYWxseSBOT1QgdXNpbmcgc3ByZWFkIG9yIGV4dGVuZCB0byBhdm9pZCB0aGUgcnVudGltZVxyXG4gICAgLy8ga2V5IGVudW1lcmF0aW9uIGNvc3QuXHJcbiAgICBjb25zdCB7IHByb3BzLCByZWYsIHBhdGNoRmxhZywgY2hpbGRyZW4gfSA9IHZub2RlO1xyXG4gICAgY29uc3QgbWVyZ2VkUHJvcHMgPSBleHRyYVByb3BzID8gbWVyZ2VQcm9wcyhwcm9wcyB8fCB7fSwgZXh0cmFQcm9wcykgOiBwcm9wcztcclxuICAgIGNvbnN0IGNsb25lZCA9IHtcclxuICAgICAgICBfX3ZfaXNWTm9kZTogdHJ1ZSxcclxuICAgICAgICBfX3Zfc2tpcDogdHJ1ZSxcclxuICAgICAgICB0eXBlOiB2bm9kZS50eXBlLFxyXG4gICAgICAgIHByb3BzOiBtZXJnZWRQcm9wcyxcclxuICAgICAgICBrZXk6IG1lcmdlZFByb3BzICYmIG5vcm1hbGl6ZUtleShtZXJnZWRQcm9wcyksXHJcbiAgICAgICAgcmVmOiBleHRyYVByb3BzICYmIGV4dHJhUHJvcHMucmVmXHJcbiAgICAgICAgICAgID8gLy8gIzIwNzggaW4gdGhlIGNhc2Ugb2YgPGNvbXBvbmVudCA6aXM9XCJ2bm9kZVwiIHJlZj1cImV4dHJhXCIvPlxyXG4gICAgICAgICAgICAgICAgLy8gaWYgdGhlIHZub2RlIGl0c2VsZiBhbHJlYWR5IGhhcyBhIHJlZiwgY2xvbmVWTm9kZSB3aWxsIG5lZWQgdG8gbWVyZ2VcclxuICAgICAgICAgICAgICAgIC8vIHRoZSByZWZzIHNvIHRoZSBzaW5nbGUgdm5vZGUgY2FuIGJlIHNldCBvbiBtdWx0aXBsZSByZWZzXHJcbiAgICAgICAgICAgICAgICBtZXJnZVJlZiAmJiByZWZcclxuICAgICAgICAgICAgICAgICAgICA/IGlzQXJyYXkocmVmKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA/IHJlZi5jb25jYXQobm9ybWFsaXplUmVmKGV4dHJhUHJvcHMpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA6IFtyZWYsIG5vcm1hbGl6ZVJlZihleHRyYVByb3BzKV1cclxuICAgICAgICAgICAgICAgICAgICA6IG5vcm1hbGl6ZVJlZihleHRyYVByb3BzKVxyXG4gICAgICAgICAgICA6IHJlZixcclxuICAgICAgICBzY29wZUlkOiB2bm9kZS5zY29wZUlkLFxyXG4gICAgICAgIHNsb3RTY29wZUlkczogdm5vZGUuc2xvdFNjb3BlSWRzLFxyXG4gICAgICAgIGNoaWxkcmVuOiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiYgcGF0Y2hGbGFnID09PSAtMSAvKiBIT0lTVEVEICovICYmIGlzQXJyYXkoY2hpbGRyZW4pXHJcbiAgICAgICAgICAgID8gY2hpbGRyZW4ubWFwKGRlZXBDbG9uZVZOb2RlKVxyXG4gICAgICAgICAgICA6IGNoaWxkcmVuLFxyXG4gICAgICAgIHRhcmdldDogdm5vZGUudGFyZ2V0LFxyXG4gICAgICAgIHRhcmdldEFuY2hvcjogdm5vZGUudGFyZ2V0QW5jaG9yLFxyXG4gICAgICAgIHN0YXRpY0NvdW50OiB2bm9kZS5zdGF0aWNDb3VudCxcclxuICAgICAgICBzaGFwZUZsYWc6IHZub2RlLnNoYXBlRmxhZyxcclxuICAgICAgICAvLyBpZiB0aGUgdm5vZGUgaXMgY2xvbmVkIHdpdGggZXh0cmEgcHJvcHMsIHdlIGNhbiBubyBsb25nZXIgYXNzdW1lIGl0c1xyXG4gICAgICAgIC8vIGV4aXN0aW5nIHBhdGNoIGZsYWcgdG8gYmUgcmVsaWFibGUgYW5kIG5lZWQgdG8gYWRkIHRoZSBGVUxMX1BST1BTIGZsYWcuXHJcbiAgICAgICAgLy8gbm90ZTogcHJlc2VydmUgZmxhZyBmb3IgZnJhZ21lbnRzIHNpbmNlIHRoZXkgdXNlIHRoZSBmbGFnIGZvciBjaGlsZHJlblxyXG4gICAgICAgIC8vIGZhc3QgcGF0aHMgb25seS5cclxuICAgICAgICBwYXRjaEZsYWc6IGV4dHJhUHJvcHMgJiYgdm5vZGUudHlwZSAhPT0gRnJhZ21lbnRcclxuICAgICAgICAgICAgPyBwYXRjaEZsYWcgPT09IC0xIC8vIGhvaXN0ZWQgbm9kZVxyXG4gICAgICAgICAgICAgICAgPyAxNiAvKiBGVUxMX1BST1BTICovXHJcbiAgICAgICAgICAgICAgICA6IHBhdGNoRmxhZyB8IDE2IC8qIEZVTExfUFJPUFMgKi9cclxuICAgICAgICAgICAgOiBwYXRjaEZsYWcsXHJcbiAgICAgICAgZHluYW1pY1Byb3BzOiB2bm9kZS5keW5hbWljUHJvcHMsXHJcbiAgICAgICAgZHluYW1pY0NoaWxkcmVuOiB2bm9kZS5keW5hbWljQ2hpbGRyZW4sXHJcbiAgICAgICAgYXBwQ29udGV4dDogdm5vZGUuYXBwQ29udGV4dCxcclxuICAgICAgICBkaXJzOiB2bm9kZS5kaXJzLFxyXG4gICAgICAgIHRyYW5zaXRpb246IHZub2RlLnRyYW5zaXRpb24sXHJcbiAgICAgICAgLy8gVGhlc2Ugc2hvdWxkIHRlY2huaWNhbGx5IG9ubHkgYmUgbm9uLW51bGwgb24gbW91bnRlZCBWTm9kZXMuIEhvd2V2ZXIsXHJcbiAgICAgICAgLy8gdGhleSAqc2hvdWxkKiBiZSBjb3BpZWQgZm9yIGtlcHQtYWxpdmUgdm5vZGVzLiBTbyB3ZSBqdXN0IGFsd2F5cyBjb3B5XHJcbiAgICAgICAgLy8gdGhlbSBzaW5jZSB0aGVtIGJlaW5nIG5vbi1udWxsIGR1cmluZyBhIG1vdW50IGRvZXNuJ3QgYWZmZWN0IHRoZSBsb2dpYyBhc1xyXG4gICAgICAgIC8vIHRoZXkgd2lsbCBzaW1wbHkgYmUgb3ZlcndyaXR0ZW4uXHJcbiAgICAgICAgY29tcG9uZW50OiB2bm9kZS5jb21wb25lbnQsXHJcbiAgICAgICAgc3VzcGVuc2U6IHZub2RlLnN1c3BlbnNlLFxyXG4gICAgICAgIHNzQ29udGVudDogdm5vZGUuc3NDb250ZW50ICYmIGNsb25lVk5vZGUodm5vZGUuc3NDb250ZW50KSxcclxuICAgICAgICBzc0ZhbGxiYWNrOiB2bm9kZS5zc0ZhbGxiYWNrICYmIGNsb25lVk5vZGUodm5vZGUuc3NGYWxsYmFjayksXHJcbiAgICAgICAgZWw6IHZub2RlLmVsLFxyXG4gICAgICAgIGFuY2hvcjogdm5vZGUuYW5jaG9yXHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIGNsb25lZDtcclxufVxyXG4vKipcclxuICogRGV2IG9ubHksIGZvciBITVIgb2YgaG9pc3RlZCB2bm9kZXMgcmV1c2VkIGluIHYtZm9yXHJcbiAqIGh0dHBzOi8vZ2l0aHViLmNvbS92aXRlanMvdml0ZS9pc3N1ZXMvMjAyMlxyXG4gKi9cclxuZnVuY3Rpb24gZGVlcENsb25lVk5vZGUodm5vZGUpIHtcclxuICAgIGNvbnN0IGNsb25lZCA9IGNsb25lVk5vZGUodm5vZGUpO1xyXG4gICAgaWYgKGlzQXJyYXkodm5vZGUuY2hpbGRyZW4pKSB7XHJcbiAgICAgICAgY2xvbmVkLmNoaWxkcmVuID0gdm5vZGUuY2hpbGRyZW4ubWFwKGRlZXBDbG9uZVZOb2RlKTtcclxuICAgIH1cclxuICAgIHJldHVybiBjbG9uZWQ7XHJcbn1cclxuLyoqXHJcbiAqIEBwcml2YXRlXHJcbiAqL1xyXG5mdW5jdGlvbiBjcmVhdGVUZXh0Vk5vZGUodGV4dCA9ICcgJywgZmxhZyA9IDApIHtcclxuICAgIHJldHVybiBjcmVhdGVWTm9kZShUZXh0LCBudWxsLCB0ZXh0LCBmbGFnKTtcclxufVxyXG4vKipcclxuICogQHByaXZhdGVcclxuICovXHJcbmZ1bmN0aW9uIGNyZWF0ZVN0YXRpY1ZOb2RlKGNvbnRlbnQsIG51bWJlck9mTm9kZXMpIHtcclxuICAgIC8vIEEgc3RhdGljIHZub2RlIGNhbiBjb250YWluIG11bHRpcGxlIHN0cmluZ2lmaWVkIGVsZW1lbnRzLCBhbmQgdGhlIG51bWJlclxyXG4gICAgLy8gb2YgZWxlbWVudHMgaXMgbmVjZXNzYXJ5IGZvciBoeWRyYXRpb24uXHJcbiAgICBjb25zdCB2bm9kZSA9IGNyZWF0ZVZOb2RlKFN0YXRpYywgbnVsbCwgY29udGVudCk7XHJcbiAgICB2bm9kZS5zdGF0aWNDb3VudCA9IG51bWJlck9mTm9kZXM7XHJcbiAgICByZXR1cm4gdm5vZGU7XHJcbn1cclxuLyoqXHJcbiAqIEBwcml2YXRlXHJcbiAqL1xyXG5mdW5jdGlvbiBjcmVhdGVDb21tZW50Vk5vZGUodGV4dCA9ICcnLCBcclxuLy8gd2hlbiB1c2VkIGFzIHRoZSB2LWVsc2UgYnJhbmNoLCB0aGUgY29tbWVudCBub2RlIG11c3QgYmUgY3JlYXRlZCBhcyBhXHJcbi8vIGJsb2NrIHRvIGVuc3VyZSBjb3JyZWN0IHVwZGF0ZXMuXHJcbmFzQmxvY2sgPSBmYWxzZSkge1xyXG4gICAgcmV0dXJuIGFzQmxvY2tcclxuICAgICAgICA/IChvcGVuQmxvY2soKSwgY3JlYXRlQmxvY2soQ29tbWVudCwgbnVsbCwgdGV4dCkpXHJcbiAgICAgICAgOiBjcmVhdGVWTm9kZShDb21tZW50LCBudWxsLCB0ZXh0KTtcclxufVxyXG5mdW5jdGlvbiBub3JtYWxpemVWTm9kZShjaGlsZCkge1xyXG4gICAgaWYgKGNoaWxkID09IG51bGwgfHwgdHlwZW9mIGNoaWxkID09PSAnYm9vbGVhbicpIHtcclxuICAgICAgICAvLyBlbXB0eSBwbGFjZWhvbGRlclxyXG4gICAgICAgIHJldHVybiBjcmVhdGVWTm9kZShDb21tZW50KTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGlzQXJyYXkoY2hpbGQpKSB7XHJcbiAgICAgICAgLy8gZnJhZ21lbnRcclxuICAgICAgICByZXR1cm4gY3JlYXRlVk5vZGUoRnJhZ21lbnQsIG51bGwsIFxyXG4gICAgICAgIC8vICMzNjY2LCBhdm9pZCByZWZlcmVuY2UgcG9sbHV0aW9uIHdoZW4gcmV1c2luZyB2bm9kZVxyXG4gICAgICAgIGNoaWxkLnNsaWNlKCkpO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAodHlwZW9mIGNoaWxkID09PSAnb2JqZWN0Jykge1xyXG4gICAgICAgIC8vIGFscmVhZHkgdm5vZGUsIHRoaXMgc2hvdWxkIGJlIHRoZSBtb3N0IGNvbW1vbiBzaW5jZSBjb21waWxlZCB0ZW1wbGF0ZXNcclxuICAgICAgICAvLyBhbHdheXMgcHJvZHVjZSBhbGwtdm5vZGUgY2hpbGRyZW4gYXJyYXlzXHJcbiAgICAgICAgcmV0dXJuIGNsb25lSWZNb3VudGVkKGNoaWxkKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIC8vIHN0cmluZ3MgYW5kIG51bWJlcnNcclxuICAgICAgICByZXR1cm4gY3JlYXRlVk5vZGUoVGV4dCwgbnVsbCwgU3RyaW5nKGNoaWxkKSk7XHJcbiAgICB9XHJcbn1cclxuLy8gb3B0aW1pemVkIG5vcm1hbGl6YXRpb24gZm9yIHRlbXBsYXRlLWNvbXBpbGVkIHJlbmRlciBmbnNcclxuZnVuY3Rpb24gY2xvbmVJZk1vdW50ZWQoY2hpbGQpIHtcclxuICAgIHJldHVybiBjaGlsZC5lbCA9PT0gbnVsbCB8fCBjaGlsZC5tZW1vID8gY2hpbGQgOiBjbG9uZVZOb2RlKGNoaWxkKTtcclxufVxyXG5mdW5jdGlvbiBub3JtYWxpemVDaGlsZHJlbih2bm9kZSwgY2hpbGRyZW4pIHtcclxuICAgIGxldCB0eXBlID0gMDtcclxuICAgIGNvbnN0IHsgc2hhcGVGbGFnIH0gPSB2bm9kZTtcclxuICAgIGlmIChjaGlsZHJlbiA9PSBudWxsKSB7XHJcbiAgICAgICAgY2hpbGRyZW4gPSBudWxsO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoaXNBcnJheShjaGlsZHJlbikpIHtcclxuICAgICAgICB0eXBlID0gMTYgLyogQVJSQVlfQ0hJTERSRU4gKi87XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICh0eXBlb2YgY2hpbGRyZW4gPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgaWYgKHNoYXBlRmxhZyAmICgxIC8qIEVMRU1FTlQgKi8gfCA2NCAvKiBURUxFUE9SVCAqLykpIHtcclxuICAgICAgICAgICAgLy8gTm9ybWFsaXplIHNsb3QgdG8gcGxhaW4gY2hpbGRyZW4gZm9yIHBsYWluIGVsZW1lbnQgYW5kIFRlbGVwb3J0XHJcbiAgICAgICAgICAgIGNvbnN0IHNsb3QgPSBjaGlsZHJlbi5kZWZhdWx0O1xyXG4gICAgICAgICAgICBpZiAoc2xvdCkge1xyXG4gICAgICAgICAgICAgICAgLy8gX2MgbWFya2VyIGlzIGFkZGVkIGJ5IHdpdGhDdHgoKSBpbmRpY2F0aW5nIHRoaXMgaXMgYSBjb21waWxlZCBzbG90XHJcbiAgICAgICAgICAgICAgICBzbG90Ll9jICYmIChzbG90Ll9kID0gZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgbm9ybWFsaXplQ2hpbGRyZW4odm5vZGUsIHNsb3QoKSk7XHJcbiAgICAgICAgICAgICAgICBzbG90Ll9jICYmIChzbG90Ll9kID0gdHJ1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdHlwZSA9IDMyIC8qIFNMT1RTX0NISUxEUkVOICovO1xyXG4gICAgICAgICAgICBjb25zdCBzbG90RmxhZyA9IGNoaWxkcmVuLl87XHJcbiAgICAgICAgICAgIGlmICghc2xvdEZsYWcgJiYgIShJbnRlcm5hbE9iamVjdEtleSBpbiBjaGlsZHJlbikpIHtcclxuICAgICAgICAgICAgICAgIGNoaWxkcmVuLl9jdHggPSBjdXJyZW50UmVuZGVyaW5nSW5zdGFuY2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoc2xvdEZsYWcgPT09IDMgLyogRk9SV0FSREVEICovICYmIGN1cnJlbnRSZW5kZXJpbmdJbnN0YW5jZSkge1xyXG4gICAgICAgICAgICAgICAgLy8gYSBjaGlsZCBjb21wb25lbnQgcmVjZWl2ZXMgZm9yd2FyZGVkIHNsb3RzIGZyb20gdGhlIHBhcmVudC5cclxuICAgICAgICAgICAgICAgIC8vIGl0cyBzbG90IHR5cGUgaXMgZGV0ZXJtaW5lZCBieSBpdHMgcGFyZW50J3Mgc2xvdCB0eXBlLlxyXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRSZW5kZXJpbmdJbnN0YW5jZS5zbG90cy5fID09PSAxIC8qIFNUQUJMRSAqLykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuLl8gPSAxIC8qIFNUQUJMRSAqLztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuLl8gPSAyIC8qIERZTkFNSUMgKi87XHJcbiAgICAgICAgICAgICAgICAgICAgdm5vZGUucGF0Y2hGbGFnIHw9IDEwMjQgLyogRFlOQU1JQ19TTE9UUyAqLztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGlzRnVuY3Rpb24oY2hpbGRyZW4pKSB7XHJcbiAgICAgICAgY2hpbGRyZW4gPSB7IGRlZmF1bHQ6IGNoaWxkcmVuLCBfY3R4OiBjdXJyZW50UmVuZGVyaW5nSW5zdGFuY2UgfTtcclxuICAgICAgICB0eXBlID0gMzIgLyogU0xPVFNfQ0hJTERSRU4gKi87XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBjaGlsZHJlbiA9IFN0cmluZyhjaGlsZHJlbik7XHJcbiAgICAgICAgLy8gZm9yY2UgdGVsZXBvcnQgY2hpbGRyZW4gdG8gYXJyYXkgc28gaXQgY2FuIGJlIG1vdmVkIGFyb3VuZFxyXG4gICAgICAgIGlmIChzaGFwZUZsYWcgJiA2NCAvKiBURUxFUE9SVCAqLykge1xyXG4gICAgICAgICAgICB0eXBlID0gMTYgLyogQVJSQVlfQ0hJTERSRU4gKi87XHJcbiAgICAgICAgICAgIGNoaWxkcmVuID0gW2NyZWF0ZVRleHRWTm9kZShjaGlsZHJlbildO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdHlwZSA9IDggLyogVEVYVF9DSElMRFJFTiAqLztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICB2bm9kZS5jaGlsZHJlbiA9IGNoaWxkcmVuO1xyXG4gICAgdm5vZGUuc2hhcGVGbGFnIHw9IHR5cGU7XHJcbn1cclxuZnVuY3Rpb24gbWVyZ2VQcm9wcyguLi5hcmdzKSB7XHJcbiAgICBjb25zdCByZXQgPSB7fTtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXJncy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGNvbnN0IHRvTWVyZ2UgPSBhcmdzW2ldO1xyXG4gICAgICAgIGZvciAoY29uc3Qga2V5IGluIHRvTWVyZ2UpIHtcclxuICAgICAgICAgICAgaWYgKGtleSA9PT0gJ2NsYXNzJykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJldC5jbGFzcyAhPT0gdG9NZXJnZS5jbGFzcykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldC5jbGFzcyA9IG5vcm1hbGl6ZUNsYXNzKFtyZXQuY2xhc3MsIHRvTWVyZ2UuY2xhc3NdKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChrZXkgPT09ICdzdHlsZScpIHtcclxuICAgICAgICAgICAgICAgIHJldC5zdHlsZSA9IG5vcm1hbGl6ZVN0eWxlKFtyZXQuc3R5bGUsIHRvTWVyZ2Uuc3R5bGVdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChpc09uKGtleSkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nID0gcmV0W2tleV07XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpbmNvbWluZyA9IHRvTWVyZ2Vba2V5XTtcclxuICAgICAgICAgICAgICAgIGlmIChpbmNvbWluZyAmJlxyXG4gICAgICAgICAgICAgICAgICAgIGV4aXN0aW5nICE9PSBpbmNvbWluZyAmJlxyXG4gICAgICAgICAgICAgICAgICAgICEoaXNBcnJheShleGlzdGluZykgJiYgZXhpc3RpbmcuaW5jbHVkZXMoaW5jb21pbmcpKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldFtrZXldID0gZXhpc3RpbmdcclxuICAgICAgICAgICAgICAgICAgICAgICAgPyBbXS5jb25jYXQoZXhpc3RpbmcsIGluY29taW5nKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA6IGluY29taW5nO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGtleSAhPT0gJycpIHtcclxuICAgICAgICAgICAgICAgIHJldFtrZXldID0gdG9NZXJnZVtrZXldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJldDtcclxufVxyXG5mdW5jdGlvbiBpbnZva2VWTm9kZUhvb2soaG9vaywgaW5zdGFuY2UsIHZub2RlLCBwcmV2Vk5vZGUgPSBudWxsKSB7XHJcbiAgICBjYWxsV2l0aEFzeW5jRXJyb3JIYW5kbGluZyhob29rLCBpbnN0YW5jZSwgNyAvKiBWTk9ERV9IT09LICovLCBbXHJcbiAgICAgICAgdm5vZGUsXHJcbiAgICAgICAgcHJldlZOb2RlXHJcbiAgICBdKTtcclxufVxuXG4vKipcclxuICogQWN0dWFsIGltcGxlbWVudGF0aW9uXHJcbiAqL1xyXG5mdW5jdGlvbiByZW5kZXJMaXN0KHNvdXJjZSwgcmVuZGVySXRlbSwgY2FjaGUsIGluZGV4KSB7XHJcbiAgICBsZXQgcmV0O1xyXG4gICAgY29uc3QgY2FjaGVkID0gKGNhY2hlICYmIGNhY2hlW2luZGV4XSk7XHJcbiAgICBpZiAoaXNBcnJheShzb3VyY2UpIHx8IGlzU3RyaW5nKHNvdXJjZSkpIHtcclxuICAgICAgICByZXQgPSBuZXcgQXJyYXkoc291cmNlLmxlbmd0aCk7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSBzb3VyY2UubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHJldFtpXSA9IHJlbmRlckl0ZW0oc291cmNlW2ldLCBpLCB1bmRlZmluZWQsIGNhY2hlZCAmJiBjYWNoZWRbaV0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2UgaWYgKHR5cGVvZiBzb3VyY2UgPT09ICdudW1iZXInKSB7XHJcbiAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiAhTnVtYmVyLmlzSW50ZWdlcihzb3VyY2UpKSB7XHJcbiAgICAgICAgICAgIHdhcm4oYFRoZSB2LWZvciByYW5nZSBleHBlY3QgYW4gaW50ZWdlciB2YWx1ZSBidXQgZ290ICR7c291cmNlfS5gKTtcclxuICAgICAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXQgPSBuZXcgQXJyYXkoc291cmNlKTtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNvdXJjZTsgaSsrKSB7XHJcbiAgICAgICAgICAgIHJldFtpXSA9IHJlbmRlckl0ZW0oaSArIDEsIGksIHVuZGVmaW5lZCwgY2FjaGVkICYmIGNhY2hlZFtpXSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoaXNPYmplY3Qoc291cmNlKSkge1xyXG4gICAgICAgIGlmIChzb3VyY2VbU3ltYm9sLml0ZXJhdG9yXSkge1xyXG4gICAgICAgICAgICByZXQgPSBBcnJheS5mcm9tKHNvdXJjZSwgKGl0ZW0sIGkpID0+IHJlbmRlckl0ZW0oaXRlbSwgaSwgdW5kZWZpbmVkLCBjYWNoZWQgJiYgY2FjaGVkW2ldKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXMoc291cmNlKTtcclxuICAgICAgICAgICAgcmV0ID0gbmV3IEFycmF5KGtleXMubGVuZ3RoKTtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSBrZXlzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qga2V5ID0ga2V5c1tpXTtcclxuICAgICAgICAgICAgICAgIHJldFtpXSA9IHJlbmRlckl0ZW0oc291cmNlW2tleV0sIGtleSwgaSwgY2FjaGVkICYmIGNhY2hlZFtpXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICByZXQgPSBbXTtcclxuICAgIH1cclxuICAgIGlmIChjYWNoZSkge1xyXG4gICAgICAgIGNhY2hlW2luZGV4XSA9IHJldDtcclxuICAgIH1cclxuICAgIHJldHVybiByZXQ7XHJcbn1cblxuLyoqXHJcbiAqIENvbXBpbGVyIHJ1bnRpbWUgaGVscGVyIGZvciBjcmVhdGluZyBkeW5hbWljIHNsb3RzIG9iamVjdFxyXG4gKiBAcHJpdmF0ZVxyXG4gKi9cclxuZnVuY3Rpb24gY3JlYXRlU2xvdHMoc2xvdHMsIGR5bmFtaWNTbG90cykge1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkeW5hbWljU2xvdHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBjb25zdCBzbG90ID0gZHluYW1pY1Nsb3RzW2ldO1xyXG4gICAgICAgIC8vIGFycmF5IG9mIGR5bmFtaWMgc2xvdCBnZW5lcmF0ZWQgYnkgPHRlbXBsYXRlIHYtZm9yPVwiLi4uXCIgI1suLi5dPlxyXG4gICAgICAgIGlmIChpc0FycmF5KHNsb3QpKSB7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgc2xvdC5sZW5ndGg7IGorKykge1xyXG4gICAgICAgICAgICAgICAgc2xvdHNbc2xvdFtqXS5uYW1lXSA9IHNsb3Rbal0uZm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoc2xvdCkge1xyXG4gICAgICAgICAgICAvLyBjb25kaXRpb25hbCBzaW5nbGUgc2xvdCBnZW5lcmF0ZWQgYnkgPHRlbXBsYXRlIHYtaWY9XCIuLi5cIiAjZm9vPlxyXG4gICAgICAgICAgICBzbG90c1tzbG90Lm5hbWVdID0gc2xvdC5mbjtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gc2xvdHM7XHJcbn1cblxuLyoqXHJcbiAqIENvbXBpbGVyIHJ1bnRpbWUgaGVscGVyIGZvciByZW5kZXJpbmcgYDxzbG90Lz5gXHJcbiAqIEBwcml2YXRlXHJcbiAqL1xyXG5mdW5jdGlvbiByZW5kZXJTbG90KHNsb3RzLCBuYW1lLCBwcm9wcyA9IHt9LCBcclxuLy8gdGhpcyBpcyBub3QgYSB1c2VyLWZhY2luZyBmdW5jdGlvbiwgc28gdGhlIGZhbGxiYWNrIGlzIGFsd2F5cyBnZW5lcmF0ZWQgYnlcclxuLy8gdGhlIGNvbXBpbGVyIGFuZCBndWFyYW50ZWVkIHRvIGJlIGEgZnVuY3Rpb24gcmV0dXJuaW5nIGFuIGFycmF5XHJcbmZhbGxiYWNrLCBub1Nsb3R0ZWQpIHtcclxuICAgIGlmIChjdXJyZW50UmVuZGVyaW5nSW5zdGFuY2UuaXNDRSkge1xyXG4gICAgICAgIHJldHVybiBjcmVhdGVWTm9kZSgnc2xvdCcsIG5hbWUgPT09ICdkZWZhdWx0JyA/IG51bGwgOiB7IG5hbWUgfSwgZmFsbGJhY2sgJiYgZmFsbGJhY2soKSk7XHJcbiAgICB9XHJcbiAgICBsZXQgc2xvdCA9IHNsb3RzW25hbWVdO1xyXG4gICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiBzbG90ICYmIHNsb3QubGVuZ3RoID4gMSkge1xyXG4gICAgICAgIHdhcm4oYFNTUi1vcHRpbWl6ZWQgc2xvdCBmdW5jdGlvbiBkZXRlY3RlZCBpbiBhIG5vbi1TU1Itb3B0aW1pemVkIHJlbmRlciBgICtcclxuICAgICAgICAgICAgYGZ1bmN0aW9uLiBZb3UgbmVlZCB0byBtYXJrIHRoaXMgY29tcG9uZW50IHdpdGggJGR5bmFtaWMtc2xvdHMgaW4gdGhlIGAgK1xyXG4gICAgICAgICAgICBgcGFyZW50IHRlbXBsYXRlLmApO1xyXG4gICAgICAgIHNsb3QgPSAoKSA9PiBbXTtcclxuICAgIH1cclxuICAgIC8vIGEgY29tcGlsZWQgc2xvdCBkaXNhYmxlcyBibG9jayB0cmFja2luZyBieSBkZWZhdWx0IHRvIGF2b2lkIG1hbnVhbFxyXG4gICAgLy8gaW52b2NhdGlvbiBpbnRlcmZlcmluZyB3aXRoIHRlbXBsYXRlLWJhc2VkIGJsb2NrIHRyYWNraW5nLCBidXQgaW5cclxuICAgIC8vIGByZW5kZXJTbG90YCB3ZSBjYW4gYmUgc3VyZSB0aGF0IGl0J3MgdGVtcGxhdGUtYmFzZWQgc28gd2UgY2FuIGZvcmNlXHJcbiAgICAvLyBlbmFibGUgaXQuXHJcbiAgICBpZiAoc2xvdCAmJiBzbG90Ll9jKSB7XHJcbiAgICAgICAgc2xvdC5fZCA9IGZhbHNlO1xyXG4gICAgfVxyXG4gICAgb3BlbkJsb2NrKCk7XHJcbiAgICBjb25zdCB2YWxpZFNsb3RDb250ZW50ID0gc2xvdCAmJiBlbnN1cmVWYWxpZFZOb2RlKHNsb3QocHJvcHMpKTtcclxuICAgIGNvbnN0IHJlbmRlcmVkID0gY3JlYXRlQmxvY2soRnJhZ21lbnQsIHsga2V5OiBwcm9wcy5rZXkgfHwgYF8ke25hbWV9YCB9LCB2YWxpZFNsb3RDb250ZW50IHx8IChmYWxsYmFjayA/IGZhbGxiYWNrKCkgOiBbXSksIHZhbGlkU2xvdENvbnRlbnQgJiYgc2xvdHMuXyA9PT0gMSAvKiBTVEFCTEUgKi9cclxuICAgICAgICA/IDY0IC8qIFNUQUJMRV9GUkFHTUVOVCAqL1xyXG4gICAgICAgIDogLTIgLyogQkFJTCAqLyk7XHJcbiAgICBpZiAoIW5vU2xvdHRlZCAmJiByZW5kZXJlZC5zY29wZUlkKSB7XHJcbiAgICAgICAgcmVuZGVyZWQuc2xvdFNjb3BlSWRzID0gW3JlbmRlcmVkLnNjb3BlSWQgKyAnLXMnXTtcclxuICAgIH1cclxuICAgIGlmIChzbG90ICYmIHNsb3QuX2MpIHtcclxuICAgICAgICBzbG90Ll9kID0gdHJ1ZTtcclxuICAgIH1cclxuICAgIHJldHVybiByZW5kZXJlZDtcclxufVxyXG5mdW5jdGlvbiBlbnN1cmVWYWxpZFZOb2RlKHZub2Rlcykge1xyXG4gICAgcmV0dXJuIHZub2Rlcy5zb21lKGNoaWxkID0+IHtcclxuICAgICAgICBpZiAoIWlzVk5vZGUoY2hpbGQpKVxyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICBpZiAoY2hpbGQudHlwZSA9PT0gQ29tbWVudClcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIGlmIChjaGlsZC50eXBlID09PSBGcmFnbWVudCAmJlxyXG4gICAgICAgICAgICAhZW5zdXJlVmFsaWRWTm9kZShjaGlsZC5jaGlsZHJlbikpXHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH0pXHJcbiAgICAgICAgPyB2bm9kZXNcclxuICAgICAgICA6IG51bGw7XHJcbn1cblxuLyoqXHJcbiAqIEZvciBwcmVmaXhpbmcga2V5cyBpbiB2LW9uPVwib2JqXCIgd2l0aCBcIm9uXCJcclxuICogQHByaXZhdGVcclxuICovXHJcbmZ1bmN0aW9uIHRvSGFuZGxlcnMob2JqKSB7XHJcbiAgICBjb25zdCByZXQgPSB7fTtcclxuICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiYgIWlzT2JqZWN0KG9iaikpIHtcclxuICAgICAgICB3YXJuKGB2LW9uIHdpdGggbm8gYXJndW1lbnQgZXhwZWN0cyBhbiBvYmplY3QgdmFsdWUuYCk7XHJcbiAgICAgICAgcmV0dXJuIHJldDtcclxuICAgIH1cclxuICAgIGZvciAoY29uc3Qga2V5IGluIG9iaikge1xyXG4gICAgICAgIHJldFt0b0hhbmRsZXJLZXkoa2V5KV0gPSBvYmpba2V5XTtcclxuICAgIH1cclxuICAgIHJldHVybiByZXQ7XHJcbn1cblxuLyoqXHJcbiAqICMyNDM3IEluIFZ1ZSAzLCBmdW5jdGlvbmFsIGNvbXBvbmVudHMgZG8gbm90IGhhdmUgYSBwdWJsaWMgaW5zdGFuY2UgcHJveHkgYnV0XHJcbiAqIHRoZXkgZXhpc3QgaW4gdGhlIGludGVybmFsIHBhcmVudCBjaGFpbi4gRm9yIGNvZGUgdGhhdCByZWxpZXMgb24gdHJhdmVyc2luZ1xyXG4gKiBwdWJsaWMgJHBhcmVudCBjaGFpbnMsIHNraXAgZnVuY3Rpb25hbCBvbmVzIGFuZCBnbyB0byB0aGUgcGFyZW50IGluc3RlYWQuXHJcbiAqL1xyXG5jb25zdCBnZXRQdWJsaWNJbnN0YW5jZSA9IChpKSA9PiB7XHJcbiAgICBpZiAoIWkpXHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICBpZiAoaXNTdGF0ZWZ1bENvbXBvbmVudChpKSlcclxuICAgICAgICByZXR1cm4gZ2V0RXhwb3NlUHJveHkoaSkgfHwgaS5wcm94eTtcclxuICAgIHJldHVybiBnZXRQdWJsaWNJbnN0YW5jZShpLnBhcmVudCk7XHJcbn07XHJcbmNvbnN0IHB1YmxpY1Byb3BlcnRpZXNNYXAgPSBleHRlbmQoT2JqZWN0LmNyZWF0ZShudWxsKSwge1xyXG4gICAgJDogaSA9PiBpLFxyXG4gICAgJGVsOiBpID0+IGkudm5vZGUuZWwsXHJcbiAgICAkZGF0YTogaSA9PiBpLmRhdGEsXHJcbiAgICAkcHJvcHM6IGkgPT4gKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSA/IHNoYWxsb3dSZWFkb25seShpLnByb3BzKSA6IGkucHJvcHMpLFxyXG4gICAgJGF0dHJzOiBpID0+ICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgPyBzaGFsbG93UmVhZG9ubHkoaS5hdHRycykgOiBpLmF0dHJzKSxcclxuICAgICRzbG90czogaSA9PiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpID8gc2hhbGxvd1JlYWRvbmx5KGkuc2xvdHMpIDogaS5zbG90cyksXHJcbiAgICAkcmVmczogaSA9PiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpID8gc2hhbGxvd1JlYWRvbmx5KGkucmVmcykgOiBpLnJlZnMpLFxyXG4gICAgJHBhcmVudDogaSA9PiBnZXRQdWJsaWNJbnN0YW5jZShpLnBhcmVudCksXHJcbiAgICAkcm9vdDogaSA9PiBnZXRQdWJsaWNJbnN0YW5jZShpLnJvb3QpLFxyXG4gICAgJGVtaXQ6IGkgPT4gaS5lbWl0LFxyXG4gICAgJG9wdGlvbnM6IGkgPT4gKF9fVlVFX09QVElPTlNfQVBJX18gPyByZXNvbHZlTWVyZ2VkT3B0aW9ucyhpKSA6IGkudHlwZSksXHJcbiAgICAkZm9yY2VVcGRhdGU6IGkgPT4gKCkgPT4gcXVldWVKb2IoaS51cGRhdGUpLFxyXG4gICAgJG5leHRUaWNrOiBpID0+IG5leHRUaWNrLmJpbmQoaS5wcm94eSksXHJcbiAgICAkd2F0Y2g6IGkgPT4gKF9fVlVFX09QVElPTlNfQVBJX18gPyBpbnN0YW5jZVdhdGNoLmJpbmQoaSkgOiBOT09QKVxyXG59KTtcclxuY29uc3QgUHVibGljSW5zdGFuY2VQcm94eUhhbmRsZXJzID0ge1xyXG4gICAgZ2V0KHsgXzogaW5zdGFuY2UgfSwga2V5KSB7XHJcbiAgICAgICAgY29uc3QgeyBjdHgsIHNldHVwU3RhdGUsIGRhdGEsIHByb3BzLCBhY2Nlc3NDYWNoZSwgdHlwZSwgYXBwQ29udGV4dCB9ID0gaW5zdGFuY2U7XHJcbiAgICAgICAgLy8gZm9yIGludGVybmFsIGZvcm1hdHRlcnMgdG8ga25vdyB0aGF0IHRoaXMgaXMgYSBWdWUgaW5zdGFuY2VcclxuICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmIGtleSA9PT0gJ19faXNWdWUnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBwcmlvcml0aXplIDxzY3JpcHQgc2V0dXA+IGJpbmRpbmdzIGR1cmluZyBkZXYuXHJcbiAgICAgICAgLy8gdGhpcyBhbGxvd3MgZXZlbiBwcm9wZXJ0aWVzIHRoYXQgc3RhcnQgd2l0aCBfIG9yICQgdG8gYmUgdXNlZCAtIHNvIHRoYXRcclxuICAgICAgICAvLyBpdCBhbGlnbnMgd2l0aCB0aGUgcHJvZHVjdGlvbiBiZWhhdmlvciB3aGVyZSB0aGUgcmVuZGVyIGZuIGlzIGlubGluZWQgYW5kXHJcbiAgICAgICAgLy8gaW5kZWVkIGhhcyBhY2Nlc3MgdG8gYWxsIGRlY2xhcmVkIHZhcmlhYmxlcy5cclxuICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmXHJcbiAgICAgICAgICAgIHNldHVwU3RhdGUgIT09IEVNUFRZX09CSiAmJlxyXG4gICAgICAgICAgICBzZXR1cFN0YXRlLl9faXNTY3JpcHRTZXR1cCAmJlxyXG4gICAgICAgICAgICBoYXNPd24oc2V0dXBTdGF0ZSwga2V5KSkge1xyXG4gICAgICAgICAgICByZXR1cm4gc2V0dXBTdGF0ZVtrZXldO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBkYXRhIC8gcHJvcHMgLyBjdHhcclxuICAgICAgICAvLyBUaGlzIGdldHRlciBnZXRzIGNhbGxlZCBmb3IgZXZlcnkgcHJvcGVydHkgYWNjZXNzIG9uIHRoZSByZW5kZXIgY29udGV4dFxyXG4gICAgICAgIC8vIGR1cmluZyByZW5kZXIgYW5kIGlzIGEgbWFqb3IgaG90c3BvdC4gVGhlIG1vc3QgZXhwZW5zaXZlIHBhcnQgb2YgdGhpc1xyXG4gICAgICAgIC8vIGlzIHRoZSBtdWx0aXBsZSBoYXNPd24oKSBjYWxscy4gSXQncyBtdWNoIGZhc3RlciB0byBkbyBhIHNpbXBsZSBwcm9wZXJ0eVxyXG4gICAgICAgIC8vIGFjY2VzcyBvbiBhIHBsYWluIG9iamVjdCwgc28gd2UgdXNlIGFuIGFjY2Vzc0NhY2hlIG9iamVjdCAod2l0aCBudWxsXHJcbiAgICAgICAgLy8gcHJvdG90eXBlKSB0byBtZW1vaXplIHdoYXQgYWNjZXNzIHR5cGUgYSBrZXkgY29ycmVzcG9uZHMgdG8uXHJcbiAgICAgICAgbGV0IG5vcm1hbGl6ZWRQcm9wcztcclxuICAgICAgICBpZiAoa2V5WzBdICE9PSAnJCcpIHtcclxuICAgICAgICAgICAgY29uc3QgbiA9IGFjY2Vzc0NhY2hlW2tleV07XHJcbiAgICAgICAgICAgIGlmIChuICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAobikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMSAvKiBTRVRVUCAqLzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNldHVwU3RhdGVba2V5XTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDIgLyogREFUQSAqLzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGFba2V5XTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDQgLyogQ09OVEVYVCAqLzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGN0eFtrZXldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMyAvKiBQUk9QUyAqLzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHByb3BzW2tleV07XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gZGVmYXVsdDoganVzdCBmYWxsdGhyb3VnaFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHNldHVwU3RhdGUgIT09IEVNUFRZX09CSiAmJiBoYXNPd24oc2V0dXBTdGF0ZSwga2V5KSkge1xyXG4gICAgICAgICAgICAgICAgYWNjZXNzQ2FjaGVba2V5XSA9IDEgLyogU0VUVVAgKi87XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc2V0dXBTdGF0ZVtrZXldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGRhdGEgIT09IEVNUFRZX09CSiAmJiBoYXNPd24oZGF0YSwga2V5KSkge1xyXG4gICAgICAgICAgICAgICAgYWNjZXNzQ2FjaGVba2V5XSA9IDIgLyogREFUQSAqLztcclxuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhW2tleV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoXHJcbiAgICAgICAgICAgIC8vIG9ubHkgY2FjaGUgb3RoZXIgcHJvcGVydGllcyB3aGVuIGluc3RhbmNlIGhhcyBkZWNsYXJlZCAodGh1cyBzdGFibGUpXHJcbiAgICAgICAgICAgIC8vIHByb3BzXHJcbiAgICAgICAgICAgIChub3JtYWxpemVkUHJvcHMgPSBpbnN0YW5jZS5wcm9wc09wdGlvbnNbMF0pICYmXHJcbiAgICAgICAgICAgICAgICBoYXNPd24obm9ybWFsaXplZFByb3BzLCBrZXkpKSB7XHJcbiAgICAgICAgICAgICAgICBhY2Nlc3NDYWNoZVtrZXldID0gMyAvKiBQUk9QUyAqLztcclxuICAgICAgICAgICAgICAgIHJldHVybiBwcm9wc1trZXldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGN0eCAhPT0gRU1QVFlfT0JKICYmIGhhc093bihjdHgsIGtleSkpIHtcclxuICAgICAgICAgICAgICAgIGFjY2Vzc0NhY2hlW2tleV0gPSA0IC8qIENPTlRFWFQgKi87XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gY3R4W2tleV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoIV9fVlVFX09QVElPTlNfQVBJX18gfHwgc2hvdWxkQ2FjaGVBY2Nlc3MpIHtcclxuICAgICAgICAgICAgICAgIGFjY2Vzc0NhY2hlW2tleV0gPSAwIC8qIE9USEVSICovO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHB1YmxpY0dldHRlciA9IHB1YmxpY1Byb3BlcnRpZXNNYXBba2V5XTtcclxuICAgICAgICBsZXQgY3NzTW9kdWxlLCBnbG9iYWxQcm9wZXJ0aWVzO1xyXG4gICAgICAgIC8vIHB1YmxpYyAkeHh4IHByb3BlcnRpZXNcclxuICAgICAgICBpZiAocHVibGljR2V0dGVyKSB7XHJcbiAgICAgICAgICAgIGlmIChrZXkgPT09ICckYXR0cnMnKSB7XHJcbiAgICAgICAgICAgICAgICB0cmFjayhpbnN0YW5jZSwgXCJnZXRcIiAvKiBHRVQgKi8sIGtleSk7XHJcbiAgICAgICAgICAgICAgICAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiYgbWFya0F0dHJzQWNjZXNzZWQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gcHVibGljR2V0dGVyKGluc3RhbmNlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoXHJcbiAgICAgICAgLy8gY3NzIG1vZHVsZSAoaW5qZWN0ZWQgYnkgdnVlLWxvYWRlcilcclxuICAgICAgICAoY3NzTW9kdWxlID0gdHlwZS5fX2Nzc01vZHVsZXMpICYmXHJcbiAgICAgICAgICAgIChjc3NNb2R1bGUgPSBjc3NNb2R1bGVba2V5XSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGNzc01vZHVsZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoY3R4ICE9PSBFTVBUWV9PQkogJiYgaGFzT3duKGN0eCwga2V5KSkge1xyXG4gICAgICAgICAgICAvLyB1c2VyIG1heSBzZXQgY3VzdG9tIHByb3BlcnRpZXMgdG8gYHRoaXNgIHRoYXQgc3RhcnQgd2l0aCBgJGBcclxuICAgICAgICAgICAgYWNjZXNzQ2FjaGVba2V5XSA9IDQgLyogQ09OVEVYVCAqLztcclxuICAgICAgICAgICAgcmV0dXJuIGN0eFtrZXldO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChcclxuICAgICAgICAvLyBnbG9iYWwgcHJvcGVydGllc1xyXG4gICAgICAgICgoZ2xvYmFsUHJvcGVydGllcyA9IGFwcENvbnRleHQuY29uZmlnLmdsb2JhbFByb3BlcnRpZXMpLFxyXG4gICAgICAgICAgICBoYXNPd24oZ2xvYmFsUHJvcGVydGllcywga2V5KSkpIHtcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGdsb2JhbFByb3BlcnRpZXNba2V5XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiZcclxuICAgICAgICAgICAgY3VycmVudFJlbmRlcmluZ0luc3RhbmNlICYmXHJcbiAgICAgICAgICAgICghaXNTdHJpbmcoa2V5KSB8fFxyXG4gICAgICAgICAgICAgICAgLy8gIzEwOTEgYXZvaWQgaW50ZXJuYWwgaXNSZWYvaXNWTm9kZSBjaGVja3Mgb24gY29tcG9uZW50IGluc3RhbmNlIGxlYWRpbmdcclxuICAgICAgICAgICAgICAgIC8vIHRvIGluZmluaXRlIHdhcm5pbmcgbG9vcFxyXG4gICAgICAgICAgICAgICAga2V5LmluZGV4T2YoJ19fdicpICE9PSAwKSkge1xyXG4gICAgICAgICAgICBpZiAoZGF0YSAhPT0gRU1QVFlfT0JKICYmXHJcbiAgICAgICAgICAgICAgICAoa2V5WzBdID09PSAnJCcgfHwga2V5WzBdID09PSAnXycpICYmXHJcbiAgICAgICAgICAgICAgICBoYXNPd24oZGF0YSwga2V5KSkge1xyXG4gICAgICAgICAgICAgICAgd2FybihgUHJvcGVydHkgJHtKU09OLnN0cmluZ2lmeShrZXkpfSBtdXN0IGJlIGFjY2Vzc2VkIHZpYSAkZGF0YSBiZWNhdXNlIGl0IHN0YXJ0cyB3aXRoIGEgcmVzZXJ2ZWQgYCArXHJcbiAgICAgICAgICAgICAgICAgICAgYGNoYXJhY3RlciAoXCIkXCIgb3IgXCJfXCIpIGFuZCBpcyBub3QgcHJveGllZCBvbiB0aGUgcmVuZGVyIGNvbnRleHQuYCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoaW5zdGFuY2UgPT09IGN1cnJlbnRSZW5kZXJpbmdJbnN0YW5jZSkge1xyXG4gICAgICAgICAgICAgICAgd2FybihgUHJvcGVydHkgJHtKU09OLnN0cmluZ2lmeShrZXkpfSB3YXMgYWNjZXNzZWQgZHVyaW5nIHJlbmRlciBgICtcclxuICAgICAgICAgICAgICAgICAgICBgYnV0IGlzIG5vdCBkZWZpbmVkIG9uIGluc3RhbmNlLmApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIHNldCh7IF86IGluc3RhbmNlIH0sIGtleSwgdmFsdWUpIHtcclxuICAgICAgICBjb25zdCB7IGRhdGEsIHNldHVwU3RhdGUsIGN0eCB9ID0gaW5zdGFuY2U7XHJcbiAgICAgICAgaWYgKHNldHVwU3RhdGUgIT09IEVNUFRZX09CSiAmJiBoYXNPd24oc2V0dXBTdGF0ZSwga2V5KSkge1xyXG4gICAgICAgICAgICBzZXR1cFN0YXRlW2tleV0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGRhdGEgIT09IEVNUFRZX09CSiAmJiBoYXNPd24oZGF0YSwga2V5KSkge1xyXG4gICAgICAgICAgICBkYXRhW2tleV0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGhhc093bihpbnN0YW5jZS5wcm9wcywga2V5KSkge1xyXG4gICAgICAgICAgICAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiZcclxuICAgICAgICAgICAgICAgIHdhcm4oYEF0dGVtcHRpbmcgdG8gbXV0YXRlIHByb3AgXCIke2tleX1cIi4gUHJvcHMgYXJlIHJlYWRvbmx5LmAsIGluc3RhbmNlKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoa2V5WzBdID09PSAnJCcgJiYga2V5LnNsaWNlKDEpIGluIGluc3RhbmNlKSB7XHJcbiAgICAgICAgICAgIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJlxyXG4gICAgICAgICAgICAgICAgd2FybihgQXR0ZW1wdGluZyB0byBtdXRhdGUgcHVibGljIHByb3BlcnR5IFwiJHtrZXl9XCIuIGAgK1xyXG4gICAgICAgICAgICAgICAgICAgIGBQcm9wZXJ0aWVzIHN0YXJ0aW5nIHdpdGggJCBhcmUgcmVzZXJ2ZWQgYW5kIHJlYWRvbmx5LmAsIGluc3RhbmNlKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiBrZXkgaW4gaW5zdGFuY2UuYXBwQ29udGV4dC5jb25maWcuZ2xvYmFsUHJvcGVydGllcykge1xyXG4gICAgICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGN0eCwga2V5LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgdmFsdWVcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY3R4W2tleV0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH0sXHJcbiAgICBoYXMoeyBfOiB7IGRhdGEsIHNldHVwU3RhdGUsIGFjY2Vzc0NhY2hlLCBjdHgsIGFwcENvbnRleHQsIHByb3BzT3B0aW9ucyB9IH0sIGtleSkge1xyXG4gICAgICAgIGxldCBub3JtYWxpemVkUHJvcHM7XHJcbiAgICAgICAgcmV0dXJuICghIWFjY2Vzc0NhY2hlW2tleV0gfHxcclxuICAgICAgICAgICAgKGRhdGEgIT09IEVNUFRZX09CSiAmJiBoYXNPd24oZGF0YSwga2V5KSkgfHxcclxuICAgICAgICAgICAgKHNldHVwU3RhdGUgIT09IEVNUFRZX09CSiAmJiBoYXNPd24oc2V0dXBTdGF0ZSwga2V5KSkgfHxcclxuICAgICAgICAgICAgKChub3JtYWxpemVkUHJvcHMgPSBwcm9wc09wdGlvbnNbMF0pICYmIGhhc093bihub3JtYWxpemVkUHJvcHMsIGtleSkpIHx8XHJcbiAgICAgICAgICAgIGhhc093bihjdHgsIGtleSkgfHxcclxuICAgICAgICAgICAgaGFzT3duKHB1YmxpY1Byb3BlcnRpZXNNYXAsIGtleSkgfHxcclxuICAgICAgICAgICAgaGFzT3duKGFwcENvbnRleHQuY29uZmlnLmdsb2JhbFByb3BlcnRpZXMsIGtleSkpO1xyXG4gICAgfSxcclxuICAgIGRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBkZXNjcmlwdG9yKSB7XHJcbiAgICAgICAgaWYgKGRlc2NyaXB0b3IuZ2V0ICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5zZXQodGFyZ2V0LCBrZXksIGRlc2NyaXB0b3IuZ2V0KCksIG51bGwpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChkZXNjcmlwdG9yLnZhbHVlICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5zZXQodGFyZ2V0LCBrZXksIGRlc2NyaXB0b3IudmFsdWUsIG51bGwpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gUmVmbGVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgZGVzY3JpcHRvcik7XHJcbiAgICB9XHJcbn07XHJcbmlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiYgIWZhbHNlKSB7XHJcbiAgICBQdWJsaWNJbnN0YW5jZVByb3h5SGFuZGxlcnMub3duS2V5cyA9ICh0YXJnZXQpID0+IHtcclxuICAgICAgICB3YXJuKGBBdm9pZCBhcHAgbG9naWMgdGhhdCByZWxpZXMgb24gZW51bWVyYXRpbmcga2V5cyBvbiBhIGNvbXBvbmVudCBpbnN0YW5jZS4gYCArXHJcbiAgICAgICAgICAgIGBUaGUga2V5cyB3aWxsIGJlIGVtcHR5IGluIHByb2R1Y3Rpb24gbW9kZSB0byBhdm9pZCBwZXJmb3JtYW5jZSBvdmVyaGVhZC5gKTtcclxuICAgICAgICByZXR1cm4gUmVmbGVjdC5vd25LZXlzKHRhcmdldCk7XHJcbiAgICB9O1xyXG59XHJcbmNvbnN0IFJ1bnRpbWVDb21waWxlZFB1YmxpY0luc3RhbmNlUHJveHlIYW5kbGVycyA9IC8qI19fUFVSRV9fKi8gZXh0ZW5kKHt9LCBQdWJsaWNJbnN0YW5jZVByb3h5SGFuZGxlcnMsIHtcclxuICAgIGdldCh0YXJnZXQsIGtleSkge1xyXG4gICAgICAgIC8vIGZhc3QgcGF0aCBmb3IgdW5zY29wYWJsZXMgd2hlbiB1c2luZyBgd2l0aGAgYmxvY2tcclxuICAgICAgICBpZiAoa2V5ID09PSBTeW1ib2wudW5zY29wYWJsZXMpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gUHVibGljSW5zdGFuY2VQcm94eUhhbmRsZXJzLmdldCh0YXJnZXQsIGtleSwgdGFyZ2V0KTtcclxuICAgIH0sXHJcbiAgICBoYXMoXywga2V5KSB7XHJcbiAgICAgICAgY29uc3QgaGFzID0ga2V5WzBdICE9PSAnXycgJiYgIWlzR2xvYmFsbHlXaGl0ZWxpc3RlZChrZXkpO1xyXG4gICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiYgIWhhcyAmJiBQdWJsaWNJbnN0YW5jZVByb3h5SGFuZGxlcnMuaGFzKF8sIGtleSkpIHtcclxuICAgICAgICAgICAgd2FybihgUHJvcGVydHkgJHtKU09OLnN0cmluZ2lmeShrZXkpfSBzaG91bGQgbm90IHN0YXJ0IHdpdGggXyB3aGljaCBpcyBhIHJlc2VydmVkIHByZWZpeCBmb3IgVnVlIGludGVybmFscy5gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGhhcztcclxuICAgIH1cclxufSk7XHJcbi8vIGRldiBvbmx5XHJcbi8vIEluIGRldiBtb2RlLCB0aGUgcHJveHkgdGFyZ2V0IGV4cG9zZXMgdGhlIHNhbWUgcHJvcGVydGllcyBhcyBzZWVuIG9uIGB0aGlzYFxyXG4vLyBmb3IgZWFzaWVyIGNvbnNvbGUgaW5zcGVjdGlvbi4gSW4gcHJvZCBtb2RlIGl0IHdpbGwgYmUgYW4gZW1wdHkgb2JqZWN0IHNvXHJcbi8vIHRoZXNlIHByb3BlcnRpZXMgZGVmaW5pdGlvbnMgY2FuIGJlIHNraXBwZWQuXHJcbmZ1bmN0aW9uIGNyZWF0ZURldlJlbmRlckNvbnRleHQoaW5zdGFuY2UpIHtcclxuICAgIGNvbnN0IHRhcmdldCA9IHt9O1xyXG4gICAgLy8gZXhwb3NlIGludGVybmFsIGluc3RhbmNlIGZvciBwcm94eSBoYW5kbGVyc1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgYF9gLCB7XHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgICAgIGdldDogKCkgPT4gaW5zdGFuY2VcclxuICAgIH0pO1xyXG4gICAgLy8gZXhwb3NlIHB1YmxpYyBwcm9wZXJ0aWVzXHJcbiAgICBPYmplY3Qua2V5cyhwdWJsaWNQcm9wZXJ0aWVzTWFwKS5mb3JFYWNoKGtleSA9PiB7XHJcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCB7XHJcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICAgICAgICAgIGdldDogKCkgPT4gcHVibGljUHJvcGVydGllc01hcFtrZXldKGluc3RhbmNlKSxcclxuICAgICAgICAgICAgLy8gaW50ZXJjZXB0ZWQgYnkgdGhlIHByb3h5IHNvIG5vIG5lZWQgZm9yIGltcGxlbWVudGF0aW9uLFxyXG4gICAgICAgICAgICAvLyBidXQgbmVlZGVkIHRvIHByZXZlbnQgc2V0IGVycm9yc1xyXG4gICAgICAgICAgICBzZXQ6IE5PT1BcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHRhcmdldDtcclxufVxyXG4vLyBkZXYgb25seVxyXG5mdW5jdGlvbiBleHBvc2VQcm9wc09uUmVuZGVyQ29udGV4dChpbnN0YW5jZSkge1xyXG4gICAgY29uc3QgeyBjdHgsIHByb3BzT3B0aW9uczogW3Byb3BzT3B0aW9uc10gfSA9IGluc3RhbmNlO1xyXG4gICAgaWYgKHByb3BzT3B0aW9ucykge1xyXG4gICAgICAgIE9iamVjdC5rZXlzKHByb3BzT3B0aW9ucykuZm9yRWFjaChrZXkgPT4ge1xyXG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoY3R4LCBrZXksIHtcclxuICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBnZXQ6ICgpID0+IGluc3RhbmNlLnByb3BzW2tleV0sXHJcbiAgICAgICAgICAgICAgICBzZXQ6IE5PT1BcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuLy8gZGV2IG9ubHlcclxuZnVuY3Rpb24gZXhwb3NlU2V0dXBTdGF0ZU9uUmVuZGVyQ29udGV4dChpbnN0YW5jZSkge1xyXG4gICAgY29uc3QgeyBjdHgsIHNldHVwU3RhdGUgfSA9IGluc3RhbmNlO1xyXG4gICAgT2JqZWN0LmtleXModG9SYXcoc2V0dXBTdGF0ZSkpLmZvckVhY2goa2V5ID0+IHtcclxuICAgICAgICBpZiAoIXNldHVwU3RhdGUuX19pc1NjcmlwdFNldHVwKSB7XHJcbiAgICAgICAgICAgIGlmIChrZXlbMF0gPT09ICckJyB8fCBrZXlbMF0gPT09ICdfJykge1xyXG4gICAgICAgICAgICAgICAgd2Fybihgc2V0dXAoKSByZXR1cm4gcHJvcGVydHkgJHtKU09OLnN0cmluZ2lmeShrZXkpfSBzaG91bGQgbm90IHN0YXJ0IHdpdGggXCIkXCIgb3IgXCJfXCIgYCArXHJcbiAgICAgICAgICAgICAgICAgICAgYHdoaWNoIGFyZSByZXNlcnZlZCBwcmVmaXhlcyBmb3IgVnVlIGludGVybmFscy5gKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoY3R4LCBrZXksIHtcclxuICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBnZXQ6ICgpID0+IHNldHVwU3RhdGVba2V5XSxcclxuICAgICAgICAgICAgICAgIHNldDogTk9PUFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufVxuXG5jb25zdCBlbXB0eUFwcENvbnRleHQgPSBjcmVhdGVBcHBDb250ZXh0KCk7XHJcbmxldCB1aWQkMSA9IDA7XHJcbmZ1bmN0aW9uIGNyZWF0ZUNvbXBvbmVudEluc3RhbmNlKHZub2RlLCBwYXJlbnQsIHN1c3BlbnNlKSB7XHJcbiAgICBjb25zdCB0eXBlID0gdm5vZGUudHlwZTtcclxuICAgIC8vIGluaGVyaXQgcGFyZW50IGFwcCBjb250ZXh0IC0gb3IgLSBpZiByb290LCBhZG9wdCBmcm9tIHJvb3Qgdm5vZGVcclxuICAgIGNvbnN0IGFwcENvbnRleHQgPSAocGFyZW50ID8gcGFyZW50LmFwcENvbnRleHQgOiB2bm9kZS5hcHBDb250ZXh0KSB8fCBlbXB0eUFwcENvbnRleHQ7XHJcbiAgICBjb25zdCBpbnN0YW5jZSA9IHtcclxuICAgICAgICB1aWQ6IHVpZCQxKyssXHJcbiAgICAgICAgdm5vZGUsXHJcbiAgICAgICAgdHlwZSxcclxuICAgICAgICBwYXJlbnQsXHJcbiAgICAgICAgYXBwQ29udGV4dCxcclxuICAgICAgICByb290OiBudWxsLFxyXG4gICAgICAgIG5leHQ6IG51bGwsXHJcbiAgICAgICAgc3ViVHJlZTogbnVsbCxcclxuICAgICAgICBlZmZlY3Q6IG51bGwsXHJcbiAgICAgICAgdXBkYXRlOiBudWxsLFxyXG4gICAgICAgIHNjb3BlOiBuZXcgRWZmZWN0U2NvcGUodHJ1ZSAvKiBkZXRhY2hlZCAqLyksXHJcbiAgICAgICAgcmVuZGVyOiBudWxsLFxyXG4gICAgICAgIHByb3h5OiBudWxsLFxyXG4gICAgICAgIGV4cG9zZWQ6IG51bGwsXHJcbiAgICAgICAgZXhwb3NlUHJveHk6IG51bGwsXHJcbiAgICAgICAgd2l0aFByb3h5OiBudWxsLFxyXG4gICAgICAgIHByb3ZpZGVzOiBwYXJlbnQgPyBwYXJlbnQucHJvdmlkZXMgOiBPYmplY3QuY3JlYXRlKGFwcENvbnRleHQucHJvdmlkZXMpLFxyXG4gICAgICAgIGFjY2Vzc0NhY2hlOiBudWxsLFxyXG4gICAgICAgIHJlbmRlckNhY2hlOiBbXSxcclxuICAgICAgICAvLyBsb2NhbCByZXNvdmxlZCBhc3NldHNcclxuICAgICAgICBjb21wb25lbnRzOiBudWxsLFxyXG4gICAgICAgIGRpcmVjdGl2ZXM6IG51bGwsXHJcbiAgICAgICAgLy8gcmVzb2x2ZWQgcHJvcHMgYW5kIGVtaXRzIG9wdGlvbnNcclxuICAgICAgICBwcm9wc09wdGlvbnM6IG5vcm1hbGl6ZVByb3BzT3B0aW9ucyh0eXBlLCBhcHBDb250ZXh0KSxcclxuICAgICAgICBlbWl0c09wdGlvbnM6IG5vcm1hbGl6ZUVtaXRzT3B0aW9ucyh0eXBlLCBhcHBDb250ZXh0KSxcclxuICAgICAgICAvLyBlbWl0XHJcbiAgICAgICAgZW1pdDogbnVsbCxcclxuICAgICAgICBlbWl0dGVkOiBudWxsLFxyXG4gICAgICAgIC8vIHByb3BzIGRlZmF1bHQgdmFsdWVcclxuICAgICAgICBwcm9wc0RlZmF1bHRzOiBFTVBUWV9PQkosXHJcbiAgICAgICAgLy8gaW5oZXJpdEF0dHJzXHJcbiAgICAgICAgaW5oZXJpdEF0dHJzOiB0eXBlLmluaGVyaXRBdHRycyxcclxuICAgICAgICAvLyBzdGF0ZVxyXG4gICAgICAgIGN0eDogRU1QVFlfT0JKLFxyXG4gICAgICAgIGRhdGE6IEVNUFRZX09CSixcclxuICAgICAgICBwcm9wczogRU1QVFlfT0JKLFxyXG4gICAgICAgIGF0dHJzOiBFTVBUWV9PQkosXHJcbiAgICAgICAgc2xvdHM6IEVNUFRZX09CSixcclxuICAgICAgICByZWZzOiBFTVBUWV9PQkosXHJcbiAgICAgICAgc2V0dXBTdGF0ZTogRU1QVFlfT0JKLFxyXG4gICAgICAgIHNldHVwQ29udGV4dDogbnVsbCxcclxuICAgICAgICAvLyBzdXNwZW5zZSByZWxhdGVkXHJcbiAgICAgICAgc3VzcGVuc2UsXHJcbiAgICAgICAgc3VzcGVuc2VJZDogc3VzcGVuc2UgPyBzdXNwZW5zZS5wZW5kaW5nSWQgOiAwLFxyXG4gICAgICAgIGFzeW5jRGVwOiBudWxsLFxyXG4gICAgICAgIGFzeW5jUmVzb2x2ZWQ6IGZhbHNlLFxyXG4gICAgICAgIC8vIGxpZmVjeWNsZSBob29rc1xyXG4gICAgICAgIC8vIG5vdCB1c2luZyBlbnVtcyBoZXJlIGJlY2F1c2UgaXQgcmVzdWx0cyBpbiBjb21wdXRlZCBwcm9wZXJ0aWVzXHJcbiAgICAgICAgaXNNb3VudGVkOiBmYWxzZSxcclxuICAgICAgICBpc1VubW91bnRlZDogZmFsc2UsXHJcbiAgICAgICAgaXNEZWFjdGl2YXRlZDogZmFsc2UsXHJcbiAgICAgICAgYmM6IG51bGwsXHJcbiAgICAgICAgYzogbnVsbCxcclxuICAgICAgICBibTogbnVsbCxcclxuICAgICAgICBtOiBudWxsLFxyXG4gICAgICAgIGJ1OiBudWxsLFxyXG4gICAgICAgIHU6IG51bGwsXHJcbiAgICAgICAgdW06IG51bGwsXHJcbiAgICAgICAgYnVtOiBudWxsLFxyXG4gICAgICAgIGRhOiBudWxsLFxyXG4gICAgICAgIGE6IG51bGwsXHJcbiAgICAgICAgcnRnOiBudWxsLFxyXG4gICAgICAgIHJ0YzogbnVsbCxcclxuICAgICAgICBlYzogbnVsbCxcclxuICAgICAgICBzcDogbnVsbFxyXG4gICAgfTtcclxuICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICBpbnN0YW5jZS5jdHggPSBjcmVhdGVEZXZSZW5kZXJDb250ZXh0KGluc3RhbmNlKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIGluc3RhbmNlLmN0eCA9IHsgXzogaW5zdGFuY2UgfTtcclxuICAgIH1cclxuICAgIGluc3RhbmNlLnJvb3QgPSBwYXJlbnQgPyBwYXJlbnQucm9vdCA6IGluc3RhbmNlO1xyXG4gICAgaW5zdGFuY2UuZW1pdCA9IGVtaXQkMS5iaW5kKG51bGwsIGluc3RhbmNlKTtcclxuICAgIC8vIGFwcGx5IGN1c3RvbSBlbGVtZW50IHNwZWNpYWwgaGFuZGxpbmdcclxuICAgIGlmICh2bm9kZS5jZSkge1xyXG4gICAgICAgIHZub2RlLmNlKGluc3RhbmNlKTtcclxuICAgIH1cclxuICAgIHJldHVybiBpbnN0YW5jZTtcclxufVxyXG5sZXQgY3VycmVudEluc3RhbmNlID0gbnVsbDtcclxuY29uc3QgZ2V0Q3VycmVudEluc3RhbmNlID0gKCkgPT4gY3VycmVudEluc3RhbmNlIHx8IGN1cnJlbnRSZW5kZXJpbmdJbnN0YW5jZTtcclxuY29uc3Qgc2V0Q3VycmVudEluc3RhbmNlID0gKGluc3RhbmNlKSA9PiB7XHJcbiAgICBjdXJyZW50SW5zdGFuY2UgPSBpbnN0YW5jZTtcclxuICAgIGluc3RhbmNlLnNjb3BlLm9uKCk7XHJcbn07XHJcbmNvbnN0IHVuc2V0Q3VycmVudEluc3RhbmNlID0gKCkgPT4ge1xyXG4gICAgY3VycmVudEluc3RhbmNlICYmIGN1cnJlbnRJbnN0YW5jZS5zY29wZS5vZmYoKTtcclxuICAgIGN1cnJlbnRJbnN0YW5jZSA9IG51bGw7XHJcbn07XHJcbmNvbnN0IGlzQnVpbHRJblRhZyA9IC8qI19fUFVSRV9fKi8gbWFrZU1hcCgnc2xvdCxjb21wb25lbnQnKTtcclxuZnVuY3Rpb24gdmFsaWRhdGVDb21wb25lbnROYW1lKG5hbWUsIGNvbmZpZykge1xyXG4gICAgY29uc3QgYXBwSXNOYXRpdmVUYWcgPSBjb25maWcuaXNOYXRpdmVUYWcgfHwgTk87XHJcbiAgICBpZiAoaXNCdWlsdEluVGFnKG5hbWUpIHx8IGFwcElzTmF0aXZlVGFnKG5hbWUpKSB7XHJcbiAgICAgICAgd2FybignRG8gbm90IHVzZSBidWlsdC1pbiBvciByZXNlcnZlZCBIVE1MIGVsZW1lbnRzIGFzIGNvbXBvbmVudCBpZDogJyArIG5hbWUpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGlzU3RhdGVmdWxDb21wb25lbnQoaW5zdGFuY2UpIHtcclxuICAgIHJldHVybiBpbnN0YW5jZS52bm9kZS5zaGFwZUZsYWcgJiA0IC8qIFNUQVRFRlVMX0NPTVBPTkVOVCAqLztcclxufVxyXG5sZXQgaXNJblNTUkNvbXBvbmVudFNldHVwID0gZmFsc2U7XHJcbmZ1bmN0aW9uIHNldHVwQ29tcG9uZW50KGluc3RhbmNlLCBpc1NTUiA9IGZhbHNlKSB7XHJcbiAgICBpc0luU1NSQ29tcG9uZW50U2V0dXAgPSBpc1NTUjtcclxuICAgIGNvbnN0IHsgcHJvcHMsIGNoaWxkcmVuIH0gPSBpbnN0YW5jZS52bm9kZTtcclxuICAgIGNvbnN0IGlzU3RhdGVmdWwgPSBpc1N0YXRlZnVsQ29tcG9uZW50KGluc3RhbmNlKTtcclxuICAgIGluaXRQcm9wcyhpbnN0YW5jZSwgcHJvcHMsIGlzU3RhdGVmdWwsIGlzU1NSKTtcclxuICAgIGluaXRTbG90cyhpbnN0YW5jZSwgY2hpbGRyZW4pO1xyXG4gICAgY29uc3Qgc2V0dXBSZXN1bHQgPSBpc1N0YXRlZnVsXHJcbiAgICAgICAgPyBzZXR1cFN0YXRlZnVsQ29tcG9uZW50KGluc3RhbmNlLCBpc1NTUilcclxuICAgICAgICA6IHVuZGVmaW5lZDtcclxuICAgIGlzSW5TU1JDb21wb25lbnRTZXR1cCA9IGZhbHNlO1xyXG4gICAgcmV0dXJuIHNldHVwUmVzdWx0O1xyXG59XHJcbmZ1bmN0aW9uIHNldHVwU3RhdGVmdWxDb21wb25lbnQoaW5zdGFuY2UsIGlzU1NSKSB7XHJcbiAgICBjb25zdCBDb21wb25lbnQgPSBpbnN0YW5jZS50eXBlO1xyXG4gICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgIGlmIChDb21wb25lbnQubmFtZSkge1xyXG4gICAgICAgICAgICB2YWxpZGF0ZUNvbXBvbmVudE5hbWUoQ29tcG9uZW50Lm5hbWUsIGluc3RhbmNlLmFwcENvbnRleHQuY29uZmlnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKENvbXBvbmVudC5jb21wb25lbnRzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG5hbWVzID0gT2JqZWN0LmtleXMoQ29tcG9uZW50LmNvbXBvbmVudHMpO1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5hbWVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YWxpZGF0ZUNvbXBvbmVudE5hbWUobmFtZXNbaV0sIGluc3RhbmNlLmFwcENvbnRleHQuY29uZmlnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoQ29tcG9uZW50LmRpcmVjdGl2ZXMpIHtcclxuICAgICAgICAgICAgY29uc3QgbmFtZXMgPSBPYmplY3Qua2V5cyhDb21wb25lbnQuZGlyZWN0aXZlcyk7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbmFtZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHZhbGlkYXRlRGlyZWN0aXZlTmFtZShuYW1lc1tpXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKENvbXBvbmVudC5jb21waWxlck9wdGlvbnMgJiYgaXNSdW50aW1lT25seSgpKSB7XHJcbiAgICAgICAgICAgIHdhcm4oYFwiY29tcGlsZXJPcHRpb25zXCIgaXMgb25seSBzdXBwb3J0ZWQgd2hlbiB1c2luZyBhIGJ1aWxkIG9mIFZ1ZSB0aGF0IGAgK1xyXG4gICAgICAgICAgICAgICAgYGluY2x1ZGVzIHRoZSBydW50aW1lIGNvbXBpbGVyLiBTaW5jZSB5b3UgYXJlIHVzaW5nIGEgcnVudGltZS1vbmx5IGAgK1xyXG4gICAgICAgICAgICAgICAgYGJ1aWxkLCB0aGUgb3B0aW9ucyBzaG91bGQgYmUgcGFzc2VkIHZpYSB5b3VyIGJ1aWxkIHRvb2wgY29uZmlnIGluc3RlYWQuYCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8gMC4gY3JlYXRlIHJlbmRlciBwcm94eSBwcm9wZXJ0eSBhY2Nlc3MgY2FjaGVcclxuICAgIGluc3RhbmNlLmFjY2Vzc0NhY2hlID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcclxuICAgIC8vIDEuIGNyZWF0ZSBwdWJsaWMgaW5zdGFuY2UgLyByZW5kZXIgcHJveHlcclxuICAgIC8vIGFsc28gbWFyayBpdCByYXcgc28gaXQncyBuZXZlciBvYnNlcnZlZFxyXG4gICAgaW5zdGFuY2UucHJveHkgPSBtYXJrUmF3KG5ldyBQcm94eShpbnN0YW5jZS5jdHgsIFB1YmxpY0luc3RhbmNlUHJveHlIYW5kbGVycykpO1xyXG4gICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgIGV4cG9zZVByb3BzT25SZW5kZXJDb250ZXh0KGluc3RhbmNlKTtcclxuICAgIH1cclxuICAgIC8vIDIuIGNhbGwgc2V0dXAoKVxyXG4gICAgY29uc3QgeyBzZXR1cCB9ID0gQ29tcG9uZW50O1xyXG4gICAgaWYgKHNldHVwKSB7XHJcbiAgICAgICAgY29uc3Qgc2V0dXBDb250ZXh0ID0gKGluc3RhbmNlLnNldHVwQ29udGV4dCA9XHJcbiAgICAgICAgICAgIHNldHVwLmxlbmd0aCA+IDEgPyBjcmVhdGVTZXR1cENvbnRleHQoaW5zdGFuY2UpIDogbnVsbCk7XHJcbiAgICAgICAgc2V0Q3VycmVudEluc3RhbmNlKGluc3RhbmNlKTtcclxuICAgICAgICBwYXVzZVRyYWNraW5nKCk7XHJcbiAgICAgICAgY29uc3Qgc2V0dXBSZXN1bHQgPSBjYWxsV2l0aEVycm9ySGFuZGxpbmcoc2V0dXAsIGluc3RhbmNlLCAwIC8qIFNFVFVQX0ZVTkNUSU9OICovLCBbKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpID8gc2hhbGxvd1JlYWRvbmx5KGluc3RhbmNlLnByb3BzKSA6IGluc3RhbmNlLnByb3BzLCBzZXR1cENvbnRleHRdKTtcclxuICAgICAgICByZXNldFRyYWNraW5nKCk7XHJcbiAgICAgICAgdW5zZXRDdXJyZW50SW5zdGFuY2UoKTtcclxuICAgICAgICBpZiAoaXNQcm9taXNlKHNldHVwUmVzdWx0KSkge1xyXG4gICAgICAgICAgICBzZXR1cFJlc3VsdC50aGVuKHVuc2V0Q3VycmVudEluc3RhbmNlLCB1bnNldEN1cnJlbnRJbnN0YW5jZSk7XHJcbiAgICAgICAgICAgIGlmIChpc1NTUikge1xyXG4gICAgICAgICAgICAgICAgLy8gcmV0dXJuIHRoZSBwcm9taXNlIHNvIHNlcnZlci1yZW5kZXJlciBjYW4gd2FpdCBvbiBpdFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHNldHVwUmVzdWx0XHJcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oKHJlc29sdmVkUmVzdWx0KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlU2V0dXBSZXN1bHQoaW5zdGFuY2UsIHJlc29sdmVkUmVzdWx0LCBpc1NTUik7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5jYXRjaChlID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBoYW5kbGVFcnJvcihlLCBpbnN0YW5jZSwgMCAvKiBTRVRVUF9GVU5DVElPTiAqLyk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIGFzeW5jIHNldHVwIHJldHVybmVkIFByb21pc2UuXHJcbiAgICAgICAgICAgICAgICAvLyBiYWlsIGhlcmUgYW5kIHdhaXQgZm9yIHJlLWVudHJ5LlxyXG4gICAgICAgICAgICAgICAgaW5zdGFuY2UuYXN5bmNEZXAgPSBzZXR1cFJlc3VsdDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgaGFuZGxlU2V0dXBSZXN1bHQoaW5zdGFuY2UsIHNldHVwUmVzdWx0LCBpc1NTUik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgZmluaXNoQ29tcG9uZW50U2V0dXAoaW5zdGFuY2UsIGlzU1NSKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBoYW5kbGVTZXR1cFJlc3VsdChpbnN0YW5jZSwgc2V0dXBSZXN1bHQsIGlzU1NSKSB7XHJcbiAgICBpZiAoaXNGdW5jdGlvbihzZXR1cFJlc3VsdCkpIHtcclxuICAgICAgICAvLyBzZXR1cCByZXR1cm5lZCBhbiBpbmxpbmUgcmVuZGVyIGZ1bmN0aW9uXHJcbiAgICAgICAgaWYgKGluc3RhbmNlLnR5cGUuX19zc3JJbmxpbmVSZW5kZXIpIHtcclxuICAgICAgICAgICAgLy8gd2hlbiB0aGUgZnVuY3Rpb24ncyBuYW1lIGlzIGBzc3JSZW5kZXJgIChjb21waWxlZCBieSBTRkMgaW5saW5lIG1vZGUpLFxyXG4gICAgICAgICAgICAvLyBzZXQgaXQgYXMgc3NyUmVuZGVyIGluc3RlYWQuXHJcbiAgICAgICAgICAgIGluc3RhbmNlLnNzclJlbmRlciA9IHNldHVwUmVzdWx0O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgaW5zdGFuY2UucmVuZGVyID0gc2V0dXBSZXN1bHQ7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoaXNPYmplY3Qoc2V0dXBSZXN1bHQpKSB7XHJcbiAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiBpc1ZOb2RlKHNldHVwUmVzdWx0KSkge1xyXG4gICAgICAgICAgICB3YXJuKGBzZXR1cCgpIHNob3VsZCBub3QgcmV0dXJuIFZOb2RlcyBkaXJlY3RseSAtIGAgK1xyXG4gICAgICAgICAgICAgICAgYHJldHVybiBhIHJlbmRlciBmdW5jdGlvbiBpbnN0ZWFkLmApO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBzZXR1cCByZXR1cm5lZCBiaW5kaW5ncy5cclxuICAgICAgICAvLyBhc3N1bWluZyBhIHJlbmRlciBmdW5jdGlvbiBjb21waWxlZCBmcm9tIHRlbXBsYXRlIGlzIHByZXNlbnQuXHJcbiAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB8fCBfX1ZVRV9QUk9EX0RFVlRPT0xTX18pIHtcclxuICAgICAgICAgICAgaW5zdGFuY2UuZGV2dG9vbHNSYXdTZXR1cFN0YXRlID0gc2V0dXBSZXN1bHQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGluc3RhbmNlLnNldHVwU3RhdGUgPSBwcm94eVJlZnMoc2V0dXBSZXN1bHQpO1xyXG4gICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgZXhwb3NlU2V0dXBTdGF0ZU9uUmVuZGVyQ29udGV4dChpbnN0YW5jZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmIHNldHVwUmVzdWx0ICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICB3YXJuKGBzZXR1cCgpIHNob3VsZCByZXR1cm4gYW4gb2JqZWN0LiBSZWNlaXZlZDogJHtzZXR1cFJlc3VsdCA9PT0gbnVsbCA/ICdudWxsJyA6IHR5cGVvZiBzZXR1cFJlc3VsdH1gKTtcclxuICAgIH1cclxuICAgIGZpbmlzaENvbXBvbmVudFNldHVwKGluc3RhbmNlLCBpc1NTUik7XHJcbn1cclxubGV0IGNvbXBpbGU7XHJcbmxldCBpbnN0YWxsV2l0aFByb3h5O1xyXG4vKipcclxuICogRm9yIHJ1bnRpbWUtZG9tIHRvIHJlZ2lzdGVyIHRoZSBjb21waWxlci5cclxuICogTm90ZSB0aGUgZXhwb3J0ZWQgbWV0aG9kIHVzZXMgYW55IHRvIGF2b2lkIGQudHMgcmVseWluZyBvbiB0aGUgY29tcGlsZXIgdHlwZXMuXHJcbiAqL1xyXG5mdW5jdGlvbiByZWdpc3RlclJ1bnRpbWVDb21waWxlcihfY29tcGlsZSkge1xyXG4gICAgY29tcGlsZSA9IF9jb21waWxlO1xyXG4gICAgaW5zdGFsbFdpdGhQcm94eSA9IGkgPT4ge1xyXG4gICAgICAgIGlmIChpLnJlbmRlci5fcmMpIHtcclxuICAgICAgICAgICAgaS53aXRoUHJveHkgPSBuZXcgUHJveHkoaS5jdHgsIFJ1bnRpbWVDb21waWxlZFB1YmxpY0luc3RhbmNlUHJveHlIYW5kbGVycyk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufVxyXG4vLyBkZXYgb25seVxyXG5jb25zdCBpc1J1bnRpbWVPbmx5ID0gKCkgPT4gIWNvbXBpbGU7XHJcbmZ1bmN0aW9uIGZpbmlzaENvbXBvbmVudFNldHVwKGluc3RhbmNlLCBpc1NTUiwgc2tpcE9wdGlvbnMpIHtcclxuICAgIGNvbnN0IENvbXBvbmVudCA9IGluc3RhbmNlLnR5cGU7XHJcbiAgICAvLyB0ZW1wbGF0ZSAvIHJlbmRlciBmdW5jdGlvbiBub3JtYWxpemF0aW9uXHJcbiAgICAvLyBjb3VsZCBiZSBhbHJlYWR5IHNldCB3aGVuIHJldHVybmVkIGZyb20gc2V0dXAoKVxyXG4gICAgaWYgKCFpbnN0YW5jZS5yZW5kZXIpIHtcclxuICAgICAgICAvLyBvbmx5IGRvIG9uLXRoZS1mbHkgY29tcGlsZSBpZiBub3QgaW4gU1NSIC0gU1NSIG9uLXRoZS1mbHkgY29tcGlsYXRpb25cclxuICAgICAgICAvLyBpcyBkb25lIGJ5IHNlcnZlci1yZW5kZXJlclxyXG4gICAgICAgIGlmICghaXNTU1IgJiYgY29tcGlsZSAmJiAhQ29tcG9uZW50LnJlbmRlcikge1xyXG4gICAgICAgICAgICBjb25zdCB0ZW1wbGF0ZSA9IENvbXBvbmVudC50ZW1wbGF0ZTtcclxuICAgICAgICAgICAgaWYgKHRlbXBsYXRlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RhcnRNZWFzdXJlKGluc3RhbmNlLCBgY29tcGlsZWApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgeyBpc0N1c3RvbUVsZW1lbnQsIGNvbXBpbGVyT3B0aW9ucyB9ID0gaW5zdGFuY2UuYXBwQ29udGV4dC5jb25maWc7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB7IGRlbGltaXRlcnMsIGNvbXBpbGVyT3B0aW9uczogY29tcG9uZW50Q29tcGlsZXJPcHRpb25zIH0gPSBDb21wb25lbnQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBmaW5hbENvbXBpbGVyT3B0aW9ucyA9IGV4dGVuZChleHRlbmQoe1xyXG4gICAgICAgICAgICAgICAgICAgIGlzQ3VzdG9tRWxlbWVudCxcclxuICAgICAgICAgICAgICAgICAgICBkZWxpbWl0ZXJzXHJcbiAgICAgICAgICAgICAgICB9LCBjb21waWxlck9wdGlvbnMpLCBjb21wb25lbnRDb21waWxlck9wdGlvbnMpO1xyXG4gICAgICAgICAgICAgICAgQ29tcG9uZW50LnJlbmRlciA9IGNvbXBpbGUodGVtcGxhdGUsIGZpbmFsQ29tcGlsZXJPcHRpb25zKTtcclxuICAgICAgICAgICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgICAgICBlbmRNZWFzdXJlKGluc3RhbmNlLCBgY29tcGlsZWApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGluc3RhbmNlLnJlbmRlciA9IChDb21wb25lbnQucmVuZGVyIHx8IE5PT1ApO1xyXG4gICAgICAgIC8vIGZvciBydW50aW1lLWNvbXBpbGVkIHJlbmRlciBmdW5jdGlvbnMgdXNpbmcgYHdpdGhgIGJsb2NrcywgdGhlIHJlbmRlclxyXG4gICAgICAgIC8vIHByb3h5IHVzZWQgbmVlZHMgYSBkaWZmZXJlbnQgYGhhc2AgaGFuZGxlciB3aGljaCBpcyBtb3JlIHBlcmZvcm1hbnQgYW5kXHJcbiAgICAgICAgLy8gYWxzbyBvbmx5IGFsbG93cyBhIHdoaXRlbGlzdCBvZiBnbG9iYWxzIHRvIGZhbGx0aHJvdWdoLlxyXG4gICAgICAgIGlmIChpbnN0YWxsV2l0aFByb3h5KSB7XHJcbiAgICAgICAgICAgIGluc3RhbGxXaXRoUHJveHkoaW5zdGFuY2UpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8vIHN1cHBvcnQgZm9yIDIueCBvcHRpb25zXHJcbiAgICBpZiAoX19WVUVfT1BUSU9OU19BUElfXyAmJiAhKGZhbHNlICkpIHtcclxuICAgICAgICBzZXRDdXJyZW50SW5zdGFuY2UoaW5zdGFuY2UpO1xyXG4gICAgICAgIHBhdXNlVHJhY2tpbmcoKTtcclxuICAgICAgICBhcHBseU9wdGlvbnMoaW5zdGFuY2UpO1xyXG4gICAgICAgIHJlc2V0VHJhY2tpbmcoKTtcclxuICAgICAgICB1bnNldEN1cnJlbnRJbnN0YW5jZSgpO1xyXG4gICAgfVxyXG4gICAgLy8gd2FybiBtaXNzaW5nIHRlbXBsYXRlL3JlbmRlclxyXG4gICAgLy8gdGhlIHJ1bnRpbWUgY29tcGlsYXRpb24gb2YgdGVtcGxhdGUgaW4gU1NSIGlzIGRvbmUgYnkgc2VydmVyLXJlbmRlclxyXG4gICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiAhQ29tcG9uZW50LnJlbmRlciAmJiBpbnN0YW5jZS5yZW5kZXIgPT09IE5PT1AgJiYgIWlzU1NSKSB7XHJcbiAgICAgICAgLyogaXN0YW5idWwgaWdub3JlIGlmICovXHJcbiAgICAgICAgaWYgKCFjb21waWxlICYmIENvbXBvbmVudC50ZW1wbGF0ZSkge1xyXG4gICAgICAgICAgICB3YXJuKGBDb21wb25lbnQgcHJvdmlkZWQgdGVtcGxhdGUgb3B0aW9uIGJ1dCBgICtcclxuICAgICAgICAgICAgICAgIGBydW50aW1lIGNvbXBpbGF0aW9uIGlzIG5vdCBzdXBwb3J0ZWQgaW4gdGhpcyBidWlsZCBvZiBWdWUuYCArXHJcbiAgICAgICAgICAgICAgICAoYCBDb25maWd1cmUgeW91ciBidW5kbGVyIHRvIGFsaWFzIFwidnVlXCIgdG8gXCJ2dWUvZGlzdC92dWUuZXNtLWJ1bmRsZXIuanNcIi5gXHJcbiAgICAgICAgICAgICAgICAgICAgKSAvKiBzaG91bGQgbm90IGhhcHBlbiAqLyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB3YXJuKGBDb21wb25lbnQgaXMgbWlzc2luZyB0ZW1wbGF0ZSBvciByZW5kZXIgZnVuY3Rpb24uYCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGNyZWF0ZUF0dHJzUHJveHkoaW5zdGFuY2UpIHtcclxuICAgIHJldHVybiBuZXcgUHJveHkoaW5zdGFuY2UuYXR0cnMsIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKVxyXG4gICAgICAgID8ge1xyXG4gICAgICAgICAgICBnZXQodGFyZ2V0LCBrZXkpIHtcclxuICAgICAgICAgICAgICAgIG1hcmtBdHRyc0FjY2Vzc2VkKCk7XHJcbiAgICAgICAgICAgICAgICB0cmFjayhpbnN0YW5jZSwgXCJnZXRcIiAvKiBHRVQgKi8sICckYXR0cnMnKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXRba2V5XTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgc2V0KCkge1xyXG4gICAgICAgICAgICAgICAgd2Fybihgc2V0dXBDb250ZXh0LmF0dHJzIGlzIHJlYWRvbmx5LmApO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBkZWxldGVQcm9wZXJ0eSgpIHtcclxuICAgICAgICAgICAgICAgIHdhcm4oYHNldHVwQ29udGV4dC5hdHRycyBpcyByZWFkb25seS5gKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICA6IHtcclxuICAgICAgICAgICAgZ2V0KHRhcmdldCwga2V5KSB7XHJcbiAgICAgICAgICAgICAgICB0cmFjayhpbnN0YW5jZSwgXCJnZXRcIiAvKiBHRVQgKi8sICckYXR0cnMnKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXRba2V5XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG59XHJcbmZ1bmN0aW9uIGNyZWF0ZVNldHVwQ29udGV4dChpbnN0YW5jZSkge1xyXG4gICAgY29uc3QgZXhwb3NlID0gZXhwb3NlZCA9PiB7XHJcbiAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiBpbnN0YW5jZS5leHBvc2VkKSB7XHJcbiAgICAgICAgICAgIHdhcm4oYGV4cG9zZSgpIHNob3VsZCBiZSBjYWxsZWQgb25seSBvbmNlIHBlciBzZXR1cCgpLmApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpbnN0YW5jZS5leHBvc2VkID0gZXhwb3NlZCB8fCB7fTtcclxuICAgIH07XHJcbiAgICBsZXQgYXR0cnM7XHJcbiAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgLy8gV2UgdXNlIGdldHRlcnMgaW4gZGV2IGluIGNhc2UgbGlicyBsaWtlIHRlc3QtdXRpbHMgb3ZlcndyaXRlIGluc3RhbmNlXHJcbiAgICAgICAgLy8gcHJvcGVydGllcyAob3ZlcndyaXRlcyBzaG91bGQgbm90IGJlIGRvbmUgaW4gcHJvZClcclxuICAgICAgICByZXR1cm4gT2JqZWN0LmZyZWV6ZSh7XHJcbiAgICAgICAgICAgIGdldCBhdHRycygpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBhdHRycyB8fCAoYXR0cnMgPSBjcmVhdGVBdHRyc1Byb3h5KGluc3RhbmNlKSk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGdldCBzbG90cygpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBzaGFsbG93UmVhZG9ubHkoaW5zdGFuY2Uuc2xvdHMpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBnZXQgZW1pdCgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAoZXZlbnQsIC4uLmFyZ3MpID0+IGluc3RhbmNlLmVtaXQoZXZlbnQsIC4uLmFyZ3MpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBleHBvc2VcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGdldCBhdHRycygpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBhdHRycyB8fCAoYXR0cnMgPSBjcmVhdGVBdHRyc1Byb3h5KGluc3RhbmNlKSk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHNsb3RzOiBpbnN0YW5jZS5zbG90cyxcclxuICAgICAgICAgICAgZW1pdDogaW5zdGFuY2UuZW1pdCxcclxuICAgICAgICAgICAgZXhwb3NlXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBnZXRFeHBvc2VQcm94eShpbnN0YW5jZSkge1xyXG4gICAgaWYgKGluc3RhbmNlLmV4cG9zZWQpIHtcclxuICAgICAgICByZXR1cm4gKGluc3RhbmNlLmV4cG9zZVByb3h5IHx8XHJcbiAgICAgICAgICAgIChpbnN0YW5jZS5leHBvc2VQcm94eSA9IG5ldyBQcm94eShwcm94eVJlZnMobWFya1JhdyhpbnN0YW5jZS5leHBvc2VkKSksIHtcclxuICAgICAgICAgICAgICAgIGdldCh0YXJnZXQsIGtleSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChrZXkgaW4gdGFyZ2V0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXRba2V5XTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoa2V5IGluIHB1YmxpY1Byb3BlcnRpZXNNYXApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHB1YmxpY1Byb3BlcnRpZXNNYXBba2V5XShpbnN0YW5jZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KSkpO1xyXG4gICAgfVxyXG59XHJcbmNvbnN0IGNsYXNzaWZ5UkUgPSAvKD86XnxbLV9dKShcXHcpL2c7XHJcbmNvbnN0IGNsYXNzaWZ5ID0gKHN0cikgPT4gc3RyLnJlcGxhY2UoY2xhc3NpZnlSRSwgYyA9PiBjLnRvVXBwZXJDYXNlKCkpLnJlcGxhY2UoL1stX10vZywgJycpO1xyXG5mdW5jdGlvbiBnZXRDb21wb25lbnROYW1lKENvbXBvbmVudCkge1xyXG4gICAgcmV0dXJuIGlzRnVuY3Rpb24oQ29tcG9uZW50KVxyXG4gICAgICAgID8gQ29tcG9uZW50LmRpc3BsYXlOYW1lIHx8IENvbXBvbmVudC5uYW1lXHJcbiAgICAgICAgOiBDb21wb25lbnQubmFtZTtcclxufVxyXG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xyXG5mdW5jdGlvbiBmb3JtYXRDb21wb25lbnROYW1lKGluc3RhbmNlLCBDb21wb25lbnQsIGlzUm9vdCA9IGZhbHNlKSB7XHJcbiAgICBsZXQgbmFtZSA9IGdldENvbXBvbmVudE5hbWUoQ29tcG9uZW50KTtcclxuICAgIGlmICghbmFtZSAmJiBDb21wb25lbnQuX19maWxlKSB7XHJcbiAgICAgICAgY29uc3QgbWF0Y2ggPSBDb21wb25lbnQuX19maWxlLm1hdGNoKC8oW14vXFxcXF0rKVxcLlxcdyskLyk7XHJcbiAgICAgICAgaWYgKG1hdGNoKSB7XHJcbiAgICAgICAgICAgIG5hbWUgPSBtYXRjaFsxXTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAoIW5hbWUgJiYgaW5zdGFuY2UgJiYgaW5zdGFuY2UucGFyZW50KSB7XHJcbiAgICAgICAgLy8gdHJ5IHRvIGluZmVyIHRoZSBuYW1lIGJhc2VkIG9uIHJldmVyc2UgcmVzb2x1dGlvblxyXG4gICAgICAgIGNvbnN0IGluZmVyRnJvbVJlZ2lzdHJ5ID0gKHJlZ2lzdHJ5KSA9PiB7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IGluIHJlZ2lzdHJ5KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVnaXN0cnlba2V5XSA9PT0gQ29tcG9uZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGtleTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgbmFtZSA9XHJcbiAgICAgICAgICAgIGluZmVyRnJvbVJlZ2lzdHJ5KGluc3RhbmNlLmNvbXBvbmVudHMgfHxcclxuICAgICAgICAgICAgICAgIGluc3RhbmNlLnBhcmVudC50eXBlLmNvbXBvbmVudHMpIHx8IGluZmVyRnJvbVJlZ2lzdHJ5KGluc3RhbmNlLmFwcENvbnRleHQuY29tcG9uZW50cyk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbmFtZSA/IGNsYXNzaWZ5KG5hbWUpIDogaXNSb290ID8gYEFwcGAgOiBgQW5vbnltb3VzYDtcclxufVxyXG5mdW5jdGlvbiBpc0NsYXNzQ29tcG9uZW50KHZhbHVlKSB7XHJcbiAgICByZXR1cm4gaXNGdW5jdGlvbih2YWx1ZSkgJiYgJ19fdmNjT3B0cycgaW4gdmFsdWU7XHJcbn1cblxuY29uc3QgY29tcHV0ZWQgPSAoKGdldHRlck9yT3B0aW9ucywgZGVidWdPcHRpb25zKSA9PiB7XHJcbiAgICAvLyBAdHMtaWdub3JlXHJcbiAgICByZXR1cm4gY29tcHV0ZWQkMShnZXR0ZXJPck9wdGlvbnMsIGRlYnVnT3B0aW9ucywgaXNJblNTUkNvbXBvbmVudFNldHVwKTtcclxufSk7XG5cbi8vIGRldiBvbmx5XHJcbmNvbnN0IHdhcm5SdW50aW1lVXNhZ2UgPSAobWV0aG9kKSA9PiB3YXJuKGAke21ldGhvZH0oKSBpcyBhIGNvbXBpbGVyLWhpbnQgaGVscGVyIHRoYXQgaXMgb25seSB1c2FibGUgaW5zaWRlIGAgK1xyXG4gICAgYDxzY3JpcHQgc2V0dXA+IG9mIGEgc2luZ2xlIGZpbGUgY29tcG9uZW50LiBJdHMgYXJndW1lbnRzIHNob3VsZCBiZSBgICtcclxuICAgIGBjb21waWxlZCBhd2F5IGFuZCBwYXNzaW5nIGl0IGF0IHJ1bnRpbWUgaGFzIG5vIGVmZmVjdC5gKTtcclxuLy8gaW1wbGVtZW50YXRpb25cclxuZnVuY3Rpb24gZGVmaW5lUHJvcHMoKSB7XHJcbiAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKSB7XHJcbiAgICAgICAgd2FyblJ1bnRpbWVVc2FnZShgZGVmaW5lUHJvcHNgKTtcclxuICAgIH1cclxuICAgIHJldHVybiBudWxsO1xyXG59XHJcbi8vIGltcGxlbWVudGF0aW9uXHJcbmZ1bmN0aW9uIGRlZmluZUVtaXRzKCkge1xyXG4gICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgIHdhcm5SdW50aW1lVXNhZ2UoYGRlZmluZUVtaXRzYCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbnVsbDtcclxufVxyXG4vKipcclxuICogVnVlIGA8c2NyaXB0IHNldHVwPmAgY29tcGlsZXIgbWFjcm8gZm9yIGRlY2xhcmluZyBhIGNvbXBvbmVudCdzIGV4cG9zZWRcclxuICogaW5zdGFuY2UgcHJvcGVydGllcyB3aGVuIGl0IGlzIGFjY2Vzc2VkIGJ5IGEgcGFyZW50IGNvbXBvbmVudCB2aWEgdGVtcGxhdGVcclxuICogcmVmcy5cclxuICpcclxuICogYDxzY3JpcHQgc2V0dXA+YCBjb21wb25lbnRzIGFyZSBjbG9zZWQgYnkgZGVmYXVsdCAtIGkuZS4gdmFyaWFibGVzIGluc2lkZVxyXG4gKiB0aGUgYDxzY3JpcHQgc2V0dXA+YCBzY29wZSBpcyBub3QgZXhwb3NlZCB0byBwYXJlbnQgdW5sZXNzIGV4cGxpY2l0bHkgZXhwb3NlZFxyXG4gKiB2aWEgYGRlZmluZUV4cG9zZWAuXHJcbiAqXHJcbiAqIFRoaXMgaXMgb25seSB1c2FibGUgaW5zaWRlIGA8c2NyaXB0IHNldHVwPmAsIGlzIGNvbXBpbGVkIGF3YXkgaW4gdGhlXHJcbiAqIG91dHB1dCBhbmQgc2hvdWxkICoqbm90KiogYmUgYWN0dWFsbHkgY2FsbGVkIGF0IHJ1bnRpbWUuXHJcbiAqL1xyXG5mdW5jdGlvbiBkZWZpbmVFeHBvc2UoZXhwb3NlZCkge1xyXG4gICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgIHdhcm5SdW50aW1lVXNhZ2UoYGRlZmluZUV4cG9zZWApO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBWdWUgYDxzY3JpcHQgc2V0dXA+YCBjb21waWxlciBtYWNybyBmb3IgcHJvdmlkaW5nIHByb3BzIGRlZmF1bHQgdmFsdWVzIHdoZW5cclxuICogdXNpbmcgdHlwZS1iYXNlZCBgZGVmaW5lUHJvcHNgIGRlY2xhcmF0aW9uLlxyXG4gKlxyXG4gKiBFeGFtcGxlIHVzYWdlOlxyXG4gKiBgYGB0c1xyXG4gKiB3aXRoRGVmYXVsdHMoZGVmaW5lUHJvcHM8e1xyXG4gKiAgIHNpemU/OiBudW1iZXJcclxuICogICBsYWJlbHM/OiBzdHJpbmdbXVxyXG4gKiB9PigpLCB7XHJcbiAqICAgc2l6ZTogMyxcclxuICogICBsYWJlbHM6ICgpID0+IFsnZGVmYXVsdCBsYWJlbCddXHJcbiAqIH0pXHJcbiAqIGBgYFxyXG4gKlxyXG4gKiBUaGlzIGlzIG9ubHkgdXNhYmxlIGluc2lkZSBgPHNjcmlwdCBzZXR1cD5gLCBpcyBjb21waWxlZCBhd2F5IGluIHRoZSBvdXRwdXRcclxuICogYW5kIHNob3VsZCAqKm5vdCoqIGJlIGFjdHVhbGx5IGNhbGxlZCBhdCBydW50aW1lLlxyXG4gKi9cclxuZnVuY3Rpb24gd2l0aERlZmF1bHRzKHByb3BzLCBkZWZhdWx0cykge1xyXG4gICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgIHdhcm5SdW50aW1lVXNhZ2UoYHdpdGhEZWZhdWx0c2ApO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG51bGw7XHJcbn1cclxuZnVuY3Rpb24gdXNlU2xvdHMoKSB7XHJcbiAgICByZXR1cm4gZ2V0Q29udGV4dCgpLnNsb3RzO1xyXG59XHJcbmZ1bmN0aW9uIHVzZUF0dHJzKCkge1xyXG4gICAgcmV0dXJuIGdldENvbnRleHQoKS5hdHRycztcclxufVxyXG5mdW5jdGlvbiBnZXRDb250ZXh0KCkge1xyXG4gICAgY29uc3QgaSA9IGdldEN1cnJlbnRJbnN0YW5jZSgpO1xyXG4gICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiAhaSkge1xyXG4gICAgICAgIHdhcm4oYHVzZUNvbnRleHQoKSBjYWxsZWQgd2l0aG91dCBhY3RpdmUgaW5zdGFuY2UuYCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gaS5zZXR1cENvbnRleHQgfHwgKGkuc2V0dXBDb250ZXh0ID0gY3JlYXRlU2V0dXBDb250ZXh0KGkpKTtcclxufVxyXG4vKipcclxuICogUnVudGltZSBoZWxwZXIgZm9yIG1lcmdpbmcgZGVmYXVsdCBkZWNsYXJhdGlvbnMuIEltcG9ydGVkIGJ5IGNvbXBpbGVkIGNvZGVcclxuICogb25seS5cclxuICogQGludGVybmFsXHJcbiAqL1xyXG5mdW5jdGlvbiBtZXJnZURlZmF1bHRzKHJhdywgZGVmYXVsdHMpIHtcclxuICAgIGNvbnN0IHByb3BzID0gaXNBcnJheShyYXcpXHJcbiAgICAgICAgPyByYXcucmVkdWNlKChub3JtYWxpemVkLCBwKSA9PiAoKG5vcm1hbGl6ZWRbcF0gPSB7fSksIG5vcm1hbGl6ZWQpLCB7fSlcclxuICAgICAgICA6IHJhdztcclxuICAgIGZvciAoY29uc3Qga2V5IGluIGRlZmF1bHRzKSB7XHJcbiAgICAgICAgY29uc3Qgb3B0ID0gcHJvcHNba2V5XTtcclxuICAgICAgICBpZiAob3B0KSB7XHJcbiAgICAgICAgICAgIGlmIChpc0FycmF5KG9wdCkgfHwgaXNGdW5jdGlvbihvcHQpKSB7XHJcbiAgICAgICAgICAgICAgICBwcm9wc1trZXldID0geyB0eXBlOiBvcHQsIGRlZmF1bHQ6IGRlZmF1bHRzW2tleV0gfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIG9wdC5kZWZhdWx0ID0gZGVmYXVsdHNba2V5XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChvcHQgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgcHJvcHNba2V5XSA9IHsgZGVmYXVsdDogZGVmYXVsdHNba2V5XSB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgd2FybihgcHJvcHMgZGVmYXVsdCBrZXkgXCIke2tleX1cIiBoYXMgbm8gY29ycmVzcG9uZGluZyBkZWNsYXJhdGlvbi5gKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcHJvcHM7XHJcbn1cclxuLyoqXHJcbiAqIFVzZWQgdG8gY3JlYXRlIGEgcHJveHkgZm9yIHRoZSByZXN0IGVsZW1lbnQgd2hlbiBkZXN0cnVjdHVyaW5nIHByb3BzIHdpdGhcclxuICogZGVmaW5lUHJvcHMoKS5cclxuICogQGludGVybmFsXHJcbiAqL1xyXG5mdW5jdGlvbiBjcmVhdGVQcm9wc1Jlc3RQcm94eShwcm9wcywgZXhjbHVkZWRLZXlzKSB7XHJcbiAgICBjb25zdCByZXQgPSB7fTtcclxuICAgIGZvciAoY29uc3Qga2V5IGluIHByb3BzKSB7XHJcbiAgICAgICAgaWYgKCFleGNsdWRlZEtleXMuaW5jbHVkZXMoa2V5KSkge1xyXG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocmV0LCBrZXksIHtcclxuICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBnZXQ6ICgpID0+IHByb3BzW2tleV1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJldDtcclxufVxyXG4vKipcclxuICogYDxzY3JpcHQgc2V0dXA+YCBoZWxwZXIgZm9yIHBlcnNpc3RpbmcgdGhlIGN1cnJlbnQgaW5zdGFuY2UgY29udGV4dCBvdmVyXHJcbiAqIGFzeW5jL2F3YWl0IGZsb3dzLlxyXG4gKlxyXG4gKiBgQHZ1ZS9jb21waWxlci1zZmNgIGNvbnZlcnRzIHRoZSBmb2xsb3dpbmc6XHJcbiAqXHJcbiAqIGBgYHRzXHJcbiAqIGNvbnN0IHggPSBhd2FpdCBmb28oKVxyXG4gKiBgYGBcclxuICpcclxuICogaW50bzpcclxuICpcclxuICogYGBgdHNcclxuICogbGV0IF9fdGVtcCwgX19yZXN0b3JlXHJcbiAqIGNvbnN0IHggPSAoKFtfX3RlbXAsIF9fcmVzdG9yZV0gPSB3aXRoQXN5bmNDb250ZXh0KCgpID0+IGZvbygpKSksX190ZW1wPWF3YWl0IF9fdGVtcCxfX3Jlc3RvcmUoKSxfX3RlbXApXHJcbiAqIGBgYFxyXG4gKiBAaW50ZXJuYWxcclxuICovXHJcbmZ1bmN0aW9uIHdpdGhBc3luY0NvbnRleHQoZ2V0QXdhaXRhYmxlKSB7XHJcbiAgICBjb25zdCBjdHggPSBnZXRDdXJyZW50SW5zdGFuY2UoKTtcclxuICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiYgIWN0eCkge1xyXG4gICAgICAgIHdhcm4oYHdpdGhBc3luY0NvbnRleHQgY2FsbGVkIHdpdGhvdXQgYWN0aXZlIGN1cnJlbnQgaW5zdGFuY2UuIGAgK1xyXG4gICAgICAgICAgICBgVGhpcyBpcyBsaWtlbHkgYSBidWcuYCk7XHJcbiAgICB9XHJcbiAgICBsZXQgYXdhaXRhYmxlID0gZ2V0QXdhaXRhYmxlKCk7XHJcbiAgICB1bnNldEN1cnJlbnRJbnN0YW5jZSgpO1xyXG4gICAgaWYgKGlzUHJvbWlzZShhd2FpdGFibGUpKSB7XHJcbiAgICAgICAgYXdhaXRhYmxlID0gYXdhaXRhYmxlLmNhdGNoKGUgPT4ge1xyXG4gICAgICAgICAgICBzZXRDdXJyZW50SW5zdGFuY2UoY3R4KTtcclxuICAgICAgICAgICAgdGhyb3cgZTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIHJldHVybiBbYXdhaXRhYmxlLCAoKSA9PiBzZXRDdXJyZW50SW5zdGFuY2UoY3R4KV07XHJcbn1cblxuLy8gQWN0dWFsIGltcGxlbWVudGF0aW9uXHJcbmZ1bmN0aW9uIGgodHlwZSwgcHJvcHNPckNoaWxkcmVuLCBjaGlsZHJlbikge1xyXG4gICAgY29uc3QgbCA9IGFyZ3VtZW50cy5sZW5ndGg7XHJcbiAgICBpZiAobCA9PT0gMikge1xyXG4gICAgICAgIGlmIChpc09iamVjdChwcm9wc09yQ2hpbGRyZW4pICYmICFpc0FycmF5KHByb3BzT3JDaGlsZHJlbikpIHtcclxuICAgICAgICAgICAgLy8gc2luZ2xlIHZub2RlIHdpdGhvdXQgcHJvcHNcclxuICAgICAgICAgICAgaWYgKGlzVk5vZGUocHJvcHNPckNoaWxkcmVuKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNyZWF0ZVZOb2RlKHR5cGUsIG51bGwsIFtwcm9wc09yQ2hpbGRyZW5dKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBwcm9wcyB3aXRob3V0IGNoaWxkcmVuXHJcbiAgICAgICAgICAgIHJldHVybiBjcmVhdGVWTm9kZSh0eXBlLCBwcm9wc09yQ2hpbGRyZW4pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8gb21pdCBwcm9wc1xyXG4gICAgICAgICAgICByZXR1cm4gY3JlYXRlVk5vZGUodHlwZSwgbnVsbCwgcHJvcHNPckNoaWxkcmVuKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBpZiAobCA+IDMpIHtcclxuICAgICAgICAgICAgY2hpbGRyZW4gPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChsID09PSAzICYmIGlzVk5vZGUoY2hpbGRyZW4pKSB7XHJcbiAgICAgICAgICAgIGNoaWxkcmVuID0gW2NoaWxkcmVuXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGNyZWF0ZVZOb2RlKHR5cGUsIHByb3BzT3JDaGlsZHJlbiwgY2hpbGRyZW4pO1xyXG4gICAgfVxyXG59XG5cbmNvbnN0IHNzckNvbnRleHRLZXkgPSBTeW1ib2woKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpID8gYHNzckNvbnRleHRgIDogYGApO1xyXG5jb25zdCB1c2VTU1JDb250ZXh0ID0gKCkgPT4ge1xyXG4gICAge1xyXG4gICAgICAgIGNvbnN0IGN0eCA9IGluamVjdChzc3JDb250ZXh0S2V5KTtcclxuICAgICAgICBpZiAoIWN0eCkge1xyXG4gICAgICAgICAgICB3YXJuKGBTZXJ2ZXIgcmVuZGVyaW5nIGNvbnRleHQgbm90IHByb3ZpZGVkLiBNYWtlIHN1cmUgdG8gb25seSBjYWxsIGAgK1xyXG4gICAgICAgICAgICAgICAgYHVzZVNTUkNvbnRleHQoKSBjb25kaXRpb25hbGx5IGluIHRoZSBzZXJ2ZXIgYnVpbGQuYCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBjdHg7XHJcbiAgICB9XHJcbn07XG5cbmZ1bmN0aW9uIGlzU2hhbGxvdyh2YWx1ZSkge1xyXG4gICAgcmV0dXJuICEhKHZhbHVlICYmIHZhbHVlW1wiX192X2lzU2hhbGxvd1wiIC8qIElTX1NIQUxMT1cgKi9dKTtcclxufVxuXG5mdW5jdGlvbiBpbml0Q3VzdG9tRm9ybWF0dGVyKCkge1xyXG4gICAgLyogZXNsaW50LWRpc2FibGUgbm8tcmVzdHJpY3RlZC1nbG9iYWxzICovXHJcbiAgICBpZiAoIShwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB8fCB0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IHZ1ZVN0eWxlID0geyBzdHlsZTogJ2NvbG9yOiMzYmE3NzYnIH07XHJcbiAgICBjb25zdCBudW1iZXJTdHlsZSA9IHsgc3R5bGU6ICdjb2xvcjojMGIxYmM5JyB9O1xyXG4gICAgY29uc3Qgc3RyaW5nU3R5bGUgPSB7IHN0eWxlOiAnY29sb3I6I2I2MmUyNCcgfTtcclxuICAgIGNvbnN0IGtleXdvcmRTdHlsZSA9IHsgc3R5bGU6ICdjb2xvcjojOWQyODhjJyB9O1xyXG4gICAgLy8gY3VzdG9tIGZvcm1hdHRlciBmb3IgQ2hyb21lXHJcbiAgICAvLyBodHRwczovL3d3dy5tYXR0emV1bmVydC5jb20vMjAxNi8wMi8xOS9jdXN0b20tY2hyb21lLWRldnRvb2xzLW9iamVjdC1mb3JtYXR0ZXJzLmh0bWxcclxuICAgIGNvbnN0IGZvcm1hdHRlciA9IHtcclxuICAgICAgICBoZWFkZXIob2JqKSB7XHJcbiAgICAgICAgICAgIC8vIFRPRE8gYWxzbyBmb3JtYXQgQ29tcG9uZW50UHVibGljSW5zdGFuY2UgJiBjdHguc2xvdHMvYXR0cnMgaW4gc2V0dXBcclxuICAgICAgICAgICAgaWYgKCFpc09iamVjdChvYmopKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAob2JqLl9faXNWdWUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBbJ2RpdicsIHZ1ZVN0eWxlLCBgVnVlSW5zdGFuY2VgXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChpc1JlZihvYmopKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICAgICAgICAgICdkaXYnLFxyXG4gICAgICAgICAgICAgICAgICAgIHt9LFxyXG4gICAgICAgICAgICAgICAgICAgIFsnc3BhbicsIHZ1ZVN0eWxlLCBnZW5SZWZGbGFnKG9iaildLFxyXG4gICAgICAgICAgICAgICAgICAgICc8JyxcclxuICAgICAgICAgICAgICAgICAgICBmb3JtYXRWYWx1ZShvYmoudmFsdWUpLFxyXG4gICAgICAgICAgICAgICAgICAgIGA+YFxyXG4gICAgICAgICAgICAgICAgXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChpc1JlYWN0aXZlKG9iaikpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgICAgICAgICAgJ2RpdicsXHJcbiAgICAgICAgICAgICAgICAgICAge30sXHJcbiAgICAgICAgICAgICAgICAgICAgWydzcGFuJywgdnVlU3R5bGUsIGlzU2hhbGxvdyhvYmopID8gJ1NoYWxsb3dSZWFjdGl2ZScgOiAnUmVhY3RpdmUnXSxcclxuICAgICAgICAgICAgICAgICAgICAnPCcsXHJcbiAgICAgICAgICAgICAgICAgICAgZm9ybWF0VmFsdWUob2JqKSxcclxuICAgICAgICAgICAgICAgICAgICBgPiR7aXNSZWFkb25seShvYmopID8gYCAocmVhZG9ubHkpYCA6IGBgfWBcclxuICAgICAgICAgICAgICAgIF07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoaXNSZWFkb25seShvYmopKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICAgICAgICAgICdkaXYnLFxyXG4gICAgICAgICAgICAgICAgICAgIHt9LFxyXG4gICAgICAgICAgICAgICAgICAgIFsnc3BhbicsIHZ1ZVN0eWxlLCBpc1NoYWxsb3cob2JqKSA/ICdTaGFsbG93UmVhZG9ubHknIDogJ1JlYWRvbmx5J10sXHJcbiAgICAgICAgICAgICAgICAgICAgJzwnLFxyXG4gICAgICAgICAgICAgICAgICAgIGZvcm1hdFZhbHVlKG9iaiksXHJcbiAgICAgICAgICAgICAgICAgICAgJz4nXHJcbiAgICAgICAgICAgICAgICBdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgaGFzQm9keShvYmopIHtcclxuICAgICAgICAgICAgcmV0dXJuIG9iaiAmJiBvYmouX19pc1Z1ZTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGJvZHkob2JqKSB7XHJcbiAgICAgICAgICAgIGlmIChvYmogJiYgb2JqLl9faXNWdWUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgICAgICAgICAgJ2RpdicsXHJcbiAgICAgICAgICAgICAgICAgICAge30sXHJcbiAgICAgICAgICAgICAgICAgICAgLi4uZm9ybWF0SW5zdGFuY2Uob2JqLiQpXHJcbiAgICAgICAgICAgICAgICBdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGZ1bmN0aW9uIGZvcm1hdEluc3RhbmNlKGluc3RhbmNlKSB7XHJcbiAgICAgICAgY29uc3QgYmxvY2tzID0gW107XHJcbiAgICAgICAgaWYgKGluc3RhbmNlLnR5cGUucHJvcHMgJiYgaW5zdGFuY2UucHJvcHMpIHtcclxuICAgICAgICAgICAgYmxvY2tzLnB1c2goY3JlYXRlSW5zdGFuY2VCbG9jaygncHJvcHMnLCB0b1JhdyhpbnN0YW5jZS5wcm9wcykpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGluc3RhbmNlLnNldHVwU3RhdGUgIT09IEVNUFRZX09CSikge1xyXG4gICAgICAgICAgICBibG9ja3MucHVzaChjcmVhdGVJbnN0YW5jZUJsb2NrKCdzZXR1cCcsIGluc3RhbmNlLnNldHVwU3RhdGUpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGluc3RhbmNlLmRhdGEgIT09IEVNUFRZX09CSikge1xyXG4gICAgICAgICAgICBibG9ja3MucHVzaChjcmVhdGVJbnN0YW5jZUJsb2NrKCdkYXRhJywgdG9SYXcoaW5zdGFuY2UuZGF0YSkpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgY29tcHV0ZWQgPSBleHRyYWN0S2V5cyhpbnN0YW5jZSwgJ2NvbXB1dGVkJyk7XHJcbiAgICAgICAgaWYgKGNvbXB1dGVkKSB7XHJcbiAgICAgICAgICAgIGJsb2Nrcy5wdXNoKGNyZWF0ZUluc3RhbmNlQmxvY2soJ2NvbXB1dGVkJywgY29tcHV0ZWQpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgaW5qZWN0ZWQgPSBleHRyYWN0S2V5cyhpbnN0YW5jZSwgJ2luamVjdCcpO1xyXG4gICAgICAgIGlmIChpbmplY3RlZCkge1xyXG4gICAgICAgICAgICBibG9ja3MucHVzaChjcmVhdGVJbnN0YW5jZUJsb2NrKCdpbmplY3RlZCcsIGluamVjdGVkKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGJsb2Nrcy5wdXNoKFtcclxuICAgICAgICAgICAgJ2RpdicsXHJcbiAgICAgICAgICAgIHt9LFxyXG4gICAgICAgICAgICBbXHJcbiAgICAgICAgICAgICAgICAnc3BhbicsXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3R5bGU6IGtleXdvcmRTdHlsZS5zdHlsZSArICc7b3BhY2l0eTowLjY2J1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICckIChpbnRlcm5hbCk6ICdcclxuICAgICAgICAgICAgXSxcclxuICAgICAgICAgICAgWydvYmplY3QnLCB7IG9iamVjdDogaW5zdGFuY2UgfV1cclxuICAgICAgICBdKTtcclxuICAgICAgICByZXR1cm4gYmxvY2tzO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gY3JlYXRlSW5zdGFuY2VCbG9jayh0eXBlLCB0YXJnZXQpIHtcclxuICAgICAgICB0YXJnZXQgPSBleHRlbmQoe30sIHRhcmdldCk7XHJcbiAgICAgICAgaWYgKCFPYmplY3Qua2V5cyh0YXJnZXQpLmxlbmd0aCkge1xyXG4gICAgICAgICAgICByZXR1cm4gWydzcGFuJywge31dO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICAnZGl2JyxcclxuICAgICAgICAgICAgeyBzdHlsZTogJ2xpbmUtaGVpZ2h0OjEuMjVlbTttYXJnaW4tYm90dG9tOjAuNmVtJyB9LFxyXG4gICAgICAgICAgICBbXHJcbiAgICAgICAgICAgICAgICAnZGl2JyxcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBzdHlsZTogJ2NvbG9yOiM0NzY1ODInXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgdHlwZVxyXG4gICAgICAgICAgICBdLFxyXG4gICAgICAgICAgICBbXHJcbiAgICAgICAgICAgICAgICAnZGl2JyxcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBzdHlsZTogJ3BhZGRpbmctbGVmdDoxLjI1ZW0nXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgLi4uT2JqZWN0LmtleXModGFyZ2V0KS5tYXAoa2V5ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnZGl2JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAge30sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFsnc3BhbicsIGtleXdvcmRTdHlsZSwga2V5ICsgJzogJ10sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdFZhbHVlKHRhcmdldFtrZXldLCBmYWxzZSlcclxuICAgICAgICAgICAgICAgICAgICBdO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgXVxyXG4gICAgICAgIF07XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBmb3JtYXRWYWx1ZSh2LCBhc1JhdyA9IHRydWUpIHtcclxuICAgICAgICBpZiAodHlwZW9mIHYgPT09ICdudW1iZXInKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBbJ3NwYW4nLCBudW1iZXJTdHlsZSwgdl07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHR5cGVvZiB2ID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICByZXR1cm4gWydzcGFuJywgc3RyaW5nU3R5bGUsIEpTT04uc3RyaW5naWZ5KHYpXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodHlwZW9mIHYgPT09ICdib29sZWFuJykge1xyXG4gICAgICAgICAgICByZXR1cm4gWydzcGFuJywga2V5d29yZFN0eWxlLCB2XTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoaXNPYmplY3QodikpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFsnb2JqZWN0JywgeyBvYmplY3Q6IGFzUmF3ID8gdG9SYXcodikgOiB2IH1dO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIFsnc3BhbicsIHN0cmluZ1N0eWxlLCBTdHJpbmcodildO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGV4dHJhY3RLZXlzKGluc3RhbmNlLCB0eXBlKSB7XHJcbiAgICAgICAgY29uc3QgQ29tcCA9IGluc3RhbmNlLnR5cGU7XHJcbiAgICAgICAgaWYgKGlzRnVuY3Rpb24oQ29tcCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBleHRyYWN0ZWQgPSB7fTtcclxuICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBpbnN0YW5jZS5jdHgpIHtcclxuICAgICAgICAgICAgaWYgKGlzS2V5T2ZUeXBlKENvbXAsIGtleSwgdHlwZSkpIHtcclxuICAgICAgICAgICAgICAgIGV4dHJhY3RlZFtrZXldID0gaW5zdGFuY2UuY3R4W2tleV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGV4dHJhY3RlZDtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGlzS2V5T2ZUeXBlKENvbXAsIGtleSwgdHlwZSkge1xyXG4gICAgICAgIGNvbnN0IG9wdHMgPSBDb21wW3R5cGVdO1xyXG4gICAgICAgIGlmICgoaXNBcnJheShvcHRzKSAmJiBvcHRzLmluY2x1ZGVzKGtleSkpIHx8XHJcbiAgICAgICAgICAgIChpc09iamVjdChvcHRzKSAmJiBrZXkgaW4gb3B0cykpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChDb21wLmV4dGVuZHMgJiYgaXNLZXlPZlR5cGUoQ29tcC5leHRlbmRzLCBrZXksIHR5cGUpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoQ29tcC5taXhpbnMgJiYgQ29tcC5taXhpbnMuc29tZShtID0+IGlzS2V5T2ZUeXBlKG0sIGtleSwgdHlwZSkpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGdlblJlZkZsYWcodikge1xyXG4gICAgICAgIGlmIChpc1NoYWxsb3codikpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGBTaGFsbG93UmVmYDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHYuZWZmZWN0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBgQ29tcHV0ZWRSZWZgO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYFJlZmA7XHJcbiAgICB9XHJcbiAgICBpZiAod2luZG93LmRldnRvb2xzRm9ybWF0dGVycykge1xyXG4gICAgICAgIHdpbmRvdy5kZXZ0b29sc0Zvcm1hdHRlcnMucHVzaChmb3JtYXR0ZXIpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgd2luZG93LmRldnRvb2xzRm9ybWF0dGVycyA9IFtmb3JtYXR0ZXJdO1xyXG4gICAgfVxyXG59XG5cbmZ1bmN0aW9uIHdpdGhNZW1vKG1lbW8sIHJlbmRlciwgY2FjaGUsIGluZGV4KSB7XHJcbiAgICBjb25zdCBjYWNoZWQgPSBjYWNoZVtpbmRleF07XHJcbiAgICBpZiAoY2FjaGVkICYmIGlzTWVtb1NhbWUoY2FjaGVkLCBtZW1vKSkge1xyXG4gICAgICAgIHJldHVybiBjYWNoZWQ7XHJcbiAgICB9XHJcbiAgICBjb25zdCByZXQgPSByZW5kZXIoKTtcclxuICAgIC8vIHNoYWxsb3cgY2xvbmVcclxuICAgIHJldC5tZW1vID0gbWVtby5zbGljZSgpO1xyXG4gICAgcmV0dXJuIChjYWNoZVtpbmRleF0gPSByZXQpO1xyXG59XHJcbmZ1bmN0aW9uIGlzTWVtb1NhbWUoY2FjaGVkLCBtZW1vKSB7XHJcbiAgICBjb25zdCBwcmV2ID0gY2FjaGVkLm1lbW87XHJcbiAgICBpZiAocHJldi5sZW5ndGggIT0gbWVtby5sZW5ndGgpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHByZXYubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBpZiAocHJldltpXSAhPT0gbWVtb1tpXSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8gbWFrZSBzdXJlIHRvIGxldCBwYXJlbnQgYmxvY2sgdHJhY2sgaXQgd2hlbiByZXR1cm5pbmcgY2FjaGVkXHJcbiAgICBpZiAoaXNCbG9ja1RyZWVFbmFibGVkID4gMCAmJiBjdXJyZW50QmxvY2spIHtcclxuICAgICAgICBjdXJyZW50QmxvY2sucHVzaChjYWNoZWQpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRydWU7XHJcbn1cblxuLy8gQ29yZSBBUEkgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbmNvbnN0IHZlcnNpb24gPSBcIjMuMi4zMVwiO1xyXG5jb25zdCBfc3NyVXRpbHMgPSB7XHJcbiAgICBjcmVhdGVDb21wb25lbnRJbnN0YW5jZSxcclxuICAgIHNldHVwQ29tcG9uZW50LFxyXG4gICAgcmVuZGVyQ29tcG9uZW50Um9vdCxcclxuICAgIHNldEN1cnJlbnRSZW5kZXJpbmdJbnN0YW5jZSxcclxuICAgIGlzVk5vZGUsXHJcbiAgICBub3JtYWxpemVWTm9kZVxyXG59O1xyXG4vKipcclxuICogU1NSIHV0aWxzIGZvciBcXEB2dWUvc2VydmVyLXJlbmRlcmVyLiBPbmx5IGV4cG9zZWQgaW4gY2pzIGJ1aWxkcy5cclxuICogQGludGVybmFsXHJcbiAqL1xyXG5jb25zdCBzc3JVdGlscyA9IChfc3NyVXRpbHMgKTtcclxuLyoqXHJcbiAqIEBpbnRlcm5hbCBvbmx5IGV4cG9zZWQgaW4gY29tcGF0IGJ1aWxkc1xyXG4gKi9cclxuY29uc3QgcmVzb2x2ZUZpbHRlciA9IG51bGw7XHJcbi8qKlxyXG4gKiBAaW50ZXJuYWwgb25seSBleHBvc2VkIGluIGNvbXBhdCBidWlsZHMuXHJcbiAqL1xyXG5jb25zdCBjb21wYXRVdGlscyA9IChudWxsKTtcblxuZXhwb3J0IHsgQmFzZVRyYW5zaXRpb24sIENvbW1lbnQsIEZyYWdtZW50LCBLZWVwQWxpdmUsIFN0YXRpYywgU3VzcGVuc2UsIFRlbGVwb3J0LCBUZXh0LCBjYWxsV2l0aEFzeW5jRXJyb3JIYW5kbGluZywgY2FsbFdpdGhFcnJvckhhbmRsaW5nLCBjbG9uZVZOb2RlLCBjb21wYXRVdGlscywgY29tcHV0ZWQsIGNyZWF0ZUJsb2NrLCBjcmVhdGVDb21tZW50Vk5vZGUsIGNyZWF0ZUVsZW1lbnRCbG9jaywgY3JlYXRlQmFzZVZOb2RlIGFzIGNyZWF0ZUVsZW1lbnRWTm9kZSwgY3JlYXRlSHlkcmF0aW9uUmVuZGVyZXIsIGNyZWF0ZVByb3BzUmVzdFByb3h5LCBjcmVhdGVSZW5kZXJlciwgY3JlYXRlU2xvdHMsIGNyZWF0ZVN0YXRpY1ZOb2RlLCBjcmVhdGVUZXh0Vk5vZGUsIGNyZWF0ZVZOb2RlLCBkZWZpbmVBc3luY0NvbXBvbmVudCwgZGVmaW5lQ29tcG9uZW50LCBkZWZpbmVFbWl0cywgZGVmaW5lRXhwb3NlLCBkZWZpbmVQcm9wcywgZGV2dG9vbHMsIGdldEN1cnJlbnRJbnN0YW5jZSwgZ2V0VHJhbnNpdGlvblJhd0NoaWxkcmVuLCBndWFyZFJlYWN0aXZlUHJvcHMsIGgsIGhhbmRsZUVycm9yLCBpbml0Q3VzdG9tRm9ybWF0dGVyLCBpbmplY3QsIGlzTWVtb1NhbWUsIGlzUnVudGltZU9ubHksIGlzVk5vZGUsIG1lcmdlRGVmYXVsdHMsIG1lcmdlUHJvcHMsIG5leHRUaWNrLCBvbkFjdGl2YXRlZCwgb25CZWZvcmVNb3VudCwgb25CZWZvcmVVbm1vdW50LCBvbkJlZm9yZVVwZGF0ZSwgb25EZWFjdGl2YXRlZCwgb25FcnJvckNhcHR1cmVkLCBvbk1vdW50ZWQsIG9uUmVuZGVyVHJhY2tlZCwgb25SZW5kZXJUcmlnZ2VyZWQsIG9uU2VydmVyUHJlZmV0Y2gsIG9uVW5tb3VudGVkLCBvblVwZGF0ZWQsIG9wZW5CbG9jaywgcG9wU2NvcGVJZCwgcHJvdmlkZSwgcHVzaFNjb3BlSWQsIHF1ZXVlUG9zdEZsdXNoQ2IsIHJlZ2lzdGVyUnVudGltZUNvbXBpbGVyLCByZW5kZXJMaXN0LCByZW5kZXJTbG90LCByZXNvbHZlQ29tcG9uZW50LCByZXNvbHZlRGlyZWN0aXZlLCByZXNvbHZlRHluYW1pY0NvbXBvbmVudCwgcmVzb2x2ZUZpbHRlciwgcmVzb2x2ZVRyYW5zaXRpb25Ib29rcywgc2V0QmxvY2tUcmFja2luZywgc2V0RGV2dG9vbHNIb29rLCBzZXRUcmFuc2l0aW9uSG9va3MsIHNzckNvbnRleHRLZXksIHNzclV0aWxzLCB0b0hhbmRsZXJzLCB0cmFuc2Zvcm1WTm9kZUFyZ3MsIHVzZUF0dHJzLCB1c2VTU1JDb250ZXh0LCB1c2VTbG90cywgdXNlVHJhbnNpdGlvblN0YXRlLCB2ZXJzaW9uLCB3YXJuLCB3YXRjaCwgd2F0Y2hFZmZlY3QsIHdhdGNoUG9zdEVmZmVjdCwgd2F0Y2hTeW5jRWZmZWN0LCB3aXRoQXN5bmNDb250ZXh0LCB3aXRoQ3R4LCB3aXRoRGVmYXVsdHMsIHdpdGhEaXJlY3RpdmVzLCB3aXRoTWVtbywgd2l0aFNjb3BlSWQgfTtcbiIsImltcG9ydCB7IGNhbWVsaXplLCB3YXJuLCBjYWxsV2l0aEFzeW5jRXJyb3JIYW5kbGluZywgZGVmaW5lQ29tcG9uZW50LCBuZXh0VGljaywgY3JlYXRlVk5vZGUsIGdldEN1cnJlbnRJbnN0YW5jZSwgd2F0Y2hQb3N0RWZmZWN0LCBvbk1vdW50ZWQsIG9uVW5tb3VudGVkLCBGcmFnbWVudCwgU3RhdGljLCBoLCBCYXNlVHJhbnNpdGlvbiwgdXNlVHJhbnNpdGlvblN0YXRlLCBvblVwZGF0ZWQsIHRvUmF3LCBnZXRUcmFuc2l0aW9uUmF3Q2hpbGRyZW4sIHNldFRyYW5zaXRpb25Ib29rcywgcmVzb2x2ZVRyYW5zaXRpb25Ib29rcywgY3JlYXRlUmVuZGVyZXIsIGlzUnVudGltZU9ubHksIGNyZWF0ZUh5ZHJhdGlvblJlbmRlcmVyIH0gZnJvbSAnQHZ1ZS9ydW50aW1lLWNvcmUnO1xuZXhwb3J0ICogZnJvbSAnQHZ1ZS9ydW50aW1lLWNvcmUnO1xuaW1wb3J0IHsgaXNTdHJpbmcsIGlzQXJyYXksIGh5cGhlbmF0ZSwgY2FwaXRhbGl6ZSwgaXNTcGVjaWFsQm9vbGVhbkF0dHIsIGluY2x1ZGVCb29sZWFuQXR0ciwgaXNPbiwgaXNNb2RlbExpc3RlbmVyLCBpc0Z1bmN0aW9uLCB0b051bWJlciwgY2FtZWxpemUgYXMgY2FtZWxpemUkMSwgZXh0ZW5kLCBFTVBUWV9PQkosIGlzT2JqZWN0LCBpbnZva2VBcnJheUZucywgbG9vc2VJbmRleE9mLCBpc1NldCwgbG9vc2VFcXVhbCwgaXNIVE1MVGFnLCBpc1NWR1RhZyB9IGZyb20gJ0B2dWUvc2hhcmVkJztcblxuY29uc3Qgc3ZnTlMgPSAnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnO1xyXG5jb25zdCBkb2MgPSAodHlwZW9mIGRvY3VtZW50ICE9PSAndW5kZWZpbmVkJyA/IGRvY3VtZW50IDogbnVsbCk7XHJcbmNvbnN0IHRlbXBsYXRlQ29udGFpbmVyID0gZG9jICYmIGRvYy5jcmVhdGVFbGVtZW50KCd0ZW1wbGF0ZScpO1xyXG5jb25zdCBub2RlT3BzID0ge1xyXG4gICAgaW5zZXJ0OiAoY2hpbGQsIHBhcmVudCwgYW5jaG9yKSA9PiB7XHJcbiAgICAgICAgcGFyZW50Lmluc2VydEJlZm9yZShjaGlsZCwgYW5jaG9yIHx8IG51bGwpO1xyXG4gICAgfSxcclxuICAgIHJlbW92ZTogY2hpbGQgPT4ge1xyXG4gICAgICAgIGNvbnN0IHBhcmVudCA9IGNoaWxkLnBhcmVudE5vZGU7XHJcbiAgICAgICAgaWYgKHBhcmVudCkge1xyXG4gICAgICAgICAgICBwYXJlbnQucmVtb3ZlQ2hpbGQoY2hpbGQpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBjcmVhdGVFbGVtZW50OiAodGFnLCBpc1NWRywgaXMsIHByb3BzKSA9PiB7XHJcbiAgICAgICAgY29uc3QgZWwgPSBpc1NWR1xyXG4gICAgICAgICAgICA/IGRvYy5jcmVhdGVFbGVtZW50TlMoc3ZnTlMsIHRhZylcclxuICAgICAgICAgICAgOiBkb2MuY3JlYXRlRWxlbWVudCh0YWcsIGlzID8geyBpcyB9IDogdW5kZWZpbmVkKTtcclxuICAgICAgICBpZiAodGFnID09PSAnc2VsZWN0JyAmJiBwcm9wcyAmJiBwcm9wcy5tdWx0aXBsZSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIGVsLnNldEF0dHJpYnV0ZSgnbXVsdGlwbGUnLCBwcm9wcy5tdWx0aXBsZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBlbDtcclxuICAgIH0sXHJcbiAgICBjcmVhdGVUZXh0OiB0ZXh0ID0+IGRvYy5jcmVhdGVUZXh0Tm9kZSh0ZXh0KSxcclxuICAgIGNyZWF0ZUNvbW1lbnQ6IHRleHQgPT4gZG9jLmNyZWF0ZUNvbW1lbnQodGV4dCksXHJcbiAgICBzZXRUZXh0OiAobm9kZSwgdGV4dCkgPT4ge1xyXG4gICAgICAgIG5vZGUubm9kZVZhbHVlID0gdGV4dDtcclxuICAgIH0sXHJcbiAgICBzZXRFbGVtZW50VGV4dDogKGVsLCB0ZXh0KSA9PiB7XHJcbiAgICAgICAgZWwudGV4dENvbnRlbnQgPSB0ZXh0O1xyXG4gICAgfSxcclxuICAgIHBhcmVudE5vZGU6IG5vZGUgPT4gbm9kZS5wYXJlbnROb2RlLFxyXG4gICAgbmV4dFNpYmxpbmc6IG5vZGUgPT4gbm9kZS5uZXh0U2libGluZyxcclxuICAgIHF1ZXJ5U2VsZWN0b3I6IHNlbGVjdG9yID0+IGRvYy5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKSxcclxuICAgIHNldFNjb3BlSWQoZWwsIGlkKSB7XHJcbiAgICAgICAgZWwuc2V0QXR0cmlidXRlKGlkLCAnJyk7XHJcbiAgICB9LFxyXG4gICAgY2xvbmVOb2RlKGVsKSB7XHJcbiAgICAgICAgY29uc3QgY2xvbmVkID0gZWwuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgICAgIC8vICMzMDcyXHJcbiAgICAgICAgLy8gLSBpbiBgcGF0Y2hET01Qcm9wYCwgd2Ugc3RvcmUgdGhlIGFjdHVhbCB2YWx1ZSBpbiB0aGUgYGVsLl92YWx1ZWAgcHJvcGVydHkuXHJcbiAgICAgICAgLy8gLSBub3JtYWxseSwgZWxlbWVudHMgdXNpbmcgYDp2YWx1ZWAgYmluZGluZ3Mgd2lsbCBub3QgYmUgaG9pc3RlZCwgYnV0IGlmXHJcbiAgICAgICAgLy8gICB0aGUgYm91bmQgdmFsdWUgaXMgYSBjb25zdGFudCwgZS5nLiBgOnZhbHVlPVwidHJ1ZVwiYCAtIHRoZXkgZG8gZ2V0XHJcbiAgICAgICAgLy8gICBob2lzdGVkLlxyXG4gICAgICAgIC8vIC0gaW4gcHJvZHVjdGlvbiwgaG9pc3RlZCBub2RlcyBhcmUgY2xvbmVkIHdoZW4gc3Vic2VxdWVudCBpbnNlcnRzLCBidXRcclxuICAgICAgICAvLyAgIGNsb25lTm9kZSgpIGRvZXMgbm90IGNvcHkgdGhlIGN1c3RvbSBwcm9wZXJ0eSB3ZSBhdHRhY2hlZC5cclxuICAgICAgICAvLyAtIFRoaXMgbWF5IG5lZWQgdG8gYWNjb3VudCBmb3Igb3RoZXIgY3VzdG9tIERPTSBwcm9wZXJ0aWVzIHdlIGF0dGFjaCB0b1xyXG4gICAgICAgIC8vICAgZWxlbWVudHMgaW4gYWRkaXRpb24gdG8gYF92YWx1ZWAgaW4gdGhlIGZ1dHVyZS5cclxuICAgICAgICBpZiAoYF92YWx1ZWAgaW4gZWwpIHtcclxuICAgICAgICAgICAgY2xvbmVkLl92YWx1ZSA9IGVsLl92YWx1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGNsb25lZDtcclxuICAgIH0sXHJcbiAgICAvLyBfX1VOU0FGRV9fXHJcbiAgICAvLyBSZWFzb246IGlubmVySFRNTC5cclxuICAgIC8vIFN0YXRpYyBjb250ZW50IGhlcmUgY2FuIG9ubHkgY29tZSBmcm9tIGNvbXBpbGVkIHRlbXBsYXRlcy5cclxuICAgIC8vIEFzIGxvbmcgYXMgdGhlIHVzZXIgb25seSB1c2VzIHRydXN0ZWQgdGVtcGxhdGVzLCB0aGlzIGlzIHNhZmUuXHJcbiAgICBpbnNlcnRTdGF0aWNDb250ZW50KGNvbnRlbnQsIHBhcmVudCwgYW5jaG9yLCBpc1NWRywgc3RhcnQsIGVuZCkge1xyXG4gICAgICAgIC8vIDxwYXJlbnQ+IGJlZm9yZSB8IGZpcnN0IC4uLiBsYXN0IHwgYW5jaG9yIDwvcGFyZW50PlxyXG4gICAgICAgIGNvbnN0IGJlZm9yZSA9IGFuY2hvciA/IGFuY2hvci5wcmV2aW91c1NpYmxpbmcgOiBwYXJlbnQubGFzdENoaWxkO1xyXG4gICAgICAgIC8vICM1MzA4IGNhbiBvbmx5IHRha2UgY2FjaGVkIHBhdGggaWY6XHJcbiAgICAgICAgLy8gLSBoYXMgYSBzaW5nbGUgcm9vdCBub2RlXHJcbiAgICAgICAgLy8gLSBuZXh0U2libGluZyBpbmZvIGlzIHN0aWxsIGF2YWlsYWJsZVxyXG4gICAgICAgIGlmIChzdGFydCAmJiAoc3RhcnQgPT09IGVuZCB8fCBzdGFydC5uZXh0U2libGluZykpIHtcclxuICAgICAgICAgICAgLy8gY2FjaGVkXHJcbiAgICAgICAgICAgIHdoaWxlICh0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICBwYXJlbnQuaW5zZXJ0QmVmb3JlKHN0YXJ0LmNsb25lTm9kZSh0cnVlKSwgYW5jaG9yKTtcclxuICAgICAgICAgICAgICAgIGlmIChzdGFydCA9PT0gZW5kIHx8ICEoc3RhcnQgPSBzdGFydC5uZXh0U2libGluZykpXHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIGZyZXNoIGluc2VydFxyXG4gICAgICAgICAgICB0ZW1wbGF0ZUNvbnRhaW5lci5pbm5lckhUTUwgPSBpc1NWRyA/IGA8c3ZnPiR7Y29udGVudH08L3N2Zz5gIDogY29udGVudDtcclxuICAgICAgICAgICAgY29uc3QgdGVtcGxhdGUgPSB0ZW1wbGF0ZUNvbnRhaW5lci5jb250ZW50O1xyXG4gICAgICAgICAgICBpZiAoaXNTVkcpIHtcclxuICAgICAgICAgICAgICAgIC8vIHJlbW92ZSBvdXRlciBzdmcgd3JhcHBlclxyXG4gICAgICAgICAgICAgICAgY29uc3Qgd3JhcHBlciA9IHRlbXBsYXRlLmZpcnN0Q2hpbGQ7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAod3JhcHBlci5maXJzdENoaWxkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGUuYXBwZW5kQ2hpbGQod3JhcHBlci5maXJzdENoaWxkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlLnJlbW92ZUNoaWxkKHdyYXBwZXIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHBhcmVudC5pbnNlcnRCZWZvcmUodGVtcGxhdGUsIGFuY2hvcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgIC8vIGZpcnN0XHJcbiAgICAgICAgICAgIGJlZm9yZSA/IGJlZm9yZS5uZXh0U2libGluZyA6IHBhcmVudC5maXJzdENoaWxkLFxyXG4gICAgICAgICAgICAvLyBsYXN0XHJcbiAgICAgICAgICAgIGFuY2hvciA/IGFuY2hvci5wcmV2aW91c1NpYmxpbmcgOiBwYXJlbnQubGFzdENoaWxkXHJcbiAgICAgICAgXTtcclxuICAgIH1cclxufTtcblxuLy8gY29tcGlsZXIgc2hvdWxkIG5vcm1hbGl6ZSBjbGFzcyArIDpjbGFzcyBiaW5kaW5ncyBvbiB0aGUgc2FtZSBlbGVtZW50XHJcbi8vIGludG8gYSBzaW5nbGUgYmluZGluZyBbJ3N0YXRpY0NsYXNzJywgZHluYW1pY11cclxuZnVuY3Rpb24gcGF0Y2hDbGFzcyhlbCwgdmFsdWUsIGlzU1ZHKSB7XHJcbiAgICAvLyBkaXJlY3RseSBzZXR0aW5nIGNsYXNzTmFtZSBzaG91bGQgYmUgZmFzdGVyIHRoYW4gc2V0QXR0cmlidXRlIGluIHRoZW9yeVxyXG4gICAgLy8gaWYgdGhpcyBpcyBhbiBlbGVtZW50IGR1cmluZyBhIHRyYW5zaXRpb24sIHRha2UgdGhlIHRlbXBvcmFyeSB0cmFuc2l0aW9uXHJcbiAgICAvLyBjbGFzc2VzIGludG8gYWNjb3VudC5cclxuICAgIGNvbnN0IHRyYW5zaXRpb25DbGFzc2VzID0gZWwuX3Z0YztcclxuICAgIGlmICh0cmFuc2l0aW9uQ2xhc3Nlcykge1xyXG4gICAgICAgIHZhbHVlID0gKHZhbHVlID8gW3ZhbHVlLCAuLi50cmFuc2l0aW9uQ2xhc3Nlc10gOiBbLi4udHJhbnNpdGlvbkNsYXNzZXNdKS5qb2luKCcgJyk7XHJcbiAgICB9XHJcbiAgICBpZiAodmFsdWUgPT0gbnVsbCkge1xyXG4gICAgICAgIGVsLnJlbW92ZUF0dHJpYnV0ZSgnY2xhc3MnKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGlzU1ZHKSB7XHJcbiAgICAgICAgZWwuc2V0QXR0cmlidXRlKCdjbGFzcycsIHZhbHVlKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIGVsLmNsYXNzTmFtZSA9IHZhbHVlO1xyXG4gICAgfVxyXG59XG5cbmZ1bmN0aW9uIHBhdGNoU3R5bGUoZWwsIHByZXYsIG5leHQpIHtcclxuICAgIGNvbnN0IHN0eWxlID0gZWwuc3R5bGU7XHJcbiAgICBjb25zdCBpc0Nzc1N0cmluZyA9IGlzU3RyaW5nKG5leHQpO1xyXG4gICAgaWYgKG5leHQgJiYgIWlzQ3NzU3RyaW5nKSB7XHJcbiAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gbmV4dCkge1xyXG4gICAgICAgICAgICBzZXRTdHlsZShzdHlsZSwga2V5LCBuZXh0W2tleV0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocHJldiAmJiAhaXNTdHJpbmcocHJldikpIHtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gcHJldikge1xyXG4gICAgICAgICAgICAgICAgaWYgKG5leHRba2V5XSA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0U3R5bGUoc3R5bGUsIGtleSwgJycpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgY29uc3QgY3VycmVudERpc3BsYXkgPSBzdHlsZS5kaXNwbGF5O1xyXG4gICAgICAgIGlmIChpc0Nzc1N0cmluZykge1xyXG4gICAgICAgICAgICBpZiAocHJldiAhPT0gbmV4dCkge1xyXG4gICAgICAgICAgICAgICAgc3R5bGUuY3NzVGV4dCA9IG5leHQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAocHJldikge1xyXG4gICAgICAgICAgICBlbC5yZW1vdmVBdHRyaWJ1dGUoJ3N0eWxlJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGluZGljYXRlcyB0aGF0IHRoZSBgZGlzcGxheWAgb2YgdGhlIGVsZW1lbnQgaXMgY29udHJvbGxlZCBieSBgdi1zaG93YCxcclxuICAgICAgICAvLyBzbyB3ZSBhbHdheXMga2VlcCB0aGUgY3VycmVudCBgZGlzcGxheWAgdmFsdWUgcmVnYXJkbGVzcyBvZiB0aGUgYHN0eWxlYFxyXG4gICAgICAgIC8vIHZhbHVlLCB0aHVzIGhhbmRpbmcgb3ZlciBjb250cm9sIHRvIGB2LXNob3dgLlxyXG4gICAgICAgIGlmICgnX3ZvZCcgaW4gZWwpIHtcclxuICAgICAgICAgICAgc3R5bGUuZGlzcGxheSA9IGN1cnJlbnREaXNwbGF5O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5jb25zdCBpbXBvcnRhbnRSRSA9IC9cXHMqIWltcG9ydGFudCQvO1xyXG5mdW5jdGlvbiBzZXRTdHlsZShzdHlsZSwgbmFtZSwgdmFsKSB7XHJcbiAgICBpZiAoaXNBcnJheSh2YWwpKSB7XHJcbiAgICAgICAgdmFsLmZvckVhY2godiA9PiBzZXRTdHlsZShzdHlsZSwgbmFtZSwgdikpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgaWYgKG5hbWUuc3RhcnRzV2l0aCgnLS0nKSkge1xyXG4gICAgICAgICAgICAvLyBjdXN0b20gcHJvcGVydHkgZGVmaW5pdGlvblxyXG4gICAgICAgICAgICBzdHlsZS5zZXRQcm9wZXJ0eShuYW1lLCB2YWwpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgY29uc3QgcHJlZml4ZWQgPSBhdXRvUHJlZml4KHN0eWxlLCBuYW1lKTtcclxuICAgICAgICAgICAgaWYgKGltcG9ydGFudFJFLnRlc3QodmFsKSkge1xyXG4gICAgICAgICAgICAgICAgLy8gIWltcG9ydGFudFxyXG4gICAgICAgICAgICAgICAgc3R5bGUuc2V0UHJvcGVydHkoaHlwaGVuYXRlKHByZWZpeGVkKSwgdmFsLnJlcGxhY2UoaW1wb3J0YW50UkUsICcnKSwgJ2ltcG9ydGFudCcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgc3R5bGVbcHJlZml4ZWRdID0gdmFsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbmNvbnN0IHByZWZpeGVzID0gWydXZWJraXQnLCAnTW96JywgJ21zJ107XHJcbmNvbnN0IHByZWZpeENhY2hlID0ge307XHJcbmZ1bmN0aW9uIGF1dG9QcmVmaXgoc3R5bGUsIHJhd05hbWUpIHtcclxuICAgIGNvbnN0IGNhY2hlZCA9IHByZWZpeENhY2hlW3Jhd05hbWVdO1xyXG4gICAgaWYgKGNhY2hlZCkge1xyXG4gICAgICAgIHJldHVybiBjYWNoZWQ7XHJcbiAgICB9XHJcbiAgICBsZXQgbmFtZSA9IGNhbWVsaXplKHJhd05hbWUpO1xyXG4gICAgaWYgKG5hbWUgIT09ICdmaWx0ZXInICYmIG5hbWUgaW4gc3R5bGUpIHtcclxuICAgICAgICByZXR1cm4gKHByZWZpeENhY2hlW3Jhd05hbWVdID0gbmFtZSk7XHJcbiAgICB9XHJcbiAgICBuYW1lID0gY2FwaXRhbGl6ZShuYW1lKTtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcHJlZml4ZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBjb25zdCBwcmVmaXhlZCA9IHByZWZpeGVzW2ldICsgbmFtZTtcclxuICAgICAgICBpZiAocHJlZml4ZWQgaW4gc3R5bGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIChwcmVmaXhDYWNoZVtyYXdOYW1lXSA9IHByZWZpeGVkKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmF3TmFtZTtcclxufVxuXG5jb25zdCB4bGlua05TID0gJ2h0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsnO1xyXG5mdW5jdGlvbiBwYXRjaEF0dHIoZWwsIGtleSwgdmFsdWUsIGlzU1ZHLCBpbnN0YW5jZSkge1xyXG4gICAgaWYgKGlzU1ZHICYmIGtleS5zdGFydHNXaXRoKCd4bGluazonKSkge1xyXG4gICAgICAgIGlmICh2YWx1ZSA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIGVsLnJlbW92ZUF0dHJpYnV0ZU5TKHhsaW5rTlMsIGtleS5zbGljZSg2LCBrZXkubGVuZ3RoKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBlbC5zZXRBdHRyaWJ1dGVOUyh4bGlua05TLCBrZXksIHZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICAvLyBub3RlIHdlIGFyZSBvbmx5IGNoZWNraW5nIGJvb2xlYW4gYXR0cmlidXRlcyB0aGF0IGRvbid0IGhhdmUgYVxyXG4gICAgICAgIC8vIGNvcnJlc3BvbmRpbmcgZG9tIHByb3Agb2YgdGhlIHNhbWUgbmFtZSBoZXJlLlxyXG4gICAgICAgIGNvbnN0IGlzQm9vbGVhbiA9IGlzU3BlY2lhbEJvb2xlYW5BdHRyKGtleSk7XHJcbiAgICAgICAgaWYgKHZhbHVlID09IG51bGwgfHwgKGlzQm9vbGVhbiAmJiAhaW5jbHVkZUJvb2xlYW5BdHRyKHZhbHVlKSkpIHtcclxuICAgICAgICAgICAgZWwucmVtb3ZlQXR0cmlidXRlKGtleSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBlbC5zZXRBdHRyaWJ1dGUoa2V5LCBpc0Jvb2xlYW4gPyAnJyA6IHZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cblxuLy8gX19VTlNBRkVfX1xyXG4vLyBmdW5jdGlvbnMuIFRoZSB1c2VyIGlzIHJlc3BvbnNpYmxlIGZvciB1c2luZyB0aGVtIHdpdGggb25seSB0cnVzdGVkIGNvbnRlbnQuXHJcbmZ1bmN0aW9uIHBhdGNoRE9NUHJvcChlbCwga2V5LCB2YWx1ZSwgXHJcbi8vIHRoZSBmb2xsb3dpbmcgYXJncyBhcmUgcGFzc2VkIG9ubHkgZHVlIHRvIHBvdGVudGlhbCBpbm5lckhUTUwvdGV4dENvbnRlbnRcclxuLy8gb3ZlcnJpZGluZyBleGlzdGluZyBWTm9kZXMsIGluIHdoaWNoIGNhc2UgdGhlIG9sZCB0cmVlIG11c3QgYmUgcHJvcGVybHlcclxuLy8gdW5tb3VudGVkLlxyXG5wcmV2Q2hpbGRyZW4sIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIHVubW91bnRDaGlsZHJlbikge1xyXG4gICAgaWYgKGtleSA9PT0gJ2lubmVySFRNTCcgfHwga2V5ID09PSAndGV4dENvbnRlbnQnKSB7XHJcbiAgICAgICAgaWYgKHByZXZDaGlsZHJlbikge1xyXG4gICAgICAgICAgICB1bm1vdW50Q2hpbGRyZW4ocHJldkNoaWxkcmVuLCBwYXJlbnRDb21wb25lbnQsIHBhcmVudFN1c3BlbnNlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxba2V5XSA9IHZhbHVlID09IG51bGwgPyAnJyA6IHZhbHVlO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGlmIChrZXkgPT09ICd2YWx1ZScgJiZcclxuICAgICAgICBlbC50YWdOYW1lICE9PSAnUFJPR1JFU1MnICYmXHJcbiAgICAgICAgLy8gY3VzdG9tIGVsZW1lbnRzIG1heSB1c2UgX3ZhbHVlIGludGVybmFsbHlcclxuICAgICAgICAhZWwudGFnTmFtZS5pbmNsdWRlcygnLScpKSB7XHJcbiAgICAgICAgLy8gc3RvcmUgdmFsdWUgYXMgX3ZhbHVlIGFzIHdlbGwgc2luY2VcclxuICAgICAgICAvLyBub24tc3RyaW5nIHZhbHVlcyB3aWxsIGJlIHN0cmluZ2lmaWVkLlxyXG4gICAgICAgIGVsLl92YWx1ZSA9IHZhbHVlO1xyXG4gICAgICAgIGNvbnN0IG5ld1ZhbHVlID0gdmFsdWUgPT0gbnVsbCA/ICcnIDogdmFsdWU7XHJcbiAgICAgICAgaWYgKGVsLnZhbHVlICE9PSBuZXdWYWx1ZSB8fFxyXG4gICAgICAgICAgICAvLyAjNDk1NjogYWx3YXlzIHNldCBmb3IgT1BUSU9OIGVsZW1lbnRzIGJlY2F1c2UgaXRzIHZhbHVlIGZhbGxzIGJhY2sgdG9cclxuICAgICAgICAgICAgLy8gdGV4dENvbnRlbnQgaWYgbm8gdmFsdWUgYXR0cmlidXRlIGlzIHByZXNlbnQuIEFuZCBzZXR0aW5nIC52YWx1ZSBmb3JcclxuICAgICAgICAgICAgLy8gT1BUSU9OIGhhcyBubyBzaWRlIGVmZmVjdFxyXG4gICAgICAgICAgICBlbC50YWdOYW1lID09PSAnT1BUSU9OJykge1xyXG4gICAgICAgICAgICBlbC52YWx1ZSA9IG5ld1ZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodmFsdWUgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBlbC5yZW1vdmVBdHRyaWJ1dGUoa2V5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgaWYgKHZhbHVlID09PSAnJyB8fCB2YWx1ZSA9PSBudWxsKSB7XHJcbiAgICAgICAgY29uc3QgdHlwZSA9IHR5cGVvZiBlbFtrZXldO1xyXG4gICAgICAgIGlmICh0eXBlID09PSAnYm9vbGVhbicpIHtcclxuICAgICAgICAgICAgLy8gZS5nLiA8c2VsZWN0IG11bHRpcGxlPiBjb21waWxlcyB0byB7IG11bHRpcGxlOiAnJyB9XHJcbiAgICAgICAgICAgIGVsW2tleV0gPSBpbmNsdWRlQm9vbGVhbkF0dHIodmFsdWUpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHZhbHVlID09IG51bGwgJiYgdHlwZSA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgLy8gZS5nLiA8ZGl2IDppZD1cIm51bGxcIj5cclxuICAgICAgICAgICAgZWxba2V5XSA9ICcnO1xyXG4gICAgICAgICAgICBlbC5yZW1vdmVBdHRyaWJ1dGUoa2V5KTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh0eXBlID09PSAnbnVtYmVyJykge1xyXG4gICAgICAgICAgICAvLyBlLmcuIDxpbWcgOndpZHRoPVwibnVsbFwiPlxyXG4gICAgICAgICAgICAvLyB0aGUgdmFsdWUgb2Ygc29tZSBJREwgYXR0ciBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAwLCBlLmcuIGlucHV0LnNpemUgPSAwIC0+IGVycm9yXHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBlbFtrZXldID0gMDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXRjaCAoX2EpIHsgfVxyXG4gICAgICAgICAgICBlbC5yZW1vdmVBdHRyaWJ1dGUoa2V5KTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8vIHNvbWUgcHJvcGVydGllcyBwZXJmb3JtIHZhbHVlIHZhbGlkYXRpb24gYW5kIHRocm93XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGVsW2tleV0gPSB2YWx1ZTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgICAgICB3YXJuKGBGYWlsZWQgc2V0dGluZyBwcm9wIFwiJHtrZXl9XCIgb24gPCR7ZWwudGFnTmFtZS50b0xvd2VyQ2FzZSgpfT46IGAgK1xyXG4gICAgICAgICAgICAgICAgYHZhbHVlICR7dmFsdWV9IGlzIGludmFsaWQuYCwgZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XG5cbi8vIEFzeW5jIGVkZ2UgY2FzZSBmaXggcmVxdWlyZXMgc3RvcmluZyBhbiBldmVudCBsaXN0ZW5lcidzIGF0dGFjaCB0aW1lc3RhbXAuXHJcbmxldCBfZ2V0Tm93ID0gRGF0ZS5ub3c7XHJcbmxldCBza2lwVGltZXN0YW1wQ2hlY2sgPSBmYWxzZTtcclxuaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAvLyBEZXRlcm1pbmUgd2hhdCBldmVudCB0aW1lc3RhbXAgdGhlIGJyb3dzZXIgaXMgdXNpbmcuIEFubm95aW5nbHksIHRoZVxyXG4gICAgLy8gdGltZXN0YW1wIGNhbiBlaXRoZXIgYmUgaGktcmVzIChyZWxhdGl2ZSB0byBwYWdlIGxvYWQpIG9yIGxvdy1yZXNcclxuICAgIC8vIChyZWxhdGl2ZSB0byBVTklYIGVwb2NoKSwgc28gaW4gb3JkZXIgdG8gY29tcGFyZSB0aW1lIHdlIGhhdmUgdG8gdXNlIHRoZVxyXG4gICAgLy8gc2FtZSB0aW1lc3RhbXAgdHlwZSB3aGVuIHNhdmluZyB0aGUgZmx1c2ggdGltZXN0YW1wLlxyXG4gICAgaWYgKF9nZXROb3coKSA+IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdFdmVudCcpLnRpbWVTdGFtcCkge1xyXG4gICAgICAgIC8vIGlmIHRoZSBsb3ctcmVzIHRpbWVzdGFtcCB3aGljaCBpcyBiaWdnZXIgdGhhbiB0aGUgZXZlbnQgdGltZXN0YW1wXHJcbiAgICAgICAgLy8gKHdoaWNoIGlzIGV2YWx1YXRlZCBBRlRFUikgaXQgbWVhbnMgdGhlIGV2ZW50IGlzIHVzaW5nIGEgaGktcmVzIHRpbWVzdGFtcCxcclxuICAgICAgICAvLyBhbmQgd2UgbmVlZCB0byB1c2UgdGhlIGhpLXJlcyB2ZXJzaW9uIGZvciBldmVudCBsaXN0ZW5lcnMgYXMgd2VsbC5cclxuICAgICAgICBfZ2V0Tm93ID0gKCkgPT4gcGVyZm9ybWFuY2Uubm93KCk7XHJcbiAgICB9XHJcbiAgICAvLyAjMzQ4NTogRmlyZWZveCA8PSA1MyBoYXMgaW5jb3JyZWN0IEV2ZW50LnRpbWVTdGFtcCBpbXBsZW1lbnRhdGlvblxyXG4gICAgLy8gYW5kIGRvZXMgbm90IGZpcmUgbWljcm90YXNrcyBpbiBiZXR3ZWVuIGV2ZW50IHByb3BhZ2F0aW9uLCBzbyBzYWZlIHRvIGV4Y2x1ZGUuXHJcbiAgICBjb25zdCBmZk1hdGNoID0gbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvZmlyZWZveFxcLyhcXGQrKS9pKTtcclxuICAgIHNraXBUaW1lc3RhbXBDaGVjayA9ICEhKGZmTWF0Y2ggJiYgTnVtYmVyKGZmTWF0Y2hbMV0pIDw9IDUzKTtcclxufVxyXG4vLyBUbyBhdm9pZCB0aGUgb3ZlcmhlYWQgb2YgcmVwZWF0ZWRseSBjYWxsaW5nIHBlcmZvcm1hbmNlLm5vdygpLCB3ZSBjYWNoZVxyXG4vLyBhbmQgdXNlIHRoZSBzYW1lIHRpbWVzdGFtcCBmb3IgYWxsIGV2ZW50IGxpc3RlbmVycyBhdHRhY2hlZCBpbiB0aGUgc2FtZSB0aWNrLlxyXG5sZXQgY2FjaGVkTm93ID0gMDtcclxuY29uc3QgcCA9IFByb21pc2UucmVzb2x2ZSgpO1xyXG5jb25zdCByZXNldCA9ICgpID0+IHtcclxuICAgIGNhY2hlZE5vdyA9IDA7XHJcbn07XHJcbmNvbnN0IGdldE5vdyA9ICgpID0+IGNhY2hlZE5vdyB8fCAocC50aGVuKHJlc2V0KSwgKGNhY2hlZE5vdyA9IF9nZXROb3coKSkpO1xyXG5mdW5jdGlvbiBhZGRFdmVudExpc3RlbmVyKGVsLCBldmVudCwgaGFuZGxlciwgb3B0aW9ucykge1xyXG4gICAgZWwuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgaGFuZGxlciwgb3B0aW9ucyk7XHJcbn1cclxuZnVuY3Rpb24gcmVtb3ZlRXZlbnRMaXN0ZW5lcihlbCwgZXZlbnQsIGhhbmRsZXIsIG9wdGlvbnMpIHtcclxuICAgIGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnQsIGhhbmRsZXIsIG9wdGlvbnMpO1xyXG59XHJcbmZ1bmN0aW9uIHBhdGNoRXZlbnQoZWwsIHJhd05hbWUsIHByZXZWYWx1ZSwgbmV4dFZhbHVlLCBpbnN0YW5jZSA9IG51bGwpIHtcclxuICAgIC8vIHZlaSA9IHZ1ZSBldmVudCBpbnZva2Vyc1xyXG4gICAgY29uc3QgaW52b2tlcnMgPSBlbC5fdmVpIHx8IChlbC5fdmVpID0ge30pO1xyXG4gICAgY29uc3QgZXhpc3RpbmdJbnZva2VyID0gaW52b2tlcnNbcmF3TmFtZV07XHJcbiAgICBpZiAobmV4dFZhbHVlICYmIGV4aXN0aW5nSW52b2tlcikge1xyXG4gICAgICAgIC8vIHBhdGNoXHJcbiAgICAgICAgZXhpc3RpbmdJbnZva2VyLnZhbHVlID0gbmV4dFZhbHVlO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgY29uc3QgW25hbWUsIG9wdGlvbnNdID0gcGFyc2VOYW1lKHJhd05hbWUpO1xyXG4gICAgICAgIGlmIChuZXh0VmFsdWUpIHtcclxuICAgICAgICAgICAgLy8gYWRkXHJcbiAgICAgICAgICAgIGNvbnN0IGludm9rZXIgPSAoaW52b2tlcnNbcmF3TmFtZV0gPSBjcmVhdGVJbnZva2VyKG5leHRWYWx1ZSwgaW5zdGFuY2UpKTtcclxuICAgICAgICAgICAgYWRkRXZlbnRMaXN0ZW5lcihlbCwgbmFtZSwgaW52b2tlciwgb3B0aW9ucyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGV4aXN0aW5nSW52b2tlcikge1xyXG4gICAgICAgICAgICAvLyByZW1vdmVcclxuICAgICAgICAgICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcihlbCwgbmFtZSwgZXhpc3RpbmdJbnZva2VyLCBvcHRpb25zKTtcclxuICAgICAgICAgICAgaW52b2tlcnNbcmF3TmFtZV0gPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbmNvbnN0IG9wdGlvbnNNb2RpZmllclJFID0gLyg/Ok9uY2V8UGFzc2l2ZXxDYXB0dXJlKSQvO1xyXG5mdW5jdGlvbiBwYXJzZU5hbWUobmFtZSkge1xyXG4gICAgbGV0IG9wdGlvbnM7XHJcbiAgICBpZiAob3B0aW9uc01vZGlmaWVyUkUudGVzdChuYW1lKSkge1xyXG4gICAgICAgIG9wdGlvbnMgPSB7fTtcclxuICAgICAgICBsZXQgbTtcclxuICAgICAgICB3aGlsZSAoKG0gPSBuYW1lLm1hdGNoKG9wdGlvbnNNb2RpZmllclJFKSkpIHtcclxuICAgICAgICAgICAgbmFtZSA9IG5hbWUuc2xpY2UoMCwgbmFtZS5sZW5ndGggLSBtWzBdLmxlbmd0aCk7XHJcbiAgICAgICAgICAgIG9wdGlvbnNbbVswXS50b0xvd2VyQ2FzZSgpXSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIFtoeXBoZW5hdGUobmFtZS5zbGljZSgyKSksIG9wdGlvbnNdO1xyXG59XHJcbmZ1bmN0aW9uIGNyZWF0ZUludm9rZXIoaW5pdGlhbFZhbHVlLCBpbnN0YW5jZSkge1xyXG4gICAgY29uc3QgaW52b2tlciA9IChlKSA9PiB7XHJcbiAgICAgICAgLy8gYXN5bmMgZWRnZSBjYXNlICM2NTY2OiBpbm5lciBjbGljayBldmVudCB0cmlnZ2VycyBwYXRjaCwgZXZlbnQgaGFuZGxlclxyXG4gICAgICAgIC8vIGF0dGFjaGVkIHRvIG91dGVyIGVsZW1lbnQgZHVyaW5nIHBhdGNoLCBhbmQgdHJpZ2dlcmVkIGFnYWluLiBUaGlzXHJcbiAgICAgICAgLy8gaGFwcGVucyBiZWNhdXNlIGJyb3dzZXJzIGZpcmUgbWljcm90YXNrIHRpY2tzIGJldHdlZW4gZXZlbnQgcHJvcGFnYXRpb24uXHJcbiAgICAgICAgLy8gdGhlIHNvbHV0aW9uIGlzIHNpbXBsZTogd2Ugc2F2ZSB0aGUgdGltZXN0YW1wIHdoZW4gYSBoYW5kbGVyIGlzIGF0dGFjaGVkLFxyXG4gICAgICAgIC8vIGFuZCB0aGUgaGFuZGxlciB3b3VsZCBvbmx5IGZpcmUgaWYgdGhlIGV2ZW50IHBhc3NlZCB0byBpdCB3YXMgZmlyZWRcclxuICAgICAgICAvLyBBRlRFUiBpdCB3YXMgYXR0YWNoZWQuXHJcbiAgICAgICAgY29uc3QgdGltZVN0YW1wID0gZS50aW1lU3RhbXAgfHwgX2dldE5vdygpO1xyXG4gICAgICAgIGlmIChza2lwVGltZXN0YW1wQ2hlY2sgfHwgdGltZVN0YW1wID49IGludm9rZXIuYXR0YWNoZWQgLSAxKSB7XHJcbiAgICAgICAgICAgIGNhbGxXaXRoQXN5bmNFcnJvckhhbmRsaW5nKHBhdGNoU3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKGUsIGludm9rZXIudmFsdWUpLCBpbnN0YW5jZSwgNSAvKiBOQVRJVkVfRVZFTlRfSEFORExFUiAqLywgW2VdKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgaW52b2tlci52YWx1ZSA9IGluaXRpYWxWYWx1ZTtcclxuICAgIGludm9rZXIuYXR0YWNoZWQgPSBnZXROb3coKTtcclxuICAgIHJldHVybiBpbnZva2VyO1xyXG59XHJcbmZ1bmN0aW9uIHBhdGNoU3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKGUsIHZhbHVlKSB7XHJcbiAgICBpZiAoaXNBcnJheSh2YWx1ZSkpIHtcclxuICAgICAgICBjb25zdCBvcmlnaW5hbFN0b3AgPSBlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbjtcclxuICAgICAgICBlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbiA9ICgpID0+IHtcclxuICAgICAgICAgICAgb3JpZ2luYWxTdG9wLmNhbGwoZSk7XHJcbiAgICAgICAgICAgIGUuX3N0b3BwZWQgPSB0cnVlO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIHZhbHVlLm1hcChmbiA9PiAoZSkgPT4gIWUuX3N0b3BwZWQgJiYgZm4gJiYgZm4oZSkpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgfVxyXG59XG5cbmNvbnN0IG5hdGl2ZU9uUkUgPSAvXm9uW2Etel0vO1xyXG5jb25zdCBwYXRjaFByb3AgPSAoZWwsIGtleSwgcHJldlZhbHVlLCBuZXh0VmFsdWUsIGlzU1ZHID0gZmFsc2UsIHByZXZDaGlsZHJlbiwgcGFyZW50Q29tcG9uZW50LCBwYXJlbnRTdXNwZW5zZSwgdW5tb3VudENoaWxkcmVuKSA9PiB7XHJcbiAgICBpZiAoa2V5ID09PSAnY2xhc3MnKSB7XHJcbiAgICAgICAgcGF0Y2hDbGFzcyhlbCwgbmV4dFZhbHVlLCBpc1NWRyk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChrZXkgPT09ICdzdHlsZScpIHtcclxuICAgICAgICBwYXRjaFN0eWxlKGVsLCBwcmV2VmFsdWUsIG5leHRWYWx1ZSk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChpc09uKGtleSkpIHtcclxuICAgICAgICAvLyBpZ25vcmUgdi1tb2RlbCBsaXN0ZW5lcnNcclxuICAgICAgICBpZiAoIWlzTW9kZWxMaXN0ZW5lcihrZXkpKSB7XHJcbiAgICAgICAgICAgIHBhdGNoRXZlbnQoZWwsIGtleSwgcHJldlZhbHVlLCBuZXh0VmFsdWUsIHBhcmVudENvbXBvbmVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoa2V5WzBdID09PSAnLidcclxuICAgICAgICA/ICgoa2V5ID0ga2V5LnNsaWNlKDEpKSwgdHJ1ZSlcclxuICAgICAgICA6IGtleVswXSA9PT0gJ14nXHJcbiAgICAgICAgICAgID8gKChrZXkgPSBrZXkuc2xpY2UoMSkpLCBmYWxzZSlcclxuICAgICAgICAgICAgOiBzaG91bGRTZXRBc1Byb3AoZWwsIGtleSwgbmV4dFZhbHVlLCBpc1NWRykpIHtcclxuICAgICAgICBwYXRjaERPTVByb3AoZWwsIGtleSwgbmV4dFZhbHVlLCBwcmV2Q2hpbGRyZW4sIHBhcmVudENvbXBvbmVudCwgcGFyZW50U3VzcGVuc2UsIHVubW91bnRDaGlsZHJlbik7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICAvLyBzcGVjaWFsIGNhc2UgZm9yIDxpbnB1dCB2LW1vZGVsIHR5cGU9XCJjaGVja2JveFwiPiB3aXRoXHJcbiAgICAgICAgLy8gOnRydWUtdmFsdWUgJiA6ZmFsc2UtdmFsdWVcclxuICAgICAgICAvLyBzdG9yZSB2YWx1ZSBhcyBkb20gcHJvcGVydGllcyBzaW5jZSBub24tc3RyaW5nIHZhbHVlcyB3aWxsIGJlXHJcbiAgICAgICAgLy8gc3RyaW5naWZpZWQuXHJcbiAgICAgICAgaWYgKGtleSA9PT0gJ3RydWUtdmFsdWUnKSB7XHJcbiAgICAgICAgICAgIGVsLl90cnVlVmFsdWUgPSBuZXh0VmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGtleSA9PT0gJ2ZhbHNlLXZhbHVlJykge1xyXG4gICAgICAgICAgICBlbC5fZmFsc2VWYWx1ZSA9IG5leHRWYWx1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcGF0Y2hBdHRyKGVsLCBrZXksIG5leHRWYWx1ZSwgaXNTVkcpO1xyXG4gICAgfVxyXG59O1xyXG5mdW5jdGlvbiBzaG91bGRTZXRBc1Byb3AoZWwsIGtleSwgdmFsdWUsIGlzU1ZHKSB7XHJcbiAgICBpZiAoaXNTVkcpIHtcclxuICAgICAgICAvLyBtb3N0IGtleXMgbXVzdCBiZSBzZXQgYXMgYXR0cmlidXRlIG9uIHN2ZyBlbGVtZW50cyB0byB3b3JrXHJcbiAgICAgICAgLy8gLi4uZXhjZXB0IGlubmVySFRNTCAmIHRleHRDb250ZW50XHJcbiAgICAgICAgaWYgKGtleSA9PT0gJ2lubmVySFRNTCcgfHwga2V5ID09PSAndGV4dENvbnRlbnQnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBvciBuYXRpdmUgb25jbGljayB3aXRoIGZ1bmN0aW9uIHZhbHVlc1xyXG4gICAgICAgIGlmIChrZXkgaW4gZWwgJiYgbmF0aXZlT25SRS50ZXN0KGtleSkgJiYgaXNGdW5jdGlvbih2YWx1ZSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIC8vIHNwZWxsY2hlY2sgYW5kIGRyYWdnYWJsZSBhcmUgbnVtZXJhdGVkIGF0dHJzLCBob3dldmVyIHRoZWlyXHJcbiAgICAvLyBjb3JyZXNwb25kaW5nIERPTSBwcm9wZXJ0aWVzIGFyZSBhY3R1YWxseSBib29sZWFucyAtIHRoaXMgbGVhZHMgdG9cclxuICAgIC8vIHNldHRpbmcgaXQgd2l0aCBhIHN0cmluZyBcImZhbHNlXCIgdmFsdWUgbGVhZGluZyBpdCB0byBiZSBjb2VyY2VkIHRvXHJcbiAgICAvLyBgdHJ1ZWAsIHNvIHdlIG5lZWQgdG8gYWx3YXlzIHRyZWF0IHRoZW0gYXMgYXR0cmlidXRlcy5cclxuICAgIC8vIE5vdGUgdGhhdCBgY29udGVudEVkaXRhYmxlYCBkb2Vzbid0IGhhdmUgdGhpcyBwcm9ibGVtOiBpdHMgRE9NXHJcbiAgICAvLyBwcm9wZXJ0eSBpcyBhbHNvIGVudW1lcmF0ZWQgc3RyaW5nIHZhbHVlcy5cclxuICAgIGlmIChrZXkgPT09ICdzcGVsbGNoZWNrJyB8fCBrZXkgPT09ICdkcmFnZ2FibGUnKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgLy8gIzE3ODcsICMyODQwIGZvcm0gcHJvcGVydHkgb24gZm9ybSBlbGVtZW50cyBpcyByZWFkb25seSBhbmQgbXVzdCBiZSBzZXQgYXNcclxuICAgIC8vIGF0dHJpYnV0ZS5cclxuICAgIGlmIChrZXkgPT09ICdmb3JtJykge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIC8vICMxNTI2IDxpbnB1dCBsaXN0PiBtdXN0IGJlIHNldCBhcyBhdHRyaWJ1dGVcclxuICAgIGlmIChrZXkgPT09ICdsaXN0JyAmJiBlbC50YWdOYW1lID09PSAnSU5QVVQnKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgLy8gIzI3NjYgPHRleHRhcmVhIHR5cGU+IG11c3QgYmUgc2V0IGFzIGF0dHJpYnV0ZVxyXG4gICAgaWYgKGtleSA9PT0gJ3R5cGUnICYmIGVsLnRhZ05hbWUgPT09ICdURVhUQVJFQScpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICAvLyBuYXRpdmUgb25jbGljayB3aXRoIHN0cmluZyB2YWx1ZSwgbXVzdCBiZSBzZXQgYXMgYXR0cmlidXRlXHJcbiAgICBpZiAobmF0aXZlT25SRS50ZXN0KGtleSkgJiYgaXNTdHJpbmcodmFsdWUpKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGtleSBpbiBlbDtcclxufVxuXG5mdW5jdGlvbiBkZWZpbmVDdXN0b21FbGVtZW50KG9wdGlvbnMsIGh5ZGF0ZSkge1xyXG4gICAgY29uc3QgQ29tcCA9IGRlZmluZUNvbXBvbmVudChvcHRpb25zKTtcclxuICAgIGNsYXNzIFZ1ZUN1c3RvbUVsZW1lbnQgZXh0ZW5kcyBWdWVFbGVtZW50IHtcclxuICAgICAgICBjb25zdHJ1Y3Rvcihpbml0aWFsUHJvcHMpIHtcclxuICAgICAgICAgICAgc3VwZXIoQ29tcCwgaW5pdGlhbFByb3BzLCBoeWRhdGUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFZ1ZUN1c3RvbUVsZW1lbnQuZGVmID0gQ29tcDtcclxuICAgIHJldHVybiBWdWVDdXN0b21FbGVtZW50O1xyXG59XHJcbmNvbnN0IGRlZmluZVNTUkN1c3RvbUVsZW1lbnQgPSAoKG9wdGlvbnMpID0+IHtcclxuICAgIC8vIEB0cy1pZ25vcmVcclxuICAgIHJldHVybiBkZWZpbmVDdXN0b21FbGVtZW50KG9wdGlvbnMsIGh5ZHJhdGUpO1xyXG59KTtcclxuY29uc3QgQmFzZUNsYXNzID0gKHR5cGVvZiBIVE1MRWxlbWVudCAhPT0gJ3VuZGVmaW5lZCcgPyBIVE1MRWxlbWVudCA6IGNsYXNzIHtcclxufSk7XHJcbmNsYXNzIFZ1ZUVsZW1lbnQgZXh0ZW5kcyBCYXNlQ2xhc3Mge1xyXG4gICAgY29uc3RydWN0b3IoX2RlZiwgX3Byb3BzID0ge30sIGh5ZHJhdGUpIHtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgICAgIHRoaXMuX2RlZiA9IF9kZWY7XHJcbiAgICAgICAgdGhpcy5fcHJvcHMgPSBfcHJvcHM7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGludGVybmFsXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5faW5zdGFuY2UgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuX2Nvbm5lY3RlZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX3Jlc29sdmVkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fbnVtYmVyUHJvcHMgPSBudWxsO1xyXG4gICAgICAgIGlmICh0aGlzLnNoYWRvd1Jvb3QgJiYgaHlkcmF0ZSkge1xyXG4gICAgICAgICAgICBoeWRyYXRlKHRoaXMuX2NyZWF0ZVZOb2RlKCksIHRoaXMuc2hhZG93Um9vdCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmIHRoaXMuc2hhZG93Um9vdCkge1xyXG4gICAgICAgICAgICAgICAgd2FybihgQ3VzdG9tIGVsZW1lbnQgaGFzIHByZS1yZW5kZXJlZCBkZWNsYXJhdGl2ZSBzaGFkb3cgcm9vdCBidXQgaXMgbm90IGAgK1xyXG4gICAgICAgICAgICAgICAgICAgIGBkZWZpbmVkIGFzIGh5ZHJhdGFibGUuIFVzZSBcXGBkZWZpbmVTU1JDdXN0b21FbGVtZW50XFxgLmApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuYXR0YWNoU2hhZG93KHsgbW9kZTogJ29wZW4nIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGNvbm5lY3RlZENhbGxiYWNrKCkge1xyXG4gICAgICAgIHRoaXMuX2Nvbm5lY3RlZCA9IHRydWU7XHJcbiAgICAgICAgaWYgKCF0aGlzLl9pbnN0YW5jZSkge1xyXG4gICAgICAgICAgICB0aGlzLl9yZXNvbHZlRGVmKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZGlzY29ubmVjdGVkQ2FsbGJhY2soKSB7XHJcbiAgICAgICAgdGhpcy5fY29ubmVjdGVkID0gZmFsc2U7XHJcbiAgICAgICAgbmV4dFRpY2soKCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuX2Nvbm5lY3RlZCkge1xyXG4gICAgICAgICAgICAgICAgcmVuZGVyKG51bGwsIHRoaXMuc2hhZG93Um9vdCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9pbnN0YW5jZSA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogcmVzb2x2ZSBpbm5lciBjb21wb25lbnQgZGVmaW5pdGlvbiAoaGFuZGxlIHBvc3NpYmxlIGFzeW5jIGNvbXBvbmVudClcclxuICAgICAqL1xyXG4gICAgX3Jlc29sdmVEZWYoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX3Jlc29sdmVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fcmVzb2x2ZWQgPSB0cnVlO1xyXG4gICAgICAgIC8vIHNldCBpbml0aWFsIGF0dHJzXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmF0dHJpYnV0ZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdGhpcy5fc2V0QXR0cih0aGlzLmF0dHJpYnV0ZXNbaV0ubmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIHdhdGNoIGZ1dHVyZSBhdHRyIGNoYW5nZXNcclxuICAgICAgICBuZXcgTXV0YXRpb25PYnNlcnZlcihtdXRhdGlvbnMgPT4ge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IG0gb2YgbXV0YXRpb25zKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zZXRBdHRyKG0uYXR0cmlidXRlTmFtZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KS5vYnNlcnZlKHRoaXMsIHsgYXR0cmlidXRlczogdHJ1ZSB9KTtcclxuICAgICAgICBjb25zdCByZXNvbHZlID0gKGRlZikgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB7IHByb3BzLCBzdHlsZXMgfSA9IGRlZjtcclxuICAgICAgICAgICAgY29uc3QgaGFzT3B0aW9ucyA9ICFpc0FycmF5KHByb3BzKTtcclxuICAgICAgICAgICAgY29uc3QgcmF3S2V5cyA9IHByb3BzID8gKGhhc09wdGlvbnMgPyBPYmplY3Qua2V5cyhwcm9wcykgOiBwcm9wcykgOiBbXTtcclxuICAgICAgICAgICAgLy8gY2FzdCBOdW1iZXItdHlwZSBwcm9wcyBzZXQgYmVmb3JlIHJlc29sdmVcclxuICAgICAgICAgICAgbGV0IG51bWJlclByb3BzO1xyXG4gICAgICAgICAgICBpZiAoaGFzT3B0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gdGhpcy5fcHJvcHMpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBvcHQgPSBwcm9wc1trZXldO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcHQgPT09IE51bWJlciB8fCAob3B0ICYmIG9wdC50eXBlID09PSBOdW1iZXIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3Byb3BzW2tleV0gPSB0b051bWJlcih0aGlzLl9wcm9wc1trZXldKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgKG51bWJlclByb3BzIHx8IChudW1iZXJQcm9wcyA9IE9iamVjdC5jcmVhdGUobnVsbCkpKVtrZXldID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5fbnVtYmVyUHJvcHMgPSBudW1iZXJQcm9wcztcclxuICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlcmUgYXJlIHByb3BzIHNldCBwcmUtdXBncmFkZSBvciBjb25uZWN0XHJcbiAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IG9mIE9iamVjdC5rZXlzKHRoaXMpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoa2V5WzBdICE9PSAnXycpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZXRQcm9wKGtleSwgdGhpc1trZXldLCB0cnVlLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gZGVmaW5pbmcgZ2V0dGVyL3NldHRlcnMgb24gcHJvdG90eXBlXHJcbiAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IG9mIHJhd0tleXMubWFwKGNhbWVsaXplJDEpKSB7XHJcbiAgICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywga2V5LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgZ2V0KCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZ2V0UHJvcChrZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgc2V0KHZhbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZXRQcm9wKGtleSwgdmFsKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBhcHBseSBDU1NcclxuICAgICAgICAgICAgdGhpcy5fYXBwbHlTdHlsZXMoc3R5bGVzKTtcclxuICAgICAgICAgICAgLy8gaW5pdGlhbCByZW5kZXJcclxuICAgICAgICAgICAgdGhpcy5fdXBkYXRlKCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBjb25zdCBhc3luY0RlZiA9IHRoaXMuX2RlZi5fX2FzeW5jTG9hZGVyO1xyXG4gICAgICAgIGlmIChhc3luY0RlZikge1xyXG4gICAgICAgICAgICBhc3luY0RlZigpLnRoZW4ocmVzb2x2ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXNvbHZlKHRoaXMuX2RlZik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgX3NldEF0dHIoa2V5KSB7XHJcbiAgICAgICAgbGV0IHZhbHVlID0gdGhpcy5nZXRBdHRyaWJ1dGUoa2V5KTtcclxuICAgICAgICBpZiAodGhpcy5fbnVtYmVyUHJvcHMgJiYgdGhpcy5fbnVtYmVyUHJvcHNba2V5XSkge1xyXG4gICAgICAgICAgICB2YWx1ZSA9IHRvTnVtYmVyKHZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fc2V0UHJvcChjYW1lbGl6ZSQxKGtleSksIHZhbHVlLCBmYWxzZSk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEBpbnRlcm5hbFxyXG4gICAgICovXHJcbiAgICBfZ2V0UHJvcChrZXkpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fcHJvcHNba2V5XTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQGludGVybmFsXHJcbiAgICAgKi9cclxuICAgIF9zZXRQcm9wKGtleSwgdmFsLCBzaG91bGRSZWZsZWN0ID0gdHJ1ZSwgc2hvdWxkVXBkYXRlID0gdHJ1ZSkge1xyXG4gICAgICAgIGlmICh2YWwgIT09IHRoaXMuX3Byb3BzW2tleV0pIHtcclxuICAgICAgICAgICAgdGhpcy5fcHJvcHNba2V5XSA9IHZhbDtcclxuICAgICAgICAgICAgaWYgKHNob3VsZFVwZGF0ZSAmJiB0aGlzLl9pbnN0YW5jZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gcmVmbGVjdFxyXG4gICAgICAgICAgICBpZiAoc2hvdWxkUmVmbGVjdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHZhbCA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0QXR0cmlidXRlKGh5cGhlbmF0ZShrZXkpLCAnJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0eXBlb2YgdmFsID09PSAnc3RyaW5nJyB8fCB0eXBlb2YgdmFsID09PSAnbnVtYmVyJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0QXR0cmlidXRlKGh5cGhlbmF0ZShrZXkpLCB2YWwgKyAnJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmICghdmFsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVBdHRyaWJ1dGUoaHlwaGVuYXRlKGtleSkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgX3VwZGF0ZSgpIHtcclxuICAgICAgICByZW5kZXIodGhpcy5fY3JlYXRlVk5vZGUoKSwgdGhpcy5zaGFkb3dSb290KTtcclxuICAgIH1cclxuICAgIF9jcmVhdGVWTm9kZSgpIHtcclxuICAgICAgICBjb25zdCB2bm9kZSA9IGNyZWF0ZVZOb2RlKHRoaXMuX2RlZiwgZXh0ZW5kKHt9LCB0aGlzLl9wcm9wcykpO1xyXG4gICAgICAgIGlmICghdGhpcy5faW5zdGFuY2UpIHtcclxuICAgICAgICAgICAgdm5vZGUuY2UgPSBpbnN0YW5jZSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9pbnN0YW5jZSA9IGluc3RhbmNlO1xyXG4gICAgICAgICAgICAgICAgaW5zdGFuY2UuaXNDRSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAvLyBITVJcclxuICAgICAgICAgICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZS5jZVJlbG9hZCA9IG5ld1N0eWxlcyA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFsd2F5cyByZXNldCBzdHlsZXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX3N0eWxlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3R5bGVzLmZvckVhY2gocyA9PiB0aGlzLnNoYWRvd1Jvb3QucmVtb3ZlQ2hpbGQocykpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3R5bGVzLmxlbmd0aCA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fYXBwbHlTdHlsZXMobmV3U3R5bGVzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWYgdGhpcyBpcyBhbiBhc3luYyBjb21wb25lbnQsIGNlUmVsb2FkIGlzIGNhbGxlZCBmcm9tIHRoZSBpbm5lclxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBjb21wb25lbnQgc28gbm8gbmVlZCB0byByZWxvYWQgdGhlIGFzeW5jIHdyYXBwZXJcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9kZWYuX19hc3luY0xvYWRlcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVsb2FkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9pbnN0YW5jZSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl91cGRhdGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyBpbnRlcmNlcHQgZW1pdFxyXG4gICAgICAgICAgICAgICAgaW5zdGFuY2UuZW1pdCA9IChldmVudCwgLi4uYXJncykgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoZXZlbnQsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiBhcmdzXHJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIC8vIGxvY2F0ZSBuZWFyZXN0IFZ1ZSBjdXN0b20gZWxlbWVudCBwYXJlbnQgZm9yIHByb3ZpZGUvaW5qZWN0XHJcbiAgICAgICAgICAgICAgICBsZXQgcGFyZW50ID0gdGhpcztcclxuICAgICAgICAgICAgICAgIHdoaWxlICgocGFyZW50ID1cclxuICAgICAgICAgICAgICAgICAgICBwYXJlbnQgJiYgKHBhcmVudC5wYXJlbnROb2RlIHx8IHBhcmVudC5ob3N0KSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocGFyZW50IGluc3RhbmNlb2YgVnVlRWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZS5wYXJlbnQgPSBwYXJlbnQuX2luc3RhbmNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB2bm9kZTtcclxuICAgIH1cclxuICAgIF9hcHBseVN0eWxlcyhzdHlsZXMpIHtcclxuICAgICAgICBpZiAoc3R5bGVzKSB7XHJcbiAgICAgICAgICAgIHN0eWxlcy5mb3JFYWNoKGNzcyA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTtcclxuICAgICAgICAgICAgICAgIHMudGV4dENvbnRlbnQgPSBjc3M7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNoYWRvd1Jvb3QuYXBwZW5kQ2hpbGQocyk7XHJcbiAgICAgICAgICAgICAgICAvLyByZWNvcmQgZm9yIEhNUlxyXG4gICAgICAgICAgICAgICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICh0aGlzLl9zdHlsZXMgfHwgKHRoaXMuX3N0eWxlcyA9IFtdKSkucHVzaChzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XG5cbmZ1bmN0aW9uIHVzZUNzc01vZHVsZShuYW1lID0gJyRzdHlsZScpIHtcclxuICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBlbHNlICovXHJcbiAgICB7XHJcbiAgICAgICAgY29uc3QgaW5zdGFuY2UgPSBnZXRDdXJyZW50SW5zdGFuY2UoKTtcclxuICAgICAgICBpZiAoIWluc3RhbmNlKSB7XHJcbiAgICAgICAgICAgIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJiB3YXJuKGB1c2VDc3NNb2R1bGUgbXVzdCBiZSBjYWxsZWQgaW5zaWRlIHNldHVwKClgKTtcclxuICAgICAgICAgICAgcmV0dXJuIEVNUFRZX09CSjtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgbW9kdWxlcyA9IGluc3RhbmNlLnR5cGUuX19jc3NNb2R1bGVzO1xyXG4gICAgICAgIGlmICghbW9kdWxlcykge1xyXG4gICAgICAgICAgICAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiYgd2FybihgQ3VycmVudCBpbnN0YW5jZSBkb2VzIG5vdCBoYXZlIENTUyBtb2R1bGVzIGluamVjdGVkLmApO1xyXG4gICAgICAgICAgICByZXR1cm4gRU1QVFlfT0JKO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBtb2QgPSBtb2R1bGVzW25hbWVdO1xyXG4gICAgICAgIGlmICghbW9kKSB7XHJcbiAgICAgICAgICAgIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJlxyXG4gICAgICAgICAgICAgICAgd2FybihgQ3VycmVudCBpbnN0YW5jZSBkb2VzIG5vdCBoYXZlIENTUyBtb2R1bGUgbmFtZWQgXCIke25hbWV9XCIuYCk7XHJcbiAgICAgICAgICAgIHJldHVybiBFTVBUWV9PQko7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBtb2Q7XHJcbiAgICB9XHJcbn1cblxuLyoqXHJcbiAqIFJ1bnRpbWUgaGVscGVyIGZvciBTRkMncyBDU1MgdmFyaWFibGUgaW5qZWN0aW9uIGZlYXR1cmUuXHJcbiAqIEBwcml2YXRlXHJcbiAqL1xyXG5mdW5jdGlvbiB1c2VDc3NWYXJzKGdldHRlcikge1xyXG4gICAgY29uc3QgaW5zdGFuY2UgPSBnZXRDdXJyZW50SW5zdGFuY2UoKTtcclxuICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXHJcbiAgICBpZiAoIWluc3RhbmNlKSB7XHJcbiAgICAgICAgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpICYmXHJcbiAgICAgICAgICAgIHdhcm4oYHVzZUNzc1ZhcnMgaXMgY2FsbGVkIHdpdGhvdXQgY3VycmVudCBhY3RpdmUgY29tcG9uZW50IGluc3RhbmNlLmApO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IHNldFZhcnMgPSAoKSA9PiBzZXRWYXJzT25WTm9kZShpbnN0YW5jZS5zdWJUcmVlLCBnZXR0ZXIoaW5zdGFuY2UucHJveHkpKTtcclxuICAgIHdhdGNoUG9zdEVmZmVjdChzZXRWYXJzKTtcclxuICAgIG9uTW91bnRlZCgoKSA9PiB7XHJcbiAgICAgICAgY29uc3Qgb2IgPSBuZXcgTXV0YXRpb25PYnNlcnZlcihzZXRWYXJzKTtcclxuICAgICAgICBvYi5vYnNlcnZlKGluc3RhbmNlLnN1YlRyZWUuZWwucGFyZW50Tm9kZSwgeyBjaGlsZExpc3Q6IHRydWUgfSk7XHJcbiAgICAgICAgb25Vbm1vdW50ZWQoKCkgPT4gb2IuZGlzY29ubmVjdCgpKTtcclxuICAgIH0pO1xyXG59XHJcbmZ1bmN0aW9uIHNldFZhcnNPblZOb2RlKHZub2RlLCB2YXJzKSB7XHJcbiAgICBpZiAodm5vZGUuc2hhcGVGbGFnICYgMTI4IC8qIFNVU1BFTlNFICovKSB7XHJcbiAgICAgICAgY29uc3Qgc3VzcGVuc2UgPSB2bm9kZS5zdXNwZW5zZTtcclxuICAgICAgICB2bm9kZSA9IHN1c3BlbnNlLmFjdGl2ZUJyYW5jaDtcclxuICAgICAgICBpZiAoc3VzcGVuc2UucGVuZGluZ0JyYW5jaCAmJiAhc3VzcGVuc2UuaXNIeWRyYXRpbmcpIHtcclxuICAgICAgICAgICAgc3VzcGVuc2UuZWZmZWN0cy5wdXNoKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHNldFZhcnNPblZOb2RlKHN1c3BlbnNlLmFjdGl2ZUJyYW5jaCwgdmFycyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8vIGRyaWxsIGRvd24gSE9DcyB1bnRpbCBpdCdzIGEgbm9uLWNvbXBvbmVudCB2bm9kZVxyXG4gICAgd2hpbGUgKHZub2RlLmNvbXBvbmVudCkge1xyXG4gICAgICAgIHZub2RlID0gdm5vZGUuY29tcG9uZW50LnN1YlRyZWU7XHJcbiAgICB9XHJcbiAgICBpZiAodm5vZGUuc2hhcGVGbGFnICYgMSAvKiBFTEVNRU5UICovICYmIHZub2RlLmVsKSB7XHJcbiAgICAgICAgc2V0VmFyc09uTm9kZSh2bm9kZS5lbCwgdmFycyk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICh2bm9kZS50eXBlID09PSBGcmFnbWVudCkge1xyXG4gICAgICAgIHZub2RlLmNoaWxkcmVuLmZvckVhY2goYyA9PiBzZXRWYXJzT25WTm9kZShjLCB2YXJzKSk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICh2bm9kZS50eXBlID09PSBTdGF0aWMpIHtcclxuICAgICAgICBsZXQgeyBlbCwgYW5jaG9yIH0gPSB2bm9kZTtcclxuICAgICAgICB3aGlsZSAoZWwpIHtcclxuICAgICAgICAgICAgc2V0VmFyc09uTm9kZShlbCwgdmFycyk7XHJcbiAgICAgICAgICAgIGlmIChlbCA9PT0gYW5jaG9yKVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGVsID0gZWwubmV4dFNpYmxpbmc7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHNldFZhcnNPbk5vZGUoZWwsIHZhcnMpIHtcclxuICAgIGlmIChlbC5ub2RlVHlwZSA9PT0gMSkge1xyXG4gICAgICAgIGNvbnN0IHN0eWxlID0gZWwuc3R5bGU7XHJcbiAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gdmFycykge1xyXG4gICAgICAgICAgICBzdHlsZS5zZXRQcm9wZXJ0eShgLS0ke2tleX1gLCB2YXJzW2tleV0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxuXG5jb25zdCBUUkFOU0lUSU9OID0gJ3RyYW5zaXRpb24nO1xyXG5jb25zdCBBTklNQVRJT04gPSAnYW5pbWF0aW9uJztcclxuLy8gRE9NIFRyYW5zaXRpb24gaXMgYSBoaWdoZXItb3JkZXItY29tcG9uZW50IGJhc2VkIG9uIHRoZSBwbGF0Zm9ybS1hZ25vc3RpY1xyXG4vLyBiYXNlIFRyYW5zaXRpb24gY29tcG9uZW50LCB3aXRoIERPTS1zcGVjaWZpYyBsb2dpYy5cclxuY29uc3QgVHJhbnNpdGlvbiA9IChwcm9wcywgeyBzbG90cyB9KSA9PiBoKEJhc2VUcmFuc2l0aW9uLCByZXNvbHZlVHJhbnNpdGlvblByb3BzKHByb3BzKSwgc2xvdHMpO1xyXG5UcmFuc2l0aW9uLmRpc3BsYXlOYW1lID0gJ1RyYW5zaXRpb24nO1xyXG5jb25zdCBET01UcmFuc2l0aW9uUHJvcHNWYWxpZGF0b3JzID0ge1xyXG4gICAgbmFtZTogU3RyaW5nLFxyXG4gICAgdHlwZTogU3RyaW5nLFxyXG4gICAgY3NzOiB7XHJcbiAgICAgICAgdHlwZTogQm9vbGVhbixcclxuICAgICAgICBkZWZhdWx0OiB0cnVlXHJcbiAgICB9LFxyXG4gICAgZHVyYXRpb246IFtTdHJpbmcsIE51bWJlciwgT2JqZWN0XSxcclxuICAgIGVudGVyRnJvbUNsYXNzOiBTdHJpbmcsXHJcbiAgICBlbnRlckFjdGl2ZUNsYXNzOiBTdHJpbmcsXHJcbiAgICBlbnRlclRvQ2xhc3M6IFN0cmluZyxcclxuICAgIGFwcGVhckZyb21DbGFzczogU3RyaW5nLFxyXG4gICAgYXBwZWFyQWN0aXZlQ2xhc3M6IFN0cmluZyxcclxuICAgIGFwcGVhclRvQ2xhc3M6IFN0cmluZyxcclxuICAgIGxlYXZlRnJvbUNsYXNzOiBTdHJpbmcsXHJcbiAgICBsZWF2ZUFjdGl2ZUNsYXNzOiBTdHJpbmcsXHJcbiAgICBsZWF2ZVRvQ2xhc3M6IFN0cmluZ1xyXG59O1xyXG5jb25zdCBUcmFuc2l0aW9uUHJvcHNWYWxpZGF0b3JzID0gKFRyYW5zaXRpb24ucHJvcHMgPVxyXG4gICAgLyojX19QVVJFX18qLyBleHRlbmQoe30sIEJhc2VUcmFuc2l0aW9uLnByb3BzLCBET01UcmFuc2l0aW9uUHJvcHNWYWxpZGF0b3JzKSk7XHJcbi8qKlxyXG4gKiAjMzIyNyBJbmNvbWluZyBob29rcyBtYXkgYmUgbWVyZ2VkIGludG8gYXJyYXlzIHdoZW4gd3JhcHBpbmcgVHJhbnNpdGlvblxyXG4gKiB3aXRoIGN1c3RvbSBIT0NzLlxyXG4gKi9cclxuY29uc3QgY2FsbEhvb2sgPSAoaG9vaywgYXJncyA9IFtdKSA9PiB7XHJcbiAgICBpZiAoaXNBcnJheShob29rKSkge1xyXG4gICAgICAgIGhvb2suZm9yRWFjaChoID0+IGgoLi4uYXJncykpO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoaG9vaykge1xyXG4gICAgICAgIGhvb2soLi4uYXJncyk7XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKiBDaGVjayBpZiBhIGhvb2sgZXhwZWN0cyBhIGNhbGxiYWNrICgybmQgYXJnKSwgd2hpY2ggbWVhbnMgdGhlIHVzZXJcclxuICogaW50ZW5kcyB0byBleHBsaWNpdGx5IGNvbnRyb2wgdGhlIGVuZCBvZiB0aGUgdHJhbnNpdGlvbi5cclxuICovXHJcbmNvbnN0IGhhc0V4cGxpY2l0Q2FsbGJhY2sgPSAoaG9vaykgPT4ge1xyXG4gICAgcmV0dXJuIGhvb2tcclxuICAgICAgICA/IGlzQXJyYXkoaG9vaylcclxuICAgICAgICAgICAgPyBob29rLnNvbWUoaCA9PiBoLmxlbmd0aCA+IDEpXHJcbiAgICAgICAgICAgIDogaG9vay5sZW5ndGggPiAxXHJcbiAgICAgICAgOiBmYWxzZTtcclxufTtcclxuZnVuY3Rpb24gcmVzb2x2ZVRyYW5zaXRpb25Qcm9wcyhyYXdQcm9wcykge1xyXG4gICAgY29uc3QgYmFzZVByb3BzID0ge307XHJcbiAgICBmb3IgKGNvbnN0IGtleSBpbiByYXdQcm9wcykge1xyXG4gICAgICAgIGlmICghKGtleSBpbiBET01UcmFuc2l0aW9uUHJvcHNWYWxpZGF0b3JzKSkge1xyXG4gICAgICAgICAgICBiYXNlUHJvcHNba2V5XSA9IHJhd1Byb3BzW2tleV07XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYgKHJhd1Byb3BzLmNzcyA9PT0gZmFsc2UpIHtcclxuICAgICAgICByZXR1cm4gYmFzZVByb3BzO1xyXG4gICAgfVxyXG4gICAgY29uc3QgeyBuYW1lID0gJ3YnLCB0eXBlLCBkdXJhdGlvbiwgZW50ZXJGcm9tQ2xhc3MgPSBgJHtuYW1lfS1lbnRlci1mcm9tYCwgZW50ZXJBY3RpdmVDbGFzcyA9IGAke25hbWV9LWVudGVyLWFjdGl2ZWAsIGVudGVyVG9DbGFzcyA9IGAke25hbWV9LWVudGVyLXRvYCwgYXBwZWFyRnJvbUNsYXNzID0gZW50ZXJGcm9tQ2xhc3MsIGFwcGVhckFjdGl2ZUNsYXNzID0gZW50ZXJBY3RpdmVDbGFzcywgYXBwZWFyVG9DbGFzcyA9IGVudGVyVG9DbGFzcywgbGVhdmVGcm9tQ2xhc3MgPSBgJHtuYW1lfS1sZWF2ZS1mcm9tYCwgbGVhdmVBY3RpdmVDbGFzcyA9IGAke25hbWV9LWxlYXZlLWFjdGl2ZWAsIGxlYXZlVG9DbGFzcyA9IGAke25hbWV9LWxlYXZlLXRvYCB9ID0gcmF3UHJvcHM7XHJcbiAgICBjb25zdCBkdXJhdGlvbnMgPSBub3JtYWxpemVEdXJhdGlvbihkdXJhdGlvbik7XHJcbiAgICBjb25zdCBlbnRlckR1cmF0aW9uID0gZHVyYXRpb25zICYmIGR1cmF0aW9uc1swXTtcclxuICAgIGNvbnN0IGxlYXZlRHVyYXRpb24gPSBkdXJhdGlvbnMgJiYgZHVyYXRpb25zWzFdO1xyXG4gICAgY29uc3QgeyBvbkJlZm9yZUVudGVyLCBvbkVudGVyLCBvbkVudGVyQ2FuY2VsbGVkLCBvbkxlYXZlLCBvbkxlYXZlQ2FuY2VsbGVkLCBvbkJlZm9yZUFwcGVhciA9IG9uQmVmb3JlRW50ZXIsIG9uQXBwZWFyID0gb25FbnRlciwgb25BcHBlYXJDYW5jZWxsZWQgPSBvbkVudGVyQ2FuY2VsbGVkIH0gPSBiYXNlUHJvcHM7XHJcbiAgICBjb25zdCBmaW5pc2hFbnRlciA9IChlbCwgaXNBcHBlYXIsIGRvbmUpID0+IHtcclxuICAgICAgICByZW1vdmVUcmFuc2l0aW9uQ2xhc3MoZWwsIGlzQXBwZWFyID8gYXBwZWFyVG9DbGFzcyA6IGVudGVyVG9DbGFzcyk7XHJcbiAgICAgICAgcmVtb3ZlVHJhbnNpdGlvbkNsYXNzKGVsLCBpc0FwcGVhciA/IGFwcGVhckFjdGl2ZUNsYXNzIDogZW50ZXJBY3RpdmVDbGFzcyk7XHJcbiAgICAgICAgZG9uZSAmJiBkb25lKCk7XHJcbiAgICB9O1xyXG4gICAgY29uc3QgZmluaXNoTGVhdmUgPSAoZWwsIGRvbmUpID0+IHtcclxuICAgICAgICByZW1vdmVUcmFuc2l0aW9uQ2xhc3MoZWwsIGxlYXZlVG9DbGFzcyk7XHJcbiAgICAgICAgcmVtb3ZlVHJhbnNpdGlvbkNsYXNzKGVsLCBsZWF2ZUFjdGl2ZUNsYXNzKTtcclxuICAgICAgICBkb25lICYmIGRvbmUoKTtcclxuICAgIH07XHJcbiAgICBjb25zdCBtYWtlRW50ZXJIb29rID0gKGlzQXBwZWFyKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIChlbCwgZG9uZSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBob29rID0gaXNBcHBlYXIgPyBvbkFwcGVhciA6IG9uRW50ZXI7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlc29sdmUgPSAoKSA9PiBmaW5pc2hFbnRlcihlbCwgaXNBcHBlYXIsIGRvbmUpO1xyXG4gICAgICAgICAgICBjYWxsSG9vayhob29rLCBbZWwsIHJlc29sdmVdKTtcclxuICAgICAgICAgICAgbmV4dEZyYW1lKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHJlbW92ZVRyYW5zaXRpb25DbGFzcyhlbCwgaXNBcHBlYXIgPyBhcHBlYXJGcm9tQ2xhc3MgOiBlbnRlckZyb21DbGFzcyk7XHJcbiAgICAgICAgICAgICAgICBhZGRUcmFuc2l0aW9uQ2xhc3MoZWwsIGlzQXBwZWFyID8gYXBwZWFyVG9DbGFzcyA6IGVudGVyVG9DbGFzcyk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWhhc0V4cGxpY2l0Q2FsbGJhY2soaG9vaykpIHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVuVHJhbnNpdGlvbkVuZHMoZWwsIHR5cGUsIGVudGVyRHVyYXRpb24sIHJlc29sdmUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuICAgIHJldHVybiBleHRlbmQoYmFzZVByb3BzLCB7XHJcbiAgICAgICAgb25CZWZvcmVFbnRlcihlbCkge1xyXG4gICAgICAgICAgICBjYWxsSG9vayhvbkJlZm9yZUVudGVyLCBbZWxdKTtcclxuICAgICAgICAgICAgYWRkVHJhbnNpdGlvbkNsYXNzKGVsLCBlbnRlckZyb21DbGFzcyk7XHJcbiAgICAgICAgICAgIGFkZFRyYW5zaXRpb25DbGFzcyhlbCwgZW50ZXJBY3RpdmVDbGFzcyk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBvbkJlZm9yZUFwcGVhcihlbCkge1xyXG4gICAgICAgICAgICBjYWxsSG9vayhvbkJlZm9yZUFwcGVhciwgW2VsXSk7XHJcbiAgICAgICAgICAgIGFkZFRyYW5zaXRpb25DbGFzcyhlbCwgYXBwZWFyRnJvbUNsYXNzKTtcclxuICAgICAgICAgICAgYWRkVHJhbnNpdGlvbkNsYXNzKGVsLCBhcHBlYXJBY3RpdmVDbGFzcyk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBvbkVudGVyOiBtYWtlRW50ZXJIb29rKGZhbHNlKSxcclxuICAgICAgICBvbkFwcGVhcjogbWFrZUVudGVySG9vayh0cnVlKSxcclxuICAgICAgICBvbkxlYXZlKGVsLCBkb25lKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlc29sdmUgPSAoKSA9PiBmaW5pc2hMZWF2ZShlbCwgZG9uZSk7XHJcbiAgICAgICAgICAgIGFkZFRyYW5zaXRpb25DbGFzcyhlbCwgbGVhdmVGcm9tQ2xhc3MpO1xyXG4gICAgICAgICAgICAvLyBmb3JjZSByZWZsb3cgc28gKi1sZWF2ZS1mcm9tIGNsYXNzZXMgaW1tZWRpYXRlbHkgdGFrZSBlZmZlY3QgKCMyNTkzKVxyXG4gICAgICAgICAgICBmb3JjZVJlZmxvdygpO1xyXG4gICAgICAgICAgICBhZGRUcmFuc2l0aW9uQ2xhc3MoZWwsIGxlYXZlQWN0aXZlQ2xhc3MpO1xyXG4gICAgICAgICAgICBuZXh0RnJhbWUoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmVtb3ZlVHJhbnNpdGlvbkNsYXNzKGVsLCBsZWF2ZUZyb21DbGFzcyk7XHJcbiAgICAgICAgICAgICAgICBhZGRUcmFuc2l0aW9uQ2xhc3MoZWwsIGxlYXZlVG9DbGFzcyk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWhhc0V4cGxpY2l0Q2FsbGJhY2sob25MZWF2ZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICB3aGVuVHJhbnNpdGlvbkVuZHMoZWwsIHR5cGUsIGxlYXZlRHVyYXRpb24sIHJlc29sdmUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgY2FsbEhvb2sob25MZWF2ZSwgW2VsLCByZXNvbHZlXSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBvbkVudGVyQ2FuY2VsbGVkKGVsKSB7XHJcbiAgICAgICAgICAgIGZpbmlzaEVudGVyKGVsLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIGNhbGxIb29rKG9uRW50ZXJDYW5jZWxsZWQsIFtlbF0pO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgb25BcHBlYXJDYW5jZWxsZWQoZWwpIHtcclxuICAgICAgICAgICAgZmluaXNoRW50ZXIoZWwsIHRydWUpO1xyXG4gICAgICAgICAgICBjYWxsSG9vayhvbkFwcGVhckNhbmNlbGxlZCwgW2VsXSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBvbkxlYXZlQ2FuY2VsbGVkKGVsKSB7XHJcbiAgICAgICAgICAgIGZpbmlzaExlYXZlKGVsKTtcclxuICAgICAgICAgICAgY2FsbEhvb2sob25MZWF2ZUNhbmNlbGxlZCwgW2VsXSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn1cclxuZnVuY3Rpb24gbm9ybWFsaXplRHVyYXRpb24oZHVyYXRpb24pIHtcclxuICAgIGlmIChkdXJhdGlvbiA9PSBudWxsKSB7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChpc09iamVjdChkdXJhdGlvbikpIHtcclxuICAgICAgICByZXR1cm4gW051bWJlck9mKGR1cmF0aW9uLmVudGVyKSwgTnVtYmVyT2YoZHVyYXRpb24ubGVhdmUpXTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIGNvbnN0IG4gPSBOdW1iZXJPZihkdXJhdGlvbik7XHJcbiAgICAgICAgcmV0dXJuIFtuLCBuXTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBOdW1iZXJPZih2YWwpIHtcclxuICAgIGNvbnN0IHJlcyA9IHRvTnVtYmVyKHZhbCk7XHJcbiAgICBpZiAoKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpKVxyXG4gICAgICAgIHZhbGlkYXRlRHVyYXRpb24ocmVzKTtcclxuICAgIHJldHVybiByZXM7XHJcbn1cclxuZnVuY3Rpb24gdmFsaWRhdGVEdXJhdGlvbih2YWwpIHtcclxuICAgIGlmICh0eXBlb2YgdmFsICE9PSAnbnVtYmVyJykge1xyXG4gICAgICAgIHdhcm4oYDx0cmFuc2l0aW9uPiBleHBsaWNpdCBkdXJhdGlvbiBpcyBub3QgYSB2YWxpZCBudW1iZXIgLSBgICtcclxuICAgICAgICAgICAgYGdvdCAke0pTT04uc3RyaW5naWZ5KHZhbCl9LmApO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoaXNOYU4odmFsKSkge1xyXG4gICAgICAgIHdhcm4oYDx0cmFuc2l0aW9uPiBleHBsaWNpdCBkdXJhdGlvbiBpcyBOYU4gLSBgICtcclxuICAgICAgICAgICAgJ3RoZSBkdXJhdGlvbiBleHByZXNzaW9uIG1pZ2h0IGJlIGluY29ycmVjdC4nKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBhZGRUcmFuc2l0aW9uQ2xhc3MoZWwsIGNscykge1xyXG4gICAgY2xzLnNwbGl0KC9cXHMrLykuZm9yRWFjaChjID0+IGMgJiYgZWwuY2xhc3NMaXN0LmFkZChjKSk7XHJcbiAgICAoZWwuX3Z0YyB8fFxyXG4gICAgICAgIChlbC5fdnRjID0gbmV3IFNldCgpKSkuYWRkKGNscyk7XHJcbn1cclxuZnVuY3Rpb24gcmVtb3ZlVHJhbnNpdGlvbkNsYXNzKGVsLCBjbHMpIHtcclxuICAgIGNscy5zcGxpdCgvXFxzKy8pLmZvckVhY2goYyA9PiBjICYmIGVsLmNsYXNzTGlzdC5yZW1vdmUoYykpO1xyXG4gICAgY29uc3QgeyBfdnRjIH0gPSBlbDtcclxuICAgIGlmIChfdnRjKSB7XHJcbiAgICAgICAgX3Z0Yy5kZWxldGUoY2xzKTtcclxuICAgICAgICBpZiAoIV92dGMuc2l6ZSkge1xyXG4gICAgICAgICAgICBlbC5fdnRjID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBuZXh0RnJhbWUoY2IpIHtcclxuICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XHJcbiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGNiKTtcclxuICAgIH0pO1xyXG59XHJcbmxldCBlbmRJZCA9IDA7XHJcbmZ1bmN0aW9uIHdoZW5UcmFuc2l0aW9uRW5kcyhlbCwgZXhwZWN0ZWRUeXBlLCBleHBsaWNpdFRpbWVvdXQsIHJlc29sdmUpIHtcclxuICAgIGNvbnN0IGlkID0gKGVsLl9lbmRJZCA9ICsrZW5kSWQpO1xyXG4gICAgY29uc3QgcmVzb2x2ZUlmTm90U3RhbGUgPSAoKSA9PiB7XHJcbiAgICAgICAgaWYgKGlkID09PSBlbC5fZW5kSWQpIHtcclxuICAgICAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBpZiAoZXhwbGljaXRUaW1lb3V0KSB7XHJcbiAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQocmVzb2x2ZUlmTm90U3RhbGUsIGV4cGxpY2l0VGltZW91dCk7XHJcbiAgICB9XHJcbiAgICBjb25zdCB7IHR5cGUsIHRpbWVvdXQsIHByb3BDb3VudCB9ID0gZ2V0VHJhbnNpdGlvbkluZm8oZWwsIGV4cGVjdGVkVHlwZSk7XHJcbiAgICBpZiAoIXR5cGUpIHtcclxuICAgICAgICByZXR1cm4gcmVzb2x2ZSgpO1xyXG4gICAgfVxyXG4gICAgY29uc3QgZW5kRXZlbnQgPSB0eXBlICsgJ2VuZCc7XHJcbiAgICBsZXQgZW5kZWQgPSAwO1xyXG4gICAgY29uc3QgZW5kID0gKCkgPT4ge1xyXG4gICAgICAgIGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoZW5kRXZlbnQsIG9uRW5kKTtcclxuICAgICAgICByZXNvbHZlSWZOb3RTdGFsZSgpO1xyXG4gICAgfTtcclxuICAgIGNvbnN0IG9uRW5kID0gKGUpID0+IHtcclxuICAgICAgICBpZiAoZS50YXJnZXQgPT09IGVsICYmICsrZW5kZWQgPj0gcHJvcENvdW50KSB7XHJcbiAgICAgICAgICAgIGVuZCgpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICBpZiAoZW5kZWQgPCBwcm9wQ291bnQpIHtcclxuICAgICAgICAgICAgZW5kKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSwgdGltZW91dCArIDEpO1xyXG4gICAgZWwuYWRkRXZlbnRMaXN0ZW5lcihlbmRFdmVudCwgb25FbmQpO1xyXG59XHJcbmZ1bmN0aW9uIGdldFRyYW5zaXRpb25JbmZvKGVsLCBleHBlY3RlZFR5cGUpIHtcclxuICAgIGNvbnN0IHN0eWxlcyA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGVsKTtcclxuICAgIC8vIEpTRE9NIG1heSByZXR1cm4gdW5kZWZpbmVkIGZvciB0cmFuc2l0aW9uIHByb3BlcnRpZXNcclxuICAgIGNvbnN0IGdldFN0eWxlUHJvcGVydGllcyA9IChrZXkpID0+IChzdHlsZXNba2V5XSB8fCAnJykuc3BsaXQoJywgJyk7XHJcbiAgICBjb25zdCB0cmFuc2l0aW9uRGVsYXlzID0gZ2V0U3R5bGVQcm9wZXJ0aWVzKFRSQU5TSVRJT04gKyAnRGVsYXknKTtcclxuICAgIGNvbnN0IHRyYW5zaXRpb25EdXJhdGlvbnMgPSBnZXRTdHlsZVByb3BlcnRpZXMoVFJBTlNJVElPTiArICdEdXJhdGlvbicpO1xyXG4gICAgY29uc3QgdHJhbnNpdGlvblRpbWVvdXQgPSBnZXRUaW1lb3V0KHRyYW5zaXRpb25EZWxheXMsIHRyYW5zaXRpb25EdXJhdGlvbnMpO1xyXG4gICAgY29uc3QgYW5pbWF0aW9uRGVsYXlzID0gZ2V0U3R5bGVQcm9wZXJ0aWVzKEFOSU1BVElPTiArICdEZWxheScpO1xyXG4gICAgY29uc3QgYW5pbWF0aW9uRHVyYXRpb25zID0gZ2V0U3R5bGVQcm9wZXJ0aWVzKEFOSU1BVElPTiArICdEdXJhdGlvbicpO1xyXG4gICAgY29uc3QgYW5pbWF0aW9uVGltZW91dCA9IGdldFRpbWVvdXQoYW5pbWF0aW9uRGVsYXlzLCBhbmltYXRpb25EdXJhdGlvbnMpO1xyXG4gICAgbGV0IHR5cGUgPSBudWxsO1xyXG4gICAgbGV0IHRpbWVvdXQgPSAwO1xyXG4gICAgbGV0IHByb3BDb3VudCA9IDA7XHJcbiAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgaWYgKi9cclxuICAgIGlmIChleHBlY3RlZFR5cGUgPT09IFRSQU5TSVRJT04pIHtcclxuICAgICAgICBpZiAodHJhbnNpdGlvblRpbWVvdXQgPiAwKSB7XHJcbiAgICAgICAgICAgIHR5cGUgPSBUUkFOU0lUSU9OO1xyXG4gICAgICAgICAgICB0aW1lb3V0ID0gdHJhbnNpdGlvblRpbWVvdXQ7XHJcbiAgICAgICAgICAgIHByb3BDb3VudCA9IHRyYW5zaXRpb25EdXJhdGlvbnMubGVuZ3RoO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGV4cGVjdGVkVHlwZSA9PT0gQU5JTUFUSU9OKSB7XHJcbiAgICAgICAgaWYgKGFuaW1hdGlvblRpbWVvdXQgPiAwKSB7XHJcbiAgICAgICAgICAgIHR5cGUgPSBBTklNQVRJT047XHJcbiAgICAgICAgICAgIHRpbWVvdXQgPSBhbmltYXRpb25UaW1lb3V0O1xyXG4gICAgICAgICAgICBwcm9wQ291bnQgPSBhbmltYXRpb25EdXJhdGlvbnMubGVuZ3RoO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHRpbWVvdXQgPSBNYXRoLm1heCh0cmFuc2l0aW9uVGltZW91dCwgYW5pbWF0aW9uVGltZW91dCk7XHJcbiAgICAgICAgdHlwZSA9XHJcbiAgICAgICAgICAgIHRpbWVvdXQgPiAwXHJcbiAgICAgICAgICAgICAgICA/IHRyYW5zaXRpb25UaW1lb3V0ID4gYW5pbWF0aW9uVGltZW91dFxyXG4gICAgICAgICAgICAgICAgICAgID8gVFJBTlNJVElPTlxyXG4gICAgICAgICAgICAgICAgICAgIDogQU5JTUFUSU9OXHJcbiAgICAgICAgICAgICAgICA6IG51bGw7XHJcbiAgICAgICAgcHJvcENvdW50ID0gdHlwZVxyXG4gICAgICAgICAgICA/IHR5cGUgPT09IFRSQU5TSVRJT05cclxuICAgICAgICAgICAgICAgID8gdHJhbnNpdGlvbkR1cmF0aW9ucy5sZW5ndGhcclxuICAgICAgICAgICAgICAgIDogYW5pbWF0aW9uRHVyYXRpb25zLmxlbmd0aFxyXG4gICAgICAgICAgICA6IDA7XHJcbiAgICB9XHJcbiAgICBjb25zdCBoYXNUcmFuc2Zvcm0gPSB0eXBlID09PSBUUkFOU0lUSU9OICYmXHJcbiAgICAgICAgL1xcYih0cmFuc2Zvcm18YWxsKSgsfCQpLy50ZXN0KHN0eWxlc1tUUkFOU0lUSU9OICsgJ1Byb3BlcnR5J10pO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICB0eXBlLFxyXG4gICAgICAgIHRpbWVvdXQsXHJcbiAgICAgICAgcHJvcENvdW50LFxyXG4gICAgICAgIGhhc1RyYW5zZm9ybVxyXG4gICAgfTtcclxufVxyXG5mdW5jdGlvbiBnZXRUaW1lb3V0KGRlbGF5cywgZHVyYXRpb25zKSB7XHJcbiAgICB3aGlsZSAoZGVsYXlzLmxlbmd0aCA8IGR1cmF0aW9ucy5sZW5ndGgpIHtcclxuICAgICAgICBkZWxheXMgPSBkZWxheXMuY29uY2F0KGRlbGF5cyk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gTWF0aC5tYXgoLi4uZHVyYXRpb25zLm1hcCgoZCwgaSkgPT4gdG9NcyhkKSArIHRvTXMoZGVsYXlzW2ldKSkpO1xyXG59XHJcbi8vIE9sZCB2ZXJzaW9ucyBvZiBDaHJvbWl1bSAoYmVsb3cgNjEuMC4zMTYzLjEwMCkgZm9ybWF0cyBmbG9hdGluZyBwb2ludGVyXHJcbi8vIG51bWJlcnMgaW4gYSBsb2NhbGUtZGVwZW5kZW50IHdheSwgdXNpbmcgYSBjb21tYSBpbnN0ZWFkIG9mIGEgZG90LlxyXG4vLyBJZiBjb21tYSBpcyBub3QgcmVwbGFjZWQgd2l0aCBhIGRvdCwgdGhlIGlucHV0IHdpbGwgYmUgcm91bmRlZCBkb3duXHJcbi8vIChpLmUuIGFjdGluZyBhcyBhIGZsb29yIGZ1bmN0aW9uKSBjYXVzaW5nIHVuZXhwZWN0ZWQgYmVoYXZpb3JzXHJcbmZ1bmN0aW9uIHRvTXMocykge1xyXG4gICAgcmV0dXJuIE51bWJlcihzLnNsaWNlKDAsIC0xKS5yZXBsYWNlKCcsJywgJy4nKSkgKiAxMDAwO1xyXG59XHJcbi8vIHN5bmNocm9ub3VzbHkgZm9yY2UgbGF5b3V0IHRvIHB1dCBlbGVtZW50cyBpbnRvIGEgY2VydGFpbiBzdGF0ZVxyXG5mdW5jdGlvbiBmb3JjZVJlZmxvdygpIHtcclxuICAgIHJldHVybiBkb2N1bWVudC5ib2R5Lm9mZnNldEhlaWdodDtcclxufVxuXG5jb25zdCBwb3NpdGlvbk1hcCA9IG5ldyBXZWFrTWFwKCk7XHJcbmNvbnN0IG5ld1Bvc2l0aW9uTWFwID0gbmV3IFdlYWtNYXAoKTtcclxuY29uc3QgVHJhbnNpdGlvbkdyb3VwSW1wbCA9IHtcclxuICAgIG5hbWU6ICdUcmFuc2l0aW9uR3JvdXAnLFxyXG4gICAgcHJvcHM6IC8qI19fUFVSRV9fKi8gZXh0ZW5kKHt9LCBUcmFuc2l0aW9uUHJvcHNWYWxpZGF0b3JzLCB7XHJcbiAgICAgICAgdGFnOiBTdHJpbmcsXHJcbiAgICAgICAgbW92ZUNsYXNzOiBTdHJpbmdcclxuICAgIH0pLFxyXG4gICAgc2V0dXAocHJvcHMsIHsgc2xvdHMgfSkge1xyXG4gICAgICAgIGNvbnN0IGluc3RhbmNlID0gZ2V0Q3VycmVudEluc3RhbmNlKCk7XHJcbiAgICAgICAgY29uc3Qgc3RhdGUgPSB1c2VUcmFuc2l0aW9uU3RhdGUoKTtcclxuICAgICAgICBsZXQgcHJldkNoaWxkcmVuO1xyXG4gICAgICAgIGxldCBjaGlsZHJlbjtcclxuICAgICAgICBvblVwZGF0ZWQoKCkgPT4ge1xyXG4gICAgICAgICAgICAvLyBjaGlsZHJlbiBpcyBndWFyYW50ZWVkIHRvIGV4aXN0IGFmdGVyIGluaXRpYWwgcmVuZGVyXHJcbiAgICAgICAgICAgIGlmICghcHJldkNoaWxkcmVuLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IG1vdmVDbGFzcyA9IHByb3BzLm1vdmVDbGFzcyB8fCBgJHtwcm9wcy5uYW1lIHx8ICd2J30tbW92ZWA7XHJcbiAgICAgICAgICAgIGlmICghaGFzQ1NTVHJhbnNmb3JtKHByZXZDaGlsZHJlblswXS5lbCwgaW5zdGFuY2Uudm5vZGUuZWwsIG1vdmVDbGFzcykpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyB3ZSBkaXZpZGUgdGhlIHdvcmsgaW50byB0aHJlZSBsb29wcyB0byBhdm9pZCBtaXhpbmcgRE9NIHJlYWRzIGFuZCB3cml0ZXNcclxuICAgICAgICAgICAgLy8gaW4gZWFjaCBpdGVyYXRpb24gLSB3aGljaCBoZWxwcyBwcmV2ZW50IGxheW91dCB0aHJhc2hpbmcuXHJcbiAgICAgICAgICAgIHByZXZDaGlsZHJlbi5mb3JFYWNoKGNhbGxQZW5kaW5nQ2JzKTtcclxuICAgICAgICAgICAgcHJldkNoaWxkcmVuLmZvckVhY2gocmVjb3JkUG9zaXRpb24pO1xyXG4gICAgICAgICAgICBjb25zdCBtb3ZlZENoaWxkcmVuID0gcHJldkNoaWxkcmVuLmZpbHRlcihhcHBseVRyYW5zbGF0aW9uKTtcclxuICAgICAgICAgICAgLy8gZm9yY2UgcmVmbG93IHRvIHB1dCBldmVyeXRoaW5nIGluIHBvc2l0aW9uXHJcbiAgICAgICAgICAgIGZvcmNlUmVmbG93KCk7XHJcbiAgICAgICAgICAgIG1vdmVkQ2hpbGRyZW4uZm9yRWFjaChjID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGVsID0gYy5lbDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHN0eWxlID0gZWwuc3R5bGU7XHJcbiAgICAgICAgICAgICAgICBhZGRUcmFuc2l0aW9uQ2xhc3MoZWwsIG1vdmVDbGFzcyk7XHJcbiAgICAgICAgICAgICAgICBzdHlsZS50cmFuc2Zvcm0gPSBzdHlsZS53ZWJraXRUcmFuc2Zvcm0gPSBzdHlsZS50cmFuc2l0aW9uRHVyYXRpb24gPSAnJztcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNiID0gKGVsLl9tb3ZlQ2IgPSAoZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlICYmIGUudGFyZ2V0ICE9PSBlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghZSB8fCAvdHJhbnNmb3JtJC8udGVzdChlLnByb3BlcnR5TmFtZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcigndHJhbnNpdGlvbmVuZCcsIGNiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZWwuX21vdmVDYiA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZVRyYW5zaXRpb25DbGFzcyhlbCwgbW92ZUNsYXNzKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ3RyYW5zaXRpb25lbmQnLCBjYik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJhd1Byb3BzID0gdG9SYXcocHJvcHMpO1xyXG4gICAgICAgICAgICBjb25zdCBjc3NUcmFuc2l0aW9uUHJvcHMgPSByZXNvbHZlVHJhbnNpdGlvblByb3BzKHJhd1Byb3BzKTtcclxuICAgICAgICAgICAgbGV0IHRhZyA9IHJhd1Byb3BzLnRhZyB8fCBGcmFnbWVudDtcclxuICAgICAgICAgICAgcHJldkNoaWxkcmVuID0gY2hpbGRyZW47XHJcbiAgICAgICAgICAgIGNoaWxkcmVuID0gc2xvdHMuZGVmYXVsdCA/IGdldFRyYW5zaXRpb25SYXdDaGlsZHJlbihzbG90cy5kZWZhdWx0KCkpIDogW107XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNoaWxkID0gY2hpbGRyZW5baV07XHJcbiAgICAgICAgICAgICAgICBpZiAoY2hpbGQua2V5ICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICBzZXRUcmFuc2l0aW9uSG9va3MoY2hpbGQsIHJlc29sdmVUcmFuc2l0aW9uSG9va3MoY2hpbGQsIGNzc1RyYW5zaXRpb25Qcm9wcywgc3RhdGUsIGluc3RhbmNlKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICAgICAgICAgICAgICB3YXJuKGA8VHJhbnNpdGlvbkdyb3VwPiBjaGlsZHJlbiBtdXN0IGJlIGtleWVkLmApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChwcmV2Q2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcHJldkNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hpbGQgPSBwcmV2Q2hpbGRyZW5baV07XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0VHJhbnNpdGlvbkhvb2tzKGNoaWxkLCByZXNvbHZlVHJhbnNpdGlvbkhvb2tzKGNoaWxkLCBjc3NUcmFuc2l0aW9uUHJvcHMsIHN0YXRlLCBpbnN0YW5jZSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uTWFwLnNldChjaGlsZCwgY2hpbGQuZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBjcmVhdGVWTm9kZSh0YWcsIG51bGwsIGNoaWxkcmVuKTtcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG59O1xyXG5jb25zdCBUcmFuc2l0aW9uR3JvdXAgPSBUcmFuc2l0aW9uR3JvdXBJbXBsO1xyXG5mdW5jdGlvbiBjYWxsUGVuZGluZ0NicyhjKSB7XHJcbiAgICBjb25zdCBlbCA9IGMuZWw7XHJcbiAgICBpZiAoZWwuX21vdmVDYikge1xyXG4gICAgICAgIGVsLl9tb3ZlQ2IoKTtcclxuICAgIH1cclxuICAgIGlmIChlbC5fZW50ZXJDYikge1xyXG4gICAgICAgIGVsLl9lbnRlckNiKCk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gcmVjb3JkUG9zaXRpb24oYykge1xyXG4gICAgbmV3UG9zaXRpb25NYXAuc2V0KGMsIGMuZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkpO1xyXG59XHJcbmZ1bmN0aW9uIGFwcGx5VHJhbnNsYXRpb24oYykge1xyXG4gICAgY29uc3Qgb2xkUG9zID0gcG9zaXRpb25NYXAuZ2V0KGMpO1xyXG4gICAgY29uc3QgbmV3UG9zID0gbmV3UG9zaXRpb25NYXAuZ2V0KGMpO1xyXG4gICAgY29uc3QgZHggPSBvbGRQb3MubGVmdCAtIG5ld1Bvcy5sZWZ0O1xyXG4gICAgY29uc3QgZHkgPSBvbGRQb3MudG9wIC0gbmV3UG9zLnRvcDtcclxuICAgIGlmIChkeCB8fCBkeSkge1xyXG4gICAgICAgIGNvbnN0IHMgPSBjLmVsLnN0eWxlO1xyXG4gICAgICAgIHMudHJhbnNmb3JtID0gcy53ZWJraXRUcmFuc2Zvcm0gPSBgdHJhbnNsYXRlKCR7ZHh9cHgsJHtkeX1weClgO1xyXG4gICAgICAgIHMudHJhbnNpdGlvbkR1cmF0aW9uID0gJzBzJztcclxuICAgICAgICByZXR1cm4gYztcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBoYXNDU1NUcmFuc2Zvcm0oZWwsIHJvb3QsIG1vdmVDbGFzcykge1xyXG4gICAgLy8gRGV0ZWN0IHdoZXRoZXIgYW4gZWxlbWVudCB3aXRoIHRoZSBtb3ZlIGNsYXNzIGFwcGxpZWQgaGFzXHJcbiAgICAvLyBDU1MgdHJhbnNpdGlvbnMuIFNpbmNlIHRoZSBlbGVtZW50IG1heSBiZSBpbnNpZGUgYW4gZW50ZXJpbmdcclxuICAgIC8vIHRyYW5zaXRpb24gYXQgdGhpcyB2ZXJ5IG1vbWVudCwgd2UgbWFrZSBhIGNsb25lIG9mIGl0IGFuZCByZW1vdmVcclxuICAgIC8vIGFsbCBvdGhlciB0cmFuc2l0aW9uIGNsYXNzZXMgYXBwbGllZCB0byBlbnN1cmUgb25seSB0aGUgbW92ZSBjbGFzc1xyXG4gICAgLy8gaXMgYXBwbGllZC5cclxuICAgIGNvbnN0IGNsb25lID0gZWwuY2xvbmVOb2RlKCk7XHJcbiAgICBpZiAoZWwuX3Z0Yykge1xyXG4gICAgICAgIGVsLl92dGMuZm9yRWFjaChjbHMgPT4ge1xyXG4gICAgICAgICAgICBjbHMuc3BsaXQoL1xccysvKS5mb3JFYWNoKGMgPT4gYyAmJiBjbG9uZS5jbGFzc0xpc3QucmVtb3ZlKGMpKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIG1vdmVDbGFzcy5zcGxpdCgvXFxzKy8pLmZvckVhY2goYyA9PiBjICYmIGNsb25lLmNsYXNzTGlzdC5hZGQoYykpO1xyXG4gICAgY2xvbmUuc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuICAgIGNvbnN0IGNvbnRhaW5lciA9IChyb290Lm5vZGVUeXBlID09PSAxID8gcm9vdCA6IHJvb3QucGFyZW50Tm9kZSk7XHJcbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoY2xvbmUpO1xyXG4gICAgY29uc3QgeyBoYXNUcmFuc2Zvcm0gfSA9IGdldFRyYW5zaXRpb25JbmZvKGNsb25lKTtcclxuICAgIGNvbnRhaW5lci5yZW1vdmVDaGlsZChjbG9uZSk7XHJcbiAgICByZXR1cm4gaGFzVHJhbnNmb3JtO1xyXG59XG5cbmNvbnN0IGdldE1vZGVsQXNzaWduZXIgPSAodm5vZGUpID0+IHtcclxuICAgIGNvbnN0IGZuID0gdm5vZGUucHJvcHNbJ29uVXBkYXRlOm1vZGVsVmFsdWUnXTtcclxuICAgIHJldHVybiBpc0FycmF5KGZuKSA/IHZhbHVlID0+IGludm9rZUFycmF5Rm5zKGZuLCB2YWx1ZSkgOiBmbjtcclxufTtcclxuZnVuY3Rpb24gb25Db21wb3NpdGlvblN0YXJ0KGUpIHtcclxuICAgIGUudGFyZ2V0LmNvbXBvc2luZyA9IHRydWU7XHJcbn1cclxuZnVuY3Rpb24gb25Db21wb3NpdGlvbkVuZChlKSB7XHJcbiAgICBjb25zdCB0YXJnZXQgPSBlLnRhcmdldDtcclxuICAgIGlmICh0YXJnZXQuY29tcG9zaW5nKSB7XHJcbiAgICAgICAgdGFyZ2V0LmNvbXBvc2luZyA9IGZhbHNlO1xyXG4gICAgICAgIHRyaWdnZXIodGFyZ2V0LCAnaW5wdXQnKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiB0cmlnZ2VyKGVsLCB0eXBlKSB7XHJcbiAgICBjb25zdCBlID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0hUTUxFdmVudHMnKTtcclxuICAgIGUuaW5pdEV2ZW50KHR5cGUsIHRydWUsIHRydWUpO1xyXG4gICAgZWwuZGlzcGF0Y2hFdmVudChlKTtcclxufVxyXG4vLyBXZSBhcmUgZXhwb3J0aW5nIHRoZSB2LW1vZGVsIHJ1bnRpbWUgZGlyZWN0bHkgYXMgdm5vZGUgaG9va3Mgc28gdGhhdCBpdCBjYW5cclxuLy8gYmUgdHJlZS1zaGFrZW4gaW4gY2FzZSB2LW1vZGVsIGlzIG5ldmVyIHVzZWQuXHJcbmNvbnN0IHZNb2RlbFRleHQgPSB7XHJcbiAgICBjcmVhdGVkKGVsLCB7IG1vZGlmaWVyczogeyBsYXp5LCB0cmltLCBudW1iZXIgfSB9LCB2bm9kZSkge1xyXG4gICAgICAgIGVsLl9hc3NpZ24gPSBnZXRNb2RlbEFzc2lnbmVyKHZub2RlKTtcclxuICAgICAgICBjb25zdCBjYXN0VG9OdW1iZXIgPSBudW1iZXIgfHwgKHZub2RlLnByb3BzICYmIHZub2RlLnByb3BzLnR5cGUgPT09ICdudW1iZXInKTtcclxuICAgICAgICBhZGRFdmVudExpc3RlbmVyKGVsLCBsYXp5ID8gJ2NoYW5nZScgOiAnaW5wdXQnLCBlID0+IHtcclxuICAgICAgICAgICAgaWYgKGUudGFyZ2V0LmNvbXBvc2luZylcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgbGV0IGRvbVZhbHVlID0gZWwudmFsdWU7XHJcbiAgICAgICAgICAgIGlmICh0cmltKSB7XHJcbiAgICAgICAgICAgICAgICBkb21WYWx1ZSA9IGRvbVZhbHVlLnRyaW0oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChjYXN0VG9OdW1iZXIpIHtcclxuICAgICAgICAgICAgICAgIGRvbVZhbHVlID0gdG9OdW1iZXIoZG9tVmFsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsLl9hc3NpZ24oZG9tVmFsdWUpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmICh0cmltKSB7XHJcbiAgICAgICAgICAgIGFkZEV2ZW50TGlzdGVuZXIoZWwsICdjaGFuZ2UnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBlbC52YWx1ZSA9IGVsLnZhbHVlLnRyaW0oKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghbGF6eSkge1xyXG4gICAgICAgICAgICBhZGRFdmVudExpc3RlbmVyKGVsLCAnY29tcG9zaXRpb25zdGFydCcsIG9uQ29tcG9zaXRpb25TdGFydCk7XHJcbiAgICAgICAgICAgIGFkZEV2ZW50TGlzdGVuZXIoZWwsICdjb21wb3NpdGlvbmVuZCcsIG9uQ29tcG9zaXRpb25FbmQpO1xyXG4gICAgICAgICAgICAvLyBTYWZhcmkgPCAxMC4yICYgVUlXZWJWaWV3IGRvZXNuJ3QgZmlyZSBjb21wb3NpdGlvbmVuZCB3aGVuXHJcbiAgICAgICAgICAgIC8vIHN3aXRjaGluZyBmb2N1cyBiZWZvcmUgY29uZmlybWluZyBjb21wb3NpdGlvbiBjaG9pY2VcclxuICAgICAgICAgICAgLy8gdGhpcyBhbHNvIGZpeGVzIHRoZSBpc3N1ZSB3aGVyZSBzb21lIGJyb3dzZXJzIGUuZy4gaU9TIENocm9tZVxyXG4gICAgICAgICAgICAvLyBmaXJlcyBcImNoYW5nZVwiIGluc3RlYWQgb2YgXCJpbnB1dFwiIG9uIGF1dG9jb21wbGV0ZS5cclxuICAgICAgICAgICAgYWRkRXZlbnRMaXN0ZW5lcihlbCwgJ2NoYW5nZScsIG9uQ29tcG9zaXRpb25FbmQpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvLyBzZXQgdmFsdWUgb24gbW91bnRlZCBzbyBpdCdzIGFmdGVyIG1pbi9tYXggZm9yIHR5cGU9XCJyYW5nZVwiXHJcbiAgICBtb3VudGVkKGVsLCB7IHZhbHVlIH0pIHtcclxuICAgICAgICBlbC52YWx1ZSA9IHZhbHVlID09IG51bGwgPyAnJyA6IHZhbHVlO1xyXG4gICAgfSxcclxuICAgIGJlZm9yZVVwZGF0ZShlbCwgeyB2YWx1ZSwgbW9kaWZpZXJzOiB7IGxhenksIHRyaW0sIG51bWJlciB9IH0sIHZub2RlKSB7XHJcbiAgICAgICAgZWwuX2Fzc2lnbiA9IGdldE1vZGVsQXNzaWduZXIodm5vZGUpO1xyXG4gICAgICAgIC8vIGF2b2lkIGNsZWFyaW5nIHVucmVzb2x2ZWQgdGV4dC4gIzIzMDJcclxuICAgICAgICBpZiAoZWwuY29tcG9zaW5nKVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgaWYgKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgPT09IGVsKSB7XHJcbiAgICAgICAgICAgIGlmIChsYXp5KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRyaW0gJiYgZWwudmFsdWUudHJpbSgpID09PSB2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICgobnVtYmVyIHx8IGVsLnR5cGUgPT09ICdudW1iZXInKSAmJiB0b051bWJlcihlbC52YWx1ZSkgPT09IHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgbmV3VmFsdWUgPSB2YWx1ZSA9PSBudWxsID8gJycgOiB2YWx1ZTtcclxuICAgICAgICBpZiAoZWwudmFsdWUgIT09IG5ld1ZhbHVlKSB7XHJcbiAgICAgICAgICAgIGVsLnZhbHVlID0gbmV3VmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG5jb25zdCB2TW9kZWxDaGVja2JveCA9IHtcclxuICAgIC8vICM0MDk2IGFycmF5IGNoZWNrYm94ZXMgbmVlZCB0byBiZSBkZWVwIHRyYXZlcnNlZFxyXG4gICAgZGVlcDogdHJ1ZSxcclxuICAgIGNyZWF0ZWQoZWwsIF8sIHZub2RlKSB7XHJcbiAgICAgICAgZWwuX2Fzc2lnbiA9IGdldE1vZGVsQXNzaWduZXIodm5vZGUpO1xyXG4gICAgICAgIGFkZEV2ZW50TGlzdGVuZXIoZWwsICdjaGFuZ2UnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vZGVsVmFsdWUgPSBlbC5fbW9kZWxWYWx1ZTtcclxuICAgICAgICAgICAgY29uc3QgZWxlbWVudFZhbHVlID0gZ2V0VmFsdWUoZWwpO1xyXG4gICAgICAgICAgICBjb25zdCBjaGVja2VkID0gZWwuY2hlY2tlZDtcclxuICAgICAgICAgICAgY29uc3QgYXNzaWduID0gZWwuX2Fzc2lnbjtcclxuICAgICAgICAgICAgaWYgKGlzQXJyYXkobW9kZWxWYWx1ZSkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gbG9vc2VJbmRleE9mKG1vZGVsVmFsdWUsIGVsZW1lbnRWYWx1ZSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBmb3VuZCA9IGluZGV4ICE9PSAtMTtcclxuICAgICAgICAgICAgICAgIGlmIChjaGVja2VkICYmICFmb3VuZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFzc2lnbihtb2RlbFZhbHVlLmNvbmNhdChlbGVtZW50VmFsdWUpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKCFjaGVja2VkICYmIGZvdW5kKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsdGVyZWQgPSBbLi4ubW9kZWxWYWx1ZV07XHJcbiAgICAgICAgICAgICAgICAgICAgZmlsdGVyZWQuc3BsaWNlKGluZGV4LCAxKTtcclxuICAgICAgICAgICAgICAgICAgICBhc3NpZ24oZmlsdGVyZWQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGlzU2V0KG1vZGVsVmFsdWUpKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjbG9uZWQgPSBuZXcgU2V0KG1vZGVsVmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGNoZWNrZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjbG9uZWQuYWRkKGVsZW1lbnRWYWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjbG9uZWQuZGVsZXRlKGVsZW1lbnRWYWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBhc3NpZ24oY2xvbmVkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGFzc2lnbihnZXRDaGVja2JveFZhbHVlKGVsLCBjaGVja2VkKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcbiAgICAvLyBzZXQgaW5pdGlhbCBjaGVja2VkIG9uIG1vdW50IHRvIHdhaXQgZm9yIHRydWUtdmFsdWUvZmFsc2UtdmFsdWVcclxuICAgIG1vdW50ZWQ6IHNldENoZWNrZWQsXHJcbiAgICBiZWZvcmVVcGRhdGUoZWwsIGJpbmRpbmcsIHZub2RlKSB7XHJcbiAgICAgICAgZWwuX2Fzc2lnbiA9IGdldE1vZGVsQXNzaWduZXIodm5vZGUpO1xyXG4gICAgICAgIHNldENoZWNrZWQoZWwsIGJpbmRpbmcsIHZub2RlKTtcclxuICAgIH1cclxufTtcclxuZnVuY3Rpb24gc2V0Q2hlY2tlZChlbCwgeyB2YWx1ZSwgb2xkVmFsdWUgfSwgdm5vZGUpIHtcclxuICAgIGVsLl9tb2RlbFZhbHVlID0gdmFsdWU7XHJcbiAgICBpZiAoaXNBcnJheSh2YWx1ZSkpIHtcclxuICAgICAgICBlbC5jaGVja2VkID0gbG9vc2VJbmRleE9mKHZhbHVlLCB2bm9kZS5wcm9wcy52YWx1ZSkgPiAtMTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGlzU2V0KHZhbHVlKSkge1xyXG4gICAgICAgIGVsLmNoZWNrZWQgPSB2YWx1ZS5oYXModm5vZGUucHJvcHMudmFsdWUpO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAodmFsdWUgIT09IG9sZFZhbHVlKSB7XHJcbiAgICAgICAgZWwuY2hlY2tlZCA9IGxvb3NlRXF1YWwodmFsdWUsIGdldENoZWNrYm94VmFsdWUoZWwsIHRydWUpKTtcclxuICAgIH1cclxufVxyXG5jb25zdCB2TW9kZWxSYWRpbyA9IHtcclxuICAgIGNyZWF0ZWQoZWwsIHsgdmFsdWUgfSwgdm5vZGUpIHtcclxuICAgICAgICBlbC5jaGVja2VkID0gbG9vc2VFcXVhbCh2YWx1ZSwgdm5vZGUucHJvcHMudmFsdWUpO1xyXG4gICAgICAgIGVsLl9hc3NpZ24gPSBnZXRNb2RlbEFzc2lnbmVyKHZub2RlKTtcclxuICAgICAgICBhZGRFdmVudExpc3RlbmVyKGVsLCAnY2hhbmdlJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBlbC5fYXNzaWduKGdldFZhbHVlKGVsKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG4gICAgYmVmb3JlVXBkYXRlKGVsLCB7IHZhbHVlLCBvbGRWYWx1ZSB9LCB2bm9kZSkge1xyXG4gICAgICAgIGVsLl9hc3NpZ24gPSBnZXRNb2RlbEFzc2lnbmVyKHZub2RlKTtcclxuICAgICAgICBpZiAodmFsdWUgIT09IG9sZFZhbHVlKSB7XHJcbiAgICAgICAgICAgIGVsLmNoZWNrZWQgPSBsb29zZUVxdWFsKHZhbHVlLCB2bm9kZS5wcm9wcy52YWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG5jb25zdCB2TW9kZWxTZWxlY3QgPSB7XHJcbiAgICAvLyA8c2VsZWN0IG11bHRpcGxlPiB2YWx1ZSBuZWVkIHRvIGJlIGRlZXAgdHJhdmVyc2VkXHJcbiAgICBkZWVwOiB0cnVlLFxyXG4gICAgY3JlYXRlZChlbCwgeyB2YWx1ZSwgbW9kaWZpZXJzOiB7IG51bWJlciB9IH0sIHZub2RlKSB7XHJcbiAgICAgICAgY29uc3QgaXNTZXRNb2RlbCA9IGlzU2V0KHZhbHVlKTtcclxuICAgICAgICBhZGRFdmVudExpc3RlbmVyKGVsLCAnY2hhbmdlJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBzZWxlY3RlZFZhbCA9IEFycmF5LnByb3RvdHlwZS5maWx0ZXJcclxuICAgICAgICAgICAgICAgIC5jYWxsKGVsLm9wdGlvbnMsIChvKSA9PiBvLnNlbGVjdGVkKVxyXG4gICAgICAgICAgICAgICAgLm1hcCgobykgPT4gbnVtYmVyID8gdG9OdW1iZXIoZ2V0VmFsdWUobykpIDogZ2V0VmFsdWUobykpO1xyXG4gICAgICAgICAgICBlbC5fYXNzaWduKGVsLm11bHRpcGxlXHJcbiAgICAgICAgICAgICAgICA/IGlzU2V0TW9kZWxcclxuICAgICAgICAgICAgICAgICAgICA/IG5ldyBTZXQoc2VsZWN0ZWRWYWwpXHJcbiAgICAgICAgICAgICAgICAgICAgOiBzZWxlY3RlZFZhbFxyXG4gICAgICAgICAgICAgICAgOiBzZWxlY3RlZFZhbFswXSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgZWwuX2Fzc2lnbiA9IGdldE1vZGVsQXNzaWduZXIodm5vZGUpO1xyXG4gICAgfSxcclxuICAgIC8vIHNldCB2YWx1ZSBpbiBtb3VudGVkICYgdXBkYXRlZCBiZWNhdXNlIDxzZWxlY3Q+IHJlbGllcyBvbiBpdHMgY2hpbGRyZW5cclxuICAgIC8vIDxvcHRpb24+cy5cclxuICAgIG1vdW50ZWQoZWwsIHsgdmFsdWUgfSkge1xyXG4gICAgICAgIHNldFNlbGVjdGVkKGVsLCB2YWx1ZSk7XHJcbiAgICB9LFxyXG4gICAgYmVmb3JlVXBkYXRlKGVsLCBfYmluZGluZywgdm5vZGUpIHtcclxuICAgICAgICBlbC5fYXNzaWduID0gZ2V0TW9kZWxBc3NpZ25lcih2bm9kZSk7XHJcbiAgICB9LFxyXG4gICAgdXBkYXRlZChlbCwgeyB2YWx1ZSB9KSB7XHJcbiAgICAgICAgc2V0U2VsZWN0ZWQoZWwsIHZhbHVlKTtcclxuICAgIH1cclxufTtcclxuZnVuY3Rpb24gc2V0U2VsZWN0ZWQoZWwsIHZhbHVlKSB7XHJcbiAgICBjb25zdCBpc011bHRpcGxlID0gZWwubXVsdGlwbGU7XHJcbiAgICBpZiAoaXNNdWx0aXBsZSAmJiAhaXNBcnJheSh2YWx1ZSkgJiYgIWlzU2V0KHZhbHVlKSkge1xyXG4gICAgICAgIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJlxyXG4gICAgICAgICAgICB3YXJuKGA8c2VsZWN0IG11bHRpcGxlIHYtbW9kZWw+IGV4cGVjdHMgYW4gQXJyYXkgb3IgU2V0IHZhbHVlIGZvciBpdHMgYmluZGluZywgYCArXHJcbiAgICAgICAgICAgICAgICBgYnV0IGdvdCAke09iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh2YWx1ZSkuc2xpY2UoOCwgLTEpfS5gKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBmb3IgKGxldCBpID0gMCwgbCA9IGVsLm9wdGlvbnMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XHJcbiAgICAgICAgY29uc3Qgb3B0aW9uID0gZWwub3B0aW9uc1tpXTtcclxuICAgICAgICBjb25zdCBvcHRpb25WYWx1ZSA9IGdldFZhbHVlKG9wdGlvbik7XHJcbiAgICAgICAgaWYgKGlzTXVsdGlwbGUpIHtcclxuICAgICAgICAgICAgaWYgKGlzQXJyYXkodmFsdWUpKSB7XHJcbiAgICAgICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBsb29zZUluZGV4T2YodmFsdWUsIG9wdGlvblZhbHVlKSA+IC0xO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gdmFsdWUuaGFzKG9wdGlvblZhbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKGxvb3NlRXF1YWwoZ2V0VmFsdWUob3B0aW9uKSwgdmFsdWUpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZWwuc2VsZWN0ZWRJbmRleCAhPT0gaSlcclxuICAgICAgICAgICAgICAgICAgICBlbC5zZWxlY3RlZEluZGV4ID0gaTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGlmICghaXNNdWx0aXBsZSAmJiBlbC5zZWxlY3RlZEluZGV4ICE9PSAtMSkge1xyXG4gICAgICAgIGVsLnNlbGVjdGVkSW5kZXggPSAtMTtcclxuICAgIH1cclxufVxyXG4vLyByZXRyaWV2ZSByYXcgdmFsdWUgc2V0IHZpYSA6dmFsdWUgYmluZGluZ3NcclxuZnVuY3Rpb24gZ2V0VmFsdWUoZWwpIHtcclxuICAgIHJldHVybiAnX3ZhbHVlJyBpbiBlbCA/IGVsLl92YWx1ZSA6IGVsLnZhbHVlO1xyXG59XHJcbi8vIHJldHJpZXZlIHJhdyB2YWx1ZSBmb3IgdHJ1ZS12YWx1ZSBhbmQgZmFsc2UtdmFsdWUgc2V0IHZpYSA6dHJ1ZS12YWx1ZSBvciA6ZmFsc2UtdmFsdWUgYmluZGluZ3NcclxuZnVuY3Rpb24gZ2V0Q2hlY2tib3hWYWx1ZShlbCwgY2hlY2tlZCkge1xyXG4gICAgY29uc3Qga2V5ID0gY2hlY2tlZCA/ICdfdHJ1ZVZhbHVlJyA6ICdfZmFsc2VWYWx1ZSc7XHJcbiAgICByZXR1cm4ga2V5IGluIGVsID8gZWxba2V5XSA6IGNoZWNrZWQ7XHJcbn1cclxuY29uc3Qgdk1vZGVsRHluYW1pYyA9IHtcclxuICAgIGNyZWF0ZWQoZWwsIGJpbmRpbmcsIHZub2RlKSB7XHJcbiAgICAgICAgY2FsbE1vZGVsSG9vayhlbCwgYmluZGluZywgdm5vZGUsIG51bGwsICdjcmVhdGVkJyk7XHJcbiAgICB9LFxyXG4gICAgbW91bnRlZChlbCwgYmluZGluZywgdm5vZGUpIHtcclxuICAgICAgICBjYWxsTW9kZWxIb29rKGVsLCBiaW5kaW5nLCB2bm9kZSwgbnVsbCwgJ21vdW50ZWQnKTtcclxuICAgIH0sXHJcbiAgICBiZWZvcmVVcGRhdGUoZWwsIGJpbmRpbmcsIHZub2RlLCBwcmV2Vk5vZGUpIHtcclxuICAgICAgICBjYWxsTW9kZWxIb29rKGVsLCBiaW5kaW5nLCB2bm9kZSwgcHJldlZOb2RlLCAnYmVmb3JlVXBkYXRlJyk7XHJcbiAgICB9LFxyXG4gICAgdXBkYXRlZChlbCwgYmluZGluZywgdm5vZGUsIHByZXZWTm9kZSkge1xyXG4gICAgICAgIGNhbGxNb2RlbEhvb2soZWwsIGJpbmRpbmcsIHZub2RlLCBwcmV2Vk5vZGUsICd1cGRhdGVkJyk7XHJcbiAgICB9XHJcbn07XHJcbmZ1bmN0aW9uIGNhbGxNb2RlbEhvb2soZWwsIGJpbmRpbmcsIHZub2RlLCBwcmV2Vk5vZGUsIGhvb2spIHtcclxuICAgIGxldCBtb2RlbFRvVXNlO1xyXG4gICAgc3dpdGNoIChlbC50YWdOYW1lKSB7XHJcbiAgICAgICAgY2FzZSAnU0VMRUNUJzpcclxuICAgICAgICAgICAgbW9kZWxUb1VzZSA9IHZNb2RlbFNlbGVjdDtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAnVEVYVEFSRUEnOlxyXG4gICAgICAgICAgICBtb2RlbFRvVXNlID0gdk1vZGVsVGV4dDtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgc3dpdGNoICh2bm9kZS5wcm9wcyAmJiB2bm9kZS5wcm9wcy50eXBlKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdjaGVja2JveCc6XHJcbiAgICAgICAgICAgICAgICAgICAgbW9kZWxUb1VzZSA9IHZNb2RlbENoZWNrYm94O1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAncmFkaW8nOlxyXG4gICAgICAgICAgICAgICAgICAgIG1vZGVsVG9Vc2UgPSB2TW9kZWxSYWRpbztcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgbW9kZWxUb1VzZSA9IHZNb2RlbFRleHQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgIH1cclxuICAgIGNvbnN0IGZuID0gbW9kZWxUb1VzZVtob29rXTtcclxuICAgIGZuICYmIGZuKGVsLCBiaW5kaW5nLCB2bm9kZSwgcHJldlZOb2RlKTtcclxufVxyXG4vLyBTU1Igdm5vZGUgdHJhbnNmb3Jtcywgb25seSB1c2VkIHdoZW4gdXNlciBpbmNsdWRlcyBjbGllbnQtb3JpZW50ZWQgcmVuZGVyXHJcbi8vIGZ1bmN0aW9uIGluIFNTUlxyXG5mdW5jdGlvbiBpbml0Vk1vZGVsRm9yU1NSKCkge1xyXG4gICAgdk1vZGVsVGV4dC5nZXRTU1JQcm9wcyA9ICh7IHZhbHVlIH0pID0+ICh7IHZhbHVlIH0pO1xyXG4gICAgdk1vZGVsUmFkaW8uZ2V0U1NSUHJvcHMgPSAoeyB2YWx1ZSB9LCB2bm9kZSkgPT4ge1xyXG4gICAgICAgIGlmICh2bm9kZS5wcm9wcyAmJiBsb29zZUVxdWFsKHZub2RlLnByb3BzLnZhbHVlLCB2YWx1ZSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHsgY2hlY2tlZDogdHJ1ZSB9O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICB2TW9kZWxDaGVja2JveC5nZXRTU1JQcm9wcyA9ICh7IHZhbHVlIH0sIHZub2RlKSA9PiB7XHJcbiAgICAgICAgaWYgKGlzQXJyYXkodmFsdWUpKSB7XHJcbiAgICAgICAgICAgIGlmICh2bm9kZS5wcm9wcyAmJiBsb29zZUluZGV4T2YodmFsdWUsIHZub2RlLnByb3BzLnZhbHVlKSA+IC0xKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4geyBjaGVja2VkOiB0cnVlIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoaXNTZXQodmFsdWUpKSB7XHJcbiAgICAgICAgICAgIGlmICh2bm9kZS5wcm9wcyAmJiB2YWx1ZS5oYXModm5vZGUucHJvcHMudmFsdWUpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4geyBjaGVja2VkOiB0cnVlIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodmFsdWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHsgY2hlY2tlZDogdHJ1ZSB9O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn1cblxuY29uc3Qgc3lzdGVtTW9kaWZpZXJzID0gWydjdHJsJywgJ3NoaWZ0JywgJ2FsdCcsICdtZXRhJ107XHJcbmNvbnN0IG1vZGlmaWVyR3VhcmRzID0ge1xyXG4gICAgc3RvcDogZSA9PiBlLnN0b3BQcm9wYWdhdGlvbigpLFxyXG4gICAgcHJldmVudDogZSA9PiBlLnByZXZlbnREZWZhdWx0KCksXHJcbiAgICBzZWxmOiBlID0+IGUudGFyZ2V0ICE9PSBlLmN1cnJlbnRUYXJnZXQsXHJcbiAgICBjdHJsOiBlID0+ICFlLmN0cmxLZXksXHJcbiAgICBzaGlmdDogZSA9PiAhZS5zaGlmdEtleSxcclxuICAgIGFsdDogZSA9PiAhZS5hbHRLZXksXHJcbiAgICBtZXRhOiBlID0+ICFlLm1ldGFLZXksXHJcbiAgICBsZWZ0OiBlID0+ICdidXR0b24nIGluIGUgJiYgZS5idXR0b24gIT09IDAsXHJcbiAgICBtaWRkbGU6IGUgPT4gJ2J1dHRvbicgaW4gZSAmJiBlLmJ1dHRvbiAhPT0gMSxcclxuICAgIHJpZ2h0OiBlID0+ICdidXR0b24nIGluIGUgJiYgZS5idXR0b24gIT09IDIsXHJcbiAgICBleGFjdDogKGUsIG1vZGlmaWVycykgPT4gc3lzdGVtTW9kaWZpZXJzLnNvbWUobSA9PiBlW2Ake219S2V5YF0gJiYgIW1vZGlmaWVycy5pbmNsdWRlcyhtKSlcclxufTtcclxuLyoqXHJcbiAqIEBwcml2YXRlXHJcbiAqL1xyXG5jb25zdCB3aXRoTW9kaWZpZXJzID0gKGZuLCBtb2RpZmllcnMpID0+IHtcclxuICAgIHJldHVybiAoZXZlbnQsIC4uLmFyZ3MpID0+IHtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG1vZGlmaWVycy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBjb25zdCBndWFyZCA9IG1vZGlmaWVyR3VhcmRzW21vZGlmaWVyc1tpXV07XHJcbiAgICAgICAgICAgIGlmIChndWFyZCAmJiBndWFyZChldmVudCwgbW9kaWZpZXJzKSlcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZuKGV2ZW50LCAuLi5hcmdzKTtcclxuICAgIH07XHJcbn07XHJcbi8vIEtlcHQgZm9yIDIueCBjb21wYXQuXHJcbi8vIE5vdGU6IElFMTEgY29tcGF0IGZvciBgc3BhY2ViYXJgIGFuZCBgZGVsYCBpcyByZW1vdmVkIGZvciBub3cuXHJcbmNvbnN0IGtleU5hbWVzID0ge1xyXG4gICAgZXNjOiAnZXNjYXBlJyxcclxuICAgIHNwYWNlOiAnICcsXHJcbiAgICB1cDogJ2Fycm93LXVwJyxcclxuICAgIGxlZnQ6ICdhcnJvdy1sZWZ0JyxcclxuICAgIHJpZ2h0OiAnYXJyb3ctcmlnaHQnLFxyXG4gICAgZG93bjogJ2Fycm93LWRvd24nLFxyXG4gICAgZGVsZXRlOiAnYmFja3NwYWNlJ1xyXG59O1xyXG4vKipcclxuICogQHByaXZhdGVcclxuICovXHJcbmNvbnN0IHdpdGhLZXlzID0gKGZuLCBtb2RpZmllcnMpID0+IHtcclxuICAgIHJldHVybiAoZXZlbnQpID0+IHtcclxuICAgICAgICBpZiAoISgna2V5JyBpbiBldmVudCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBldmVudEtleSA9IGh5cGhlbmF0ZShldmVudC5rZXkpO1xyXG4gICAgICAgIGlmIChtb2RpZmllcnMuc29tZShrID0+IGsgPT09IGV2ZW50S2V5IHx8IGtleU5hbWVzW2tdID09PSBldmVudEtleSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZuKGV2ZW50KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59O1xuXG5jb25zdCB2U2hvdyA9IHtcclxuICAgIGJlZm9yZU1vdW50KGVsLCB7IHZhbHVlIH0sIHsgdHJhbnNpdGlvbiB9KSB7XHJcbiAgICAgICAgZWwuX3ZvZCA9IGVsLnN0eWxlLmRpc3BsYXkgPT09ICdub25lJyA/ICcnIDogZWwuc3R5bGUuZGlzcGxheTtcclxuICAgICAgICBpZiAodHJhbnNpdGlvbiAmJiB2YWx1ZSkge1xyXG4gICAgICAgICAgICB0cmFuc2l0aW9uLmJlZm9yZUVudGVyKGVsKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHNldERpc3BsYXkoZWwsIHZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgbW91bnRlZChlbCwgeyB2YWx1ZSB9LCB7IHRyYW5zaXRpb24gfSkge1xyXG4gICAgICAgIGlmICh0cmFuc2l0aW9uICYmIHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHRyYW5zaXRpb24uZW50ZXIoZWwpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICB1cGRhdGVkKGVsLCB7IHZhbHVlLCBvbGRWYWx1ZSB9LCB7IHRyYW5zaXRpb24gfSkge1xyXG4gICAgICAgIGlmICghdmFsdWUgPT09ICFvbGRWYWx1ZSlcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIGlmICh0cmFuc2l0aW9uKSB7XHJcbiAgICAgICAgICAgIGlmICh2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgdHJhbnNpdGlvbi5iZWZvcmVFbnRlcihlbCk7XHJcbiAgICAgICAgICAgICAgICBzZXREaXNwbGF5KGVsLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgIHRyYW5zaXRpb24uZW50ZXIoZWwpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdHJhbnNpdGlvbi5sZWF2ZShlbCwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHNldERpc3BsYXkoZWwsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBzZXREaXNwbGF5KGVsLCB2YWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGJlZm9yZVVubW91bnQoZWwsIHsgdmFsdWUgfSkge1xyXG4gICAgICAgIHNldERpc3BsYXkoZWwsIHZhbHVlKTtcclxuICAgIH1cclxufTtcclxuZnVuY3Rpb24gc2V0RGlzcGxheShlbCwgdmFsdWUpIHtcclxuICAgIGVsLnN0eWxlLmRpc3BsYXkgPSB2YWx1ZSA/IGVsLl92b2QgOiAnbm9uZSc7XHJcbn1cclxuLy8gU1NSIHZub2RlIHRyYW5zZm9ybXMsIG9ubHkgdXNlZCB3aGVuIHVzZXIgaW5jbHVkZXMgY2xpZW50LW9yaWVudGVkIHJlbmRlclxyXG4vLyBmdW5jdGlvbiBpbiBTU1JcclxuZnVuY3Rpb24gaW5pdFZTaG93Rm9yU1NSKCkge1xyXG4gICAgdlNob3cuZ2V0U1NSUHJvcHMgPSAoeyB2YWx1ZSB9KSA9PiB7XHJcbiAgICAgICAgaWYgKCF2YWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4geyBzdHlsZTogeyBkaXNwbGF5OiAnbm9uZScgfSB9O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn1cblxuY29uc3QgcmVuZGVyZXJPcHRpb25zID0gZXh0ZW5kKHsgcGF0Y2hQcm9wIH0sIG5vZGVPcHMpO1xyXG4vLyBsYXp5IGNyZWF0ZSB0aGUgcmVuZGVyZXIgLSB0aGlzIG1ha2VzIGNvcmUgcmVuZGVyZXIgbG9naWMgdHJlZS1zaGFrYWJsZVxyXG4vLyBpbiBjYXNlIHRoZSB1c2VyIG9ubHkgaW1wb3J0cyByZWFjdGl2aXR5IHV0aWxpdGllcyBmcm9tIFZ1ZS5cclxubGV0IHJlbmRlcmVyO1xyXG5sZXQgZW5hYmxlZEh5ZHJhdGlvbiA9IGZhbHNlO1xyXG5mdW5jdGlvbiBlbnN1cmVSZW5kZXJlcigpIHtcclxuICAgIHJldHVybiAocmVuZGVyZXIgfHxcclxuICAgICAgICAocmVuZGVyZXIgPSBjcmVhdGVSZW5kZXJlcihyZW5kZXJlck9wdGlvbnMpKSk7XHJcbn1cclxuZnVuY3Rpb24gZW5zdXJlSHlkcmF0aW9uUmVuZGVyZXIoKSB7XHJcbiAgICByZW5kZXJlciA9IGVuYWJsZWRIeWRyYXRpb25cclxuICAgICAgICA/IHJlbmRlcmVyXHJcbiAgICAgICAgOiBjcmVhdGVIeWRyYXRpb25SZW5kZXJlcihyZW5kZXJlck9wdGlvbnMpO1xyXG4gICAgZW5hYmxlZEh5ZHJhdGlvbiA9IHRydWU7XHJcbiAgICByZXR1cm4gcmVuZGVyZXI7XHJcbn1cclxuLy8gdXNlIGV4cGxpY2l0IHR5cGUgY2FzdHMgaGVyZSB0byBhdm9pZCBpbXBvcnQoKSBjYWxscyBpbiByb2xsZWQtdXAgZC50c1xyXG5jb25zdCByZW5kZXIgPSAoKC4uLmFyZ3MpID0+IHtcclxuICAgIGVuc3VyZVJlbmRlcmVyKCkucmVuZGVyKC4uLmFyZ3MpO1xyXG59KTtcclxuY29uc3QgaHlkcmF0ZSA9ICgoLi4uYXJncykgPT4ge1xyXG4gICAgZW5zdXJlSHlkcmF0aW9uUmVuZGVyZXIoKS5oeWRyYXRlKC4uLmFyZ3MpO1xyXG59KTtcclxuY29uc3QgY3JlYXRlQXBwID0gKCguLi5hcmdzKSA9PiB7XHJcbiAgICBjb25zdCBhcHAgPSBlbnN1cmVSZW5kZXJlcigpLmNyZWF0ZUFwcCguLi5hcmdzKTtcclxuICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykpIHtcclxuICAgICAgICBpbmplY3ROYXRpdmVUYWdDaGVjayhhcHApO1xyXG4gICAgICAgIGluamVjdENvbXBpbGVyT3B0aW9uc0NoZWNrKGFwcCk7XHJcbiAgICB9XHJcbiAgICBjb25zdCB7IG1vdW50IH0gPSBhcHA7XHJcbiAgICBhcHAubW91bnQgPSAoY29udGFpbmVyT3JTZWxlY3RvcikgPT4ge1xyXG4gICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IG5vcm1hbGl6ZUNvbnRhaW5lcihjb250YWluZXJPclNlbGVjdG9yKTtcclxuICAgICAgICBpZiAoIWNvbnRhaW5lcilcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIGNvbnN0IGNvbXBvbmVudCA9IGFwcC5fY29tcG9uZW50O1xyXG4gICAgICAgIGlmICghaXNGdW5jdGlvbihjb21wb25lbnQpICYmICFjb21wb25lbnQucmVuZGVyICYmICFjb21wb25lbnQudGVtcGxhdGUpIHtcclxuICAgICAgICAgICAgLy8gX19VTlNBRkVfX1xyXG4gICAgICAgICAgICAvLyBSZWFzb246IHBvdGVudGlhbCBleGVjdXRpb24gb2YgSlMgZXhwcmVzc2lvbnMgaW4gaW4tRE9NIHRlbXBsYXRlLlxyXG4gICAgICAgICAgICAvLyBUaGUgdXNlciBtdXN0IG1ha2Ugc3VyZSB0aGUgaW4tRE9NIHRlbXBsYXRlIGlzIHRydXN0ZWQuIElmIGl0J3NcclxuICAgICAgICAgICAgLy8gcmVuZGVyZWQgYnkgdGhlIHNlcnZlciwgdGhlIHRlbXBsYXRlIHNob3VsZCBub3QgY29udGFpbiBhbnkgdXNlciBkYXRhLlxyXG4gICAgICAgICAgICBjb21wb25lbnQudGVtcGxhdGUgPSBjb250YWluZXIuaW5uZXJIVE1MO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBjbGVhciBjb250ZW50IGJlZm9yZSBtb3VudGluZ1xyXG4gICAgICAgIGNvbnRhaW5lci5pbm5lckhUTUwgPSAnJztcclxuICAgICAgICBjb25zdCBwcm94eSA9IG1vdW50KGNvbnRhaW5lciwgZmFsc2UsIGNvbnRhaW5lciBpbnN0YW5jZW9mIFNWR0VsZW1lbnQpO1xyXG4gICAgICAgIGlmIChjb250YWluZXIgaW5zdGFuY2VvZiBFbGVtZW50KSB7XHJcbiAgICAgICAgICAgIGNvbnRhaW5lci5yZW1vdmVBdHRyaWJ1dGUoJ3YtY2xvYWsnKTtcclxuICAgICAgICAgICAgY29udGFpbmVyLnNldEF0dHJpYnV0ZSgnZGF0YS12LWFwcCcsICcnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHByb3h5O1xyXG4gICAgfTtcclxuICAgIHJldHVybiBhcHA7XHJcbn0pO1xyXG5jb25zdCBjcmVhdGVTU1JBcHAgPSAoKC4uLmFyZ3MpID0+IHtcclxuICAgIGNvbnN0IGFwcCA9IGVuc3VyZUh5ZHJhdGlvblJlbmRlcmVyKCkuY3JlYXRlQXBwKC4uLmFyZ3MpO1xyXG4gICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSkge1xyXG4gICAgICAgIGluamVjdE5hdGl2ZVRhZ0NoZWNrKGFwcCk7XHJcbiAgICAgICAgaW5qZWN0Q29tcGlsZXJPcHRpb25zQ2hlY2soYXBwKTtcclxuICAgIH1cclxuICAgIGNvbnN0IHsgbW91bnQgfSA9IGFwcDtcclxuICAgIGFwcC5tb3VudCA9IChjb250YWluZXJPclNlbGVjdG9yKSA9PiB7XHJcbiAgICAgICAgY29uc3QgY29udGFpbmVyID0gbm9ybWFsaXplQ29udGFpbmVyKGNvbnRhaW5lck9yU2VsZWN0b3IpO1xyXG4gICAgICAgIGlmIChjb250YWluZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG1vdW50KGNvbnRhaW5lciwgdHJ1ZSwgY29udGFpbmVyIGluc3RhbmNlb2YgU1ZHRWxlbWVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBhcHA7XHJcbn0pO1xyXG5mdW5jdGlvbiBpbmplY3ROYXRpdmVUYWdDaGVjayhhcHApIHtcclxuICAgIC8vIEluamVjdCBgaXNOYXRpdmVUYWdgXHJcbiAgICAvLyB0aGlzIGlzIHVzZWQgZm9yIGNvbXBvbmVudCBuYW1lIHZhbGlkYXRpb24gKGRldiBvbmx5KVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGFwcC5jb25maWcsICdpc05hdGl2ZVRhZycsIHtcclxuICAgICAgICB2YWx1ZTogKHRhZykgPT4gaXNIVE1MVGFnKHRhZykgfHwgaXNTVkdUYWcodGFnKSxcclxuICAgICAgICB3cml0YWJsZTogZmFsc2VcclxuICAgIH0pO1xyXG59XHJcbi8vIGRldiBvbmx5XHJcbmZ1bmN0aW9uIGluamVjdENvbXBpbGVyT3B0aW9uc0NoZWNrKGFwcCkge1xyXG4gICAgaWYgKGlzUnVudGltZU9ubHkoKSkge1xyXG4gICAgICAgIGNvbnN0IGlzQ3VzdG9tRWxlbWVudCA9IGFwcC5jb25maWcuaXNDdXN0b21FbGVtZW50O1xyXG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShhcHAuY29uZmlnLCAnaXNDdXN0b21FbGVtZW50Jywge1xyXG4gICAgICAgICAgICBnZXQoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaXNDdXN0b21FbGVtZW50O1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBzZXQoKSB7XHJcbiAgICAgICAgICAgICAgICB3YXJuKGBUaGUgXFxgaXNDdXN0b21FbGVtZW50XFxgIGNvbmZpZyBvcHRpb24gaXMgZGVwcmVjYXRlZC4gVXNlIGAgK1xyXG4gICAgICAgICAgICAgICAgICAgIGBcXGBjb21waWxlck9wdGlvbnMuaXNDdXN0b21FbGVtZW50XFxgIGluc3RlYWQuYCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBjb25zdCBjb21waWxlck9wdGlvbnMgPSBhcHAuY29uZmlnLmNvbXBpbGVyT3B0aW9ucztcclxuICAgICAgICBjb25zdCBtc2cgPSBgVGhlIFxcYGNvbXBpbGVyT3B0aW9uc1xcYCBjb25maWcgb3B0aW9uIGlzIG9ubHkgcmVzcGVjdGVkIHdoZW4gdXNpbmcgYCArXHJcbiAgICAgICAgICAgIGBhIGJ1aWxkIG9mIFZ1ZS5qcyB0aGF0IGluY2x1ZGVzIHRoZSBydW50aW1lIGNvbXBpbGVyIChha2EgXCJmdWxsIGJ1aWxkXCIpLiBgICtcclxuICAgICAgICAgICAgYFNpbmNlIHlvdSBhcmUgdXNpbmcgdGhlIHJ1bnRpbWUtb25seSBidWlsZCwgXFxgY29tcGlsZXJPcHRpb25zXFxgIGAgK1xyXG4gICAgICAgICAgICBgbXVzdCBiZSBwYXNzZWQgdG8gXFxgQHZ1ZS9jb21waWxlci1kb21cXGAgaW4gdGhlIGJ1aWxkIHNldHVwIGluc3RlYWQuXFxuYCArXHJcbiAgICAgICAgICAgIGAtIEZvciB2dWUtbG9hZGVyOiBwYXNzIGl0IHZpYSB2dWUtbG9hZGVyJ3MgXFxgY29tcGlsZXJPcHRpb25zXFxgIGxvYWRlciBvcHRpb24uXFxuYCArXHJcbiAgICAgICAgICAgIGAtIEZvciB2dWUtY2xpOiBzZWUgaHR0cHM6Ly9jbGkudnVlanMub3JnL2d1aWRlL3dlYnBhY2suaHRtbCNtb2RpZnlpbmctb3B0aW9ucy1vZi1hLWxvYWRlclxcbmAgK1xyXG4gICAgICAgICAgICBgLSBGb3Igdml0ZTogcGFzcyBpdCB2aWEgQHZpdGVqcy9wbHVnaW4tdnVlIG9wdGlvbnMuIFNlZSBodHRwczovL2dpdGh1Yi5jb20vdml0ZWpzL3ZpdGUvdHJlZS9tYWluL3BhY2thZ2VzL3BsdWdpbi12dWUjZXhhbXBsZS1mb3ItcGFzc2luZy1vcHRpb25zLXRvLXZ1ZWNvbXBpbGVyLWRvbWA7XHJcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGFwcC5jb25maWcsICdjb21waWxlck9wdGlvbnMnLCB7XHJcbiAgICAgICAgICAgIGdldCgpIHtcclxuICAgICAgICAgICAgICAgIHdhcm4obXNnKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjb21waWxlck9wdGlvbnM7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHNldCgpIHtcclxuICAgICAgICAgICAgICAgIHdhcm4obXNnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIG5vcm1hbGl6ZUNvbnRhaW5lcihjb250YWluZXIpIHtcclxuICAgIGlmIChpc1N0cmluZyhjb250YWluZXIpKSB7XHJcbiAgICAgICAgY29uc3QgcmVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXIpO1xyXG4gICAgICAgIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgJiYgIXJlcykge1xyXG4gICAgICAgICAgICB3YXJuKGBGYWlsZWQgdG8gbW91bnQgYXBwOiBtb3VudCB0YXJnZXQgc2VsZWN0b3IgXCIke2NvbnRhaW5lcn1cIiByZXR1cm5lZCBudWxsLmApO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzO1xyXG4gICAgfVxyXG4gICAgaWYgKChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSAmJlxyXG4gICAgICAgIHdpbmRvdy5TaGFkb3dSb290ICYmXHJcbiAgICAgICAgY29udGFpbmVyIGluc3RhbmNlb2Ygd2luZG93LlNoYWRvd1Jvb3QgJiZcclxuICAgICAgICBjb250YWluZXIubW9kZSA9PT0gJ2Nsb3NlZCcpIHtcclxuICAgICAgICB3YXJuKGBtb3VudGluZyBvbiBhIFNoYWRvd1Jvb3Qgd2l0aCBcXGB7bW9kZTogXCJjbG9zZWRcIn1cXGAgbWF5IGxlYWQgdG8gdW5wcmVkaWN0YWJsZSBidWdzYCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gY29udGFpbmVyO1xyXG59XHJcbmxldCBzc3JEaXJlY3RpdmVJbml0aWFsaXplZCA9IGZhbHNlO1xyXG4vKipcclxuICogQGludGVybmFsXHJcbiAqL1xyXG5jb25zdCBpbml0RGlyZWN0aXZlc0ZvclNTUiA9ICgpID0+IHtcclxuICAgICAgICBpZiAoIXNzckRpcmVjdGl2ZUluaXRpYWxpemVkKSB7XHJcbiAgICAgICAgICAgIHNzckRpcmVjdGl2ZUluaXRpYWxpemVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgaW5pdFZNb2RlbEZvclNTUigpO1xyXG4gICAgICAgICAgICBpbml0VlNob3dGb3JTU1IoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICA7XG5cbmV4cG9ydCB7IFRyYW5zaXRpb24sIFRyYW5zaXRpb25Hcm91cCwgVnVlRWxlbWVudCwgY3JlYXRlQXBwLCBjcmVhdGVTU1JBcHAsIGRlZmluZUN1c3RvbUVsZW1lbnQsIGRlZmluZVNTUkN1c3RvbUVsZW1lbnQsIGh5ZHJhdGUsIGluaXREaXJlY3RpdmVzRm9yU1NSLCByZW5kZXIsIHVzZUNzc01vZHVsZSwgdXNlQ3NzVmFycywgdk1vZGVsQ2hlY2tib3gsIHZNb2RlbER5bmFtaWMsIHZNb2RlbFJhZGlvLCB2TW9kZWxTZWxlY3QsIHZNb2RlbFRleHQsIHZTaG93LCB3aXRoS2V5cywgd2l0aE1vZGlmaWVycyB9O1xuIiwiXG5jb25zb2xlLmFzc2VydCA9IChjb25kaXRpb24sIG1zZykgPT4ge1xuICBpZighY29uZGl0aW9uKSB7XG4gICAgLy8gY29uc29sZS5sb2coLi4ubXNnKTtcbiAgICBjb25zb2xlLmxvZyhuZXcgRXJyb3IobXNnKSk7XG4gIH1cbn1cblxuY29uc3Qgbm8gPSBvID0+IG8gJiYgSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShvKSk7IC8vIG5vcm1hbGl6ZSAoYW5kIGZyZWV6ZSkgb2JqZWN0IGZvciBjb25zb2xlIG91dHB1dCAoY2FuJ3QgaGFuZGxlIGN5Y2xpYyBvYmplY3RzKVxuXG5mdW5jdGlvbiBsYXN0KGFycikge1xuICByZXR1cm4gYXJyW2Fyci5sZW5ndGggLSAxXTtcbn1cblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0gaWQgLS0tLS0tLS0tLS0tLS0tLS0tXG5cbmNvbnN0IHN5bWJvbHMgPSAnMDk4NzY1NDMyMWFiY2RlZmdoaWprbG1ub3Byc3R1dnl6JztcblxuZXhwb3J0IGZ1bmN0aW9uIHJhbmRvbUlEKG49NCkge1xuICBjb25zdCBsID0gc3ltYm9scy5sZW5ndGg7XG4gIGNvbnN0IGsgPSBNYXRoLnBvdyhsLCBuKTtcbiAgLy8gbGV0IHIgPSByYW5kSW50KGspXG4gIGxldCByID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogayk7XG4gIGNvbnN0IGlkID0gW107XG4gIGZvcihsZXQgaT0wOyBpPG47IGkrPTEpIHtcbiAgICBpZC5wdXNoKHN5bWJvbHNbciAlIGxdKVxuICAgIHIgPSBNYXRoLmZsb29yKHIgLyBsKVxuICB9XG4gIHJldHVybiBpZC5qb2luKCcnKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG5ld0lEKHBhcmVudElEKSB7XG4gIHJldHVybiByYW5kb21JRCgpO1xufVxuXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vIERPTSBvbmx5IC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4vLyBwYXJzZSBnZW5lcmFsIERPTSAoZXh0cmFjdCBwYXJhZ3JhcGhzIGFuZCBzcGFucyB3aXRoIGZvcm1hdHRpbmdcbmV4cG9ydCBmdW5jdGlvbiBwYXJzZVZhbmlsbGFET00ocm9vdE5vZGUsIGNzc1J1bGVzKSB7XG5cbiAgbGV0IHVuZGVybGluZUNsYXNzZXMgPSBbXTtcblxuICBpZihjc3NSdWxlcykge1xuICAgIGZvcihjb25zdCBydWxlIG9mIGNzc1J1bGVzKSB7XG4gICAgICBpZihydWxlLnNlbGVjdG9yVGV4dC5zZWFyY2goL1sjOlxcW1xcXT5dL2cpICE9PSAtMSkge1xuICAgICAgICAvLyBza2lwIHJ1bGVzIHdpdGggaWQgc2VsZWN0b3Igb3Igb3RoZXIgY29tcGxleCBzZWxlY3RvcnNcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICAvLyBjb25zb2xlLmxvZyhydWxlLmNzc1RleHQpO1xuICAgICAgLy8gY29uc29sZS5sb2cocnVsZS5zZWxlY3RvclRleHQpO1xuICAgICAgLy8gY29uc29sZS5sb2cocnVsZS5zdHlsZS5jc3NUZXh0KTtcbiAgICAgIC8vIGNvbnNvbGUubG9nKHJ1bGUuc3R5bGUudGV4dERlY29yYXRpb25MaW5lKTtcbiAgICAgIC8vIGNvbnNvbGUubG9nKHJ1bGUpXG4gICAgICBpZihydWxlLnN0eWxlLnRleHREZWNvcmF0aW9uTGluZSA9PT0gJ3VuZGVybGluZScpIHtcbiAgICAgICAgY29uc3Qgc2VsZWN0b3JzID0gcnVsZS5zZWxlY3RvclRleHQuc3BsaXQoJywnKTtcbiAgICAgICAgZm9yKGNvbnN0IHNlbGVjdG9yIG9mIHNlbGVjdG9ycykge1xuICAgICAgICAgIGNvbnN0IHBhcnRzID0gc2VsZWN0b3Iuc3BsaXQoJzonKVswXS5zcGxpdCgnLicpO1xuICAgICAgICAgIGNvbnN0IHRhZyA9IHBhcnRzLnNoaWZ0KCk7XG4gICAgICAgICAgdW5kZXJsaW5lQ2xhc3NlcyA9IHBhcnRzO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8gY29uc29sZS5sb2coJ3VuZGVybGluZScsIHVuZGVybGluZUNsYXNzZXMpXG5cbiAgY29uc3Qgc3RhY2sgPSBbXTtcbiAgY29uc3QgcGFyYWdyYXBocyA9IFtdO1xuICBsZXQgZm10ID0ge307XG4gIGxldCBwYXJhZ3JhcGggPSB1bmRlZmluZWQ7XG5cbiAgbGV0IG5vZGUgPSByb290Tm9kZTsgIC8vIHJvb3Qgbm9kZSBpdHNlbGYgaXMgbm90IFwicGFyc2VkXCJcblxuICBsZXQgbiwgaSA9IDA7XG4gIHdoaWxlKG5vZGUpIHtcbiAgICBjb25zdCBjaGlsZE5vZGVzID0gbm9kZS5jaGlsZE5vZGVzO1xuICAgIG4gPSBjaGlsZE5vZGVzLmxlbmd0aDtcbiAgICBmb3IoOyBpPG47IGkrKykge1xuICAgICAgY29uc3QgY2hpbGQgPSBjaGlsZE5vZGVzW2ldO1xuXG4gICAgICAvLyBjb25zb2xlLmxvZygnQ0hJTEQnLCBjaGlsZC5ub2RlVHlwZSwgY2hpbGQubm9kZU5hbWUsIGNoaWxkLm5vZGVWYWx1ZSwgY2hpbGQuY2hpbGROb2Rlcyk7XG5cbiAgICAgIGlmKGNoaWxkLm5vZGVUeXBlID09PSBOb2RlLlRFWFRfTk9ERSAmJiBjaGlsZC5ub2RlVmFsdWUubGVuZ3RoID4gMCkge1xuXG4gICAgICAgIGlmKGNoaWxkLm5vZGVWYWx1ZS50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cblxuICAgICAgICBpZighcGFyYWdyYXBoKSB7XG4gICAgICAgICAgLy8gY29uc29sZS5sb2coJ05FVyBQQVJBJylcbiAgICAgICAgICBwYXJhZ3JhcGggPSB7IHNwYW5zOiBbXSwgaWQ6IG5ld0lEKCkgfTtcbiAgICAgICAgICBwYXJhZ3JhcGhzLnB1c2gocGFyYWdyYXBoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCdTVE9SRSBTUEFOJywgeyB0ZXh0OiBjaGlsZC5ub2RlVmFsdWUsIGZvcm1hdDogT2JqZWN0LmFzc2lnbih7fSwgZm10KSwgaWQ6IG5ld0lEKCkgfSlcbiAgICAgICAgcGFyYWdyYXBoLnNwYW5zLnB1c2goeyB0ZXh0OiBjaGlsZC5ub2RlVmFsdWUsIGZvcm1hdDogT2JqZWN0LmFzc2lnbih7fSwgZm10KSwgaWQ6IG5ld0lEKCkgfSk7XG5cbiAgICAgIH0gZWxzZSBpZihjaGlsZC5ub2RlVHlwZSA9PT0gTm9kZS5FTEVNRU5UX05PREUpIHtcblxuICAgICAgICBjb25zdCBjaGlsZEZtdCA9IE9iamVjdC5hc3NpZ24oe30sIGZtdCk7XG4gICAgICAgIGNvbnN0IG5vZGVGbXQgPSBPYmplY3QuYXNzaWduKHt9LCBmbXQpO1xuXG4gICAgICAgIC8vIGNoZWNrIHRhZyBuYW1lXG4gICAgICAgIGlmKGNoaWxkLm5vZGVOYW1lID09PSAnQicgfHwgY2hpbGQubm9kZU5hbWUgPT09ICdTVFJPTkcnKSB7XG4gICAgICAgICAgZm10LmJvbGQgPSB0cnVlO1xuICAgICAgICB9IGVsc2UgaWYoY2hpbGQubm9kZU5hbWUgPT09ICdJJyB8fCBjaGlsZC5ub2RlTmFtZSA9PT0gJ0VNJykge1xuICAgICAgICAgIGZtdC5pdGFsaWMgPSB0cnVlO1xuICAgICAgICB9IGVsc2UgaWYoY2hpbGQubm9kZU5hbWUgPT09ICdVJykge1xuICAgICAgICAgIGZtdC51bmRlcmxpbmUgPSB0cnVlO1xuICAgICAgICB9IGVsc2UgaWYoY2hpbGQubm9kZU5hbWUgPT09ICdTVVAnKSB7XG4gICAgICAgICAgZm10LnN1cGVyc2NyaXB0ID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIGlmKGNoaWxkLm5vZGVOYW1lID09PSAnU1VCJykge1xuICAgICAgICAgIGZtdC5zdWJzY3JpcHQgPSB0cnVlO1xuICAgICAgICB9IGVsc2UgaWYoY2hpbGQubm9kZU5hbWUgPT09ICdTUEFOJykge1xuICAgICAgICAgIGZvcihjb25zdCBjbHMgb2YgY2hpbGQuY2xhc3NMaXN0KSB7XG4gICAgICAgICAgICBpZih1bmRlcmxpbmVDbGFzc2VzLmluZGV4T2YoY2xzKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgZm10LnVuZGVybGluZSA9IHRydWU7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmKGNoaWxkLm5vZGVOYW1lID09PSAnUCcpIHtcbiAgICAgICAgICBwYXJhZ3JhcGggPSB7IHNwYW5zOiBbXSwgaWQ6IG5ld0lEKCkgfTtcbiAgICAgICAgICBwYXJhZ3JhcGhzLnB1c2gocGFyYWdyYXBoKTtcbiAgICAgICAgfSBlbHNlIGlmKGNoaWxkLm5vZGVOYW1lID09PSAnTEknKSB7XG4gICAgICAgICAgcGFyYWdyYXBoID0geyBzcGFuczogW10sIGlkOiBuZXdJRCgpLCBidWxsZXQ6IHRydWUgfTtcbiAgICAgICAgICBwYXJhZ3JhcGhzLnB1c2gocGFyYWdyYXBoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGRlYWwgd2l0aCBjaGlsZHJlblxuICAgICAgICBpZihub2RlLmNoaWxkTm9kZXMgJiYgbm9kZS5jaGlsZE5vZGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAvLyBjb25zb2xlLmxvZygnUFVTSCcsIGksIG5vZGUsIG5vZGVGbXQsICdjb250aW51ZSB3aXRoJywgT2JqZWN0LmFzc2lnbih7fSwgZm10KSlcbiAgICAgICAgICBzdGFjay5wdXNoKHsgbm9kZSwgaTogaSsxLCBmbXQ6IE9iamVjdC5hc3NpZ24oe30sIG5vZGVGbXQpIH0pXG4gICAgICAgICAgaSA9IDA7XG4gICAgICAgICAgbm9kZSA9IGNoaWxkO1xuICAgICAgICAgIG4gPSBub2RlLmNoaWxkTm9kZXMubGVuZ3RoO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGlmKGkgPj0gbikge1xuICAgICAgaWYoc3RhY2subGVuZ3RoID4gMCkge1xuICAgICAgICBpZihub2RlLm5vZGVOYW1lID09PSAnUCcgfHwgbm9kZS5ub2RlTmFtZSA9PT0gJ0xJJykge1xuICAgICAgICAgIHBhcmFncmFwaCA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBpdGVtID0gc3RhY2sucG9wKCk7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCdQT1AnLCBpdGVtKVxuICAgICAgICBpID0gaXRlbS5pO1xuICAgICAgICBub2RlID0gaXRlbS5ub2RlO1xuICAgICAgICBmbXQgPSBpdGVtLmZtdDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG5vZGUgPSBudWxsO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gcGFyYWdyYXBocztcbn1cblxuLy8gcGFyc2UgZWRpdG9yIERPTVxuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlRE9NKHJvb3ROb2RlKSB7XG5cblxuICBjb25zdCBhdHRyVmFsdWUgPSAoYXR0ciwgdHJhbnNmb3JtKSA9PiB7XG4gICAgbGV0IHZhbHVlID0gYXR0cjtcbiAgICBpZih2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB2YWx1ZSA9IHZhbHVlLm5vZGVWYWx1ZTtcbiAgICB9XG4gICAgaWYodmFsdWUgIT09IHVuZGVmaW5lZCAmJiB0cmFuc2Zvcm0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgdmFsdWUgPSB0cmFuc2Zvcm0odmFsdWUpO1xuICAgIH1cbiAgICByZXR1cm4gdmFsdWVcbiAgfTtcblxuICBjb25zdCBwYXJhZ3JhcGhzID0gW107XG5cbiAgLy8gcGxhaW50ZXh0MTxici8+cGxhaW50ZXh0MjxkaXYgcGFyYT5wYXJhaGVhZDxzcGFuPnNwYW48L3NwYW4+cGFyYWZvb3Q8L2RpdiBwYXJhPnBsYWludGV4dDNcbiAgLy8gbWFwcG9qYXMgdXpcbiAgLy8gW1xuICAvLyAgPHBhcmE+cGxhaW50ZXh0MTwvcGFyYT5cbiAgLy8gIDxwYXJhPnBsYWludGV4dDI8L3BhcmE+XG4gIC8vICA8cGFyYT48c3Bhbj5wYXJhaGVhZHNwYW5wYXJhZm9vdDwvc3Bhbj48cGFyYT5cbiAgLy8gIDxwYXJhPnBsYWludGV4dDM8L3BhcmE+XG4gIC8vIF1cblxuICAvLyBjb25zb2xlLmxvZygnSFRNTCcsIHJvb3ROb2RlLmlubmVySFRNTCk7XG5cbiAgbGV0IGxhc3RQbGFpbnRleHRQYXJhID0gZmFsc2U7XG4gIGxldCBmbXQgPSB7fTtcblxuICBmb3IoY29uc3Qgbm9kZSBvZiByb290Tm9kZS5jaGlsZE5vZGVzKSB7XG4gICAgaWYobm9kZS5ub2RlVHlwZSA9PT0gTm9kZS5FTEVNRU5UX05PREUpIHtcbiAgICAgIGlmKG5vZGUubm9kZU5hbWUgPT09ICdESVYnICYmIG5vZGUuYXR0cmlidXRlc1snZGF0YS1pZCddKSB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCdkaXYnLCBub2RlKTtcbiAgICAgICAgbGFzdFBsYWludGV4dFBhcmEgPSB0cnVlO1xuICAgICAgICBmbXQgPSB7fTtcbiAgICAgICAgY29uc3QgaWQgPSBub2RlLmF0dHJpYnV0ZXNbJ2RhdGEtaWQnXS5ub2RlVmFsdWU7XG4gICAgICAgIGNvbnN0IHNwYW5zID0gW107XG4gICAgICAgIGNvbnN0IHBhcmFncmFwaCA9IHsgaWQsIHNwYW5zIH07XG4gICAgICAgIHBhcmFncmFwaHMucHVzaChwYXJhZ3JhcGgpO1xuICAgICAgICBsZXQgcHJlcGVuZFRleHQ7XG4gICAgICAgIC8vIGFkZChub2RlLmlubmVyVGV4dCwgdWlkKTtcbiAgICAgICAgLy8gcGFyc2Ugc3BhbnNcbiAgICAgICAgY29uc3QgcGFyYWdyYXBoTm9kZSA9IG5vZGU7XG4gICAgICAgIHtcbiAgICAgICAgICBmb3IoY29uc3Qgbm9kZSBvZiBwYXJhZ3JhcGhOb2RlLmNoaWxkTm9kZXMpIHtcbiAgICAgICAgICAgIGlmKG5vZGUubm9kZVR5cGUgPT09IE5vZGUuRUxFTUVOVF9OT0RFKSB7XG4gICAgICAgICAgICAgIGlmKG5vZGUubm9kZU5hbWUgPT09ICdTUEFOJyAmJiBub2RlLmF0dHJpYnV0ZXNbJ2RhdGEtaWQnXSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGlkID0gbm9kZS5hdHRyaWJ1dGVzWydkYXRhLWlkJ10ubm9kZVZhbHVlO1xuICAgICAgICAgICAgICAgIGxldCB0ZXh0ID0gbm9kZS5pbm5lclRleHQ7XG4gICAgICAgICAgICAgICAgaWYocHJlcGVuZFRleHQgJiYgcHJlcGVuZFRleHQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgdGV4dCA9IHByZXBlbmRUZXh0ICsgdGV4dDtcbiAgICAgICAgICAgICAgICAgIHByZXBlbmRUZXh0ID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCB0aW1lID0gYXR0clZhbHVlKG5vZGUuYXR0cmlidXRlc1snZGF0YS10aW1lJ10sIHBhcnNlSW50KTtcbiAgICAgICAgICAgICAgICBjb25zdCBkdXJhdGlvbiA9IGF0dHJWYWx1ZShub2RlLmF0dHJpYnV0ZXNbJ2RhdGEtZHVyYXRpb24nXSwgcGFyc2VJbnQpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbmZpZGVuY2UgPSBhdHRyVmFsdWUobm9kZS5hdHRyaWJ1dGVzWydkYXRhLWNvbmZpZGVuY2UnXSwgcGFyc2VGbG9hdCk7XG4gICAgICAgICAgICAgICAgc3BhbnMucHVzaCh7IGlkLCB0ZXh0LCB0aW1lLCBkdXJhdGlvbiwgY29uZmlkZW5jZSB9KTtcbiAgICAgICAgICAgICAgICAvLyBhZGQobm9kZS5pbm5lclRleHQsIHVpZCk7XG4gICAgICAgICAgICAgICAgLy8gcGFyc2Ugc3BhbnNcblxuICAgICAgICAgICAgICB9IGVsc2UgaWYobm9kZS5ub2RlTmFtZSA9PT0gJ0JSJykge1xuICAgICAgICAgICAgICAgIC8vIGFkZCgnXFxuJyk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gYWRkKG5vZGUuaW5uZXJUZXh0KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmKG5vZGUubm9kZVR5cGUgPT09IE5vZGUuVEVYVF9OT0RFKSB7XG4gICAgICAgICAgICAgIC8vIGFkZChub2RlLm5vZGVWYWx1ZSk7XG4gICAgICAgICAgICAgIC8vIHdlIGhhdmUgcGxhaW4gdGV4dCwgYXBwZW5kIGl0IHNvbWV3aGVyZVxuICAgICAgICAgICAgICBpZihub2RlLm5vZGVWYWx1ZS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgaWYoc3BhbnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgc3BhbnNbc3BhbnMubGVuZ3RoIC0gMV0udGV4dCArPSBub2RlLm5vZGVWYWx1ZS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIHByZXBlbmRUZXh0ID0gbm9kZS5ub2RlVmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdURVhUIE5PREUnLCBub2RlLm5vZGVWYWx1ZSwgbm9kZS5ub2RlVmFsdWUubGVuZ3RoKVxuICAgICAgICAgICAgICBub2RlLm5vZGVWYWx1ZSA9ICcnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmKHNwYW5zLmxlbmd0aCA9PT0gMCAmJiBwcmVwZW5kVGV4dCAmJiBwcmVwZW5kVGV4dC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgc3BhbnMucHVzaChuZXdTcGFuKHByZXBlbmRUZXh0KSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZihub2RlLm5vZGVOYW1lID09PSAnQlInKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdicicsIG5vZGUpO1xuICAgICAgICBsYXN0UGxhaW50ZXh0UGFyYSA9IGZhbHNlO1xuICAgICAgICBub2RlLnJlbW92ZSgpO1xuICAgICAgICAvLyBhZGQoJ1xcbicpO1xuICAgICAgLy8gfSBlbHNlIGlmKG5vZGUubm9kZU5hbWUgPT09ICdTVFJPTkcnIHx8IG5vZGUubm9kZU5hbWUgPT09ICdCJykge1xuICAgICAgLy8gICBmbXQuYm9sZCA9IHRydWU7XG4gICAgICAvLyB9IGVsc2UgaWYobm9kZS5ub2RlTmFtZSA9PT0gJ0VNJyB8fCBub2RlLm5vZGVOYW1lID09PSAnSScpIHtcbiAgICAgIC8vICAgZm10Lml0YWxpYyA9IHRydWU7XG4gICAgICAvLyB9IGVsc2UgaWYobm9kZS5ub2RlTmFtZSA9PT0gJ1UnKSB7XG4gICAgICAvLyAgIGZtdC51bmRlcmxpbmUgPSB0cnVlO1xuICAgICAgLy8gfSBlbHNlIGlmKG5vZGUubm9kZU5hbWUgPT09ICdTVUInKSB7XG4gICAgICAvLyAgIGZtdC5zdWJzY3JpcHQgPSB0cnVlO1xuICAgICAgLy8gfSBlbHNlIGlmKG5vZGUubm9kZU5hbWUgPT09ICdTVVAnKSB7XG4gICAgICAvLyAgIGZtdC5zdXBlcnNjcmlwdCA9IHRydWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBjb25zb2xlLmxvZygnb3RoZXIgZWxlbWVudCcsIG5vZGUpO1xuICAgICAgICBub2RlLnJlbW92ZSgpO1xuICAgICAgICAvLyBUT0RPOiBtYXAgZm9ybWF0dGluZ1xuICAgICAgICAvLyBhZGQobm9kZS5pbm5lclRleHQpO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZihub2RlLm5vZGVUeXBlID09PSBOb2RlLlRFWFRfTk9ERSAmJiBub2RlLm5vZGVWYWx1ZS5sZW5ndGggPiAwKSB7XG4gICAgICAvLyBjb25zb2xlLmxvZygndGV4dCBub2RlJywgbm9kZSwgYD4ke25vZGUubm9kZVZhbHVlfTxgKTtcbiAgICAgIGxldCBwYXJhZ3JhcGggPSBwYXJhZ3JhcGhzLmxlbmd0aCA+IDAgJiYgbGFzdFBsYWludGV4dFBhcmEgJiYgcGFyYWdyYXBoc1twYXJhZ3JhcGhzLmxlbmd0aCAtIDFdO1xuICAgICAgaWYoIXBhcmFncmFwaCkge1xuICAgICAgICBwYXJhZ3JhcGggPSB7IGlkOiBuZXdJRCgpLCBzcGFuczogW10gfTtcbiAgICAgICAgcGFyYWdyYXBocy5wdXNoKHBhcmFncmFwaCk7XG4gICAgICB9XG4gICAgICBjb25zdCBzcGFucyA9IHBhcmFncmFwaC5zcGFucztcbiAgICAgIHNwYW5zLnB1c2goeyBpZDogbmV3SUQoKSwgdGV4dDogbm9kZS5ub2RlVmFsdWUgfSk7XG4gICAgICAgIG5vZGUucmVtb3ZlKCk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHBhcmFncmFwaHM7XG59XG5cbmZ1bmN0aW9uIGlzRE9NU2VsZWN0aW9uQmFja3dhcmRzKHNlbGVjdGlvbikge1xuICBpZihzZWxlY3Rpb24uaXNDb2xsYXBzZWQpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgaWYoc2VsZWN0aW9uLmFuY2hvck5vZGUgPT09IHNlbGVjdGlvbi5mb2N1c05vZGUpIHtcbiAgICBpZihzZWxlY3Rpb24uYW5jaG9yT2Zmc2V0ID4gc2VsZWN0aW9uLmZvY3VzT2Zmc2V0KSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIC8vIGdldCBsaXN0IG9mIHBhcmVudHMgc3RhcnRpbmcgZnJvbSBhbmNob3JOb2RlXG4gIGNvbnN0IHBhcmVudE5vZGVzID0gW3NlbGVjdGlvbi5hbmNob3JOb2RlXTtcbiAgbGV0IG5vZGUgPSBzZWxlY3Rpb24uYW5jaG9yTm9kZTtcbiAgd2hpbGUobm9kZSAmJiBub2RlICE9IGRvY3VtZW50LmJvZHkpIHtcbiAgICBub2RlID0gbm9kZS5wYXJlbnROb2RlO1xuICAgIHBhcmVudE5vZGVzLnB1c2gobm9kZSk7XG4gIH1cbiAgLy8gaXRlcmF0ZSBmcm9tIGZvY3VzTm9kZSB0byBwYXJlbnQgbm9kZXNcbiAgbm9kZSA9IHNlbGVjdGlvbi5mb2N1c05vZGU7XG4gIHdoaWxlKG5vZGUgJiYgbm9kZSAhPSBkb2N1bWVudC5ib2R5KSB7XG4gICAgY29uc3QgZm9jdXNOb2RlID0gbm9kZTtcbiAgICBub2RlID0gbm9kZS5wYXJlbnROb2RlO1xuICAgIGxldCBhbmNob3JOb2RlO1xuICAgIC8vIGNoZWNrIGVhY2ggbm9kZSBtYXRjaCBpbnNpZGUgcHJldmlvdXNseSBidWlsdCBwYXJlbnQgbm9kZSBsaXN0XG4gICAgZm9yKGNvbnN0IHBhcmVudCBvZiBwYXJlbnROb2Rlcykge1xuICAgICAgaWYobm9kZSA9PT0gcGFyZW50KSB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCdQQVJFTlQ6JywgcGFyZW50LCAnQU5DSE9SOicsIGFuY2hvck5vZGUsICdGT0NVUzonLCBmb2N1c05vZGUpXG4gICAgICAgIC8vIHdlIGhhdmUgY29tbWFuZCBwYXJlbnQgbm9kZSwgbGV0J3MgY2hlY2sgd2hpY2ggY2hpbGQgbm9kZSBjb21lcyBmaXJzdDogZnJvbSBhbmNob3IgYnJhbmNoIG9yIGZvY3VzIGJyYW5jaFxuICAgICAgICBmb3IoY29uc3QgY2hpbGROb2RlIG9mIHBhcmVudC5jaGlsZE5vZGVzKSB7XG4gICAgICAgICAgaWYoY2hpbGROb2RlID09PSBhbmNob3JOb2RlKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgfSBlbHNlIGlmKGNoaWxkTm9kZSA9PT0gZm9jdXNOb2RlKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGFuY2hvck5vZGUgPSBwYXJlbnQ7XG4gICAgfVxuICB9XG4gIC8vIE5PVEU6IGFsdGVybmF0aXZlIGFwcHJvYWNoIGludm9sdmVzIGNoZWNraW5nIGlmIHNvbWUgcG9pbnQgaXMgaW5zaWRlIHRoZSByYW5nZSwgb3Igb3V0c2lkZSB0byB0aGUgbGVmdCBvciByaWdodFxuICAvLyBpZihzZWxlY3Rpb24ucmFuZ2VDb3VudCA9PSAwKSB7XG4gIC8vICAgcmV0dXJuIGZhbHNlO1xuICAvLyB9XG4gIC8vIGNvbnN0IHJhbmdlID0gc2VsZWN0aW9uLmdldFJhbmdlQXQoMCk7XG4gIC8vIHJhbmdlLmNvbXBhcmVQb2ludChub2RlLCBvZmZzZXQpID0+IC0xLCAwLCAxXG59XG5cblxuZXhwb3J0IGZ1bmN0aW9uIG5vcm1hbGl6ZWRET01TZWxlY3Rpb24oc2VsZWN0aW9uKSB7XG4gIGlmKCFzZWxlY3Rpb24pIHtcbiAgICBzZWxlY3Rpb24gPSBkb2N1bWVudC5nZXRTZWxlY3Rpb24oKTtcbiAgfVxuICBpZighKHNlbGVjdGlvbiBpbnN0YW5jZW9mIFNlbGVjdGlvbikpIHtcbiAgICByZXR1cm4gc2VsZWN0aW9uO1xuICB9XG4gIGlmKHNlbGVjdGlvbi5pc0NvbGxhcHNlZCkge1xuICAgIGNvbnN0IHN0YXJ0Tm9kZSA9IHNlbGVjdGlvbi5hbmNob3JOb2RlO1xuICAgIGNvbnN0IHN0YXJ0T2Zmc2V0ID0gc2VsZWN0aW9uLmFuY2hvck9mZnNldDtcbiAgICBjb25zdCBzdGFydCA9IHsgbm9kZTogc3RhcnROb2RlLCBvZmZzZXQ6IHN0YXJ0T2Zmc2V0IH07XG4gICAgLy8gcmV0dXJuIHsgc3RhcnROb2RlLCBzdGFydE9mZnNldCwgZW5kTm9kZTogc3RhcnROb2RlLCBlbmRPZmZzZXQ6IHN0YXJ0T2Zmc2V0LCBiYWNrd2FyZHM6IGZhbHNlLCBjb2xsYXBzZWQ6IHRydWUgfTtcbiAgICByZXR1cm4geyBzdGFydCwgZW5kOiBzdGFydCwgYmFja3dhcmRzOiBmYWxzZSwgY29sbGFwc2VkOiB0cnVlLCBzZWxlY3Rpb24gfTtcbiAgfVxuICBjb25zdCBiYWNrd2FyZHMgPSBpc0RPTVNlbGVjdGlvbkJhY2t3YXJkcyhzZWxlY3Rpb24pO1xuICBjb25zdCBzdGFydE5vZGUgPSBiYWNrd2FyZHMgPyBzZWxlY3Rpb24uZm9jdXNOb2RlIDogc2VsZWN0aW9uLmFuY2hvck5vZGU7XG4gIGNvbnN0IHN0YXJ0T2Zmc2V0ID0gYmFja3dhcmRzID8gc2VsZWN0aW9uLmZvY3VzT2Zmc2V0IDogc2VsZWN0aW9uLmFuY2hvck9mZnNldDtcbiAgY29uc3QgZW5kTm9kZSA9IGJhY2t3YXJkcyA/IHNlbGVjdGlvbi5hbmNob3JOb2RlIDogc2VsZWN0aW9uLmZvY3VzTm9kZTtcbiAgY29uc3QgZW5kT2Zmc2V0ID0gYmFja3dhcmRzID8gc2VsZWN0aW9uLmFuY2hvck9mZnNldCA6IHNlbGVjdGlvbi5mb2N1c09mZnNldDtcbiAgLy8gcmV0dXJuIHsgc3RhcnROb2RlLCBzdGFydE9mZnNldCwgZW5kTm9kZSwgZW5kT2Zmc2V0LCBiYWNrd2FyZHMsIGNvbGxhcHNlZDogZmFsc2UgfTtcbiAgcmV0dXJuIHsgc3RhcnQ6IHsgbm9kZTogc3RhcnROb2RlLCBvZmZzZXQ6IHN0YXJ0T2Zmc2V0IH0sIGVuZDogeyBub2RlOiBlbmROb2RlLCBvZmZzZXQ6IGVuZE9mZnNldCB9LCBiYWNrd2FyZHMsIGNvbGxhcHNlZDogZmFsc2UsIHNlbGVjdGlvbiB9O1xufVxuXG4vLyBET00gdGV4dCBwb2ludGVyIC0+IHRleHQgbm9kZSArIG9mZnNldFxuXG4vLyBmdW5jdGlvbiBub3JtYWxpemVQb2ludGVyKHBvaW50ZXIpIHtcbi8vICAgLy8gZXhwZWN0ZWQgYXR0cmlidXRlczogbm9kZSwgb2Zmc2V0LCBwYXJhZ3JhcGhJRCwgc3BhbklELCBwYXJhZ3JhcGhJbmRleCwgc3BhbkluZGV4XG4vLyB9XG5cbi8vIGdldCBub2RlIHdpdGggc3BlY2lmaWVkIHRhZyBhbmQgZXh0cmFjdCBzcGVjaWZpZWQgZGF0YS0gYXR0cmlidXRlc1xuZXhwb3J0IGZ1bmN0aW9uIGdldERPTUVsZW1lbnREYXRhQXR0cmlidXRlcyhub2RlLCB0YWcsIHJlc29sdmVBdHRycyA9IFtdKSB7XG4gIGlmKG5vZGUgJiYgbm9kZS5ub2RlVHlwZSA9PSBOb2RlLlRFWFRfTk9ERSkge1xuICAgIG5vZGUgPSBub2RlLnBhcmVudE5vZGU7XG4gIH1cbiAgaWYobm9kZSAmJiBub2RlLm5vZGVUeXBlID09IE5vZGUuRUxFTUVOVF9OT0RFKSB7XG4gICAgaWYoIXRhZyB8fCBub2RlLm5vZGVOYW1lID09PSB0YWcpIHtcbiAgICAgIGNvbnN0IGF0dHJzID0ge307XG4gICAgICBmb3IoY29uc3QgbmFtZSBvZiByZXNvbHZlQXR0cnMpIHtcbiAgICAgICAgY29uc3QgYXR0ciA9IG5vZGUuYXR0cmlidXRlc1snZGF0YS0nICsgbmFtZV07XG4gICAgICAgIGlmKGF0dHIpIHtcbiAgICAgICAgICBhdHRyc1tuYW1lXSA9IGF0dHIubm9kZVZhbHVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4geyBub2RlLCBhdHRycyB9O1xuICAgIH1cbiAgfVxuICByZXR1cm4ge307XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkYXRhRE9NTm9kZXNBdE5vZGUobm9kZSkge1xuICBsZXQgaW5wdXROb2RlID0gbm9kZTtcbiAgbGV0IHNwYW5BdHRycywgcGFyYWdyYXBoQXR0cnMsIHNwYW5Ob2RlLCBwYXJhZ3JhcGhOb2RlO1xuICB3aGlsZShpbnB1dE5vZGUgJiYgIXBhcmFncmFwaEF0dHJzKSB7XG4gICAgY29uc3QgeyBub2RlLCBhdHRycyB9ID0gZ2V0RE9NRWxlbWVudERhdGFBdHRyaWJ1dGVzKGlucHV0Tm9kZSwgdW5kZWZpbmVkLCBbJ2lkJywgJ3RpbWUnLCAnZHVyYXRpb24nLCAnY29uZmlkZW5jZSddKTsgIC8vIHRyeSBzcGFuIG5vZGVcbiAgICBpZighcGFyYWdyYXBoQXR0cnMgJiYgIXNwYW5BdHRycyAmJiBub2RlICYmIG5vZGUubm9kZU5hbWUgPT09ICdTUEFOJyAmJiBhdHRycy5pZCkge1xuICAgICAgc3BhbkF0dHJzID0gYXR0cnM7XG4gICAgICBzcGFuTm9kZSA9IG5vZGU7XG4gICAgfSBlbHNlIGlmKCFwYXJhZ3JhcGhBdHRycyAmJiBub2RlICYmIG5vZGUubm9kZU5hbWUgPT09ICdESVYnICYmIGF0dHJzLmlkKSB7XG4gICAgICBwYXJhZ3JhcGhBdHRycyA9IGF0dHJzO1xuICAgICAgcGFyYWdyYXBoTm9kZSA9IG5vZGU7XG4gICAgICBicmVhaztcbiAgICB9XG4gICAgaWYobm9kZSkge1xuICAgICAgaW5wdXROb2RlID0gbm9kZTtcbiAgICB9XG4gICAgaW5wdXROb2RlID0gaW5wdXROb2RlLnBhcmVudE5vZGU7XG4gIH1cbiAgcmV0dXJuIHsgc3Bhbk5vZGUsIHNwYW5BdHRycywgcGFyYWdyYXBoTm9kZSwgcGFyYWdyYXBoQXR0cnMgfTtcbn1cblxuZnVuY3Rpb24gdGV4dE5vZGUobm9kZSkge1xuICBpZihub2RlLm5vZGVUeXBlID09PSBOb2RlLkVMRU1FTlRfTk9ERSkge1xuICAgIGlmKG5vZGUuY2hpbGROb2Rlcy5sZW5ndGggPiAwKSB7XG4gICAgICByZXR1cm4gbm9kZS5jaGlsZE5vZGVzWzBdO1xuICAgIH1cbiAgICByZXR1cm4gbm9kZTtcbiAgfSBlbHNlIGlmKG5vZGUubm9kZVR5cGUgPT09IE5vZGUuVEVYVF9OT0RFKSB7XG4gICAgcmV0dXJuIG5vZGU7XG4gIH1cbiAgcmV0dXJuO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGF0YVBvaW50ZXJET01Ob2RlKHBvaW50ZXIsIGNvbnRhaW5lck5vZGUpIHtcbiAgY29uc3Qgbm9kZSA9IGNvbnRhaW5lck5vZGUucXVlcnlTZWxlY3RvcihgZGl2W2RhdGEtaWQ9XCIke3BvaW50ZXIucGFyYWdyYXBoSUR9XCJdYCArIChwb2ludGVyLnNwYW5JRCA/IGAgPiBzcGFuW2RhdGEtaWQ9XCIke3BvaW50ZXIuc3BhbklEfVwiXWAgOiAnJykgKTtcbiAgcG9pbnRlci5ub2RlID0gbm9kZTtcbiAgLy8gaWYoZG9TZWxlY3RUZXh0ICYmIGVsZW1lbnQuY2hpbGROb2Rlcy5sZW5ndGggPiAwKSB7XG4gIC8vICAgcmV0dXJuIGVsZW1lbnQuY2hpbGROb2Rlc1swXTtcbiAgLy8gfVxuICByZXR1cm4gcG9pbnRlcjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlc3RvcmVET01TZWxlY3Rpb24oY29udGFpbmVyTm9kZSwgc3RhcnQsIGVuZCkge1xuXG4gIGNvbnN0IHN0YXJ0Tm9kZSA9IHRleHROb2RlKHN0YXJ0Lm5vZGUgfHwgZGF0YVBvaW50ZXJET01Ob2RlKHN0YXJ0LCBjb250YWluZXJOb2RlKS5ub2RlKTtcbiAgY29uc3QgZW5kTm9kZSA9IGVuZCAmJiB0ZXh0Tm9kZShlbmQubm9kZSB8fCBkYXRhUG9pbnRlckRPTU5vZGUoZW5kLCBjb250YWluZXJOb2RlKS5ub2RlKTtcblxuICAvLyBjb25zb2xlLmxvZygnc2VsZWN0IHN0YXJ0IGVsZW1lbnQnLCBzdGFydGVsZW1lbnQsICdzdGFydG9mZnNldCcsIHN0YXJ0Lm9mZnNldCwgJ2VuZCBlbGVtZW50JywgZW5kZWxlbWVudCwgJ2VuZG9mZmZzZXQnLCBlbmQgJiYgZW5kLm9mZnNldCk7XG5cbiAgY29uc3Qgc2VsZWN0aW9uID0gZG9jdW1lbnQuZ2V0U2VsZWN0aW9uKCk7XG4gIHNlbGVjdGlvbi5lbXB0eSgpO1xuICBjb25zdCByYW5nZSA9IG5ldyBSYW5nZSgpO1xuICByYW5nZS5zZXRTdGFydChzdGFydE5vZGUsIHN0YXJ0Lm9mZnNldCk7XG4gIGlmKCFlbmQpIHtcbiAgICAvLyByYW5nZS5zZXRFbmQoc3RhcnROb2RlLCBzdGFydC5vZmZzZXQpO1xuICAgIHJhbmdlLmNvbGxhcHNlKHRydWUpO1xuICB9IGVsc2Uge1xuICAgIHJhbmdlLnNldEVuZChlbmROb2RlLCBlbmQub2Zmc2V0KTtcbiAgfVxuICBzZWxlY3Rpb24uYWRkUmFuZ2UocmFuZ2UpO1xufVxuXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBkYXRhIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuZnVuY3Rpb24gZGF0YVBhcmFncmFwaHMoZGF0YSkge1xuICByZXR1cm4gZGF0YTtcbn1cblxuZnVuY3Rpb24gcGFyYWdyYXBoU3BhbnMocGFyYWdyYXBoKSB7XG4gIHJldHVybiBwYXJhZ3JhcGguc3BhbnM7XG59XG5cbmZ1bmN0aW9uIHNldFBhcmFncmFwaFNwYW5zKHBhcmFncmFwaCwgc3BhbnMpIHtcbiAgcmV0dXJuIHBhcmFncmFwaC5zcGFucyA9IHNwYW5zO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbmV3U3Bhbih0ZXh0ID0gJycpIHtcbiAgcmV0dXJuIHsgaWQ6IG5ld0lEKCksIHRleHQsIGZvcm1hdDoge30gfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG5ld1BhcmFncmFwaChzcGFucykge1xuICByZXR1cm4geyBpZDogbmV3SUQoKSwgc3BhbnM6IHR5cGVvZiBzcGFucyA9PT0gJ251bWJlcicgPyBBcnJheS5mcm9tKEFycmF5KHNwYW5zKSwgKCkgPT4gbmV3U3BhbigpKSA6IChzcGFucyB8fCBbXSkgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvcHlTcGFuKHNwYW4sIC4uLm5ld1Byb3BzKSB7XG4gIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCBzcGFuLCB7IGZvcm1hdDogT2JqZWN0LmFzc2lnbih7fSwgc3Bhbi5mb3JtYXQgfHwge30pIH0sIC4uLm5ld1Byb3BzKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gc3BsaXRTcGFuKHNwYW4sIG9mZnNldCwgeyBuZXdpZCwgc3BsaXRUaW1lIH0gPSB7IG5ld2lkOiBuZXdJRCwgc3BsaXRUaW1lOiBmYWxzZSB9KSB7XG4gIGNvbnN0IGxlZnQgPSB7IGlkOiBuZXdpZChzcGFuLmlkKSwgdGV4dDogc3Bhbi50ZXh0LnN1YnN0cigwLCBvZmZzZXQpLCBmb3JtYXQ6IE9iamVjdC5hc3NpZ24oe30sIHNwYW4uZm9ybWF0KSAvKnNwYW4uaWQgKyAnLWwnKi8gfTsgLy8gZ2VuZXJhdGUgbmV3IHJhbmRvbSBpZFxuICBjb25zdCByaWdodCA9IHsgaWQ6IG5ld2lkKHNwYW4uaWQpLCB0ZXh0OiBzcGFuLnRleHQuc3Vic3RyKG9mZnNldCksIGZvcm1hdDogT2JqZWN0LmFzc2lnbih7fSwgc3Bhbi5mb3JtYXQpIC8qc3Bhbi5pZCArICctcicqLyB9OyAvLyBnZW5lcmF0ZSBuZXcgcmFuZG9tIGlkXG4gIGlmKHNwbGl0VGltZSkge1xuICAgIGNvbnN0IHRvdGFsID0gc3Bhbi50ZXh0LnJlcGxhY2UoL1xccyovZywgJycpLmxlbmd0aDtcbiAgICBpZihzcGFuLmR1cmF0aW9uID4gMCkge1xuICAgICAgbGVmdC5kdXJhdGlvbiA9IGxlZnQudGV4dC5yZXBsYWNlKC9cXHMqL2csICcnKS5sZW5ndGggKiBzcGFuLmR1cmF0aW9uIC8gdG90YWw7XG4gICAgICByaWdodC5kdXJhdGlvbiA9IHJpZ2h0LnRleHQucmVwbGFjZSgvXFxzKi9nLCAnJykubGVuZ3RoICogc3Bhbi5kdXJhdGlvbiAvIHRvdGFsO1xuICAgICAgaWYoc3Bhbi50aW1lID49IDApIHtcbiAgICAgICAgbGVmdC50aW1lID0gc3Bhbi50aW1lO1xuICAgICAgICByaWdodC50aW1lID0gc3Bhbi50aW1lICsgbGVmdC5kdXJhdGlvbjtcbiAgICAgICAgLy8gcmlnaHQudGltZSA9IHNwYW4udGltZSArIHBhcnNlSW50KGxlZnQuZHVyYXRpb24gKiAxMDAwKTtcbiAgICAgIH1cbiAgICAgIC8vIFRPRE86IG1heSBuZWVkIHRvIGtlZXAgb3JpZ2luYWwgdGltZS9kdXJhdGlvbiBhcyBiYWNrdXAgdmFsdWVzXG4gICAgfVxuICAgIC8vIFRPRE86IGZuIHRvIGZpeCBncm91cHNcbiAgfSBlbHNlIHtcbiAgICBsZWZ0LnRpbWUgPSBzcGFuLnRpbWU7XG4gICAgcmlnaHQudGltZSA9IHNwYW4udGltZTtcbiAgICBsZWZ0LmR1cmF0aW9uID0gc3Bhbi5kdXJhdGlvbjtcbiAgICByaWdodC5kdXJhdGlvbiA9IHNwYW4uZHVyYXRpb247XG4gICAgaWYoc3Bhbi5ncm91cCAmJiBzcGFuLmdyb3VwLmxlbmd0aCA+IDApIHtcbiAgICAgIC8vIHNhbWUgZ3JvdXBcbiAgICAgIGxlZnQuZ3JvdXAgPSBzcGFuLmdyb3VwO1xuICAgICAgcmlnaHQuZ3JvdXAgPSBzcGFuLmdyb3VwO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBzcGF3biBhIGdyb3VwXG4gICAgICBsZWZ0Lmdyb3VwID0gc3Bhbi5pZDtcbiAgICAgIHJpZ2h0Lmdyb3VwID0gc3Bhbi5pZDtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHsgbGVmdCwgcmlnaHQgfTtcbn1cblxuXG5leHBvcnQgZnVuY3Rpb24gaWRUb0luZGV4KGRhdGEsIHBhcmFncmFwaElELCBzcGFuSUQpIHtcbiAgY29uc29sZS5hc3NlcnQoZGF0YSAhPT0gdW5kZWZpbmVkLCAnZGF0YSBub3Qgc3BlY2lmaWVkJyk7XG4gIGNvbnNvbGUuYXNzZXJ0KHBhcmFncmFwaElEICE9PSB1bmRlZmluZWQsICdwYXJhZ3JhcGhJRCBub3Qgc3BlY2lmaWVkJyk7XG5cbiAgY29uc3Qgbm9ybUluZGV4ID0gKGluZGV4KSA9PiBpbmRleCA9PT0gLTEgPyB1bmRlZmluZWQgOiBpbmRleDtcbiAgY29uc3QgcGFyYWdyYXBocyA9IGRhdGFQYXJhZ3JhcGhzKGRhdGEpO1xuICBjb25zb2xlLmFzc2VydChwYXJhZ3JhcGhzICE9PSB1bmRlZmluZWQsICdubyBwYXJhZ3JhcGhzJyk7XG4gIGNvbnN0IHBhcmFncmFwaEluZGV4ID0gbm9ybUluZGV4KHBhcmFncmFwaHMuZmluZEluZGV4KHBhcmFncmFwaCA9PiBwYXJhZ3JhcGguaWQgPT09IHBhcmFncmFwaElEKSk7XG4gIGNvbnN0IHBhcmFncmFwaCA9IHBhcmFncmFwaEluZGV4ICE9PSB1bmRlZmluZWQgJiYgcGFyYWdyYXBoSW5kZXggIT09IC0xICYmIHBhcmFncmFwaHNbcGFyYWdyYXBoSW5kZXhdIHx8IHVuZGVmaW5lZDtcbiAgY29uc3Qgc3BhbkluZGV4ID0gcGFyYWdyYXBoICYmIG5vcm1JbmRleChwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGgpLmZpbmRJbmRleChzcGFuID0+IHNwYW4uaWQgPT09IHNwYW5JRCkpO1xuICBjb25zdCBzcGFuID0gc3BhbkluZGV4ICE9PSB1bmRlZmluZWQgJiYgc3BhbkluZGV4ICE9PSAtMSAmJiBwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGgpW3NwYW5JbmRleF0gfHwgdW5kZWZpbmVkO1xuICByZXR1cm4geyBwYXJhZ3JhcGgsIHBhcmFncmFwaEluZGV4LCBzcGFuLCBzcGFuSW5kZXggfTtcbn1cblxuZnVuY3Rpb24gZGF0YUF0SW5kZXgoZGF0YSwgcGFyYWdyYXBoSW5kZXgsIHNwYW5JbmRleCkge1xuICBjb25zdCBwYXJhZ3JhcGhzID0gZGF0YVBhcmFncmFwaHMoZGF0YSk7XG4gIGNvbnN0IHBhcmFncmFwaCA9IHBhcmFncmFwaEluZGV4ID49IDAgJiYgcGFyYWdyYXBoc1twYXJhZ3JhcGhJbmRleF0gfHwgdW5kZWZpbmVkO1xuICBjb25zdCBzcGFucyA9IHBhcmFncmFwaCAmJiBwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGgpO1xuICBjb25zdCBzcGFuID0gc3BhbnMgJiYgc3BhbkluZGV4ICE9PSB1bmRlZmluZWQgLyogPj0gMCAqLyAmJiBzcGFuc1tzcGFuSW5kZXggPT09IC0xID8gc3BhbnMubGVuZ3RoIC0gMSA6IChzcGFuSW5kZXggPj0gc3BhbnMubGVuZ3RoID8gc3BhbnMubGVuZ3RoIC0gMSA6IHNwYW5JbmRleCldIHx8IHVuZGVmaW5lZDtcbiAgcmV0dXJuIHsgcGFyYWdyYXBoLCBzcGFuIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkYXRhUG9pbnRlckZyb21ET01Qb2ludGVyKGRhdGEsIHBvaW50ZXIpIHtcbiAgY29uc29sZS5hc3NlcnQoZGF0YSAhPT0gdW5kZWZpbmVkLCAnZGF0YSBub3Qgc3BlY2lmaWVkJyk7XG4gIGNvbnNvbGUuYXNzZXJ0KHBvaW50ZXIgIT09IHVuZGVmaW5lZCwgJ3BvaW50ZXIgbm90IHNwZWNpZmllZCcpO1xuXG4gIGNvbnN0IHsgc3BhbkF0dHJzLCBwYXJhZ3JhcGhBdHRycyB9ID0gZGF0YURPTU5vZGVzQXROb2RlKHBvaW50ZXIubm9kZSk7XG4gIC8vIGNvbnN0IHsgc3BhbkF0dHJzLCBwYXJhZ3JhcGhBdHRycyB9ID0gZXh0cmFjdEluZm9Gcm9tRE9NUG9pbnRlcihwb2ludGVyKTtcblxuICBjb25zdCBwYXJhZ3JhcGhJRCA9IHBhcmFncmFwaEF0dHJzICYmIHBhcmFncmFwaEF0dHJzLmlkO1xuICBjb25zdCBzcGFuSUQgPSBzcGFuQXR0cnMgJiYgc3BhbkF0dHJzLmlkO1xuXG4gIGNvbnN0IHBhcmFncmFwaHMgPSBkYXRhUGFyYWdyYXBocyhkYXRhKTtcbiAgY29uc3QgeyBwYXJhZ3JhcGhJbmRleCwgcGFyYWdyYXBoLCBzcGFuSW5kZXgsIHNwYW4gfSA9IHBhcmFncmFwaHMgJiYgaWRUb0luZGV4KGRhdGEsIHBhcmFncmFwaElELCBzcGFuSUQpIHx8IHt9O1xuXG4gIHJldHVybiB7IG5vZGU6IHBvaW50ZXIubm9kZSwgc3BhbkF0dHJzLCBwYXJhZ3JhcGhBdHRycywgcGFyYWdyYXBoSUQsIHNwYW5JRCwgcGFyYWdyYXBoSW5kZXgsIHBhcmFncmFwaCwgc3BhbkluZGV4LCBzcGFuLCBvZmZzZXQ6IHBvaW50ZXIub2Zmc2V0IH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzZWxlY3RQb2ludGVyVGV4dE9mZnNldENvbnRhaW5lcihyb290Q29udGFpbmVyLCBwb2ludGVyKSB7XG5cbiAgaWYocG9pbnRlci5zcGFuSUQgJiYgcG9pbnRlci5wYXJhZ3JhcGhJRCkge1xuXG4gICAgcmV0dXJuIHBvaW50ZXIubm9kZTtcblxuICB9IGVsc2UgaWYocG9pbnRlci5wYXJhZ3JhcGhJRCkge1xuXG4gICAgY29uc3QgeyBub2RlIH0gPSBnZXRET01FbGVtZW50RGF0YUF0dHJpYnV0ZXMocG9pbnRlci5ub2RlLCAnRElWJywgWydpZCddKTsgIC8vIHRyeSBwYXJhZ3JhcGggbm9kZVxuXG4gICAgcmV0dXJuIG5vZGU7XG4gIH1cbiAgcmV0dXJuIHJvb3RDb250YWluZXI7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwb2ludGVyVGV4dE9mZnNldEluQ29udGFpbmVyKGNvbnRhaW5lciwgcG9pbnRlcikge1xuICBjb25zdCBvZmZzZXRDb250YWluZXIgPSBzZWxlY3RQb2ludGVyVGV4dE9mZnNldENvbnRhaW5lcihjb250YWluZXIsIHBvaW50ZXIpXG5cbiAgbGV0IHsgbm9kZSwgb2Zmc2V0IH0gPSBwb2ludGVyO1xuXG4gIGlmKG5vZGUubm9kZVR5cGUgPT09IE5vZGUuRUxFTUVOVF9OT0RFKSB7XG4gICAgb2Zmc2V0ID0gMDtcbiAgICBmb3IobGV0IGk9cG9pbnRlci5vZmZzZXQtMTsgaSA+PSAwICYmIGk8bm9kZS5jaGlsZE5vZGVzLmxlbmd0aDsgaS0tKSB7XG4gICAgICBvZmZzZXQgKz0gbm9kZS5jaGlsZE5vZGVzLnRleHRDb250ZW50ICYmIG5vZGUuY2hpbGROb2Rlc1tpXS50ZXh0Q29uZW50Lmxlbmd0aCB8fCAwO1xuICAgIH1cbiAgfVxuXG4gIGxldCBzcGFuSUQsIHBhcmFncmFwaElELCBsZWZ0U3BhbklELCBsZWZ0UGFyYWdyYXBoSUQ7XG5cbiAgd2hpbGUobm9kZSAmJiBub2RlICE9IGNvbnRhaW5lcikge1xuICAgIGlmKG5vZGUubm9kZVR5cGUgPT09IE5vZGUuRUxFTUVOVF9OT0RFKSB7XG4gICAgICBpZihub2RlLm5vZGVOYW1lID09PSAnU1BBTicpIHtcbiAgICAgICAgY29uc3QgaWRBdHRyID0gbm9kZS5hdHRyaWJ1dGVzWydkYXRhLWlkJ107XG4gICAgICAgIHNwYW5JRCA9IGlkQXR0ci5ub2RlVmFsdWU7XG4gICAgICB9XG4gICAgICBpZihub2RlLm5vZGVOYW1lID09PSAnRElWJykge1xuICAgICAgICBjb25zdCBpZEF0dHIgPSBub2RlLmF0dHJpYnV0ZXNbJ2RhdGEtaWQnXTtcbiAgICAgICAgcGFyYWdyYXBoSUQgPSBpZEF0dHIubm9kZVZhbHVlO1xuICAgICAgfVxuICAgIH1cbiAgICBsZXQgbiA9IG5vZGU7XG4gICAgd2hpbGUobiA9IG4ucHJldmlvdXNTaWJsaW5nKSB7XG4gICAgICBpZighbGVmdFNwYW5JRCAmJiBuLm5vZGVOYW1lID09PSAnU1BBTicpIHtcbiAgICAgICAgY29uc3QgaWRBdHRyID0gbi5hdHRyaWJ1dGVzWydkYXRhLWlkJ107XG4gICAgICAgIGxlZnRTcGFuSUQgPSBpZEF0dHIubm9kZVZhbHVlO1xuICAgICAgICBpZighc3BhbklEICYmICFwYXJhZ3JhcGhJRCkge1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZighbGVmdFBhcmFncmFwaElEICYmIG4ubm9kZU5hbWUgPT09ICdESVYnKSB7XG4gICAgICAgIGNvbnN0IGlkQXR0ciA9IG4uYXR0cmlidXRlc1snZGF0YS1pZCddO1xuICAgICAgICBsZWZ0UGFyYWdyYXBoSUQgPSBpZEF0dHIubm9kZVZhbHVlO1xuICAgICAgICBpZighc3BhbklEICYmICFwYXJhZ3JhcGhJRCkge1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZighc3BhbklEICYmICFwYXJhZ3JhcGhJRCkge1xuICAgICAgICAgIGlmKG4udGV4dENvbmVudCkge1xuICAgICAgICAgICAgb2Zmc2V0ICs9IG4udGV4dENvbmVudC5sZW5ndGg7XG4gICAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBub2RlID0gbm9kZS5wYXJlbnROb2RlO1xuICB9XG5cbiAgcG9pbnRlci5zcGFuSUQgPSBzcGFuSUQ7XG4gIHBvaW50ZXIucGFyYWdyYXBoSUQgPSBwYXJhZ3JhcGhJRDtcbiAgcG9pbnRlci5vZmZzZXQgPSBvZmZzZXQ7XG4gIHBvaW50ZXIubGVmdFNwYW5JRCA9IGxlZnRTcGFuSUQ7XG4gIHBvaW50ZXIubGVmdFBhcmFncmFwaElEID0gbGVmdFBhcmFncmFwaElEO1xuXG4gIHJldHVybiBwb2ludGVyO1xufVxuXG4vLyBmcm9tIHBhcnRpYWwgdG8gZnVsbFxuZXhwb3J0IGZ1bmN0aW9uIGRhdGFQb2ludGVyKGRhdGEsIHBvaW50ZXIpIHtcbiAgY29uc29sZS5hc3NlcnQoZGF0YSAhPT0gdW5kZWZpbmVkLCAnZGF0YSBub3Qgc3BlY2lmaWVkJyk7XG4gIGNvbnNvbGUuYXNzZXJ0KHBvaW50ZXIgIT09IHVuZGVmaW5lZCwgJ3BvaW50ZXIgbm90IHNwZWNpZmllZCcpO1xuXG4gIC8vIHBhcmFncmFwaFxuICBpZihwb2ludGVyLnBhcmFncmFwaElEID09PSB1bmRlZmluZWQgJiYgKHBvaW50ZXIucGFyYWdyYXBoSW5kZXggPT09IHVuZGVmaW5lZCB8fCBwb2ludGVyLnBhcmFncmFwaEluZGV4ID09PSAtMSkpIHtcbiAgICAvLyBubyBwYXJhZ3JhcGgsIGhhdmUgdG8gY2hlY2sgZm9yIG5vZGVcbiAgICBjb25zb2xlLmFzc2VydChwb2ludGVyLm5vZGUgIT09IHVuZGVmaW5lZCwgJ2ludmFsaWQgcG9pbnRlciwgbm8gcGFyYWdyYXBoIGluZm8gYW5kIG5vIG5vZGUnKVxuICAgIHJldHVybiBPYmplY3QuYXNzaWduKHBvaW50ZXIsIGRhdGFQb2ludGVyRnJvbURPTVBvaW50ZXIoZGF0YSwgcG9pbnRlcikpO1xuICB9IGVsc2UgaWYocG9pbnRlci5wYXJhZ3JhcGhJRCAhPT0gdW5kZWZpbmVkICYmIChwb2ludGVyLnBhcmFncmFwaEluZGV4ID09PSB1bmRlZmluZWQgfHwgcG9pbnRlci5wYXJhZ3JhcGhJbmRleCA9PT0gLTEpKSB7XG4gICAgLy8gaGFzIHBhcmFncmFwaCBpZCwgcGFyYWdyYXBoIGluZGV4IGlzIG1pc3NpbmdcbiAgICBjb25zdCB7IHBhcmFncmFwaEluZGV4LCBwYXJhZ3JhcGgsIHNwYW5JbmRleCwgc3BhbiB9ID0gaWRUb0luZGV4KGRhdGEsIHBvaW50ZXIucGFyYWdyYXBoSUQsIHBvaW50ZXIuc3BhbklEKTtcblxuICAgIGNvbnNvbGUuYXNzZXJ0KHBhcmFncmFwaCwgJ3BhcmFncmFwaCBub3QgcmVzb2x2ZWQnKTtcbiAgICBjb25zb2xlLmFzc2VydChwb2ludGVyLnNwYW5JRCAmJiBzcGFuIHx8IHBvaW50ZXIuc3BhbklEID09PSB1bmRlZmluZWQsICdzcGFuIG5vdCByZXNvbHZlZCwgYnV0IHNwYW4gaWQgaXMgc2V0Jyk7XG5cbiAgICBPYmplY3QuYXNzaWduKHBvaW50ZXIsIHsgcGFyYWdyYXBoSW5kZXgsIHBhcmFncmFwaCB9KTtcbiAgICAvLyBpZihwb2ludGVyLnNwYW5JRCAhPT0gdW5kZWZpbmVkICYmIChzcGFuSW5kZXggPT09IHVuZGVmaW5lZCB8fCBzcGFuSW5kZXggPT09IC0xKSkge1xuICAgIC8vICAgcG9pbnRlci5zcGFuSW5kZXggPSBzcGFuSW5kZXg7XG4gICAgLy8gfVxuICAgIGlmKHBvaW50ZXIuc3BhbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBwb2ludGVyLnNwYW4gPSBzcGFuO1xuICAgIH1cbiAgfSBlbHNlIGlmKHBvaW50ZXIucGFyYWdyYXBoSUQgPT09IHVuZGVmaW5lZCAmJiAocG9pbnRlci5wYXJhZ3JhcGhJbmRleCAhPT0gdW5kZWZpbmVkIHx8IHBvaW50ZXIucGFyYWdyYXBoSW5kZXggIT09IC0xKSkge1xuICAgIC8vIHBhcmFncmFwaCBpZCBpcyBtaXNzaW5nLCBoYXMgcGFyYWdyYXBoIGluZGV4XG4gICAgY29uc3QgeyBwYXJhZ3JhcGgsIHNwYW4gfSA9IGRhdGFBdEluZGV4KGRhdGEsIHBvaW50ZXIucGFyYWdyYXBoSW5kZXgsIHBvaW50ZXIuc3BhbkluZGV4KTtcblxuICAgIGNvbnNvbGUuYXNzZXJ0KHBhcmFncmFwaCwgJ3BhcmFncmFwaCBub3QgcmVzb2x2ZWQnKTtcbiAgICBjb25zb2xlLmFzc2VydChwb2ludGVyLnNwYW5JbmRleCAhPT0gdW5kZWZpbmVkICYmIC8qIHBvaW50ZXIuc3BhbkluZGV4ICE9PSAtMSAmJiAqLyBzcGFuIHx8IHBvaW50ZXIuc3BhbkluZGV4ID09PSB1bmRlZmluZWQgLy8gfHwgcG9pbnRlci5zcGFuSW5kZXggPT09IC0xXG4gICAgICB8fCBwYXJhZ3JhcGhTcGFucyhkYXRhUGFyYWdyYXBocyhkYXRhKVtwb2ludGVyLnBhcmFncmFwaEluZGV4XSkubGVuZ3RoID09PSAwLFxuICAgICAgJ3NwYW4gbm90IHJlc29sdmVkLCBidXQgc3BhbiBpbmRleCBpcyBzZXRaJyk7XG5cbiAgICBPYmplY3QuYXNzaWduKHBvaW50ZXIsIHsgcGFyYWdyYXBoLCBwYXJhZ3JhcGhJRDogcGFyYWdyYXBoLmlkIH0pO1xuICAgIGlmKHNwYW4gJiYgKHBvaW50ZXIuc3BhbiA9PT0gdW5kZWZpbmVkIHx8IHBvaW50ZXIuc3BhbklEID09PSB1bmRlZmluZWQpKSB7XG4gICAgICBPYmplY3QuYXNzaWduKHBvaW50ZXIsIHsgc3Bhbiwgc3BhbklEOiBzcGFuLmlkIH0pO1xuICAgIH1cbiAgfVxuXG4gIGlmKHBvaW50ZXIuc3BhbklEID09PSB1bmRlZmluZWQgJiYgKHBvaW50ZXIuc3BhbkluZGV4ID09PSB1bmRlZmluZWQgLyogfHwgcG9pbnRlci5zcGFuSW5kZXggPT09IC0xICovKSkge1xuICAgIC8vIG5vIHNwYW4sIGhhdmUgdG8gY2hlY2sgZm9yIG5vZGVcbiAgICAvLyBjb25zb2xlLmFzc2VydChwb2ludGVyLm5vZGUgIT09IHVuZGVmaW5lZCwgJ2ludmFsaWQgcG9pbnRlciwgbm8gc3BhbiBpbmZvIGFuZCBubyBub2RlJylcbiAgICBpZihwb2ludGVyLm5vZGUpIHtcbiAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHBvaW50ZXIsIGRhdGFQb2ludGVyRnJvbURPTVBvaW50ZXIoZGF0YSwgcG9pbnRlcikpO1xuICAgIH1cbiAgfSBlbHNlIGlmKHBvaW50ZXIuc3BhbklEICE9PSB1bmRlZmluZWQgJiYgKHBvaW50ZXIuc3BhbkluZGV4ID09PSB1bmRlZmluZWQgLyogfHwgcG9pbnRlci5zcGFuSW5kZXggPT09IC0xICovKSkge1xuICAgIE9iamVjdC5hc3NpZ24ocG9pbnRlciwgaWRUb0luZGV4KGRhdGEsIHBvaW50ZXIucGFyYWdyYXBoSUQsIHBvaW50ZXIuc3BhbklEKSk7XG5cbiAgICBjb25zb2xlLmFzc2VydChwb2ludGVyLnBhcmFncmFwaCwgJ3BhcmFncmFwaCBub3QgcmVzb2x2ZWQnKTtcbiAgICBjb25zb2xlLmFzc2VydCgvKnBvaW50ZXIuc3BhbklEICE9PSB1bmRlZmluZWQgJiYqLyAvKiBwb2ludGVyLnNwYW5JbmRleCAhPT0gLTEgJiYgKi8gcG9pbnRlci5zcGFuSW5kZXggIT09IHVuZGVmaW5lZCAmJiBwb2ludGVyLnNwYW4sXG4gICAgICAnc3BhbiBub3QgcmVzb2x2ZWQsIGJ1dCBzcGFuIGlkIGlzIHNldFknKTtcblxuICB9IGVsc2UgaWYocG9pbnRlci5zcGFuSUQgPT09IHVuZGVmaW5lZCAmJiAocG9pbnRlci5zcGFuSW5kZXggIT09IHVuZGVmaW5lZCAvKiAmJiBwb2ludGVyLnNwYW5JbmRleCAhPT0gLTEgKi8pKSB7XG4gICAgY29uc3QgeyBwYXJhZ3JhcGgsIHNwYW4gfSA9IGRhdGFBdEluZGV4KGRhdGEsIHBvaW50ZXIucGFyYWdyYXBoSW5kZXgsIHBvaW50ZXIuc3BhbkluZGV4KTtcbiAgICBjb25zdCBzcGFucyA9IHBhcmFncmFwaFNwYW5zKHBhcmFncmFwaCk7XG4gICAgaWYocG9pbnRlci5zcGFuSW5kZXggPj0gc3BhbnMubGVuZ3RoICYmIHNwYW5zLmxlbmd0aCA+IDApIHtcbiAgICAgIC8vIGlmIHBvaW50ZXIgaXMgcGFzdCB0aGUgZW5kIG9mIHBhcmFncmFwaCwgcG9pbnQgaXQgdG8gdGhlIGVuZCBvZiBwYXJhZ3JhcGhcbiAgICAgIHBvaW50ZXIuc3BhbkluZGV4ID0gc3BhbnMubGVuZ3RoIC0gMTtcbiAgICAgIHBvaW50ZXIub2Zmc2V0ID0gc3BhbnNbc3BhbnMubGVuZ3RoIC0gMV0udGV4dC5sZW5ndGg7XG4gICAgfVxuXG4gICAgY29uc29sZS5hc3NlcnQocG9pbnRlci5wYXJhZ3JhcGgsICdwYXJhZ3JhcGggbm90IHJlc29sdmVkJyk7XG4gICAgY29uc29sZS5hc3NlcnQoLypwb2ludGVyLnNwYW5JbmRleCAhPT0gLTEgJiYgcG9pbnRlci5zcGFuSW5kZXggIT09IHVuZGVmaW5lZCAmJiovIHNwYW4gfHwgcGFyYWdyYXBoU3BhbnMoZGF0YVBhcmFncmFwaHMoZGF0YSlbcG9pbnRlci5wYXJhZ3JhcGhJbmRleF0pLmxlbmd0aCA9PT0gMCxcbiAgICAgICdzcGFuIG5vdCByZXNvbHZlZCwgYnV0IHNwYW4gaW5kZXggaXMgc2V0Jyk7XG5cbiAgICBPYmplY3QuYXNzaWduKHBvaW50ZXIsIHsgcGFyYWdyYXBoLCBwYXJhZ3JhcGhJRDogcGFyYWdyYXBoLmlkLCBzcGFuLCBzcGFuSUQ6IHNwYW4gJiYgc3Bhbi5pZCwgc3BhbkluZGV4OiBzcGFuICYmIHBvaW50ZXIuc3BhbkluZGV4IH0pO1xuICB9XG5cbiAgaWYocG9pbnRlci5wYXJhZ3JhcGhJbmRleCAhPSB1bmRlZmluZWQgJiYgcG9pbnRlci5wYXJhZ3JhcGhJbmRleCAhPSAtMSAmJiBwb2ludGVyLnNwYW5JbmRleCAhPSB1bmRlZmluZWQgLyogJiYgcG9pbnRlci5zcGFuSW5kZXggIT0gLTEgKi8pIHtcbiAgICBjb25zdCBwYXJhZ3JhcGhzID0gZGF0YVBhcmFncmFwaHMoZGF0YSk7XG4gICAgY29uc3Qgc3BhbnMgPSBwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGhzW3BvaW50ZXIucGFyYWdyYXBoSW5kZXhdKTtcbiAgICBpZihzcGFucy5sZW5ndGggPiAwKSB7XG4gICAgICBpZihwb2ludGVyLnNwYW5JbmRleCA9PT0gLTEpIHtcbiAgICAgICAgcG9pbnRlci5zcGFuSW5kZXggPSBzcGFucy5sZW5ndGggLSAxO1xuICAgICAgfVxuICAgICAgaWYocG9pbnRlci5vZmZzZXQgPCAwKSB7XG4gICAgICAgIHBvaW50ZXIub2Zmc2V0ID0gc3BhbnNbcG9pbnRlci5zcGFuSW5kZXhdLnRleHQubGVuZ3RoICsgMSArIHBvaW50ZXIub2Zmc2V0OyAvLyBmcm9tIHRoZSBlbmQgb2Ygc3BhbjogdGhpcyBpcyBkaWZmZXJlbnQgdGhhbiBpbiBweXRob24sIGl0J3Mgc2hpZnRlZCBieSBvbmUsIGkuZS4sIC0xIGlzIGxlblxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBwb2ludGVyO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGF0YVBvaW50ZXJQcmV2KGRhdGEsIHBvaW50ZXIsIG9mZnNldCkge1xuICBjb25zb2xlLmFzc2VydChkYXRhICE9PSB1bmRlZmluZWQsICdkYXRhIG5vdCBzZXQnKTtcbiAgY29uc29sZS5hc3NlcnQocG9pbnRlci5wYXJhZ3JhcGhJbmRleCA+PSAwLCAncG9pbnRlciBwYXJhZ3JhcGhJbmRleCBtaXNzaW5nIG9yIGludmFsaWQnKTtcblxuICBjb25zdCBwYXJhZ3JhcGhzID0gZGF0YVBhcmFncmFwaHMoZGF0YSk7XG5cbiAgbGV0IHBhcmFncmFwaEluZGV4ID0gcG9pbnRlci5wYXJhZ3JhcGhJbmRleDtcbiAgbGV0IHNwYW5JbmRleCA9IHBvaW50ZXIuc3BhbkluZGV4O1xuXG4gIGlmKHNwYW5JbmRleCAhPT0gdW5kZWZpbmVkICYmIHNwYW5JbmRleCAhPT0gLTEpIHtcbiAgICBpZihzcGFuSW5kZXggPiAwKSB7XG4gICAgICBzcGFuSW5kZXgtLTtcbiAgICB9IGVsc2UgaWYocGFyYWdyYXBoSW5kZXggPiAwKSB7XG4gICAgICBwYXJhZ3JhcGhJbmRleC0tO1xuICAgICAgaWYocGFyYWdyYXBoU3BhbnMocGFyYWdyYXBoc1twYXJhZ3JhcGhJbmRleF0pLmxlbmd0aCA+IDApIHtcbiAgICAgICAgc3BhbkluZGV4ID0gcGFyYWdyYXBoU3BhbnMocGFyYWdyYXBoc1twYXJhZ3JhcGhJbmRleF0pLmxlbmd0aCAtIDE7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzcGFuSW5kZXggPSB1bmRlZmluZWQ7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gIH0gZWxzZSBpZihwYXJhZ3JhcGhJbmRleCA+IDApIHtcbiAgICBwYXJhZ3JhcGhJbmRleC0tO1xuICAgIGlmKHBhcmFncmFwaFNwYW5zKHBhcmFncmFwaHNbcGFyYWdyYXBoSW5kZXhdKS5sZW5ndGggPiAwKSB7XG4gICAgICBzcGFuSW5kZXggPSBwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGhzW3BhcmFncmFwaEluZGV4XSkubGVuZ3RoIC0gMTtcbiAgICB9IGVsc2Uge1xuICAgICAgc3BhbkluZGV4ID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZihvZmZzZXQgPT09IHVuZGVmaW5lZCkge1xuICAgIG9mZnNldCA9IC0xO1xuICB9XG5cbiAgcmV0dXJuIGRhdGFQb2ludGVyKGRhdGEsIHsgcGFyYWdyYXBoSW5kZXgsIHNwYW5JbmRleCwgb2Zmc2V0IH0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGF0YVBvaW50ZXJOZXh0KGRhdGEsIHBvaW50ZXIsIG9mZnNldCkge1xuICBjb25zb2xlLmFzc2VydChkYXRhICE9PSB1bmRlZmluZWQsICdkYXRhIG5vdCBzZXQnKTtcbiAgY29uc29sZS5hc3NlcnQocG9pbnRlci5wYXJhZ3JhcGhJbmRleCA+PSAwLCAncG9pbnRlciBwYXJhZ3JhcGhJbmRleCBtaXNzaW5nIG9yIGludmFsaWQnKTtcblxuICBjb25zdCBwYXJhZ3JhcGhzID0gZGF0YVBhcmFncmFwaHMoZGF0YSk7XG5cbiAgbGV0IHBhcmFncmFwaEluZGV4ID0gcG9pbnRlci5wYXJhZ3JhcGhJbmRleDtcbiAgbGV0IHNwYW5JbmRleCA9IHBvaW50ZXIuc3BhbkluZGV4O1xuXG4gIGlmKHNwYW5JbmRleCAhPT0gdW5kZWZpbmVkICYmIHNwYW5JbmRleCAhPT0gLTEpIHtcbiAgICBpZihzcGFuSW5kZXggPCBwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGhzW3BhcmFncmFwaEluZGV4XSkubGVuZ3RoIC0gMSkge1xuICAgICAgc3BhbkluZGV4Kys7XG4gICAgfSBlbHNlIGlmKHBhcmFncmFwaEluZGV4IDwgcGFyYWdyYXBocy5sZW5ndGggLSAxKSB7XG4gICAgICBwYXJhZ3JhcGhJbmRleCsrO1xuICAgICAgaWYocGFyYWdyYXBoU3BhbnMocGFyYWdyYXBoc1twYXJhZ3JhcGhJbmRleF0pLmxlbmd0aCA+IDApIHtcbiAgICAgICAgc3BhbkluZGV4ID0gMFxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc3BhbkluZGV4ID0gdW5kZWZpbmVkO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICB9IGVsc2UgaWYocGFyYWdyYXBoSW5kZXggPCBwYXJhZ3JhcGhzLmxlbmd0aCAtIDEpIHtcbiAgICBwYXJhZ3JhcGhJbmRleCsrO1xuICAgIGlmKHBhcmFncmFwaFNwYW5zKHBhcmFncmFwaHNbcGFyYWdyYXBoSW5kZXhdKS5sZW5ndGggPiAwKSB7XG4gICAgICBzcGFuSW5kZXggPSAwO1xuICAgIH0gZWxzZSB7XG4gICAgICBzcGFuSW5kZXggPSB1bmRlZmluZWQ7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmKG9mZnNldCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgb2Zmc2V0ID0gMDtcbiAgfVxuXG4gIHJldHVybiBkYXRhUG9pbnRlcihkYXRhLCB7IHBhcmFncmFwaEluZGV4LCBzcGFuSW5kZXgsIG9mZnNldCB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRhdGFQb2ludGVyUHJldlNwYW4oZGF0YSwgcG9pbnRlcikge1xuICBjb25zb2xlLmFzc2VydChkYXRhICE9PSB1bmRlZmluZWQsICdkYXRhIG5vdCBzZXQnKTtcbiAgLy8gY29uc29sZS5hc3NlcnQocG9pbnRlci5wYXJhZ3JhcGhJRCAhPT0gdW5kZWZpbmVkLCAncG9pbnRlciBwYXJhZ3JhcGhJRCBtaXNzaW5nJyk7XG4gIGNvbnNvbGUuYXNzZXJ0KHBvaW50ZXIucGFyYWdyYXBoSW5kZXggPj0gMCwgJ3BvaW50ZXIgcGFyYWdyYXBoSW5kZXggbWlzc2luZyBvciBpbnZhbGlkJyk7XG5cbiAgY29uc3QgcGFyYWdyYXBocyA9IGRhdGFQYXJhZ3JhcGhzKGRhdGEpO1xuICBsZXQgcGFyYWdyYXBoSW5kZXggPSBwb2ludGVyLnBhcmFncmFwaEluZGV4O1xuICBsZXQgc3BhbkluZGV4ID0gcG9pbnRlci5zcGFuSW5kZXggPj0gMCA/IHBvaW50ZXIuc3BhbkluZGV4IDogMDtcbiAgd2hpbGUocGFyYWdyYXBoSW5kZXggPj0gMCkge1xuICAgIHNwYW5JbmRleC0tO1xuICAgIGlmKHNwYW5JbmRleCA8IDApIHtcbiAgICAgIHBhcmFncmFwaEluZGV4LS07XG4gICAgICBpZihwYXJhZ3JhcGhJbmRleCA8IDApIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBzcGFuSW5kZXggPSBwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGhzW3BhcmFncmFwaEluZGV4XSkubGVuZ3RoIC0gMTtcbiAgICB9XG4gICAgaWYoc3BhbkluZGV4ID49IDAgJiYgcGFyYWdyYXBoSW5kZXggPj0gMCkge1xuICAgICAgcmV0dXJuIGRhdGFQb2ludGVyKGRhdGEsIHsgcGFyYWdyYXBoSW5kZXgsIHNwYW5JbmRleCB9KTtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRhdGFQb2ludGVyTmV4dFNwYW4oZGF0YSwgcG9pbnRlcikge1xuICBjb25zb2xlLmFzc2VydChkYXRhICE9PSB1bmRlZmluZWQsICdkYXRhIG5vdCBzZXQnKTtcbiAgLy8gY29uc29sZS5hc3NlcnQocG9pbnRlci5wYXJhZ3JhcGhJRCAhPT0gdW5kZWZpbmVkLCAncG9pbnRlciBwYXJhZ3JhcGhJRCBtaXNzaW5nJyk7XG4gIGNvbnNvbGUuYXNzZXJ0KHBvaW50ZXIucGFyYWdyYXBoSW5kZXggPj0gMCwgJ3BvaW50ZXIgcGFyYWdyYXBoSW5kZXggbWlzc2luZyBvciBpbnZhbGlkJyk7XG5cbiAgY29uc3QgcGFyYWdyYXBocyA9IGRhdGFQYXJhZ3JhcGhzKGRhdGEpO1xuICBsZXQgcGFyYWdyYXBoSW5kZXggPSBwb2ludGVyLnBhcmFncmFwaEluZGV4O1xuICBsZXQgc3BhbkluZGV4ID0gcG9pbnRlci5zcGFuSW5kZXggPj0gMCA/IHBvaW50ZXIuc3BhbkluZGV4IDogcGFyYWdyYXBoc1twYXJhZ3JhcGhJbmRleF0uc3BhbnMubGVuZ3RoO1xuICB3aGlsZShwYXJhZ3JhcGhJbmRleCA8IHBhcmFncmFwaHMubGVuZ3RoKSB7XG4gICAgc3BhbkluZGV4Kys7XG4gICAgaWYoc3BhbkluZGV4ID49IHBhcmFncmFwaHNbcGFyYWdyYXBoSW5kZXhdLnNwYW5zLmxlbmd0aCkge1xuICAgICAgcGFyYWdyYXBoSW5kZXgrKztcbiAgICAgIGlmKHBhcmFncmFwaEluZGV4ID49IHBhcmFncmFwaHMubGVuZ3RoKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgc3BhbkluZGV4ID0gMDtcbiAgICB9XG4gICAgaWYocGFyYWdyYXBoSW5kZXggPCBwYXJhZ3JhcGhzLmxlbmd0aCAmJiBzcGFuSW5kZXggPCBwYXJhZ3JhcGhzW3BhcmFncmFwaEluZGV4XS5zcGFucy5sZW5ndGgpIHtcbiAgICAgIHJldHVybiBkYXRhUG9pbnRlcihkYXRhLCB7IHBhcmFncmFwaEluZGV4LCBzcGFuSW5kZXggfSk7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBjb25zdCBTcGxpY2VNb2RlID0gT2JqZWN0LmZyZWV6ZSh7XG4gIFJlbW92ZTogMSxcbiAgSW5QbGFjZTogMixcbiAgQ29weTogMyxcbn0pO1xuXG5leHBvcnQgZnVuY3Rpb24gc3BsaWNlU3BhbnMoc3BhbnMsIHN0YXJ0SW5kZXgsIHN0YXJ0T2Zmc2V0LCBlbmRJbmRleCwgZW5kT2Zmc2V0LCBtb2RlID0gU3BsaWNlTW9kZS5SZW1vdmUpIHtcbiAgaWYoc3RhcnRJbmRleCA9PSB1bmRlZmluZWQpIHtcbiAgICBzdGFydEluZGV4ID0gMDtcbiAgfVxuICBpZihzdGFydE9mZnNldCA9PSB1bmRlZmluZWQgfHwgc3RhcnRPZmZzZXQgPCAwKSB7XG4gICAgc3RhcnRPZmZzZXQgPSAwO1xuICB9XG4gIGlmKGVuZEluZGV4ID09IHVuZGVmaW5lZCB8fCBlbmRJbmRleCA+PSBzcGFucy5sZW5ndGgpIHtcbiAgICBlbmRJbmRleCA9IHNwYW5zLmxlbmd0aCAtIDE7XG4gIH1cbiAgY29uc3QgZW5kU3Bhbkxlbmd0aCA9IHNwYW5zW2VuZEluZGV4XS50ZXh0Lmxlbmd0aFxuICBpZihlbmRPZmZzZXQgPT09IHVuZGVmaW5lZCB8fCBlbmRPZmZzZXQgPiBlbmRTcGFuTGVuZ3RoKSB7XG4gICAgZW5kT2Zmc2V0ID0gZW5kU3Bhbkxlbmd0aDtcbiAgfVxuICBpZihlbmRPZmZzZXQgPCAwKSB7XG4gICAgZW5kT2Zmc2V0ID0gMDtcbiAgfVxuICBpZihzdGFydE9mZnNldCA+IHNwYW5zW3N0YXJ0SW5kZXhdLnRleHQubGVuZ3RoKSB7XG4gICAgc3RhcnRPZmZzZXQgPSBzcGFuc1tzdGFydEluZGV4XS50ZXh0Lmxlbmd0aDtcbiAgfVxuICBpZihzdGFydEluZGV4ID09PSBlbmRJbmRleCkge1xuICAgIGlmKGVuZE9mZnNldCA8IHN0YXJ0T2Zmc2V0KSB7XG4gICAgICBlbmRPZmZzZXQgPSBzdGFydE9mZnNldFxuICAgIH1cbiAgICBpZihtb2RlID09PSBTcGxpY2VNb2RlLlJlbW92ZSkge1xuICAgICAgY29uc3Qgc3BhbiA9IHNwYW5zW3N0YXJ0SW5kZXhdO1xuICAgICAgY29uc3QgcmVtb3ZlZFNwYW5UZXh0ID0gc3Bhbi50ZXh0LnN1YnN0cmluZyhzdGFydE9mZnNldCwgZW5kT2Zmc2V0KTtcbiAgICAgIHNwYW4udGV4dCA9IHNwYW4udGV4dC5zdWJzdHJpbmcoMCwgc3RhcnRPZmZzZXQpICsgc3Bhbi50ZXh0LnN1YnN0cmluZyhlbmRPZmZzZXQpO1xuICAgICAgY29uc3QgcmVtb3ZlZFNwYW5zID0gW107XG4gICAgICBpZihyZW1vdmVkU3BhblRleHQubGVuZ3RoID4gMCkge1xuICAgICAgICByZW1vdmVkU3BhbnMucHVzaChjb3B5U3BhbihzcGFuLCB7IHRleHQ6IHJlbW92ZWRTcGFuVGV4dCB9KSk7XG4gICAgICB9XG4gICAgICByZXR1cm4geyBzcGFuczogcmVtb3ZlZFNwYW5zLCBzcGxpdEluZGV4OiBzdGFydEluZGV4LCBzcGxpdE9mZnNldDogc3RhcnRPZmZzZXQsIHJlbW92ZWRTcGFuVGV4dCB9O1xuICAgIH0gZWxzZSBpZihtb2RlID09PSBTcGxpY2VNb2RlLkluUGxhY2UpIHtcbiAgICAgIC8vIGNvbnNvbGUubG9nKGBpblBsYWNlICBzdGFydEluZGV4PSR7c3RhcnRJbmRleH0gICBzdGFydE9mZnNldD0ke3N0YXJ0T2Zmc2V0fSAgZW5kSW5kZXg9JHtlbmRJbmRleH0gICBlbmRPZmZzZXQ9JHtlbmRPZmZzZXR9YClcbiAgICAgIC8vIHJlcGxhY2Ugb3JpZ2luYWwgc3BhbiB3aXRoIG9yaWdpbmFsICsgdHdvIG1vcmUgcGFydHNcbiAgICAgIGNvbnN0IHNwYW4gPSBzcGFuc1tzdGFydEluZGV4XTtcbiAgICAgIGlmKHN0YXJ0T2Zmc2V0ID09PSAwICYmIGVuZE9mZnNldCA+PSBzcGFuLnRleHQubGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiB7IHNwYW5zOiBbc3Bhbl0sIHNwbGl0SW5kZXg6IHN0YXJ0SW5kZXgsIHNwbGl0T2Zmc2V0OiBzdGFydE9mZnNldCB9O1xuICAgICAgfSBlbHNlIGlmKHN0YXJ0T2Zmc2V0ID09PSBlbmRPZmZzZXQpIHtcbiAgICAgICAgaWYoc3RhcnRPZmZzZXQgPT09IDApIHtcbiAgICAgICAgICByZXR1cm4geyByaWdodDogc3Bhbiwgc3BhbnM6IFtdLCBzcGxpdEluZGV4OiBzdGFydEluZGV4LCBzcGxpdE9mZnNldDogc3RhcnRPZmZzZXQgfTtcbiAgICAgICAgfSBlbHNlIGlmKGVuZE9mZnNldCA+PSBzcGFuLnRleHQubGVuZ3RoKSB7XG4gICAgICAgICAgcmV0dXJuIHsgbGVmdDogc3Bhbiwgc3BhbnM6IFtdLCBzcGxpdEluZGV4OiBzdGFydEluZGV4ICsgMSwgc3BsaXRPZmZzZXQ6IDAgfTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBsZXQgeyBsZWZ0LCByaWdodCB9ID0gc3BsaXRTcGFuKHNwYW4sIHN0YXJ0T2Zmc2V0KTtcbiAgICAgICAgICBzcGFucy5zcGxpY2Uoc3RhcnRJbmRleCwgMSwgLi4uW2xlZnQsIHJpZ2h0XS5maWx0ZXIocyA9PiBzLnRleHQubGVuZ3RoID4gMCkpO1xuICAgICAgICAgIHJldHVybiB7IGxlZnQsIHJpZ2h0LCBzcGFuczogW10sIHNwbGl0SW5kZXg6IHN0YXJ0SW5kZXggKyAxLCBzcGxpdE9mZnNldDogMCB9O1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYoc3RhcnRPZmZzZXQgPT09IDApIHtcbiAgICAgICAgbGV0IHsgbGVmdDogbWlkLCByaWdodCB9ID0gc3BsaXRTcGFuKHNwYW4sIGVuZE9mZnNldCk7XG4gICAgICAgIHNwYW5zLnNwbGljZShzdGFydEluZGV4LCAxLCAuLi5bbWlkLCByaWdodF0uZmlsdGVyKHMgPT4gcy50ZXh0Lmxlbmd0aCA+IDApKTtcbiAgICAgICAgcmV0dXJuIHsgcmlnaHQsIHNwYW5zOiBbbWlkXSwgc3BsaXRJbmRleDogc3RhcnRJbmRleCwgc3BsaXRPZmZzZXQ6IHN0YXJ0T2Zmc2V0IH07XG4gICAgICB9IGVsc2UgaWYoZW5kT2Zmc2V0ID49IHNwYW4udGV4dC5sZW5ndGgpIHtcbiAgICAgICAgbGV0IHsgbGVmdCwgcmlnaHQ6IG1pZCB9ID0gc3BsaXRTcGFuKHNwYW4sIHN0YXJ0T2Zmc2V0KTtcbiAgICAgICAgc3BhbnMuc3BsaWNlKHN0YXJ0SW5kZXgsIDEsIC4uLltsZWZ0LCBtaWRdLmZpbHRlcihzID0+IHMudGV4dC5sZW5ndGggPiAwKSk7XG4gICAgICAgIHJldHVybiB7IGxlZnQsIHNwYW5zOiBbbWlkXSwgc3BsaXRJbmRleDogc3RhcnRJbmRleCArIDEsIHNwbGl0T2Zmc2V0OiBzdGFydE9mZnNldCB9O1xuICAgICAgfVxuICAgICAgLy8gaWYoc3RhcnRPZmZzZXQgPT09IGVuZE9mZnNldCkge1xuICAgICAgLy8gICBpZihzdGFydE9mZnNldCA9PSAwIHx8IHN0YXJ0T2Zmc2V0ID49IHNwYW4udGV4dC5sZW5ndGgpIHtcbiAgICAgIC8vICAgICByZXR1cm4geyBzcGFuczogW10sIHNwbGl0SW5kZXg6IHN0YXJ0SW5kZXgsIHNwbGl0T2Zmc2V0OiBzdGFydE9mZnNldCB9O1xuICAgICAgLy8gICB9XG4gICAgICAvLyAgIGxldCB7IGxlZnQsIHJpZ2h0IH0gPSBzcGxpdFNwYW4oc3Bhbiwgc3RhcnRPZmZzZXQpO1xuICAgICAgLy8gICBzcGFucy5zcGxpY2Uoc3RhcnRJbmRleCwgMSwgbGVmdCwgcmlnaHQpO1xuICAgICAgLy8gICByZXR1cm4geyBzcGFuczogW10sIHNwbGl0SW5kZXg6IHN0YXJ0SW5kZXggKyAxLCBzcGxpdE9mZnNldDogMCB9O1xuICAgICAgLy8gfVxuICAgICAgbGV0IHsgbGVmdCwgcmlnaHQ6IG1pZHJpZ2h0IH0gPSBzcGxpdFNwYW4oc3Bhbiwgc3RhcnRPZmZzZXQpO1xuICAgICAgbGV0IHsgbGVmdDogbWlkLCByaWdodCB9ID0gc3BsaXRTcGFuKG1pZHJpZ2h0LCBlbmRPZmZzZXQgLSBzdGFydE9mZnNldCk7XG4gICAgICBzcGFucy5zcGxpY2Uoc3RhcnRJbmRleCwgMSwgLi4uW2xlZnQsIG1pZCwgcmlnaHRdLmZpbHRlcihzID0+IHMudGV4dC5sZW5ndGggPiAwKSk7XG4gICAgICByZXR1cm4geyBsZWZ0LCByaWdodCwgc3BhbnM6IFttaWRdLCBzcGxpdEluZGV4OiBzdGFydEluZGV4ICsgMSwgc3BsaXRPZmZzZXQ6IDAgLypzdGFydE9mZnNldCovIH07XG4gICAgfSBlbHNlIGlmKG1vZGUgPT09IFNwbGljZU1vZGUuQ29weSkge1xuICAgICAgY29uc3Qgc3BhbiA9IHNwYW5zW3N0YXJ0SW5kZXhdO1xuICAgICAgY29uc3QgcmVtb3ZlZFNwYW5UZXh0ID0gc3Bhbi50ZXh0LnN1YnN0cmluZyhzdGFydE9mZnNldCwgZW5kT2Zmc2V0KTtcbiAgICAgIC8vIHNwYW4udGV4dCA9IHNwYW4udGV4dC5zdWJzdHJpbmcoMCwgc3RhcnRPZmZzZXQpICsgc3Bhbi50ZXh0LnN1YnN0cmluZyhlbmRPZmZzZXQpO1xuICAgICAgY29uc3QgY29waWVkU3BhbnMgPSBbXTtcbiAgICAgIGlmKHJlbW92ZWRTcGFuVGV4dC5sZW5ndGggPiAwKSB7XG4gICAgICAgIGNvcGllZFNwYW5zLnB1c2goY29weVNwYW4oc3BhbiwgeyB0ZXh0OiByZW1vdmVkU3BhblRleHQsIGdyb3VwOiBzcGFuLmlkIH0pKTsgIC8vIFRPRE86IG5ldyBpZCA/Pz9cbiAgICAgIH1cbiAgICAgIHJldHVybiB7IHNwYW5zOiBjb3BpZWRTcGFucywgc3BsaXRJbmRleDogc3RhcnRJbmRleCwgc3BsaXRPZmZzZXQ6IHN0YXJ0T2Zmc2V0IH07XG4gICAgfVxuICB9XG5cbiAgaWYoZW5kSW5kZXggPT09IHN0YXJ0SW5kZXggKyAxICYmIGVuZE9mZnNldCA9PT0gMCAmJiBzdGFydE9mZnNldCA+PSBzcGFuc1tzdGFydEluZGV4XS50ZXh0Lmxlbmd0aCkge1xuICAgIC8vIGNvbGxhcHNlZCBwb3NpdGlvbiBvbiBzcGFuIHNwYW4gYm9yZGVyIGZyb20gYm90aCBzaWRlc1xuICAgIHJldHVybiB7IHNwYW5zOiBbXSwgc3BsaXRJbmRleDogc3RhcnRJbmRleCwgc3BsaXRPZmZzZXQ6IHN0YXJ0T2Zmc2V0IH07XG4gIH1cblxuICBjb25zdCBzcGxpY2VTdGFydCA9IHN0YXJ0T2Zmc2V0ID09PSAwID8gc3RhcnRJbmRleCA6IHN0YXJ0SW5kZXggKyAxO1xuICBjb25zdCBzcGxpY2VFbmQgPSBlbmRPZmZzZXQgPj0gZW5kU3Bhbkxlbmd0aCA/IGVuZEluZGV4IDogZW5kSW5kZXggLSAxO1xuICAvLyBbc3BsaWNlU3RhcnQsIHNwbGljZUVuZF0gLSBvbmx5IHdob2xlICh1c3VhbGx5IGlubmVyIG9ubHkpIHNwYW5zXG5cbiAgaWYobW9kZSA9PT0gU3BsaWNlTW9kZS5SZW1vdmUpIHtcblxuICAgIGNvbnN0IHJlbW92ZWRTcGFucyA9IHNwYW5zLnNwbGljZShzcGxpY2VTdGFydCwgc3BsaWNlRW5kICsgMSAtIHNwbGljZVN0YXJ0KTsgIC8vICsxIGJlY2F1c2UgZW5kIGlzIGluY2x1c2l2ZVxuICAgIGlmKHN0YXJ0SW5kZXggPCBzcGxpY2VTdGFydCkge1xuICAgICAgY29uc3Qgc3BhbiA9IHNwYW5zW3N0YXJ0SW5kZXhdO1xuICAgICAgY29uc3QgeyBsZWZ0LCByaWdodCB9ID0gc3BsaXRTcGFuKHNwYW4sIHN0YXJ0T2Zmc2V0KTtcbiAgICAgIGlmKHJpZ2h0LnRleHQubGVuZ3RoID4gMCkge1xuICAgICAgICByZW1vdmVkU3BhbnMudW5zaGlmdChjb3B5U3BhbihzcGFuLCByaWdodCkpO1xuICAgICAgfVxuICAgICAgT2JqZWN0LmFzc2lnbihzcGFuLCBsZWZ0KTtcbiAgICB9XG4gICAgaWYoc3BsaWNlRW5kIDwgZW5kSW5kZXgpIHtcbiAgICAgIGNvbnN0IHNwYW4gPSBzcGFuc1tzcGxpY2VTdGFydF07ICAvLyBzcGxpY2VTdGFydDogc3BhbnMgYXJlIGFscmVhZHkgcmVtb3ZlZCAvIHNwbGljZWQgZnJvbSB0aGUgYXJyYXlcbiAgICAgIGNvbnN0IHsgbGVmdCwgcmlnaHQgfSA9IHNwbGl0U3BhbihzcGFuLCBlbmRPZmZzZXQpO1xuICAgICAgaWYobGVmdC50ZXh0Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgcmVtb3ZlZFNwYW5zLnB1c2goY29weVNwYW4oc3BhbiwgbGVmdCkpO1xuICAgICAgfVxuICAgICAgT2JqZWN0LmFzc2lnbihzcGFuLCByaWdodCk7XG4gICAgfVxuICAgIC8vIHNwbGljZSBhbmQgdXBkYXRlIHRpbWUgZGVwZW5kaW5nIG9uIGR1cmF0aW9ucyBhbmQgc3BsaXQgZW5kcG9pbnRzXG4gICAgcmV0dXJuIHsgc3BhbnM6IHJlbW92ZWRTcGFucywgc3BsaXRJbmRleDogc3RhcnRJbmRleCwgc3BsaXRPZmZzZXQ6IHN0YXJ0T2Zmc2V0IH07XG5cbiAgfSBlbHNlIGlmKG1vZGUgPT09IFNwbGljZU1vZGUuSW5QbGFjZSkge1xuXG4gICAgLy8gY29weSBpbm5lciBzcGFuc1xuICAgIGNvbnN0IHNsaWNlZFNwYW5zID0gc3BhbnMuc2xpY2Uoc3BsaWNlU3RhcnQsIHNwbGljZUVuZCArIDEpOyAgLy8gKzEgYmVjYXVzZSBlbmQgaXMgaW5jbHVzaXZlXG5cbiAgICAvLyBjb25zb2xlLmxvZyhgaW5QbGFjZSAgc3RhcnRJbmRleD0ke3N0YXJ0SW5kZXh9ICBzcGxpY2VTdGFydD0ke3NwbGljZVN0YXJ0fSAgc3RhcnRPZmZzZXQ9JHtzdGFydE9mZnNldH0gIGVuZEluZGV4PSR7ZW5kSW5kZXh9ICBzcGxpY2VFbmQ9JHtzcGxpY2VFbmR9ICBlbmRPZmZzZXQ9JHtlbmRPZmZzZXR9YClcbiAgICAvLyBkZWFsIHdpdGggYm9yZGVyIHNwYW5zXG4gICAgLy8gc3RhcnQgd2l0aCBlbmQgYXMgdGhlIGluZGV4IG1heSBiZWNvbSBpbnZhbGlkIGFmdGVyIHRoZSBzdGFydCBpcyBzcGxpdFxuICAgIGlmKHNwbGljZUVuZCA8IGVuZEluZGV4KSB7XG4gICAgICBjb25zdCBzcGFuID0gc3BhbnNbZW5kSW5kZXhdO1xuICAgICAgaWYoZW5kT2Zmc2V0ID4gMCAmJiBlbmRPZmZzZXQgPCBzcGFuLnRleHQubGVuZ3RoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdlbmQgb2Zmc2V0IG1pZGRsZScpXG4gICAgICAgIGNvbnN0IHsgbGVmdCwgcmlnaHQgfSA9IHNwbGl0U3BhbihzcGFuLCBlbmRPZmZzZXQpO1xuICAgICAgICBzcGFucy5zcGxpY2UoZW5kSW5kZXgsIDEsIC4uLltsZWZ0LCByaWdodF0uZmlsdGVyKHMgPT4gcy50ZXh0Lmxlbmd0aCA+IDApKTtcbiAgICAgICAgLy8gaWYobGVmdC50ZXh0Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBzbGljZWRTcGFucy5wdXNoKGxlZnQpO1xuICAgICAgICAvLyB9XG4gICAgICAgIC8vIE9iamVjdC5hc3NpZ24oc3BhbiwgcmlnaHQpO1xuICAgICAgfSBlbHNlIGlmKGVuZE9mZnNldCA+IDApIHtcbiAgICAgICAgc2xpY2VkU3BhbnMucHVzaChzcGFuKTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYoc3RhcnRJbmRleCA8IHNwbGljZVN0YXJ0KSB7XG4gICAgICBjb25zdCBzcGFuID0gc3BhbnNbc3RhcnRJbmRleF07XG4gICAgICBpZihzdGFydE9mZnNldCA+IDAgJiYgc3RhcnRPZmZzZXQgPCBzcGFuLnRleHQubGVuZ3RoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdzdGFydCBvZmZzZXQgbWlkZGxlJylcbiAgICAgICAgY29uc3QgeyBsZWZ0LCByaWdodCB9ID0gc3BsaXRTcGFuKHNwYW4sIHN0YXJ0T2Zmc2V0KTtcbiAgICAgICAgLy8gaWYocmlnaHQudGV4dC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgc2xpY2VkU3BhbnMudW5zaGlmdChyaWdodCk7XG4gICAgICAgIC8vIH1cbiAgICAgICAgc3BhbnMuc3BsaWNlKHN0YXJ0SW5kZXgsIDEsIC4uLltsZWZ0LCByaWdodF0uZmlsdGVyKHMgPT4gcy50ZXh0Lmxlbmd0aCA+IDApKTtcbiAgICAgICAgLy8gT2JqZWN0LmFzc2lnbihzcGFuLCBsZWZ0KTtcbiAgICAgICAgc3RhcnRJbmRleCsrO1xuICAgICAgfSBlbHNlIGlmKHN0YXJ0T2Zmc2V0ID09PSAwKSB7XG4gICAgICAgIHNsaWNlZFNwYW5zLnVuc2hpZnQoc3Bhbik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzdGFydEluZGV4Kys7XG4gICAgICB9XG4gICAgfVxuICAgIC8vIHNwbGljZSBhbmQgdXBkYXRlIHRpbWUgZGVwZW5kaW5nIG9uIGR1cmF0aW9ucyBhbmQgc3BsaXQgZW5kcG9pbnRzXG4gICAgcmV0dXJuIHsgc3BhbnM6IHNsaWNlZFNwYW5zLCBzcGxpdEluZGV4OiBzdGFydEluZGV4LCBzcGxpdE9mZnNldDogc3RhcnRPZmZzZXQgfTtcblxuICB9IGVsc2UgaWYobW9kZSA9PT0gU3BsaWNlTW9kZS5Db3B5KSB7XG5cbiAgICBjb25zdCBzbGljZWRTcGFucyA9IHNwYW5zLnNsaWNlKHNwbGljZVN0YXJ0LCBzcGxpY2VFbmQgKyAxKTtcblxuICAgIGlmKHN0YXJ0SW5kZXggPCBzcGxpY2VTdGFydCkge1xuICAgICAgY29uc3Qgc3BhbiA9IHNwYW5zW3N0YXJ0SW5kZXhdO1xuICAgICAgY29uc3QgeyBsZWZ0LCByaWdodCB9ID0gc3BsaXRTcGFuKHNwYW4sIHN0YXJ0T2Zmc2V0KTtcbiAgICAgIGlmKHJpZ2h0LnRleHQubGVuZ3RoID4gMCkge1xuICAgICAgICBzbGljZWRTcGFucy51bnNoaWZ0KGNvcHlTcGFuKHNwYW4sIHJpZ2h0KSk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmKHNwbGljZUVuZCA8IGVuZEluZGV4KSB7XG4gICAgICBjb25zdCBzcGFuID0gc3BhbnNbZW5kSW5kZXhdO1xuICAgICAgY29uc3QgeyBsZWZ0LCByaWdodCB9ID0gc3BsaXRTcGFuKHNwYW4sIGVuZE9mZnNldCk7XG4gICAgICBpZihsZWZ0LnRleHQubGVuZ3RoID4gMCkge1xuICAgICAgICBzbGljZWRTcGFucy5wdXNoKGNvcHlTcGFuKHNwYW4sIGxlZnQpKTtcbiAgICAgIH1cbiAgICB9XG4gICAgLy8gc3BsaWNlIGFuZCB1cGRhdGUgdGltZSBkZXBlbmRpbmcgb24gZHVyYXRpb25zIGFuZCBzcGxpdCBlbmRwb2ludHNcbiAgICByZXR1cm4geyBzcGFuczogc2xpY2VkU3BhbnMsIHNwbGl0SW5kZXg6IHN0YXJ0SW5kZXgsIHNwbGl0T2Zmc2V0OiBzdGFydE9mZnNldCB9O1xuXG4gIH1cbiAgcmV0dXJuO1xufVxuXG5cblxuXG5leHBvcnQgZnVuY3Rpb24gZGF0YVNwbGljZShkYXRhLCBzdGFydCwgZW5kLCBtb2RlID0gU3BsaWNlTW9kZS5SZW1vdmUpIHtcbiAgLy8gbW9kZTogcmVtb3ZlLCBpbnBsYWNlLCBjb3B5XG4gIGNvbnN0IHBhcmFncmFwaHMgPSBkYXRhUGFyYWdyYXBocyhkYXRhKTtcbiAgY29uc3QgcmVtb3ZlZCA9IFtdO1xuICBsZXQgc3RhcnRQYXJhZ3JhcGg7XG4gIGZvcihsZXQgaT1zdGFydC5wYXJhZ3JhcGhJbmRleDsgaTxwYXJhZ3JhcGhzLmxlbmd0aCAmJiBpIDw9IGVuZC5wYXJhZ3JhcGhJbmRleDspIHtcbiAgICBjb25zdCBwYXJhZ3JhcGggPSBwYXJhZ3JhcGhzW2ldO1xuICAgIGlmKHBhcmFncmFwaC5pZCA9PT0gc3RhcnQucGFyYWdyYXBoSUQpIHtcbiAgICAgIHN0YXJ0UGFyYWdyYXBoID0gcGFyYWdyYXBoO1xuICAgIH1cbiAgICBpZihwYXJhZ3JhcGguaWQgPT09IHN0YXJ0LnBhcmFncmFwaElEICYmIHBhcmFncmFwaC5pZCA9PT0gZW5kLnBhcmFncmFwaElEKSB7XG4gICAgICAvLyBzaW5nbGUgcGFyYWdyYXBoXG4gICAgICBpZihwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGgpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgLy8gbm9uLWVtcHR5IHBhcmFncmFwaFxuICAgICAgICBpZihtb2RlID09PSBTcGxpY2VNb2RlLlJlbW92ZSkge1xuICAgICAgICAgIGNvbnN0IHJlbW92ZWRTcGFucyA9IHNwbGljZVNwYW5zKHBhcmFncmFwaFNwYW5zKHBhcmFncmFwaCksIHN0YXJ0LnNwYW5JbmRleCwgc3RhcnQub2Zmc2V0LCBlbmQuc3BhbkluZGV4LCBlbmQub2Zmc2V0LCBtb2RlKTtcbiAgICAgICAgICBpZihyZW1vdmVkU3BhbnMuc3BhbnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgcmVtb3ZlZC5wdXNoKHtcbiAgICAgICAgICAgICAgaWQ6IHBhcmFncmFwaC5pZCxcbiAgICAgICAgICAgICAgc3BhbnM6IHJlbW92ZWRTcGFucy5zcGFucyxcbiAgICAgICAgICAgICAgcGFydGlhbDogc3RhcnQuc3BhbkluZGV4ID4gMCB8fCBzdGFydC5vZmZzZXQgPiAwIHx8IGVuZC5zcGFuSW5kZXggPCBwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGgpLmxlbmd0aCAtIDFcbiAgICAgICAgICAgICAgICAgICAgICB8fCBwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGgpLmxlbmd0aCA+IDAgJiYgZW5kLm9mZnNldCA8IGxhc3QocGFyYWdyYXBoU3BhbnMocGFyYWdyYXBoKSkudGV4dC5sZW5ndGhcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmKG1vZGUgPT09IFNwbGljZU1vZGUuQ29weSkge1xuICAgICAgICAgIGNvbnN0IHJlbW92ZWRTcGFucyA9IHNwbGljZVNwYW5zKHBhcmFncmFwaFNwYW5zKHBhcmFncmFwaCksIHN0YXJ0LnNwYW5JbmRleCwgc3RhcnQub2Zmc2V0LCBlbmQuc3BhbkluZGV4LCBlbmQub2Zmc2V0LCBtb2RlKTtcbiAgICAgICAgICBpZihyZW1vdmVkU3BhbnMuc3BhbnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgcmVtb3ZlZC5wdXNoKHtcbiAgICAgICAgICAgICAgaWQ6IHBhcmFncmFwaC5pZCxcbiAgICAgICAgICAgICAgc3BhbnM6IHJlbW92ZWRTcGFucy5zcGFucyxcbiAgICAgICAgICAgICAgcGFydGlhbDogc3RhcnQuc3BhbkluZGV4ID4gMCB8fCBzdGFydC5vZmZzZXQgPiAwIHx8IGVuZC5zcGFuSW5kZXggPCBwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGgpLmxlbmd0aCAtIDFcbiAgICAgICAgICAgICAgICAgICAgICB8fCBlbmQub2Zmc2V0IDwgbGFzdChwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGgpKS50ZXh0Lmxlbmd0aFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYobW9kZSA9PT0gU3BsaWNlTW9kZS5JblBsYWNlKSB7XG4gICAgICAgICAgY29uc3QgcmVtb3ZlZFNwYW5zID0gc3BsaWNlU3BhbnMocGFyYWdyYXBoU3BhbnMocGFyYWdyYXBoKSwgc3RhcnQuc3BhbkluZGV4LCBzdGFydC5vZmZzZXQsIGVuZC5zcGFuSW5kZXgsIGVuZC5vZmZzZXQsIG1vZGUpO1xuICAgICAgICAgIGlmKHJlbW92ZWRTcGFucy5zcGFucy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICByZW1vdmVkLnB1c2goe1xuICAgICAgICAgICAgICBpZDogcGFyYWdyYXBoLmlkLFxuICAgICAgICAgICAgICBzcGFuczogcmVtb3ZlZFNwYW5zLnNwYW5zLFxuICAgICAgICAgICAgICBwYXJ0aWFsOiBzdGFydC5zcGFuSW5kZXggPiAwIHx8IHN0YXJ0Lm9mZnNldCA+IDAgfHwgZW5kLnNwYW5JbmRleCA8IHBhcmFncmFwaFNwYW5zKHBhcmFncmFwaCkubGVuZ3RoIC0gMVxuICAgICAgICAgICAgICAgICAgICAgIHx8IGVuZC5vZmZzZXQgPCBsYXN0KHBhcmFncmFwaFNwYW5zKHBhcmFncmFwaCkpLnRleHQubGVuZ3RoXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIGVtcHR5IHBhcmFncmFwaFxuICAgICAgICBpZihtb2RlID09PSBTcGxpY2VNb2RlLlJlbW92ZSkge1xuICAgICAgICAgIHBhcmFncmFwaHMuc3BsaWNlKGksIDEpOyAvLyByZW1vdmUgcGFyYWdyYXBoXG4gICAgICAgICAgcmVtb3ZlZC5wdXNoKE9iamVjdC5hc3NpZ24oe30sIHBhcmFncmFwaCwgeyBwYXJ0aWFsOiBmYWxzZSB9KSk7XG4gICAgICAgIH0gZWxzZSBpZihtb2RlID09PSBTcGxpY2VNb2RlLkNvcHkpIHtcbiAgICAgICAgICByZW1vdmVkLnB1c2goT2JqZWN0LmFzc2lnbih7fSwgcGFyYWdyYXBoLCB7IHBhcnRpYWw6IGZhbHNlIH0pKTtcbiAgICAgICAgfSBlbHNlIGlmKG1vZGUgPT09IFNwbGljZU1vZGUuSW5QbGFjZSkge1xuICAgICAgICAgIHBhcmFncmFwaHMuc3BsaWNlKGksIDEpOyAvLyByZW1vdmUgcGFyYWdyYXBoXG4gICAgICAgICAgcmVtb3ZlZC5wdXNoKHBhcmFncmFwaCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuICAgIH0gZWxzZSBpZihwYXJhZ3JhcGguaWQgPT09IHN0YXJ0LnBhcmFncmFwaElEICYmIHBhcmFncmFwaFNwYW5zKHBhcmFncmFwaCkubGVuZ3RoID4gMCkge1xuICAgICAgLy8gc3RhcnQgcGFyYWdyYXBoIG9ubHlcbiAgICAgIGNvbnN0IHJlbW92ZWRTcGFucyA9IHNwbGljZVNwYW5zKHBhcmFncmFwaFNwYW5zKHBhcmFncmFwaCksIHN0YXJ0LnNwYW5JbmRleCwgc3RhcnQub2Zmc2V0LCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgbW9kZSk7XG4gICAgICBpZihwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGgpLmxlbmd0aCA9PT0gMCAmJiBtb2RlID09PSBTcGxpY2VNb2RlLlJlbW92ZSkge1xuICAgICAgICBwYXJhZ3JhcGhzLnNwbGljZShpLCAxKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGkrKztcbiAgICAgIH1cbiAgICAgIGlmKHJlbW92ZWRTcGFucy5zcGFucy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHJlbW92ZWQucHVzaCh7IGlkOiBwYXJhZ3JhcGguaWQsIHNwYW5zOiByZW1vdmVkU3BhbnMuc3BhbnMsIHBhcnRpYWw6IHBhcmFncmFwaFNwYW5zKHBhcmFncmFwaCkubGVuZ3RoID4gMCB9KTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYocGFyYWdyYXBoLmlkID09PSBlbmQucGFyYWdyYXBoSUQgJiYgcGFyYWdyYXBoU3BhbnMocGFyYWdyYXBoKS5sZW5ndGggPiAwKSB7XG4gICAgICAvLyBlbmQgcGFyYWdyYXBoXG4gICAgICBjb25zdCByZW1vdmVkU3BhbnMgPSBzcGxpY2VTcGFucyhwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGgpLCAwLCAwLCBlbmQuc3BhbkluZGV4LCBlbmQub2Zmc2V0LCBtb2RlKTtcbiAgICAgIGlmKHJlbW92ZWRTcGFucy5zcGFucy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHJlbW92ZWQucHVzaCh7IGlkOiBwYXJhZ3JhcGguaWQsIHNwYW5zOiByZW1vdmVkU3BhbnMuc3BhbnMsIHBhcnRpYWw6IHBhcmFncmFwaFNwYW5zKHBhcmFncmFwaCkubGVuZ3RoID4gMCB9KTtcbiAgICAgIH1cbiAgICAgIC8vIGNoZWNrIGlmIHN0YXJ0IHBhcmFncmFwaCB3YXMgbm9uLWVtcHR5IChhbmQgdGh1cyBub3QgcmVtb3ZlZClcbiAgICAgIGlmKHBhcmFncmFwaFNwYW5zKHN0YXJ0UGFyYWdyYXBoKS5sZW5ndGggPiAwKSB7XG4gICAgICAgIC8vIGpvaW4gZmlyc3QgYW5kIGxhc3QgcGFyYWdyYXBocywgaS5lLiwgYXBwZW5kIHJlc3Qgb2YgdGhlIGxhc3QgdG8gdGhlIGZpcnN0IHBhcmFncmFwaFxuICAgICAgICBpZihtb2RlID09PSBTcGxpY2VNb2RlLlJlbW92ZSkge1xuICAgICAgICAgIHBhcmFncmFwaFNwYW5zKHN0YXJ0UGFyYWdyYXBoKS5zcGxpY2UocGFyYWdyYXBoU3BhbnMoc3RhcnRQYXJhZ3JhcGgpLmxlbmd0aCwgMCwgLi4ucGFyYWdyYXBoU3BhbnMocGFyYWdyYXBoKSk7XG4gICAgICAgICAgcGFyYWdyYXBocy5zcGxpY2UoaSwgMSk7ICAvLyBwYXJhZ3JhcGggbGVmdG92ZXIgc3BhbnMgYXJlIGFkZGVkIHRvIHN0YXJ0IHBhcmFncmFwaFxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBicmVhaztcbiAgICB9IGVsc2UgaWYocGFyYWdyYXBoLmlkID09PSBlbmQucGFyYWdyYXBoSUQpIHtcbiAgICAgIC8vIGVtcHR5IGVuZCBwYXJhZ3JhcGgsIHJlbW92ZSBpdFxuICAgICAgaWYobW9kZSA9PT0gU3BsaWNlTW9kZS5SZW1vdmUpIHtcbiAgICAgICAgcGFyYWdyYXBocy5zcGxpY2UoaSwgMSk7XG4gICAgICB9XG4gICAgICByZW1vdmVkLnB1c2goT2JqZWN0LmFzc2lnbih7fSwgcGFyYWdyYXBoLCB7IHBhcnRpYWw6IGZhbHNlIH0pKTtcbiAgICAgIGJyZWFrO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyByZW1vdmUgaW5uZXIgcGFyYWdyYXBoIG9mIHRoZSByYW5nZSwgcmVtb3ZlIGl0XG4gICAgICBpZihtb2RlID09PSBTcGxpY2VNb2RlLlJlbW92ZSkge1xuICAgICAgICBwYXJhZ3JhcGhzLnNwbGljZShpLCAxKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGkrKztcbiAgICAgIH1cbiAgICAgIHJlbW92ZWQucHVzaChPYmplY3QuYXNzaWduKHt9LCBwYXJhZ3JhcGgsIHsgcGFydGlhbDogZmFsc2UgfSkpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmVtb3ZlZDtcbn1cblxuZnVuY3Rpb24gZGF0YUNvcHlTcGFucyhzcGFucywgc3RhcnRJbmRleCwgc3RhcnRPZmZzZXQsIGVuZEluZGV4LCBlbmRPZmZzZXQpIHtcbiAgaWYoc3RhcnRJbmRleCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgc3RhcnRJbmRleCA9IDA7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRhdGFDb3B5KGRhdGEsIHN0YXJ0LCBlbmQpIHtcbiAgY29uc3QgcGFyYWdyYXBocyA9IGRhdGFQYXJhZ3JhcGhzKGRhdGEpO1xuICBjb25zdCBjb3BpZWQgPSBbXTtcbiAgZm9yKGxldCBpPXN0YXJ0LnBhcmFncmFwaEluZGV4OyBpPHBhcmFncmFwaHMubGVuZ3RoICYmIGkgPD0gZW5kLnBhcmFncmFwaEluZGV4OyBpKyspIHtcbiAgICBjb25zdCBwYXJhZ3JhcGggPSBwYXJhZ3JhcGhzW2ldO1xuICAgIGNvbnN0IHNwYW5zID0gcGFyYWdyYXBoU3BhbnMocGFyYWdyYXBoKTtcbiAgICBpZihzcGFucy5sZW5ndGggPT09IDApIHtcbiAgICAgIGNvcGllZC5wdXNoKHBhcmFncmFwaCk7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgaWYoaSA9PT0gc3RhcnQucGFyYWdyYXBoSW5kZXggJiYgaSA9PT0gZW5kLnBhcmFncmFwaEluZGV4KSB7XG4gICAgICBpZihzdGFydC5zcGFuSW5kZXggPT09IHVuZGVmaW5lZCB8fCBzdGFydC5zcGFuSW5kZXggPT09IC0xIHx8IGVuZC5zcGFuSW5kZXggPT09IHVuZGVmaW5lZCB8fCBlbmQuc3BhbkluZGV4ID09PSAtMSkge1xuICAgICAgICBjb3BpZWQucHVzaChwYXJhZ3JhcGgpO1xuICAgICAgICBicmVhaztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmKHN0YXJ0Lm9mZnNldCA9PT0gdW5kZWZpbmVkICYmIGVuZC5vZmZzZXQgPT09IHVuZGVmaW5lZCkge1xuXG4gICAgICAgIH0gZWxzZSBpZihzdGFydC5vZmZzZXQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICB9IGVsc2UgaWYoZW5kLm9mZnNldCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gY2hlY2sgcG9zaXRpb25zIGJvdGhcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgLy8gbGV0IHNsaWNlU3RhcnQgPSBzdGFydC5cbiAgICB9IGVsc2UgaWYoaSA9PT0gc3RhcnQucGFyYWdyYXBoSW5kZXgpIHtcbiAgICB9IGVsc2UgaWYoaSA9PT0gZW5kLnBhcmFncmFwaEluZGV4KSB7XG4gICAgfVxuXG4gICAgY29waWVkUGFyYWdyYXBoID0gT2JqZWN0LmFzc2lnbih7fSwgcGFyYWdyYXBoLCB7IHNwYW5zOiBbXSB9KTtcbiAgICAvLyBmb3IobGV0IGs9c3RhcnQuc3BhbkluZGV4KVxuICAgIC8vIGlmKHN0YXJ0LilcblxuICB9XG4gIHJldHVybiBjb3BpZWQ7XG5cblxuXG4gIGNvbnN0IHJlbW92ZWQgPSBbXTtcbiAgbGV0IHN0YXJ0UGFyYWdyYXBoO1xuICBmb3IobGV0IGk9c3RhcnQucGFyYWdyYXBoSW5kZXg7IGk8cGFyYWdyYXBocy5sZW5ndGggJiYgaSA8PSBlbmQucGFyYWdyYXBoSW5kZXg7KSB7XG4gICAgY29uc3QgcGFyYWdyYXBoID0gcGFyYWdyYXBoc1tpXTtcbiAgICBpZihwYXJhZ3JhcGguaWQgPT09IHN0YXJ0LnBhcmFncmFwaElEKSB7XG4gICAgICBzdGFydFBhcmFncmFwaCA9IHBhcmFncmFwaDtcbiAgICB9XG4gICAgaWYocGFyYWdyYXBoLmlkID09PSBzdGFydC5wYXJhZ3JhcGhJRCAmJiBwYXJhZ3JhcGguaWQgPT09IGVuZC5wYXJhZ3JhcGhJRCkge1xuICAgICAgaWYocGFyYWdyYXBoU3BhbnMocGFyYWdyYXBoKS5sZW5ndGggPiAwKSB7XG4gICAgICAgIC8vIG5vbi1lbXB0eSBwYXJhZ3JhcGhcbiAgICAgICAgY29uc3QgcmVtb3ZlZFNwYW5zID0gc3BsaWNlU3BhbnMocGFyYWdyYXBoU3BhbnMocGFyYWdyYXBoKSwgc3RhcnQuc3BhbkluZGV4LCBzdGFydC5vZmZzZXQsIGVuZC5zcGFuSW5kZXgsIGVuZC5vZmZzZXQpO1xuICAgICAgICBpZihyZW1vdmVkU3BhbnMuc3BhbnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIHJlbW92ZWQucHVzaCh7IGlkOiBwYXJhZ3JhcGguaWQsIHNwYW5zOiByZW1vdmVkU3BhbnMuc3BhbnMsXG4gICAgICAgICAgICBwYXJ0aWFsOiBzdGFydC5zcGFuSW5kZXggPiAwIHx8IHN0YXJ0Lm9mZnNldCA+IDAgfHwgZW5kLnNwYW5JbmRleCA8IHBhcmFncmFwaFNwYW5zKHBhcmFncmFwaCkubGVuZ3RoIC0gMSB8fCBlbmQub2Zmc2V0IDwgbGFzdChwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGgpKS50ZXh0Lmxlbmd0aCB9KTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gZW1wdHkgcGFyYWdyYXBoLCByZW1vdmUgaXRcbiAgICAgICAgcGFyYWdyYXBocy5zcGxpY2UoaSwgMSk7XG4gICAgICAgIHJlbW92ZWQucHVzaChPYmplY3QuYXNzaWduKHt9LCBwYXJhZ3JhcGgsIHsgcGFydGlhbDogZmFsc2UgfSkpO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG4gICAgfSBlbHNlIGlmKHBhcmFncmFwaC5pZCA9PT0gc3RhcnQucGFyYWdyYXBoSUQgJiYgcGFyYWdyYXBoU3BhbnMocGFyYWdyYXBoKS5sZW5ndGggPiAwKSB7XG4gICAgICAvLyBzdGFydCBwYXJhZ3JhcGggb25seVxuICAgICAgY29uc3QgcmVtb3ZlZFNwYW5zID0gc3BsaWNlU3BhbnMocGFyYWdyYXBoU3BhbnMocGFyYWdyYXBoKSwgc3RhcnQuc3BhbkluZGV4LCBzdGFydC5vZmZzZXQpO1xuICAgICAgaWYocGFyYWdyYXBoU3BhbnMocGFyYWdyYXBoKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgcGFyYWdyYXBocy5zcGxpY2UoaSwgMSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpKys7XG4gICAgICB9XG4gICAgICBpZihyZW1vdmVkU3BhbnMuc3BhbnMubGVuZ3RoID4gMCkge1xuICAgICAgICByZW1vdmVkLnB1c2goeyBpZDogcGFyYWdyYXBoLmlkLCBzcGFuczogcmVtb3ZlZFNwYW5zLnNwYW5zLCBwYXJ0aWFsOiBwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGgpLmxlbmd0aCA+IDAgfSk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmKHBhcmFncmFwaC5pZCA9PT0gZW5kLnBhcmFncmFwaElEICYmIHBhcmFncmFwaFNwYW5zKHBhcmFncmFwaCkubGVuZ3RoID4gMCkge1xuICAgICAgLy8gZW5kIHBhcmFncmFwaFxuICAgICAgY29uc3QgcmVtb3ZlZFNwYW5zID0gc3BsaWNlU3BhbnMocGFyYWdyYXBoU3BhbnMocGFyYWdyYXBoKSwgMCwgMCwgZW5kLnNwYW5JbmRleCwgZW5kLm9mZnNldCk7XG4gICAgICBpZihyZW1vdmVkU3BhbnMuc3BhbnMubGVuZ3RoID4gMCkge1xuICAgICAgICByZW1vdmVkLnB1c2goeyBpZDogcGFyYWdyYXBoLmlkLCBzcGFuczogcmVtb3ZlZFNwYW5zLnNwYW5zLCBwYXJ0aWFsOiBwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGgpLmxlbmd0aCA+IDAgfSk7XG4gICAgICB9XG4gICAgICAvLyBjaGVjayBpZiBzdGFydCBwYXJhZ3JhcGggd2FzIG5vbi1lbXB0eSAoYW5kIHRodXMgbm90IHJlbW92ZWQpXG4gICAgICBpZihwYXJhZ3JhcGhTcGFucyhzdGFydFBhcmFncmFwaCkubGVuZ3RoID4gMCkge1xuICAgICAgICAvLyBqb2luIGZpcnN0IGFuZCBsYXN0IHBhcmFncmFwaHMsIGkuZS4sIGFwcGVuZCByZXN0IG9mIHRoZSBsYXN0IHRvIHRoZSBmaXJzdCBwYXJhZ3JhcGhcbiAgICAgICAgcGFyYWdyYXBoU3BhbnMoc3RhcnRQYXJhZ3JhcGgpLnNwbGljZShwYXJhZ3JhcGhTcGFucyhzdGFydFBhcmFncmFwaCkubGVuZ3RoLCAwLCAuLi5wYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGgpKTtcbiAgICAgICAgcGFyYWdyYXBocy5zcGxpY2UoaSwgMSk7ICAvLyBwYXJhZ3JhcGggbGVmdG92ZXIgc3BhbnMgYXJlIGFkZGVkIHRvIHN0YXJ0IHBhcmFncmFwaFxuICAgICAgfVxuICAgICAgYnJlYWs7XG4gICAgfSBlbHNlIGlmKHBhcmFncmFwaC5pZCA9PT0gZW5kLnBhcmFncmFwaElEKSB7XG4gICAgICAvLyBlbXB0eSBlbmQgcGFyYWdyYXBoLCByZW1vdmUgaXRcbiAgICAgIHBhcmFncmFwaHMuc3BsaWNlKGksIDEpO1xuICAgICAgcmVtb3ZlZC5wdXNoKE9iamVjdC5hc3NpZ24oe30sIHBhcmFncmFwaCwgeyBwYXJ0aWFsOiBmYWxzZSB9KSk7XG4gICAgICBicmVhaztcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gcmVtb3ZlIGlubmVyIHBhcmFncmFwaCBvZiB0aGUgcmFuZ2UsIHJlbW92ZSBpdFxuICAgICAgcGFyYWdyYXBocy5zcGxpY2UoaSwgMSk7XG4gICAgICByZW1vdmVkLnB1c2goT2JqZWN0LmFzc2lnbih7fSwgcGFyYWdyYXBoLCB7IHBhcnRpYWw6IGZhbHNlIH0pKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHJlbW92ZWQ7XG59XG5cblxuZXhwb3J0IGZ1bmN0aW9uIGRhdGFJbnNlcnQoZGF0YSwgc3RhcnQsIG5ld0RhdGEpIHtcbiAgY29uc3QgcGFyYWdyYXBocyA9IGRhdGFQYXJhZ3JhcGhzKGRhdGEpO1xuICBjb25zdCBuZXdQYXJhZ3JhcGhzID0gZGF0YVBhcmFncmFwaHMobmV3RGF0YSk7XG4gIGlmKG5ld1BhcmFncmFwaHMubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYocGFyYWdyYXBocy5sZW5ndGggPT09IDApIHtcbiAgICBwYXJhZ3JhcGhzLnNwbGljZSgwLCAwLCAuLi5uZXdEYXRhKTtcbiAgICBjb25zdCBsYXN0UGFyYWdyYXBoID0gbGFzdChuZXdEYXRhKTtcbiAgICByZXR1cm4geyBzdGFydDogZGF0YVBvaW50ZXIoZGF0YSwgeyBwYXJhZ3JhcGhJbmRleDogMCwgc3BhbkluZGV4OiAwLCBvZmZzZXQ6IDAgfSksXG4gICAgICBlbmQ6IGRhdGFQb2ludGVyKGRhdGEsIHsgcGFyYWdyYXBoSW5kZXg6IG5ld0RhdGEubGVuZ3RoIC0gMSwgc3BhbkluZGV4OiBsYXN0UGFyYWdyYXBoLnNwYW5zLmxlbmd0aCAtIDEsIG9mZnNldDogbGFzdChsYXN0UGFyYWdyYXBoLnNwYW5zKS50ZXh0Lmxlbmd0aCB9KSB9O1xuICB9XG5cbiAgaWYobmV3UGFyYWdyYXBocy5sZW5ndGggPT09IDEpIHtcbiAgICAvLyBzaW5nbGUgcGFyYWdyYXBoIHRvIGJlIGluc2VydGVkXG5cbiAgICBjb25zdCBuZXdTcGFucyA9IHBhcmFncmFwaFNwYW5zKG5ld1BhcmFncmFwaHNbMF0pO1xuICAgIGNvbnN0IHBhcmFncmFwaCA9IHBhcmFncmFwaHNbc3RhcnQucGFyYWdyYXBoSW5kZXhdO1xuXG4gICAgLy8gbGV0IGVuZDtcblxuICAgIGxldCBpbnNlcnRlZFN0YXJ0LCBpbnNlcnRlZEVuZDtcblxuICAgIGlmKHN0YXJ0Lm9mZnNldCA9PT0gMCkge1xuICAgICAgLy8gc3BhbiBiZWxvbmdzIHRvIHJpZ2h0IHNldFxuICAgICAgcGFyYWdyYXBoU3BhbnMocGFyYWdyYXBoKS5zcGxpY2Uoc3RhcnQuc3BhbkluZGV4LCAwLCAuLi5uZXdTcGFucyk7XG5cbiAgICAgIGluc2VydGVkU3RhcnQgPSBkYXRhUG9pbnRlcihkYXRhLCB7IHBhcmFncmFwaElEOiBzdGFydC5wYXJhZ3JhcGhJRCwgc3BhbkluZGV4OiBzdGFydC5zcGFuSW5kZXgsIG9mZnNldDogMCB9KTtcbiAgICAgIGluc2VydGVkRW5kID0gZGF0YVBvaW50ZXIoZGF0YSwgeyBwYXJhZ3JhcGhJRDogc3RhcnQucGFyYWdyYXBoSUQsIHNwYW5JbmRleDogc3RhcnQuc3BhbkluZGV4ICsgbmV3U3BhbnMubGVuZ3RoIC0gMSwgb2Zmc2V0OiAtMSB9KTtcblxuICAgIH0gZWxzZSBpZihzdGFydC5vZmZzZXQgPT09IHBhcmFncmFwaFNwYW5zKHBhcmFncmFwaClbc3RhcnQuc3BhbkluZGV4XS50ZXh0Lmxlbmd0aCkge1xuICAgICAgLy8gc3BhbiBiZWxvbmdzIHRvIGxlZnQgc2V0XG4gICAgICBwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGgpLnNwbGljZShzdGFydC5zcGFuSW5kZXgrMSwgMCwgLi4ubmV3U3BhbnMpO1xuXG4gICAgICBpbnNlcnRlZFN0YXJ0ID0gZGF0YVBvaW50ZXIoZGF0YSwgeyBwYXJhZ3JhcGhJRDogc3RhcnQucGFyYWdyYXBoSUQsIHNwYW5JbmRleDogc3RhcnQuc3BhbkluZGV4ICsgMSwgb2Zmc2V0OiAwIH0pO1xuICAgICAgaW5zZXJ0ZWRFbmQgPSBkYXRhUG9pbnRlcihkYXRhLCB7IHBhcmFncmFwaElEOiBzdGFydC5wYXJhZ3JhcGhJRCwgc3BhbkluZGV4OiBzdGFydC5zcGFuSW5kZXggKyAxICsgbmV3U3BhbnMubGVuZ3RoIC0gMSwgb2Zmc2V0OiAtMSB9KTtcblxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBzcGFuIG11c3QgYmUgY3V0IGluIGhhbGZcbiAgICAgIGNvbnN0IHsgbGVmdCwgcmlnaHQgfSA9IHNwbGl0U3BhbihwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGgpW3N0YXJ0LnNwYW5JbmRleF0sIHN0YXJ0Lm9mZnNldCk7XG4gICAgICBwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGgpLnNwbGljZShzdGFydC5zcGFuSW5kZXggKyAxLCAwLCBjb3B5U3BhbihwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGgpW3N0YXJ0LnNwYW5JbmRleF0sIHJpZ2h0KSk7XG4gICAgICBPYmplY3QuYXNzaWduKHBhcmFncmFwaFNwYW5zKHBhcmFncmFwaClbc3RhcnQuc3BhbkluZGV4XSwgbGVmdCk7XG4gICAgICBwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGgpLnNwbGljZShzdGFydC5zcGFuSW5kZXggKyAxLCAwLCAuLi5uZXdTcGFucyk7XG5cbiAgICAgIGluc2VydGVkU3RhcnQgPSBkYXRhUG9pbnRlcihkYXRhLCB7IHBhcmFncmFwaElEOiBzdGFydC5wYXJhZ3JhcGhJRCwgc3BhbkluZGV4OiBzdGFydC5zcGFuSW5kZXggKyAxLCBvZmZzZXQ6IDAgfSk7XG4gICAgICBpbnNlcnRlZEVuZCA9IGRhdGFQb2ludGVyKGRhdGEsIHsgcGFyYWdyYXBoSUQ6IHN0YXJ0LnBhcmFncmFwaElELCBzcGFuSW5kZXg6IHN0YXJ0LnNwYW5JbmRleCArIDEgKyBuZXdTcGFucy5sZW5ndGggLSAxLCBvZmZzZXQ6IC0xIH0pO1xuICAgIH1cblxuICAgIC8vIFRPRE86IGludGVycG9sYXRlIGluc2VydGVkIHNwYW5zXG4gICAgLy8gVE9ETzogcmVxdWlyZXM6IHByZXYgYW5kIG5leHQgc3BhbnMgZm9yIHRpbWUgaW5mb3JtYXRpb25cblxuICAgIHJldHVybiB7IHN0YXJ0OiBpbnNlcnRlZFN0YXJ0LCBlbmQ6IGluc2VydGVkRW5kLCBzcGFuczogbmV3U3BhbnMgfTtcbiAgfVxuXG4gIC8vIGluc2VydCBtdWx0aXBsZSBwYXJhZ3JhcGhzXG5cbiAgY29uc3Qgc3RhcnRQYXJhZ3JhcGggPSBwYXJhZ3JhcGhzW3N0YXJ0LnBhcmFncmFwaEluZGV4XTtcbiAgY29uc3QgbGFzdFBhcmFncmFwaCA9IG5ld1BhcmFncmFwaCgpO1xuICAvLyBsZXQgZW5kO1xuXG4gIGxldCBpbnNlcnRlZFN0YXJ0LCBpbnNlcnRlZEVuZDtcblxuICAvLyBmaXJzdCBwYXJhZ3JhcGggdG8gYmUgaW5zZXJ0ZWRcbiAgaWYoc3RhcnQuc3BhbkluZGV4ICE9IHVuZGVmaW5lZCAmJiBzdGFydC5zcGFuSW5kZXggIT0gLTEgJiYgcGFyYWdyYXBoU3BhbnMoc3RhcnRQYXJhZ3JhcGgpLmxlbmd0aCA+IDApIHtcbiAgICBpZihzdGFydC5vZmZzZXQgPT09IDApIHtcbiAgICAgIC8vIHNwYW4gYmVsb25ncyB0byByaWdodCBzZXRcbiAgICAgIGNvbnN0IHJpZ2h0U3BhbnMgPSBwYXJhZ3JhcGhTcGFucyhzdGFydFBhcmFncmFwaCkuc3BsaWNlKHN0YXJ0LnNwYW5JbmRleCk7XG4gICAgICBzZXRQYXJhZ3JhcGhTcGFucyhsYXN0UGFyYWdyYXBoLCByaWdodFNwYW5zKTtcbiAgICB9IGVsc2UgaWYoc3RhcnQub2Zmc2V0ID09PSBwYXJhZ3JhcGhTcGFucyhzdGFydFBhcmFncmFwaClbc3RhcnQuc3BhbkluZGV4XS50ZXh0Lmxlbmd0aCkge1xuICAgICAgLy8gc3BhbiBiZWxvbmdzIHRvIGxlZnQgc2V0XG4gICAgICBjb25zdCByaWdodFNwYW5zID0gcGFyYWdyYXBoU3BhbnMoc3RhcnRQYXJhZ3JhcGgpLnNwbGljZShzdGFydC5zcGFuSW5kZXgrMSk7XG4gICAgICBzZXRQYXJhZ3JhcGhTcGFucyhsYXN0UGFyYWdyYXBoLCByaWdodFNwYW5zKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gc3BhbiBtdXN0IGJlIGN1dCBpbiBoYWxmXG4gICAgICBjb25zdCByaWdodFNwYW5zID0gcGFyYWdyYXBoU3BhbnMoc3RhcnRQYXJhZ3JhcGgpLnNwbGljZShzdGFydC5zcGFuSW5kZXgrMSk7XG4gICAgICBjb25zdCB7IGxlZnQsIHJpZ2h0IH0gPSBzcGxpdFNwYW4ocGFyYWdyYXBoU3BhbnMoc3RhcnRQYXJhZ3JhcGgpW3N0YXJ0LnNwYW5JbmRleF0sIHN0YXJ0Lm9mZnNldCk7XG4gICAgICBzZXRQYXJhZ3JhcGhTcGFucyhsYXN0UGFyYWdyYXBoLCByaWdodFNwYW5zKTtcbiAgICAgIHBhcmFncmFwaFNwYW5zKGxhc3RQYXJhZ3JhcGgpLnVuc2hpZnQoY29weVNwYW4ocGFyYWdyYXBoU3BhbnMoc3RhcnRQYXJhZ3JhcGgpW3N0YXJ0LnNwYW5JbmRleF0sIHJpZ2h0KSk7XG4gICAgICBPYmplY3QuYXNzaWduKHBhcmFncmFwaFNwYW5zKHN0YXJ0UGFyYWdyYXBoKVtzdGFydC5zcGFuSW5kZXhdLCBsZWZ0KTtcbiAgICB9XG4gIH1cblxuICBpZihwYXJhZ3JhcGhTcGFucyhuZXdQYXJhZ3JhcGhzWzBdKS5sZW5ndGggPiAwKSB7XG4gICAgaW5zZXJ0ZWRTdGFydCA9IHsgcGFyYWdyYXBoSUQ6IHN0YXJ0UGFyYWdyYXBoLmlkLCBzcGFuSW5kZXg6IHBhcmFncmFwaFNwYW5zKHBhcmFncmFwaHNbc3RhcnQucGFyYWdyYXBoSW5kZXhdKS5sZW5ndGgsIG9mZnNldDogMCB9O1xuICB9XG5cbiAgLy8gYXBwZW5kIHNwYW5zIHRvIHN0YXJ0IHBhcmFncmFwaFxuICBwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGhzW3N0YXJ0LnBhcmFncmFwaEluZGV4XSkuc3BsaWNlKHBhcmFncmFwaFNwYW5zKHBhcmFncmFwaHNbc3RhcnQucGFyYWdyYXBoSW5kZXhdKS5sZW5ndGgsIDAsIC4uLnBhcmFncmFwaFNwYW5zKG5ld1BhcmFncmFwaHNbMF0pKVxuXG4gIC8vIG1pZGRsZSBwYXJhZ3JhcGhzXG4gIGxldCBwYXJhZ3JhcGhJbmRleCA9IHN0YXJ0LnBhcmFncmFwaEluZGV4ICsgMTtcbiAgaWYobmV3UGFyYWdyYXBocy5sZW5ndGggPiAyKSB7XG4gICAgcGFyYWdyYXBocy5zcGxpY2UocGFyYWdyYXBoSW5kZXgsIDAsIC4uLm5ld1BhcmFncmFwaHMuc2xpY2UoMSwgbmV3UGFyYWdyYXBocy5sZW5ndGggLSAxKSk7ICAvLyBnZXRTcGFucyA/IT9cbiAgICBwYXJhZ3JhcGhJbmRleCArPSBuZXdQYXJhZ3JhcGhzLmxlbmd0aCAtIDI7XG4gIH1cblxuICBwYXJhZ3JhcGhTcGFucyhsYXN0UGFyYWdyYXBoKS5zcGxpY2UoMCwgMCwgLi4ucGFyYWdyYXBoU3BhbnMobmV3UGFyYWdyYXBoc1tuZXdQYXJhZ3JhcGhzLmxlbmd0aCAtIDFdKSk7XG4gIHBhcmFncmFwaHMuc3BsaWNlKHBhcmFncmFwaEluZGV4LCAwLCBsYXN0UGFyYWdyYXBoKTtcblxuXG4gIGlmKCFpbnNlcnRlZFN0YXJ0KSB7XG4gICAgaW5zZXJ0ZWRTdGFydCA9IHsgcGFyYWdyYXBoSW5kZXg6IHN0YXJ0LnBhcmFncmFwaEluZGV4ICsgMSwgc3BhbkluZGV4OiAwLCBvZmZzZXQ6IDAgfTtcbiAgfVxuXG4gIGluc2VydGVkRW5kID0gZGF0YVBvaW50ZXIoZGF0YSwgeyBwYXJhZ3JhcGhJRDogbGFzdFBhcmFncmFwaC5pZCwgc3BhbkluZGV4OiBwYXJhZ3JhcGhTcGFucyhuZXdQYXJhZ3JhcGhzW25ld1BhcmFncmFwaHMubGVuZ3RoIC0gMV0pLmxlbmd0aCAtIDEsIG9mZnNldDogLTEgfSk7XG5cbiAgaW5zZXJ0ZWRTdGFydCA9IGRhdGFQb2ludGVyKGRhdGEsIGluc2VydGVkU3RhcnQpO1xuXG4gIC8vIFRPRE86IGludGVycG9sYXRlIGluc2VydGVkIHNwYW5zXG4gIC8vIFRPRE86IHJlcXVpcmVzOiBwcmV2IGFuZCBuZXh0IHNwYW5zIGZvciB0aW1lIGluZm9ybWF0aW9uXG5cbiAgY29uc3QgbmV3U3BhbnMgPSBkYXRhUGFyYWdyYXBocyhuZXdEYXRhKS5yZWR1Y2UoKHNwYW5zLCBwYXJhZ3JhcGgpID0+IHNwYW5zLmNvbmNhdChwYXJhZ3JhcGhTcGFucyhwYXJhZ3JhcGgpKSwgW10pO1xuXG4gIHJldHVybiB7IHN0YXJ0OiBpbnNlcnRlZFN0YXJ0LCBlbmQ6IGluc2VydGVkRW5kLCBzcGFuczogbmV3U3BhbnMgfTtcbn1cblxuXG5mdW5jdGlvbiBkYXRhTWVyZ2VTcGFucyhzcGFucywgc291cmNlU3BhbnMpIHtcbiAgbGV0IHNvdXJjZVNwYW47XG4gIGxldCBrID0gMDtcbiAgZm9yKGNvbnN0IHNvdXJjZVNwYW4gb2Ygc291cmNlU3BhbnMpIHtcbiAgICBpZihrIDwgc3BhbnMubGVuZ3RoICYmIHNwYW5zW2tdLmlkID09PSBzb3VyY2VTcGFuLmlkKSB7XG4gICAgICBzcGFuc1trXS50ZXh0ID0gc291cmNlU3Bhbi50ZXh0O1xuICAgICAgLy8gZGF0YU1lcmdlU3BhbnMoc3BhblNwYW5zKHNwYW5zW2tdKSwgc3BhblNwYW5zKHNvdXJjZVNwYW4pKTtcbiAgICAgIGsrKztcbiAgICB9IGVsc2Uge1xuICAgICAgbGV0IGZvdW5kID0gZmFsc2U7XG4gICAgICBmb3IobGV0IGo9azsgajxzcGFucy5sZW5ndGg7IGorKykge1xuICAgICAgICBpZihzcGFuc1tqXS5pZCA9PT0gc291cmNlU3Bhbi5pZCkge1xuICAgICAgICAgIHNwYW5zLnNwbGljZShrLCBqLWspO1xuICAgICAgICAgIHNwYW5zW2tdLnRleHQgPSBzb3VyY2VTcGFuLnRleHQ7XG4gICAgICAgICAgaysrO1xuICAgICAgICAgIGZvdW5kID0gdHJ1ZTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYoIWZvdW5kKSB7XG4gICAgICAgIHNwYW5zLnNwbGljZShrLCAwLCBzb3VyY2VTcGFuKTtcbiAgICAgICAgaysrO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICAvLyBjb25zb2xlLmxvZygnc3BhbnMnLCBzcGFucy5sZW5ndGgsIGspO1xuICBpZihzcGFucy5sZW5ndGggPiBrKSB7XG4gICAgc3BhbnMuc3BsaWNlKGspO1xuICB9XG4gIHJldHVybiBzcGFucztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRhdGFNZXJnZVBhcmFncmFwaHMocGFyYWdyYXBocywgc291cmNlUGFyYWdyYXBocykge1xuICBsZXQgc291cmNlUGFyYWdyYXBoO1xuICBsZXQgayA9IDA7XG4gIGZvcihjb25zdCBzb3VyY2VQYXJhZ3JhcGggb2Ygc291cmNlUGFyYWdyYXBocykge1xuICAgIGlmKGsgPCBwYXJhZ3JhcGhzLmxlbmd0aCAmJiBwYXJhZ3JhcGhzW2tdLmlkID09PSBzb3VyY2VQYXJhZ3JhcGguaWQpIHtcbiAgICAgIC8vIGNvbnNvbGUubG9nKCdtZXJnaW5nIHNwYW5zJywgcGFyYWdyYXBoU3BhbnMocGFyYWdyYXBoc1trXSksIHBhcmFncmFwaFNwYW5zKHNvdXJjZVBhcmFncmFwaCkpXG4gICAgICAgIGRhdGFNZXJnZVNwYW5zKHBhcmFncmFwaFNwYW5zKHBhcmFncmFwaHNba10pLCBwYXJhZ3JhcGhTcGFucyhzb3VyY2VQYXJhZ3JhcGgpKTtcbiAgICAgICAgaysrO1xuICAgIH0gZWxzZSB7XG4gICAgICBsZXQgZm91bmQgPSBmYWxzZTtcbiAgICAgIGZvcihsZXQgaj1rOyBqPHBhcmFncmFwaHMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgaWYocGFyYWdyYXBoc1tqXS5pZCA9PT0gc291cmNlUGFyYWdyYXBoLmlkKSB7XG4gICAgICAgICAgcGFyYWdyYXBocy5zcGxpY2Uoaywgai1rKTtcbiAgICAgICAgICBwYXJhZ3JhcGhzW2tdLnRleHQgPSBzb3VyY2VQYXJhZ3JhcGgudGV4dDtcbiAgICAgICAgICBrKys7XG4gICAgICAgICAgZm91bmQgPSB0cnVlO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZighZm91bmQpIHtcbiAgICAgICAgcGFyYWdyYXBocy5zcGxpY2UoaywgMCwgc291cmNlUGFyYWdyYXBoKTtcbiAgICAgICAgaysrO1xuICAgICAgfVxuICAgICAgLy8gcGFyYWdyYXBocy5zcGxpY2UoaywgMCwgc291cmNlUGFyYWdyYXBoKTtcbiAgICAgIC8vIGsrKztcbiAgICB9XG4gIH1cbiAgLy8gY29uc29sZS5sb2coJ3BhcmFncmFwaHMnLCBwYXJhZ3JhcGhzLmxlbmd0aCwgayk7XG4gIGlmKHBhcmFncmFwaHMubGVuZ3RoID4gaykge1xuICAgIHBhcmFncmFwaHMuc3BsaWNlKGspO1xuICB9XG5cbiAgcmV0dXJuIHBhcmFncmFwaHM7XG59XG5cblxuZXhwb3J0IGZ1bmN0aW9uIGRhdGFTZWxlY3Rpb25Ub09mZnNldHMoZGF0YSwgc2VsZWN0aW9uKSB7XG4gIC8vIGdldCBsZWZ0IGFuZCByaWdodCBzcGFuL3BhcmFncmFwaFxuICAvLyBpZihzZWxlY3Rpb24ucGFyYWdyYXBoSUQgJiYgc2VsZWN0aW9uLnBhcmFncmFwaEluZGV4ID09PSB1bmRlZmluZWQgfHwgKHNlbGVjdGlvbi5zcGFuSUQgJiYgc2VsZWN0aW9uLnNwYW5JbmRleCA9PT0gdW5kZWZpbmVkKSkge1xuICAvLyAgIHNlbGVjdGlvblxuICAvLyB9XG4gIGRhdGFQb2ludGVyKGRhdGEsIHNlbGVjdGlvbi5zdGFydCk7XG4gIGRhdGFQb2ludGVyKGRhdGEsIHNlbGVjdGlvbi5lbmQpO1xuICBzZWxlY3Rpb24uc3RhcnQub2Zmc2V0TGVmdCA9IHNlbGVjdGlvbi5zdGFydC5vZmZzZXQ7XG4gIGlmKHNlbGVjdGlvbi5zdGFydC5zcGFuSW5kZXggPT09IDApIHtcbiAgICAvLyBzZWxlY3Rpb24uc3RhcnQub2Zmc2V0RnJvbVBhcmFncmFwaExlZnQgPSBzZWxlY3Rpb24uc3RhcnQub2Zmc2V0O1xuICB9IGVsc2UgaWYoc2VsZWN0aW9uLnN0YXJ0LnNwYW5JbmRleCA+IDApIHtcbiAgICBzZWxlY3Rpb24uc3RhcnQubGVmdFNwYW5JbmRleCA9IHNlbGVjdGlvbi5zdGFydC5zcGFuSW5kZXggLSAxO1xuICAgIHNlbGVjdGlvbi5zdGFydC5sZWZ0U3BhbklEID0gcGFyYWdyYXBoU3BhbnMoc2VsZWN0aW9uLnN0YXJ0LnBhcmFncmFwaClbc2VsZWN0aW9uLnN0YXJ0LnNwYW5JbmRleCAtIDFdLmlkO1xuICAgIC8vIHNlbGVjdGlvbi5zdGFydC5vZmZzZXRGcm9tTGVmdFNwYW4gPSBzZWxlY3Rpb24uc3RhcnQub2Zmc2V0O1xuICB9XG4gIHNlbGVjdGlvbi5lbmQub2Zmc2V0UmlnaHQgPSBzZWxlY3Rpb24uZW5kLnNwYW4udGV4dC5sZW5ndGggLSBzZWxlY3Rpb24uZW5kLm9mZnNldDtcbiAgaWYoc2VsZWN0aW9uLmVuZC5zcGFuSW5kZXggPj0gcGFyYWdyYXBoU3BhbnMoc2VsZWN0aW9uLmVuZC5wYXJhZ3JhcGgpLmxlbmd0aCkge1xuICAgIC8vIHNlbGVjdGlvbi5zdGFydC5vZmZzZXRGcm9tUGFyYWdyYXBoUmlnaHQgPSBzZWxlY3Rpb24uZW5kLnNwYW4udGV4dC5sZW5ndGggLSBzZWxlY3Rpb24uZW5kLm9mZnNldDtcbiAgfSBlbHNlIGlmKHNlbGVjdGlvbi5lbmQuc3BhbkluZGV4IDwgcGFyYWdyYXBoU3BhbnMoc2VsZWN0aW9uLmVuZC5wYXJhZ3JhcGgpLmxlbmd0aCAtIDEpIHtcbiAgICBzZWxlY3Rpb24uZW5kLnJpZ2h0U3BhbkluZGV4ID0gc2VsZWN0aW9uLmVuZC5zcGFuSW5kZXggKyAxO1xuICAgIHNlbGVjdGlvbi5lbmQucmlnaHRTcGFuSUQgPSBwYXJhZ3JhcGhTcGFucyhzZWxlY3Rpb24uZW5kLnBhcmFncmFwaClbc2VsZWN0aW9uLmVuZC5zcGFuSW5kZXggKyAxXS5pZDtcbiAgICAvLyBzZWxlY3Rpb24uZW5kLm9mZnNldEZyb21SaWdodFNwYW4gPSBzZWxlY3Rpb24uZW5kLnNwYW4udGV4dC5sZW5ndGggLSBzZWxlY3Rpb24uZW5kLm9mZnNldDtcbiAgfVxuXG4gIHJldHVybiBzZWxlY3Rpb247XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkYXRhU2VsZWN0aW9uUmVzdG9yZUZyb21PZmZzZXRzKGRhdGEsIHNlbGVjdGlvbikge1xuICBpZihzZWxlY3Rpb24uc3RhcnQub2Zmc2V0TGVmdCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgbGV0IG9mZnNldCA9IDA7XG4gICAgY29uc3Qgc3BhbnMgPSBwYXJhZ3JhcGhTcGFucyhzZWxlY3Rpb24uc3RhcnQucGFyYWdyYXBoKTtcbiAgICBmb3IobGV0IGk9c2VsZWN0aW9uLnN0YXJ0LmxlZnRTcGFuSW5kZXggPT09IHVuZGVmaW5lZCA/IDAgOiBzZWxlY3Rpb24uc3RhcnQubGVmdFNwYW5JbmRleCsxOyBpPHNwYW5zLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBzcGFuID0gc3BhbnNbaV07XG4gICAgICBpZihzZWxlY3Rpb24uc3RhcnQub2Zmc2V0TGVmdCA+PSBvZmZzZXQgJiYgc2VsZWN0aW9uLnN0YXJ0Lm9mZnNldExlZnQgPD0gb2Zmc2V0ICsgc3Bhbi50ZXh0Lmxlbmd0aCkge1xuICAgICAgICBzZWxlY3Rpb24uc3RhcnQuc3BhbkluZGV4ID0gaTtcbiAgICAgICAgc2VsZWN0aW9uLnN0YXJ0LnNwYW4gPSBzcGFuO1xuICAgICAgICBzZWxlY3Rpb24uc3RhcnQuc3BhbklEID0gc3Bhbi5pZDtcbiAgICAgICAgc2VsZWN0aW9uLnN0YXJ0Lm9mZnNldCA9IHNlbGVjdGlvbi5zdGFydC5vZmZzZXRMZWZ0IC0gb2Zmc2V0O1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIG9mZnNldCArPSBzcGFuLnRleHQubGVuZ3RoO1xuICAgIH1cbiAgfVxuICBpZihzZWxlY3Rpb24uZW5kLm9mZnNldFJpZ2h0ICE9PSB1bmRlZmluZWQpIHtcbiAgICBsZXQgb2Zmc2V0ID0gMDtcbiAgICBjb25zdCBzcGFucyA9IHBhcmFncmFwaFNwYW5zKHNlbGVjdGlvbi5lbmQucGFyYWdyYXBoKTtcbiAgICBpZihzZWxlY3Rpb24uZW5kLnJpZ2h0U3BhbklEICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGZvcihsZXQgaT1zZWxlY3Rpb24uc3RhcnQubGVmdFNwYW5JbmRleDsgaSA8IHNwYW5zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IHNwYW4gPSBzcGFuc1tpXTtcbiAgICAgICAgaWYoc3Bhbi5pZCA9PT0gc2VsZWN0aW9uLmVuZC5yaWdodFNwYW5JRCkge1xuICAgICAgICAgIHNlbGVjdGlvbi5lbmQucmlnaHRTcGFuSW5kZXggPSBpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGZvcihsZXQgaT1zZWxlY3Rpb24uZW5kLnJpZ2h0U3BhbkluZGV4ID09PSB1bmRlZmluZWQgPyBzcGFucy5sZW5ndGgtMSA6IHNlbGVjdGlvbi5lbmQucmlnaHRTcGFuSW5kZXgtMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgIGNvbnN0IHNwYW4gPSBzcGFuc1tpXTtcbiAgICAgIGlmKHNlbGVjdGlvbi5lbmQub2Zmc2V0UmlnaHQgPj0gb2Zmc2V0ICYmIHNlbGVjdGlvbi5lbmQub2Zmc2V0UmlnaHQgPD0gb2Zmc2V0ICsgc3Bhbi50ZXh0Lmxlbmd0aCkge1xuICAgICAgICBzZWxlY3Rpb24uZW5kLnNwYW5JbmRleCA9IGk7XG4gICAgICAgIHNlbGVjdGlvbi5lbmQuc3BhbiA9IHNwYW47XG4gICAgICAgIHNlbGVjdGlvbi5lbmQuc3BhbklEID0gc3Bhbi5pZDtcbiAgICAgICAgc2VsZWN0aW9uLmVuZC5vZmZzZXQgPSBzcGFuLnRleHQubGVuZ3RoIC0gKHNlbGVjdGlvbi5lbmQub2Zmc2V0UmlnaHQgLSBvZmZzZXQpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIG9mZnNldCArPSBzcGFuLnRleHQubGVuZ3RoO1xuICAgIH1cbiAgfVxuICBkZWxldGUgc2VsZWN0aW9uLnN0YXJ0Lm9mZnNldExlZnQ7XG4gIGRlbGV0ZSBzZWxlY3Rpb24uc3RhcnQubGVmdFNwYW5JbmRleDtcbiAgZGVsZXRlIHNlbGVjdGlvbi5zdGFydC5sZWZ0U3BhbklEO1xuICBkZWxldGUgc2VsZWN0aW9uLmVuZC5vZmZzZXRSaWdodDtcbiAgZGVsZXRlIHNlbGVjdGlvbi5lbmQucmlnaHRTcGFuSW5kZXg7XG4gIGRlbGV0ZSBzZWxlY3Rpb24uZW5kLnJpZ2h0U3BhbklEO1xuICByZXR1cm4gc2VsZWN0aW9uO1xufVxuXG5cblxuXG5mdW5jdGlvbiogcGFyYWdyYXBoU3Bhbkl0ZXJhdG9yKHNwYW5zLCBzdGFydElELCBlbmRJRCkge1xuICBsZXQgc3RhcnRlZCA9IHN0YXJ0SUQgPT09IHVuZGVmaW5lZDtcbiAgZm9yKGNvbnN0IHNwYW4gb2Ygc3BhbnMpIHtcbiAgICBpZighc3RhcnRlZCAmJiBzcGFuLmlkID09PSBzdGFydElEKSB7XG4gICAgICBzdGFydGVkID0gdHJ1ZTtcbiAgICB9XG4gICAgaWYoIXN0YXJ0ZWQpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICB5aWVsZCBzcGFuO1xuICAgIGlmKGVuZElEICE9PSB1bmRlZmluZWQgJiYgc3Bhbi5pZCA9PT0gZW5kSUQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uKiBkYXRhU3Bhbkl0ZXJhdG9yKGRhdGEsIHN0YXJ0LCBlbmQpIHtcbiAgY29uc3QgcGFyYWdyYXBocyA9IGRhdGE7XG4gIGxldCBzdGFydGVkID0gZmFsc2U7XG4gIGZvcihjb25zdCBwYXJhZ3JhcGggb2YgcGFyYWdyYXBocykge1xuICAgIGlmKCFzdGFydCkge1xuICAgICAgc3RhcnRlZCA9IHRydWU7XG4gICAgfVxuICAgIGlmKHN0YXJ0ICYmIHBhcmFncmFwaC5pZCA9PT0gc3RhcnQucGFyYWdyYXBoSUQgJiYgZW5kICYmIHBhcmFncmFwaC5pZCA9PT0gZW5kLnBhcmFncmFwaElEKSB7XG4gICAgICB5aWVsZCogcGFyYWdyYXBoU3Bhbkl0ZXJhdG9yKHBhcmFncmFwaC5zcGFucywgc3RhcnQuc3BhbklELCBlbmQuc3BhbklEKTtcbiAgICAgIHJldHVybjtcbiAgICB9IGVsc2UgaWYoc3RhcnQgJiYgcGFyYWdyYXBoLmlkID09PSBzdGFydC5wYXJhZ3JhcGhJRCkge1xuICAgICAgc3RhcnRlZCA9IHRydWU7XG4gICAgICB5aWVsZCogcGFyYWdyYXBoU3Bhbkl0ZXJhdG9yKHBhcmFncmFwaC5zcGFucywgc3RhcnQuc3BhbklEKTtcbiAgICB9IGVsc2UgaWYoZW5kICYmIHBhcmFncmFwaC5pZCA9PT0gZW5kLnBhcmFncmFwaElEKSB7XG4gICAgICBpZihzdGFydGVkKSB7XG4gICAgICAgIHlpZWxkKiBwYXJhZ3JhcGhTcGFuSXRlcmF0b3IocGFyYWdyYXBoLnNwYW5zLCB1bmRlZmluZWQsIGVuZC5zcGFuSUQpO1xuICAgICAgfVxuICAgICAgcmV0dXJuO1xuICAgIH0gZWxzZSBpZihzdGFydGVkKSB7XG4gICAgICB5aWVsZCogcGFyYWdyYXBoLnNwYW5zO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24qIGRhdGFJdGVyYXRvcihkYXRhLCBzdGFydCwgZW5kKSB7XG4gIGNvbnN0IHBhcmFncmFwaHMgPSBkYXRhO1xuICBsZXQgc3RhcnRlZCA9IGZhbHNlO1xuICBmb3IoY29uc3QgcGFyYWdyYXBoIG9mIHBhcmFncmFwaHMpIHtcbiAgICBpZighc3RhcnQpIHtcbiAgICAgIHN0YXJ0ZWQgPSB0cnVlO1xuICAgIH1cbiAgICBpZihzdGFydCAmJiBwYXJhZ3JhcGguaWQgPT09IHN0YXJ0LnBhcmFncmFwaElEICYmIGVuZCAmJiBwYXJhZ3JhcGguaWQgPT09IGVuZC5wYXJhZ3JhcGhJRCkge1xuICAgICAgLy8geWllbGQqIHBhcmFncmFwaFNwYW5JdGVyYXRvcihwYXJhZ3JhcGguc3BhbnMsIHN0YXJ0LnNwYW5JRCwgZW5kLnNwYW5JRCk7XG4gICAgICB5aWVsZCB7IHBhcmFncmFwaCwgc3BhbnM6IEFycmF5LmZyb20ocGFyYWdyYXBoU3Bhbkl0ZXJhdG9yKHBhcmFncmFwaC5zcGFucywgc3RhcnQuc3BhbklELCBlbmQuc3BhbklEKSkgfTtcbiAgICAgIHJldHVybjtcbiAgICB9IGVsc2UgaWYoc3RhcnQgJiYgcGFyYWdyYXBoLmlkID09PSBzdGFydC5wYXJhZ3JhcGhJRCkge1xuICAgICAgc3RhcnRlZCA9IHRydWU7XG4gICAgICAvLyB5aWVsZCogcGFyYWdyYXBoU3Bhbkl0ZXJhdG9yKHBhcmFncmFwaC5zcGFucywgc3RhcnQuc3BhbklEKTtcbiAgICAgIHlpZWxkIHsgcGFyYWdyYXBoLCBzcGFuczogQXJyYXkuZnJvbShwYXJhZ3JhcGhTcGFuSXRlcmF0b3IocGFyYWdyYXBoLnNwYW5zLCBzdGFydC5zcGFuSUQpKSB9O1xuICAgIH0gZWxzZSBpZihlbmQgJiYgcGFyYWdyYXBoLmlkID09PSBlbmQucGFyYWdyYXBoSUQpIHtcbiAgICAgIGlmKHN0YXJ0ZWQpIHtcbiAgICAgICAgLy8geWllbGQqIHBhcmFncmFwaFNwYW5JdGVyYXRvcihwYXJhZ3JhcGguc3BhbnMsIHVuZGVmaW5lZCwgZW5kLnNwYW5JRCk7XG4gICAgICAgIHlpZWxkIHsgcGFyYWdyYXBoLCBzcGFuczogQXJyYXkuZnJvbShwYXJhZ3JhcGhTcGFuSXRlcmF0b3IocGFyYWdyYXBoLnNwYW5zLCB1bmRlZmluZWQsIGVuZC5zcGFuSUQpKSB9O1xuICAgICAgfVxuICAgICAgcmV0dXJuO1xuICAgIH0gZWxzZSBpZihzdGFydGVkKSB7XG4gICAgICAvLyB5aWVsZCogcGFyYWdyYXBoLnNwYW5zO1xuICAgICAgeWllbGQgeyBwYXJhZ3JhcGgsIHNwYW5zOiBBcnJheS5mcm9tKHBhcmFncmFwaC5zcGFucykgfTtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG5leHQoZGF0YSwgcG9pbnRlcikge1xuICBjb25zdCBwYXJhZ3JhcGhzID0gZGF0YTtcbiAgbGV0IHsgcGFyYWdyYXBoSW5kZXgsIHNwYW5JbmRleCwgcGFyYWdyYXBoIH0gPSBpZFRvSW5kZXgoZGF0YSwgcG9pbnRlci5wYXJhZ3JhcGhJRCwgcG9pbnRlci5zcGFuSUQpO1xuICBpZihzcGFuSW5kZXggPCBwYXJhZ3JhcGguc3BhbnMubGVuZ3RoIC0gMSkge1xuICAgIHNwYW5JbmRleCArPSAxO1xuICAgIHJldHVybiBPYmplY3QuYXNzaWduKHsgcGFyYWdyYXBoSUQ6IHBhcmFncmFwaC5pZCwgc3BhbklEOiBwYXJhZ3JhcGguc3BhbnNbc3BhbkluZGV4XS5pZCB9LCBpZFRvSW5kZXgoZGF0YSwgcGFyYWdyYXBoLmlkLCBwYXJhZ3JhcGguc3BhbnNbc3BhbkluZGV4XSkpO1xuICB9IGVsc2UgaWYocGFyYWdyYXBoSW5kZXggPCBwYXJhZ3JhcGhzLmxlbmd0aC0xKSB7XG4gICAgcGFyYWdyYXBoSW5kZXggKz0gMTtcbiAgICBzcGFuSW5kZXggPSAwO1xuICAgIGZvcig7IHBhcmFncmFwaEluZGV4IDwgcGFyYWdyYXBocy5sZW5ndGg7IHBhcmFncmFwaEluZGV4KyspIHtcbiAgICAgIHBhcmFncmFwaCA9IHBhcmFncmFwaHNbcGFyYWdyYXBoSW5kZXhdO1xuICAgICAgaWYocGFyYWdyYXBoLnNwYW5zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICAgIGlmKHBhcmFncmFwaC5zcGFucy5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgcmV0dXJuIHBvaW50ZXJSZXNvbHZlKGRhdGEsIE9iamVjdC5hc3NpZ24oeyBwYXJhZ3JhcGhJRDogcGFyYWdyYXBoLmlkLCBzcGFuSUQ6IHBhcmFncmFwaC5zcGFuc1tzcGFuSW5kZXhdLmlkIH0sIGlkVG9JbmRleChkYXRhLCBwYXJhZ3JhcGguaWQsIHBhcmFncmFwaC5zcGFuc1tzcGFuSW5kZXhdKSkpO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwcmV2KGRhdGEsIHBvaW50ZXIpIHtcbiAgY29uc3QgcGFyYWdyYXBocyA9IGRhdGE7XG4gIGxldCB7IHBhcmFncmFwaEluZGV4LCBzcGFuSW5kZXgsIHBhcmFncmFwaCB9ID0gaWRUb0luZGV4KGRhdGEsIHBvaW50ZXIucGFyYWdyYXBoSUQsIHBvaW50ZXIuc3BhbklEKTtcbiAgaWYoc3BhbkluZGV4ID4gMCkge1xuICAgIHNwYW5JbmRleCAtPSAxO1xuICAgIHJldHVybiBPYmplY3QuYXNzaWduKHsgcGFyYWdyYXBoSUQ6IHBhcmFncmFwaC5pZCwgc3BhbklEOiBwYXJhZ3JhcGguc3BhbnNbc3BhbkluZGV4XS5pZCB9LCBpZFRvSW5kZXgoZGF0YSwgcGFyYWdyYXBoLmlkLCBwYXJhZ3JhcGguc3BhbnNbc3BhbkluZGV4XSkpO1xuICB9IGVsc2UgaWYocGFyYWdyYXBoSW5kZXggPiAwKSB7XG4gICAgcGFyYWdyYXBoSW5kZXggLT0gMTtcbiAgICBzcGFuSW5kZXggPSAwO1xuICAgIGZvcig7IHBhcmFncmFwaEluZGV4ID49IDA7IHBhcmFncmFwaEluZGV4LS0pIHtcbiAgICAgIHBhcmFncmFwaCA9IHBhcmFncmFwaHNbcGFyYWdyYXBoSW5kZXhdO1xuICAgICAgaWYocGFyYWdyYXBoLnNwYW5zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgc3BhbkluZGV4ID0gcGFyYWdyYXBoLnNwYW5zLmxlbmd0aC0xO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gICAgaWYocGFyYWdyYXBoLnNwYW5zLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICByZXR1cm4gcG9pbnRlclJlc29sdmUoZGF0YSwgT2JqZWN0LmFzc2lnbih7IHBhcmFncmFwaElEOiBwYXJhZ3JhcGguaWQsIHNwYW5JRDogcGFyYWdyYXBoLnNwYW5zW3NwYW5JbmRleF0uaWQgfSwgaWRUb0luZGV4KGRhdGEsIHBhcmFncmFwaC5pZCwgcGFyYWdyYXBoLnNwYW5zW3NwYW5JbmRleF0pKSk7XG4gIH1cbn1cbiIsIjx0ZW1wbGF0ZT5cbiAgPGRpdiBzdHlsZT1cImJvcmRlcjogMXB4IHNvbGlkICNjY2NcIiA6Y29udGVudGVkaXRhYmxlPVwiZWRpdGFibGVcIiBzcGVsbGNoZWNrPVwiZmFsc2VcIiA6a2V5PVwia2V5XCJcbiAgICBAaW5wdXQ9XCJvbklucHV0XCIgQGtleWRvd249XCJvbktleWRvd25cIiBAcGFzdGU9XCJvblBhc3RlXCIgQGN1dD1cIm9uQ3V0XCIgQGNvcHk9XCJvbkNvcHlcIlxuICAgIEBzZWxlY3RzdGFydD1cInNlbGVjdFN0YXJ0XCIgQG1vdXNldXA9XCJzZWxlY3RFbmRcIiBAZHJhZ3N0YXJ0PVwib25EcmFnU3RhcnRcIlxuICAgIHJlZj1cImNvbnRhaW5lclwiIGNsYXNzPVwidHJhbnNjcmlwdFwiPlxuICAgIDxkaXYgdi1mb3I9XCIocGFyYWdyYXBoLCBpbmRleCkgaW4gcGFyYWdyYXBoc1wiIDpkYXRhLWlkPVwicGFyYWdyYXBoLmlkXCIgOmtleT1cInBhcmFncmFwaC5pZFwiIDpjb250ZW50ZWRpdGFibGU9XCJlZGl0YWJsZVwiXG4gICAgICA6Y2xhc3M9XCJ7ICdsaXN0LWl0ZW0nOiBwYXJhZ3JhcGguYnVsbGV0IH1cIiBjbGFzcz1cInBhcmFncmFwaFwiXG4gICAgICA6ZGF0YS10aW1lPVwicGFyYWdyYXBoLnNwYW5zLmxlbmd0aCA+IDAgPyAocGFyYWdyYXBoLnNwYW5zWzBdLnRpbWUgLyAxMDAwKS50b0ZpeGVkKDIpIDogJydcIj5cbiAgICAgIDxzcGFuIHYtZm9yPVwiKHNwYW4sIGluZGV4KSBpbiBwYXJhZ3JhcGguc3BhbnNcIiA6a2V5PVwic3Bhbi5pZFwiIDpkYXRhLWZpcnN0PVwiaW5kZXggPT0gMFwiIDpkYXRhLWxhc3Q9XCJpbmRleCA+PSBwYXJhZ3JhcGguc3BhbnMubGVuZ3RoLTFcIiA6Y29udGVudGVkaXRhYmxlPVwiZWRpdGFibGVcIlxuICAgICAgICAgICAgOmRhdGEtaWQ9XCJzcGFuLmlkXCIgOmRhdGEtdGltZT1cInNwYW4udGltZVwiIDpkYXRhLWR1cmF0aW9uPVwic3Bhbi5kdXJhdGlvblwiIDpkYXRhLWNvbmZpZGVuY2U9XCJzcGFuLmNvbmZpZGVuY2VcIiBjbGFzcz1cInNwYW4gdG9rZW5cIlxuICAgICAgICAgICAgOmNsYXNzPVwie1xuICAgICAgICAgICAgICBzZWxlY3RlZDogc3Bhbi50aW1lIDw9IHRpbWUgJiYgdGltZSA8IHNwYW4udGltZSArIHNwYW4uZHVyYXRpb24sXG4gICAgICAgICAgICAgIHBhc3Q6IHNwYW4udGltZSArIHNwYW4uZHVyYXRpb24gPD0gdGltZSwgaGlnaGxpZ2h0ZWQ6IHNwYW4uaGlnaGxpZ2h0ZWQsXG4gICAgICAgICAgICAgIGJvbGQ6IHNwYW4uZm9ybWF0ICYmIHNwYW4uZm9ybWF0LmJvbGQsIGl0YWxpYzogc3Bhbi5mb3JtYXQgJiYgc3Bhbi5mb3JtYXQuaXRhbGljLCB1bmRlcmxpbmU6IHNwYW4uZm9ybWF0ICYmIHNwYW4uZm9ybWF0LnVuZGVybGluZSxcbiAgICAgICAgICAgICAgc3VwZXJzY3JpcHQ6IHNwYW4uZm9ybWF0ICYmIHNwYW4uZm9ybWF0LnN1cGVyc2NyaXB0LCBzdWJzY3JpcHQ6IHNwYW4uZm9ybWF0ICYmIHNwYW4uZm9ybWF0LnN1YnNjcmlwdCxcbiAgICAgICAgICAgIH1cIlxuICAgICAgICAgICAgQGNsaWNrPVwic3BhblNlbGVjdGVkKHNwYW4sICRldmVudClcIlxuICAgICAgICAgICAgOnN0eWxlPVwic2hvd0NvbmZpZGVuY2UgPyBgb3BhY2l0eTogJHtNYXRoLnBvdyhzcGFuLmNvbmZpZGVuY2UsIDAuNSkgLyAyICsgLjV9O2AgOiAnJ1wiXG4gICAgICAgICAgICA6dGl0bGU9XCJzaG93Q29uZmlkZW5jZSA/IGBDb25maWRlbmNlOiAke3NwYW4uY29uZmlkZW5jZX1gIDogJydcIlxuICAgICAgPlxuICAgICAgICB7e3NwYW4udGV4dH19XG4gICAgICA8L3NwYW4+XG4gICAgPC9kaXY+XG4gIDwvZGl2PlxuPC90ZW1wbGF0ZT5cblxuPHNjcmlwdD5cblxuLy8gaHR0cHM6Ly9sZXZlbHVwLmdpdGNvbm5lY3RlZC5jb20vZGVib3VuY2UtaW4tamF2YXNjcmlwdC1pbXByb3ZlLXlvdXItYXBwbGljYXRpb25zLXBlcmZvcm1hbmNlLTViMDE4NTVlMDg2XG4vLyBodHRwczovL2Rhdmlkd2Fsc2gubmFtZS9qYXZhc2NyaXB0LWRlYm91bmNlLWZ1bmN0aW9uXG4vLyBSZXR1cm5zIGEgZnVuY3Rpb24sIHRoYXQsIGFzIGxvbmcgYXMgaXQgY29udGludWVzIHRvIGJlIGludm9rZWQsIHdpbGwgbm90XG4vLyBiZSB0cmlnZ2VyZWQuIFRoZSBmdW5jdGlvbiB3aWxsIGJlIGNhbGxlZCBhZnRlciBpdCBzdG9wcyBiZWluZyBjYWxsZWQgZm9yXG4vLyBOIG1pbGxpc2Vjb25kcy4gSWYgYGltbWVkaWF0ZWAgaXMgcGFzc2VkLCB0cmlnZ2VyIHRoZSBmdW5jdGlvbiBvbiB0aGVcbi8vIGxlYWRpbmcgZWRnZSwgaW5zdGVhZCBvZiB0aGUgdHJhaWxpbmcuXG5cbi8vIGNvbnN0IGRlYm91bmNlID0gKGZ1bmMsIHdhaXQsIGltbWVkaWF0ZSkgPT4ge1xuLy8gICBsZXQgdGltZW91dDtcbi8vXG4vLyAgIHJldHVybiBmdW5jdGlvbiBleGVjdXRlZEZ1bmN0aW9uKC4uLmFyZ3MpIHtcbi8vICAgICBjb25zdCBsYXRlciA9ICgpID0+IHtcbi8vICAgICAgIHRpbWVvdXQgPSBudWxsO1xuLy8gICAgICAgaWYoIWltbWVkaWF0ZSkgZnVuYy5hcHBseSh0aGlzLCBhcmdzKTtcbi8vICAgICB9O1xuLy8gICAgIGNvbnN0IGNhbGxOb3cgPSBpbW1lZGlhdGUgJiYgIXRpbWVvdXQ7XG4vLyAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xuLy8gICAgIHRpbWVvdXQgPSBzZXRUaW1lb3V0KGxhdGVyLCB3YWl0KTtcbi8vICAgICBpZihjYWxsTm93KSBmdW5jLmFwcGx5KHRoaXMsIGFyZ3MpO1xuLy8gICB9O1xuLy8gfTtcblxuZnVuY3Rpb24gZGVib3VuY2VkKGZ1bmMsIHdhaXQsIGltbWVkaWF0ZSkge1xuICBsZXQgdGltZW91dDtcblxuICByZXR1cm4ge1xuXG4gICAgbm93KHNlbGYsIC4uLmFyZ3MpIHtcbiAgICAgIHRpbWVvdXQgPSBudWxsO1xuICAgICAgaWYoIWltbWVkaWF0ZSkgcmV0dXJuIGZ1bmMuYXBwbHkoc2VsZiwgYXJncyk7XG4gICAgfSxcblxuICAgIGRlYm91bmNlZChzZWxmLCAuLi5hcmdzKSB7XG4gICAgICBjb25zdCBjYWxsTm93ID0gaW1tZWRpYXRlICYmICF0aW1lb3V0O1xuICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xuICAgICAgdGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4geyB0aGlzLm5vdyhzZWxmLCAuLi5hcmdzKTsgfSwgd2FpdCk7XG4gICAgICBpZihjYWxsTm93KSBmdW5jLmFwcGx5KHNlbGYsIGFyZ3MpO1xuICAgIH0sXG4gIH07XG59XG5cbmNvbnN0IHRvSlNPTiA9IChvYmopID0+IEpTT04uc3RyaW5naWZ5KG9iaiwgdW5kZWZpbmVkLCAyKTtcbmNvbnN0IGZyZWV6ZSA9IChvYmopID0+IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkob2JqKSk7XG5cbmltcG9ydCB7XG4gIHBhcnNlRE9NLFxuICBwYXJzZVZhbmlsbGFET00sXG4gIGRhdGFNZXJnZVBhcmFncmFwaHMsXG4gIG5ld1BhcmFncmFwaCxcbiAgZGF0YVBvaW50ZXIsXG4gIGRhdGFTcGxpY2UsXG4gIGRhdGFJbnNlcnQsXG4gIG5vcm1hbGl6ZWRET01TZWxlY3Rpb24sXG4gIHJlc3RvcmVET01TZWxlY3Rpb24sXG4gIGRhdGFQb2ludGVyRE9NTm9kZSxcbiAgZGF0YVBvaW50ZXJQcmV2LFxuICBkYXRhUG9pbnRlck5leHQsXG4gIGRhdGFJdGVyYXRvcixcbiAgU3BsaWNlTW9kZSxcbiAgbmV3SUQsXG4gIGRhdGFQb2ludGVyRnJvbURPTVBvaW50ZXIsXG4gIHBvaW50ZXJUZXh0T2Zmc2V0SW5Db250YWluZXIsXG4gIGRhdGFTZWxlY3Rpb25Ub09mZnNldHMsXG4gIGRhdGFTZWxlY3Rpb25SZXN0b3JlRnJvbU9mZnNldHMsXG59IGZyb20gJy4vZWRpdG9yLmpzJztcblxuZXhwb3J0IGRlZmF1bHQge1xuXG4gIHByb3BzOiB7XG4gICAgbW9kZWxWYWx1ZTogT2JqZWN0LFxuICAgIHRpbWU6IE51bWJlcixcbiAgICBlZGl0YWJsZToge3R5cGU6IEJvb2xlYW4sIGRlZmF1bHQ6IHRydWV9LFxuICAgIHNob3dDb25maWRlbmNlOiB7dHlwZTogQm9vbGVhbiwgZGVmYXVsdDogZmFsc2V9LFxuICB9LFxuXG4gIGRhdGEoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHBhcmFncmFwaHM6IFtdLFxuICAgICAga2V5OiAxLFxuICAgIH07XG4gIH0sXG5cbiAgbW91bnRlZCgpIHtcbiAgICAvLyA1MDAgbWF5IGJlIHRvbyBzbG93IC0gdXNlciBjYW4gdXBkYXRlIHRleHQgYW5kIHByZXNzIHNvbWUgaG90a2V5IGJlZm9yZSB2ZXJzaW9uIGNoYW5nZSBoYXMgYmVlbiByZWdpc3RlcmVkXG4gICAgY29uc3QgZGQgPSBkZWJvdW5jZWQodGhpcy5hcHBseVZpZXdDaGFuZ2VzTm93LCAyMDApO1xuICAgIHRoaXMuYXBwbHlWaWV3Q2hhbmdlc05vdyA9ICguLi5hcmdzKSA9PiBkZC5ub3codGhpcywgLi4uYXJncyk7XG4gICAgdGhpcy5hcHBseVZpZXdDaGFuZ2VzID0gKC4uLmFyZ3MpID0+IGRkLmRlYm91bmNlZCh0aGlzLCAuLi5hcmdzKTtcbiAgICAvLyBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdzZWxlY3Rpb25jaGFuZ2UnLCAoKSA9PiB7XG4gICAgLy8gICBjb25zb2xlLmRlYnVnKGRvY3VtZW50LmdldFNlbGVjdGlvbigpKTtcbiAgICAvLyB9KTtcbiAgICB0aGlzLiRvcHRpb25zLndhdGNoLm1vZGVsVmFsdWUuY2FsbCh0aGlzLCB0aGlzLm1vZGVsVmFsdWUpO1xuICB9LFxuXG4gIHdhdGNoOiB7XG4gICAgbW9kZWxWYWx1ZSh2YWx1ZSkge1xuICAgICAgdGhpcy5wYXJhZ3JhcGhzID0gdmFsdWUucGFyYWdyYXBocyB8fCBbXTtcbiAgICB9LFxuICAgIC8vIHRpbWUodmFsdWUpIHtcbiAgICAvLyAgIGNvbnNvbGUuZGVidWcoJ3RpbWUgdXBkYXRlZCB0bycsIHRoaXMudGltZSk7XG4gICAgLy8gfSxcbiAgfSxcblxuICBtZXRob2RzOiB7XG5cbiAgICByZXNldCgpIHtcbiAgICAgIGNvbnNvbGUuZGVidWcoJ3Jlc2V0dGluZycpO1xuICAgICAgdGhpcy5rZXkgKz0gMTtcbiAgICB9LFxuXG4gICAgc2F2ZSgpIHtcbiAgICAgIC8vIGNvbnNvbGUuZGVidWcoJ3VwZGF0aW5nIHNvdXJjZScpXG4gICAgICB0aGlzLiRlbWl0KCd1cGRhdGU6bW9kZWxWYWx1ZScsIE9iamVjdC5hc3NpZ24oe30sIHRoaXMubW9kZWxWYWx1ZSwgeyBwYXJhZ3JhcGhzOiB0aGlzLnBhcmFncmFwaHMgfSkpO1xuICAgIH0sXG5cbiAgICBkb3dubG9hZChmaWxlbmFtZSwgdGV4dCwgdHlwZSA9ICd0ZXh0L3BsYWluJykge1xuICAgICAgLy8gaHR0cHM6Ly9vdXJjb2Rld29ybGQuY29tL2FydGljbGVzL3JlYWQvMTg5L2hvdy10by1jcmVhdGUtYS1maWxlLWFuZC1nZW5lcmF0ZS1hLWRvd25sb2FkLXdpdGgtamF2YXNjcmlwdC1pbi10aGUtYnJvd3Nlci13aXRob3V0LWEtc2VydmVyXG4gICAgICBsZXQgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcbiAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdocmVmJywgYGRhdGE6JHt0eXBlfTtjaGFyc2V0PXV0Zi04LGAgKyBlbmNvZGVVUklDb21wb25lbnQodGV4dCkpO1xuICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2Rvd25sb2FkJywgZmlsZW5hbWUpO1xuICAgICAgZWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlbGVtZW50KTtcbiAgICAgIGVsZW1lbnQuY2xpY2soKTtcbiAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoZWxlbWVudCk7XG4gICAgfSxcblxuICAgIGFzSFRNTChzb3VyY2UpIHtcbiAgICAgIGlmKCFzb3VyY2UpIHtcbiAgICAgICAgc291cmNlID0gdGhpcy5wYXJhZ3JhcGhzO1xuICAgICAgfVxuICAgICAgY29uc3QgcGFyYWdyYXBocyA9IFtdO1xuICAgICAgZm9yKGNvbnN0IHBhcmFncmFwaCBvZiBzb3VyY2UpIHtcbiAgICAgICAgbGV0IHNlbnRlbmNlID0gW107XG4gICAgICAgIGZvcihjb25zdCBzcGFuIG9mIHBhcmFncmFwaC5zcGFucykge1xuICAgICAgICAgIGxldCB0YWcgPSAnc3Bhbic7XG4gICAgICAgICAgaWYoc3Bhbi5mb3JtYXQpIHtcbiAgICAgICAgICAgIGlmKHNwYW4uZm9ybWF0LmJvbGQpIHtcbiAgICAgICAgICAgICAgdGFnID0gJ3N0cm9uZyc7XG4gICAgICAgICAgICB9IGVsc2UgaWYoc3Bhbi5mb3JtYXQuaXRhbGljKSB7XG4gICAgICAgICAgICAgIHRhZyA9ICdlbSc7XG4gICAgICAgICAgICB9IGVsc2UgaWYoc3Bhbi5mb3JtYXQudW5kZXJsaW5lKSB7XG4gICAgICAgICAgICAgIHRhZyA9ICd1JztcbiAgICAgICAgICAgIH0gZWxzZSBpZihzcGFuLmZvcm1hdC5zdWJzY3JpcHQpIHtcbiAgICAgICAgICAgICAgdGFnID0gJ3N1Yic7XG4gICAgICAgICAgICB9IGVsc2UgaWYoc3Bhbi5mb3JtYXQuc3VwZXJzY3JpcHQpIHtcbiAgICAgICAgICAgICAgdGFnID0gJ3N1cCc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHNlbnRlbmNlLnB1c2goYDwke3RhZ30+JHtzcGFuLnRleHR9PC8ke3RhZ30+YCk7XG4gICAgICAgIH1cbiAgICAgICAgc2VudGVuY2UgPSBzZW50ZW5jZS5qb2luKCcnKTtcbiAgICAgICAgaWYocGFyYWdyYXBoLmJ1bGxldCkge1xuICAgICAgICAgIHBhcmFncmFwaHMucHVzaChgPGxpPiR7c2VudGVuY2V9PC9saT5gKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHBhcmFncmFwaHMucHVzaChgPHA+JHtzZW50ZW5jZX08L3A+YClcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHBhcmFncmFwaHMuam9pbignXFxuJyk7XG4gICAgfSxcblxuICAgIGV4cG9ydFdvcmQobmFtZT0nZG9jdW1lbnQuZG9jJykge1xuXG4gICAgICBjb25zdCBwYXJhZ3JhcGhzID0gdGhpcy5hc0hUTUwoKTtcblxuICAgICAgY29uc3QgdGl0bGUgPSAnUlVUQSBleHBvcnRlZCBkb2N1bWVudCc7XG5cbiAgICAgIGNvbnN0IGh0bWwgPSBgPGh0bWwgeG1sbnM6bz1cInVybjpzY2hlbWFzLW1pY3Jvc29mdC1jb206b2ZmaWNlOm9mZmljZVwiIHhtbG5zOnc9XCJ1cm46c2NoZW1hcy1taWNyb3NvZnQtY29tOm9mZmljZTp3b3JkXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy9UUi9SRUMtaHRtbDQwXCI+XG4gICAgICA8aGVhZD48bWV0YSBjaGFyc2V0PSd1dGYtOCc+PHRpdGxlPiR7dGl0bGV9PC90aXRsZT48L2hlYWQ+XG4gICAgICA8Ym9keT4ke3BhcmFncmFwaHN9PC9ib2R5PlxuICAgICAgPC9odG1sPmA7XG5cbiAgICAgIHRoaXMuZG93bmxvYWQobmFtZSwgaHRtbCwgJ2FwcGxpY2F0aW9uL3ZuZC5tcy13b3JkJyk7XG4gICAgfSxcblxuICAgIHNwYW5TZWxlY3RlZChzcGFuLCBldmVudCkge1xuICAgICAgaWYoZG9jdW1lbnQuZ2V0U2VsZWN0aW9uKCkuaXNDb2xsYXBzZWQpIHtcbiAgICAgICAgLy8gY29uc29sZS5kZWJ1Zygnc3BhbiBzZWxlY3RlZCcsIHNwYW4pO1xuICAgICAgICB0aGlzLiRlbWl0KCd1cGRhdGU6dGltZScsIHNwYW4udGltZSk7XG4gICAgICB9XG4gICAgfSxcblxuICAgIHNlbGVjdFN0YXJ0KGV2ZW50KSB7XG4gICAgICAvLyBjb25zb2xlLmRlYnVnKCdzZWxlY3Qgc3RhcnQnLCBldmVudCk7XG4gICAgfSxcblxuICAgIHNlbGVjdEVuZChldmVudCkge1xuICAgICAgY29uc3QgZGF0YSA9IHRoaXMucGFyYWdyYXBocztcbiAgICAgIGNvbnN0IHNlbGVjdGlvbiA9IG5vcm1hbGl6ZWRET01TZWxlY3Rpb24oKTtcbiAgICAgIGNvbnN0IHN0YXJ0ID0gc2VsZWN0aW9uLnN0YXJ0O1xuICAgICAgZGF0YVBvaW50ZXIoZGF0YSwgc3RhcnQpO1xuICAgICAgY29uc3QgZW5kID0gc2VsZWN0aW9uLmVuZDtcbiAgICAgIGRhdGFQb2ludGVyKGRhdGEsIGVuZCk7XG4gICAgICAvLyBjb25zb2xlLmRlYnVnKCdTRUxFQ1RFRCcsIHN0YXJ0LCBlbmQsIGRhdGEpXG4gICAgICBpZighc2VsZWN0aW9uLmNvbGxhcHNlZCkge1xuICAgICAgICBjb25zdCBzdGFydCA9IHNlbGVjdGlvbi5zdGFydC5zcGFuLnRpbWU7XG4gICAgICAgIGNvbnN0IGVuZCA9IHNlbGVjdGlvbi5lbmQuc3Bhbi50aW1lICE9PSB1bmRlZmluZWQgPyAoc2VsZWN0aW9uLmVuZC5zcGFuLnRpbWUgKyBzZWxlY3Rpb24uZW5kLnNwYW4uZHVyYXRpb24gfHwgMCkgOiB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuJGVtaXQoJ3NlbGVjdGVkJywge3N0YXJ0LCBlbmR9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuJGVtaXQoJ3NlbGVjdGVkJyk7XG4gICAgICB9XG4gICAgICByZXR1cm47XG4gICAgfSxcblxuICAgIGdldFNwYW5TZWxlY3Rpb24oc2VsZWN0aW9uKSB7XG4gICAgICBjb25zdCBkYXRhID0gdGhpcy5wYXJhZ3JhcGhzO1xuICAgICAgc2VsZWN0aW9uID0gbm9ybWFsaXplZERPTVNlbGVjdGlvbihzZWxlY3Rpb24pO1xuICAgICAgZGF0YVBvaW50ZXIoZGF0YSwgc2VsZWN0aW9uLnN0YXJ0KTtcbiAgICAgIGRhdGFQb2ludGVyKGRhdGEsIHNlbGVjdGlvbi5lbmQpO1xuICAgICAgcmV0dXJuIEFycmF5LmZyb20oZGF0YUl0ZXJhdG9yKHRoaXMucGFyYWdyYXBocywgc2VsZWN0aW9uLnN0YXJ0LCBzZWxlY3Rpb24uZW5kKSk7XG4gICAgfSxcblxuICAgIHRvZ2dsZVN0eWxlWChuYW1lLCBub2ZvY3VzKSB7XG4gICAgICBjb25zdCBzZWxlY3Rpb24gPSBub3JtYWxpemVkRE9NU2VsZWN0aW9uKCk7XG4gICAgICBpZighc2VsZWN0aW9uLmNvbGxhcHNlZCkge1xuICAgICAgICBjb25zdCBkYXRhID0gdGhpcy5wYXJhZ3JhcGhzO1xuICAgICAgICBkYXRhU2VsZWN0aW9uVG9PZmZzZXRzKGRhdGEsIHNlbGVjdGlvbik7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCdCRUZPUkUgVE9HR0xFIEFGVEVSIE9GRlNFVFMnLCBmcmVlemUoc2VsZWN0aW9uKSlcbiAgICAgICAgdGhpcy50b2dnbGVTdHlsZShuYW1lLCBzZWxlY3Rpb24pO1xuICAgICAgICAvLyByZXNldCBET00gbm9kZXMgYXMgdGhleSBhcmUgbW9zdCBsaWtlbHkgZ29uZSBhZnRlciBkYXRhIG1vZGlmaWNhdGlvbnNcbiAgICAgICAgc2VsZWN0aW9uLnN0YXJ0Lm5vZGUgPSB1bmRlZmluZWQ7XG4gICAgICAgIHNlbGVjdGlvbi5lbmQubm9kZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgZGF0YVNlbGVjdGlvblJlc3RvcmVGcm9tT2Zmc2V0cyhkYXRhLCBzZWxlY3Rpb24pO1xuICAgICAgICAvLyBjb25zb2xlLmxvZygnQUZURVIgVE9HR0xFIEFGVEVSIFJFU1RPUkUgT0ZGU0VUUycsIGZyZWV6ZShzZWxlY3Rpb24pKVxuICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7XG4gICAgICAgICAgaWYoIW5vZm9jdXMpIHtcbiAgICAgICAgICAgIHRoaXMuJHJlZnMuY29udGFpbmVyLmZvY3VzKCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJlc3RvcmVET01TZWxlY3Rpb24odGhpcy4kcmVmcy5jb250YWluZXIsIHNlbGVjdGlvbi5zdGFydCwgc2VsZWN0aW9uLmVuZCk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICB0b2dnbGVTdHlsZShuYW1lLCBzZWxlY3Rpb24pIHtcblxuICAgICAgY29uc3QgZGF0YSA9IHRoaXMucGFyYWdyYXBocztcbiAgICAgIGlmKCFzZWxlY3Rpb24pIHtcbiAgICAgICAgc2VsZWN0aW9uID0gbm9ybWFsaXplZERPTVNlbGVjdGlvbigpO1xuICAgICAgfVxuICAgICAgaWYoc2VsZWN0aW9uLmlzQ29sbGFwc2VkKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHN0YXJ0ID0gc2VsZWN0aW9uLnN0YXJ0O1xuICAgICAgZGF0YVBvaW50ZXIoZGF0YSwgc3RhcnQpO1xuICAgICAgY29uc3QgZW5kID0gc2VsZWN0aW9uLmVuZDtcbiAgICAgIGRhdGFQb2ludGVyKGRhdGEsIGVuZCk7XG5cbiAgICAgIGNvbnN0IHIgPSBkYXRhU3BsaWNlKGRhdGEsIHN0YXJ0LCBlbmQsIFNwbGljZU1vZGUuSW5QbGFjZSk7XG5cbiAgICAgIC8vIGdldCBjdXJyZW50IHZhbHVlIGFjcm9zcyB0aGUgcmFuZ2UsIHJldmVydCB0byBmYWxzZSBpZiB0cnVlIGF0IHRoZSB3aG9sZSByYW5nZVxuICAgICAgbGV0IHZhbHVlID0gdHJ1ZTtcbiAgICAgIGZvcihjb25zdCBwIG9mIHIpIHtcbiAgICAgICAgZm9yKGNvbnN0IHNwYW4gb2YgcC5zcGFucykge1xuICAgICAgICAgIGlmKHNwYW4uZm9ybWF0ICYmIHNwYW4uZm9ybWF0W25hbWVdKSB7XG4gICAgICAgICAgICB2YWx1ZSA9IGZhbHNlO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICAvLyBvbmUgZGlzYWJsZXMgdGhlIG90aGVyXG4gICAgICBsZXQgbmFtZTIsIHZhbHVlMjtcbiAgICAgIGlmKG5hbWUgPT09ICdzdWJzY3JpcHQnKSB7XG4gICAgICAgIG5hbWUyID0gJ3N1cGVyc2NyaXB0JztcbiAgICAgICAgdmFsdWUyID0gZmFsc2U7XG4gICAgICB9IGVsc2UgaWYobmFtZSA9PT0gJ3N1cGVyc2NyaXB0Jykge1xuICAgICAgICBuYW1lMiA9ICdzdWJzY3JpcHQnO1xuICAgICAgICB2YWx1ZTIgPSBmYWxzZTtcbiAgICAgIH1cbiAgICAgIC8vIGFwcGx5IHRoZSBuZXcgc3R5bGVcbiAgICAgIGZvcihjb25zdCBwIG9mIHIpIHtcbiAgICAgICAgZm9yKGNvbnN0IHNwYW4gb2YgcC5zcGFucykge1xuICAgICAgICAgIE9iamVjdC5hc3NpZ24oc3BhbiwgeyBmb3JtYXQ6IE9iamVjdC5hc3NpZ24oc3Bhbi5mb3JtYXQgfHwge30sIHsgW25hbWVdOiB2YWx1ZSB9LCBuYW1lMiAmJiB7IFtuYW1lMl06IHZhbHVlMiB9IHx8IHt9KSwgaWQ6IG5ld0lEKCkgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuXG4gICAgdG9nZ2xlQnVsbGV0KCkge1xuICAgICAgY29uc3Qgc2VsZWN0aW9uID0gZG9jdW1lbnQuZ2V0U2VsZWN0aW9uKCk7XG4gICAgICBjb25zdCBzcGFuU2VsZWN0aW9uID0gdGhpcy5nZXRTcGFuU2VsZWN0aW9uKHNlbGVjdGlvbik7XG4gICAgICBsZXQgYnVsbGV0ID0gdHJ1ZTtcbiAgICAgIGZvcihjb25zdCBzIG9mIHNwYW5TZWxlY3Rpb24pIHtcbiAgICAgICAgaWYocy5wYXJhZ3JhcGguYnVsbGV0KSB7XG4gICAgICAgICAgYnVsbGV0ID0gZmFsc2U7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGZvcihjb25zdCBzIG9mIHNwYW5TZWxlY3Rpb24pIHtcbiAgICAgICAgcy5wYXJhZ3JhcGguYnVsbGV0ID0gYnVsbGV0O1xuICAgICAgfVxuICAgIH0sXG5cbiAgICBtYXBDb250YWluZXJPZmZzZXRQb2ludGVyVG9EYXRhKGRhdGEsIHBvaW50ZXIpIHtcbiAgICAgIC8vIG1hcCBvdXQgb2YgYm91bmQgb2Zmc2V0IHRvIGRhdGEsIHVzZXMgb2Zmc2V0IGdlbmVyYXRlZCBieSBwb2ludGVyVGV4dE9mZnNldEluQ29udGFpbmVyKClcbiAgICAgIC8vIGNvbnNvbGUuZGVidWcoJ01BUCcsIEpTT04uc3RyaW5naWZ5KGRhdGEsIHVuZGVmaW5lZCwgIDIpLCAnUE9JTlRFUicsIHBvaW50ZXIsICBKU09OLnN0cmluZ2lmeShwb2ludGVyLCB1bmRlZmluZWQsIDIpKVxuICAgICAgaWYoIXBvaW50ZXIucGFyYWdyYXBoSUQpIHtcbiAgICAgICAgLy8gc3RhcnQgZnJvbSBiZWdpbm5pbmcgLyBsZWZ0IHBhcmFncmFwaFxuICAgICAgICBsZXQgb2Zmc2V0ID0gMDtcbiAgICAgICAgZm9yKGNvbnN0IHBhcmFncmFwaCBvZiBkYXRhKSB7XG4gICAgICAgICAgLy8gY29uc29sZS5kZWJ1ZygncGFyYWdyYXBoJywgcGFyYWdyYXBoLCAnbGVmdCBwYXJhIGlkJywgcG9pbnRlci5sZWZ0UGFyYWdyYXBoSUQpXG4gICAgICAgICAgaWYocG9pbnRlci5sZWZ0UGFyYWdyYXBoSUQgJiYgcGFyYWdyYXBoLmlkID09PSBwb2ludGVyLmxlZnRQYXJhZ3JhcGhJRCkge1xuICAgICAgICAgICAgb2Zmc2V0ID0gMDtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBmb3IoY29uc3Qgc3BhbiBvZiBwYXJhZ3JhcGguc3BhbnMpIHtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUuZGVidWcoJ3NwYW4nLCBzcGFuLmlkLCAnb2Zmc2V0Jywgb2Zmc2V0LCAncG9pbnRlci5vZmZzZXQnLCBwb2ludGVyLm9mZnNldClcbiAgICAgICAgICAgIGlmKG9mZnNldCA8PSBwb2ludGVyLm9mZnNldCAmJiBwb2ludGVyLm9mZnNldCA8IG9mZnNldCArIHNwYW4udGV4dC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgcG9pbnRlci5wYXJhZ3JhcGhJRCA9IHBhcmFncmFwaC5pZDtcbiAgICAgICAgICAgICAgcG9pbnRlci5wYXJhZ3JhcGggPSBwYXJhZ3JhcGg7XG4gICAgICAgICAgICAgIHBvaW50ZXIuc3BhbklEID0gc3Bhbi5pZDtcbiAgICAgICAgICAgICAgcG9pbnRlci5zcGFuID0gc3BhbjtcbiAgICAgICAgICAgICAgcG9pbnRlci5vZmZzZXQgLT0gb2Zmc2V0O1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG9mZnNldCArPSBzcGFuLnRleHQubGVuZ3RoO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZihwb2ludGVyLm9mZnNldCA9PT0gb2Zmc2V0ICYmIHBhcmFncmFwaC5zcGFucy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBwb2ludGVyLnBhcmFncmFwaElEID0gcGFyYWdyYXBoLmlkO1xuICAgICAgICAgICAgY29uc3Qgc3BhbiA9IHBhcmFncmFwaC5zcGFuc1twYXJhZ3JhcGguc3BhbnMubGVuZ3RoLTFdXG4gICAgICAgICAgICBwb2ludGVyLnNwYW5JRCA9IHNwYW4uaWQ7XG4gICAgICAgICAgICBwb2ludGVyLnNwYW4gPSBzcGFuO1xuICAgICAgICAgICAgcG9pbnRlci5vZmZzZXQgPSBzcGFuLnRleHQubGVuZ3RoOztcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYocG9pbnRlci5wYXJhZ3JhcGhJRCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZihwb2ludGVyLnBhcmFncmFwaElEICYmICFwb2ludGVyLnNwYW5JRCkge1xuICAgICAgICAvLyBzdGFydCBmcm9tIHBhcmFncmFwaCAvIGxlZnQgc3BhblxuICAgICAgICAvLyBjb25zb2xlLmRlYnVnKCdnZXR0aW5nIHNwYW4gaWQnKVxuICAgICAgICBmb3IoY29uc3QgcGFyYWdyYXBoIG9mIGRhdGEpIHtcbiAgICAgICAgICAvLyBjb25zb2xlLmRlYnVnKCdwYXJhZ3JhcGggaWQnLCBwYXJhZ3JhcGguaWQsICdwb2ludGVyIHBhcmEgaWQnLCBwb2ludGVyLnBhcmFncmFwaElEKVxuICAgICAgICAgIGlmKHBhcmFncmFwaC5pZCAhPT0gcG9pbnRlci5wYXJhZ3JhcGhJRCkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8vIGNvbnNvbGUuZGVidWcoJ3BhcmFncmFwaCcsIHBhcmFncmFwaC5pZClcbiAgICAgICAgICBsZXQgb2Zmc2V0ID0gMDtcbiAgICAgICAgICBmb3IoY29uc3Qgc3BhbiBvZiBwYXJhZ3JhcGguc3BhbnMpIHtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUuZGVidWcoJ3NwYW4uaWQnLCBzcGFuLmlkLCBvZmZzZXQsIHNwYW4udGV4dC5sZW5ndGgsIHBvaW50ZXIub2Zmc2V0KVxuICAgICAgICAgICAgaWYocG9pbnRlci5sZWZ0U3BhbklEICYmIHNwYW4uaWQgPT09IHBvaW50ZXIubGVmdFNwYW5JRCkge1xuICAgICAgICAgICAgICBvZmZzZXQgPSAwO1xuICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmKG9mZnNldCA8PSBwb2ludGVyLm9mZnNldCAmJiBwb2ludGVyLm9mZnNldCA8IG9mZnNldCArIHNwYW4udGV4dC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgcG9pbnRlci5zcGFuSUQgPSBzcGFuLmlkO1xuICAgICAgICAgICAgICBwb2ludGVyLnNwYW4gPSBzcGFuO1xuICAgICAgICAgICAgICBwb2ludGVyLm9mZnNldCAtPSBvZmZzZXQ7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb2Zmc2V0ICs9IHNwYW4udGV4dC5sZW5ndGg7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmKHBvaW50ZXIub2Zmc2V0ID09PSBvZmZzZXQgJiYgcGFyYWdyYXBoLnNwYW5zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGNvbnN0IHNwYW4gPSBwYXJhZ3JhcGguc3BhbnNbcGFyYWdyYXBoLnNwYW5zLmxlbmd0aC0xXVxuICAgICAgICAgICAgcG9pbnRlci5zcGFuSUQgPSBzcGFuLmlkO1xuICAgICAgICAgICAgcG9pbnRlci5zcGFuID0gc3BhbjtcbiAgICAgICAgICAgIHBvaW50ZXIub2Zmc2V0ID0gc3Bhbi50ZXh0Lmxlbmd0aDs7XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBwb2ludGVyLm5vZGUgPSB1bmRlZmluZWQ7XG4gICAgICBkYXRhUG9pbnRlcihkYXRhLCBwb2ludGVyKTtcbiAgICAgIHJldHVybiBwb2ludGVyO1xuICAgIH0sXG5cbiAgICBwYXJzZURPTShyZXN0b3JlU2VsZWN0aW9uKSB7XG5cbiAgICAgIC8vIGNvbnNvbGUuZGVidWcoJ3BhcnNlRE9NIHRyYWNlOicsIEVycm9yKCdzdGFjayB0cmFjZSBpbmZvJykuc3RhY2spO1xuXG4gICAgICBsZXQgZGF0YSA9IHRoaXMucGFyYWdyYXBocztcblxuICAgICAgY29uc3Qgc2VsZWN0aW9uID0gbm9ybWFsaXplZERPTVNlbGVjdGlvbigpO1xuICAgICAgY29uc3Qgc3RhcnQgPSBkYXRhUG9pbnRlckZyb21ET01Qb2ludGVyKGRhdGEsIHNlbGVjdGlvbi5zdGFydCk7XG4gICAgICBjb25zdCBlbmQgPSBkYXRhUG9pbnRlckZyb21ET01Qb2ludGVyKGRhdGEsIHNlbGVjdGlvbi5lbmQpO1xuXG4gICAgICBpZighc3RhcnQuc3BhbklEIHx8ICFzdGFydC5wYXJhZ3JhcGhJRCkge1xuICAgICAgICBwb2ludGVyVGV4dE9mZnNldEluQ29udGFpbmVyKHRoaXMuJHJlZnMuY29udGFpbmVyLCBzdGFydCk7XG4gICAgICB9XG4gICAgICBpZighZW5kLnNwYW5JRCB8fCAhZW5kLnBhcmFncmFwaElEKSB7XG4gICAgICAgIHBvaW50ZXJUZXh0T2Zmc2V0SW5Db250YWluZXIodGhpcy4kcmVmcy5jb250YWluZXIsIGVuZCk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHBhcnNlZCA9IHBhcnNlRE9NKHRoaXMuJHJlZnMuY29udGFpbmVyKVxuXG4gICAgICAvLyBjb25zb2xlLmRlYnVnKCdET00nLCBKU09OLnN0cmluZ2lmeShwYXJzZWQsIHVuZGVmaW5lZCwgMikpXG4gICAgICAvLyBjb25zb2xlLmRlYnVnKCdEQVRBJywgSlNPTi5zdHJpbmdpZnkodGhpcy5wYXJhZ3JhcGhzLCB1bmRlZmluZWQsIDIpKTtcbiAgICAgIGNvbnN0IHBhcmFncmFwaHMgPSBkYXRhTWVyZ2VQYXJhZ3JhcGhzKHRoaXMucGFyYWdyYXBocyB8fCBbXSwgcGFyc2VkKTtcbiAgICAgIC8vIGNvbnNvbGUuZGVidWcoJ01FUkdFRCcsIEpTT04uc3RyaW5naWZ5KHBhcmFncmFwaHMsIHVuZGVmaW5lZCwgMikpO1xuICAgICAgdGhpcy5wYXJhZ3JhcGhzID0gcGFyYWdyYXBocztcbiAgICAgIGRhdGEgPSBwYXJhZ3JhcGhzO1xuXG4gICAgICAvLyByZS1tYXAgb3V0IG9mIGJvdW5kIG9mZnNldCB0byBkYXRhXG4gICAgICB0aGlzLm1hcENvbnRhaW5lck9mZnNldFBvaW50ZXJUb0RhdGEoZGF0YSwgc3RhcnQpO1xuICAgICAgdGhpcy5tYXBDb250YWluZXJPZmZzZXRQb2ludGVyVG9EYXRhKGRhdGEsIGVuZCk7XG5cbiAgICAgIGlmKHJlc3RvcmVTZWxlY3Rpb24pIHtcbiAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4ge1xuICAgICAgICAgIC8vIGNvbnNvbGUuZGVidWcoJ1JFU1RPUkUgREFUQScsIGRhdGEsIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoZGF0YSkpKVxuICAgICAgICAgIC8vIGNvbnNvbGUuZGVidWcoJ1JFU1RPUkUgU1RBUlQnLCBkYXRhUG9pbnRlcihkYXRhLCBzdGFydCksICdSRVNUT1JFIEVORCcgLCBzZWxlY3Rpb24uY29sbGFwc2VkID8gbnVsbCA6IGRhdGFQb2ludGVyKGRhdGEsIGVuZCksICdDT0xMQVBTRUQnLCBzZWxlY3Rpb24uY29sbGFwc2VkKTtcbiAgICAgICAgICByZXN0b3JlRE9NU2VsZWN0aW9uKHRoaXMuJHJlZnMuY29udGFpbmVyLCBkYXRhUG9pbnRlcihkYXRhLCBzdGFydCksIHNlbGVjdGlvbi5jb2xsYXBzZWQgPyBudWxsIDogZGF0YVBvaW50ZXIoZGF0YSwgZW5kKSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBwb2ludGVyIGlzIHBvaW50aW5nIHRvIGRhdGE7IHRvIGdldCBmdWxsIERPTSBwb2ludGVyLCBhdWdtZW50IGFmdGVyIG5leHQgRE9NIHVwZGF0ZVxuICAgICAgcmV0dXJuIHsgcGFyYWdyYXBocywgc3RhcnQsIGVuZCwgY29sbGFwc2VkOiBzZWxlY3Rpb24uY29sbGFwc2VkIH07XG4gICAgfSxcblxuICAgIGFwcGx5Vmlld0NoYW5nZXNOb3cocmVzdG9yZVNlbGVjdGlvbiA9IHRydWUpIHtcblxuICAgICAgY29uc3QgeyBwYXJhZ3JhcGhzLCBzdGFydCwgZW5kLCBjb2xsYXBzZWQgfSA9IHRoaXMucGFyc2VET00ocmVzdG9yZVNlbGVjdGlvbik7ICAvLyBET00gLT4gZGF0YSwgcG9pbnRlciBpbiBkYXRhXG5cbiAgICAgIC8vIGNvbnNvbGUuZGVidWcoJ2RlYm91bmNlZCcsIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5wYXJhZ3JhcGhzKSkpO1xuICAgICAgdGhpcy5zYXZlKCk7XG5cbiAgICAgIHJldHVybiB7IHN0YXJ0LCBlbmQsIGNvbGxhcHNlZCB9O1xuICAgIH0sXG5cbiAgICBvbklucHV0KGUpIHtcbiAgICAgIC8vIGNvbnNvbGUuZGVidWcoJ29uIGlucHV0Jyk7XG4gICAgICB0aGlzLmFwcGx5Vmlld0NoYW5nZXMoKTtcbiAgICB9LFxuXG4gICAgLy8gb25LZXlwcmVzcyhlKSB7XG4gICAgLy8gICBjb25zb2xlLmRlYnVnKCdlZGl0YWJsZS1zcGFucyBrZXlwcmVzczonLCBlKTtcbiAgICAvLyAgIGlmKGUua2V5ID09ICdFbnRlcicpIHtcbiAgICAvLyAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIC8vICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgIC8vXG4gICAgLy8gICAgIGNvbnN0IHNlbGVjdGlvbiA9IGRvY3VtZW50LmdldFNlbGVjdGlvbigpO1xuICAgIC8vICAgICBjb25zdCByYW5nZSA9IHNlbGVjdGlvbi5nZXRSYW5nZUF0KDApO1xuICAgIC8vXG4gICAgLy8gICAgIC8vIGNvbnN0IGdldE5vZGVJbmRleCA9IChub2RlKSA9PiB7IGZvcih2YXIgaT0wOyAobm9kZT1ub2RlLnByZXZpb3VzU2libGluZyk7IGkrKyk7IHJldHVybiBpOyB9OyAgLy8gaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xLzU5MTM5MjdcbiAgICAvL1xuICAgIC8vICAgICByYW5nZS5pbnNlcnROb2RlKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2JyJykpOyAvLyBpbnNlcnQgPGJyLz4gZWxlbWVudFxuICAgIC8vICAgICByYW5nZS5jb2xsYXBzZSgpOyAvLyB3aXRob3V0IHRoaXMgdGhlIG5ld2xpbmUgd2lsbCByZW1haW4gc2VsZWN0ZWQgYW5kIG5ldyB0ZXh0IGlucHV0IHdpbGwgcmVwbGFjZSB0aGUgbmV3bGluZVxuICAgIC8vXG4gICAgLy8gICAgIC8vIFNhZmFyaSByZXF1aXJlcyB0aGF0IHJhbmdlIG11c3QgYmUgcmUtYWRkZWRcbiAgICAvLyAgICAgc2VsZWN0aW9uLnJlbW92ZUFsbFJhbmdlcygpO1xuICAgIC8vICAgICBzZWxlY3Rpb24uYWRkUmFuZ2UocmFuZ2UpO1xuICAgIC8vXG4gICAgLy8gICAgIC8vIHRoaXMub25JbnB1dChlKTsgLy8gdG8gcmVnaXN0ZXIgY2hhbmdlcywgYnV0IGl0IGFwcGVhcnMgdGhhdCB0aGlzIHdpbGwgYmUgY2FsbGVkIGFueXdheSBieSB0aGUgYnJvd3NlclxuICAgIC8vICAgICAvLyB0aGlzLmlucHV0KCk7XG4gICAgLy8gICB9IGVsc2UgaWYoIWUuY3RybEtleSAmJiAhZS5hbHRLZXkgJiYgIWUubWV0YUtleSBbIyYmICFlLnNoaWZ0S2V5I10pIHtcbiAgICAvLyAgIH1cbiAgICAvLyAgIC8vIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzE3ODkwNTY4L2NvbnRlbnRlZGl0YWJsZS1kaXYtYmFja3NwYWNlLWFuZC1kZWxldGluZy10ZXh0LW5vZGUtcHJvYmxlbXNcbiAgICAvLyB9LFxuXG4gICAgZXJyb3JDYXB0dXJlZChlcnIsIHZtLCBpbmZvKSB7XG4gICAgICBjb25zb2xlLmRlYnVnKCdFUlJPUiBjYXB0dXJlZDonLCBlcnIsIHZtLCBpbmZvKTtcbiAgICB9LFxuXG4gICAgYXN5bmMgb25LZXlkb3duKGUpIHtcbiAgICAgIC8vIGNvbnNvbGUuZGVidWcoJ2VkaXRhYmxlLXNwYW5zIGtleWRvd246JywgZSk7XG4gICAgICBpZigoZS5tZXRhS2V5IHx8IGUuY3RybEtleSkgJiYgZS5zaGlmdEtleSAmJiBlLmFsdEtleSAmJiAoZS5jb2RlID09PSAnS2V5UicpKSB7XG4gICAgICAgIHRoaXMucmVzZXQoKTtcbiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZigoZS5tZXRhS2V5IHx8IGUuY3RybEtleSkgJiYgKGUuY29kZSA9PT0gJ0tleVonKSkge1xuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmKChlLm1ldGFLZXkgfHwgZS5jdHJsS2V5KSAmJiAoZS5jb2RlID09PSAnS2V5QycgfHwgZS5jb2RlID09PSAnS2V5VicgfHwgZS5jb2RlID09PSAnS2V5WCcgfHwgZS5jb2RlID09PSAnS2V5UicgfHwgZS5rZXkgPT09ICdNZXRhJyB8fCBlLmtleSA9PT0gJ0NvbnRyb2wnKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIGlnbm9yZSBjb250cm9sIGNoYXJzXG4gICAgICBpZiAoZS5jb2RlID09PSAnRXNjYXBlJyB8fCBlLmNvZGUgPT09ICdUYWInKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gZG8gbm90IHByb2Nlc3Mgc2VsZWN0IGFjdGlvbiBrZXlzdHJva2VzXG4gICAgICBpZigvKiBlLnNoaWZ0S2V5ICYmICovIChlLmtleSA9PT0gJ0Fycm93TGVmdCcgfHwgZS5rZXkgPT09ICdBcnJvd1JpZ2h0JyB8fCBlLmtleSA9PT0gJ0Fycm93VXAnIHx8IGUua2V5ID09PSAnQXJyb3dEb3duJykpIHtcbiAgICAgICAgaWYoIWUuc2hpZnRLZXkpIHtcbiAgICAgICAgICAvLyBUT0RPOiBwb3RlbnRpb25hbGx5IGNvcnJlY3QgY3Vyc29yIHBvc2l0aW9uIGluIHNvbWUgY2FzZXMgKHNlZSBjb2RlIGZyYWdtZW50cyBiZWxvdylcbiAgICAgICAgfVxuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIGUua2V5ID09PSAnRGVhZCcgLy8gY29kZSA9PT0gJ1F1b3RlJ1xuICAgICAgaWYoZS5rZXkgPT09ICdEZWFkJykge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGxldCBzZWxlY3Rpb24gPSBkb2N1bWVudC5nZXRTZWxlY3Rpb24oKTtcbiAgICAgIGlmKCFzZWxlY3Rpb24uaXNDb2xsYXBzZWQgJiYgIWUuY3RybEtleSAmJiAhZS5tZXRhS2V5ICYmIGUua2V5ICE9ICdBbHQnICYmIGUua2V5ICE9ICdTaGlmdCcpIHtcbiAgICAgICAgLy8gVE9ETzogYmVjYXVzZSB0aGVyZSBpcyBubyB3YXkgdG8gc2VuZCBrZXlib2FyZCBldmVudHMgdG8gdGhlIGJyb3dzZXIgZnJvbSBqYXZhc2NyaXB0OlxuICAgICAgICAvLyBhKSB0aGUgY3VycmVudCBrZXlib2FyZCBldmVudCAodGhhdCByZW1vdmVzIGN1cnJlbnQgc2VsZWN0aW9uIGZpcnN0KSBtdXN0IGJlIHByb2Nlc3NlZFxuICAgICAgICAvLyBiKSB0aGUgY3VycmVudCBrZXlib2FyZCBldmVudCBtdXN0IGJlIHBhc3NlZCB0aHJvdWdoIGZvciBzZWxlY3RlZCBrZXlzdHJva2VzIChlLmcuIHVzdWFsIHRleHQgaW5wdXQpXG4gICAgICAgIC8vICAgIGFmdGVyIHRoZSBkYXRhIHNwbGljZSBvcGVyYXRpb24gYmVsb3dcbiAgICAgICAgaWYoZS5rZXkgPT09ICdEZWxldGUnIHx8IGUua2V5ID09PSAnQmFja3NwYWNlJyB8fCBlLmtleSA9PT0gJ0VudGVyJykge1xuICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLnBhcmFncmFwaHM7XG4gICAgICAgIHNlbGVjdGlvbiA9IG5vcm1hbGl6ZWRET01TZWxlY3Rpb24oc2VsZWN0aW9uKTtcbiAgICAgICAgY29uc3Qgc3RhcnQgPSBzZWxlY3Rpb24uc3RhcnQ7XG4gICAgICAgIGRhdGFQb2ludGVyKGRhdGEsIHN0YXJ0KTtcbiAgICAgICAgY29uc3QgZW5kID0gc2VsZWN0aW9uLmVuZDtcbiAgICAgICAgZGF0YVBvaW50ZXIoZGF0YSwgZW5kKTtcbiAgICAgICAgLy8gZm9yIGZ1bGwgbGluZSBzZWxlY3Q6IHNuYXAgdGhlIGVuZCBwb3NpdGlvbiB0byB0aGUgYmVnaW5uaW5nIG9mIHRoZSBmaXJzdCBzcGFuIG9mIHRoZSBuZXh0IHBhcmFncmFwaFxuICAgICAgICBpZihlbmQucGFyYWdyYXBoSUQgJiYgZW5kLnBhcmFncmFwaElELmxlbmd0aCA+IDAgJiYgZW5kLnNwYW5JRCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgaWYoZGF0YVtlbmQucGFyYWdyYXBoSW5kZXhdLnNwYW5zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGVuZC5zcGFuSW5kZXggPSAwO1xuICAgICAgICAgICAgZW5kLm9mZnNldCA9IDA7XG4gICAgICAgICAgICBkYXRhUG9pbnRlcihkYXRhLCBlbmQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb25zdCByID0gZGF0YVNwbGljZShkYXRhLCBzdGFydCwgZW5kKTtcbiAgICAgICAgLy8gY29uc29sZS5kZWJ1ZygnREVMRVRFRCcsIHIpXG5cbiAgICAgICAgaWYoZS5rZXkgPT09ICdFbnRlcicpIHtcbiAgICAgICAgICBjb25zdCByID0gZGF0YUluc2VydChkYXRhLCBzdGFydCwgW25ld1BhcmFncmFwaCgpLCBuZXdQYXJhZ3JhcGgoKV0pO1xuICAgICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHtcbiAgICAgICAgICAgIHJlc3RvcmVET01TZWxlY3Rpb24odGhpcy4kcmVmcy5jb250YWluZXIsIGRhdGFQb2ludGVyRE9NTm9kZShkYXRhUG9pbnRlck5leHQoZGF0YSwgc3RhcnQpLCB0aGlzLiRyZWZzLmNvbnRhaW5lcikpO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICAvLyBUT0RPOiBkbyB3ZSBuZWVkIHRoaXM/XG4gICAgICAgIC8vIGlmKHN0YXJ0LnBhcmFncmFwaC5zcGFucy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgLy8gICBzdGFydC5wYXJhZ3JhcGguc3BhbnMuc3BsaWNlKDAsIDAsIG5ld1NwYW4oKSk7XG4gICAgICAgIC8vIH1cbiAgICAgICAgLy8gaWYoZW5kLnBhcmFncmFwaC5zcGFucy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgLy8gICBlbmQucGFyYWdyYXBoLnNwYW5zLnNwbGljZSgwLCAwLCBuZXdTcGFuKCkpO1xuICAgICAgICAvLyB9XG4gICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHtcbiAgICAgICAgICBzdGFydC5zcGFuSUQgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgc3RhcnQubm9kZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICByZXN0b3JlRE9NU2VsZWN0aW9uKHRoaXMuJHJlZnMuY29udGFpbmVyLCBkYXRhUG9pbnRlcihkYXRhLCBzdGFydCkpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy83MjA3MjkxL2lzLWl0LXBvc3NpYmxlLXRvLWRpc2FibGUtb3ItY29udHJvbC1jb21tYW5kcy1pbi1jb250ZW50ZWRpdGFibGUtZWxlbWVudHNcbiAgICAgIGlmKGUuY29kZSA9PT0gJ0tleUwnICYmIChlLm1ldGFLZXkgPT09IHRydWUgfHwgZS5jdHJsS2V5ID09PSB0cnVlKSkge1xuICAgICAgICAvLyBsaXN0XG4gICAgICAgIHRoaXMudG9nZ2xlQnVsbGV0KCk7XG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfSBlbHNlIGlmKChlLmNvZGUgPT09ICdLZXlMJ1xuICAgICAgICB8fCBlLmNvZGUgPT09ICdLZXlCJ1xuICAgICAgICB8fCBlLmNvZGUgPT09ICdLZXlJJ1xuICAgICAgICB8fCBlLmNvZGUgPT09ICdLZXlVJ1xuICAgICAgICB8fCAoZS5jb2RlID09PSAnRGlnaXQ2JyAmJiBlLnNoaWZ0S2V5ID09PSB0cnVlKVxuICAgICAgICB8fCAoZS5jb2RlID09PSAnTWludXMnICYmIGUuc2hpZnRLZXkgPT09IHRydWUpKSAmJiAoZS5jdHJsS2V5ID09PSB0cnVlIHx8IGUubWV0YUtleSA9PT0gdHJ1ZSkpIHtcblxuICAgICAgICBsZXQgc3R5bGU7XG4gICAgICAgIGlmKGUuY29kZSA9PT0gJ0tleUInKSB7XG4gICAgICAgICAgc3R5bGUgPSAnYm9sZCc7XG4gICAgICAgIH0gZWxzZSBpZihlLmNvZGUgPT09ICdLZXlJJykge1xuICAgICAgICAgIHN0eWxlID0gJ2l0YWxpYyc7XG4gICAgICAgIH0gZWxzZSBpZihlLmNvZGUgPT09ICdLZXlVJykge1xuICAgICAgICAgIHN0eWxlID0gJ3VuZGVybGluZSc7XG4gICAgICAgIH0gZWxzZSBpZihlLmNvZGUgPT09ICdEaWdpdDYnKSB7XG4gICAgICAgICAgc3R5bGUgPSAnc3VwZXJzY3JpcHQnO1xuICAgICAgICB9IGVsc2UgaWYoZS5jb2RlID09PSAnTWludXMnKSB7XG4gICAgICAgICAgc3R5bGUgPSAnc3Vic2NyaXB0JztcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMudG9nZ2xlU3R5bGVYKHN0eWxlLCB0cnVlKTtcblxuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcblxuICAgICAgfSBlbHNlIGlmKGUua2V5ID09PSAnRW50ZXInKSB7XG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICB0aGlzLmFwcGx5Vmlld0NoYW5nZXNOb3coKTtcblxuICAgICAgICBpZighdGhpcy5wYXJhZ3JhcGhzKSB7XG4gICAgICAgICAgdGhpcy5wYXJhZ3JhcGhzID0gW25ld1BhcmFncmFwaCgpLCBuZXdQYXJhZ3JhcGgoKV07XG4gICAgICAgICAgdGhpcy5hcHBseVZpZXdDaGFuZ2VzTm93KGZhbHNlKTtcbiAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7XG4gICAgICAgICAgICByZXN0b3JlRE9NU2VsZWN0aW9uKHRoaXMuJHJlZnMuY29udGFpbmVyLCBkYXRhUG9pbnRlckRPTU5vZGUoZGF0YVBvaW50ZXIodGhpcy5wYXJhZ3JhcGhzLCB7IHBhcmFncmFwaEluZGV4OiAxLCBvZmZzZXQ6IDAgfSksIHRoaXMuJHJlZnMuY29udGFpbmVyKSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4ge1xuXG4gICAgICAgICAgY29uc3QgZGF0YSA9IHRoaXMucGFyYWdyYXBocztcblxuICAgICAgICAgIGNvbnN0IHNlbGVjdGlvbiA9IG5vcm1hbGl6ZWRET01TZWxlY3Rpb24oKTtcblxuICAgICAgICAgIGlmKHNlbGVjdGlvbi5jb2xsYXBzZWQpIHtcbiAgICAgICAgICAgIGRhdGFQb2ludGVyKGRhdGEsIHNlbGVjdGlvbi5zdGFydCk7XG4gICAgICAgICAgICAvLyBkYXRhUG9pbnRlcihkYXRhLCBzZWxlY3Rpb24uZW5kKTtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUuZGVidWcoc2VsZWN0aW9uKTtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUuZGVidWcoJ0VOVEVSIFNFTCcsIEpTT04uc3RyaW5naWZ5KHNlbGVjdGlvbi5zdGFydCwgdW5kZWZpbmVkLCAyKSk7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmRlYnVnKCdFTlRFUiBEQVRBIEJFRk9SRScsIEpTT04uc3RyaW5naWZ5KGRhdGEsIHVuZGVmaW5lZCwgMikpO1xuICAgICAgICAgICAgY29uc3QgciA9IGRhdGFJbnNlcnQoZGF0YSwgc2VsZWN0aW9uLnN0YXJ0LCBbbmV3UGFyYWdyYXBoKCksIG5ld1BhcmFncmFwaCgpXSk7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmRlYnVnKCdFTlRFUiBEQVRBIEFGVEVSJywgSlNPTi5zdHJpbmdpZnkoZGF0YSwgdW5kZWZpbmVkLCAyKSk7XG4gICAgICAgICAgICAvLyBpZihzZWxlY3Rpb24uc3RhcnQuc3BhbkluZGV4ID09PSAwKSB7XG4gICAgICAgICAgICAvLyAgIGNvbnN0IHIgPSBkYXRhSW5zZXJ0KGRhdGEsIHNlbGVjdGlvbi5zdGFydCwgW25ld1BhcmFncmFwaCgxKSwgbmV3UGFyYWdyYXBoKCldKTtcbiAgICAgICAgICAgIC8vIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyAgIGNvbnN0IHIgPSBkYXRhSW5zZXJ0KGRhdGEsIHNlbGVjdGlvbi5zdGFydCwgW25ld1BhcmFncmFwaCgpLCBuZXdQYXJhZ3JhcGgoMSldKTtcbiAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgIC8vIGNvbnNvbGUuZGVidWcoJ0VOVEVSJywgZGF0YSlcbiAgICAgICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgcmVzdG9yZURPTVNlbGVjdGlvbih0aGlzLiRyZWZzLmNvbnRhaW5lciwgZGF0YVBvaW50ZXJET01Ob2RlKGRhdGFQb2ludGVyTmV4dChkYXRhLCBzZWxlY3Rpb24uc3RhcnQpLCB0aGlzLiRyZWZzLmNvbnRhaW5lcikpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgIH0pO1xuXG4gICAgICB9IGVsc2UgaWYoZS5rZXkgPT09ICdCYWNrc3BhY2UnKSB7XG5cbiAgICAgICAgY29uc3QgeyBzdGFydCwgZW5kLCBjb2xsYXBzZWQgfSA9IHRoaXMuYXBwbHlWaWV3Q2hhbmdlc05vdygpO1xuXG4gICAgICAgIGlmKCFjb2xsYXBzZWQpIHtcbiAgICAgICAgICBjb25zb2xlLmRlYnVnKCd3YXJuaW5nOiByYW5nZSBiYWNrc3BhY2UgaGFkIHRvIGJlIGhhbmRsZXIgZWxzZXdoZXJlJyk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYoc3RhcnQub2Zmc2V0ID4gMCB8fCBzdGFydC5zcGFuSW5kZXggPiAwKSB7XG4gICAgICAgICAgcmV0dXJuOyAvLyByZXN1bWUgd2l0aCBub3JtYWwgYmFja3NwYWNlIG9wZXJhdGlvblxuICAgICAgICB9XG5cbiAgICAgICAgLy8gTk9URTogYXR0cnMuZmlyc3QgPT09ICd0cnVlJyBjb3VsZCBub3Qga2VlcCB1cCB0byB0aGUgdGFzaywgaS5lLiwgYXQgdGhhdCBwb2ludCB0aGUgc3BhbiBtaWdodCBiZSBhbHJlYWR5IGdvbmVcblxuICAgICAgICAvLyBiZWNhdXNlIG9mIGRlYm91bmNlIGFwcGx5Vmlld0NoYW5nZXMgd2lsbCBub3Qga2VlcCB1cCB0byB0aGUgdGFzaywgcHJldmVudCBkZWxldGluZyBwYXJhZ3JhcGggRE9NIHRhZ3MgYnkgdGhlIGJyb3dzZXIgYXV0b21hdGljYWxseVxuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4ge1xuXG4gICAgICAgICAgLy8gYXNzdW1lXG5cbiAgICAgICAgICBjb25zdCBkYXRhID0gdGhpcy5wYXJhZ3JhcGhzO1xuICAgICAgICAgIGNvbnN0IHBhcmFncmFwaHMgPSB0aGlzLnBhcmFncmFwaHM7XG5cbiAgICAgICAgICBjb25zdCBzZWxlY3Rpb24gPSBub3JtYWxpemVkRE9NU2VsZWN0aW9uKCk7XG5cbiAgICAgICAgICBjb25zdCBzdGFydCA9IHNlbGVjdGlvbi5zdGFydDtcblxuICAgICAgICAgIGNvbnN0IG9iaiA9IChvKSA9PiBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KG8pKTtcblxuICAgICAgICAgIC8vIGNvbnRpbnVlIGRlbGV0aW5nIHBhcmFncmFwaC4uLlxuXG4gICAgICAgICAgZGF0YVBvaW50ZXIoZGF0YSwgc3RhcnQpOyAvLyB2ZXJpZnkgYnkgYWxpZ25pbmcgd2l0aCBkYXRhIG1vZGVsXG5cbiAgICAgICAgICAvLyBzdGFydCBtYXkgbm90IHBvaW50IHRvIHRoZSBiZWdpbm5pbmcgb2YgcGFyYWdyYXBoLCBldmVuIGlmIHRoZSBjdXJzb3IgdHJ1bHkgaXMsIHNvIGNvbnN0cnVjdFxuICAgICAgICAgIGNvbnN0IHN0YXJ0T2ZQYXJhZ3JhcGggPSBkYXRhUG9pbnRlcihkYXRhLCB7IHBhcmFncmFwaEluZGV4OiBzdGFydC5wYXJhZ3JhcGhJbmRleCwgc3BhbkluZGV4OiAwLCBvZmZzZXQ6IDAgfSk7XG5cbiAgICAgICAgICBpZihzdGFydC5wYXJhZ3JhcGhJbmRleCA+IDAgLyomJiBzdGFydC5zcGFuSW5kZXggPT09IDAgJiYgc3RhcnQub2Zmc2V0ID09PSAwKi8pIHtcblxuICAgICAgICAgICAgY29uc3QgZGF0YSA9IHRoaXMucGFyYWdyYXBocztcblxuICAgICAgICAgICAgLy8gd2UgYXJlIGF0IHRoZSBiZWdpbm5pbmcgb2YgcGFyYWdyYXBoLCBkZWxldGUgaXQgYnkgam9pbmluZyB0aGUgcmVzdCBvZiBpdCB3aXRoIHRoZSBwcmV2aW91cyBwYXJhZ3JhcGhcblxuICAgICAgICAgICAgY29uc3QgcHAgPSBkYXRhUG9pbnRlclByZXYoZGF0YSwgc3RhcnRPZlBhcmFncmFwaCk7ICAvLyBwcmV2aW91cyBwb3NpdGlvbiAobWlnaHQgbm90IGNvbnRhaW4gYSByZWFsIHNwYW4pXG4gICAgICAgICAgICAvLyBjb25zb2xlLmRlYnVnKCdiZWZvcmUgc3BsaWNlJywgJ3N0YXJ0IG9mIHBhcmEnLCBzdGFydE9mUGFyYWdyYXBoLCAnc3RhcnQnLCBzdGFydCwgJy0tPicsIHBwKVxuICAgICAgICAgICAgY29uc3QgciA9IGRhdGFTcGxpY2UoZGF0YSwgcHAsIHN0YXJ0KTtcbiAgICAgICAgICAgIC8vIGlmKHBwLnBhcmFncmFwaC5zcGFucy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIC8vICAgcHAucGFyYWdyYXBoLnNwYW5zLnNwbGljZSgwLCAwLCBuZXdTcGFuKCkpO1xuICAgICAgICAgICAgLy8gfVxuICAgICAgICAgICAgLy8gY29uc29sZS5kZWJ1ZyhKU09OLnN0cmluZ2lmeShyLCB1bmRlZmluZWQsIDIpKTtcblxuICAgICAgICAgICAgY29uc3QgYyA9IHIubGVuZ3RoID4gMCAmJiByWzBdLmlkID09PSBwcC5wYXJhZ3JhcGhJRCA/IHN0YXJ0IDogcHA7XG5cbiAgICAgICAgICAgIC8vIGF0IG5leHQgRE9NIHVwZGF0ZSAoYXQgdGhpcyBwb2ludCBvbmx5IHRoZSBkYXRhIG1vZGVsIGhhcyBjaGFuZ2VzLCB0aGUgRE9NIGNvbnRhaW5zIG9sZCBjb250ZW50KSwgc2V0IGN1cnNvciB0byB0aGUgY29ycmVjdCBwb3NpdGlvblxuICAgICAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAvLyBoYXZlIHRvIHJlc2V0IHRoZXNlXG4gICAgICAgICAgICAgIC8vIGMuc3BhbklEID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICBjLm5vZGUgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgIC8vIHBwLnNwYW5JbmRleCA9IDA7XG4gICAgICAgICAgICAgIC8vIHBwLm9mZnNldCA9IDA7XG4gICAgICAgICAgICAgIC8vIHB1dCB0ZXh0IGN1cnNvciBhdCB0aGUgZXhwZWN0ZWQgcG9zaXRpb25cbiAgICAgICAgICAgICAgLy8gZGF0YVBvaW50ZXIoZGF0YSwgcHApO1xuICAgICAgICAgICAgICAvLyBjb25zb2xlLmRlYnVnKCdEQVRBJywgSlNPTi5zdHJpbmdpZnkoZGF0YSwgdW5kZWZpbmVkLCAyKSk7XG4gICAgICAgICAgICAgIC8vIGNvbnNvbGUuZGVidWcoJ3Jlc3RvcmluZycsIEpTT04uc3RyaW5naWZ5KHBwLCB1bmRlZmluZWQsIDIpKTtcbiAgICAgICAgICAgICAgLy8gY29uc29sZS5kZWJ1ZygncmVzdG9yaW5nJywgYyk7XG4gICAgICAgICAgICAgIHJlc3RvcmVET01TZWxlY3Rpb24odGhpcy4kcmVmcy5jb250YWluZXIsIGMpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgfSBlbHNlIGlmKGUua2V5ID09PSAnRGVsZXRlJykge1xuXG4gICAgICAgIGNvbnN0IHsgc3RhcnQsIGVuZCwgY29sbGFwc2VkIH0gPSB0aGlzLmFwcGx5Vmlld0NoYW5nZXNOb3coKTtcblxuICAgICAgICBpZighY29sbGFwc2VkKSB7XG4gICAgICAgICAgY29uc29sZS5kZWJ1Zygnd2FybmluZzogcmFuZ2UgZGVsZXRlcyBtdXN0IGJlIGhhbmRsZWQgZWxzZXdoZXJlJyk7XG4gICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gY29uc29sZS5kZWJ1ZygnREVMRVRFIEtFWScsIHN0YXJ0LCBlbmQpXG5cbiAgICAgICAgaWYoIXN0YXJ0IHx8IHN0YXJ0LnNwYW5JbmRleCA8IHN0YXJ0LnBhcmFncmFwaC5zcGFucy5sZW5ndGggLSAxIHx8IHN0YXJ0LnNwYW4gJiYgc3RhcnQub2Zmc2V0IDwgc3RhcnQuc3Bhbi50ZXh0Lmxlbmd0aFxuICAgICAgICAgIC8qIHx8IHN0YXJ0LnBhcmFncmFwaC5zcGFucy5sZW5ndGggPiAwICovKSB7XG4gICAgICAgICAgLy8gbm90IGVuZCBvZiBwYXJhZ3JhcGggcG9zaXRpb25cbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4ge1xuXG4gICAgICAgICAgY29uc3QgZGF0YSA9IHRoaXMucGFyYWdyYXBocztcbiAgICAgICAgICBjb25zdCBwYXJhZ3JhcGhzID0gdGhpcy5wYXJhZ3JhcGhzO1xuXG4gICAgICAgICAgLy8gY29uc3Qgc2VsZWN0aW9uID0gbm9ybWFsaXplZERPTVNlbGVjdGlvbigpO1xuXG4gICAgICAgICAgaWYoY29sbGFwc2VkKSB7XG5cbiAgICAgICAgICAgIC8vIGRhdGFQb2ludGVyKGRhdGEsIHN0YXJ0KTtcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0UGFyYWdyYXBoU3BhbnMgPSBwYXJhZ3JhcGhzW3N0YXJ0LnBhcmFncmFwaEluZGV4XS5zcGFucztcbiAgICAgICAgICAgIGNvbnN0IGVuZE9mUGFyYWdyYXBoID0gZGF0YVBvaW50ZXIoZGF0YSwgeyBwYXJhZ3JhcGhJbmRleDogc3RhcnQucGFyYWdyYXBoSW5kZXgsIHNwYW5JbmRleDogc3RhcnRQYXJhZ3JhcGhTcGFucy5sZW5ndGgtMSwgb2Zmc2V0OiAtMSB9KVxuICAgICAgICAgICAgLy8gY29uc29sZS5kZWJ1ZygnREVMRVRFJywgc3RhcnQsIHN0YXJ0UGFyYWdyYXBoU3BhbnMsIHN0YXJ0UGFyYWdyYXBoU3BhbnNbc3RhcnQuc3BhbkluZGV4XSlcblxuICAgICAgICAgICAgaWYoc3RhcnQucGFyYWdyYXBoSW5kZXggPCBwYXJhZ3JhcGhzLmxlbmd0aCAtIDEgLyomJiBzdGFydC5zcGFuSW5kZXggPT09IHN0YXJ0UGFyYWdyYXBoU3BhbnMubGVuZ3RoIC0gMSAmJiBzdGFydC5vZmZzZXQgPj0gc3RhcnRQYXJhZ3JhcGhTcGFuc1tzdGFydC5zcGFuSW5kZXhdLnRleHQudHJpbUVuZCgpLmxlbmd0aCovKSB7XG5cbiAgICAgICAgICAgICAgLy8gd2UgYXJlIGF0IHRoZSBlbmQgb2YgdGhlIGN1cnJlbnQgcGFyYWdyYXBoLCBkZWxldGUgbmV4dCBwYXJhZ3JhcGggaXQgYnkgam9pbmluZyBpdCB0byB0aGUgY3VycmVudCBwYXJhZ3JhcGhcblxuICAgICAgICAgICAgICBjb25zdCBkYXRhID0gdGhpcy5wYXJhZ3JhcGhzO1xuXG4gICAgICAgICAgICAgIGlmKHN0YXJ0LnBhcmFncmFwaC5zcGFucy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAvLyByZW1vdmUgY3VycmVudCBlbXB0eSBwYXJhZ3JhcGggb25seVxuICAgICAgICAgICAgICAgIGRhdGEuc3BsaWNlKHN0YXJ0LnBhcmFncmFwaEluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICBzdGFydC5zcGFuSW5kZXggPSAwO1xuICAgICAgICAgICAgICAgIHN0YXJ0LnBhcmFncmFwaElEID0gMDtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAvLyBkYXRhU3BsaWNlKGRhdGEsIHN0YXJ0LCBkYXRhUG9pbnRlcihkYXRhLCBkYXRhUG9pbnRlcihkYXRhLCB7IHBhcmFncmFwaEluZGV4OiBzdGFydC5wYXJhZ3JhcGhJbmRleCArIDEsIHNwYW5JbmRleDogMCwgb2Zmc2V0OiAwIH0pKSk7XG4gICAgICAgICAgICAgIC8vIGNvbnNvbGUuZGVidWcoJ3N0YXJ0IHBhcmEgc3BhbnMnLCBzdGFydFBhcmFncmFwaFNwYW5zKVxuICAgICAgICAgICAgICAvLyBjb25zb2xlLmRlYnVnKCdlbmRvZiBwYXJhJywgZW5kT2ZQYXJhZ3JhcGgpXG4gICAgICAgICAgICAgIC8vIGNvbnNvbGUuZGVidWcoJ3BvaW50ZXIgbmV4dCcsIGRhdGFQb2ludGVyTmV4dChkYXRhLCBlbmRPZlBhcmFncmFwaCkpXG4gICAgICAgICAgICAgIC8vICAgY29uc29sZS5kZWJ1ZygnREFUQTAnLCBKU09OLnN0cmluZ2lmeShkYXRhLCB1bmRlZmluZWQsIDIpKTtcbiAgICAgICAgICAgICAgY29uc3QgciA9IGRhdGFTcGxpY2UoZGF0YSwgc3RhcnQsIGRhdGFQb2ludGVyTmV4dChkYXRhLCBlbmRPZlBhcmFncmFwaCkpO1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUuZGVidWcoJ0RBVEExJywgSlNPTi5zdHJpbmdpZnkoZGF0YSwgdW5kZWZpbmVkLCAyKSk7XG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5kZWJ1ZygnU1BMSUNFRCcsIEpTT04uc3RyaW5naWZ5KHIsIHVuZGVmaW5lZCwgMikpO1xuICAgICAgICAgICAgICAgIGlmKHN0YXJ0LnNwYW5JbmRleCA9PT0gdW5kZWZpbmVkICYmIHN0YXJ0LnNwYW5JRCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgc3RhcnQuc3BhbkluZGV4ID0gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAvLyBhdCBuZXh0IERPTSB1cGRhdGUgKGF0IHRoaXMgcG9pbnQgb25seSB0aGUgZGF0YSBtb2RlbCBoYXMgY2hhbmdlcywgdGhlIERPTSBjb250YWlucyBvbGQgY29udGVudCksIHNldCBjdXJzb3IgdG8gdGhlIGNvcnJlY3QgcG9zaXRpb25cbiAgICAgICAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgIC8vIGhhdmUgdG8gcmVzZXQgdGhlc2VcbiAgICAgICAgICAgICAgICAvLyBzdGFydC5zcGFuSUQgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgc3RhcnQubm9kZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAvLyBwdXQgdGV4dCBjdXJzb3IgYXQgdGhlIGV4cGVjdGVkIHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgZGF0YVBvaW50ZXIoZGF0YSwgc3RhcnQpXG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5kZWJ1ZygnUkVTVE9SRScsIHN0YXJ0KVxuICAgICAgICAgICAgICAgIHJlc3RvcmVET01TZWxlY3Rpb24odGhpcy4kcmVmcy5jb250YWluZXIsIHN0YXJ0KTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSBpZigoZS5jdHJsS2V5IHx8IGUubWV0YUtleSkgJiYgZS5zaGlmdEtleSAmJiBlLmNvZGUgPT09ICdLZXlIJykge1xuICAgICAgICBjb25zdCBzZWxlY3RlZFNwYW5zID0gdGhpcy5nZXRTcGFuU2VsZWN0aW9uKCk7XG4gICAgICAgIC8vIGNvbnNvbGUuZGVidWcoJ3JlbW92ZSBoaWdobGlnaHRpbmcgZnJvbSBzcGFucycsIHNlbGVjdGVkU3BhbnMpO1xuICAgICAgICBmb3IoY29uc3QgcyBvZiBzZWxlY3RlZFNwYW5zKSB7XG4gICAgICAgICAgZm9yKGNvbnN0IHNwYW4gb2Ygcy5zcGFucykge1xuICAgICAgICAgICAgc3Bhbi5oaWdobGlnaHRlZCA9IGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICB9IGVsc2UgaWYoKGUuY3RybEtleSB8fCBlLm1ldGFLZXkpICYmIGUuY29kZSA9PT0gJ0tleUgnKSB7XG4gICAgICAgIGNvbnN0IHNlbGVjdGVkU3BhbnMgPSB0aGlzLmdldFNwYW5TZWxlY3Rpb24oKTtcbiAgICAgICAgLy8gY29uc29sZS5kZWJ1ZygnaGlnaGxpZ2h0IHNwYW5zJywgc2VsZWN0ZWRTcGFucyk7XG4gICAgICAgIGZvcihjb25zdCBzIG9mIHNlbGVjdGVkU3BhbnMpIHtcbiAgICAgICAgICBmb3IoY29uc3Qgc3BhbiBvZiBzLnNwYW5zKSB7XG4gICAgICAgICAgICBzcGFuLmhpZ2hsaWdodGVkID0gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgfSBlbHNlIGlmKCFzZWxlY3Rpb24uaXNDb2xsYXBzZWQpIHtcbiAgICAgICAgY29uc29sZS5kZWJ1ZygnUFJFVkVOVCBSQU5HRSBSRVBMQUNFJyk7XG4gICAgICAgIC8vIFRPRE8gYmxvY2tzIGNtZCtzIGlmIHRleHQgaXMgc2VsZWN0ZWRcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gY29uc29sZS5kZWJ1ZygnRU5EJylcbiAgICAgIH1cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0sXG5cbiAgICBvbkRyYWdTdGFydChlKSB7XG4gICAgICAvLyBwcmV2ZW50IHRleHQgZHJhZ2dpbmdcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSxcblxuICAgIG9uUGFzdGUoZSkge1xuICAgICAgLy8gY29uc29sZS5kZWJ1ZygnZWRpdGFibGUtc3BhbnMgcGFzdGUnLCBlKTtcbiAgICAgIC8vIHRoaXMgcHJldmVudHMgcGFzdGUgd2l0aCBzZWxlY3RpbmcgcGFzdGUgbWVudSBpdGVtLCBrZXlib2FyZCBzaG9ydGN1dHMgZ2V0IHByZXZlbnRlZCBpbiBrZXlkb3duIGV2ZW50IGhhbmRsZXJcblxuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgY29uc3QgeyBzdGFydCwgZW5kLCBjb2xsYXBzZWQgfSA9IHRoaXMuYXBwbHlWaWV3Q2hhbmdlc05vdyhmYWxzZSk7XG5cbiAgICAgIGNvbnN0IG5hdGl2ZURhdGEgPSBlLmNsaXBib2FyZERhdGEuZ2V0RGF0YSgnYXBwbGljYXRpb24vcnV0YScpO1xuICAgICAgY29uc3QgaHRtbERhdGEgPSBlLmNsaXBib2FyZERhdGEuZ2V0RGF0YSgndGV4dC9odG1sJyk7XG4gICAgICBjb25zdCB0ZXh0RGF0YSA9IGUuY2xpcGJvYXJkRGF0YS5nZXREYXRhKCd0ZXh0L3BsYWluJyk7XG5cbiAgICAgIGlmKG5hdGl2ZURhdGEubGVuZ3RoID09PSAwICYmIGh0bWxEYXRhLmxlbmd0aCA9PT0gMCAmJiB0ZXh0RGF0YS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgLy8gY2xpcGJvYXJkIGVtcHR5IG9yIGluY29tcGF0aWJsZSBmb3JtYXRcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBkYXRhID0gdGhpcy5wYXJhZ3JhcGhzO1xuICAgICAgZGF0YVBvaW50ZXIoZGF0YSwgc3RhcnQpO1xuXG4gICAgICBpZighY29sbGFwc2VkKSB7XG4gICAgICAgIGRhdGFQb2ludGVyKGRhdGEsIGVuZCk7XG4gICAgICAgIGNvbnN0IHIgPSBkYXRhU3BsaWNlKGRhdGEsIHN0YXJ0LCBlbmQpO1xuXG4gICAgICAgIHN0YXJ0LnNwYW5JRCA9IHVuZGVmaW5lZDtcbiAgICAgICAgc3RhcnQubm9kZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgZGF0YVBvaW50ZXIoZGF0YSwgc3RhcnQpO1xuICAgICAgICBzdGFydC5ub2RlID0gdW5kZWZpbmVkO1xuICAgICAgfVxuXG4gICAgICAvLyBjb25zb2xlLmRlYnVnKCdDTElQJywgZS5jbGlwYm9hcmREYXRhLnR5cGVzKVxuICAgICAgLy8gY29uc29sZS5kZWJ1ZygnUEFTVEUgSFRNTCcsIGUuY2xpcGJvYXJkRGF0YS5nZXREYXRhKCd0ZXh0L2h0bWwnKSk7XG4gICAgICAvLyBjb25zb2xlLmRlYnVnKCdQQVNURSBSVEYnLCBlLmNsaXBib2FyZERhdGEuZ2V0RGF0YSgndGV4dC9ydGYnKSk7XG4gICAgICAvLyBjb25zb2xlLmRlYnVnKCdQQVNURSBQTEFJTicsIGUuY2xpcGJvYXJkRGF0YS5nZXREYXRhKCd0ZXh0L3BsYWluJykpO1xuXG4gICAgICBpZihuYXRpdmVEYXRhLmxlbmd0aCA+IDApIHtcblxuICAgICAgICBjb25zb2xlLmRlYnVnKCdwYXN0aW5nIGZyb20gUlVUQScpXG4gICAgICAgIGNvbnN0IG5ld0RhdGEgPSBKU09OLnBhcnNlKG5hdGl2ZURhdGEpOyAgLy8gdGhpcyBuYXR1cmFsbHkgZ2l2ZXMgY29weVxuICAgICAgICAvLyBnZW5lcmF0ZSBuZXcgdW5pcXVlIGlkJ3NcbiAgICAgICAgZm9yKGNvbnN0IHAgb2YgbmV3RGF0YSkge1xuICAgICAgICAgIHAuaWQgPSBuZXdJRCgpO1xuICAgICAgICAgIGZvcihjb25zdCBzIG9mIHAuc3BhbnMpIHtcbiAgICAgICAgICAgIHMuaWQgPSBuZXdJRCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb25zdCByID0gZGF0YUluc2VydChkYXRhLCBzdGFydCwgbmV3RGF0YSk7XG4gICAgICAgIC8vIHB1dCBjdXJzb3IgYWZ0ZXIgcGFzdGVkIHRleHRcbiAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4ge1xuICAgICAgICAgIHIuZW5kLm5vZGUgPSBudWxsO1xuICAgICAgICAgIHJlc3RvcmVET01TZWxlY3Rpb24odGhpcy4kcmVmcy5jb250YWluZXIsIGRhdGFQb2ludGVyKGRhdGEsIHIuZW5kKSk7XG4gICAgICAgIH0pO1xuXG4gICAgICB9IGVsc2UgaWYoaHRtbERhdGEubGVuZ3RoID4gMCkge1xuXG4gICAgICAgIGNvbnN0IGh0bWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdodG1sJylcbiAgICAgICAgaHRtbC5pbm5lckhUTUwgPSBodG1sRGF0YTtcblxuICAgICAgICBjb25zdCBzdHlsZSA9IGh0bWwucXVlcnlTZWxlY3RvcignaGVhZCA+IHN0eWxlJyk7XG4gICAgICAgIC8vIGNvbnN0IHN0eWxlVGV4dCA9IHN0eWxlLnRleHRDb250ZW50O1xuICAgICAgICAvLyBjb25zb2xlLmRlYnVnKHN0eWxlVGV4dClcbiAgICAgICAgLy8gY29uc29sZS5kaXIoaHRtbC5xdWVyeVNlbGVjdG9yKCdoZWFkID4gc3R5bGUnKSlcblxuICAgICAgICAvLyBwYXJzZSBzdHlsZVxuICAgICAgICBpZihzdHlsZSkge1xuICAgICAgICAgIGxldCBkb2MgPSBkb2N1bWVudC5pbXBsZW1lbnRhdGlvbi5jcmVhdGVIVE1MRG9jdW1lbnQoXCJcIik7XG4gICAgICAgICAgZG9jLmJvZHkuYXBwZW5kQ2hpbGQoc3R5bGUpO1xuICAgICAgICAgIC8vIGNvbnNvbGUuZGVidWcoJ1NIRUVUJywgc3R5bGUuc2hlZXQpXG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBib2R5ID0gaHRtbC5xdWVyeVNlbGVjdG9yKCdib2R5Jyk7XG5cbiAgICAgICAgLy8gY29uc29sZS5kZWJ1Zyhib2R5KVxuXG4gICAgICAgIC8vIHBhcnNlIERPTSBoZXJlIHdpdGggZm9ybWF0dGluZ1xuICAgICAgICBjb25zdCBuZXdEYXRhID0gcGFyc2VWYW5pbGxhRE9NKGJvZHksIHN0eWxlICYmIHN0eWxlLnNoZWV0LmNzc1J1bGVzKTtcblxuICAgICAgICAvLyBjb25zb2xlLmRlYnVnKEpTT04uc3RyaW5naWZ5KG5ld0RhdGEsIHVuZGVmaW5lZCwgMikpXG5cbiAgICAgICAgLy8gZ2VuZXJhdGUgbmV3IHVuaXF1ZSBpZCdzXG4gICAgICAgIGZvcihjb25zdCBwIG9mIG5ld0RhdGEpIHtcbiAgICAgICAgICBwLmlkID0gbmV3SUQoKTtcbiAgICAgICAgICBmb3IoY29uc3QgcyBvZiBwLnNwYW5zKSB7XG4gICAgICAgICAgICBzLmlkID0gbmV3SUQoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjb25zb2xlLmRlYnVnKCdwYXN0aW5nIGZvcm1hdHRlZCB0ZXh0IGZyb20gaHRtbCBzb3VyY2UnKTtcbiAgICAgICAgY29uc3QgciA9IGRhdGFJbnNlcnQoZGF0YSwgc3RhcnQsIG5ld0RhdGEpO1xuXG4gICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHtcbiAgICAgICAgICByLmVuZC5ub2RlID0gbnVsbDtcbiAgICAgICAgICByZXN0b3JlRE9NU2VsZWN0aW9uKHRoaXMuJHJlZnMuY29udGFpbmVyLCBkYXRhUG9pbnRlcihkYXRhLCByLmVuZCkpO1xuICAgICAgICB9KTtcblxuICAgICAgfSBlbHNlIGlmKHRleHREYXRhLmxlbmd0aCA+IDApIHtcblxuICAgICAgICBjb25zb2xlLmRlYnVnKCdwYXN0aW5nIHBsYWludGV4dCcpO1xuICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7XG4gICAgICAgICAgaWYoc3RhcnQucGFyYWdyYXBoSW5kZXggIT09IHVuZGVmaW5lZCB8fCBzdGFydC5wYXJhZ3JhcGhJRCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXN0b3JlRE9NU2VsZWN0aW9uKHRoaXMuJHJlZnMuY29udGFpbmVyLCBkYXRhUG9pbnRlcihkYXRhLCBzdGFydCkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBuZXdEYXRhID0gW107XG4gICAgICAgICAgY29uc3QgbGluZXMgPSB0ZXh0RGF0YS5zcGxpdCgnXFxuJyk7XG4gICAgICAgICAgZm9yKGNvbnN0IGxpbmUgb2YgbGluZXMpIHtcbiAgICAgICAgICAgIG5ld0RhdGEucHVzaCh7IGlkOiBuZXdJRCgpLCBzcGFuczogW3sgaWQ6IG5ld0lEKCksIHRleHQ6IGxpbmUsIGZvcm1hdDoge30gfV0gfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGxldCBlbmQ7XG4gICAgICAgICAgaWYobmV3RGF0YS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIGRhdGEuc3BsaWNlLmFwcGx5KGRhdGEsIFswLCAwXS5jb25jYXQobmV3RGF0YSkpO1xuICAgICAgICAgICAgZW5kID0geyBwYXJhZ3JhcGhJRDogbmV3RGF0YVtuZXdEYXRhLmxlbmd0aCAtIDFdLmlkLCBzcGFuSUQ6IG5ld0RhdGFbbmV3RGF0YS5sZW5ndGggLSAxXS5zcGFuc1swXS5pZCwgb2Zmc2V0OiBuZXdEYXRhW25ld0RhdGEubGVuZ3RoIC0gMV0uc3BhbnNbMF0udGV4dC5sZW5ndGggfTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgciA9IGRhdGFJbnNlcnQoZGF0YSwgc3RhcnQsIG5ld0RhdGEpO1xuICAgICAgICAgICAgZW5kID0gci5lbmQ7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8vIHB1dCBjdXJzb3IgYWZ0ZXIgcGFzdGVkIHRleHRcbiAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7XG4gICAgICAgICAgICBlbmQubm9kZSA9IG51bGw7XG4gICAgICAgICAgICByZXN0b3JlRE9NU2VsZWN0aW9uKHRoaXMuJHJlZnMuY29udGFpbmVyLCBkYXRhUG9pbnRlcihkYXRhLCBlbmQpKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICAvLyBkb2N1bWVudC5leGVjQ29tbWFuZChcImluc2VydEhUTUxcIiwgZmFsc2UsIHRleHREYXRhKTsgICAvLyBOT1RFOiB0ZXh0IGlzIG5vdCBzcGxpdHRlZCBpbnRvIHByb3BlciBwYXJhZ3JhcGhzIGF0IG5ld2xpbmVzXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICBvbkN1dChlKSB7XG4gICAgICAvLyBjb25zb2xlLmRlYnVnKCdlZGl0YWJsZS1zcGFucyBjdXQnLCBlKTtcbiAgICAgIC8vIHRoaXMgcHJldmVudHMgY3V0dGluZyB3aXRoIHNlbGVjdGluZyBjdXQgbWVudSBpdGVtLCBrZXlib2FyZCBzaG9ydGN1dHMgZ2V0IHByZXZlbnRlZCBpbiBrZXlkb3duIGV2ZW50IGhhbmRsZXJcbiAgICAgIHRoaXMub25Db3B5KGUpO1xuICAgICAgLy8gZGVsZXRlIHNlbGVjdGlvblxuICAgICAgY29uc3Qgc2VsZWN0aW9uID0gbm9ybWFsaXplZERPTVNlbGVjdGlvbigpO1xuICAgICAgaWYoIXNlbGVjdGlvbi5jb2xsYXBzZWQpIHtcbiAgICAgICAgY29uc3QgZGF0YSA9IHRoaXMucGFyYWdyYXBocztcbiAgICAgICAgY29uc3Qgc3RhcnQgPSBzZWxlY3Rpb24uc3RhcnQ7XG4gICAgICAgIGRhdGFQb2ludGVyKGRhdGEsIHN0YXJ0KTtcbiAgICAgICAgY29uc3QgZW5kID0gc2VsZWN0aW9uLmVuZDtcbiAgICAgICAgZGF0YVBvaW50ZXIoZGF0YSwgZW5kKTtcbiAgICAgICAgY29uc3QgciA9IGRhdGFTcGxpY2UoZGF0YSwgc3RhcnQsIGVuZCk7XG4gICAgICB9XG4gICAgfSxcblxuICAgIG9uQ29weShlKSB7XG4gICAgICAvLyBjb25zb2xlLmRlYnVnKCdlZGl0YWJsZS1zcGFucyBjb3B5JywgZSk7XG4gICAgICBjb25zdCBkYXRhID0gdGhpcy5wYXJhZ3JhcGhzO1xuICAgICAgY29uc3Qgc2VsZWN0aW9uID0gbm9ybWFsaXplZERPTVNlbGVjdGlvbigpO1xuICAgICAgaWYoIXNlbGVjdGlvbi5pc0NvbGxhcHNlZCkge1xuXG4gICAgICAgIGNvbnN0IHN0YXJ0ID0gc2VsZWN0aW9uLnN0YXJ0O1xuICAgICAgICBkYXRhUG9pbnRlcihkYXRhLCBzdGFydCk7XG4gICAgICAgIGNvbnN0IGVuZCA9IHNlbGVjdGlvbi5lbmQ7XG4gICAgICAgIGRhdGFQb2ludGVyKGRhdGEsIGVuZCk7XG5cblxuICAgICAgICBjb25zdCByID0gZGF0YVNwbGljZShkYXRhLCBzdGFydCwgZW5kLCBTcGxpY2VNb2RlLkNvcHkpO1xuXG4gICAgICAgIC8vIGNvcHkgYXMgcnV0YSBpbnRlcm5hbCBmb3JtYXRcbiAgICAgICAgZS5jbGlwYm9hcmREYXRhLnNldERhdGEoJ2FwcGxpY2F0aW9uL3J1dGEnLCBKU09OLnN0cmluZ2lmeShyKSk7XG4gICAgICAgIC8vIGUuY2xpcGJvYXJkRGF0YS5zZXREYXRhKCdhcHBsaWNhdGlvbi9ydXRhJywgSlNPTi5zdHJpbmdpZnkociwgdW5kZWZpbmVkLCAyKSk7XG5cbiAgICAgICAgLy8gY29weSBwbGFpbnRleHRcbiAgICAgICAgY29uc3QgcGFyYWdyYXBocyA9IFtdO1xuICAgICAgICBmb3IoY29uc3QgcCBvZiByKSB7XG4gICAgICAgICAgY29uc3Qgc3BhbnMgPSBbXTtcbiAgICAgICAgICBmb3IoY29uc3QgcyBvZiBwLnNwYW5zKSB7XG4gICAgICAgICAgICBzcGFucy5wdXNoKHMudGV4dCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHBhcmFncmFwaHMucHVzaChzcGFucy5qb2luKCcnKSk7XG4gICAgICAgIH1cbiAgICAgICAgZS5jbGlwYm9hcmREYXRhLnNldERhdGEoJ3RleHQvcGxhaW4nLCBwYXJhZ3JhcGhzLmpvaW4oJ1xcbicpKTtcblxuICAgICAgICAvLyBjb3B5IGFzIEhUTUxcbiAgICAgICAgLy8gY29uc29sZS5kZWJ1ZygnQ09QWSBIVE1MJywgdGhpcy5hc0hUTUwocikpO1xuICAgICAgICBlLmNsaXBib2FyZERhdGEuc2V0RGF0YSgndGV4dC9odG1sJywgdGhpcy5hc0hUTUwocikpO1xuICAgICAgfVxuXG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgLy8gdGhpcyBwcmV2ZW50cyBjdXR0aW5nIHdpdGggc2VsZWN0aW5nIGN1dCBtZW51IGl0ZW0sIGtleWJvYXJkIHNob3J0Y3V0cyBnZXQgcHJldmVudGVkIGluIGtleWRvd24gZXZlbnQgaGFuZGxlclxuICAgIH0sXG4gIH0sXG5cbiAgZXJyb3JDYXB0dXJlZChlcnIsIGluc3RhbmNlLCBpbmZvKSB7XG4gICAgY29uc29sZS5kZWJ1ZygnRURJVE9SIEVSUk9SIENBUFRVUkVEJywgZXJyLCBpbnN0YW5jZSwgaW5mbyk7XG4gICAgcmV0dXJuIHRydWU7XG4gIH0sXG59O1xuPC9zY3JpcHQ+XG5cblxuPHN0eWxlIHNjb3BlZD5cbi50cmFuc2NyaXB0IHtcbiAgZm9udC1zaXplOiAyMHB4O1xuICBjb2xvcjogIzc3Nztcbn1cbnNwYW4uc2VsZWN0ZWQge1xuICBjb2xvcjogIzAwMDtcbiAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgyNTMsIDI0OSwgMTIsIDAuNTApO1xufVxuc3Bhbi5oaWdobGlnaHRlZCB7XG4gIGJhY2tncm91bmQtY29sb3I6IHllbGxvdztcbn1cbnNwYW4ucGFzdCB7XG4gIGNvbG9yOiAjMjIyO1xufVxuLm5vc2VsZWN0IHtcbiAgLXdlYmtpdC10b3VjaC1jYWxsb3V0OiBub25lOyAvKiBpT1MgU2FmYXJpICovXG4gICAgLXdlYmtpdC11c2VyLXNlbGVjdDogbm9uZTsgLyogU2FmYXJpICovXG4gICAgIC1raHRtbC11c2VyLXNlbGVjdDogbm9uZTsgLyogS29ucXVlcm9yIEhUTUwgKi9cbiAgICAgICAtbW96LXVzZXItc2VsZWN0OiBub25lOyAvKiBPbGQgdmVyc2lvbnMgb2YgRmlyZWZveCAqL1xuICAgICAgICAtbXMtdXNlci1zZWxlY3Q6IG5vbmU7IC8qIEludGVybmV0IEV4cGxvcmVyL0VkZ2UgKi9cbiAgICAgICAgICAgIHVzZXItc2VsZWN0OiBub25lOyAvKiBOb24tcHJlZml4ZWQgdmVyc2lvbiwgY3VycmVudGx5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VwcG9ydGVkIGJ5IENocm9tZSwgRWRnZSwgT3BlcmEgYW5kIEZpcmVmb3ggKi9cbn1cbi5saXN0LWl0ZW06OmJlZm9yZSB7XG4gIGNvbnRlbnQ6IFwiXFwyMDIyXCI7ICAvKiBBZGQgY29udGVudDogXFwyMDIyIGlzIHRoZSBDU1MgQ29kZS91bmljb2RlIGZvciBhIGJ1bGxldCAqL1xuICBjb2xvcjogYmxhY2s7IC8qIENoYW5nZSB0aGUgY29sb3IgKi9cbiAgZm9udC13ZWlnaHQ6IGJvbGQ7IC8qIElmIHlvdSB3YW50IGl0IHRvIGJlIGJvbGQgKi9cbiAgZGlzcGxheTogaW5saW5lLWJsb2NrOyAvKiBOZWVkZWQgdG8gYWRkIHNwYWNlIGJldHdlZW4gdGhlIGJ1bGxldCBhbmQgdGhlIHRleHQgKi9cbiAgd2lkdGg6IDFlbTsgLyogQWxzbyBuZWVkZWQgZm9yIHNwYWNlICh0d2VhayBpZiBuZWVkZWQpICovXG4gIG1hcmdpbi1sZWZ0OiAtMWVtOyAvKiBBbHNvIG5lZWRlZCBmb3Igc3BhY2UgKHR3ZWFrIGlmIG5lZWRlZCkgKi9cbiAgbWFyZ2luLWxlZnQ6IDIwcHg7XG4gIC8qIGJvcmRlcjogMXB4IHNvbGlkIGdyZWVuOyAqL1xufVxuLnBhcmFncmFwaCB7XG4gIHBhZGRpbmctYm90dG9tOiAxMHB4O1xuICBtaW4taGVpZ2h0OiA0MHB4O1xufVxuLnBhcmFncmFwaC1udW1iZXIge1xuICBmbG9hdDogbGVmdDtcbn1cbnNwYW4uYm9sZCB7XG4gIGZvbnQtd2VpZ2h0OiBib2xkO1xufVxuc3Bhbi5pdGFsaWMge1xuICBmb250LXN0eWxlOiBpdGFsaWM7XG59XG5zcGFuLnVuZGVybGluZSB7XG4gIHRleHQtZGVjb3JhdGlvbjogdW5kZXJsaW5lO1xufVxuLyogaHR0cHM6Ly9jc3MtdHJpY2tzLmNvbS9zbmlwcGV0cy9jc3MvcHJldmVudC1zdXBlcnNjcmlwdHMtYW5kLXN1YnNjcmlwdHMtZnJvbS1hZmZlY3RpbmctbGluZS1oZWlnaHQvICovXG5zcGFuLnN1cGVyc2NyaXB0IHtcbiAgdmVydGljYWwtYWxpZ246IHN1cGVyO1xuICBmb250LXNpemU6IDgwJTtcblxuICB2ZXJ0aWNhbC1hbGlnbjogYmFzZWxpbmU7XG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgdG9wOiAtMC40ZW07XG4gIGxpbmUtaGVpZ2h0OiAwO1xufVxuc3Bhbi5zdWJzY3JpcHQge1xuICB2ZXJ0aWNhbC1hbGlnbjogc3ViO1xuICBmb250LXNpemU6IDgwJTtcblxuICB2ZXJ0aWNhbC1hbGlnbjogYmFzZWxpbmU7XG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgdG9wOiAwLjRlbTtcbiAgbGluZS1oZWlnaHQ6IDA7XG59XG5zcGFuLnRva2VuLnBzZXVkbzo6YWZ0ZXIge1xuICBjb250ZW50OiBcIlxcMGEwXCI7XG4gIGRpc3BsYXk6IGlubGluZTtcbn1cbi5wYXJhZ3JhcGgge1xuICBwb3NpdGlvbjogcmVsYXRpdmU7XG59XG4ucGFyYWdyYXBoOjpiZWZvcmUge1xuICBjb250ZW50OiBhdHRyKGRhdGEtdGltZSkgXCJzXCI7XG4gIGZvbnQtc2l6ZTogOHB4O1xuICBjb2xvcjogI2JiYjtcbiAgdG9wOiAtNnB4O1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIHJpZ2h0OiAwcHg7XG59XG48L3N0eWxlPlxuIiwidmFyIG5vb3AgPSB7dmFsdWU6ICgpID0+IHt9fTtcblxuZnVuY3Rpb24gZGlzcGF0Y2goKSB7XG4gIGZvciAodmFyIGkgPSAwLCBuID0gYXJndW1lbnRzLmxlbmd0aCwgXyA9IHt9LCB0OyBpIDwgbjsgKytpKSB7XG4gICAgaWYgKCEodCA9IGFyZ3VtZW50c1tpXSArIFwiXCIpIHx8ICh0IGluIF8pIHx8IC9bXFxzLl0vLnRlc3QodCkpIHRocm93IG5ldyBFcnJvcihcImlsbGVnYWwgdHlwZTogXCIgKyB0KTtcbiAgICBfW3RdID0gW107XG4gIH1cbiAgcmV0dXJuIG5ldyBEaXNwYXRjaChfKTtcbn1cblxuZnVuY3Rpb24gRGlzcGF0Y2goXykge1xuICB0aGlzLl8gPSBfO1xufVxuXG5mdW5jdGlvbiBwYXJzZVR5cGVuYW1lcyh0eXBlbmFtZXMsIHR5cGVzKSB7XG4gIHJldHVybiB0eXBlbmFtZXMudHJpbSgpLnNwbGl0KC9efFxccysvKS5tYXAoZnVuY3Rpb24odCkge1xuICAgIHZhciBuYW1lID0gXCJcIiwgaSA9IHQuaW5kZXhPZihcIi5cIik7XG4gICAgaWYgKGkgPj0gMCkgbmFtZSA9IHQuc2xpY2UoaSArIDEpLCB0ID0gdC5zbGljZSgwLCBpKTtcbiAgICBpZiAodCAmJiAhdHlwZXMuaGFzT3duUHJvcGVydHkodCkpIHRocm93IG5ldyBFcnJvcihcInVua25vd24gdHlwZTogXCIgKyB0KTtcbiAgICByZXR1cm4ge3R5cGU6IHQsIG5hbWU6IG5hbWV9O1xuICB9KTtcbn1cblxuRGlzcGF0Y2gucHJvdG90eXBlID0gZGlzcGF0Y2gucHJvdG90eXBlID0ge1xuICBjb25zdHJ1Y3RvcjogRGlzcGF0Y2gsXG4gIG9uOiBmdW5jdGlvbih0eXBlbmFtZSwgY2FsbGJhY2spIHtcbiAgICB2YXIgXyA9IHRoaXMuXyxcbiAgICAgICAgVCA9IHBhcnNlVHlwZW5hbWVzKHR5cGVuYW1lICsgXCJcIiwgXyksXG4gICAgICAgIHQsXG4gICAgICAgIGkgPSAtMSxcbiAgICAgICAgbiA9IFQubGVuZ3RoO1xuXG4gICAgLy8gSWYgbm8gY2FsbGJhY2sgd2FzIHNwZWNpZmllZCwgcmV0dXJuIHRoZSBjYWxsYmFjayBvZiB0aGUgZ2l2ZW4gdHlwZSBhbmQgbmFtZS5cbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA8IDIpIHtcbiAgICAgIHdoaWxlICgrK2kgPCBuKSBpZiAoKHQgPSAodHlwZW5hbWUgPSBUW2ldKS50eXBlKSAmJiAodCA9IGdldChfW3RdLCB0eXBlbmFtZS5uYW1lKSkpIHJldHVybiB0O1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIElmIGEgdHlwZSB3YXMgc3BlY2lmaWVkLCBzZXQgdGhlIGNhbGxiYWNrIGZvciB0aGUgZ2l2ZW4gdHlwZSBhbmQgbmFtZS5cbiAgICAvLyBPdGhlcndpc2UsIGlmIGEgbnVsbCBjYWxsYmFjayB3YXMgc3BlY2lmaWVkLCByZW1vdmUgY2FsbGJhY2tzIG9mIHRoZSBnaXZlbiBuYW1lLlxuICAgIGlmIChjYWxsYmFjayAhPSBudWxsICYmIHR5cGVvZiBjYWxsYmFjayAhPT0gXCJmdW5jdGlvblwiKSB0aHJvdyBuZXcgRXJyb3IoXCJpbnZhbGlkIGNhbGxiYWNrOiBcIiArIGNhbGxiYWNrKTtcbiAgICB3aGlsZSAoKytpIDwgbikge1xuICAgICAgaWYgKHQgPSAodHlwZW5hbWUgPSBUW2ldKS50eXBlKSBfW3RdID0gc2V0KF9bdF0sIHR5cGVuYW1lLm5hbWUsIGNhbGxiYWNrKTtcbiAgICAgIGVsc2UgaWYgKGNhbGxiYWNrID09IG51bGwpIGZvciAodCBpbiBfKSBfW3RdID0gc2V0KF9bdF0sIHR5cGVuYW1lLm5hbWUsIG51bGwpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xuICB9LFxuICBjb3B5OiBmdW5jdGlvbigpIHtcbiAgICB2YXIgY29weSA9IHt9LCBfID0gdGhpcy5fO1xuICAgIGZvciAodmFyIHQgaW4gXykgY29weVt0XSA9IF9bdF0uc2xpY2UoKTtcbiAgICByZXR1cm4gbmV3IERpc3BhdGNoKGNvcHkpO1xuICB9LFxuICBjYWxsOiBmdW5jdGlvbih0eXBlLCB0aGF0KSB7XG4gICAgaWYgKChuID0gYXJndW1lbnRzLmxlbmd0aCAtIDIpID4gMCkgZm9yICh2YXIgYXJncyA9IG5ldyBBcnJheShuKSwgaSA9IDAsIG4sIHQ7IGkgPCBuOyArK2kpIGFyZ3NbaV0gPSBhcmd1bWVudHNbaSArIDJdO1xuICAgIGlmICghdGhpcy5fLmhhc093blByb3BlcnR5KHR5cGUpKSB0aHJvdyBuZXcgRXJyb3IoXCJ1bmtub3duIHR5cGU6IFwiICsgdHlwZSk7XG4gICAgZm9yICh0ID0gdGhpcy5fW3R5cGVdLCBpID0gMCwgbiA9IHQubGVuZ3RoOyBpIDwgbjsgKytpKSB0W2ldLnZhbHVlLmFwcGx5KHRoYXQsIGFyZ3MpO1xuICB9LFxuICBhcHBseTogZnVuY3Rpb24odHlwZSwgdGhhdCwgYXJncykge1xuICAgIGlmICghdGhpcy5fLmhhc093blByb3BlcnR5KHR5cGUpKSB0aHJvdyBuZXcgRXJyb3IoXCJ1bmtub3duIHR5cGU6IFwiICsgdHlwZSk7XG4gICAgZm9yICh2YXIgdCA9IHRoaXMuX1t0eXBlXSwgaSA9IDAsIG4gPSB0Lmxlbmd0aDsgaSA8IG47ICsraSkgdFtpXS52YWx1ZS5hcHBseSh0aGF0LCBhcmdzKTtcbiAgfVxufTtcblxuZnVuY3Rpb24gZ2V0KHR5cGUsIG5hbWUpIHtcbiAgZm9yICh2YXIgaSA9IDAsIG4gPSB0eXBlLmxlbmd0aCwgYzsgaSA8IG47ICsraSkge1xuICAgIGlmICgoYyA9IHR5cGVbaV0pLm5hbWUgPT09IG5hbWUpIHtcbiAgICAgIHJldHVybiBjLnZhbHVlO1xuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBzZXQodHlwZSwgbmFtZSwgY2FsbGJhY2spIHtcbiAgZm9yICh2YXIgaSA9IDAsIG4gPSB0eXBlLmxlbmd0aDsgaSA8IG47ICsraSkge1xuICAgIGlmICh0eXBlW2ldLm5hbWUgPT09IG5hbWUpIHtcbiAgICAgIHR5cGVbaV0gPSBub29wLCB0eXBlID0gdHlwZS5zbGljZSgwLCBpKS5jb25jYXQodHlwZS5zbGljZShpICsgMSkpO1xuICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG4gIGlmIChjYWxsYmFjayAhPSBudWxsKSB0eXBlLnB1c2goe25hbWU6IG5hbWUsIHZhbHVlOiBjYWxsYmFja30pO1xuICByZXR1cm4gdHlwZTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZGlzcGF0Y2g7XG4iLCJleHBvcnQgdmFyIHhodG1sID0gXCJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sXCI7XG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgc3ZnOiBcImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIsXG4gIHhodG1sOiB4aHRtbCxcbiAgeGxpbms6IFwiaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGlua1wiLFxuICB4bWw6IFwiaHR0cDovL3d3dy53My5vcmcvWE1MLzE5OTgvbmFtZXNwYWNlXCIsXG4gIHhtbG5zOiBcImh0dHA6Ly93d3cudzMub3JnLzIwMDAveG1sbnMvXCJcbn07XG4iLCJpbXBvcnQgbmFtZXNwYWNlcyBmcm9tIFwiLi9uYW1lc3BhY2VzLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKG5hbWUpIHtcbiAgdmFyIHByZWZpeCA9IG5hbWUgKz0gXCJcIiwgaSA9IHByZWZpeC5pbmRleE9mKFwiOlwiKTtcbiAgaWYgKGkgPj0gMCAmJiAocHJlZml4ID0gbmFtZS5zbGljZSgwLCBpKSkgIT09IFwieG1sbnNcIikgbmFtZSA9IG5hbWUuc2xpY2UoaSArIDEpO1xuICByZXR1cm4gbmFtZXNwYWNlcy5oYXNPd25Qcm9wZXJ0eShwcmVmaXgpID8ge3NwYWNlOiBuYW1lc3BhY2VzW3ByZWZpeF0sIGxvY2FsOiBuYW1lfSA6IG5hbWU7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tcHJvdG90eXBlLWJ1aWx0aW5zXG59XG4iLCJpbXBvcnQgbmFtZXNwYWNlIGZyb20gXCIuL25hbWVzcGFjZS5qc1wiO1xuaW1wb3J0IHt4aHRtbH0gZnJvbSBcIi4vbmFtZXNwYWNlcy5qc1wiO1xuXG5mdW5jdGlvbiBjcmVhdG9ySW5oZXJpdChuYW1lKSB7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICB2YXIgZG9jdW1lbnQgPSB0aGlzLm93bmVyRG9jdW1lbnQsXG4gICAgICAgIHVyaSA9IHRoaXMubmFtZXNwYWNlVVJJO1xuICAgIHJldHVybiB1cmkgPT09IHhodG1sICYmIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5uYW1lc3BhY2VVUkkgPT09IHhodG1sXG4gICAgICAgID8gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChuYW1lKVxuICAgICAgICA6IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyh1cmksIG5hbWUpO1xuICB9O1xufVxuXG5mdW5jdGlvbiBjcmVhdG9yRml4ZWQoZnVsbG5hbWUpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLm93bmVyRG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKGZ1bGxuYW1lLnNwYWNlLCBmdWxsbmFtZS5sb2NhbCk7XG4gIH07XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKG5hbWUpIHtcbiAgdmFyIGZ1bGxuYW1lID0gbmFtZXNwYWNlKG5hbWUpO1xuICByZXR1cm4gKGZ1bGxuYW1lLmxvY2FsXG4gICAgICA/IGNyZWF0b3JGaXhlZFxuICAgICAgOiBjcmVhdG9ySW5oZXJpdCkoZnVsbG5hbWUpO1xufVxuIiwiZnVuY3Rpb24gbm9uZSgpIHt9XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKHNlbGVjdG9yKSB7XG4gIHJldHVybiBzZWxlY3RvciA9PSBudWxsID8gbm9uZSA6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpO1xuICB9O1xufVxuIiwiLy8gR2l2ZW4gc29tZXRoaW5nIGFycmF5IGxpa2UgKG9yIG51bGwpLCByZXR1cm5zIHNvbWV0aGluZyB0aGF0IGlzIHN0cmljdGx5IGFuXG4vLyBhcnJheS4gVGhpcyBpcyB1c2VkIHRvIGVuc3VyZSB0aGF0IGFycmF5LWxpa2Ugb2JqZWN0cyBwYXNzZWQgdG8gZDMuc2VsZWN0QWxsXG4vLyBvciBzZWxlY3Rpb24uc2VsZWN0QWxsIGFyZSBjb252ZXJ0ZWQgaW50byBwcm9wZXIgYXJyYXlzIHdoZW4gY3JlYXRpbmcgYVxuLy8gc2VsZWN0aW9uOyB3ZSBkb27igJl0IGV2ZXIgd2FudCB0byBjcmVhdGUgYSBzZWxlY3Rpb24gYmFja2VkIGJ5IGEgbGl2ZVxuLy8gSFRNTENvbGxlY3Rpb24gb3IgTm9kZUxpc3QuIEhvd2V2ZXIsIG5vdGUgdGhhdCBzZWxlY3Rpb24uc2VsZWN0QWxsIHdpbGwgdXNlIGFcbi8vIHN0YXRpYyBOb2RlTGlzdCBhcyBhIGdyb3VwLCBzaW5jZSBpdCBzYWZlbHkgZGVyaXZlZCBmcm9tIHF1ZXJ5U2VsZWN0b3JBbGwuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBhcnJheSh4KSB7XG4gIHJldHVybiB4ID09IG51bGwgPyBbXSA6IEFycmF5LmlzQXJyYXkoeCkgPyB4IDogQXJyYXkuZnJvbSh4KTtcbn1cbiIsImZ1bmN0aW9uIGVtcHR5KCkge1xuICByZXR1cm4gW107XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKHNlbGVjdG9yKSB7XG4gIHJldHVybiBzZWxlY3RvciA9PSBudWxsID8gZW1wdHkgOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKTtcbiAgfTtcbn1cbiIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKHNlbGVjdG9yKSB7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5tYXRjaGVzKHNlbGVjdG9yKTtcbiAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNoaWxkTWF0Y2hlcihzZWxlY3Rvcikge1xuICByZXR1cm4gZnVuY3Rpb24obm9kZSkge1xuICAgIHJldHVybiBub2RlLm1hdGNoZXMoc2VsZWN0b3IpO1xuICB9O1xufVxuXG4iLCJpbXBvcnQge2NoaWxkTWF0Y2hlcn0gZnJvbSBcIi4uL21hdGNoZXIuanNcIjtcblxudmFyIGZpbmQgPSBBcnJheS5wcm90b3R5cGUuZmluZDtcblxuZnVuY3Rpb24gY2hpbGRGaW5kKG1hdGNoKSB7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gZmluZC5jYWxsKHRoaXMuY2hpbGRyZW4sIG1hdGNoKTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gY2hpbGRGaXJzdCgpIHtcbiAgcmV0dXJuIHRoaXMuZmlyc3RFbGVtZW50Q2hpbGQ7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKG1hdGNoKSB7XG4gIHJldHVybiB0aGlzLnNlbGVjdChtYXRjaCA9PSBudWxsID8gY2hpbGRGaXJzdFxuICAgICAgOiBjaGlsZEZpbmQodHlwZW9mIG1hdGNoID09PSBcImZ1bmN0aW9uXCIgPyBtYXRjaCA6IGNoaWxkTWF0Y2hlcihtYXRjaCkpKTtcbn1cbiIsImltcG9ydCB7Y2hpbGRNYXRjaGVyfSBmcm9tIFwiLi4vbWF0Y2hlci5qc1wiO1xuXG52YXIgZmlsdGVyID0gQXJyYXkucHJvdG90eXBlLmZpbHRlcjtcblxuZnVuY3Rpb24gY2hpbGRyZW4oKSB7XG4gIHJldHVybiBBcnJheS5mcm9tKHRoaXMuY2hpbGRyZW4pO1xufVxuXG5mdW5jdGlvbiBjaGlsZHJlbkZpbHRlcihtYXRjaCkge1xuICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIGZpbHRlci5jYWxsKHRoaXMuY2hpbGRyZW4sIG1hdGNoKTtcbiAgfTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24obWF0Y2gpIHtcbiAgcmV0dXJuIHRoaXMuc2VsZWN0QWxsKG1hdGNoID09IG51bGwgPyBjaGlsZHJlblxuICAgICAgOiBjaGlsZHJlbkZpbHRlcih0eXBlb2YgbWF0Y2ggPT09IFwiZnVuY3Rpb25cIiA/IG1hdGNoIDogY2hpbGRNYXRjaGVyKG1hdGNoKSkpO1xufVxuIiwiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24odXBkYXRlKSB7XG4gIHJldHVybiBuZXcgQXJyYXkodXBkYXRlLmxlbmd0aCk7XG59XG4iLCJpbXBvcnQgc3BhcnNlIGZyb20gXCIuL3NwYXJzZS5qc1wiO1xuaW1wb3J0IHtTZWxlY3Rpb259IGZyb20gXCIuL2luZGV4LmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gbmV3IFNlbGVjdGlvbih0aGlzLl9lbnRlciB8fCB0aGlzLl9ncm91cHMubWFwKHNwYXJzZSksIHRoaXMuX3BhcmVudHMpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gRW50ZXJOb2RlKHBhcmVudCwgZGF0dW0pIHtcbiAgdGhpcy5vd25lckRvY3VtZW50ID0gcGFyZW50Lm93bmVyRG9jdW1lbnQ7XG4gIHRoaXMubmFtZXNwYWNlVVJJID0gcGFyZW50Lm5hbWVzcGFjZVVSSTtcbiAgdGhpcy5fbmV4dCA9IG51bGw7XG4gIHRoaXMuX3BhcmVudCA9IHBhcmVudDtcbiAgdGhpcy5fX2RhdGFfXyA9IGRhdHVtO1xufVxuXG5FbnRlck5vZGUucHJvdG90eXBlID0ge1xuICBjb25zdHJ1Y3RvcjogRW50ZXJOb2RlLFxuICBhcHBlbmRDaGlsZDogZnVuY3Rpb24oY2hpbGQpIHsgcmV0dXJuIHRoaXMuX3BhcmVudC5pbnNlcnRCZWZvcmUoY2hpbGQsIHRoaXMuX25leHQpOyB9LFxuICBpbnNlcnRCZWZvcmU6IGZ1bmN0aW9uKGNoaWxkLCBuZXh0KSB7IHJldHVybiB0aGlzLl9wYXJlbnQuaW5zZXJ0QmVmb3JlKGNoaWxkLCBuZXh0KTsgfSxcbiAgcXVlcnlTZWxlY3RvcjogZnVuY3Rpb24oc2VsZWN0b3IpIHsgcmV0dXJuIHRoaXMuX3BhcmVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTsgfSxcbiAgcXVlcnlTZWxlY3RvckFsbDogZnVuY3Rpb24oc2VsZWN0b3IpIHsgcmV0dXJuIHRoaXMuX3BhcmVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKTsgfVxufTtcbiIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKHgpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB4O1xuICB9O1xufVxuIiwiaW1wb3J0IHtTZWxlY3Rpb259IGZyb20gXCIuL2luZGV4LmpzXCI7XG5pbXBvcnQge0VudGVyTm9kZX0gZnJvbSBcIi4vZW50ZXIuanNcIjtcbmltcG9ydCBjb25zdGFudCBmcm9tIFwiLi4vY29uc3RhbnQuanNcIjtcblxuZnVuY3Rpb24gYmluZEluZGV4KHBhcmVudCwgZ3JvdXAsIGVudGVyLCB1cGRhdGUsIGV4aXQsIGRhdGEpIHtcbiAgdmFyIGkgPSAwLFxuICAgICAgbm9kZSxcbiAgICAgIGdyb3VwTGVuZ3RoID0gZ3JvdXAubGVuZ3RoLFxuICAgICAgZGF0YUxlbmd0aCA9IGRhdGEubGVuZ3RoO1xuXG4gIC8vIFB1dCBhbnkgbm9uLW51bGwgbm9kZXMgdGhhdCBmaXQgaW50byB1cGRhdGUuXG4gIC8vIFB1dCBhbnkgbnVsbCBub2RlcyBpbnRvIGVudGVyLlxuICAvLyBQdXQgYW55IHJlbWFpbmluZyBkYXRhIGludG8gZW50ZXIuXG4gIGZvciAoOyBpIDwgZGF0YUxlbmd0aDsgKytpKSB7XG4gICAgaWYgKG5vZGUgPSBncm91cFtpXSkge1xuICAgICAgbm9kZS5fX2RhdGFfXyA9IGRhdGFbaV07XG4gICAgICB1cGRhdGVbaV0gPSBub2RlO1xuICAgIH0gZWxzZSB7XG4gICAgICBlbnRlcltpXSA9IG5ldyBFbnRlck5vZGUocGFyZW50LCBkYXRhW2ldKTtcbiAgICB9XG4gIH1cblxuICAvLyBQdXQgYW55IG5vbi1udWxsIG5vZGVzIHRoYXQgZG9u4oCZdCBmaXQgaW50byBleGl0LlxuICBmb3IgKDsgaSA8IGdyb3VwTGVuZ3RoOyArK2kpIHtcbiAgICBpZiAobm9kZSA9IGdyb3VwW2ldKSB7XG4gICAgICBleGl0W2ldID0gbm9kZTtcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gYmluZEtleShwYXJlbnQsIGdyb3VwLCBlbnRlciwgdXBkYXRlLCBleGl0LCBkYXRhLCBrZXkpIHtcbiAgdmFyIGksXG4gICAgICBub2RlLFxuICAgICAgbm9kZUJ5S2V5VmFsdWUgPSBuZXcgTWFwLFxuICAgICAgZ3JvdXBMZW5ndGggPSBncm91cC5sZW5ndGgsXG4gICAgICBkYXRhTGVuZ3RoID0gZGF0YS5sZW5ndGgsXG4gICAgICBrZXlWYWx1ZXMgPSBuZXcgQXJyYXkoZ3JvdXBMZW5ndGgpLFxuICAgICAga2V5VmFsdWU7XG5cbiAgLy8gQ29tcHV0ZSB0aGUga2V5IGZvciBlYWNoIG5vZGUuXG4gIC8vIElmIG11bHRpcGxlIG5vZGVzIGhhdmUgdGhlIHNhbWUga2V5LCB0aGUgZHVwbGljYXRlcyBhcmUgYWRkZWQgdG8gZXhpdC5cbiAgZm9yIChpID0gMDsgaSA8IGdyb3VwTGVuZ3RoOyArK2kpIHtcbiAgICBpZiAobm9kZSA9IGdyb3VwW2ldKSB7XG4gICAgICBrZXlWYWx1ZXNbaV0gPSBrZXlWYWx1ZSA9IGtleS5jYWxsKG5vZGUsIG5vZGUuX19kYXRhX18sIGksIGdyb3VwKSArIFwiXCI7XG4gICAgICBpZiAobm9kZUJ5S2V5VmFsdWUuaGFzKGtleVZhbHVlKSkge1xuICAgICAgICBleGl0W2ldID0gbm9kZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG5vZGVCeUtleVZhbHVlLnNldChrZXlWYWx1ZSwgbm9kZSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8gQ29tcHV0ZSB0aGUga2V5IGZvciBlYWNoIGRhdHVtLlxuICAvLyBJZiB0aGVyZSBhIG5vZGUgYXNzb2NpYXRlZCB3aXRoIHRoaXMga2V5LCBqb2luIGFuZCBhZGQgaXQgdG8gdXBkYXRlLlxuICAvLyBJZiB0aGVyZSBpcyBub3QgKG9yIHRoZSBrZXkgaXMgYSBkdXBsaWNhdGUpLCBhZGQgaXQgdG8gZW50ZXIuXG4gIGZvciAoaSA9IDA7IGkgPCBkYXRhTGVuZ3RoOyArK2kpIHtcbiAgICBrZXlWYWx1ZSA9IGtleS5jYWxsKHBhcmVudCwgZGF0YVtpXSwgaSwgZGF0YSkgKyBcIlwiO1xuICAgIGlmIChub2RlID0gbm9kZUJ5S2V5VmFsdWUuZ2V0KGtleVZhbHVlKSkge1xuICAgICAgdXBkYXRlW2ldID0gbm9kZTtcbiAgICAgIG5vZGUuX19kYXRhX18gPSBkYXRhW2ldO1xuICAgICAgbm9kZUJ5S2V5VmFsdWUuZGVsZXRlKGtleVZhbHVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZW50ZXJbaV0gPSBuZXcgRW50ZXJOb2RlKHBhcmVudCwgZGF0YVtpXSk7XG4gICAgfVxuICB9XG5cbiAgLy8gQWRkIGFueSByZW1haW5pbmcgbm9kZXMgdGhhdCB3ZXJlIG5vdCBib3VuZCB0byBkYXRhIHRvIGV4aXQuXG4gIGZvciAoaSA9IDA7IGkgPCBncm91cExlbmd0aDsgKytpKSB7XG4gICAgaWYgKChub2RlID0gZ3JvdXBbaV0pICYmIChub2RlQnlLZXlWYWx1ZS5nZXQoa2V5VmFsdWVzW2ldKSA9PT0gbm9kZSkpIHtcbiAgICAgIGV4aXRbaV0gPSBub2RlO1xuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBkYXR1bShub2RlKSB7XG4gIHJldHVybiBub2RlLl9fZGF0YV9fO1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbih2YWx1ZSwga2V5KSB7XG4gIGlmICghYXJndW1lbnRzLmxlbmd0aCkgcmV0dXJuIEFycmF5LmZyb20odGhpcywgZGF0dW0pO1xuXG4gIHZhciBiaW5kID0ga2V5ID8gYmluZEtleSA6IGJpbmRJbmRleCxcbiAgICAgIHBhcmVudHMgPSB0aGlzLl9wYXJlbnRzLFxuICAgICAgZ3JvdXBzID0gdGhpcy5fZ3JvdXBzO1xuXG4gIGlmICh0eXBlb2YgdmFsdWUgIT09IFwiZnVuY3Rpb25cIikgdmFsdWUgPSBjb25zdGFudCh2YWx1ZSk7XG5cbiAgZm9yICh2YXIgbSA9IGdyb3Vwcy5sZW5ndGgsIHVwZGF0ZSA9IG5ldyBBcnJheShtKSwgZW50ZXIgPSBuZXcgQXJyYXkobSksIGV4aXQgPSBuZXcgQXJyYXkobSksIGogPSAwOyBqIDwgbTsgKytqKSB7XG4gICAgdmFyIHBhcmVudCA9IHBhcmVudHNbal0sXG4gICAgICAgIGdyb3VwID0gZ3JvdXBzW2pdLFxuICAgICAgICBncm91cExlbmd0aCA9IGdyb3VwLmxlbmd0aCxcbiAgICAgICAgZGF0YSA9IGFycmF5bGlrZSh2YWx1ZS5jYWxsKHBhcmVudCwgcGFyZW50ICYmIHBhcmVudC5fX2RhdGFfXywgaiwgcGFyZW50cykpLFxuICAgICAgICBkYXRhTGVuZ3RoID0gZGF0YS5sZW5ndGgsXG4gICAgICAgIGVudGVyR3JvdXAgPSBlbnRlcltqXSA9IG5ldyBBcnJheShkYXRhTGVuZ3RoKSxcbiAgICAgICAgdXBkYXRlR3JvdXAgPSB1cGRhdGVbal0gPSBuZXcgQXJyYXkoZGF0YUxlbmd0aCksXG4gICAgICAgIGV4aXRHcm91cCA9IGV4aXRbal0gPSBuZXcgQXJyYXkoZ3JvdXBMZW5ndGgpO1xuXG4gICAgYmluZChwYXJlbnQsIGdyb3VwLCBlbnRlckdyb3VwLCB1cGRhdGVHcm91cCwgZXhpdEdyb3VwLCBkYXRhLCBrZXkpO1xuXG4gICAgLy8gTm93IGNvbm5lY3QgdGhlIGVudGVyIG5vZGVzIHRvIHRoZWlyIGZvbGxvd2luZyB1cGRhdGUgbm9kZSwgc3VjaCB0aGF0XG4gICAgLy8gYXBwZW5kQ2hpbGQgY2FuIGluc2VydCB0aGUgbWF0ZXJpYWxpemVkIGVudGVyIG5vZGUgYmVmb3JlIHRoaXMgbm9kZSxcbiAgICAvLyByYXRoZXIgdGhhbiBhdCB0aGUgZW5kIG9mIHRoZSBwYXJlbnQgbm9kZS5cbiAgICBmb3IgKHZhciBpMCA9IDAsIGkxID0gMCwgcHJldmlvdXMsIG5leHQ7IGkwIDwgZGF0YUxlbmd0aDsgKytpMCkge1xuICAgICAgaWYgKHByZXZpb3VzID0gZW50ZXJHcm91cFtpMF0pIHtcbiAgICAgICAgaWYgKGkwID49IGkxKSBpMSA9IGkwICsgMTtcbiAgICAgICAgd2hpbGUgKCEobmV4dCA9IHVwZGF0ZUdyb3VwW2kxXSkgJiYgKytpMSA8IGRhdGFMZW5ndGgpO1xuICAgICAgICBwcmV2aW91cy5fbmV4dCA9IG5leHQgfHwgbnVsbDtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICB1cGRhdGUgPSBuZXcgU2VsZWN0aW9uKHVwZGF0ZSwgcGFyZW50cyk7XG4gIHVwZGF0ZS5fZW50ZXIgPSBlbnRlcjtcbiAgdXBkYXRlLl9leGl0ID0gZXhpdDtcbiAgcmV0dXJuIHVwZGF0ZTtcbn1cblxuLy8gR2l2ZW4gc29tZSBkYXRhLCB0aGlzIHJldHVybnMgYW4gYXJyYXktbGlrZSB2aWV3IG9mIGl0OiBhbiBvYmplY3QgdGhhdFxuLy8gZXhwb3NlcyBhIGxlbmd0aCBwcm9wZXJ0eSBhbmQgYWxsb3dzIG51bWVyaWMgaW5kZXhpbmcuIE5vdGUgdGhhdCB1bmxpa2Vcbi8vIHNlbGVjdEFsbCwgdGhpcyBpc27igJl0IHdvcnJpZWQgYWJvdXQg4oCcbGl2ZeKAnSBjb2xsZWN0aW9ucyBiZWNhdXNlIHRoZSByZXN1bHRpbmdcbi8vIGFycmF5IHdpbGwgb25seSBiZSB1c2VkIGJyaWVmbHkgd2hpbGUgZGF0YSBpcyBiZWluZyBib3VuZC4gKEl0IGlzIHBvc3NpYmxlIHRvXG4vLyBjYXVzZSB0aGUgZGF0YSB0byBjaGFuZ2Ugd2hpbGUgaXRlcmF0aW5nIGJ5IHVzaW5nIGEga2V5IGZ1bmN0aW9uLCBidXQgcGxlYXNlXG4vLyBkb27igJl0OyB3ZeKAmWQgcmF0aGVyIGF2b2lkIGEgZ3JhdHVpdG91cyBjb3B5LilcbmZ1bmN0aW9uIGFycmF5bGlrZShkYXRhKSB7XG4gIHJldHVybiB0eXBlb2YgZGF0YSA9PT0gXCJvYmplY3RcIiAmJiBcImxlbmd0aFwiIGluIGRhdGFcbiAgICA/IGRhdGEgLy8gQXJyYXksIFR5cGVkQXJyYXksIE5vZGVMaXN0LCBhcnJheS1saWtlXG4gICAgOiBBcnJheS5mcm9tKGRhdGEpOyAvLyBNYXAsIFNldCwgaXRlcmFibGUsIHN0cmluZywgb3IgYW55dGhpbmcgZWxzZVxufVxuIiwiaW1wb3J0IHtTZWxlY3Rpb259IGZyb20gXCIuL2luZGV4LmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKGNvbXBhcmUpIHtcbiAgaWYgKCFjb21wYXJlKSBjb21wYXJlID0gYXNjZW5kaW5nO1xuXG4gIGZ1bmN0aW9uIGNvbXBhcmVOb2RlKGEsIGIpIHtcbiAgICByZXR1cm4gYSAmJiBiID8gY29tcGFyZShhLl9fZGF0YV9fLCBiLl9fZGF0YV9fKSA6ICFhIC0gIWI7XG4gIH1cblxuICBmb3IgKHZhciBncm91cHMgPSB0aGlzLl9ncm91cHMsIG0gPSBncm91cHMubGVuZ3RoLCBzb3J0Z3JvdXBzID0gbmV3IEFycmF5KG0pLCBqID0gMDsgaiA8IG07ICsraikge1xuICAgIGZvciAodmFyIGdyb3VwID0gZ3JvdXBzW2pdLCBuID0gZ3JvdXAubGVuZ3RoLCBzb3J0Z3JvdXAgPSBzb3J0Z3JvdXBzW2pdID0gbmV3IEFycmF5KG4pLCBub2RlLCBpID0gMDsgaSA8IG47ICsraSkge1xuICAgICAgaWYgKG5vZGUgPSBncm91cFtpXSkge1xuICAgICAgICBzb3J0Z3JvdXBbaV0gPSBub2RlO1xuICAgICAgfVxuICAgIH1cbiAgICBzb3J0Z3JvdXAuc29ydChjb21wYXJlTm9kZSk7XG4gIH1cblxuICByZXR1cm4gbmV3IFNlbGVjdGlvbihzb3J0Z3JvdXBzLCB0aGlzLl9wYXJlbnRzKS5vcmRlcigpO1xufVxuXG5mdW5jdGlvbiBhc2NlbmRpbmcoYSwgYikge1xuICByZXR1cm4gYSA8IGIgPyAtMSA6IGEgPiBiID8gMSA6IGEgPj0gYiA/IDAgOiBOYU47XG59XG4iLCJpbXBvcnQgbmFtZXNwYWNlIGZyb20gXCIuLi9uYW1lc3BhY2UuanNcIjtcblxuZnVuY3Rpb24gYXR0clJlbW92ZShuYW1lKSB7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLnJlbW92ZUF0dHJpYnV0ZShuYW1lKTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gYXR0clJlbW92ZU5TKGZ1bGxuYW1lKSB7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLnJlbW92ZUF0dHJpYnV0ZU5TKGZ1bGxuYW1lLnNwYWNlLCBmdWxsbmFtZS5sb2NhbCk7XG4gIH07XG59XG5cbmZ1bmN0aW9uIGF0dHJDb25zdGFudChuYW1lLCB2YWx1ZSkge1xuICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5zZXRBdHRyaWJ1dGUobmFtZSwgdmFsdWUpO1xuICB9O1xufVxuXG5mdW5jdGlvbiBhdHRyQ29uc3RhbnROUyhmdWxsbmFtZSwgdmFsdWUpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuc2V0QXR0cmlidXRlTlMoZnVsbG5hbWUuc3BhY2UsIGZ1bGxuYW1lLmxvY2FsLCB2YWx1ZSk7XG4gIH07XG59XG5cbmZ1bmN0aW9uIGF0dHJGdW5jdGlvbihuYW1lLCB2YWx1ZSkge1xuICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHYgPSB2YWx1ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIGlmICh2ID09IG51bGwpIHRoaXMucmVtb3ZlQXR0cmlidXRlKG5hbWUpO1xuICAgIGVsc2UgdGhpcy5zZXRBdHRyaWJ1dGUobmFtZSwgdik7XG4gIH07XG59XG5cbmZ1bmN0aW9uIGF0dHJGdW5jdGlvbk5TKGZ1bGxuYW1lLCB2YWx1ZSkge1xuICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHYgPSB2YWx1ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIGlmICh2ID09IG51bGwpIHRoaXMucmVtb3ZlQXR0cmlidXRlTlMoZnVsbG5hbWUuc3BhY2UsIGZ1bGxuYW1lLmxvY2FsKTtcbiAgICBlbHNlIHRoaXMuc2V0QXR0cmlidXRlTlMoZnVsbG5hbWUuc3BhY2UsIGZ1bGxuYW1lLmxvY2FsLCB2KTtcbiAgfTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24obmFtZSwgdmFsdWUpIHtcbiAgdmFyIGZ1bGxuYW1lID0gbmFtZXNwYWNlKG5hbWUpO1xuXG4gIGlmIChhcmd1bWVudHMubGVuZ3RoIDwgMikge1xuICAgIHZhciBub2RlID0gdGhpcy5ub2RlKCk7XG4gICAgcmV0dXJuIGZ1bGxuYW1lLmxvY2FsXG4gICAgICAgID8gbm9kZS5nZXRBdHRyaWJ1dGVOUyhmdWxsbmFtZS5zcGFjZSwgZnVsbG5hbWUubG9jYWwpXG4gICAgICAgIDogbm9kZS5nZXRBdHRyaWJ1dGUoZnVsbG5hbWUpO1xuICB9XG5cbiAgcmV0dXJuIHRoaXMuZWFjaCgodmFsdWUgPT0gbnVsbFxuICAgICAgPyAoZnVsbG5hbWUubG9jYWwgPyBhdHRyUmVtb3ZlTlMgOiBhdHRyUmVtb3ZlKSA6ICh0eXBlb2YgdmFsdWUgPT09IFwiZnVuY3Rpb25cIlxuICAgICAgPyAoZnVsbG5hbWUubG9jYWwgPyBhdHRyRnVuY3Rpb25OUyA6IGF0dHJGdW5jdGlvbilcbiAgICAgIDogKGZ1bGxuYW1lLmxvY2FsID8gYXR0ckNvbnN0YW50TlMgOiBhdHRyQ29uc3RhbnQpKSkoZnVsbG5hbWUsIHZhbHVlKSk7XG59XG4iLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbihub2RlKSB7XG4gIHJldHVybiAobm9kZS5vd25lckRvY3VtZW50ICYmIG5vZGUub3duZXJEb2N1bWVudC5kZWZhdWx0VmlldykgLy8gbm9kZSBpcyBhIE5vZGVcbiAgICAgIHx8IChub2RlLmRvY3VtZW50ICYmIG5vZGUpIC8vIG5vZGUgaXMgYSBXaW5kb3dcbiAgICAgIHx8IG5vZGUuZGVmYXVsdFZpZXc7IC8vIG5vZGUgaXMgYSBEb2N1bWVudFxufVxuIiwiaW1wb3J0IGRlZmF1bHRWaWV3IGZyb20gXCIuLi93aW5kb3cuanNcIjtcblxuZnVuY3Rpb24gc3R5bGVSZW1vdmUobmFtZSkge1xuICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5zdHlsZS5yZW1vdmVQcm9wZXJ0eShuYW1lKTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gc3R5bGVDb25zdGFudChuYW1lLCB2YWx1ZSwgcHJpb3JpdHkpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuc3R5bGUuc2V0UHJvcGVydHkobmFtZSwgdmFsdWUsIHByaW9yaXR5KTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gc3R5bGVGdW5jdGlvbihuYW1lLCB2YWx1ZSwgcHJpb3JpdHkpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHZhciB2ID0gdmFsdWUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICBpZiAodiA9PSBudWxsKSB0aGlzLnN0eWxlLnJlbW92ZVByb3BlcnR5KG5hbWUpO1xuICAgIGVsc2UgdGhpcy5zdHlsZS5zZXRQcm9wZXJ0eShuYW1lLCB2LCBwcmlvcml0eSk7XG4gIH07XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKG5hbWUsIHZhbHVlLCBwcmlvcml0eSkge1xuICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA+IDFcbiAgICAgID8gdGhpcy5lYWNoKCh2YWx1ZSA9PSBudWxsXG4gICAgICAgICAgICA/IHN0eWxlUmVtb3ZlIDogdHlwZW9mIHZhbHVlID09PSBcImZ1bmN0aW9uXCJcbiAgICAgICAgICAgID8gc3R5bGVGdW5jdGlvblxuICAgICAgICAgICAgOiBzdHlsZUNvbnN0YW50KShuYW1lLCB2YWx1ZSwgcHJpb3JpdHkgPT0gbnVsbCA/IFwiXCIgOiBwcmlvcml0eSkpXG4gICAgICA6IHN0eWxlVmFsdWUodGhpcy5ub2RlKCksIG5hbWUpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc3R5bGVWYWx1ZShub2RlLCBuYW1lKSB7XG4gIHJldHVybiBub2RlLnN0eWxlLmdldFByb3BlcnR5VmFsdWUobmFtZSlcbiAgICAgIHx8IGRlZmF1bHRWaWV3KG5vZGUpLmdldENvbXB1dGVkU3R5bGUobm9kZSwgbnVsbCkuZ2V0UHJvcGVydHlWYWx1ZShuYW1lKTtcbn1cbiIsImZ1bmN0aW9uIHByb3BlcnR5UmVtb3ZlKG5hbWUpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIGRlbGV0ZSB0aGlzW25hbWVdO1xuICB9O1xufVxuXG5mdW5jdGlvbiBwcm9wZXJ0eUNvbnN0YW50KG5hbWUsIHZhbHVlKSB7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICB0aGlzW25hbWVdID0gdmFsdWU7XG4gIH07XG59XG5cbmZ1bmN0aW9uIHByb3BlcnR5RnVuY3Rpb24obmFtZSwgdmFsdWUpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHZhciB2ID0gdmFsdWUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICBpZiAodiA9PSBudWxsKSBkZWxldGUgdGhpc1tuYW1lXTtcbiAgICBlbHNlIHRoaXNbbmFtZV0gPSB2O1xuICB9O1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbihuYW1lLCB2YWx1ZSkge1xuICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA+IDFcbiAgICAgID8gdGhpcy5lYWNoKCh2YWx1ZSA9PSBudWxsXG4gICAgICAgICAgPyBwcm9wZXJ0eVJlbW92ZSA6IHR5cGVvZiB2YWx1ZSA9PT0gXCJmdW5jdGlvblwiXG4gICAgICAgICAgPyBwcm9wZXJ0eUZ1bmN0aW9uXG4gICAgICAgICAgOiBwcm9wZXJ0eUNvbnN0YW50KShuYW1lLCB2YWx1ZSkpXG4gICAgICA6IHRoaXMubm9kZSgpW25hbWVdO1xufVxuIiwiZnVuY3Rpb24gY2xhc3NBcnJheShzdHJpbmcpIHtcbiAgcmV0dXJuIHN0cmluZy50cmltKCkuc3BsaXQoL158XFxzKy8pO1xufVxuXG5mdW5jdGlvbiBjbGFzc0xpc3Qobm9kZSkge1xuICByZXR1cm4gbm9kZS5jbGFzc0xpc3QgfHwgbmV3IENsYXNzTGlzdChub2RlKTtcbn1cblxuZnVuY3Rpb24gQ2xhc3NMaXN0KG5vZGUpIHtcbiAgdGhpcy5fbm9kZSA9IG5vZGU7XG4gIHRoaXMuX25hbWVzID0gY2xhc3NBcnJheShub2RlLmdldEF0dHJpYnV0ZShcImNsYXNzXCIpIHx8IFwiXCIpO1xufVxuXG5DbGFzc0xpc3QucHJvdG90eXBlID0ge1xuICBhZGQ6IGZ1bmN0aW9uKG5hbWUpIHtcbiAgICB2YXIgaSA9IHRoaXMuX25hbWVzLmluZGV4T2YobmFtZSk7XG4gICAgaWYgKGkgPCAwKSB7XG4gICAgICB0aGlzLl9uYW1lcy5wdXNoKG5hbWUpO1xuICAgICAgdGhpcy5fbm9kZS5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCB0aGlzLl9uYW1lcy5qb2luKFwiIFwiKSk7XG4gICAgfVxuICB9LFxuICByZW1vdmU6IGZ1bmN0aW9uKG5hbWUpIHtcbiAgICB2YXIgaSA9IHRoaXMuX25hbWVzLmluZGV4T2YobmFtZSk7XG4gICAgaWYgKGkgPj0gMCkge1xuICAgICAgdGhpcy5fbmFtZXMuc3BsaWNlKGksIDEpO1xuICAgICAgdGhpcy5fbm9kZS5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCB0aGlzLl9uYW1lcy5qb2luKFwiIFwiKSk7XG4gICAgfVxuICB9LFxuICBjb250YWluczogZnVuY3Rpb24obmFtZSkge1xuICAgIHJldHVybiB0aGlzLl9uYW1lcy5pbmRleE9mKG5hbWUpID49IDA7XG4gIH1cbn07XG5cbmZ1bmN0aW9uIGNsYXNzZWRBZGQobm9kZSwgbmFtZXMpIHtcbiAgdmFyIGxpc3QgPSBjbGFzc0xpc3Qobm9kZSksIGkgPSAtMSwgbiA9IG5hbWVzLmxlbmd0aDtcbiAgd2hpbGUgKCsraSA8IG4pIGxpc3QuYWRkKG5hbWVzW2ldKTtcbn1cblxuZnVuY3Rpb24gY2xhc3NlZFJlbW92ZShub2RlLCBuYW1lcykge1xuICB2YXIgbGlzdCA9IGNsYXNzTGlzdChub2RlKSwgaSA9IC0xLCBuID0gbmFtZXMubGVuZ3RoO1xuICB3aGlsZSAoKytpIDwgbikgbGlzdC5yZW1vdmUobmFtZXNbaV0pO1xufVxuXG5mdW5jdGlvbiBjbGFzc2VkVHJ1ZShuYW1lcykge1xuICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgY2xhc3NlZEFkZCh0aGlzLCBuYW1lcyk7XG4gIH07XG59XG5cbmZ1bmN0aW9uIGNsYXNzZWRGYWxzZShuYW1lcykge1xuICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgY2xhc3NlZFJlbW92ZSh0aGlzLCBuYW1lcyk7XG4gIH07XG59XG5cbmZ1bmN0aW9uIGNsYXNzZWRGdW5jdGlvbihuYW1lcywgdmFsdWUpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICh2YWx1ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpID8gY2xhc3NlZEFkZCA6IGNsYXNzZWRSZW1vdmUpKHRoaXMsIG5hbWVzKTtcbiAgfTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24obmFtZSwgdmFsdWUpIHtcbiAgdmFyIG5hbWVzID0gY2xhc3NBcnJheShuYW1lICsgXCJcIik7XG5cbiAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPCAyKSB7XG4gICAgdmFyIGxpc3QgPSBjbGFzc0xpc3QodGhpcy5ub2RlKCkpLCBpID0gLTEsIG4gPSBuYW1lcy5sZW5ndGg7XG4gICAgd2hpbGUgKCsraSA8IG4pIGlmICghbGlzdC5jb250YWlucyhuYW1lc1tpXSkpIHJldHVybiBmYWxzZTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIHJldHVybiB0aGlzLmVhY2goKHR5cGVvZiB2YWx1ZSA9PT0gXCJmdW5jdGlvblwiXG4gICAgICA/IGNsYXNzZWRGdW5jdGlvbiA6IHZhbHVlXG4gICAgICA/IGNsYXNzZWRUcnVlXG4gICAgICA6IGNsYXNzZWRGYWxzZSkobmFtZXMsIHZhbHVlKSk7XG59XG4iLCJmdW5jdGlvbiB0ZXh0UmVtb3ZlKCkge1xuICB0aGlzLnRleHRDb250ZW50ID0gXCJcIjtcbn1cblxuZnVuY3Rpb24gdGV4dENvbnN0YW50KHZhbHVlKSB7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLnRleHRDb250ZW50ID0gdmFsdWU7XG4gIH07XG59XG5cbmZ1bmN0aW9uIHRleHRGdW5jdGlvbih2YWx1ZSkge1xuICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHYgPSB2YWx1ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIHRoaXMudGV4dENvbnRlbnQgPSB2ID09IG51bGwgPyBcIlwiIDogdjtcbiAgfTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24odmFsdWUpIHtcbiAgcmV0dXJuIGFyZ3VtZW50cy5sZW5ndGhcbiAgICAgID8gdGhpcy5lYWNoKHZhbHVlID09IG51bGxcbiAgICAgICAgICA/IHRleHRSZW1vdmUgOiAodHlwZW9mIHZhbHVlID09PSBcImZ1bmN0aW9uXCJcbiAgICAgICAgICA/IHRleHRGdW5jdGlvblxuICAgICAgICAgIDogdGV4dENvbnN0YW50KSh2YWx1ZSkpXG4gICAgICA6IHRoaXMubm9kZSgpLnRleHRDb250ZW50O1xufVxuIiwiZnVuY3Rpb24gaHRtbFJlbW92ZSgpIHtcbiAgdGhpcy5pbm5lckhUTUwgPSBcIlwiO1xufVxuXG5mdW5jdGlvbiBodG1sQ29uc3RhbnQodmFsdWUpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5uZXJIVE1MID0gdmFsdWU7XG4gIH07XG59XG5cbmZ1bmN0aW9uIGh0bWxGdW5jdGlvbih2YWx1ZSkge1xuICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHYgPSB2YWx1ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIHRoaXMuaW5uZXJIVE1MID0gdiA9PSBudWxsID8gXCJcIiA6IHY7XG4gIH07XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKHZhbHVlKSB7XG4gIHJldHVybiBhcmd1bWVudHMubGVuZ3RoXG4gICAgICA/IHRoaXMuZWFjaCh2YWx1ZSA9PSBudWxsXG4gICAgICAgICAgPyBodG1sUmVtb3ZlIDogKHR5cGVvZiB2YWx1ZSA9PT0gXCJmdW5jdGlvblwiXG4gICAgICAgICAgPyBodG1sRnVuY3Rpb25cbiAgICAgICAgICA6IGh0bWxDb25zdGFudCkodmFsdWUpKVxuICAgICAgOiB0aGlzLm5vZGUoKS5pbm5lckhUTUw7XG59XG4iLCJmdW5jdGlvbiByYWlzZSgpIHtcbiAgaWYgKHRoaXMubmV4dFNpYmxpbmcpIHRoaXMucGFyZW50Tm9kZS5hcHBlbmRDaGlsZCh0aGlzKTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24oKSB7XG4gIHJldHVybiB0aGlzLmVhY2gocmFpc2UpO1xufVxuIiwiZnVuY3Rpb24gbG93ZXIoKSB7XG4gIGlmICh0aGlzLnByZXZpb3VzU2libGluZykgdGhpcy5wYXJlbnROb2RlLmluc2VydEJlZm9yZSh0aGlzLCB0aGlzLnBhcmVudE5vZGUuZmlyc3RDaGlsZCk7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gdGhpcy5lYWNoKGxvd2VyKTtcbn1cbiIsImltcG9ydCBjcmVhdG9yIGZyb20gXCIuLi9jcmVhdG9yLmpzXCI7XG5pbXBvcnQgc2VsZWN0b3IgZnJvbSBcIi4uL3NlbGVjdG9yLmpzXCI7XG5cbmZ1bmN0aW9uIGNvbnN0YW50TnVsbCgpIHtcbiAgcmV0dXJuIG51bGw7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKG5hbWUsIGJlZm9yZSkge1xuICB2YXIgY3JlYXRlID0gdHlwZW9mIG5hbWUgPT09IFwiZnVuY3Rpb25cIiA/IG5hbWUgOiBjcmVhdG9yKG5hbWUpLFxuICAgICAgc2VsZWN0ID0gYmVmb3JlID09IG51bGwgPyBjb25zdGFudE51bGwgOiB0eXBlb2YgYmVmb3JlID09PSBcImZ1bmN0aW9uXCIgPyBiZWZvcmUgOiBzZWxlY3RvcihiZWZvcmUpO1xuICByZXR1cm4gdGhpcy5zZWxlY3QoZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuaW5zZXJ0QmVmb3JlKGNyZWF0ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpLCBzZWxlY3QuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCBudWxsKTtcbiAgfSk7XG59XG4iLCJmdW5jdGlvbiByZW1vdmUoKSB7XG4gIHZhciBwYXJlbnQgPSB0aGlzLnBhcmVudE5vZGU7XG4gIGlmIChwYXJlbnQpIHBhcmVudC5yZW1vdmVDaGlsZCh0aGlzKTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24oKSB7XG4gIHJldHVybiB0aGlzLmVhY2gocmVtb3ZlKTtcbn1cbiIsImZ1bmN0aW9uIHNlbGVjdGlvbl9jbG9uZVNoYWxsb3coKSB7XG4gIHZhciBjbG9uZSA9IHRoaXMuY2xvbmVOb2RlKGZhbHNlKSwgcGFyZW50ID0gdGhpcy5wYXJlbnROb2RlO1xuICByZXR1cm4gcGFyZW50ID8gcGFyZW50Lmluc2VydEJlZm9yZShjbG9uZSwgdGhpcy5uZXh0U2libGluZykgOiBjbG9uZTtcbn1cblxuZnVuY3Rpb24gc2VsZWN0aW9uX2Nsb25lRGVlcCgpIHtcbiAgdmFyIGNsb25lID0gdGhpcy5jbG9uZU5vZGUodHJ1ZSksIHBhcmVudCA9IHRoaXMucGFyZW50Tm9kZTtcbiAgcmV0dXJuIHBhcmVudCA/IHBhcmVudC5pbnNlcnRCZWZvcmUoY2xvbmUsIHRoaXMubmV4dFNpYmxpbmcpIDogY2xvbmU7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKGRlZXApIHtcbiAgcmV0dXJuIHRoaXMuc2VsZWN0KGRlZXAgPyBzZWxlY3Rpb25fY2xvbmVEZWVwIDogc2VsZWN0aW9uX2Nsb25lU2hhbGxvdyk7XG59XG4iLCJmdW5jdGlvbiBjb250ZXh0TGlzdGVuZXIobGlzdGVuZXIpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgbGlzdGVuZXIuY2FsbCh0aGlzLCBldmVudCwgdGhpcy5fX2RhdGFfXyk7XG4gIH07XG59XG5cbmZ1bmN0aW9uIHBhcnNlVHlwZW5hbWVzKHR5cGVuYW1lcykge1xuICByZXR1cm4gdHlwZW5hbWVzLnRyaW0oKS5zcGxpdCgvXnxcXHMrLykubWFwKGZ1bmN0aW9uKHQpIHtcbiAgICB2YXIgbmFtZSA9IFwiXCIsIGkgPSB0LmluZGV4T2YoXCIuXCIpO1xuICAgIGlmIChpID49IDApIG5hbWUgPSB0LnNsaWNlKGkgKyAxKSwgdCA9IHQuc2xpY2UoMCwgaSk7XG4gICAgcmV0dXJuIHt0eXBlOiB0LCBuYW1lOiBuYW1lfTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIG9uUmVtb3ZlKHR5cGVuYW1lKSB7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICB2YXIgb24gPSB0aGlzLl9fb247XG4gICAgaWYgKCFvbikgcmV0dXJuO1xuICAgIGZvciAodmFyIGogPSAwLCBpID0gLTEsIG0gPSBvbi5sZW5ndGgsIG87IGogPCBtOyArK2opIHtcbiAgICAgIGlmIChvID0gb25bal0sICghdHlwZW5hbWUudHlwZSB8fCBvLnR5cGUgPT09IHR5cGVuYW1lLnR5cGUpICYmIG8ubmFtZSA9PT0gdHlwZW5hbWUubmFtZSkge1xuICAgICAgICB0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoby50eXBlLCBvLmxpc3RlbmVyLCBvLm9wdGlvbnMpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgb25bKytpXSA9IG87XG4gICAgICB9XG4gICAgfVxuICAgIGlmICgrK2kpIG9uLmxlbmd0aCA9IGk7XG4gICAgZWxzZSBkZWxldGUgdGhpcy5fX29uO1xuICB9O1xufVxuXG5mdW5jdGlvbiBvbkFkZCh0eXBlbmFtZSwgdmFsdWUsIG9wdGlvbnMpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHZhciBvbiA9IHRoaXMuX19vbiwgbywgbGlzdGVuZXIgPSBjb250ZXh0TGlzdGVuZXIodmFsdWUpO1xuICAgIGlmIChvbikgZm9yICh2YXIgaiA9IDAsIG0gPSBvbi5sZW5ndGg7IGogPCBtOyArK2opIHtcbiAgICAgIGlmICgobyA9IG9uW2pdKS50eXBlID09PSB0eXBlbmFtZS50eXBlICYmIG8ubmFtZSA9PT0gdHlwZW5hbWUubmFtZSkge1xuICAgICAgICB0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoby50eXBlLCBvLmxpc3RlbmVyLCBvLm9wdGlvbnMpO1xuICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoby50eXBlLCBvLmxpc3RlbmVyID0gbGlzdGVuZXIsIG8ub3B0aW9ucyA9IG9wdGlvbnMpO1xuICAgICAgICBvLnZhbHVlID0gdmFsdWU7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9XG4gICAgdGhpcy5hZGRFdmVudExpc3RlbmVyKHR5cGVuYW1lLnR5cGUsIGxpc3RlbmVyLCBvcHRpb25zKTtcbiAgICBvID0ge3R5cGU6IHR5cGVuYW1lLnR5cGUsIG5hbWU6IHR5cGVuYW1lLm5hbWUsIHZhbHVlOiB2YWx1ZSwgbGlzdGVuZXI6IGxpc3RlbmVyLCBvcHRpb25zOiBvcHRpb25zfTtcbiAgICBpZiAoIW9uKSB0aGlzLl9fb24gPSBbb107XG4gICAgZWxzZSBvbi5wdXNoKG8pO1xuICB9O1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbih0eXBlbmFtZSwgdmFsdWUsIG9wdGlvbnMpIHtcbiAgdmFyIHR5cGVuYW1lcyA9IHBhcnNlVHlwZW5hbWVzKHR5cGVuYW1lICsgXCJcIiksIGksIG4gPSB0eXBlbmFtZXMubGVuZ3RoLCB0O1xuXG4gIGlmIChhcmd1bWVudHMubGVuZ3RoIDwgMikge1xuICAgIHZhciBvbiA9IHRoaXMubm9kZSgpLl9fb247XG4gICAgaWYgKG9uKSBmb3IgKHZhciBqID0gMCwgbSA9IG9uLmxlbmd0aCwgbzsgaiA8IG07ICsraikge1xuICAgICAgZm9yIChpID0gMCwgbyA9IG9uW2pdOyBpIDwgbjsgKytpKSB7XG4gICAgICAgIGlmICgodCA9IHR5cGVuYW1lc1tpXSkudHlwZSA9PT0gby50eXBlICYmIHQubmFtZSA9PT0gby5uYW1lKSB7XG4gICAgICAgICAgcmV0dXJuIG8udmFsdWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgb24gPSB2YWx1ZSA/IG9uQWRkIDogb25SZW1vdmU7XG4gIGZvciAoaSA9IDA7IGkgPCBuOyArK2kpIHRoaXMuZWFjaChvbih0eXBlbmFtZXNbaV0sIHZhbHVlLCBvcHRpb25zKSk7XG4gIHJldHVybiB0aGlzO1xufVxuIiwiaW1wb3J0IGRlZmF1bHRWaWV3IGZyb20gXCIuLi93aW5kb3cuanNcIjtcblxuZnVuY3Rpb24gZGlzcGF0Y2hFdmVudChub2RlLCB0eXBlLCBwYXJhbXMpIHtcbiAgdmFyIHdpbmRvdyA9IGRlZmF1bHRWaWV3KG5vZGUpLFxuICAgICAgZXZlbnQgPSB3aW5kb3cuQ3VzdG9tRXZlbnQ7XG5cbiAgaWYgKHR5cGVvZiBldmVudCA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgZXZlbnQgPSBuZXcgZXZlbnQodHlwZSwgcGFyYW1zKTtcbiAgfSBlbHNlIHtcbiAgICBldmVudCA9IHdpbmRvdy5kb2N1bWVudC5jcmVhdGVFdmVudChcIkV2ZW50XCIpO1xuICAgIGlmIChwYXJhbXMpIGV2ZW50LmluaXRFdmVudCh0eXBlLCBwYXJhbXMuYnViYmxlcywgcGFyYW1zLmNhbmNlbGFibGUpLCBldmVudC5kZXRhaWwgPSBwYXJhbXMuZGV0YWlsO1xuICAgIGVsc2UgZXZlbnQuaW5pdEV2ZW50KHR5cGUsIGZhbHNlLCBmYWxzZSk7XG4gIH1cblxuICBub2RlLmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xufVxuXG5mdW5jdGlvbiBkaXNwYXRjaENvbnN0YW50KHR5cGUsIHBhcmFtcykge1xuICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIGRpc3BhdGNoRXZlbnQodGhpcywgdHlwZSwgcGFyYW1zKTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gZGlzcGF0Y2hGdW5jdGlvbih0eXBlLCBwYXJhbXMpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBkaXNwYXRjaEV2ZW50KHRoaXMsIHR5cGUsIHBhcmFtcy5hcHBseSh0aGlzLCBhcmd1bWVudHMpKTtcbiAgfTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24odHlwZSwgcGFyYW1zKSB7XG4gIHJldHVybiB0aGlzLmVhY2goKHR5cGVvZiBwYXJhbXMgPT09IFwiZnVuY3Rpb25cIlxuICAgICAgPyBkaXNwYXRjaEZ1bmN0aW9uXG4gICAgICA6IGRpc3BhdGNoQ29uc3RhbnQpKHR5cGUsIHBhcmFtcykpO1xufVxuIiwiaW1wb3J0IHNlbGVjdGlvbl9zZWxlY3QgZnJvbSBcIi4vc2VsZWN0LmpzXCI7XG5pbXBvcnQgc2VsZWN0aW9uX3NlbGVjdEFsbCBmcm9tIFwiLi9zZWxlY3RBbGwuanNcIjtcbmltcG9ydCBzZWxlY3Rpb25fc2VsZWN0Q2hpbGQgZnJvbSBcIi4vc2VsZWN0Q2hpbGQuanNcIjtcbmltcG9ydCBzZWxlY3Rpb25fc2VsZWN0Q2hpbGRyZW4gZnJvbSBcIi4vc2VsZWN0Q2hpbGRyZW4uanNcIjtcbmltcG9ydCBzZWxlY3Rpb25fZmlsdGVyIGZyb20gXCIuL2ZpbHRlci5qc1wiO1xuaW1wb3J0IHNlbGVjdGlvbl9kYXRhIGZyb20gXCIuL2RhdGEuanNcIjtcbmltcG9ydCBzZWxlY3Rpb25fZW50ZXIgZnJvbSBcIi4vZW50ZXIuanNcIjtcbmltcG9ydCBzZWxlY3Rpb25fZXhpdCBmcm9tIFwiLi9leGl0LmpzXCI7XG5pbXBvcnQgc2VsZWN0aW9uX2pvaW4gZnJvbSBcIi4vam9pbi5qc1wiO1xuaW1wb3J0IHNlbGVjdGlvbl9tZXJnZSBmcm9tIFwiLi9tZXJnZS5qc1wiO1xuaW1wb3J0IHNlbGVjdGlvbl9vcmRlciBmcm9tIFwiLi9vcmRlci5qc1wiO1xuaW1wb3J0IHNlbGVjdGlvbl9zb3J0IGZyb20gXCIuL3NvcnQuanNcIjtcbmltcG9ydCBzZWxlY3Rpb25fY2FsbCBmcm9tIFwiLi9jYWxsLmpzXCI7XG5pbXBvcnQgc2VsZWN0aW9uX25vZGVzIGZyb20gXCIuL25vZGVzLmpzXCI7XG5pbXBvcnQgc2VsZWN0aW9uX25vZGUgZnJvbSBcIi4vbm9kZS5qc1wiO1xuaW1wb3J0IHNlbGVjdGlvbl9zaXplIGZyb20gXCIuL3NpemUuanNcIjtcbmltcG9ydCBzZWxlY3Rpb25fZW1wdHkgZnJvbSBcIi4vZW1wdHkuanNcIjtcbmltcG9ydCBzZWxlY3Rpb25fZWFjaCBmcm9tIFwiLi9lYWNoLmpzXCI7XG5pbXBvcnQgc2VsZWN0aW9uX2F0dHIgZnJvbSBcIi4vYXR0ci5qc1wiO1xuaW1wb3J0IHNlbGVjdGlvbl9zdHlsZSBmcm9tIFwiLi9zdHlsZS5qc1wiO1xuaW1wb3J0IHNlbGVjdGlvbl9wcm9wZXJ0eSBmcm9tIFwiLi9wcm9wZXJ0eS5qc1wiO1xuaW1wb3J0IHNlbGVjdGlvbl9jbGFzc2VkIGZyb20gXCIuL2NsYXNzZWQuanNcIjtcbmltcG9ydCBzZWxlY3Rpb25fdGV4dCBmcm9tIFwiLi90ZXh0LmpzXCI7XG5pbXBvcnQgc2VsZWN0aW9uX2h0bWwgZnJvbSBcIi4vaHRtbC5qc1wiO1xuaW1wb3J0IHNlbGVjdGlvbl9yYWlzZSBmcm9tIFwiLi9yYWlzZS5qc1wiO1xuaW1wb3J0IHNlbGVjdGlvbl9sb3dlciBmcm9tIFwiLi9sb3dlci5qc1wiO1xuaW1wb3J0IHNlbGVjdGlvbl9hcHBlbmQgZnJvbSBcIi4vYXBwZW5kLmpzXCI7XG5pbXBvcnQgc2VsZWN0aW9uX2luc2VydCBmcm9tIFwiLi9pbnNlcnQuanNcIjtcbmltcG9ydCBzZWxlY3Rpb25fcmVtb3ZlIGZyb20gXCIuL3JlbW92ZS5qc1wiO1xuaW1wb3J0IHNlbGVjdGlvbl9jbG9uZSBmcm9tIFwiLi9jbG9uZS5qc1wiO1xuaW1wb3J0IHNlbGVjdGlvbl9kYXR1bSBmcm9tIFwiLi9kYXR1bS5qc1wiO1xuaW1wb3J0IHNlbGVjdGlvbl9vbiBmcm9tIFwiLi9vbi5qc1wiO1xuaW1wb3J0IHNlbGVjdGlvbl9kaXNwYXRjaCBmcm9tIFwiLi9kaXNwYXRjaC5qc1wiO1xuaW1wb3J0IHNlbGVjdGlvbl9pdGVyYXRvciBmcm9tIFwiLi9pdGVyYXRvci5qc1wiO1xuXG5leHBvcnQgdmFyIHJvb3QgPSBbbnVsbF07XG5cbmV4cG9ydCBmdW5jdGlvbiBTZWxlY3Rpb24oZ3JvdXBzLCBwYXJlbnRzKSB7XG4gIHRoaXMuX2dyb3VwcyA9IGdyb3VwcztcbiAgdGhpcy5fcGFyZW50cyA9IHBhcmVudHM7XG59XG5cbmZ1bmN0aW9uIHNlbGVjdGlvbigpIHtcbiAgcmV0dXJuIG5ldyBTZWxlY3Rpb24oW1tkb2N1bWVudC5kb2N1bWVudEVsZW1lbnRdXSwgcm9vdCk7XG59XG5cbmZ1bmN0aW9uIHNlbGVjdGlvbl9zZWxlY3Rpb24oKSB7XG4gIHJldHVybiB0aGlzO1xufVxuXG5TZWxlY3Rpb24ucHJvdG90eXBlID0gc2VsZWN0aW9uLnByb3RvdHlwZSA9IHtcbiAgY29uc3RydWN0b3I6IFNlbGVjdGlvbixcbiAgc2VsZWN0OiBzZWxlY3Rpb25fc2VsZWN0LFxuICBzZWxlY3RBbGw6IHNlbGVjdGlvbl9zZWxlY3RBbGwsXG4gIHNlbGVjdENoaWxkOiBzZWxlY3Rpb25fc2VsZWN0Q2hpbGQsXG4gIHNlbGVjdENoaWxkcmVuOiBzZWxlY3Rpb25fc2VsZWN0Q2hpbGRyZW4sXG4gIGZpbHRlcjogc2VsZWN0aW9uX2ZpbHRlcixcbiAgZGF0YTogc2VsZWN0aW9uX2RhdGEsXG4gIGVudGVyOiBzZWxlY3Rpb25fZW50ZXIsXG4gIGV4aXQ6IHNlbGVjdGlvbl9leGl0LFxuICBqb2luOiBzZWxlY3Rpb25fam9pbixcbiAgbWVyZ2U6IHNlbGVjdGlvbl9tZXJnZSxcbiAgc2VsZWN0aW9uOiBzZWxlY3Rpb25fc2VsZWN0aW9uLFxuICBvcmRlcjogc2VsZWN0aW9uX29yZGVyLFxuICBzb3J0OiBzZWxlY3Rpb25fc29ydCxcbiAgY2FsbDogc2VsZWN0aW9uX2NhbGwsXG4gIG5vZGVzOiBzZWxlY3Rpb25fbm9kZXMsXG4gIG5vZGU6IHNlbGVjdGlvbl9ub2RlLFxuICBzaXplOiBzZWxlY3Rpb25fc2l6ZSxcbiAgZW1wdHk6IHNlbGVjdGlvbl9lbXB0eSxcbiAgZWFjaDogc2VsZWN0aW9uX2VhY2gsXG4gIGF0dHI6IHNlbGVjdGlvbl9hdHRyLFxuICBzdHlsZTogc2VsZWN0aW9uX3N0eWxlLFxuICBwcm9wZXJ0eTogc2VsZWN0aW9uX3Byb3BlcnR5LFxuICBjbGFzc2VkOiBzZWxlY3Rpb25fY2xhc3NlZCxcbiAgdGV4dDogc2VsZWN0aW9uX3RleHQsXG4gIGh0bWw6IHNlbGVjdGlvbl9odG1sLFxuICByYWlzZTogc2VsZWN0aW9uX3JhaXNlLFxuICBsb3dlcjogc2VsZWN0aW9uX2xvd2VyLFxuICBhcHBlbmQ6IHNlbGVjdGlvbl9hcHBlbmQsXG4gIGluc2VydDogc2VsZWN0aW9uX2luc2VydCxcbiAgcmVtb3ZlOiBzZWxlY3Rpb25fcmVtb3ZlLFxuICBjbG9uZTogc2VsZWN0aW9uX2Nsb25lLFxuICBkYXR1bTogc2VsZWN0aW9uX2RhdHVtLFxuICBvbjogc2VsZWN0aW9uX29uLFxuICBkaXNwYXRjaDogc2VsZWN0aW9uX2Rpc3BhdGNoLFxuICBbU3ltYm9sLml0ZXJhdG9yXTogc2VsZWN0aW9uX2l0ZXJhdG9yXG59O1xuXG5leHBvcnQgZGVmYXVsdCBzZWxlY3Rpb247XG4iLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbihjb25zdHJ1Y3RvciwgZmFjdG9yeSwgcHJvdG90eXBlKSB7XG4gIGNvbnN0cnVjdG9yLnByb3RvdHlwZSA9IGZhY3RvcnkucHJvdG90eXBlID0gcHJvdG90eXBlO1xuICBwcm90b3R5cGUuY29uc3RydWN0b3IgPSBjb25zdHJ1Y3Rvcjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGV4dGVuZChwYXJlbnQsIGRlZmluaXRpb24pIHtcbiAgdmFyIHByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUocGFyZW50LnByb3RvdHlwZSk7XG4gIGZvciAodmFyIGtleSBpbiBkZWZpbml0aW9uKSBwcm90b3R5cGVba2V5XSA9IGRlZmluaXRpb25ba2V5XTtcbiAgcmV0dXJuIHByb3RvdHlwZTtcbn1cbiIsImltcG9ydCBkZWZpbmUsIHtleHRlbmR9IGZyb20gXCIuL2RlZmluZS5qc1wiO1xuXG5leHBvcnQgZnVuY3Rpb24gQ29sb3IoKSB7fVxuXG5leHBvcnQgdmFyIGRhcmtlciA9IDAuNztcbmV4cG9ydCB2YXIgYnJpZ2h0ZXIgPSAxIC8gZGFya2VyO1xuXG52YXIgcmVJID0gXCJcXFxccyooWystXT9cXFxcZCspXFxcXHMqXCIsXG4gICAgcmVOID0gXCJcXFxccyooWystXT9cXFxcZCpcXFxcLj9cXFxcZCsoPzpbZUVdWystXT9cXFxcZCspPylcXFxccypcIixcbiAgICByZVAgPSBcIlxcXFxzKihbKy1dP1xcXFxkKlxcXFwuP1xcXFxkKyg/OltlRV1bKy1dP1xcXFxkKyk/KSVcXFxccypcIixcbiAgICByZUhleCA9IC9eIyhbMC05YS1mXXszLDh9KSQvLFxuICAgIHJlUmdiSW50ZWdlciA9IG5ldyBSZWdFeHAoXCJecmdiXFxcXChcIiArIFtyZUksIHJlSSwgcmVJXSArIFwiXFxcXCkkXCIpLFxuICAgIHJlUmdiUGVyY2VudCA9IG5ldyBSZWdFeHAoXCJecmdiXFxcXChcIiArIFtyZVAsIHJlUCwgcmVQXSArIFwiXFxcXCkkXCIpLFxuICAgIHJlUmdiYUludGVnZXIgPSBuZXcgUmVnRXhwKFwiXnJnYmFcXFxcKFwiICsgW3JlSSwgcmVJLCByZUksIHJlTl0gKyBcIlxcXFwpJFwiKSxcbiAgICByZVJnYmFQZXJjZW50ID0gbmV3IFJlZ0V4cChcIl5yZ2JhXFxcXChcIiArIFtyZVAsIHJlUCwgcmVQLCByZU5dICsgXCJcXFxcKSRcIiksXG4gICAgcmVIc2xQZXJjZW50ID0gbmV3IFJlZ0V4cChcIl5oc2xcXFxcKFwiICsgW3JlTiwgcmVQLCByZVBdICsgXCJcXFxcKSRcIiksXG4gICAgcmVIc2xhUGVyY2VudCA9IG5ldyBSZWdFeHAoXCJeaHNsYVxcXFwoXCIgKyBbcmVOLCByZVAsIHJlUCwgcmVOXSArIFwiXFxcXCkkXCIpO1xuXG52YXIgbmFtZWQgPSB7XG4gIGFsaWNlYmx1ZTogMHhmMGY4ZmYsXG4gIGFudGlxdWV3aGl0ZTogMHhmYWViZDcsXG4gIGFxdWE6IDB4MDBmZmZmLFxuICBhcXVhbWFyaW5lOiAweDdmZmZkNCxcbiAgYXp1cmU6IDB4ZjBmZmZmLFxuICBiZWlnZTogMHhmNWY1ZGMsXG4gIGJpc3F1ZTogMHhmZmU0YzQsXG4gIGJsYWNrOiAweDAwMDAwMCxcbiAgYmxhbmNoZWRhbG1vbmQ6IDB4ZmZlYmNkLFxuICBibHVlOiAweDAwMDBmZixcbiAgYmx1ZXZpb2xldDogMHg4YTJiZTIsXG4gIGJyb3duOiAweGE1MmEyYSxcbiAgYnVybHl3b29kOiAweGRlYjg4NyxcbiAgY2FkZXRibHVlOiAweDVmOWVhMCxcbiAgY2hhcnRyZXVzZTogMHg3ZmZmMDAsXG4gIGNob2NvbGF0ZTogMHhkMjY5MWUsXG4gIGNvcmFsOiAweGZmN2Y1MCxcbiAgY29ybmZsb3dlcmJsdWU6IDB4NjQ5NWVkLFxuICBjb3Juc2lsazogMHhmZmY4ZGMsXG4gIGNyaW1zb246IDB4ZGMxNDNjLFxuICBjeWFuOiAweDAwZmZmZixcbiAgZGFya2JsdWU6IDB4MDAwMDhiLFxuICBkYXJrY3lhbjogMHgwMDhiOGIsXG4gIGRhcmtnb2xkZW5yb2Q6IDB4Yjg4NjBiLFxuICBkYXJrZ3JheTogMHhhOWE5YTksXG4gIGRhcmtncmVlbjogMHgwMDY0MDAsXG4gIGRhcmtncmV5OiAweGE5YTlhOSxcbiAgZGFya2toYWtpOiAweGJkYjc2YixcbiAgZGFya21hZ2VudGE6IDB4OGIwMDhiLFxuICBkYXJrb2xpdmVncmVlbjogMHg1NTZiMmYsXG4gIGRhcmtvcmFuZ2U6IDB4ZmY4YzAwLFxuICBkYXJrb3JjaGlkOiAweDk5MzJjYyxcbiAgZGFya3JlZDogMHg4YjAwMDAsXG4gIGRhcmtzYWxtb246IDB4ZTk5NjdhLFxuICBkYXJrc2VhZ3JlZW46IDB4OGZiYzhmLFxuICBkYXJrc2xhdGVibHVlOiAweDQ4M2Q4YixcbiAgZGFya3NsYXRlZ3JheTogMHgyZjRmNGYsXG4gIGRhcmtzbGF0ZWdyZXk6IDB4MmY0ZjRmLFxuICBkYXJrdHVycXVvaXNlOiAweDAwY2VkMSxcbiAgZGFya3Zpb2xldDogMHg5NDAwZDMsXG4gIGRlZXBwaW5rOiAweGZmMTQ5MyxcbiAgZGVlcHNreWJsdWU6IDB4MDBiZmZmLFxuICBkaW1ncmF5OiAweDY5Njk2OSxcbiAgZGltZ3JleTogMHg2OTY5NjksXG4gIGRvZGdlcmJsdWU6IDB4MWU5MGZmLFxuICBmaXJlYnJpY2s6IDB4YjIyMjIyLFxuICBmbG9yYWx3aGl0ZTogMHhmZmZhZjAsXG4gIGZvcmVzdGdyZWVuOiAweDIyOGIyMixcbiAgZnVjaHNpYTogMHhmZjAwZmYsXG4gIGdhaW5zYm9ybzogMHhkY2RjZGMsXG4gIGdob3N0d2hpdGU6IDB4ZjhmOGZmLFxuICBnb2xkOiAweGZmZDcwMCxcbiAgZ29sZGVucm9kOiAweGRhYTUyMCxcbiAgZ3JheTogMHg4MDgwODAsXG4gIGdyZWVuOiAweDAwODAwMCxcbiAgZ3JlZW55ZWxsb3c6IDB4YWRmZjJmLFxuICBncmV5OiAweDgwODA4MCxcbiAgaG9uZXlkZXc6IDB4ZjBmZmYwLFxuICBob3RwaW5rOiAweGZmNjliNCxcbiAgaW5kaWFucmVkOiAweGNkNWM1YyxcbiAgaW5kaWdvOiAweDRiMDA4MixcbiAgaXZvcnk6IDB4ZmZmZmYwLFxuICBraGFraTogMHhmMGU2OGMsXG4gIGxhdmVuZGVyOiAweGU2ZTZmYSxcbiAgbGF2ZW5kZXJibHVzaDogMHhmZmYwZjUsXG4gIGxhd25ncmVlbjogMHg3Y2ZjMDAsXG4gIGxlbW9uY2hpZmZvbjogMHhmZmZhY2QsXG4gIGxpZ2h0Ymx1ZTogMHhhZGQ4ZTYsXG4gIGxpZ2h0Y29yYWw6IDB4ZjA4MDgwLFxuICBsaWdodGN5YW46IDB4ZTBmZmZmLFxuICBsaWdodGdvbGRlbnJvZHllbGxvdzogMHhmYWZhZDIsXG4gIGxpZ2h0Z3JheTogMHhkM2QzZDMsXG4gIGxpZ2h0Z3JlZW46IDB4OTBlZTkwLFxuICBsaWdodGdyZXk6IDB4ZDNkM2QzLFxuICBsaWdodHBpbms6IDB4ZmZiNmMxLFxuICBsaWdodHNhbG1vbjogMHhmZmEwN2EsXG4gIGxpZ2h0c2VhZ3JlZW46IDB4MjBiMmFhLFxuICBsaWdodHNreWJsdWU6IDB4ODdjZWZhLFxuICBsaWdodHNsYXRlZ3JheTogMHg3Nzg4OTksXG4gIGxpZ2h0c2xhdGVncmV5OiAweDc3ODg5OSxcbiAgbGlnaHRzdGVlbGJsdWU6IDB4YjBjNGRlLFxuICBsaWdodHllbGxvdzogMHhmZmZmZTAsXG4gIGxpbWU6IDB4MDBmZjAwLFxuICBsaW1lZ3JlZW46IDB4MzJjZDMyLFxuICBsaW5lbjogMHhmYWYwZTYsXG4gIG1hZ2VudGE6IDB4ZmYwMGZmLFxuICBtYXJvb246IDB4ODAwMDAwLFxuICBtZWRpdW1hcXVhbWFyaW5lOiAweDY2Y2RhYSxcbiAgbWVkaXVtYmx1ZTogMHgwMDAwY2QsXG4gIG1lZGl1bW9yY2hpZDogMHhiYTU1ZDMsXG4gIG1lZGl1bXB1cnBsZTogMHg5MzcwZGIsXG4gIG1lZGl1bXNlYWdyZWVuOiAweDNjYjM3MSxcbiAgbWVkaXVtc2xhdGVibHVlOiAweDdiNjhlZSxcbiAgbWVkaXVtc3ByaW5nZ3JlZW46IDB4MDBmYTlhLFxuICBtZWRpdW10dXJxdW9pc2U6IDB4NDhkMWNjLFxuICBtZWRpdW12aW9sZXRyZWQ6IDB4YzcxNTg1LFxuICBtaWRuaWdodGJsdWU6IDB4MTkxOTcwLFxuICBtaW50Y3JlYW06IDB4ZjVmZmZhLFxuICBtaXN0eXJvc2U6IDB4ZmZlNGUxLFxuICBtb2NjYXNpbjogMHhmZmU0YjUsXG4gIG5hdmFqb3doaXRlOiAweGZmZGVhZCxcbiAgbmF2eTogMHgwMDAwODAsXG4gIG9sZGxhY2U6IDB4ZmRmNWU2LFxuICBvbGl2ZTogMHg4MDgwMDAsXG4gIG9saXZlZHJhYjogMHg2YjhlMjMsXG4gIG9yYW5nZTogMHhmZmE1MDAsXG4gIG9yYW5nZXJlZDogMHhmZjQ1MDAsXG4gIG9yY2hpZDogMHhkYTcwZDYsXG4gIHBhbGVnb2xkZW5yb2Q6IDB4ZWVlOGFhLFxuICBwYWxlZ3JlZW46IDB4OThmYjk4LFxuICBwYWxldHVycXVvaXNlOiAweGFmZWVlZSxcbiAgcGFsZXZpb2xldHJlZDogMHhkYjcwOTMsXG4gIHBhcGF5YXdoaXA6IDB4ZmZlZmQ1LFxuICBwZWFjaHB1ZmY6IDB4ZmZkYWI5LFxuICBwZXJ1OiAweGNkODUzZixcbiAgcGluazogMHhmZmMwY2IsXG4gIHBsdW06IDB4ZGRhMGRkLFxuICBwb3dkZXJibHVlOiAweGIwZTBlNixcbiAgcHVycGxlOiAweDgwMDA4MCxcbiAgcmViZWNjYXB1cnBsZTogMHg2NjMzOTksXG4gIHJlZDogMHhmZjAwMDAsXG4gIHJvc3licm93bjogMHhiYzhmOGYsXG4gIHJveWFsYmx1ZTogMHg0MTY5ZTEsXG4gIHNhZGRsZWJyb3duOiAweDhiNDUxMyxcbiAgc2FsbW9uOiAweGZhODA3MixcbiAgc2FuZHlicm93bjogMHhmNGE0NjAsXG4gIHNlYWdyZWVuOiAweDJlOGI1NyxcbiAgc2Vhc2hlbGw6IDB4ZmZmNWVlLFxuICBzaWVubmE6IDB4YTA1MjJkLFxuICBzaWx2ZXI6IDB4YzBjMGMwLFxuICBza3libHVlOiAweDg3Y2VlYixcbiAgc2xhdGVibHVlOiAweDZhNWFjZCxcbiAgc2xhdGVncmF5OiAweDcwODA5MCxcbiAgc2xhdGVncmV5OiAweDcwODA5MCxcbiAgc25vdzogMHhmZmZhZmEsXG4gIHNwcmluZ2dyZWVuOiAweDAwZmY3ZixcbiAgc3RlZWxibHVlOiAweDQ2ODJiNCxcbiAgdGFuOiAweGQyYjQ4YyxcbiAgdGVhbDogMHgwMDgwODAsXG4gIHRoaXN0bGU6IDB4ZDhiZmQ4LFxuICB0b21hdG86IDB4ZmY2MzQ3LFxuICB0dXJxdW9pc2U6IDB4NDBlMGQwLFxuICB2aW9sZXQ6IDB4ZWU4MmVlLFxuICB3aGVhdDogMHhmNWRlYjMsXG4gIHdoaXRlOiAweGZmZmZmZixcbiAgd2hpdGVzbW9rZTogMHhmNWY1ZjUsXG4gIHllbGxvdzogMHhmZmZmMDAsXG4gIHllbGxvd2dyZWVuOiAweDlhY2QzMlxufTtcblxuZGVmaW5lKENvbG9yLCBjb2xvciwge1xuICBjb3B5OiBmdW5jdGlvbihjaGFubmVscykge1xuICAgIHJldHVybiBPYmplY3QuYXNzaWduKG5ldyB0aGlzLmNvbnN0cnVjdG9yLCB0aGlzLCBjaGFubmVscyk7XG4gIH0sXG4gIGRpc3BsYXlhYmxlOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5yZ2IoKS5kaXNwbGF5YWJsZSgpO1xuICB9LFxuICBoZXg6IGNvbG9yX2Zvcm1hdEhleCwgLy8gRGVwcmVjYXRlZCEgVXNlIGNvbG9yLmZvcm1hdEhleC5cbiAgZm9ybWF0SGV4OiBjb2xvcl9mb3JtYXRIZXgsXG4gIGZvcm1hdEhzbDogY29sb3JfZm9ybWF0SHNsLFxuICBmb3JtYXRSZ2I6IGNvbG9yX2Zvcm1hdFJnYixcbiAgdG9TdHJpbmc6IGNvbG9yX2Zvcm1hdFJnYlxufSk7XG5cbmZ1bmN0aW9uIGNvbG9yX2Zvcm1hdEhleCgpIHtcbiAgcmV0dXJuIHRoaXMucmdiKCkuZm9ybWF0SGV4KCk7XG59XG5cbmZ1bmN0aW9uIGNvbG9yX2Zvcm1hdEhzbCgpIHtcbiAgcmV0dXJuIGhzbENvbnZlcnQodGhpcykuZm9ybWF0SHNsKCk7XG59XG5cbmZ1bmN0aW9uIGNvbG9yX2Zvcm1hdFJnYigpIHtcbiAgcmV0dXJuIHRoaXMucmdiKCkuZm9ybWF0UmdiKCk7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGNvbG9yKGZvcm1hdCkge1xuICB2YXIgbSwgbDtcbiAgZm9ybWF0ID0gKGZvcm1hdCArIFwiXCIpLnRyaW0oKS50b0xvd2VyQ2FzZSgpO1xuICByZXR1cm4gKG0gPSByZUhleC5leGVjKGZvcm1hdCkpID8gKGwgPSBtWzFdLmxlbmd0aCwgbSA9IHBhcnNlSW50KG1bMV0sIDE2KSwgbCA9PT0gNiA/IHJnYm4obSkgLy8gI2ZmMDAwMFxuICAgICAgOiBsID09PSAzID8gbmV3IFJnYigobSA+PiA4ICYgMHhmKSB8IChtID4+IDQgJiAweGYwKSwgKG0gPj4gNCAmIDB4ZikgfCAobSAmIDB4ZjApLCAoKG0gJiAweGYpIDw8IDQpIHwgKG0gJiAweGYpLCAxKSAvLyAjZjAwXG4gICAgICA6IGwgPT09IDggPyByZ2JhKG0gPj4gMjQgJiAweGZmLCBtID4+IDE2ICYgMHhmZiwgbSA+PiA4ICYgMHhmZiwgKG0gJiAweGZmKSAvIDB4ZmYpIC8vICNmZjAwMDAwMFxuICAgICAgOiBsID09PSA0ID8gcmdiYSgobSA+PiAxMiAmIDB4ZikgfCAobSA+PiA4ICYgMHhmMCksIChtID4+IDggJiAweGYpIHwgKG0gPj4gNCAmIDB4ZjApLCAobSA+PiA0ICYgMHhmKSB8IChtICYgMHhmMCksICgoKG0gJiAweGYpIDw8IDQpIHwgKG0gJiAweGYpKSAvIDB4ZmYpIC8vICNmMDAwXG4gICAgICA6IG51bGwpIC8vIGludmFsaWQgaGV4XG4gICAgICA6IChtID0gcmVSZ2JJbnRlZ2VyLmV4ZWMoZm9ybWF0KSkgPyBuZXcgUmdiKG1bMV0sIG1bMl0sIG1bM10sIDEpIC8vIHJnYigyNTUsIDAsIDApXG4gICAgICA6IChtID0gcmVSZ2JQZXJjZW50LmV4ZWMoZm9ybWF0KSkgPyBuZXcgUmdiKG1bMV0gKiAyNTUgLyAxMDAsIG1bMl0gKiAyNTUgLyAxMDAsIG1bM10gKiAyNTUgLyAxMDAsIDEpIC8vIHJnYigxMDAlLCAwJSwgMCUpXG4gICAgICA6IChtID0gcmVSZ2JhSW50ZWdlci5leGVjKGZvcm1hdCkpID8gcmdiYShtWzFdLCBtWzJdLCBtWzNdLCBtWzRdKSAvLyByZ2JhKDI1NSwgMCwgMCwgMSlcbiAgICAgIDogKG0gPSByZVJnYmFQZXJjZW50LmV4ZWMoZm9ybWF0KSkgPyByZ2JhKG1bMV0gKiAyNTUgLyAxMDAsIG1bMl0gKiAyNTUgLyAxMDAsIG1bM10gKiAyNTUgLyAxMDAsIG1bNF0pIC8vIHJnYigxMDAlLCAwJSwgMCUsIDEpXG4gICAgICA6IChtID0gcmVIc2xQZXJjZW50LmV4ZWMoZm9ybWF0KSkgPyBoc2xhKG1bMV0sIG1bMl0gLyAxMDAsIG1bM10gLyAxMDAsIDEpIC8vIGhzbCgxMjAsIDUwJSwgNTAlKVxuICAgICAgOiAobSA9IHJlSHNsYVBlcmNlbnQuZXhlYyhmb3JtYXQpKSA/IGhzbGEobVsxXSwgbVsyXSAvIDEwMCwgbVszXSAvIDEwMCwgbVs0XSkgLy8gaHNsYSgxMjAsIDUwJSwgNTAlLCAxKVxuICAgICAgOiBuYW1lZC5oYXNPd25Qcm9wZXJ0eShmb3JtYXQpID8gcmdibihuYW1lZFtmb3JtYXRdKSAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXByb3RvdHlwZS1idWlsdGluc1xuICAgICAgOiBmb3JtYXQgPT09IFwidHJhbnNwYXJlbnRcIiA/IG5ldyBSZ2IoTmFOLCBOYU4sIE5hTiwgMClcbiAgICAgIDogbnVsbDtcbn1cblxuZnVuY3Rpb24gcmdibihuKSB7XG4gIHJldHVybiBuZXcgUmdiKG4gPj4gMTYgJiAweGZmLCBuID4+IDggJiAweGZmLCBuICYgMHhmZiwgMSk7XG59XG5cbmZ1bmN0aW9uIHJnYmEociwgZywgYiwgYSkge1xuICBpZiAoYSA8PSAwKSByID0gZyA9IGIgPSBOYU47XG4gIHJldHVybiBuZXcgUmdiKHIsIGcsIGIsIGEpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmdiQ29udmVydChvKSB7XG4gIGlmICghKG8gaW5zdGFuY2VvZiBDb2xvcikpIG8gPSBjb2xvcihvKTtcbiAgaWYgKCFvKSByZXR1cm4gbmV3IFJnYjtcbiAgbyA9IG8ucmdiKCk7XG4gIHJldHVybiBuZXcgUmdiKG8uciwgby5nLCBvLmIsIG8ub3BhY2l0eSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZ2IociwgZywgYiwgb3BhY2l0eSkge1xuICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA9PT0gMSA/IHJnYkNvbnZlcnQocikgOiBuZXcgUmdiKHIsIGcsIGIsIG9wYWNpdHkgPT0gbnVsbCA/IDEgOiBvcGFjaXR5KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIFJnYihyLCBnLCBiLCBvcGFjaXR5KSB7XG4gIHRoaXMuciA9ICtyO1xuICB0aGlzLmcgPSArZztcbiAgdGhpcy5iID0gK2I7XG4gIHRoaXMub3BhY2l0eSA9ICtvcGFjaXR5O1xufVxuXG5kZWZpbmUoUmdiLCByZ2IsIGV4dGVuZChDb2xvciwge1xuICBicmlnaHRlcjogZnVuY3Rpb24oaykge1xuICAgIGsgPSBrID09IG51bGwgPyBicmlnaHRlciA6IE1hdGgucG93KGJyaWdodGVyLCBrKTtcbiAgICByZXR1cm4gbmV3IFJnYih0aGlzLnIgKiBrLCB0aGlzLmcgKiBrLCB0aGlzLmIgKiBrLCB0aGlzLm9wYWNpdHkpO1xuICB9LFxuICBkYXJrZXI6IGZ1bmN0aW9uKGspIHtcbiAgICBrID0gayA9PSBudWxsID8gZGFya2VyIDogTWF0aC5wb3coZGFya2VyLCBrKTtcbiAgICByZXR1cm4gbmV3IFJnYih0aGlzLnIgKiBrLCB0aGlzLmcgKiBrLCB0aGlzLmIgKiBrLCB0aGlzLm9wYWNpdHkpO1xuICB9LFxuICByZ2I6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzO1xuICB9LFxuICBkaXNwbGF5YWJsZTogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuICgtMC41IDw9IHRoaXMuciAmJiB0aGlzLnIgPCAyNTUuNSlcbiAgICAgICAgJiYgKC0wLjUgPD0gdGhpcy5nICYmIHRoaXMuZyA8IDI1NS41KVxuICAgICAgICAmJiAoLTAuNSA8PSB0aGlzLmIgJiYgdGhpcy5iIDwgMjU1LjUpXG4gICAgICAgICYmICgwIDw9IHRoaXMub3BhY2l0eSAmJiB0aGlzLm9wYWNpdHkgPD0gMSk7XG4gIH0sXG4gIGhleDogcmdiX2Zvcm1hdEhleCwgLy8gRGVwcmVjYXRlZCEgVXNlIGNvbG9yLmZvcm1hdEhleC5cbiAgZm9ybWF0SGV4OiByZ2JfZm9ybWF0SGV4LFxuICBmb3JtYXRSZ2I6IHJnYl9mb3JtYXRSZ2IsXG4gIHRvU3RyaW5nOiByZ2JfZm9ybWF0UmdiXG59KSk7XG5cbmZ1bmN0aW9uIHJnYl9mb3JtYXRIZXgoKSB7XG4gIHJldHVybiBcIiNcIiArIGhleCh0aGlzLnIpICsgaGV4KHRoaXMuZykgKyBoZXgodGhpcy5iKTtcbn1cblxuZnVuY3Rpb24gcmdiX2Zvcm1hdFJnYigpIHtcbiAgdmFyIGEgPSB0aGlzLm9wYWNpdHk7IGEgPSBpc05hTihhKSA/IDEgOiBNYXRoLm1heCgwLCBNYXRoLm1pbigxLCBhKSk7XG4gIHJldHVybiAoYSA9PT0gMSA/IFwicmdiKFwiIDogXCJyZ2JhKFwiKVxuICAgICAgKyBNYXRoLm1heCgwLCBNYXRoLm1pbigyNTUsIE1hdGgucm91bmQodGhpcy5yKSB8fCAwKSkgKyBcIiwgXCJcbiAgICAgICsgTWF0aC5tYXgoMCwgTWF0aC5taW4oMjU1LCBNYXRoLnJvdW5kKHRoaXMuZykgfHwgMCkpICsgXCIsIFwiXG4gICAgICArIE1hdGgubWF4KDAsIE1hdGgubWluKDI1NSwgTWF0aC5yb3VuZCh0aGlzLmIpIHx8IDApKVxuICAgICAgKyAoYSA9PT0gMSA/IFwiKVwiIDogXCIsIFwiICsgYSArIFwiKVwiKTtcbn1cblxuZnVuY3Rpb24gaGV4KHZhbHVlKSB7XG4gIHZhbHVlID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oMjU1LCBNYXRoLnJvdW5kKHZhbHVlKSB8fCAwKSk7XG4gIHJldHVybiAodmFsdWUgPCAxNiA/IFwiMFwiIDogXCJcIikgKyB2YWx1ZS50b1N0cmluZygxNik7XG59XG5cbmZ1bmN0aW9uIGhzbGEoaCwgcywgbCwgYSkge1xuICBpZiAoYSA8PSAwKSBoID0gcyA9IGwgPSBOYU47XG4gIGVsc2UgaWYgKGwgPD0gMCB8fCBsID49IDEpIGggPSBzID0gTmFOO1xuICBlbHNlIGlmIChzIDw9IDApIGggPSBOYU47XG4gIHJldHVybiBuZXcgSHNsKGgsIHMsIGwsIGEpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaHNsQ29udmVydChvKSB7XG4gIGlmIChvIGluc3RhbmNlb2YgSHNsKSByZXR1cm4gbmV3IEhzbChvLmgsIG8ucywgby5sLCBvLm9wYWNpdHkpO1xuICBpZiAoIShvIGluc3RhbmNlb2YgQ29sb3IpKSBvID0gY29sb3Iobyk7XG4gIGlmICghbykgcmV0dXJuIG5ldyBIc2w7XG4gIGlmIChvIGluc3RhbmNlb2YgSHNsKSByZXR1cm4gbztcbiAgbyA9IG8ucmdiKCk7XG4gIHZhciByID0gby5yIC8gMjU1LFxuICAgICAgZyA9IG8uZyAvIDI1NSxcbiAgICAgIGIgPSBvLmIgLyAyNTUsXG4gICAgICBtaW4gPSBNYXRoLm1pbihyLCBnLCBiKSxcbiAgICAgIG1heCA9IE1hdGgubWF4KHIsIGcsIGIpLFxuICAgICAgaCA9IE5hTixcbiAgICAgIHMgPSBtYXggLSBtaW4sXG4gICAgICBsID0gKG1heCArIG1pbikgLyAyO1xuICBpZiAocykge1xuICAgIGlmIChyID09PSBtYXgpIGggPSAoZyAtIGIpIC8gcyArIChnIDwgYikgKiA2O1xuICAgIGVsc2UgaWYgKGcgPT09IG1heCkgaCA9IChiIC0gcikgLyBzICsgMjtcbiAgICBlbHNlIGggPSAociAtIGcpIC8gcyArIDQ7XG4gICAgcyAvPSBsIDwgMC41ID8gbWF4ICsgbWluIDogMiAtIG1heCAtIG1pbjtcbiAgICBoICo9IDYwO1xuICB9IGVsc2Uge1xuICAgIHMgPSBsID4gMCAmJiBsIDwgMSA/IDAgOiBoO1xuICB9XG4gIHJldHVybiBuZXcgSHNsKGgsIHMsIGwsIG8ub3BhY2l0eSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBoc2woaCwgcywgbCwgb3BhY2l0eSkge1xuICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA9PT0gMSA/IGhzbENvbnZlcnQoaCkgOiBuZXcgSHNsKGgsIHMsIGwsIG9wYWNpdHkgPT0gbnVsbCA/IDEgOiBvcGFjaXR5KTtcbn1cblxuZnVuY3Rpb24gSHNsKGgsIHMsIGwsIG9wYWNpdHkpIHtcbiAgdGhpcy5oID0gK2g7XG4gIHRoaXMucyA9ICtzO1xuICB0aGlzLmwgPSArbDtcbiAgdGhpcy5vcGFjaXR5ID0gK29wYWNpdHk7XG59XG5cbmRlZmluZShIc2wsIGhzbCwgZXh0ZW5kKENvbG9yLCB7XG4gIGJyaWdodGVyOiBmdW5jdGlvbihrKSB7XG4gICAgayA9IGsgPT0gbnVsbCA/IGJyaWdodGVyIDogTWF0aC5wb3coYnJpZ2h0ZXIsIGspO1xuICAgIHJldHVybiBuZXcgSHNsKHRoaXMuaCwgdGhpcy5zLCB0aGlzLmwgKiBrLCB0aGlzLm9wYWNpdHkpO1xuICB9LFxuICBkYXJrZXI6IGZ1bmN0aW9uKGspIHtcbiAgICBrID0gayA9PSBudWxsID8gZGFya2VyIDogTWF0aC5wb3coZGFya2VyLCBrKTtcbiAgICByZXR1cm4gbmV3IEhzbCh0aGlzLmgsIHRoaXMucywgdGhpcy5sICogaywgdGhpcy5vcGFjaXR5KTtcbiAgfSxcbiAgcmdiOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgaCA9IHRoaXMuaCAlIDM2MCArICh0aGlzLmggPCAwKSAqIDM2MCxcbiAgICAgICAgcyA9IGlzTmFOKGgpIHx8IGlzTmFOKHRoaXMucykgPyAwIDogdGhpcy5zLFxuICAgICAgICBsID0gdGhpcy5sLFxuICAgICAgICBtMiA9IGwgKyAobCA8IDAuNSA/IGwgOiAxIC0gbCkgKiBzLFxuICAgICAgICBtMSA9IDIgKiBsIC0gbTI7XG4gICAgcmV0dXJuIG5ldyBSZ2IoXG4gICAgICBoc2wycmdiKGggPj0gMjQwID8gaCAtIDI0MCA6IGggKyAxMjAsIG0xLCBtMiksXG4gICAgICBoc2wycmdiKGgsIG0xLCBtMiksXG4gICAgICBoc2wycmdiKGggPCAxMjAgPyBoICsgMjQwIDogaCAtIDEyMCwgbTEsIG0yKSxcbiAgICAgIHRoaXMub3BhY2l0eVxuICAgICk7XG4gIH0sXG4gIGRpc3BsYXlhYmxlOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gKDAgPD0gdGhpcy5zICYmIHRoaXMucyA8PSAxIHx8IGlzTmFOKHRoaXMucykpXG4gICAgICAgICYmICgwIDw9IHRoaXMubCAmJiB0aGlzLmwgPD0gMSlcbiAgICAgICAgJiYgKDAgPD0gdGhpcy5vcGFjaXR5ICYmIHRoaXMub3BhY2l0eSA8PSAxKTtcbiAgfSxcbiAgZm9ybWF0SHNsOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgYSA9IHRoaXMub3BhY2l0eTsgYSA9IGlzTmFOKGEpID8gMSA6IE1hdGgubWF4KDAsIE1hdGgubWluKDEsIGEpKTtcbiAgICByZXR1cm4gKGEgPT09IDEgPyBcImhzbChcIiA6IFwiaHNsYShcIilcbiAgICAgICAgKyAodGhpcy5oIHx8IDApICsgXCIsIFwiXG4gICAgICAgICsgKHRoaXMucyB8fCAwKSAqIDEwMCArIFwiJSwgXCJcbiAgICAgICAgKyAodGhpcy5sIHx8IDApICogMTAwICsgXCIlXCJcbiAgICAgICAgKyAoYSA9PT0gMSA/IFwiKVwiIDogXCIsIFwiICsgYSArIFwiKVwiKTtcbiAgfVxufSkpO1xuXG4vKiBGcm9tIEZ2RCAxMy4zNywgQ1NTIENvbG9yIE1vZHVsZSBMZXZlbCAzICovXG5mdW5jdGlvbiBoc2wycmdiKGgsIG0xLCBtMikge1xuICByZXR1cm4gKGggPCA2MCA/IG0xICsgKG0yIC0gbTEpICogaCAvIDYwXG4gICAgICA6IGggPCAxODAgPyBtMlxuICAgICAgOiBoIDwgMjQwID8gbTEgKyAobTIgLSBtMSkgKiAoMjQwIC0gaCkgLyA2MFxuICAgICAgOiBtMSkgKiAyNTU7XG59XG4iLCJpbXBvcnQge1NlbGVjdGlvbn0gZnJvbSBcIi4vaW5kZXguanNcIjtcbmltcG9ydCBzZWxlY3RvciBmcm9tIFwiLi4vc2VsZWN0b3IuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24oc2VsZWN0KSB7XG4gIGlmICh0eXBlb2Ygc2VsZWN0ICE9PSBcImZ1bmN0aW9uXCIpIHNlbGVjdCA9IHNlbGVjdG9yKHNlbGVjdCk7XG5cbiAgZm9yICh2YXIgZ3JvdXBzID0gdGhpcy5fZ3JvdXBzLCBtID0gZ3JvdXBzLmxlbmd0aCwgc3ViZ3JvdXBzID0gbmV3IEFycmF5KG0pLCBqID0gMDsgaiA8IG07ICsraikge1xuICAgIGZvciAodmFyIGdyb3VwID0gZ3JvdXBzW2pdLCBuID0gZ3JvdXAubGVuZ3RoLCBzdWJncm91cCA9IHN1Ymdyb3Vwc1tqXSA9IG5ldyBBcnJheShuKSwgbm9kZSwgc3Vibm9kZSwgaSA9IDA7IGkgPCBuOyArK2kpIHtcbiAgICAgIGlmICgobm9kZSA9IGdyb3VwW2ldKSAmJiAoc3Vibm9kZSA9IHNlbGVjdC5jYWxsKG5vZGUsIG5vZGUuX19kYXRhX18sIGksIGdyb3VwKSkpIHtcbiAgICAgICAgaWYgKFwiX19kYXRhX19cIiBpbiBub2RlKSBzdWJub2RlLl9fZGF0YV9fID0gbm9kZS5fX2RhdGFfXztcbiAgICAgICAgc3ViZ3JvdXBbaV0gPSBzdWJub2RlO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBuZXcgU2VsZWN0aW9uKHN1Ymdyb3VwcywgdGhpcy5fcGFyZW50cyk7XG59XG4iLCJpbXBvcnQge1NlbGVjdGlvbn0gZnJvbSBcIi4vaW5kZXguanNcIjtcbmltcG9ydCBhcnJheSBmcm9tIFwiLi4vYXJyYXkuanNcIjtcbmltcG9ydCBzZWxlY3RvckFsbCBmcm9tIFwiLi4vc2VsZWN0b3JBbGwuanNcIjtcblxuZnVuY3Rpb24gYXJyYXlBbGwoc2VsZWN0KSB7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gYXJyYXkoc2VsZWN0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpO1xuICB9O1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbihzZWxlY3QpIHtcbiAgaWYgKHR5cGVvZiBzZWxlY3QgPT09IFwiZnVuY3Rpb25cIikgc2VsZWN0ID0gYXJyYXlBbGwoc2VsZWN0KTtcbiAgZWxzZSBzZWxlY3QgPSBzZWxlY3RvckFsbChzZWxlY3QpO1xuXG4gIGZvciAodmFyIGdyb3VwcyA9IHRoaXMuX2dyb3VwcywgbSA9IGdyb3Vwcy5sZW5ndGgsIHN1Ymdyb3VwcyA9IFtdLCBwYXJlbnRzID0gW10sIGogPSAwOyBqIDwgbTsgKytqKSB7XG4gICAgZm9yICh2YXIgZ3JvdXAgPSBncm91cHNbal0sIG4gPSBncm91cC5sZW5ndGgsIG5vZGUsIGkgPSAwOyBpIDwgbjsgKytpKSB7XG4gICAgICBpZiAobm9kZSA9IGdyb3VwW2ldKSB7XG4gICAgICAgIHN1Ymdyb3Vwcy5wdXNoKHNlbGVjdC5jYWxsKG5vZGUsIG5vZGUuX19kYXRhX18sIGksIGdyb3VwKSk7XG4gICAgICAgIHBhcmVudHMucHVzaChub2RlKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gbmV3IFNlbGVjdGlvbihzdWJncm91cHMsIHBhcmVudHMpO1xufVxuIiwiaW1wb3J0IHtTZWxlY3Rpb259IGZyb20gXCIuL2luZGV4LmpzXCI7XG5pbXBvcnQgbWF0Y2hlciBmcm9tIFwiLi4vbWF0Y2hlci5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbihtYXRjaCkge1xuICBpZiAodHlwZW9mIG1hdGNoICE9PSBcImZ1bmN0aW9uXCIpIG1hdGNoID0gbWF0Y2hlcihtYXRjaCk7XG5cbiAgZm9yICh2YXIgZ3JvdXBzID0gdGhpcy5fZ3JvdXBzLCBtID0gZ3JvdXBzLmxlbmd0aCwgc3ViZ3JvdXBzID0gbmV3IEFycmF5KG0pLCBqID0gMDsgaiA8IG07ICsraikge1xuICAgIGZvciAodmFyIGdyb3VwID0gZ3JvdXBzW2pdLCBuID0gZ3JvdXAubGVuZ3RoLCBzdWJncm91cCA9IHN1Ymdyb3Vwc1tqXSA9IFtdLCBub2RlLCBpID0gMDsgaSA8IG47ICsraSkge1xuICAgICAgaWYgKChub2RlID0gZ3JvdXBbaV0pICYmIG1hdGNoLmNhbGwobm9kZSwgbm9kZS5fX2RhdGFfXywgaSwgZ3JvdXApKSB7XG4gICAgICAgIHN1Ymdyb3VwLnB1c2gobm9kZSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG5ldyBTZWxlY3Rpb24oc3ViZ3JvdXBzLCB0aGlzLl9wYXJlbnRzKTtcbn1cbiIsImltcG9ydCBzcGFyc2UgZnJvbSBcIi4vc3BhcnNlLmpzXCI7XG5pbXBvcnQge1NlbGVjdGlvbn0gZnJvbSBcIi4vaW5kZXguanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24oKSB7XG4gIHJldHVybiBuZXcgU2VsZWN0aW9uKHRoaXMuX2V4aXQgfHwgdGhpcy5fZ3JvdXBzLm1hcChzcGFyc2UpLCB0aGlzLl9wYXJlbnRzKTtcbn1cbiIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKG9uZW50ZXIsIG9udXBkYXRlLCBvbmV4aXQpIHtcbiAgdmFyIGVudGVyID0gdGhpcy5lbnRlcigpLCB1cGRhdGUgPSB0aGlzLCBleGl0ID0gdGhpcy5leGl0KCk7XG4gIGlmICh0eXBlb2Ygb25lbnRlciA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgZW50ZXIgPSBvbmVudGVyKGVudGVyKTtcbiAgICBpZiAoZW50ZXIpIGVudGVyID0gZW50ZXIuc2VsZWN0aW9uKCk7XG4gIH0gZWxzZSB7XG4gICAgZW50ZXIgPSBlbnRlci5hcHBlbmQob25lbnRlciArIFwiXCIpO1xuICB9XG4gIGlmIChvbnVwZGF0ZSAhPSBudWxsKSB7XG4gICAgdXBkYXRlID0gb251cGRhdGUodXBkYXRlKTtcbiAgICBpZiAodXBkYXRlKSB1cGRhdGUgPSB1cGRhdGUuc2VsZWN0aW9uKCk7XG4gIH1cbiAgaWYgKG9uZXhpdCA9PSBudWxsKSBleGl0LnJlbW92ZSgpOyBlbHNlIG9uZXhpdChleGl0KTtcbiAgcmV0dXJuIGVudGVyICYmIHVwZGF0ZSA/IGVudGVyLm1lcmdlKHVwZGF0ZSkub3JkZXIoKSA6IHVwZGF0ZTtcbn1cbiIsImltcG9ydCB7U2VsZWN0aW9ufSBmcm9tIFwiLi9pbmRleC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbihjb250ZXh0KSB7XG4gIHZhciBzZWxlY3Rpb24gPSBjb250ZXh0LnNlbGVjdGlvbiA/IGNvbnRleHQuc2VsZWN0aW9uKCkgOiBjb250ZXh0O1xuXG4gIGZvciAodmFyIGdyb3VwczAgPSB0aGlzLl9ncm91cHMsIGdyb3VwczEgPSBzZWxlY3Rpb24uX2dyb3VwcywgbTAgPSBncm91cHMwLmxlbmd0aCwgbTEgPSBncm91cHMxLmxlbmd0aCwgbSA9IE1hdGgubWluKG0wLCBtMSksIG1lcmdlcyA9IG5ldyBBcnJheShtMCksIGogPSAwOyBqIDwgbTsgKytqKSB7XG4gICAgZm9yICh2YXIgZ3JvdXAwID0gZ3JvdXBzMFtqXSwgZ3JvdXAxID0gZ3JvdXBzMVtqXSwgbiA9IGdyb3VwMC5sZW5ndGgsIG1lcmdlID0gbWVyZ2VzW2pdID0gbmV3IEFycmF5KG4pLCBub2RlLCBpID0gMDsgaSA8IG47ICsraSkge1xuICAgICAgaWYgKG5vZGUgPSBncm91cDBbaV0gfHwgZ3JvdXAxW2ldKSB7XG4gICAgICAgIG1lcmdlW2ldID0gbm9kZTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmb3IgKDsgaiA8IG0wOyArK2opIHtcbiAgICBtZXJnZXNbal0gPSBncm91cHMwW2pdO1xuICB9XG5cbiAgcmV0dXJuIG5ldyBTZWxlY3Rpb24obWVyZ2VzLCB0aGlzLl9wYXJlbnRzKTtcbn1cbiIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKCkge1xuXG4gIGZvciAodmFyIGdyb3VwcyA9IHRoaXMuX2dyb3VwcywgaiA9IC0xLCBtID0gZ3JvdXBzLmxlbmd0aDsgKytqIDwgbTspIHtcbiAgICBmb3IgKHZhciBncm91cCA9IGdyb3Vwc1tqXSwgaSA9IGdyb3VwLmxlbmd0aCAtIDEsIG5leHQgPSBncm91cFtpXSwgbm9kZTsgLS1pID49IDA7KSB7XG4gICAgICBpZiAobm9kZSA9IGdyb3VwW2ldKSB7XG4gICAgICAgIGlmIChuZXh0ICYmIG5vZGUuY29tcGFyZURvY3VtZW50UG9zaXRpb24obmV4dCkgXiA0KSBuZXh0LnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKG5vZGUsIG5leHQpO1xuICAgICAgICBuZXh0ID0gbm9kZTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gdGhpcztcbn1cbiIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKCkge1xuICB2YXIgY2FsbGJhY2sgPSBhcmd1bWVudHNbMF07XG4gIGFyZ3VtZW50c1swXSA9IHRoaXM7XG4gIGNhbGxiYWNrLmFwcGx5KG51bGwsIGFyZ3VtZW50cyk7XG4gIHJldHVybiB0aGlzO1xufVxuIiwiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24oKSB7XG4gIHJldHVybiBBcnJheS5mcm9tKHRoaXMpO1xufVxuIiwiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24oKSB7XG5cbiAgZm9yICh2YXIgZ3JvdXBzID0gdGhpcy5fZ3JvdXBzLCBqID0gMCwgbSA9IGdyb3Vwcy5sZW5ndGg7IGogPCBtOyArK2opIHtcbiAgICBmb3IgKHZhciBncm91cCA9IGdyb3Vwc1tqXSwgaSA9IDAsIG4gPSBncm91cC5sZW5ndGg7IGkgPCBuOyArK2kpIHtcbiAgICAgIHZhciBub2RlID0gZ3JvdXBbaV07XG4gICAgICBpZiAobm9kZSkgcmV0dXJuIG5vZGU7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG51bGw7XG59XG4iLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbigpIHtcbiAgbGV0IHNpemUgPSAwO1xuICBmb3IgKGNvbnN0IG5vZGUgb2YgdGhpcykgKytzaXplOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVudXNlZC12YXJzXG4gIHJldHVybiBzaXplO1xufVxuIiwiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24oKSB7XG4gIHJldHVybiAhdGhpcy5ub2RlKCk7XG59XG4iLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbihjYWxsYmFjaykge1xuXG4gIGZvciAodmFyIGdyb3VwcyA9IHRoaXMuX2dyb3VwcywgaiA9IDAsIG0gPSBncm91cHMubGVuZ3RoOyBqIDwgbTsgKytqKSB7XG4gICAgZm9yICh2YXIgZ3JvdXAgPSBncm91cHNbal0sIGkgPSAwLCBuID0gZ3JvdXAubGVuZ3RoLCBub2RlOyBpIDwgbjsgKytpKSB7XG4gICAgICBpZiAobm9kZSA9IGdyb3VwW2ldKSBjYWxsYmFjay5jYWxsKG5vZGUsIG5vZGUuX19kYXRhX18sIGksIGdyb3VwKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gdGhpcztcbn1cbiIsImltcG9ydCBjcmVhdG9yIGZyb20gXCIuLi9jcmVhdG9yLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKG5hbWUpIHtcbiAgdmFyIGNyZWF0ZSA9IHR5cGVvZiBuYW1lID09PSBcImZ1bmN0aW9uXCIgPyBuYW1lIDogY3JlYXRvcihuYW1lKTtcbiAgcmV0dXJuIHRoaXMuc2VsZWN0KGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLmFwcGVuZENoaWxkKGNyZWF0ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpKTtcbiAgfSk7XG59XG4iLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbih2YWx1ZSkge1xuICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aFxuICAgICAgPyB0aGlzLnByb3BlcnR5KFwiX19kYXRhX19cIiwgdmFsdWUpXG4gICAgICA6IHRoaXMubm9kZSgpLl9fZGF0YV9fO1xufVxuIiwiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24qKCkge1xuICBmb3IgKHZhciBncm91cHMgPSB0aGlzLl9ncm91cHMsIGogPSAwLCBtID0gZ3JvdXBzLmxlbmd0aDsgaiA8IG07ICsraikge1xuICAgIGZvciAodmFyIGdyb3VwID0gZ3JvdXBzW2pdLCBpID0gMCwgbiA9IGdyb3VwLmxlbmd0aCwgbm9kZTsgaSA8IG47ICsraSkge1xuICAgICAgaWYgKG5vZGUgPSBncm91cFtpXSkgeWllbGQgbm9kZTtcbiAgICB9XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IHggPT4gKCkgPT4geDtcbiIsImltcG9ydCBjb25zdGFudCBmcm9tIFwiLi9jb25zdGFudC5qc1wiO1xuXG5mdW5jdGlvbiBsaW5lYXIoYSwgZCkge1xuICByZXR1cm4gZnVuY3Rpb24odCkge1xuICAgIHJldHVybiBhICsgdCAqIGQ7XG4gIH07XG59XG5cbmZ1bmN0aW9uIGV4cG9uZW50aWFsKGEsIGIsIHkpIHtcbiAgcmV0dXJuIGEgPSBNYXRoLnBvdyhhLCB5KSwgYiA9IE1hdGgucG93KGIsIHkpIC0gYSwgeSA9IDEgLyB5LCBmdW5jdGlvbih0KSB7XG4gICAgcmV0dXJuIE1hdGgucG93KGEgKyB0ICogYiwgeSk7XG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBodWUoYSwgYikge1xuICB2YXIgZCA9IGIgLSBhO1xuICByZXR1cm4gZCA/IGxpbmVhcihhLCBkID4gMTgwIHx8IGQgPCAtMTgwID8gZCAtIDM2MCAqIE1hdGgucm91bmQoZCAvIDM2MCkgOiBkKSA6IGNvbnN0YW50KGlzTmFOKGEpID8gYiA6IGEpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2FtbWEoeSkge1xuICByZXR1cm4gKHkgPSAreSkgPT09IDEgPyBub2dhbW1hIDogZnVuY3Rpb24oYSwgYikge1xuICAgIHJldHVybiBiIC0gYSA/IGV4cG9uZW50aWFsKGEsIGIsIHkpIDogY29uc3RhbnQoaXNOYU4oYSkgPyBiIDogYSk7XG4gIH07XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIG5vZ2FtbWEoYSwgYikge1xuICB2YXIgZCA9IGIgLSBhO1xuICByZXR1cm4gZCA/IGxpbmVhcihhLCBkKSA6IGNvbnN0YW50KGlzTmFOKGEpID8gYiA6IGEpO1xufVxuIiwiaW1wb3J0IHtyZ2IgYXMgY29sb3JSZ2J9IGZyb20gXCJkMy1jb2xvclwiO1xuaW1wb3J0IGJhc2lzIGZyb20gXCIuL2Jhc2lzLmpzXCI7XG5pbXBvcnQgYmFzaXNDbG9zZWQgZnJvbSBcIi4vYmFzaXNDbG9zZWQuanNcIjtcbmltcG9ydCBub2dhbW1hLCB7Z2FtbWF9IGZyb20gXCIuL2NvbG9yLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IChmdW5jdGlvbiByZ2JHYW1tYSh5KSB7XG4gIHZhciBjb2xvciA9IGdhbW1hKHkpO1xuXG4gIGZ1bmN0aW9uIHJnYihzdGFydCwgZW5kKSB7XG4gICAgdmFyIHIgPSBjb2xvcigoc3RhcnQgPSBjb2xvclJnYihzdGFydCkpLnIsIChlbmQgPSBjb2xvclJnYihlbmQpKS5yKSxcbiAgICAgICAgZyA9IGNvbG9yKHN0YXJ0LmcsIGVuZC5nKSxcbiAgICAgICAgYiA9IGNvbG9yKHN0YXJ0LmIsIGVuZC5iKSxcbiAgICAgICAgb3BhY2l0eSA9IG5vZ2FtbWEoc3RhcnQub3BhY2l0eSwgZW5kLm9wYWNpdHkpO1xuICAgIHJldHVybiBmdW5jdGlvbih0KSB7XG4gICAgICBzdGFydC5yID0gcih0KTtcbiAgICAgIHN0YXJ0LmcgPSBnKHQpO1xuICAgICAgc3RhcnQuYiA9IGIodCk7XG4gICAgICBzdGFydC5vcGFjaXR5ID0gb3BhY2l0eSh0KTtcbiAgICAgIHJldHVybiBzdGFydCArIFwiXCI7XG4gICAgfTtcbiAgfVxuXG4gIHJnYi5nYW1tYSA9IHJnYkdhbW1hO1xuXG4gIHJldHVybiByZ2I7XG59KSgxKTtcblxuZnVuY3Rpb24gcmdiU3BsaW5lKHNwbGluZSkge1xuICByZXR1cm4gZnVuY3Rpb24oY29sb3JzKSB7XG4gICAgdmFyIG4gPSBjb2xvcnMubGVuZ3RoLFxuICAgICAgICByID0gbmV3IEFycmF5KG4pLFxuICAgICAgICBnID0gbmV3IEFycmF5KG4pLFxuICAgICAgICBiID0gbmV3IEFycmF5KG4pLFxuICAgICAgICBpLCBjb2xvcjtcbiAgICBmb3IgKGkgPSAwOyBpIDwgbjsgKytpKSB7XG4gICAgICBjb2xvciA9IGNvbG9yUmdiKGNvbG9yc1tpXSk7XG4gICAgICByW2ldID0gY29sb3IuciB8fCAwO1xuICAgICAgZ1tpXSA9IGNvbG9yLmcgfHwgMDtcbiAgICAgIGJbaV0gPSBjb2xvci5iIHx8IDA7XG4gICAgfVxuICAgIHIgPSBzcGxpbmUocik7XG4gICAgZyA9IHNwbGluZShnKTtcbiAgICBiID0gc3BsaW5lKGIpO1xuICAgIGNvbG9yLm9wYWNpdHkgPSAxO1xuICAgIHJldHVybiBmdW5jdGlvbih0KSB7XG4gICAgICBjb2xvci5yID0gcih0KTtcbiAgICAgIGNvbG9yLmcgPSBnKHQpO1xuICAgICAgY29sb3IuYiA9IGIodCk7XG4gICAgICByZXR1cm4gY29sb3IgKyBcIlwiO1xuICAgIH07XG4gIH07XG59XG5cbmV4cG9ydCB2YXIgcmdiQmFzaXMgPSByZ2JTcGxpbmUoYmFzaXMpO1xuZXhwb3J0IHZhciByZ2JCYXNpc0Nsb3NlZCA9IHJnYlNwbGluZShiYXNpc0Nsb3NlZCk7XG4iLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbihhLCBiKSB7XG4gIHJldHVybiBhID0gK2EsIGIgPSArYiwgZnVuY3Rpb24odCkge1xuICAgIHJldHVybiBhICogKDEgLSB0KSArIGIgKiB0O1xuICB9O1xufVxuIiwiaW1wb3J0IG51bWJlciBmcm9tIFwiLi9udW1iZXIuanNcIjtcblxudmFyIHJlQSA9IC9bLStdPyg/OlxcZCtcXC4/XFxkKnxcXC4/XFxkKykoPzpbZUVdWy0rXT9cXGQrKT8vZyxcbiAgICByZUIgPSBuZXcgUmVnRXhwKHJlQS5zb3VyY2UsIFwiZ1wiKTtcblxuZnVuY3Rpb24gemVybyhiKSB7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gYjtcbiAgfTtcbn1cblxuZnVuY3Rpb24gb25lKGIpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKHQpIHtcbiAgICByZXR1cm4gYih0KSArIFwiXCI7XG4gIH07XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKGEsIGIpIHtcbiAgdmFyIGJpID0gcmVBLmxhc3RJbmRleCA9IHJlQi5sYXN0SW5kZXggPSAwLCAvLyBzY2FuIGluZGV4IGZvciBuZXh0IG51bWJlciBpbiBiXG4gICAgICBhbSwgLy8gY3VycmVudCBtYXRjaCBpbiBhXG4gICAgICBibSwgLy8gY3VycmVudCBtYXRjaCBpbiBiXG4gICAgICBicywgLy8gc3RyaW5nIHByZWNlZGluZyBjdXJyZW50IG51bWJlciBpbiBiLCBpZiBhbnlcbiAgICAgIGkgPSAtMSwgLy8gaW5kZXggaW4gc1xuICAgICAgcyA9IFtdLCAvLyBzdHJpbmcgY29uc3RhbnRzIGFuZCBwbGFjZWhvbGRlcnNcbiAgICAgIHEgPSBbXTsgLy8gbnVtYmVyIGludGVycG9sYXRvcnNcblxuICAvLyBDb2VyY2UgaW5wdXRzIHRvIHN0cmluZ3MuXG4gIGEgPSBhICsgXCJcIiwgYiA9IGIgKyBcIlwiO1xuXG4gIC8vIEludGVycG9sYXRlIHBhaXJzIG9mIG51bWJlcnMgaW4gYSAmIGIuXG4gIHdoaWxlICgoYW0gPSByZUEuZXhlYyhhKSlcbiAgICAgICYmIChibSA9IHJlQi5leGVjKGIpKSkge1xuICAgIGlmICgoYnMgPSBibS5pbmRleCkgPiBiaSkgeyAvLyBhIHN0cmluZyBwcmVjZWRlcyB0aGUgbmV4dCBudW1iZXIgaW4gYlxuICAgICAgYnMgPSBiLnNsaWNlKGJpLCBicyk7XG4gICAgICBpZiAoc1tpXSkgc1tpXSArPSBiczsgLy8gY29hbGVzY2Ugd2l0aCBwcmV2aW91cyBzdHJpbmdcbiAgICAgIGVsc2Ugc1srK2ldID0gYnM7XG4gICAgfVxuICAgIGlmICgoYW0gPSBhbVswXSkgPT09IChibSA9IGJtWzBdKSkgeyAvLyBudW1iZXJzIGluIGEgJiBiIG1hdGNoXG4gICAgICBpZiAoc1tpXSkgc1tpXSArPSBibTsgLy8gY29hbGVzY2Ugd2l0aCBwcmV2aW91cyBzdHJpbmdcbiAgICAgIGVsc2Ugc1srK2ldID0gYm07XG4gICAgfSBlbHNlIHsgLy8gaW50ZXJwb2xhdGUgbm9uLW1hdGNoaW5nIG51bWJlcnNcbiAgICAgIHNbKytpXSA9IG51bGw7XG4gICAgICBxLnB1c2goe2k6IGksIHg6IG51bWJlcihhbSwgYm0pfSk7XG4gICAgfVxuICAgIGJpID0gcmVCLmxhc3RJbmRleDtcbiAgfVxuXG4gIC8vIEFkZCByZW1haW5zIG9mIGIuXG4gIGlmIChiaSA8IGIubGVuZ3RoKSB7XG4gICAgYnMgPSBiLnNsaWNlKGJpKTtcbiAgICBpZiAoc1tpXSkgc1tpXSArPSBiczsgLy8gY29hbGVzY2Ugd2l0aCBwcmV2aW91cyBzdHJpbmdcbiAgICBlbHNlIHNbKytpXSA9IGJzO1xuICB9XG5cbiAgLy8gU3BlY2lhbCBvcHRpbWl6YXRpb24gZm9yIG9ubHkgYSBzaW5nbGUgbWF0Y2guXG4gIC8vIE90aGVyd2lzZSwgaW50ZXJwb2xhdGUgZWFjaCBvZiB0aGUgbnVtYmVycyBhbmQgcmVqb2luIHRoZSBzdHJpbmcuXG4gIHJldHVybiBzLmxlbmd0aCA8IDIgPyAocVswXVxuICAgICAgPyBvbmUocVswXS54KVxuICAgICAgOiB6ZXJvKGIpKVxuICAgICAgOiAoYiA9IHEubGVuZ3RoLCBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDAsIG87IGkgPCBiOyArK2kpIHNbKG8gPSBxW2ldKS5pXSA9IG8ueCh0KTtcbiAgICAgICAgICByZXR1cm4gcy5qb2luKFwiXCIpO1xuICAgICAgICB9KTtcbn1cbiIsInZhciBkZWdyZWVzID0gMTgwIC8gTWF0aC5QSTtcblxuZXhwb3J0IHZhciBpZGVudGl0eSA9IHtcbiAgdHJhbnNsYXRlWDogMCxcbiAgdHJhbnNsYXRlWTogMCxcbiAgcm90YXRlOiAwLFxuICBza2V3WDogMCxcbiAgc2NhbGVYOiAxLFxuICBzY2FsZVk6IDFcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKGEsIGIsIGMsIGQsIGUsIGYpIHtcbiAgdmFyIHNjYWxlWCwgc2NhbGVZLCBza2V3WDtcbiAgaWYgKHNjYWxlWCA9IE1hdGguc3FydChhICogYSArIGIgKiBiKSkgYSAvPSBzY2FsZVgsIGIgLz0gc2NhbGVYO1xuICBpZiAoc2tld1ggPSBhICogYyArIGIgKiBkKSBjIC09IGEgKiBza2V3WCwgZCAtPSBiICogc2tld1g7XG4gIGlmIChzY2FsZVkgPSBNYXRoLnNxcnQoYyAqIGMgKyBkICogZCkpIGMgLz0gc2NhbGVZLCBkIC89IHNjYWxlWSwgc2tld1ggLz0gc2NhbGVZO1xuICBpZiAoYSAqIGQgPCBiICogYykgYSA9IC1hLCBiID0gLWIsIHNrZXdYID0gLXNrZXdYLCBzY2FsZVggPSAtc2NhbGVYO1xuICByZXR1cm4ge1xuICAgIHRyYW5zbGF0ZVg6IGUsXG4gICAgdHJhbnNsYXRlWTogZixcbiAgICByb3RhdGU6IE1hdGguYXRhbjIoYiwgYSkgKiBkZWdyZWVzLFxuICAgIHNrZXdYOiBNYXRoLmF0YW4oc2tld1gpICogZGVncmVlcyxcbiAgICBzY2FsZVg6IHNjYWxlWCxcbiAgICBzY2FsZVk6IHNjYWxlWVxuICB9O1xufVxuIiwiaW1wb3J0IGRlY29tcG9zZSwge2lkZW50aXR5fSBmcm9tIFwiLi9kZWNvbXBvc2UuanNcIjtcblxudmFyIHN2Z05vZGU7XG5cbi8qIGVzbGludC1kaXNhYmxlIG5vLXVuZGVmICovXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VDc3ModmFsdWUpIHtcbiAgY29uc3QgbSA9IG5ldyAodHlwZW9mIERPTU1hdHJpeCA9PT0gXCJmdW5jdGlvblwiID8gRE9NTWF0cml4IDogV2ViS2l0Q1NTTWF0cml4KSh2YWx1ZSArIFwiXCIpO1xuICByZXR1cm4gbS5pc0lkZW50aXR5ID8gaWRlbnRpdHkgOiBkZWNvbXBvc2UobS5hLCBtLmIsIG0uYywgbS5kLCBtLmUsIG0uZik7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZVN2Zyh2YWx1ZSkge1xuICBpZiAodmFsdWUgPT0gbnVsbCkgcmV0dXJuIGlkZW50aXR5O1xuICBpZiAoIXN2Z05vZGUpIHN2Z05vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiLCBcImdcIik7XG4gIHN2Z05vZGUuc2V0QXR0cmlidXRlKFwidHJhbnNmb3JtXCIsIHZhbHVlKTtcbiAgaWYgKCEodmFsdWUgPSBzdmdOb2RlLnRyYW5zZm9ybS5iYXNlVmFsLmNvbnNvbGlkYXRlKCkpKSByZXR1cm4gaWRlbnRpdHk7XG4gIHZhbHVlID0gdmFsdWUubWF0cml4O1xuICByZXR1cm4gZGVjb21wb3NlKHZhbHVlLmEsIHZhbHVlLmIsIHZhbHVlLmMsIHZhbHVlLmQsIHZhbHVlLmUsIHZhbHVlLmYpO1xufVxuIiwiaW1wb3J0IG51bWJlciBmcm9tIFwiLi4vbnVtYmVyLmpzXCI7XG5pbXBvcnQge3BhcnNlQ3NzLCBwYXJzZVN2Z30gZnJvbSBcIi4vcGFyc2UuanNcIjtcblxuZnVuY3Rpb24gaW50ZXJwb2xhdGVUcmFuc2Zvcm0ocGFyc2UsIHB4Q29tbWEsIHB4UGFyZW4sIGRlZ1BhcmVuKSB7XG5cbiAgZnVuY3Rpb24gcG9wKHMpIHtcbiAgICByZXR1cm4gcy5sZW5ndGggPyBzLnBvcCgpICsgXCIgXCIgOiBcIlwiO1xuICB9XG5cbiAgZnVuY3Rpb24gdHJhbnNsYXRlKHhhLCB5YSwgeGIsIHliLCBzLCBxKSB7XG4gICAgaWYgKHhhICE9PSB4YiB8fCB5YSAhPT0geWIpIHtcbiAgICAgIHZhciBpID0gcy5wdXNoKFwidHJhbnNsYXRlKFwiLCBudWxsLCBweENvbW1hLCBudWxsLCBweFBhcmVuKTtcbiAgICAgIHEucHVzaCh7aTogaSAtIDQsIHg6IG51bWJlcih4YSwgeGIpfSwge2k6IGkgLSAyLCB4OiBudW1iZXIoeWEsIHliKX0pO1xuICAgIH0gZWxzZSBpZiAoeGIgfHwgeWIpIHtcbiAgICAgIHMucHVzaChcInRyYW5zbGF0ZShcIiArIHhiICsgcHhDb21tYSArIHliICsgcHhQYXJlbik7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gcm90YXRlKGEsIGIsIHMsIHEpIHtcbiAgICBpZiAoYSAhPT0gYikge1xuICAgICAgaWYgKGEgLSBiID4gMTgwKSBiICs9IDM2MDsgZWxzZSBpZiAoYiAtIGEgPiAxODApIGEgKz0gMzYwOyAvLyBzaG9ydGVzdCBwYXRoXG4gICAgICBxLnB1c2goe2k6IHMucHVzaChwb3AocykgKyBcInJvdGF0ZShcIiwgbnVsbCwgZGVnUGFyZW4pIC0gMiwgeDogbnVtYmVyKGEsIGIpfSk7XG4gICAgfSBlbHNlIGlmIChiKSB7XG4gICAgICBzLnB1c2gocG9wKHMpICsgXCJyb3RhdGUoXCIgKyBiICsgZGVnUGFyZW4pO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHNrZXdYKGEsIGIsIHMsIHEpIHtcbiAgICBpZiAoYSAhPT0gYikge1xuICAgICAgcS5wdXNoKHtpOiBzLnB1c2gocG9wKHMpICsgXCJza2V3WChcIiwgbnVsbCwgZGVnUGFyZW4pIC0gMiwgeDogbnVtYmVyKGEsIGIpfSk7XG4gICAgfSBlbHNlIGlmIChiKSB7XG4gICAgICBzLnB1c2gocG9wKHMpICsgXCJza2V3WChcIiArIGIgKyBkZWdQYXJlbik7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gc2NhbGUoeGEsIHlhLCB4YiwgeWIsIHMsIHEpIHtcbiAgICBpZiAoeGEgIT09IHhiIHx8IHlhICE9PSB5Yikge1xuICAgICAgdmFyIGkgPSBzLnB1c2gocG9wKHMpICsgXCJzY2FsZShcIiwgbnVsbCwgXCIsXCIsIG51bGwsIFwiKVwiKTtcbiAgICAgIHEucHVzaCh7aTogaSAtIDQsIHg6IG51bWJlcih4YSwgeGIpfSwge2k6IGkgLSAyLCB4OiBudW1iZXIoeWEsIHliKX0pO1xuICAgIH0gZWxzZSBpZiAoeGIgIT09IDEgfHwgeWIgIT09IDEpIHtcbiAgICAgIHMucHVzaChwb3AocykgKyBcInNjYWxlKFwiICsgeGIgKyBcIixcIiArIHliICsgXCIpXCIpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBmdW5jdGlvbihhLCBiKSB7XG4gICAgdmFyIHMgPSBbXSwgLy8gc3RyaW5nIGNvbnN0YW50cyBhbmQgcGxhY2Vob2xkZXJzXG4gICAgICAgIHEgPSBbXTsgLy8gbnVtYmVyIGludGVycG9sYXRvcnNcbiAgICBhID0gcGFyc2UoYSksIGIgPSBwYXJzZShiKTtcbiAgICB0cmFuc2xhdGUoYS50cmFuc2xhdGVYLCBhLnRyYW5zbGF0ZVksIGIudHJhbnNsYXRlWCwgYi50cmFuc2xhdGVZLCBzLCBxKTtcbiAgICByb3RhdGUoYS5yb3RhdGUsIGIucm90YXRlLCBzLCBxKTtcbiAgICBza2V3WChhLnNrZXdYLCBiLnNrZXdYLCBzLCBxKTtcbiAgICBzY2FsZShhLnNjYWxlWCwgYS5zY2FsZVksIGIuc2NhbGVYLCBiLnNjYWxlWSwgcywgcSk7XG4gICAgYSA9IGIgPSBudWxsOyAvLyBnY1xuICAgIHJldHVybiBmdW5jdGlvbih0KSB7XG4gICAgICB2YXIgaSA9IC0xLCBuID0gcS5sZW5ndGgsIG87XG4gICAgICB3aGlsZSAoKytpIDwgbikgc1sobyA9IHFbaV0pLmldID0gby54KHQpO1xuICAgICAgcmV0dXJuIHMuam9pbihcIlwiKTtcbiAgICB9O1xuICB9O1xufVxuXG5leHBvcnQgdmFyIGludGVycG9sYXRlVHJhbnNmb3JtQ3NzID0gaW50ZXJwb2xhdGVUcmFuc2Zvcm0ocGFyc2VDc3MsIFwicHgsIFwiLCBcInB4KVwiLCBcImRlZylcIik7XG5leHBvcnQgdmFyIGludGVycG9sYXRlVHJhbnNmb3JtU3ZnID0gaW50ZXJwb2xhdGVUcmFuc2Zvcm0ocGFyc2VTdmcsIFwiLCBcIiwgXCIpXCIsIFwiKVwiKTtcbiIsInZhciBmcmFtZSA9IDAsIC8vIGlzIGFuIGFuaW1hdGlvbiBmcmFtZSBwZW5kaW5nP1xuICAgIHRpbWVvdXQgPSAwLCAvLyBpcyBhIHRpbWVvdXQgcGVuZGluZz9cbiAgICBpbnRlcnZhbCA9IDAsIC8vIGFyZSBhbnkgdGltZXJzIGFjdGl2ZT9cbiAgICBwb2tlRGVsYXkgPSAxMDAwLCAvLyBob3cgZnJlcXVlbnRseSB3ZSBjaGVjayBmb3IgY2xvY2sgc2tld1xuICAgIHRhc2tIZWFkLFxuICAgIHRhc2tUYWlsLFxuICAgIGNsb2NrTGFzdCA9IDAsXG4gICAgY2xvY2tOb3cgPSAwLFxuICAgIGNsb2NrU2tldyA9IDAsXG4gICAgY2xvY2sgPSB0eXBlb2YgcGVyZm9ybWFuY2UgPT09IFwib2JqZWN0XCIgJiYgcGVyZm9ybWFuY2Uubm93ID8gcGVyZm9ybWFuY2UgOiBEYXRlLFxuICAgIHNldEZyYW1lID0gdHlwZW9mIHdpbmRvdyA9PT0gXCJvYmplY3RcIiAmJiB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lID8gd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZS5iaW5kKHdpbmRvdykgOiBmdW5jdGlvbihmKSB7IHNldFRpbWVvdXQoZiwgMTcpOyB9O1xuXG5leHBvcnQgZnVuY3Rpb24gbm93KCkge1xuICByZXR1cm4gY2xvY2tOb3cgfHwgKHNldEZyYW1lKGNsZWFyTm93KSwgY2xvY2tOb3cgPSBjbG9jay5ub3coKSArIGNsb2NrU2tldyk7XG59XG5cbmZ1bmN0aW9uIGNsZWFyTm93KCkge1xuICBjbG9ja05vdyA9IDA7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBUaW1lcigpIHtcbiAgdGhpcy5fY2FsbCA9XG4gIHRoaXMuX3RpbWUgPVxuICB0aGlzLl9uZXh0ID0gbnVsbDtcbn1cblxuVGltZXIucHJvdG90eXBlID0gdGltZXIucHJvdG90eXBlID0ge1xuICBjb25zdHJ1Y3RvcjogVGltZXIsXG4gIHJlc3RhcnQ6IGZ1bmN0aW9uKGNhbGxiYWNrLCBkZWxheSwgdGltZSkge1xuICAgIGlmICh0eXBlb2YgY2FsbGJhY2sgIT09IFwiZnVuY3Rpb25cIikgdGhyb3cgbmV3IFR5cGVFcnJvcihcImNhbGxiYWNrIGlzIG5vdCBhIGZ1bmN0aW9uXCIpO1xuICAgIHRpbWUgPSAodGltZSA9PSBudWxsID8gbm93KCkgOiArdGltZSkgKyAoZGVsYXkgPT0gbnVsbCA/IDAgOiArZGVsYXkpO1xuICAgIGlmICghdGhpcy5fbmV4dCAmJiB0YXNrVGFpbCAhPT0gdGhpcykge1xuICAgICAgaWYgKHRhc2tUYWlsKSB0YXNrVGFpbC5fbmV4dCA9IHRoaXM7XG4gICAgICBlbHNlIHRhc2tIZWFkID0gdGhpcztcbiAgICAgIHRhc2tUYWlsID0gdGhpcztcbiAgICB9XG4gICAgdGhpcy5fY2FsbCA9IGNhbGxiYWNrO1xuICAgIHRoaXMuX3RpbWUgPSB0aW1lO1xuICAgIHNsZWVwKCk7XG4gIH0sXG4gIHN0b3A6IGZ1bmN0aW9uKCkge1xuICAgIGlmICh0aGlzLl9jYWxsKSB7XG4gICAgICB0aGlzLl9jYWxsID0gbnVsbDtcbiAgICAgIHRoaXMuX3RpbWUgPSBJbmZpbml0eTtcbiAgICAgIHNsZWVwKCk7XG4gICAgfVxuICB9XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gdGltZXIoY2FsbGJhY2ssIGRlbGF5LCB0aW1lKSB7XG4gIHZhciB0ID0gbmV3IFRpbWVyO1xuICB0LnJlc3RhcnQoY2FsbGJhY2ssIGRlbGF5LCB0aW1lKTtcbiAgcmV0dXJuIHQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB0aW1lckZsdXNoKCkge1xuICBub3coKTsgLy8gR2V0IHRoZSBjdXJyZW50IHRpbWUsIGlmIG5vdCBhbHJlYWR5IHNldC5cbiAgKytmcmFtZTsgLy8gUHJldGVuZCB3ZeKAmXZlIHNldCBhbiBhbGFybSwgaWYgd2UgaGF2ZW7igJl0IGFscmVhZHkuXG4gIHZhciB0ID0gdGFza0hlYWQsIGU7XG4gIHdoaWxlICh0KSB7XG4gICAgaWYgKChlID0gY2xvY2tOb3cgLSB0Ll90aW1lKSA+PSAwKSB0Ll9jYWxsLmNhbGwodW5kZWZpbmVkLCBlKTtcbiAgICB0ID0gdC5fbmV4dDtcbiAgfVxuICAtLWZyYW1lO1xufVxuXG5mdW5jdGlvbiB3YWtlKCkge1xuICBjbG9ja05vdyA9IChjbG9ja0xhc3QgPSBjbG9jay5ub3coKSkgKyBjbG9ja1NrZXc7XG4gIGZyYW1lID0gdGltZW91dCA9IDA7XG4gIHRyeSB7XG4gICAgdGltZXJGbHVzaCgpO1xuICB9IGZpbmFsbHkge1xuICAgIGZyYW1lID0gMDtcbiAgICBuYXAoKTtcbiAgICBjbG9ja05vdyA9IDA7XG4gIH1cbn1cblxuZnVuY3Rpb24gcG9rZSgpIHtcbiAgdmFyIG5vdyA9IGNsb2NrLm5vdygpLCBkZWxheSA9IG5vdyAtIGNsb2NrTGFzdDtcbiAgaWYgKGRlbGF5ID4gcG9rZURlbGF5KSBjbG9ja1NrZXcgLT0gZGVsYXksIGNsb2NrTGFzdCA9IG5vdztcbn1cblxuZnVuY3Rpb24gbmFwKCkge1xuICB2YXIgdDAsIHQxID0gdGFza0hlYWQsIHQyLCB0aW1lID0gSW5maW5pdHk7XG4gIHdoaWxlICh0MSkge1xuICAgIGlmICh0MS5fY2FsbCkge1xuICAgICAgaWYgKHRpbWUgPiB0MS5fdGltZSkgdGltZSA9IHQxLl90aW1lO1xuICAgICAgdDAgPSB0MSwgdDEgPSB0MS5fbmV4dDtcbiAgICB9IGVsc2Uge1xuICAgICAgdDIgPSB0MS5fbmV4dCwgdDEuX25leHQgPSBudWxsO1xuICAgICAgdDEgPSB0MCA/IHQwLl9uZXh0ID0gdDIgOiB0YXNrSGVhZCA9IHQyO1xuICAgIH1cbiAgfVxuICB0YXNrVGFpbCA9IHQwO1xuICBzbGVlcCh0aW1lKTtcbn1cblxuZnVuY3Rpb24gc2xlZXAodGltZSkge1xuICBpZiAoZnJhbWUpIHJldHVybjsgLy8gU29vbmVzdCBhbGFybSBhbHJlYWR5IHNldCwgb3Igd2lsbCBiZS5cbiAgaWYgKHRpbWVvdXQpIHRpbWVvdXQgPSBjbGVhclRpbWVvdXQodGltZW91dCk7XG4gIHZhciBkZWxheSA9IHRpbWUgLSBjbG9ja05vdzsgLy8gU3RyaWN0bHkgbGVzcyB0aGFuIGlmIHdlIHJlY29tcHV0ZWQgY2xvY2tOb3cuXG4gIGlmIChkZWxheSA+IDI0KSB7XG4gICAgaWYgKHRpbWUgPCBJbmZpbml0eSkgdGltZW91dCA9IHNldFRpbWVvdXQod2FrZSwgdGltZSAtIGNsb2NrLm5vdygpIC0gY2xvY2tTa2V3KTtcbiAgICBpZiAoaW50ZXJ2YWwpIGludGVydmFsID0gY2xlYXJJbnRlcnZhbChpbnRlcnZhbCk7XG4gIH0gZWxzZSB7XG4gICAgaWYgKCFpbnRlcnZhbCkgY2xvY2tMYXN0ID0gY2xvY2subm93KCksIGludGVydmFsID0gc2V0SW50ZXJ2YWwocG9rZSwgcG9rZURlbGF5KTtcbiAgICBmcmFtZSA9IDEsIHNldEZyYW1lKHdha2UpO1xuICB9XG59XG4iLCJpbXBvcnQge1RpbWVyfSBmcm9tIFwiLi90aW1lci5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbihjYWxsYmFjaywgZGVsYXksIHRpbWUpIHtcbiAgdmFyIHQgPSBuZXcgVGltZXI7XG4gIGRlbGF5ID0gZGVsYXkgPT0gbnVsbCA/IDAgOiArZGVsYXk7XG4gIHQucmVzdGFydChlbGFwc2VkID0+IHtcbiAgICB0LnN0b3AoKTtcbiAgICBjYWxsYmFjayhlbGFwc2VkICsgZGVsYXkpO1xuICB9LCBkZWxheSwgdGltZSk7XG4gIHJldHVybiB0O1xufVxuIiwiaW1wb3J0IHtkaXNwYXRjaH0gZnJvbSBcImQzLWRpc3BhdGNoXCI7XG5pbXBvcnQge3RpbWVyLCB0aW1lb3V0fSBmcm9tIFwiZDMtdGltZXJcIjtcblxudmFyIGVtcHR5T24gPSBkaXNwYXRjaChcInN0YXJ0XCIsIFwiZW5kXCIsIFwiY2FuY2VsXCIsIFwiaW50ZXJydXB0XCIpO1xudmFyIGVtcHR5VHdlZW4gPSBbXTtcblxuZXhwb3J0IHZhciBDUkVBVEVEID0gMDtcbmV4cG9ydCB2YXIgU0NIRURVTEVEID0gMTtcbmV4cG9ydCB2YXIgU1RBUlRJTkcgPSAyO1xuZXhwb3J0IHZhciBTVEFSVEVEID0gMztcbmV4cG9ydCB2YXIgUlVOTklORyA9IDQ7XG5leHBvcnQgdmFyIEVORElORyA9IDU7XG5leHBvcnQgdmFyIEVOREVEID0gNjtcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24obm9kZSwgbmFtZSwgaWQsIGluZGV4LCBncm91cCwgdGltaW5nKSB7XG4gIHZhciBzY2hlZHVsZXMgPSBub2RlLl9fdHJhbnNpdGlvbjtcbiAgaWYgKCFzY2hlZHVsZXMpIG5vZGUuX190cmFuc2l0aW9uID0ge307XG4gIGVsc2UgaWYgKGlkIGluIHNjaGVkdWxlcykgcmV0dXJuO1xuICBjcmVhdGUobm9kZSwgaWQsIHtcbiAgICBuYW1lOiBuYW1lLFxuICAgIGluZGV4OiBpbmRleCwgLy8gRm9yIGNvbnRleHQgZHVyaW5nIGNhbGxiYWNrLlxuICAgIGdyb3VwOiBncm91cCwgLy8gRm9yIGNvbnRleHQgZHVyaW5nIGNhbGxiYWNrLlxuICAgIG9uOiBlbXB0eU9uLFxuICAgIHR3ZWVuOiBlbXB0eVR3ZWVuLFxuICAgIHRpbWU6IHRpbWluZy50aW1lLFxuICAgIGRlbGF5OiB0aW1pbmcuZGVsYXksXG4gICAgZHVyYXRpb246IHRpbWluZy5kdXJhdGlvbixcbiAgICBlYXNlOiB0aW1pbmcuZWFzZSxcbiAgICB0aW1lcjogbnVsbCxcbiAgICBzdGF0ZTogQ1JFQVRFRFxuICB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGluaXQobm9kZSwgaWQpIHtcbiAgdmFyIHNjaGVkdWxlID0gZ2V0KG5vZGUsIGlkKTtcbiAgaWYgKHNjaGVkdWxlLnN0YXRlID4gQ1JFQVRFRCkgdGhyb3cgbmV3IEVycm9yKFwidG9vIGxhdGU7IGFscmVhZHkgc2NoZWR1bGVkXCIpO1xuICByZXR1cm4gc2NoZWR1bGU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzZXQobm9kZSwgaWQpIHtcbiAgdmFyIHNjaGVkdWxlID0gZ2V0KG5vZGUsIGlkKTtcbiAgaWYgKHNjaGVkdWxlLnN0YXRlID4gU1RBUlRFRCkgdGhyb3cgbmV3IEVycm9yKFwidG9vIGxhdGU7IGFscmVhZHkgcnVubmluZ1wiKTtcbiAgcmV0dXJuIHNjaGVkdWxlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0KG5vZGUsIGlkKSB7XG4gIHZhciBzY2hlZHVsZSA9IG5vZGUuX190cmFuc2l0aW9uO1xuICBpZiAoIXNjaGVkdWxlIHx8ICEoc2NoZWR1bGUgPSBzY2hlZHVsZVtpZF0pKSB0aHJvdyBuZXcgRXJyb3IoXCJ0cmFuc2l0aW9uIG5vdCBmb3VuZFwiKTtcbiAgcmV0dXJuIHNjaGVkdWxlO1xufVxuXG5mdW5jdGlvbiBjcmVhdGUobm9kZSwgaWQsIHNlbGYpIHtcbiAgdmFyIHNjaGVkdWxlcyA9IG5vZGUuX190cmFuc2l0aW9uLFxuICAgICAgdHdlZW47XG5cbiAgLy8gSW5pdGlhbGl6ZSB0aGUgc2VsZiB0aW1lciB3aGVuIHRoZSB0cmFuc2l0aW9uIGlzIGNyZWF0ZWQuXG4gIC8vIE5vdGUgdGhlIGFjdHVhbCBkZWxheSBpcyBub3Qga25vd24gdW50aWwgdGhlIGZpcnN0IGNhbGxiYWNrIVxuICBzY2hlZHVsZXNbaWRdID0gc2VsZjtcbiAgc2VsZi50aW1lciA9IHRpbWVyKHNjaGVkdWxlLCAwLCBzZWxmLnRpbWUpO1xuXG4gIGZ1bmN0aW9uIHNjaGVkdWxlKGVsYXBzZWQpIHtcbiAgICBzZWxmLnN0YXRlID0gU0NIRURVTEVEO1xuICAgIHNlbGYudGltZXIucmVzdGFydChzdGFydCwgc2VsZi5kZWxheSwgc2VsZi50aW1lKTtcblxuICAgIC8vIElmIHRoZSBlbGFwc2VkIGRlbGF5IGlzIGxlc3MgdGhhbiBvdXIgZmlyc3Qgc2xlZXAsIHN0YXJ0IGltbWVkaWF0ZWx5LlxuICAgIGlmIChzZWxmLmRlbGF5IDw9IGVsYXBzZWQpIHN0YXJ0KGVsYXBzZWQgLSBzZWxmLmRlbGF5KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHN0YXJ0KGVsYXBzZWQpIHtcbiAgICB2YXIgaSwgaiwgbiwgbztcblxuICAgIC8vIElmIHRoZSBzdGF0ZSBpcyBub3QgU0NIRURVTEVELCB0aGVuIHdlIHByZXZpb3VzbHkgZXJyb3JlZCBvbiBzdGFydC5cbiAgICBpZiAoc2VsZi5zdGF0ZSAhPT0gU0NIRURVTEVEKSByZXR1cm4gc3RvcCgpO1xuXG4gICAgZm9yIChpIGluIHNjaGVkdWxlcykge1xuICAgICAgbyA9IHNjaGVkdWxlc1tpXTtcbiAgICAgIGlmIChvLm5hbWUgIT09IHNlbGYubmFtZSkgY29udGludWU7XG5cbiAgICAgIC8vIFdoaWxlIHRoaXMgZWxlbWVudCBhbHJlYWR5IGhhcyBhIHN0YXJ0aW5nIHRyYW5zaXRpb24gZHVyaW5nIHRoaXMgZnJhbWUsXG4gICAgICAvLyBkZWZlciBzdGFydGluZyBhbiBpbnRlcnJ1cHRpbmcgdHJhbnNpdGlvbiB1bnRpbCB0aGF0IHRyYW5zaXRpb24gaGFzIGFcbiAgICAgIC8vIGNoYW5jZSB0byB0aWNrIChhbmQgcG9zc2libHkgZW5kKTsgc2VlIGQzL2QzLXRyYW5zaXRpb24jNTQhXG4gICAgICBpZiAoby5zdGF0ZSA9PT0gU1RBUlRFRCkgcmV0dXJuIHRpbWVvdXQoc3RhcnQpO1xuXG4gICAgICAvLyBJbnRlcnJ1cHQgdGhlIGFjdGl2ZSB0cmFuc2l0aW9uLCBpZiBhbnkuXG4gICAgICBpZiAoby5zdGF0ZSA9PT0gUlVOTklORykge1xuICAgICAgICBvLnN0YXRlID0gRU5ERUQ7XG4gICAgICAgIG8udGltZXIuc3RvcCgpO1xuICAgICAgICBvLm9uLmNhbGwoXCJpbnRlcnJ1cHRcIiwgbm9kZSwgbm9kZS5fX2RhdGFfXywgby5pbmRleCwgby5ncm91cCk7XG4gICAgICAgIGRlbGV0ZSBzY2hlZHVsZXNbaV07XG4gICAgICB9XG5cbiAgICAgIC8vIENhbmNlbCBhbnkgcHJlLWVtcHRlZCB0cmFuc2l0aW9ucy5cbiAgICAgIGVsc2UgaWYgKCtpIDwgaWQpIHtcbiAgICAgICAgby5zdGF0ZSA9IEVOREVEO1xuICAgICAgICBvLnRpbWVyLnN0b3AoKTtcbiAgICAgICAgby5vbi5jYWxsKFwiY2FuY2VsXCIsIG5vZGUsIG5vZGUuX19kYXRhX18sIG8uaW5kZXgsIG8uZ3JvdXApO1xuICAgICAgICBkZWxldGUgc2NoZWR1bGVzW2ldO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIERlZmVyIHRoZSBmaXJzdCB0aWNrIHRvIGVuZCBvZiB0aGUgY3VycmVudCBmcmFtZTsgc2VlIGQzL2QzIzE1NzYuXG4gICAgLy8gTm90ZSB0aGUgdHJhbnNpdGlvbiBtYXkgYmUgY2FuY2VsZWQgYWZ0ZXIgc3RhcnQgYW5kIGJlZm9yZSB0aGUgZmlyc3QgdGljayFcbiAgICAvLyBOb3RlIHRoaXMgbXVzdCBiZSBzY2hlZHVsZWQgYmVmb3JlIHRoZSBzdGFydCBldmVudDsgc2VlIGQzL2QzLXRyYW5zaXRpb24jMTYhXG4gICAgLy8gQXNzdW1pbmcgdGhpcyBpcyBzdWNjZXNzZnVsLCBzdWJzZXF1ZW50IGNhbGxiYWNrcyBnbyBzdHJhaWdodCB0byB0aWNrLlxuICAgIHRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoc2VsZi5zdGF0ZSA9PT0gU1RBUlRFRCkge1xuICAgICAgICBzZWxmLnN0YXRlID0gUlVOTklORztcbiAgICAgICAgc2VsZi50aW1lci5yZXN0YXJ0KHRpY2ssIHNlbGYuZGVsYXksIHNlbGYudGltZSk7XG4gICAgICAgIHRpY2soZWxhcHNlZCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBEaXNwYXRjaCB0aGUgc3RhcnQgZXZlbnQuXG4gICAgLy8gTm90ZSB0aGlzIG11c3QgYmUgZG9uZSBiZWZvcmUgdGhlIHR3ZWVuIGFyZSBpbml0aWFsaXplZC5cbiAgICBzZWxmLnN0YXRlID0gU1RBUlRJTkc7XG4gICAgc2VsZi5vbi5jYWxsKFwic3RhcnRcIiwgbm9kZSwgbm9kZS5fX2RhdGFfXywgc2VsZi5pbmRleCwgc2VsZi5ncm91cCk7XG4gICAgaWYgKHNlbGYuc3RhdGUgIT09IFNUQVJUSU5HKSByZXR1cm47IC8vIGludGVycnVwdGVkXG4gICAgc2VsZi5zdGF0ZSA9IFNUQVJURUQ7XG5cbiAgICAvLyBJbml0aWFsaXplIHRoZSB0d2VlbiwgZGVsZXRpbmcgbnVsbCB0d2Vlbi5cbiAgICB0d2VlbiA9IG5ldyBBcnJheShuID0gc2VsZi50d2Vlbi5sZW5ndGgpO1xuICAgIGZvciAoaSA9IDAsIGogPSAtMTsgaSA8IG47ICsraSkge1xuICAgICAgaWYgKG8gPSBzZWxmLnR3ZWVuW2ldLnZhbHVlLmNhbGwobm9kZSwgbm9kZS5fX2RhdGFfXywgc2VsZi5pbmRleCwgc2VsZi5ncm91cCkpIHtcbiAgICAgICAgdHdlZW5bKytqXSA9IG87XG4gICAgICB9XG4gICAgfVxuICAgIHR3ZWVuLmxlbmd0aCA9IGogKyAxO1xuICB9XG5cbiAgZnVuY3Rpb24gdGljayhlbGFwc2VkKSB7XG4gICAgdmFyIHQgPSBlbGFwc2VkIDwgc2VsZi5kdXJhdGlvbiA/IHNlbGYuZWFzZS5jYWxsKG51bGwsIGVsYXBzZWQgLyBzZWxmLmR1cmF0aW9uKSA6IChzZWxmLnRpbWVyLnJlc3RhcnQoc3RvcCksIHNlbGYuc3RhdGUgPSBFTkRJTkcsIDEpLFxuICAgICAgICBpID0gLTEsXG4gICAgICAgIG4gPSB0d2Vlbi5sZW5ndGg7XG5cbiAgICB3aGlsZSAoKytpIDwgbikge1xuICAgICAgdHdlZW5baV0uY2FsbChub2RlLCB0KTtcbiAgICB9XG5cbiAgICAvLyBEaXNwYXRjaCB0aGUgZW5kIGV2ZW50LlxuICAgIGlmIChzZWxmLnN0YXRlID09PSBFTkRJTkcpIHtcbiAgICAgIHNlbGYub24uY2FsbChcImVuZFwiLCBub2RlLCBub2RlLl9fZGF0YV9fLCBzZWxmLmluZGV4LCBzZWxmLmdyb3VwKTtcbiAgICAgIHN0b3AoKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBzdG9wKCkge1xuICAgIHNlbGYuc3RhdGUgPSBFTkRFRDtcbiAgICBzZWxmLnRpbWVyLnN0b3AoKTtcbiAgICBkZWxldGUgc2NoZWR1bGVzW2lkXTtcbiAgICBmb3IgKHZhciBpIGluIHNjaGVkdWxlcykgcmV0dXJuOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVudXNlZC12YXJzXG4gICAgZGVsZXRlIG5vZGUuX190cmFuc2l0aW9uO1xuICB9XG59XG4iLCJpbXBvcnQge2dldCwgc2V0fSBmcm9tIFwiLi9zY2hlZHVsZS5qc1wiO1xuXG5mdW5jdGlvbiB0d2VlblJlbW92ZShpZCwgbmFtZSkge1xuICB2YXIgdHdlZW4wLCB0d2VlbjE7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICB2YXIgc2NoZWR1bGUgPSBzZXQodGhpcywgaWQpLFxuICAgICAgICB0d2VlbiA9IHNjaGVkdWxlLnR3ZWVuO1xuXG4gICAgLy8gSWYgdGhpcyBub2RlIHNoYXJlZCB0d2VlbiB3aXRoIHRoZSBwcmV2aW91cyBub2RlLFxuICAgIC8vIGp1c3QgYXNzaWduIHRoZSB1cGRhdGVkIHNoYXJlZCB0d2VlbiBhbmQgd2XigJlyZSBkb25lIVxuICAgIC8vIE90aGVyd2lzZSwgY29weS1vbi13cml0ZS5cbiAgICBpZiAodHdlZW4gIT09IHR3ZWVuMCkge1xuICAgICAgdHdlZW4xID0gdHdlZW4wID0gdHdlZW47XG4gICAgICBmb3IgKHZhciBpID0gMCwgbiA9IHR3ZWVuMS5sZW5ndGg7IGkgPCBuOyArK2kpIHtcbiAgICAgICAgaWYgKHR3ZWVuMVtpXS5uYW1lID09PSBuYW1lKSB7XG4gICAgICAgICAgdHdlZW4xID0gdHdlZW4xLnNsaWNlKCk7XG4gICAgICAgICAgdHdlZW4xLnNwbGljZShpLCAxKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHNjaGVkdWxlLnR3ZWVuID0gdHdlZW4xO1xuICB9O1xufVxuXG5mdW5jdGlvbiB0d2VlbkZ1bmN0aW9uKGlkLCBuYW1lLCB2YWx1ZSkge1xuICB2YXIgdHdlZW4wLCB0d2VlbjE7XG4gIGlmICh0eXBlb2YgdmFsdWUgIT09IFwiZnVuY3Rpb25cIikgdGhyb3cgbmV3IEVycm9yO1xuICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHNjaGVkdWxlID0gc2V0KHRoaXMsIGlkKSxcbiAgICAgICAgdHdlZW4gPSBzY2hlZHVsZS50d2VlbjtcblxuICAgIC8vIElmIHRoaXMgbm9kZSBzaGFyZWQgdHdlZW4gd2l0aCB0aGUgcHJldmlvdXMgbm9kZSxcbiAgICAvLyBqdXN0IGFzc2lnbiB0aGUgdXBkYXRlZCBzaGFyZWQgdHdlZW4gYW5kIHdl4oCZcmUgZG9uZSFcbiAgICAvLyBPdGhlcndpc2UsIGNvcHktb24td3JpdGUuXG4gICAgaWYgKHR3ZWVuICE9PSB0d2VlbjApIHtcbiAgICAgIHR3ZWVuMSA9ICh0d2VlbjAgPSB0d2Vlbikuc2xpY2UoKTtcbiAgICAgIGZvciAodmFyIHQgPSB7bmFtZTogbmFtZSwgdmFsdWU6IHZhbHVlfSwgaSA9IDAsIG4gPSB0d2VlbjEubGVuZ3RoOyBpIDwgbjsgKytpKSB7XG4gICAgICAgIGlmICh0d2VlbjFbaV0ubmFtZSA9PT0gbmFtZSkge1xuICAgICAgICAgIHR3ZWVuMVtpXSA9IHQ7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChpID09PSBuKSB0d2VlbjEucHVzaCh0KTtcbiAgICB9XG5cbiAgICBzY2hlZHVsZS50d2VlbiA9IHR3ZWVuMTtcbiAgfTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24obmFtZSwgdmFsdWUpIHtcbiAgdmFyIGlkID0gdGhpcy5faWQ7XG5cbiAgbmFtZSArPSBcIlwiO1xuXG4gIGlmIChhcmd1bWVudHMubGVuZ3RoIDwgMikge1xuICAgIHZhciB0d2VlbiA9IGdldCh0aGlzLm5vZGUoKSwgaWQpLnR3ZWVuO1xuICAgIGZvciAodmFyIGkgPSAwLCBuID0gdHdlZW4ubGVuZ3RoLCB0OyBpIDwgbjsgKytpKSB7XG4gICAgICBpZiAoKHQgPSB0d2VlbltpXSkubmFtZSA9PT0gbmFtZSkge1xuICAgICAgICByZXR1cm4gdC52YWx1ZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICByZXR1cm4gdGhpcy5lYWNoKCh2YWx1ZSA9PSBudWxsID8gdHdlZW5SZW1vdmUgOiB0d2VlbkZ1bmN0aW9uKShpZCwgbmFtZSwgdmFsdWUpKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHR3ZWVuVmFsdWUodHJhbnNpdGlvbiwgbmFtZSwgdmFsdWUpIHtcbiAgdmFyIGlkID0gdHJhbnNpdGlvbi5faWQ7XG5cbiAgdHJhbnNpdGlvbi5lYWNoKGZ1bmN0aW9uKCkge1xuICAgIHZhciBzY2hlZHVsZSA9IHNldCh0aGlzLCBpZCk7XG4gICAgKHNjaGVkdWxlLnZhbHVlIHx8IChzY2hlZHVsZS52YWx1ZSA9IHt9KSlbbmFtZV0gPSB2YWx1ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9KTtcblxuICByZXR1cm4gZnVuY3Rpb24obm9kZSkge1xuICAgIHJldHVybiBnZXQobm9kZSwgaWQpLnZhbHVlW25hbWVdO1xuICB9O1xufVxuIiwiaW1wb3J0IHtjb2xvcn0gZnJvbSBcImQzLWNvbG9yXCI7XG5pbXBvcnQge2ludGVycG9sYXRlTnVtYmVyLCBpbnRlcnBvbGF0ZVJnYiwgaW50ZXJwb2xhdGVTdHJpbmd9IGZyb20gXCJkMy1pbnRlcnBvbGF0ZVwiO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbihhLCBiKSB7XG4gIHZhciBjO1xuICByZXR1cm4gKHR5cGVvZiBiID09PSBcIm51bWJlclwiID8gaW50ZXJwb2xhdGVOdW1iZXJcbiAgICAgIDogYiBpbnN0YW5jZW9mIGNvbG9yID8gaW50ZXJwb2xhdGVSZ2JcbiAgICAgIDogKGMgPSBjb2xvcihiKSkgPyAoYiA9IGMsIGludGVycG9sYXRlUmdiKVxuICAgICAgOiBpbnRlcnBvbGF0ZVN0cmluZykoYSwgYik7XG59XG4iLCJpbXBvcnQge2ludGVycG9sYXRlVHJhbnNmb3JtU3ZnIGFzIGludGVycG9sYXRlVHJhbnNmb3JtfSBmcm9tIFwiZDMtaW50ZXJwb2xhdGVcIjtcbmltcG9ydCB7bmFtZXNwYWNlfSBmcm9tIFwiZDMtc2VsZWN0aW9uXCI7XG5pbXBvcnQge3R3ZWVuVmFsdWV9IGZyb20gXCIuL3R3ZWVuLmpzXCI7XG5pbXBvcnQgaW50ZXJwb2xhdGUgZnJvbSBcIi4vaW50ZXJwb2xhdGUuanNcIjtcblxuZnVuY3Rpb24gYXR0clJlbW92ZShuYW1lKSB7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLnJlbW92ZUF0dHJpYnV0ZShuYW1lKTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gYXR0clJlbW92ZU5TKGZ1bGxuYW1lKSB7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLnJlbW92ZUF0dHJpYnV0ZU5TKGZ1bGxuYW1lLnNwYWNlLCBmdWxsbmFtZS5sb2NhbCk7XG4gIH07XG59XG5cbmZ1bmN0aW9uIGF0dHJDb25zdGFudChuYW1lLCBpbnRlcnBvbGF0ZSwgdmFsdWUxKSB7XG4gIHZhciBzdHJpbmcwMCxcbiAgICAgIHN0cmluZzEgPSB2YWx1ZTEgKyBcIlwiLFxuICAgICAgaW50ZXJwb2xhdGUwO1xuICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHN0cmluZzAgPSB0aGlzLmdldEF0dHJpYnV0ZShuYW1lKTtcbiAgICByZXR1cm4gc3RyaW5nMCA9PT0gc3RyaW5nMSA/IG51bGxcbiAgICAgICAgOiBzdHJpbmcwID09PSBzdHJpbmcwMCA/IGludGVycG9sYXRlMFxuICAgICAgICA6IGludGVycG9sYXRlMCA9IGludGVycG9sYXRlKHN0cmluZzAwID0gc3RyaW5nMCwgdmFsdWUxKTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gYXR0ckNvbnN0YW50TlMoZnVsbG5hbWUsIGludGVycG9sYXRlLCB2YWx1ZTEpIHtcbiAgdmFyIHN0cmluZzAwLFxuICAgICAgc3RyaW5nMSA9IHZhbHVlMSArIFwiXCIsXG4gICAgICBpbnRlcnBvbGF0ZTA7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICB2YXIgc3RyaW5nMCA9IHRoaXMuZ2V0QXR0cmlidXRlTlMoZnVsbG5hbWUuc3BhY2UsIGZ1bGxuYW1lLmxvY2FsKTtcbiAgICByZXR1cm4gc3RyaW5nMCA9PT0gc3RyaW5nMSA/IG51bGxcbiAgICAgICAgOiBzdHJpbmcwID09PSBzdHJpbmcwMCA/IGludGVycG9sYXRlMFxuICAgICAgICA6IGludGVycG9sYXRlMCA9IGludGVycG9sYXRlKHN0cmluZzAwID0gc3RyaW5nMCwgdmFsdWUxKTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gYXR0ckZ1bmN0aW9uKG5hbWUsIGludGVycG9sYXRlLCB2YWx1ZSkge1xuICB2YXIgc3RyaW5nMDAsXG4gICAgICBzdHJpbmcxMCxcbiAgICAgIGludGVycG9sYXRlMDtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHZhciBzdHJpbmcwLCB2YWx1ZTEgPSB2YWx1ZSh0aGlzKSwgc3RyaW5nMTtcbiAgICBpZiAodmFsdWUxID09IG51bGwpIHJldHVybiB2b2lkIHRoaXMucmVtb3ZlQXR0cmlidXRlKG5hbWUpO1xuICAgIHN0cmluZzAgPSB0aGlzLmdldEF0dHJpYnV0ZShuYW1lKTtcbiAgICBzdHJpbmcxID0gdmFsdWUxICsgXCJcIjtcbiAgICByZXR1cm4gc3RyaW5nMCA9PT0gc3RyaW5nMSA/IG51bGxcbiAgICAgICAgOiBzdHJpbmcwID09PSBzdHJpbmcwMCAmJiBzdHJpbmcxID09PSBzdHJpbmcxMCA/IGludGVycG9sYXRlMFxuICAgICAgICA6IChzdHJpbmcxMCA9IHN0cmluZzEsIGludGVycG9sYXRlMCA9IGludGVycG9sYXRlKHN0cmluZzAwID0gc3RyaW5nMCwgdmFsdWUxKSk7XG4gIH07XG59XG5cbmZ1bmN0aW9uIGF0dHJGdW5jdGlvbk5TKGZ1bGxuYW1lLCBpbnRlcnBvbGF0ZSwgdmFsdWUpIHtcbiAgdmFyIHN0cmluZzAwLFxuICAgICAgc3RyaW5nMTAsXG4gICAgICBpbnRlcnBvbGF0ZTA7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICB2YXIgc3RyaW5nMCwgdmFsdWUxID0gdmFsdWUodGhpcyksIHN0cmluZzE7XG4gICAgaWYgKHZhbHVlMSA9PSBudWxsKSByZXR1cm4gdm9pZCB0aGlzLnJlbW92ZUF0dHJpYnV0ZU5TKGZ1bGxuYW1lLnNwYWNlLCBmdWxsbmFtZS5sb2NhbCk7XG4gICAgc3RyaW5nMCA9IHRoaXMuZ2V0QXR0cmlidXRlTlMoZnVsbG5hbWUuc3BhY2UsIGZ1bGxuYW1lLmxvY2FsKTtcbiAgICBzdHJpbmcxID0gdmFsdWUxICsgXCJcIjtcbiAgICByZXR1cm4gc3RyaW5nMCA9PT0gc3RyaW5nMSA/IG51bGxcbiAgICAgICAgOiBzdHJpbmcwID09PSBzdHJpbmcwMCAmJiBzdHJpbmcxID09PSBzdHJpbmcxMCA/IGludGVycG9sYXRlMFxuICAgICAgICA6IChzdHJpbmcxMCA9IHN0cmluZzEsIGludGVycG9sYXRlMCA9IGludGVycG9sYXRlKHN0cmluZzAwID0gc3RyaW5nMCwgdmFsdWUxKSk7XG4gIH07XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7XG4gIHZhciBmdWxsbmFtZSA9IG5hbWVzcGFjZShuYW1lKSwgaSA9IGZ1bGxuYW1lID09PSBcInRyYW5zZm9ybVwiID8gaW50ZXJwb2xhdGVUcmFuc2Zvcm0gOiBpbnRlcnBvbGF0ZTtcbiAgcmV0dXJuIHRoaXMuYXR0clR3ZWVuKG5hbWUsIHR5cGVvZiB2YWx1ZSA9PT0gXCJmdW5jdGlvblwiXG4gICAgICA/IChmdWxsbmFtZS5sb2NhbCA/IGF0dHJGdW5jdGlvbk5TIDogYXR0ckZ1bmN0aW9uKShmdWxsbmFtZSwgaSwgdHdlZW5WYWx1ZSh0aGlzLCBcImF0dHIuXCIgKyBuYW1lLCB2YWx1ZSkpXG4gICAgICA6IHZhbHVlID09IG51bGwgPyAoZnVsbG5hbWUubG9jYWwgPyBhdHRyUmVtb3ZlTlMgOiBhdHRyUmVtb3ZlKShmdWxsbmFtZSlcbiAgICAgIDogKGZ1bGxuYW1lLmxvY2FsID8gYXR0ckNvbnN0YW50TlMgOiBhdHRyQ29uc3RhbnQpKGZ1bGxuYW1lLCBpLCB2YWx1ZSkpO1xufVxuIiwiaW1wb3J0IHtuYW1lc3BhY2V9IGZyb20gXCJkMy1zZWxlY3Rpb25cIjtcblxuZnVuY3Rpb24gYXR0ckludGVycG9sYXRlKG5hbWUsIGkpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKHQpIHtcbiAgICB0aGlzLnNldEF0dHJpYnV0ZShuYW1lLCBpLmNhbGwodGhpcywgdCkpO1xuICB9O1xufVxuXG5mdW5jdGlvbiBhdHRySW50ZXJwb2xhdGVOUyhmdWxsbmFtZSwgaSkge1xuICByZXR1cm4gZnVuY3Rpb24odCkge1xuICAgIHRoaXMuc2V0QXR0cmlidXRlTlMoZnVsbG5hbWUuc3BhY2UsIGZ1bGxuYW1lLmxvY2FsLCBpLmNhbGwodGhpcywgdCkpO1xuICB9O1xufVxuXG5mdW5jdGlvbiBhdHRyVHdlZW5OUyhmdWxsbmFtZSwgdmFsdWUpIHtcbiAgdmFyIHQwLCBpMDtcbiAgZnVuY3Rpb24gdHdlZW4oKSB7XG4gICAgdmFyIGkgPSB2YWx1ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIGlmIChpICE9PSBpMCkgdDAgPSAoaTAgPSBpKSAmJiBhdHRySW50ZXJwb2xhdGVOUyhmdWxsbmFtZSwgaSk7XG4gICAgcmV0dXJuIHQwO1xuICB9XG4gIHR3ZWVuLl92YWx1ZSA9IHZhbHVlO1xuICByZXR1cm4gdHdlZW47XG59XG5cbmZ1bmN0aW9uIGF0dHJUd2VlbihuYW1lLCB2YWx1ZSkge1xuICB2YXIgdDAsIGkwO1xuICBmdW5jdGlvbiB0d2VlbigpIHtcbiAgICB2YXIgaSA9IHZhbHVlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgaWYgKGkgIT09IGkwKSB0MCA9IChpMCA9IGkpICYmIGF0dHJJbnRlcnBvbGF0ZShuYW1lLCBpKTtcbiAgICByZXR1cm4gdDA7XG4gIH1cbiAgdHdlZW4uX3ZhbHVlID0gdmFsdWU7XG4gIHJldHVybiB0d2Vlbjtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24obmFtZSwgdmFsdWUpIHtcbiAgdmFyIGtleSA9IFwiYXR0ci5cIiArIG5hbWU7XG4gIGlmIChhcmd1bWVudHMubGVuZ3RoIDwgMikgcmV0dXJuIChrZXkgPSB0aGlzLnR3ZWVuKGtleSkpICYmIGtleS5fdmFsdWU7XG4gIGlmICh2YWx1ZSA9PSBudWxsKSByZXR1cm4gdGhpcy50d2VlbihrZXksIG51bGwpO1xuICBpZiAodHlwZW9mIHZhbHVlICE9PSBcImZ1bmN0aW9uXCIpIHRocm93IG5ldyBFcnJvcjtcbiAgdmFyIGZ1bGxuYW1lID0gbmFtZXNwYWNlKG5hbWUpO1xuICByZXR1cm4gdGhpcy50d2VlbihrZXksIChmdWxsbmFtZS5sb2NhbCA/IGF0dHJUd2Vlbk5TIDogYXR0clR3ZWVuKShmdWxsbmFtZSwgdmFsdWUpKTtcbn1cbiIsImltcG9ydCB7Z2V0LCBpbml0fSBmcm9tIFwiLi9zY2hlZHVsZS5qc1wiO1xuXG5mdW5jdGlvbiBkZWxheUZ1bmN0aW9uKGlkLCB2YWx1ZSkge1xuICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgaW5pdCh0aGlzLCBpZCkuZGVsYXkgPSArdmFsdWUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gZGVsYXlDb25zdGFudChpZCwgdmFsdWUpIHtcbiAgcmV0dXJuIHZhbHVlID0gK3ZhbHVlLCBmdW5jdGlvbigpIHtcbiAgICBpbml0KHRoaXMsIGlkKS5kZWxheSA9IHZhbHVlO1xuICB9O1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbih2YWx1ZSkge1xuICB2YXIgaWQgPSB0aGlzLl9pZDtcblxuICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aFxuICAgICAgPyB0aGlzLmVhY2goKHR5cGVvZiB2YWx1ZSA9PT0gXCJmdW5jdGlvblwiXG4gICAgICAgICAgPyBkZWxheUZ1bmN0aW9uXG4gICAgICAgICAgOiBkZWxheUNvbnN0YW50KShpZCwgdmFsdWUpKVxuICAgICAgOiBnZXQodGhpcy5ub2RlKCksIGlkKS5kZWxheTtcbn1cbiIsImltcG9ydCB7Z2V0LCBzZXR9IGZyb20gXCIuL3NjaGVkdWxlLmpzXCI7XG5cbmZ1bmN0aW9uIGR1cmF0aW9uRnVuY3Rpb24oaWQsIHZhbHVlKSB7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICBzZXQodGhpcywgaWQpLmR1cmF0aW9uID0gK3ZhbHVlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG59XG5cbmZ1bmN0aW9uIGR1cmF0aW9uQ29uc3RhbnQoaWQsIHZhbHVlKSB7XG4gIHJldHVybiB2YWx1ZSA9ICt2YWx1ZSwgZnVuY3Rpb24oKSB7XG4gICAgc2V0KHRoaXMsIGlkKS5kdXJhdGlvbiA9IHZhbHVlO1xuICB9O1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbih2YWx1ZSkge1xuICB2YXIgaWQgPSB0aGlzLl9pZDtcblxuICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aFxuICAgICAgPyB0aGlzLmVhY2goKHR5cGVvZiB2YWx1ZSA9PT0gXCJmdW5jdGlvblwiXG4gICAgICAgICAgPyBkdXJhdGlvbkZ1bmN0aW9uXG4gICAgICAgICAgOiBkdXJhdGlvbkNvbnN0YW50KShpZCwgdmFsdWUpKVxuICAgICAgOiBnZXQodGhpcy5ub2RlKCksIGlkKS5kdXJhdGlvbjtcbn1cbiIsImltcG9ydCB7Z2V0LCBzZXR9IGZyb20gXCIuL3NjaGVkdWxlLmpzXCI7XG5cbmZ1bmN0aW9uIGVhc2VDb25zdGFudChpZCwgdmFsdWUpIHtcbiAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gXCJmdW5jdGlvblwiKSB0aHJvdyBuZXcgRXJyb3I7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICBzZXQodGhpcywgaWQpLmVhc2UgPSB2YWx1ZTtcbiAgfTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24odmFsdWUpIHtcbiAgdmFyIGlkID0gdGhpcy5faWQ7XG5cbiAgcmV0dXJuIGFyZ3VtZW50cy5sZW5ndGhcbiAgICAgID8gdGhpcy5lYWNoKGVhc2VDb25zdGFudChpZCwgdmFsdWUpKVxuICAgICAgOiBnZXQodGhpcy5ub2RlKCksIGlkKS5lYXNlO1xufVxuIiwiaW1wb3J0IHtnZXQsIHNldCwgaW5pdH0gZnJvbSBcIi4vc2NoZWR1bGUuanNcIjtcblxuZnVuY3Rpb24gc3RhcnQobmFtZSkge1xuICByZXR1cm4gKG5hbWUgKyBcIlwiKS50cmltKCkuc3BsaXQoL158XFxzKy8pLmV2ZXJ5KGZ1bmN0aW9uKHQpIHtcbiAgICB2YXIgaSA9IHQuaW5kZXhPZihcIi5cIik7XG4gICAgaWYgKGkgPj0gMCkgdCA9IHQuc2xpY2UoMCwgaSk7XG4gICAgcmV0dXJuICF0IHx8IHQgPT09IFwic3RhcnRcIjtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIG9uRnVuY3Rpb24oaWQsIG5hbWUsIGxpc3RlbmVyKSB7XG4gIHZhciBvbjAsIG9uMSwgc2l0ID0gc3RhcnQobmFtZSkgPyBpbml0IDogc2V0O1xuICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHNjaGVkdWxlID0gc2l0KHRoaXMsIGlkKSxcbiAgICAgICAgb24gPSBzY2hlZHVsZS5vbjtcblxuICAgIC8vIElmIHRoaXMgbm9kZSBzaGFyZWQgYSBkaXNwYXRjaCB3aXRoIHRoZSBwcmV2aW91cyBub2RlLFxuICAgIC8vIGp1c3QgYXNzaWduIHRoZSB1cGRhdGVkIHNoYXJlZCBkaXNwYXRjaCBhbmQgd2XigJlyZSBkb25lIVxuICAgIC8vIE90aGVyd2lzZSwgY29weS1vbi13cml0ZS5cbiAgICBpZiAob24gIT09IG9uMCkgKG9uMSA9IChvbjAgPSBvbikuY29weSgpKS5vbihuYW1lLCBsaXN0ZW5lcik7XG5cbiAgICBzY2hlZHVsZS5vbiA9IG9uMTtcbiAgfTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24obmFtZSwgbGlzdGVuZXIpIHtcbiAgdmFyIGlkID0gdGhpcy5faWQ7XG5cbiAgcmV0dXJuIGFyZ3VtZW50cy5sZW5ndGggPCAyXG4gICAgICA/IGdldCh0aGlzLm5vZGUoKSwgaWQpLm9uLm9uKG5hbWUpXG4gICAgICA6IHRoaXMuZWFjaChvbkZ1bmN0aW9uKGlkLCBuYW1lLCBsaXN0ZW5lcikpO1xufVxuIiwiaW1wb3J0IHtzZWxlY3Rpb259IGZyb20gXCJkMy1zZWxlY3Rpb25cIjtcblxudmFyIFNlbGVjdGlvbiA9IHNlbGVjdGlvbi5wcm90b3R5cGUuY29uc3RydWN0b3I7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gbmV3IFNlbGVjdGlvbih0aGlzLl9ncm91cHMsIHRoaXMuX3BhcmVudHMpO1xufVxuIiwiaW1wb3J0IHtpbnRlcnBvbGF0ZVRyYW5zZm9ybUNzcyBhcyBpbnRlcnBvbGF0ZVRyYW5zZm9ybX0gZnJvbSBcImQzLWludGVycG9sYXRlXCI7XG5pbXBvcnQge3N0eWxlfSBmcm9tIFwiZDMtc2VsZWN0aW9uXCI7XG5pbXBvcnQge3NldH0gZnJvbSBcIi4vc2NoZWR1bGUuanNcIjtcbmltcG9ydCB7dHdlZW5WYWx1ZX0gZnJvbSBcIi4vdHdlZW4uanNcIjtcbmltcG9ydCBpbnRlcnBvbGF0ZSBmcm9tIFwiLi9pbnRlcnBvbGF0ZS5qc1wiO1xuXG5mdW5jdGlvbiBzdHlsZU51bGwobmFtZSwgaW50ZXJwb2xhdGUpIHtcbiAgdmFyIHN0cmluZzAwLFxuICAgICAgc3RyaW5nMTAsXG4gICAgICBpbnRlcnBvbGF0ZTA7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICB2YXIgc3RyaW5nMCA9IHN0eWxlKHRoaXMsIG5hbWUpLFxuICAgICAgICBzdHJpbmcxID0gKHRoaXMuc3R5bGUucmVtb3ZlUHJvcGVydHkobmFtZSksIHN0eWxlKHRoaXMsIG5hbWUpKTtcbiAgICByZXR1cm4gc3RyaW5nMCA9PT0gc3RyaW5nMSA/IG51bGxcbiAgICAgICAgOiBzdHJpbmcwID09PSBzdHJpbmcwMCAmJiBzdHJpbmcxID09PSBzdHJpbmcxMCA/IGludGVycG9sYXRlMFxuICAgICAgICA6IGludGVycG9sYXRlMCA9IGludGVycG9sYXRlKHN0cmluZzAwID0gc3RyaW5nMCwgc3RyaW5nMTAgPSBzdHJpbmcxKTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gc3R5bGVSZW1vdmUobmFtZSkge1xuICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5zdHlsZS5yZW1vdmVQcm9wZXJ0eShuYW1lKTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gc3R5bGVDb25zdGFudChuYW1lLCBpbnRlcnBvbGF0ZSwgdmFsdWUxKSB7XG4gIHZhciBzdHJpbmcwMCxcbiAgICAgIHN0cmluZzEgPSB2YWx1ZTEgKyBcIlwiLFxuICAgICAgaW50ZXJwb2xhdGUwO1xuICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHN0cmluZzAgPSBzdHlsZSh0aGlzLCBuYW1lKTtcbiAgICByZXR1cm4gc3RyaW5nMCA9PT0gc3RyaW5nMSA/IG51bGxcbiAgICAgICAgOiBzdHJpbmcwID09PSBzdHJpbmcwMCA/IGludGVycG9sYXRlMFxuICAgICAgICA6IGludGVycG9sYXRlMCA9IGludGVycG9sYXRlKHN0cmluZzAwID0gc3RyaW5nMCwgdmFsdWUxKTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gc3R5bGVGdW5jdGlvbihuYW1lLCBpbnRlcnBvbGF0ZSwgdmFsdWUpIHtcbiAgdmFyIHN0cmluZzAwLFxuICAgICAgc3RyaW5nMTAsXG4gICAgICBpbnRlcnBvbGF0ZTA7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICB2YXIgc3RyaW5nMCA9IHN0eWxlKHRoaXMsIG5hbWUpLFxuICAgICAgICB2YWx1ZTEgPSB2YWx1ZSh0aGlzKSxcbiAgICAgICAgc3RyaW5nMSA9IHZhbHVlMSArIFwiXCI7XG4gICAgaWYgKHZhbHVlMSA9PSBudWxsKSBzdHJpbmcxID0gdmFsdWUxID0gKHRoaXMuc3R5bGUucmVtb3ZlUHJvcGVydHkobmFtZSksIHN0eWxlKHRoaXMsIG5hbWUpKTtcbiAgICByZXR1cm4gc3RyaW5nMCA9PT0gc3RyaW5nMSA/IG51bGxcbiAgICAgICAgOiBzdHJpbmcwID09PSBzdHJpbmcwMCAmJiBzdHJpbmcxID09PSBzdHJpbmcxMCA/IGludGVycG9sYXRlMFxuICAgICAgICA6IChzdHJpbmcxMCA9IHN0cmluZzEsIGludGVycG9sYXRlMCA9IGludGVycG9sYXRlKHN0cmluZzAwID0gc3RyaW5nMCwgdmFsdWUxKSk7XG4gIH07XG59XG5cbmZ1bmN0aW9uIHN0eWxlTWF5YmVSZW1vdmUoaWQsIG5hbWUpIHtcbiAgdmFyIG9uMCwgb24xLCBsaXN0ZW5lcjAsIGtleSA9IFwic3R5bGUuXCIgKyBuYW1lLCBldmVudCA9IFwiZW5kLlwiICsga2V5LCByZW1vdmU7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICB2YXIgc2NoZWR1bGUgPSBzZXQodGhpcywgaWQpLFxuICAgICAgICBvbiA9IHNjaGVkdWxlLm9uLFxuICAgICAgICBsaXN0ZW5lciA9IHNjaGVkdWxlLnZhbHVlW2tleV0gPT0gbnVsbCA/IHJlbW92ZSB8fCAocmVtb3ZlID0gc3R5bGVSZW1vdmUobmFtZSkpIDogdW5kZWZpbmVkO1xuXG4gICAgLy8gSWYgdGhpcyBub2RlIHNoYXJlZCBhIGRpc3BhdGNoIHdpdGggdGhlIHByZXZpb3VzIG5vZGUsXG4gICAgLy8ganVzdCBhc3NpZ24gdGhlIHVwZGF0ZWQgc2hhcmVkIGRpc3BhdGNoIGFuZCB3ZeKAmXJlIGRvbmUhXG4gICAgLy8gT3RoZXJ3aXNlLCBjb3B5LW9uLXdyaXRlLlxuICAgIGlmIChvbiAhPT0gb24wIHx8IGxpc3RlbmVyMCAhPT0gbGlzdGVuZXIpIChvbjEgPSAob24wID0gb24pLmNvcHkoKSkub24oZXZlbnQsIGxpc3RlbmVyMCA9IGxpc3RlbmVyKTtcblxuICAgIHNjaGVkdWxlLm9uID0gb24xO1xuICB9O1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbihuYW1lLCB2YWx1ZSwgcHJpb3JpdHkpIHtcbiAgdmFyIGkgPSAobmFtZSArPSBcIlwiKSA9PT0gXCJ0cmFuc2Zvcm1cIiA/IGludGVycG9sYXRlVHJhbnNmb3JtIDogaW50ZXJwb2xhdGU7XG4gIHJldHVybiB2YWx1ZSA9PSBudWxsID8gdGhpc1xuICAgICAgLnN0eWxlVHdlZW4obmFtZSwgc3R5bGVOdWxsKG5hbWUsIGkpKVxuICAgICAgLm9uKFwiZW5kLnN0eWxlLlwiICsgbmFtZSwgc3R5bGVSZW1vdmUobmFtZSkpXG4gICAgOiB0eXBlb2YgdmFsdWUgPT09IFwiZnVuY3Rpb25cIiA/IHRoaXNcbiAgICAgIC5zdHlsZVR3ZWVuKG5hbWUsIHN0eWxlRnVuY3Rpb24obmFtZSwgaSwgdHdlZW5WYWx1ZSh0aGlzLCBcInN0eWxlLlwiICsgbmFtZSwgdmFsdWUpKSlcbiAgICAgIC5lYWNoKHN0eWxlTWF5YmVSZW1vdmUodGhpcy5faWQsIG5hbWUpKVxuICAgIDogdGhpc1xuICAgICAgLnN0eWxlVHdlZW4obmFtZSwgc3R5bGVDb25zdGFudChuYW1lLCBpLCB2YWx1ZSksIHByaW9yaXR5KVxuICAgICAgLm9uKFwiZW5kLnN0eWxlLlwiICsgbmFtZSwgbnVsbCk7XG59XG4iLCJmdW5jdGlvbiBzdHlsZUludGVycG9sYXRlKG5hbWUsIGksIHByaW9yaXR5KSB7XG4gIHJldHVybiBmdW5jdGlvbih0KSB7XG4gICAgdGhpcy5zdHlsZS5zZXRQcm9wZXJ0eShuYW1lLCBpLmNhbGwodGhpcywgdCksIHByaW9yaXR5KTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gc3R5bGVUd2VlbihuYW1lLCB2YWx1ZSwgcHJpb3JpdHkpIHtcbiAgdmFyIHQsIGkwO1xuICBmdW5jdGlvbiB0d2VlbigpIHtcbiAgICB2YXIgaSA9IHZhbHVlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgaWYgKGkgIT09IGkwKSB0ID0gKGkwID0gaSkgJiYgc3R5bGVJbnRlcnBvbGF0ZShuYW1lLCBpLCBwcmlvcml0eSk7XG4gICAgcmV0dXJuIHQ7XG4gIH1cbiAgdHdlZW4uX3ZhbHVlID0gdmFsdWU7XG4gIHJldHVybiB0d2Vlbjtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24obmFtZSwgdmFsdWUsIHByaW9yaXR5KSB7XG4gIHZhciBrZXkgPSBcInN0eWxlLlwiICsgKG5hbWUgKz0gXCJcIik7XG4gIGlmIChhcmd1bWVudHMubGVuZ3RoIDwgMikgcmV0dXJuIChrZXkgPSB0aGlzLnR3ZWVuKGtleSkpICYmIGtleS5fdmFsdWU7XG4gIGlmICh2YWx1ZSA9PSBudWxsKSByZXR1cm4gdGhpcy50d2VlbihrZXksIG51bGwpO1xuICBpZiAodHlwZW9mIHZhbHVlICE9PSBcImZ1bmN0aW9uXCIpIHRocm93IG5ldyBFcnJvcjtcbiAgcmV0dXJuIHRoaXMudHdlZW4oa2V5LCBzdHlsZVR3ZWVuKG5hbWUsIHZhbHVlLCBwcmlvcml0eSA9PSBudWxsID8gXCJcIiA6IHByaW9yaXR5KSk7XG59XG4iLCJmdW5jdGlvbiB0ZXh0SW50ZXJwb2xhdGUoaSkge1xuICByZXR1cm4gZnVuY3Rpb24odCkge1xuICAgIHRoaXMudGV4dENvbnRlbnQgPSBpLmNhbGwodGhpcywgdCk7XG4gIH07XG59XG5cbmZ1bmN0aW9uIHRleHRUd2Vlbih2YWx1ZSkge1xuICB2YXIgdDAsIGkwO1xuICBmdW5jdGlvbiB0d2VlbigpIHtcbiAgICB2YXIgaSA9IHZhbHVlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgaWYgKGkgIT09IGkwKSB0MCA9IChpMCA9IGkpICYmIHRleHRJbnRlcnBvbGF0ZShpKTtcbiAgICByZXR1cm4gdDA7XG4gIH1cbiAgdHdlZW4uX3ZhbHVlID0gdmFsdWU7XG4gIHJldHVybiB0d2Vlbjtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24odmFsdWUpIHtcbiAgdmFyIGtleSA9IFwidGV4dFwiO1xuICBpZiAoYXJndW1lbnRzLmxlbmd0aCA8IDEpIHJldHVybiAoa2V5ID0gdGhpcy50d2VlbihrZXkpKSAmJiBrZXkuX3ZhbHVlO1xuICBpZiAodmFsdWUgPT0gbnVsbCkgcmV0dXJuIHRoaXMudHdlZW4oa2V5LCBudWxsKTtcbiAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gXCJmdW5jdGlvblwiKSB0aHJvdyBuZXcgRXJyb3I7XG4gIHJldHVybiB0aGlzLnR3ZWVuKGtleSwgdGV4dFR3ZWVuKHZhbHVlKSk7XG59XG4iLCJpbXBvcnQge3NlbGVjdGlvbn0gZnJvbSBcImQzLXNlbGVjdGlvblwiO1xuaW1wb3J0IHRyYW5zaXRpb25fYXR0ciBmcm9tIFwiLi9hdHRyLmpzXCI7XG5pbXBvcnQgdHJhbnNpdGlvbl9hdHRyVHdlZW4gZnJvbSBcIi4vYXR0clR3ZWVuLmpzXCI7XG5pbXBvcnQgdHJhbnNpdGlvbl9kZWxheSBmcm9tIFwiLi9kZWxheS5qc1wiO1xuaW1wb3J0IHRyYW5zaXRpb25fZHVyYXRpb24gZnJvbSBcIi4vZHVyYXRpb24uanNcIjtcbmltcG9ydCB0cmFuc2l0aW9uX2Vhc2UgZnJvbSBcIi4vZWFzZS5qc1wiO1xuaW1wb3J0IHRyYW5zaXRpb25fZWFzZVZhcnlpbmcgZnJvbSBcIi4vZWFzZVZhcnlpbmcuanNcIjtcbmltcG9ydCB0cmFuc2l0aW9uX2ZpbHRlciBmcm9tIFwiLi9maWx0ZXIuanNcIjtcbmltcG9ydCB0cmFuc2l0aW9uX21lcmdlIGZyb20gXCIuL21lcmdlLmpzXCI7XG5pbXBvcnQgdHJhbnNpdGlvbl9vbiBmcm9tIFwiLi9vbi5qc1wiO1xuaW1wb3J0IHRyYW5zaXRpb25fcmVtb3ZlIGZyb20gXCIuL3JlbW92ZS5qc1wiO1xuaW1wb3J0IHRyYW5zaXRpb25fc2VsZWN0IGZyb20gXCIuL3NlbGVjdC5qc1wiO1xuaW1wb3J0IHRyYW5zaXRpb25fc2VsZWN0QWxsIGZyb20gXCIuL3NlbGVjdEFsbC5qc1wiO1xuaW1wb3J0IHRyYW5zaXRpb25fc2VsZWN0aW9uIGZyb20gXCIuL3NlbGVjdGlvbi5qc1wiO1xuaW1wb3J0IHRyYW5zaXRpb25fc3R5bGUgZnJvbSBcIi4vc3R5bGUuanNcIjtcbmltcG9ydCB0cmFuc2l0aW9uX3N0eWxlVHdlZW4gZnJvbSBcIi4vc3R5bGVUd2Vlbi5qc1wiO1xuaW1wb3J0IHRyYW5zaXRpb25fdGV4dCBmcm9tIFwiLi90ZXh0LmpzXCI7XG5pbXBvcnQgdHJhbnNpdGlvbl90ZXh0VHdlZW4gZnJvbSBcIi4vdGV4dFR3ZWVuLmpzXCI7XG5pbXBvcnQgdHJhbnNpdGlvbl90cmFuc2l0aW9uIGZyb20gXCIuL3RyYW5zaXRpb24uanNcIjtcbmltcG9ydCB0cmFuc2l0aW9uX3R3ZWVuIGZyb20gXCIuL3R3ZWVuLmpzXCI7XG5pbXBvcnQgdHJhbnNpdGlvbl9lbmQgZnJvbSBcIi4vZW5kLmpzXCI7XG5cbnZhciBpZCA9IDA7XG5cbmV4cG9ydCBmdW5jdGlvbiBUcmFuc2l0aW9uKGdyb3VwcywgcGFyZW50cywgbmFtZSwgaWQpIHtcbiAgdGhpcy5fZ3JvdXBzID0gZ3JvdXBzO1xuICB0aGlzLl9wYXJlbnRzID0gcGFyZW50cztcbiAgdGhpcy5fbmFtZSA9IG5hbWU7XG4gIHRoaXMuX2lkID0gaWQ7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHRyYW5zaXRpb24obmFtZSkge1xuICByZXR1cm4gc2VsZWN0aW9uKCkudHJhbnNpdGlvbihuYW1lKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG5ld0lkKCkge1xuICByZXR1cm4gKytpZDtcbn1cblxudmFyIHNlbGVjdGlvbl9wcm90b3R5cGUgPSBzZWxlY3Rpb24ucHJvdG90eXBlO1xuXG5UcmFuc2l0aW9uLnByb3RvdHlwZSA9IHRyYW5zaXRpb24ucHJvdG90eXBlID0ge1xuICBjb25zdHJ1Y3RvcjogVHJhbnNpdGlvbixcbiAgc2VsZWN0OiB0cmFuc2l0aW9uX3NlbGVjdCxcbiAgc2VsZWN0QWxsOiB0cmFuc2l0aW9uX3NlbGVjdEFsbCxcbiAgc2VsZWN0Q2hpbGQ6IHNlbGVjdGlvbl9wcm90b3R5cGUuc2VsZWN0Q2hpbGQsXG4gIHNlbGVjdENoaWxkcmVuOiBzZWxlY3Rpb25fcHJvdG90eXBlLnNlbGVjdENoaWxkcmVuLFxuICBmaWx0ZXI6IHRyYW5zaXRpb25fZmlsdGVyLFxuICBtZXJnZTogdHJhbnNpdGlvbl9tZXJnZSxcbiAgc2VsZWN0aW9uOiB0cmFuc2l0aW9uX3NlbGVjdGlvbixcbiAgdHJhbnNpdGlvbjogdHJhbnNpdGlvbl90cmFuc2l0aW9uLFxuICBjYWxsOiBzZWxlY3Rpb25fcHJvdG90eXBlLmNhbGwsXG4gIG5vZGVzOiBzZWxlY3Rpb25fcHJvdG90eXBlLm5vZGVzLFxuICBub2RlOiBzZWxlY3Rpb25fcHJvdG90eXBlLm5vZGUsXG4gIHNpemU6IHNlbGVjdGlvbl9wcm90b3R5cGUuc2l6ZSxcbiAgZW1wdHk6IHNlbGVjdGlvbl9wcm90b3R5cGUuZW1wdHksXG4gIGVhY2g6IHNlbGVjdGlvbl9wcm90b3R5cGUuZWFjaCxcbiAgb246IHRyYW5zaXRpb25fb24sXG4gIGF0dHI6IHRyYW5zaXRpb25fYXR0cixcbiAgYXR0clR3ZWVuOiB0cmFuc2l0aW9uX2F0dHJUd2VlbixcbiAgc3R5bGU6IHRyYW5zaXRpb25fc3R5bGUsXG4gIHN0eWxlVHdlZW46IHRyYW5zaXRpb25fc3R5bGVUd2VlbixcbiAgdGV4dDogdHJhbnNpdGlvbl90ZXh0LFxuICB0ZXh0VHdlZW46IHRyYW5zaXRpb25fdGV4dFR3ZWVuLFxuICByZW1vdmU6IHRyYW5zaXRpb25fcmVtb3ZlLFxuICB0d2VlbjogdHJhbnNpdGlvbl90d2VlbixcbiAgZGVsYXk6IHRyYW5zaXRpb25fZGVsYXksXG4gIGR1cmF0aW9uOiB0cmFuc2l0aW9uX2R1cmF0aW9uLFxuICBlYXNlOiB0cmFuc2l0aW9uX2Vhc2UsXG4gIGVhc2VWYXJ5aW5nOiB0cmFuc2l0aW9uX2Vhc2VWYXJ5aW5nLFxuICBlbmQ6IHRyYW5zaXRpb25fZW5kLFxuICBbU3ltYm9sLml0ZXJhdG9yXTogc2VsZWN0aW9uX3Byb3RvdHlwZVtTeW1ib2wuaXRlcmF0b3JdXG59O1xuIiwiaW1wb3J0IHtzZWxlY3Rvcn0gZnJvbSBcImQzLXNlbGVjdGlvblwiO1xuaW1wb3J0IHtUcmFuc2l0aW9ufSBmcm9tIFwiLi9pbmRleC5qc1wiO1xuaW1wb3J0IHNjaGVkdWxlLCB7Z2V0fSBmcm9tIFwiLi9zY2hlZHVsZS5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbihzZWxlY3QpIHtcbiAgdmFyIG5hbWUgPSB0aGlzLl9uYW1lLFxuICAgICAgaWQgPSB0aGlzLl9pZDtcblxuICBpZiAodHlwZW9mIHNlbGVjdCAhPT0gXCJmdW5jdGlvblwiKSBzZWxlY3QgPSBzZWxlY3RvcihzZWxlY3QpO1xuXG4gIGZvciAodmFyIGdyb3VwcyA9IHRoaXMuX2dyb3VwcywgbSA9IGdyb3Vwcy5sZW5ndGgsIHN1Ymdyb3VwcyA9IG5ldyBBcnJheShtKSwgaiA9IDA7IGogPCBtOyArK2opIHtcbiAgICBmb3IgKHZhciBncm91cCA9IGdyb3Vwc1tqXSwgbiA9IGdyb3VwLmxlbmd0aCwgc3ViZ3JvdXAgPSBzdWJncm91cHNbal0gPSBuZXcgQXJyYXkobiksIG5vZGUsIHN1Ym5vZGUsIGkgPSAwOyBpIDwgbjsgKytpKSB7XG4gICAgICBpZiAoKG5vZGUgPSBncm91cFtpXSkgJiYgKHN1Ym5vZGUgPSBzZWxlY3QuY2FsbChub2RlLCBub2RlLl9fZGF0YV9fLCBpLCBncm91cCkpKSB7XG4gICAgICAgIGlmIChcIl9fZGF0YV9fXCIgaW4gbm9kZSkgc3Vibm9kZS5fX2RhdGFfXyA9IG5vZGUuX19kYXRhX187XG4gICAgICAgIHN1Ymdyb3VwW2ldID0gc3Vibm9kZTtcbiAgICAgICAgc2NoZWR1bGUoc3ViZ3JvdXBbaV0sIG5hbWUsIGlkLCBpLCBzdWJncm91cCwgZ2V0KG5vZGUsIGlkKSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG5ldyBUcmFuc2l0aW9uKHN1Ymdyb3VwcywgdGhpcy5fcGFyZW50cywgbmFtZSwgaWQpO1xufVxuIiwiaW1wb3J0IHtzZWxlY3RvckFsbH0gZnJvbSBcImQzLXNlbGVjdGlvblwiO1xuaW1wb3J0IHtUcmFuc2l0aW9ufSBmcm9tIFwiLi9pbmRleC5qc1wiO1xuaW1wb3J0IHNjaGVkdWxlLCB7Z2V0fSBmcm9tIFwiLi9zY2hlZHVsZS5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbihzZWxlY3QpIHtcbiAgdmFyIG5hbWUgPSB0aGlzLl9uYW1lLFxuICAgICAgaWQgPSB0aGlzLl9pZDtcblxuICBpZiAodHlwZW9mIHNlbGVjdCAhPT0gXCJmdW5jdGlvblwiKSBzZWxlY3QgPSBzZWxlY3RvckFsbChzZWxlY3QpO1xuXG4gIGZvciAodmFyIGdyb3VwcyA9IHRoaXMuX2dyb3VwcywgbSA9IGdyb3Vwcy5sZW5ndGgsIHN1Ymdyb3VwcyA9IFtdLCBwYXJlbnRzID0gW10sIGogPSAwOyBqIDwgbTsgKytqKSB7XG4gICAgZm9yICh2YXIgZ3JvdXAgPSBncm91cHNbal0sIG4gPSBncm91cC5sZW5ndGgsIG5vZGUsIGkgPSAwOyBpIDwgbjsgKytpKSB7XG4gICAgICBpZiAobm9kZSA9IGdyb3VwW2ldKSB7XG4gICAgICAgIGZvciAodmFyIGNoaWxkcmVuID0gc2VsZWN0LmNhbGwobm9kZSwgbm9kZS5fX2RhdGFfXywgaSwgZ3JvdXApLCBjaGlsZCwgaW5oZXJpdCA9IGdldChub2RlLCBpZCksIGsgPSAwLCBsID0gY2hpbGRyZW4ubGVuZ3RoOyBrIDwgbDsgKytrKSB7XG4gICAgICAgICAgaWYgKGNoaWxkID0gY2hpbGRyZW5ba10pIHtcbiAgICAgICAgICAgIHNjaGVkdWxlKGNoaWxkLCBuYW1lLCBpZCwgaywgY2hpbGRyZW4sIGluaGVyaXQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBzdWJncm91cHMucHVzaChjaGlsZHJlbik7XG4gICAgICAgIHBhcmVudHMucHVzaChub2RlKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gbmV3IFRyYW5zaXRpb24oc3ViZ3JvdXBzLCBwYXJlbnRzLCBuYW1lLCBpZCk7XG59XG4iLCJpbXBvcnQge21hdGNoZXJ9IGZyb20gXCJkMy1zZWxlY3Rpb25cIjtcbmltcG9ydCB7VHJhbnNpdGlvbn0gZnJvbSBcIi4vaW5kZXguanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24obWF0Y2gpIHtcbiAgaWYgKHR5cGVvZiBtYXRjaCAhPT0gXCJmdW5jdGlvblwiKSBtYXRjaCA9IG1hdGNoZXIobWF0Y2gpO1xuXG4gIGZvciAodmFyIGdyb3VwcyA9IHRoaXMuX2dyb3VwcywgbSA9IGdyb3Vwcy5sZW5ndGgsIHN1Ymdyb3VwcyA9IG5ldyBBcnJheShtKSwgaiA9IDA7IGogPCBtOyArK2opIHtcbiAgICBmb3IgKHZhciBncm91cCA9IGdyb3Vwc1tqXSwgbiA9IGdyb3VwLmxlbmd0aCwgc3ViZ3JvdXAgPSBzdWJncm91cHNbal0gPSBbXSwgbm9kZSwgaSA9IDA7IGkgPCBuOyArK2kpIHtcbiAgICAgIGlmICgobm9kZSA9IGdyb3VwW2ldKSAmJiBtYXRjaC5jYWxsKG5vZGUsIG5vZGUuX19kYXRhX18sIGksIGdyb3VwKSkge1xuICAgICAgICBzdWJncm91cC5wdXNoKG5vZGUpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBuZXcgVHJhbnNpdGlvbihzdWJncm91cHMsIHRoaXMuX3BhcmVudHMsIHRoaXMuX25hbWUsIHRoaXMuX2lkKTtcbn1cbiIsImltcG9ydCB7VHJhbnNpdGlvbn0gZnJvbSBcIi4vaW5kZXguanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24odHJhbnNpdGlvbikge1xuICBpZiAodHJhbnNpdGlvbi5faWQgIT09IHRoaXMuX2lkKSB0aHJvdyBuZXcgRXJyb3I7XG5cbiAgZm9yICh2YXIgZ3JvdXBzMCA9IHRoaXMuX2dyb3VwcywgZ3JvdXBzMSA9IHRyYW5zaXRpb24uX2dyb3VwcywgbTAgPSBncm91cHMwLmxlbmd0aCwgbTEgPSBncm91cHMxLmxlbmd0aCwgbSA9IE1hdGgubWluKG0wLCBtMSksIG1lcmdlcyA9IG5ldyBBcnJheShtMCksIGogPSAwOyBqIDwgbTsgKytqKSB7XG4gICAgZm9yICh2YXIgZ3JvdXAwID0gZ3JvdXBzMFtqXSwgZ3JvdXAxID0gZ3JvdXBzMVtqXSwgbiA9IGdyb3VwMC5sZW5ndGgsIG1lcmdlID0gbWVyZ2VzW2pdID0gbmV3IEFycmF5KG4pLCBub2RlLCBpID0gMDsgaSA8IG47ICsraSkge1xuICAgICAgaWYgKG5vZGUgPSBncm91cDBbaV0gfHwgZ3JvdXAxW2ldKSB7XG4gICAgICAgIG1lcmdlW2ldID0gbm9kZTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmb3IgKDsgaiA8IG0wOyArK2opIHtcbiAgICBtZXJnZXNbal0gPSBncm91cHMwW2pdO1xuICB9XG5cbiAgcmV0dXJuIG5ldyBUcmFuc2l0aW9uKG1lcmdlcywgdGhpcy5fcGFyZW50cywgdGhpcy5fbmFtZSwgdGhpcy5faWQpO1xufVxuIiwiaW1wb3J0IHtUcmFuc2l0aW9uLCBuZXdJZH0gZnJvbSBcIi4vaW5kZXguanNcIjtcbmltcG9ydCBzY2hlZHVsZSwge2dldH0gZnJvbSBcIi4vc2NoZWR1bGUuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24oKSB7XG4gIHZhciBuYW1lID0gdGhpcy5fbmFtZSxcbiAgICAgIGlkMCA9IHRoaXMuX2lkLFxuICAgICAgaWQxID0gbmV3SWQoKTtcblxuICBmb3IgKHZhciBncm91cHMgPSB0aGlzLl9ncm91cHMsIG0gPSBncm91cHMubGVuZ3RoLCBqID0gMDsgaiA8IG07ICsraikge1xuICAgIGZvciAodmFyIGdyb3VwID0gZ3JvdXBzW2pdLCBuID0gZ3JvdXAubGVuZ3RoLCBub2RlLCBpID0gMDsgaSA8IG47ICsraSkge1xuICAgICAgaWYgKG5vZGUgPSBncm91cFtpXSkge1xuICAgICAgICB2YXIgaW5oZXJpdCA9IGdldChub2RlLCBpZDApO1xuICAgICAgICBzY2hlZHVsZShub2RlLCBuYW1lLCBpZDEsIGksIGdyb3VwLCB7XG4gICAgICAgICAgdGltZTogaW5oZXJpdC50aW1lICsgaW5oZXJpdC5kZWxheSArIGluaGVyaXQuZHVyYXRpb24sXG4gICAgICAgICAgZGVsYXk6IDAsXG4gICAgICAgICAgZHVyYXRpb246IGluaGVyaXQuZHVyYXRpb24sXG4gICAgICAgICAgZWFzZTogaW5oZXJpdC5lYXNlXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBuZXcgVHJhbnNpdGlvbihncm91cHMsIHRoaXMuX3BhcmVudHMsIG5hbWUsIGlkMSk7XG59XG4iLCJpbXBvcnQge3R3ZWVuVmFsdWV9IGZyb20gXCIuL3R3ZWVuLmpzXCI7XG5cbmZ1bmN0aW9uIHRleHRDb25zdGFudCh2YWx1ZSkge1xuICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy50ZXh0Q29udGVudCA9IHZhbHVlO1xuICB9O1xufVxuXG5mdW5jdGlvbiB0ZXh0RnVuY3Rpb24odmFsdWUpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHZhciB2YWx1ZTEgPSB2YWx1ZSh0aGlzKTtcbiAgICB0aGlzLnRleHRDb250ZW50ID0gdmFsdWUxID09IG51bGwgPyBcIlwiIDogdmFsdWUxO1xuICB9O1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbih2YWx1ZSkge1xuICByZXR1cm4gdGhpcy50d2VlbihcInRleHRcIiwgdHlwZW9mIHZhbHVlID09PSBcImZ1bmN0aW9uXCJcbiAgICAgID8gdGV4dEZ1bmN0aW9uKHR3ZWVuVmFsdWUodGhpcywgXCJ0ZXh0XCIsIHZhbHVlKSlcbiAgICAgIDogdGV4dENvbnN0YW50KHZhbHVlID09IG51bGwgPyBcIlwiIDogdmFsdWUgKyBcIlwiKSk7XG59XG4iLCJmdW5jdGlvbiByZW1vdmVGdW5jdGlvbihpZCkge1xuICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHBhcmVudCA9IHRoaXMucGFyZW50Tm9kZTtcbiAgICBmb3IgKHZhciBpIGluIHRoaXMuX190cmFuc2l0aW9uKSBpZiAoK2kgIT09IGlkKSByZXR1cm47XG4gICAgaWYgKHBhcmVudCkgcGFyZW50LnJlbW92ZUNoaWxkKHRoaXMpO1xuICB9O1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHRoaXMub24oXCJlbmQucmVtb3ZlXCIsIHJlbW92ZUZ1bmN0aW9uKHRoaXMuX2lkKSk7XG59XG4iLCJpbXBvcnQge3NldH0gZnJvbSBcIi4vc2NoZWR1bGUuanNcIjtcblxuZnVuY3Rpb24gZWFzZVZhcnlpbmcoaWQsIHZhbHVlKSB7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICB2YXIgdiA9IHZhbHVlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgaWYgKHR5cGVvZiB2ICE9PSBcImZ1bmN0aW9uXCIpIHRocm93IG5ldyBFcnJvcjtcbiAgICBzZXQodGhpcywgaWQpLmVhc2UgPSB2O1xuICB9O1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbih2YWx1ZSkge1xuICBpZiAodHlwZW9mIHZhbHVlICE9PSBcImZ1bmN0aW9uXCIpIHRocm93IG5ldyBFcnJvcjtcbiAgcmV0dXJuIHRoaXMuZWFjaChlYXNlVmFyeWluZyh0aGlzLl9pZCwgdmFsdWUpKTtcbn1cbiIsImltcG9ydCB7c2V0fSBmcm9tIFwiLi9zY2hlZHVsZS5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbigpIHtcbiAgdmFyIG9uMCwgb24xLCB0aGF0ID0gdGhpcywgaWQgPSB0aGF0Ll9pZCwgc2l6ZSA9IHRoYXQuc2l6ZSgpO1xuICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgdmFyIGNhbmNlbCA9IHt2YWx1ZTogcmVqZWN0fSxcbiAgICAgICAgZW5kID0ge3ZhbHVlOiBmdW5jdGlvbigpIHsgaWYgKC0tc2l6ZSA9PT0gMCkgcmVzb2x2ZSgpOyB9fTtcblxuICAgIHRoYXQuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgIHZhciBzY2hlZHVsZSA9IHNldCh0aGlzLCBpZCksXG4gICAgICAgICAgb24gPSBzY2hlZHVsZS5vbjtcblxuICAgICAgLy8gSWYgdGhpcyBub2RlIHNoYXJlZCBhIGRpc3BhdGNoIHdpdGggdGhlIHByZXZpb3VzIG5vZGUsXG4gICAgICAvLyBqdXN0IGFzc2lnbiB0aGUgdXBkYXRlZCBzaGFyZWQgZGlzcGF0Y2ggYW5kIHdl4oCZcmUgZG9uZSFcbiAgICAgIC8vIE90aGVyd2lzZSwgY29weS1vbi13cml0ZS5cbiAgICAgIGlmIChvbiAhPT0gb24wKSB7XG4gICAgICAgIG9uMSA9IChvbjAgPSBvbikuY29weSgpO1xuICAgICAgICBvbjEuXy5jYW5jZWwucHVzaChjYW5jZWwpO1xuICAgICAgICBvbjEuXy5pbnRlcnJ1cHQucHVzaChjYW5jZWwpO1xuICAgICAgICBvbjEuXy5lbmQucHVzaChlbmQpO1xuICAgICAgfVxuXG4gICAgICBzY2hlZHVsZS5vbiA9IG9uMTtcbiAgICB9KTtcblxuICAgIC8vIFRoZSBzZWxlY3Rpb24gd2FzIGVtcHR5LCByZXNvbHZlIGVuZCBpbW1lZGlhdGVseVxuICAgIGlmIChzaXplID09PSAwKSByZXNvbHZlKCk7XG4gIH0pO1xufVxuIiwiaW1wb3J0IHtUcmFuc2l0aW9uLCBuZXdJZH0gZnJvbSBcIi4uL3RyYW5zaXRpb24vaW5kZXguanNcIjtcbmltcG9ydCBzY2hlZHVsZSBmcm9tIFwiLi4vdHJhbnNpdGlvbi9zY2hlZHVsZS5qc1wiO1xuaW1wb3J0IHtlYXNlQ3ViaWNJbk91dH0gZnJvbSBcImQzLWVhc2VcIjtcbmltcG9ydCB7bm93fSBmcm9tIFwiZDMtdGltZXJcIjtcblxudmFyIGRlZmF1bHRUaW1pbmcgPSB7XG4gIHRpbWU6IG51bGwsIC8vIFNldCBvbiB1c2UuXG4gIGRlbGF5OiAwLFxuICBkdXJhdGlvbjogMjUwLFxuICBlYXNlOiBlYXNlQ3ViaWNJbk91dFxufTtcblxuZnVuY3Rpb24gaW5oZXJpdChub2RlLCBpZCkge1xuICB2YXIgdGltaW5nO1xuICB3aGlsZSAoISh0aW1pbmcgPSBub2RlLl9fdHJhbnNpdGlvbikgfHwgISh0aW1pbmcgPSB0aW1pbmdbaWRdKSkge1xuICAgIGlmICghKG5vZGUgPSBub2RlLnBhcmVudE5vZGUpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYHRyYW5zaXRpb24gJHtpZH0gbm90IGZvdW5kYCk7XG4gICAgfVxuICB9XG4gIHJldHVybiB0aW1pbmc7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKG5hbWUpIHtcbiAgdmFyIGlkLFxuICAgICAgdGltaW5nO1xuXG4gIGlmIChuYW1lIGluc3RhbmNlb2YgVHJhbnNpdGlvbikge1xuICAgIGlkID0gbmFtZS5faWQsIG5hbWUgPSBuYW1lLl9uYW1lO1xuICB9IGVsc2Uge1xuICAgIGlkID0gbmV3SWQoKSwgKHRpbWluZyA9IGRlZmF1bHRUaW1pbmcpLnRpbWUgPSBub3coKSwgbmFtZSA9IG5hbWUgPT0gbnVsbCA/IG51bGwgOiBuYW1lICsgXCJcIjtcbiAgfVxuXG4gIGZvciAodmFyIGdyb3VwcyA9IHRoaXMuX2dyb3VwcywgbSA9IGdyb3Vwcy5sZW5ndGgsIGogPSAwOyBqIDwgbTsgKytqKSB7XG4gICAgZm9yICh2YXIgZ3JvdXAgPSBncm91cHNbal0sIG4gPSBncm91cC5sZW5ndGgsIG5vZGUsIGkgPSAwOyBpIDwgbjsgKytpKSB7XG4gICAgICBpZiAobm9kZSA9IGdyb3VwW2ldKSB7XG4gICAgICAgIHNjaGVkdWxlKG5vZGUsIG5hbWUsIGlkLCBpLCBncm91cCwgdGltaW5nIHx8IGluaGVyaXQobm9kZSwgaWQpKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gbmV3IFRyYW5zaXRpb24oZ3JvdXBzLCB0aGlzLl9wYXJlbnRzLCBuYW1lLCBpZCk7XG59XG4iLCJleHBvcnQgZnVuY3Rpb24gY3ViaWNJbih0KSB7XG4gIHJldHVybiB0ICogdCAqIHQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjdWJpY091dCh0KSB7XG4gIHJldHVybiAtLXQgKiB0ICogdCArIDE7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjdWJpY0luT3V0KHQpIHtcbiAgcmV0dXJuICgodCAqPSAyKSA8PSAxID8gdCAqIHQgKiB0IDogKHQgLT0gMikgKiB0ICogdCArIDIpIC8gMjtcbn1cbiIsImltcG9ydCB7c2VsZWN0aW9ufSBmcm9tIFwiZDMtc2VsZWN0aW9uXCI7XG5pbXBvcnQgc2VsZWN0aW9uX2ludGVycnVwdCBmcm9tIFwiLi9pbnRlcnJ1cHQuanNcIjtcbmltcG9ydCBzZWxlY3Rpb25fdHJhbnNpdGlvbiBmcm9tIFwiLi90cmFuc2l0aW9uLmpzXCI7XG5cbnNlbGVjdGlvbi5wcm90b3R5cGUuaW50ZXJydXB0ID0gc2VsZWN0aW9uX2ludGVycnVwdDtcbnNlbGVjdGlvbi5wcm90b3R5cGUudHJhbnNpdGlvbiA9IHNlbGVjdGlvbl90cmFuc2l0aW9uO1xuIiwiaW1wb3J0IGludGVycnVwdCBmcm9tIFwiLi4vaW50ZXJydXB0LmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKG5hbWUpIHtcbiAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHtcbiAgICBpbnRlcnJ1cHQodGhpcywgbmFtZSk7XG4gIH0pO1xufVxuIiwiaW1wb3J0IHtTVEFSVElORywgRU5ESU5HLCBFTkRFRH0gZnJvbSBcIi4vdHJhbnNpdGlvbi9zY2hlZHVsZS5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbihub2RlLCBuYW1lKSB7XG4gIHZhciBzY2hlZHVsZXMgPSBub2RlLl9fdHJhbnNpdGlvbixcbiAgICAgIHNjaGVkdWxlLFxuICAgICAgYWN0aXZlLFxuICAgICAgZW1wdHkgPSB0cnVlLFxuICAgICAgaTtcblxuICBpZiAoIXNjaGVkdWxlcykgcmV0dXJuO1xuXG4gIG5hbWUgPSBuYW1lID09IG51bGwgPyBudWxsIDogbmFtZSArIFwiXCI7XG5cbiAgZm9yIChpIGluIHNjaGVkdWxlcykge1xuICAgIGlmICgoc2NoZWR1bGUgPSBzY2hlZHVsZXNbaV0pLm5hbWUgIT09IG5hbWUpIHsgZW1wdHkgPSBmYWxzZTsgY29udGludWU7IH1cbiAgICBhY3RpdmUgPSBzY2hlZHVsZS5zdGF0ZSA+IFNUQVJUSU5HICYmIHNjaGVkdWxlLnN0YXRlIDwgRU5ESU5HO1xuICAgIHNjaGVkdWxlLnN0YXRlID0gRU5ERUQ7XG4gICAgc2NoZWR1bGUudGltZXIuc3RvcCgpO1xuICAgIHNjaGVkdWxlLm9uLmNhbGwoYWN0aXZlID8gXCJpbnRlcnJ1cHRcIiA6IFwiY2FuY2VsXCIsIG5vZGUsIG5vZGUuX19kYXRhX18sIHNjaGVkdWxlLmluZGV4LCBzY2hlZHVsZS5ncm91cCk7XG4gICAgZGVsZXRlIHNjaGVkdWxlc1tpXTtcbiAgfVxuXG4gIGlmIChlbXB0eSkgZGVsZXRlIG5vZGUuX190cmFuc2l0aW9uO1xufVxuIiwiPHRlbXBsYXRlPlxuICA8IS0tIFdhdmVmb3JtIGdvZXMgaGVyZSAtLT5cbiAgPGRpdiBAY2xpY2s9XCJjbGlja1wiPlxuICAgIDxzdmcgcmVmPVwic3ZnXCIgc3R5bGU9XCItYm9yZGVyOiAxcHggc29saWQgcmVkOyB3aWR0aDogMTAwJTsgaGVpZ2h0OiAxMDAlXCI+PC9zdmc+XG4gICAgPGRpdiB2LWlmPVwic2VsZWN0aW9uXCJcbiAgICAgIHN0eWxlPVwicG9zaXRpb246IGFic29sdXRlOyB0b3A6IDBweDsgaGVpZ2h0OiAxMDAlOyBsZWZ0OiAwcHg7IGxlZnQ6IDBweDsgYmFja2dyb3VuZC1jb2xvcjogI2ZmZmI7IHBvaW50ZXItZXZlbnRzOiBub25lOyBib3JkZXItbGVmdDogMXB4IHNvbGlkIGJsdWU7IGJvcmRlci1yaWdodDogMXB4IHNvbGlkIGJsdWVcIlxuICAgICAgOnN0eWxlPVwieyBsZWZ0OiAoc2VsZWN0aW9uLnN0YXJ0L2R1cmF0aW9uICogMTAwKSArICclJywgd2lkdGg6ICgoc2VsZWN0aW9uLmVuZCAtIHNlbGVjdGlvbi5zdGFydCkvZHVyYXRpb24gKiAxMDApICsgJyUnIH1cIj48L2Rpdj5cbiAgICA8IS0tIDxkaXYgdi1mb3I9XCJcIiByZWY9XCJoaWdobGlnaHRzXCI+IC0tPlxuICAgIDwhLS0gPC9kaXY+IC0tPlxuICAgIDxkaXYgc3R5bGU9XCJwb3NpdGlvbjogYWJzb2x1dGU7IHRvcDogMHB4OyBoZWlnaHQ6IDEwMCU7IHdpZHRoOiAwcHg7IGJvcmRlcjogMXB4IHNvbGlkIHJlZDsgbGVmdDogMHB4XCIgcmVmPVwiaGVhZFwiIDpzdHlsZT1cInsgbGVmdDogKHRpbWUvZHVyYXRpb24pICogMTAwICsgJyUnIH1cIj48L2Rpdj5cblxuXG4gIDwvZGl2PlxuPC90ZW1wbGF0ZT5cblxuPHNjcmlwdD5cbmltcG9ydCAqIGFzIGQzIGZyb20gJ2QzJztcblxuZXhwb3J0IGRlZmF1bHQge1xuICBwcm9wczoge1xuICAgIG1vZGVsVmFsdWU6IFtJbnQxNkFycmF5LCBJbnQzMkFycmF5LCBBcnJheV0sXG4gICAgLy8gdHJhbnNjcmlwdDogT2JqZWN0LFxuICAgIHRpbWU6IE51bWJlcixcbiAgICBkdXJhdGlvbjogTnVtYmVyLFxuICAgIHNlbGVjdGlvbjogT2JqZWN0LFxuICB9LFxuXG4gIGRhdGEoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHdhdmVmb3JtOiB1bmRlZmluZWQsXG4gICAgICBzdmc6IHVuZGVmaW5lZCxcbiAgICAgIGRhdGE6IHVuZGVmaW5lZCxcbiAgICB9O1xuICB9LFxuXG4gIC8vIGVtaXRzOiBbJ3VwZGF0ZTp0aW1lJ10sXG5cbiAgYXN5bmMgbW91bnRlZCgpIHtcbiAgICB0aGlzLiRvcHRpb25zLndhdGNoLm1vZGVsVmFsdWUuY2FsbCh0aGlzLCB0aGlzLm1vZGVsVmFsdWUpO1xuICAgIC8vIHRlbXBvcmFyeSB3b3JrYXJvdW5kIChyZXF1aXJlcyBwcm9wZXIgZGltZW5zaW9uIGNoYW5nZSBkZXRlY3Rpb24pOlxuICAgIC8vIHJlZ3VsYXJseSAoZWFjaCAyIHNlY29uZHMgb3Igc28pIGNoZWNrIGRyYXdpbmcgYXJlYSBkaW1lbnNpb25zIGFuZCByZWRyYXcgd2F2ZWZvcm0gaWYgY2hhbmdlZFxuICAgIHRoaXMucmVzaXplQ2hlY2tJbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgIGlmKHRoaXMuY3VycmVudFdpZHRoICE9IHVuZGVmaW5lZCAmJiB0aGlzLmN1cnJlbnRIZWlnaHQgIT0gdW5kZWZpbmVkICYmIHRoaXMuJHJlZnMuc3ZnICYmXG4gICAgICAgICh0aGlzLmN1cnJlbnRXaWR0aCAhPSB0aGlzLiRyZWZzLnN2Zy5jbGllbnRXaWR0aCB8fCB0aGlzLmN1cnJlbnRIZWlnaHQgIT0gdGhpcy4kcmVmcy5zdmcuY2xpZW50SGVpZ2h0KSkge1xuICAgICAgICB0aGlzLmRyYXcoKTtcbiAgICAgIH1cbiAgICB9LCAyMDAwKTtcbiAgfSxcblxuICB3YXRjaDoge1xuICAgIG1vZGVsVmFsdWUodmFsdWUpIHtcbiAgICAgIGlmKHZhbHVlKSB7XG4gICAgICAgIGlmKHZhbHVlIGluc3RhbmNlb2YgSW50MTZBcnJheSkge1xuICAgICAgICAgIGNvbnN0IGRhdGEgPSBuZXcgRmxvYXQzMkFycmF5KHZhbHVlKVxuICAgICAgICAgIHRoaXMuZGF0YSA9IGRhdGEubWFwKHggPT4geCAvIDB4ODAwMCk7XG4gICAgICAgIH0gZWxzZSBpZih2YWx1ZSBpbnN0YW5jZW9mIEZsb2F0MzJBcnJheSkge1xuICAgICAgICAgIHRoaXMuZGF0YSA9IHZhbHVlO1xuICAgICAgICB9IGVsc2UgaWYodmFsdWUgaW5zdGFuY2VvZiBBcnJheSAmJiB2YWx1ZS5sZW5ndGggPiAwICYmIHR5cGVvZiB2YWx1ZVswXSA9PT0gJ251bWJlcicgJiYgdmFsdWVbMF0gPj0gLTEgJiYgdmFsdWVbMF0gPD0gMSkge1xuICAgICAgICAgIHRoaXMuZGF0YSA9IHZhbHVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuZGF0YSA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5kYXRhID0gdW5kZWZpbmVkO1xuICAgICAgfVxuICAgICAgdGhpcy5kcmF3KCk7XG4gICAgICAvLyBpZih2YWx1ZSkge1xuICAgICAgLy8gICBjb25zdCBtaW4gPSBkMy5taW4odmFsdWUpO1xuICAgICAgLy8gICBjb25zdCBkYXRhID0gdmFsdWUubWFwKCh5LCB4KSA9PiAoeyB4LCB5IH0pKTtcbiAgICAgIC8vICAgZGF0YS5wdXNoKHsgeDogZGF0YS5sZW5ndGgsIHk6IG1pbiB9KTtcbiAgICAgIC8vICAgZGF0YS51bnNoaWZ0KHsgeDogMCwgeTogbWluIH0pO1xuICAgICAgLy8gICB0aGlzLndhdmVmb3JtID0gZGF0YTtcbiAgICAgIC8vXG4gICAgICAvLyAgIC8vIHRoaXMuZHJhdygpO1xuICAgICAgLy8gfVxuICAgIH0sXG4gICAgdGltZSh2YWx1ZSkge1xuICAgICAgLy8gY29uc29sZS5sb2coJ3RpbWUgdXBkYXRlZCB0bycsIHRoaXMudGltZSk7XG4gICAgICAvLyBjb25zdCB3aWR0aCA9IHRoaXMuJHJlZnMuc3ZnLmNsaWVudFdpZHRoO1xuICAgICAgLy8gY29uc29sZS5kaXIodGhpcy4kcmVmcy5oZWFkKTtcbiAgICAgIC8vIHRoaXMuJHJlZnMuaGVhZC5zdHlsZS5sZWZ0ID0gYCR7dmFsdWUvMTAwMC90aGlzLmR1cmF0aW9uICogMTAwfSVgO1xuICAgIH0sXG4gIH0sXG5cbiAgbWV0aG9kczoge1xuXG4gICAgY2xpY2soZXZlbnQpIHtcbiAgICAgIC8vIGNvbnNvbGUubG9nKGV2ZW50KVxuICAgICAgY29uc3QgeCA9IGV2ZW50Lm9mZnNldFg7XG4gICAgICBjb25zdCB3aWR0aCA9IHRoaXMuJHJlZnMuc3ZnLmNsaWVudFdpZHRoO1xuICAgICAgY29uc3QgdGltZSA9IHggLyB3aWR0aCAqIHRoaXMuZHVyYXRpb247XG4gICAgICAvLyBjb25zb2xlLmxvZygnbmV3IHRpbWUnLCB0aW1lKVxuICAgICAgdGhpcy4kZW1pdCgndXBkYXRlOnRpbWUnLCB0aW1lKTtcbiAgICB9LFxuXG4gICAgZHJhdyh3aWR0aCA9IHVuZGVmaW5lZCwgaGVpZ2h0ID0gdW5kZWZpbmVkKSB7XG4gICAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhO1xuXG4gICAgICB3aWR0aCA9IHdpZHRoIHx8IHRoaXMuJHJlZnMuc3ZnLmNsaWVudFdpZHRoO1xuICAgICAgaGVpZ2h0ID0gaGVpZ2h0IHx8IHRoaXMuJHJlZnMuc3ZnLmNsaWVudEhlaWdodDtcbiAgICAgIHRoaXMuY3VycmVudFdpZHRoID0gd2lkdGg7XG4gICAgICB0aGlzLmN1cnJlbnRIZWlnaHQgPSBoZWlnaHQ7XG5cbiAgICAgIGNvbnN0IHN2ZyA9IGQzLnNlbGVjdCh0aGlzLiRyZWZzLnN2Zyk7XG5cbiAgICAgIGlmKCFkYXRhKSB7XG4gICAgICAgIHN2Zy5zZWxlY3RBbGwoJyonKS5yZW1vdmUoKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG5cbiAgICAgIHN2Zy5hdHRyKCdoZWlnaHQnLCBoZWlnaHQpLmF0dHIoJ3dpZHRoJywgd2lkdGgpO1xuXG4gICAgICAvLyBjb25zb2xlLmxvZyhoZWlnaHQsIHdpZHRoKVxuXG4gICAgICAvLyBodHRwOi8vam9lc3VsLmxpL3Zhbi8yMDE0LzAzL2RyYXdpbmctd2F2ZWZvcm1zL1xuICAgICAgZnVuY3Rpb24gc3VtbWFyaXplKCBkYXRhLCBwaXhlbHMgKSB7XG4gICAgICAgIHZhciBwaXhlbExlbmd0aCA9IE1hdGgucm91bmQoZGF0YS5sZW5ndGgvcGl4ZWxzKTtcbiAgICAgICAgdmFyIHZhbHMgPSBbXTtcblxuICAgICAgICAvLyBGb3IgZWFjaCBwaXhlbCB3ZSBkaXNwbGF5XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGl4ZWxzOyBpKyspIHtcbiAgICAgICAgICB2YXIgcG9zU3VtID0gMCxcbiAgICAgICAgICAgIG5lZ1N1bSA9IDA7XG5cbiAgICAgICAgICAvLyBDeWNsZSB0aHJvdWdoIHRoZSBkYXRhLXBvaW50cyByZWxldmFudCB0byB0aGUgcGl4ZWxcbiAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHBpeGVsTGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgIHZhciB2YWwgPSBkYXRhWyBpICogcGl4ZWxMZW5ndGggKyBqIF07XG4gICAgICAgICAgICBpZihpICogcGl4ZWxMZW5ndGggKyBqID49IGRhdGEubGVuZ3RoKSB7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBLZWVwIHRyYWNrIG9mIHBvc2l0aXZlIGFuZCBuZWdhdGl2ZSB2YWx1ZXMgc2VwYXJhdGVseVxuICAgICAgICAgICAgaWYgKHZhbCA+IDApIHtcbiAgICAgICAgICAgICAgcG9zU3VtICs9IHZhbDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIG5lZ1N1bSArPSB2YWw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhbHMucHVzaCggWyBuZWdTdW0gLyBwaXhlbExlbmd0aCwgcG9zU3VtIC8gcGl4ZWxMZW5ndGggXSApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWxzO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBzdW1tYXJpemVGYXN0ZXIoIGRhdGEsIHBpeGVscyApIHtcbiAgICAgICAgdmFyIHBpeGVsTGVuZ3RoID0gTWF0aC5yb3VuZChkYXRhLmxlbmd0aC9waXhlbHMpO1xuICAgICAgICB2YXIgdmFscyA9IFtdO1xuXG4gICAgICAgIC8vIERlZmluZSBhIG1pbmltdW0gc2FtcGxlIHNpemUgcGVyIHBpeGVsXG4gICAgICAgIHZhciBtYXhTYW1wbGVTaXplID0gMTAwMDtcbiAgICAgICAgY29uc3Qgc2FtcGxlU2l6ZSA9IE1hdGgubWluKHBpeGVsTGVuZ3RoLCBtYXhTYW1wbGVTaXplKTtcblxuXG4gICAgICAgIC8vIEZvciBlYWNoIHBpeGVsIHdlIGRpc3BsYXlcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwaXhlbHM7IGkrKykge1xuICAgICAgICAgIHZhciBwb3NTdW0gPSAwLFxuICAgICAgICAgICAgbmVnU3VtID0gMDtcblxuICAgICAgICAgIC8vIEN5Y2xlIHRocm91Z2ggdGhlIGRhdGEtcG9pbnRzIHJlbGV2YW50IHRvIHRoZSBwaXhlbFxuICAgICAgICAgIC8vIERvbid0IGN5Y2xlIHRocm91Z2ggbW9yZSB0aGFuIHNhbXBsZVNpemUgZnJhbWVzIHBlciBwaXhlbC5cbiAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNhbXBsZVNpemU7IGorKykge1xuICAgICAgICAgICAgaWYoaSAqIHBpeGVsTGVuZ3RoICsgaiA+PSBkYXRhLmxlbmd0aCkge1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB2YWwgPSBkYXRhWyBpICogcGl4ZWxMZW5ndGggKyBqIF07XG5cbiAgICAgICAgICAgIC8vIEtlZXAgdHJhY2sgb2YgcG9zaXRpdmUgYW5kIG5lZ2F0aXZlIHZhbHVlcyBzZXBhcmF0ZWx5XG4gICAgICAgICAgICBpZiAodmFsID4gMCkge1xuICAgICAgICAgICAgICBwb3NTdW0gKz0gdmFsO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgbmVnU3VtICs9IHZhbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgdmFscy5wdXNoKCBbIG5lZ1N1bSAvIHNhbXBsZVNpemUsIHBvc1N1bSAvIHNhbXBsZVNpemUgXSApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWxzO1xuICAgICAgfVxuXG4gICAgICAvLyBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMTM0NDA4NDJcbiAgICAgIGZ1bmN0aW9uIGFycmF5TWluKGFycikge1xuICAgICAgICB2YXIgbGVuID0gYXJyLmxlbmd0aCwgbWluID0gSW5maW5pdHk7XG4gICAgICAgIHdoaWxlIChsZW4tLSkge1xuICAgICAgICAgIGlmIChhcnJbbGVuXSA8IG1pbikge1xuICAgICAgICAgICAgbWluID0gYXJyW2xlbl07XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBtaW47XG4gICAgICB9O1xuXG4gICAgICBmdW5jdGlvbiBhcnJheU1heChhcnIpIHtcbiAgICAgICAgdmFyIGxlbiA9IGFyci5sZW5ndGgsIG1heCA9IC1JbmZpbml0eTtcbiAgICAgICAgd2hpbGUgKGxlbi0tKSB7XG4gICAgICAgICAgaWYgKGFycltsZW5dID4gbWF4KSB7XG4gICAgICAgICAgICBtYXggPSBhcnJbbGVuXTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG1heDtcbiAgICAgIH07XG5cblxuICAgICAgLy8gbGV0IGRhdGEgPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuZGF0YSlcbiAgICAgIC8vIGRhdGEgPSBkYXRhLm1hcCh4ID0+IHggLyAweDgwMDApO1xuXG4gICAgICBjb25zdCBzdW1tYXJ5ID0gc3VtbWFyaXplRmFzdGVyKGRhdGEsIDEyMDApO1xuXG4gICAgICBsZXQgbWVhbiA9IDA7XG4gICAgICBmb3IoY29uc3QgZWwgb2Ygc3VtbWFyeSkge1xuICAgICAgICBtZWFuICs9IC1lbFswXSArIGVsWzFdO1xuICAgICAgfVxuICAgICAgbWVhbiA9IG1lYW4gLyAoMiAqIHN1bW1hcnkubGVuZ3RoKTtcbiAgICAgIC8vIGNvbnNvbGUubG9nKGFycmF5TWF4KGRhdGEpIC0gYXJyYXlNaW4oZGF0YSkpXG4gICAgICAvLyBjb25zdCBtdWx0aXBsaWVyID0gMTAvIChhcnJheU1heChkYXRhKSAtIGFycmF5TWluKGRhdGEpKSAqIGhlaWdodDsvLyAvIDI7XG4gICAgICBjb25zdCBtdWx0aXBsaWVyID0gMC4xICogaGVpZ2h0IC8gbWVhbjsgIC8vIG1lYW4gYXQgMTAlIG9mIGhlaWdodFxuICAgICAgY29uc3QgdyA9IHdpZHRoIC8gc3VtbWFyeS5sZW5ndGg7XG4gICAgICBzdmdcbiAgICAgICAgLnNlbGVjdEFsbCgncmVjdCcpXG4gICAgICAgIC5kYXRhKCBzdW1tYXJ5IClcbiAgICAgICAgICAuYXR0cigneCcsIGZ1bmN0aW9uKGQsIGkpIHtcbiAgICAgICAgICAgIHJldHVybiBpIC8gc3VtbWFyeS5sZW5ndGggKiB3aWR0aDtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5hdHRyKCd5JywgZnVuY3Rpb24oZCwgaSkge1xuICAgICAgICAgICAgcmV0dXJuIDAuNSAqIGhlaWdodCAtIChtdWx0aXBsaWVyICogZFsxXSApO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmF0dHIoJ3dpZHRoJywgdylcbiAgICAgICAgICAuYXR0cignaGVpZ2h0JywgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgcmV0dXJuIG11bHRpcGxpZXIqKGRbMV0gLSBkWzBdKTtcbiAgICAgICAgICB9KVxuICAgICAgICAuZW50ZXIoKVxuICAgICAgICAgIC5hcHBlbmQoJ3JlY3QnKVxuICAgICAgICAgIC5zdHlsZSgnc3Ryb2tlJywgJyMzNDJhNDAnKVxuICAgICAgICAgIC5zdHlsZSgnc3Ryb2tlLXdpZHRoJywgJzAnKVxuICAgICAgICAgIC5zdHlsZSgnZmlsbCcsICdyZ2JhKDAsMCwwLDAuMyknKVxuICAgICAgICAgIC5hdHRyKCd4JywgZnVuY3Rpb24oZCwgaSkge1xuICAgICAgICAgICAgcmV0dXJuIGkgLyBzdW1tYXJ5Lmxlbmd0aCAqIHdpZHRoO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmF0dHIoJ3knLCBmdW5jdGlvbihkLCBpKSB7XG4gICAgICAgICAgICByZXR1cm4gMC41ICogaGVpZ2h0IC0gKG11bHRpcGxpZXIgKiBkWzFdICk7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuYXR0cignd2lkdGgnLCB3KVxuICAgICAgICAgIC5hdHRyKCdoZWlnaHQnLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICByZXR1cm4gbXVsdGlwbGllciooZFsxXSAtIGRbMF0pO1xuICAgICAgICAgIH0pXG4gICAgICAgIC5leGl0KCkucmVtb3ZlKClcbiAgICAgIDtcbiAgICB9LFxuICB9LFxufTtcbjwvc2NyaXB0PlxuXG48c3R5bGUgc2NvcGVkPlxuc3ZnIHtcbiAgY29sb3I6IHdoaXRlO1xufVxuPC9zdHlsZT5cbiIsImltcG9ydCB7U2VsZWN0aW9uLCByb290fSBmcm9tIFwiLi9zZWxlY3Rpb24vaW5kZXguanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24oc2VsZWN0b3IpIHtcbiAgcmV0dXJuIHR5cGVvZiBzZWxlY3RvciA9PT0gXCJzdHJpbmdcIlxuICAgICAgPyBuZXcgU2VsZWN0aW9uKFtbZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3RvcildXSwgW2RvY3VtZW50LmRvY3VtZW50RWxlbWVudF0pXG4gICAgICA6IG5ldyBTZWxlY3Rpb24oW1tzZWxlY3Rvcl1dLCByb290KTtcbn1cbiIsIlxuZXhwb3J0IGNsYXNzIEF1ZGlvRmlsZURlY29kZXIge1xuXG4gIGNvbnN0cnVjdG9yKGNiKSB7XG4gICAgdGhpcy5pbml0KGNiKTtcbiAgfVxuXG4gIGluaXQoY2IpIHtcbiAgICB0aGlzLmNsb3NlKCk7XG4gICAgdGhpcy5jb250ZXh0ID0gbmV3IEF1ZGlvQ29udGV4dCgpO1xuICAgIGlmKGNiKSB7XG4gICAgICB0aGlzLmNvbnRleHQub25zdGF0ZWNoYW5nZSA9ICgpID0+IHsgY2IodGhpcyk7IH07XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuY29udGV4dC5vbnN0YXRlY2hhbmdlID0gKCkgPT4geyBjYiAmJiBjYiB8fCB0aGlzLm9uc3RhdGVjaGFuZ2UodGhpcyk7IH07XG4gICAgfVxuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgaWYodGhpcy5jb250ZXh0KSB7XG4gICAgICB0aGlzLmNvbnRleHQuY2xvc2UoKTtcbiAgICAgIHRoaXMuY29udGV4dCA9IHVuZGVmaW5lZDtcbiAgICB9XG4gIH1cblxuICByZXN1bWUoKSB7XG4gICAgdGhpcy5jb250ZXh0LnJlc3VtZSgpO1xuICB9XG5cbiAgZ2V0IHN1c3BlbmRlZCgpIHtcbiAgICByZXR1cm4gdGhpcy5jb250ZXh0LnN0YXRlID09PSAnc3VzcGVuZGVkJztcbiAgfVxuXG4gIG9uc3RhdGVjaGFuZ2UoZGVjb2Rlcikge1xuICAgIGNvbnNvbGUubG9nKCdhdWRpbyBjb250ZXh0IHN0YXRlIGNoYW5nZWQ6JywgZGVjb2Rlci5jb250ZXh0LnN0YXRlKTtcbiAgfVxuXG4gIGFzeW5jIGRlY29kZUF1ZGlvRmlsZURhdGEoYXJyYXlCdWZmZXIpIHtcbiAgICBjb25zdCBidWZmZXIgPSBhd2FpdCB0aGlzLmRlY29kZUF1ZGlvRmlsZUJ1ZmZlcihhcnJheUJ1ZmZlcik7XG5cbiAgICBjb25zdCBkYXRhID0gdGhpcy5idWZmZXJEYXRhKGJ1ZmZlcik7XG5cbiAgICByZXR1cm4geyBkYXRhOiB0aGlzLkZsb2F0MzJBcnJheVRvSW50MTZBcnJheShkYXRhKSwgc2FtcGxlUmF0ZTogYnVmZmVyLnNhbXBsZVJhdGUsIGxlbmd0aDogYnVmZmVyLmxlbmd0aCwgZHVyYXRpb246IGJ1ZmZlci5kdXJhdGlvbiwgbnVtYmVyT2ZDaGFubmVsczogYnVmZmVyLm51bWJlck9mQ2hhbm5lbHMgfTtcbiAgfVxuXG4gIGFzeW5jIGZldGNoQW5kRGVjb2RlQXVkaW9GaWxlKHVybCkge1xuICAgIGNvbnN0IGJ1ZmZlciA9IGF3YWl0IHRoaXMuZmV0Y2hBdWRpb0ZpbGVBbmREZWNvZGUodXJsKTtcblxuICAgIGNvbnN0IGRhdGEgPSB0aGlzLmJ1ZmZlckRhdGEoYnVmZmVyKTtcblxuICAgIHJldHVybiB7IGRhdGE6IHRoaXMuRmxvYXQzMkFycmF5VG9JbnQxNkFycmF5KGRhdGEpLCBzYW1wbGVSYXRlOiBidWZmZXIuc2FtcGxlUmF0ZSwgbGVuZ3RoOiBidWZmZXIubGVuZ3RoLCBkdXJhdGlvbjogYnVmZmVyLmR1cmF0aW9uLCBudW1iZXJPZkNoYW5uZWxzOiBidWZmZXIubnVtYmVyT2ZDaGFubmVscyB9O1xuICB9XG5cbiAgYXN5bmMgZmV0Y2hBdWRpb0ZpbGVBbmREZWNvZGUodXJsKSB7XG5cbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCk7XG5cbiAgICBjb25zdCBidWZmZXIgPSBhd2FpdCB0aGlzLmRlY29kZUF1ZGlvRmlsZUJ1ZmZlcihhd2FpdCByZXNwb25zZS5hcnJheUJ1ZmZlcigpKTtcblxuICAgIHJldHVybiBidWZmZXI7XG4gIH1cblxuICBhc3luYyBkZWNvZGVBdWRpb0ZpbGVCdWZmZXIoYXJyYXlCdWZmZXIpIHtcblxuICAgIC8vIGNvbnN0IGNvbnRleHQgPSBuZXcgQXVkaW9Db250ZXh0KCk7XG4gICAgY29uc3QgY29udGV4dCA9IHRoaXMuY29udGV4dDtcbiAgICAvLyBjb25zb2xlLmxvZygnQ1RYIHN0YXRlJywgY29udGV4dC5zdGF0ZSlcbiAgICAvLyBpZihjb250ZXh0LnN0YXRlID09PSAnc3VzcGVuZGVkJykge1xuICAgIC8vICAgY29uc29sZS5sb2coJ1NVU1BFTkRFRCcpXG4gICAgLy8gfVxuXG4gICAgLy8gVE9ETzogYWRkIHRyeSB7fSBjYXRjaCB7fVxuXG4gICAgY29uc3QgYnVmZmVyID0gYXdhaXQgY29udGV4dC5kZWNvZGVBdWRpb0RhdGEoYXJyYXlCdWZmZXIpO1xuXG4gICAgcmV0dXJuIGJ1ZmZlcjtcbiAgfVxuXG4gIEZsb2F0MzJBcnJheVRvSW50MTZBcnJheShmbG9hdEFycmF5KSB7XG4gICAgcmV0dXJuIEludDE2QXJyYXkuZnJvbShmbG9hdEFycmF5Lm1hcChzYW1wbGUgPT4gc2FtcGxlICogMHg4MDAwKSk7XG4gIH1cblxuICBidWZmZXJEYXRhKGJ1ZmZlciwgeyBjaGFubmVsID0gMCB9ID0ge30pIHtcbiAgICBjb25zdCBkYXRhID0gYnVmZmVyLmdldENoYW5uZWxEYXRhKGNoYW5uZWwpO1xuICAgIC8vIHJldHVybiBGbG9hdDMyQXJyYXlUb0ludDE2QXJyYXkoZGF0YSk7XG4gICAgcmV0dXJuIGRhdGE7XG4gIH1cbn1cbiIsIjx0ZW1wbGF0ZT5cbiAgPGRpdiBjbGFzcz1cImVkaXRvci13cmFwcGVyXCI+XG5cbiAgICA8c2xvdD48L3Nsb3Q+XG5cbiAgICA8ZGl2IHYtaWY9XCJ0aGlzLmVkaXRhYmxlXCIgY2xhc3M9XCJoZWFkZXJcIj5cbiAgICAgIDxkaXYgY2xhc3M9XCJidG4tZ3JvdXAgbWUtMlwiIHJvbGU9XCJncm91cFwiPlxuICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJidG4gYnRuLW91dGxpbmUtcHJpbWFyeVwiIEBjbGljaz1cInNhdmUoKVwiPlxuICAgICAgICAgICAgPGRpdiB2LWlmPVwic2F2aW5nXCIgY2xhc3M9XCJzcGlubmVyLWJvcmRlciBzcGlubmVyLWJvcmRlci1zbVwiIHJvbGU9XCJzdGF0dXNcIj48L2Rpdj5cbiAgICAgICAgICAgIDxpIHYtZWxzZS1pZj1cInN5bmNlZFwiICBjbGFzcz1cImJpIGJpLWNoZWNrLWxnXCIgdGl0bGU9XCJTYWdsYWLEgXRzXCI+PC9pPlxuICAgICAgICAgICAgPGkgdi1lbHNlIGNsYXNzPVwiYmkgYmktYXN0ZXJpc2tcIiB0aXRsZT1cIklyIG5lc2FnbGFixIF0YXMgaXptYWnFhmFzXCI+PC9pPlxuICAgICAgICAgICAgU2FnbGFixIF0XG4gICAgICAgICAgPC9idXR0b24+XG5cbiAgICAgICAgPGJ1dHRvbiA6Y2xhc3M9XCJgYnRuICR7YXV0b1NhdmUgPyAnYnRuLXByaW1hcnknIDogJ2J0bi1vdXRsaW5lLXByaW1hcnknfWBcIiBAY2xpY2s9XCJ0b2dnbGVBdXRvU2F2ZVwiIHRpdGxlPVwiQXV0b23EgXRpc2tpIHNhZ2FsYWLEgXQga2F0cmFzIDVzXCI+XG4gICAgICAgICAgPGkgOmNsYXNzPVwiYGJpIGJpLXRvZ2dsZS0ke2F1dG9TYXZlID8gJ29uJyA6ICdvZmYnfWBcIj48L2k+IDVzXG4gICAgICAgIDwvYnV0dG9uPlxuXG4gICAgICA8L2Rpdj5cblxuICAgICAgPGRpdiBjbGFzcz1cImJ0bi1ncm91cCBtZS0yXCIgcm9sZT1cImdyb3VwXCI+XG4gICAgICAgIDxidXR0b24gY2xhc3M9XCJidG4gYnRuLW91dGxpbmUtcHJpbWFyeVwiIEBjbGljaz1cIiRyZWZzLnRyYW5zY3JpcHQudG9nZ2xlU3R5bGVYKCdib2xkJylcIj48aSBjbGFzcz1cImJpIGJpLXR5cGUtYm9sZFwiPjwvaT48L2J1dHRvbj5cbiAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImJ0biBidG4tb3V0bGluZS1wcmltYXJ5XCIgQGNsaWNrPVwiJHJlZnMudHJhbnNjcmlwdC50b2dnbGVTdHlsZVgoJ2l0YWxpYycpXCI+PGkgY2xhc3M9XCJiaSBiaS10eXBlLWl0YWxpY1wiPjwvaT48L2J1dHRvbj5cbiAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImJ0biBidG4tb3V0bGluZS1wcmltYXJ5XCIgQGNsaWNrPVwiJHJlZnMudHJhbnNjcmlwdC50b2dnbGVTdHlsZVgoJ3VuZGVybGluZScpXCI+PGkgY2xhc3M9XCJiaSBiaS10eXBlLXVuZGVybGluZVwiPjwvaT48L2J1dHRvbj5cbiAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImJ0biBidG4tb3V0bGluZS1wcmltYXJ5XCIgQGNsaWNrPVwiJHJlZnMudHJhbnNjcmlwdC50b2dnbGVTdHlsZVgoJ3N1cGVyc2NyaXB0JylcIj48aSBjbGFzcz1cImJpXCI+eDxzdXA+Mjwvc3VwPjwvaT48L2J1dHRvbj5cbiAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImJ0biBidG4tb3V0bGluZS1wcmltYXJ5XCIgQGNsaWNrPVwiJHJlZnMudHJhbnNjcmlwdC50b2dnbGVTdHlsZVgoJ3N1YnNjcmlwdCcpXCI+PGkgY2xhc3M9XCJiaVwiPng8c3ViPjI8L3N1Yj48L2k+PC9idXR0b24+XG4gICAgICAgIDxidXR0b24gY2xhc3M9XCJidG4gYnRuLW91dGxpbmUtcHJpbWFyeVwiIEBjbGljaz1cIiRyZWZzLnRyYW5zY3JpcHQudG9nZ2xlQnVsbGV0KClcIj48aSBjbGFzcz1cImJpIGJpLWxpc3QtdWxcIj48L2k+PC9idXR0b24+XG4gICAgICA8L2Rpdj5cbjwhLS0gICAgICA8ZGl2IGNsYXNzPVwiYnRuLWdyb3VwIG1lLTJcIiByb2xlPVwiZ3JvdXBcIj4tLT5cbjwhLS0gICAgICAgIDxidXR0b24gY2xhc3M9XCJidG4gYnRuLW91dGxpbmUtcHJpbWFyeVwiIEBjbGljaz1cIiRyZWZzLnRyYW5zY3JpcHQuZXhwb3J0V29yZCgpXCI+PGkgY2xhc3M9XCJiaSBiaS1maWxlLXdvcmRcIj48L2k+IGRvYzwvYnV0dG9uPi0tPlxuPCEtLSAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImJ0biBidG4tb3V0bGluZS1wcmltYXJ5XCIgQGNsaWNrPVwiJHJlZnMudHJhbnNjcmlwdC5kb3dubG9hZCgnZXhwb3J0Lmpzb24nLCBKU09OLnN0cmluZ2lmeSh0cmFuc2NyaXB0LCBudWxsLCAnICAnKSwgJ2FwcGxpY2F0aW9uL2pzb24nKVwiPjxpIGNsYXNzPVwiYmkgYmktY2xvdWQtZG93bmxvYWRcIj48L2k+IGpzb248L2J1dHRvbj4tLT5cbjwhLS0gICAgICA8L2Rpdj4tLT5cbiAgICA8L2Rpdj5cblxuICAgIDxUcmFuc2NyaXB0RWRpdG9yIGNsYXNzPVwibWFpbiB0cmFuc2NyaXB0LWVkaXRvclwiXG4gICAgICByZWY9XCJ0cmFuc2NyaXB0XCIgdi1tb2RlbD1cInRyYW5zY3JpcHRcIiBAdXBkYXRlOm1vZGVsVmFsdWU9XCJ0cmFuc2NyaXB0VXBkYXRlZFwiXG4gICAgICA6dGltZT1cInBvc2l0aW9uXCIgQHVwZGF0ZTp0aW1lPVwic2V0UG9zaXRpb25cIiBAc2VsZWN0ZWQ9XCJzZWxlY3RlZCA9ICRldmVudFwiIDplZGl0YWJsZT1cImVkaXRhYmxlXCJcbiAgICAgIDpzaG93LWNvbmZpZGVuY2U9XCJ0aGlzLnNob3dDb25maWRlbmNlXCJcbiAgICA+PC9UcmFuc2NyaXB0RWRpdG9yPlxuXG4gICAgPGRpdiBjbGFzcz1cImZvb3RlclwiPlxuICAgICAgPGRpdiBjbGFzcz1cIm1lZGlhLXBhbmVsXCIgOmNsYXNzPVwieyB2aWRlbzogaXNWaWRlbyAmJiBwcmV2aWV3VmlkZW8gfVwiPlxuXG4gICAgICAgIDwhLS0gPGRpdj4gLS0+XG4gICAgICAgICAgPHZpZGVvIHBsYXlzaW5saW5lXG4gICAgICAgICAgICA6c3JjPVwiX3VybFwiIHJlZj1cInZpZGVvXCIgQHRpbWV1cGRhdGU9XCJ0aW1lVXBkYXRlXCIgQGxvYWRlZGRhdGE9XCJvbkRhdGFMb2FkZWRcIiBAbG9hZHN0YXJ0PVwib25EYXRhTG9hZGVkXCIgQGVtcHRpZWQ9XCJvbkVtcHR5XCIgQGR1cmF0aW9uY2hhbmdlPVwiZHVyYXRpb25DaGFuZ2VkXCJcbiAgICAgICAgICAgIEBwbGF5PVwib25QbGF5XCIgQHBhdXNlPVwib25QYXVzZVwiIEBlbmRlZD1cIm9uRW5kZWRcIj48L3ZpZGVvPlxuICAgICAgICA8IS0tIDwvZGl2PiAtLT5cblxuICAgICAgICA8ZGl2IGNsYXNzPVwid2F2ZWZvcm0tYW5kLWJ1dHRvbnNcIj5cblxuICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICA8V2F2ZWZvcm0gY2xhc3M9XCJ3YXZlZm9ybVwiIHYtaWY9XCJfd2F2ZWZvcm0gIT0gdW5kZWZpbmVkXCJcbiAgICAgICAgICAgICAgdi1tb2RlbD1cIl93YXZlZm9ybVwiIHYtbW9kZWw6dGltZT1cInBvc2l0aW9uXCIgQHVwZGF0ZTp0aW1lPVwic2V0UG9zaXRpb25cIiA6ZHVyYXRpb249XCJfZHVyYXRpb25cIiA6c2VsZWN0aW9uPVwic2VsZWN0ZWRcIj48L1dhdmVmb3JtPlxuXG4gICAgICAgICAgICA8IS0tXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwid2F2ZWZvcm0tbG9hZGluZ1wiIHYtZWxzZS1pZj1cImF1ZGlvRGVjb2RpbmdTdXNwZW5kZWRcIj5cbiAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImJ0biBidG4tcHJpbWFyeVwiIEBjbGljaz1cImRlY29kZXIucmVzdW1lKClcIj5Mb2FkPC9idXR0b24+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIC0tPlxuXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwid2F2ZWZvcm0tbG9hZGluZ1wiIHYtZWxzZT5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInRleHQtY2VudGVyXCIgc3R5bGU9XCJwb3NpdGlvbjogcmVsYXRpdmU7IHRvcDogY2FsYyg1MCUgLSAxcmVtKVwiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJzcGlubmVyLWdyb3dcIiByb2xlPVwic3RhdHVzXCI+XG4gICAgICAgICAgICAgICAgICA8IS0tIDxzcGFuIGNsYXNzPVwidmlzdWFsbHktaGlkZGVuXCI+TG9hZGluZy4uLjwvc3Bhbj4gLS0+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPGRpdiBzdHlsZT1cInBvc2l0aW9uOiByZWxhdGl2ZTsgZGlzcGxheTogaW5saW5lLWJsb2NrOyB0b3A6IC0wLjVyZW07IGxlZnQ6IDAuNXJlbVwiPlxuICAgICAgICAgICAgICAgICAgTG9hZGluZy4uLlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgPGRpdiBjbGFzcz1cImNvbnRyb2xzXCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiYnRuLWdyb3VwIHBlLTJcIiByb2xlPVwiZ3JvdXBcIiB2LWlmPVwibG9hZGVkXCI+XG4gICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJidG4gYnRuLXByaW1hcnlcIiBAY2xpY2s9XCIkcmVmcy52aWRlby5wbGF5KClcIiB2LWlmPVwiIXBsYXlpbmdcIj48aSBjbGFzcz1cImJpIGJpLXBsYXktZmlsbFwiPjwvaT48L2J1dHRvbj5cbiAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImJ0biBidG4tcHJpbWFyeVwiIEBjbGljaz1cIiRyZWZzLnZpZGVvLnBhdXNlKClcIiB2LWVsc2U+PGkgY2xhc3M9XCJiaSBiaS1wYXVzZS1maWxsXCI+PC9pPjwvYnV0dG9uPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8c3BhbiBzdHlsZT1cImZvbnQtdmFyaWFudC1udW1lcmljOiB0YWJ1bGFyLW51bXM7XCI+e3ttc1RvVGltZShwb3NpdGlvbil9fSAvIHt7IG1zVG9UaW1lKHZpZGVvX2R1cmF0aW9uKSB9fTwvc3Bhbj5cbiAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICA8L2Rpdj5cblxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gIDwvZGl2PlxuPC90ZW1wbGF0ZT5cblxuXG48c2NyaXB0IGxhbmc9XCJ0c1wiPlxuaW1wb3J0IFRyYW5zY3JpcHRFZGl0b3IgZnJvbSAnLi9UcmFuc2NyaXB0RWRpdG9yLnZ1ZSc7XG5pbXBvcnQgV2F2ZWZvcm0gZnJvbSAnLi9XYXZlZm9ybS52dWUnO1xuaW1wb3J0IHttc1RvVGltZX0gZnJvbSAnLi91dGlscyc7XG5pbXBvcnQgeyBBdWRpb0ZpbGVEZWNvZGVyIH0gZnJvbSAnLi9hdWRpbyc7XG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgY29tcG9uZW50czoge1xuICAgIFRyYW5zY3JpcHRFZGl0b3IsXG4gICAgV2F2ZWZvcm0sXG4gIH0sXG4gIHByb3BzOiB7XG4gICAgdHJhbnNjcmlwdDogeyB0eXBlOiBPYmplY3QsIGRlZmF1bHQ6IHsgcGFyYWdyYXBoczoge30gfSB9LFxuICAgIGR1cmF0aW9uOiB7IHR5cGU6IE51bWJlciB9LFxuICAgIHVybDogeyB0eXBlOiBTdHJpbmcgfSxcbiAgICBuYW1lOiB7fSxcbiAgICB3YXZlZm9ybTogW0ludDE2QXJyYXksIEludDMyQXJyYXksIEFycmF5LCBTdHJpbmddLFxuICAgIHByZXZpZXdWaWRlbzogeyB0eXBlOiBCb29sZWFuLCBkZWZhdWx0OiB0cnVlIH0sXG4gICAgb25TYXZlOiB7IHR5cGU6IEZ1bmN0aW9uLCBkZWZhdWx0OiBhc3luYyAoKSA9PiBjb25zb2xlLmxvZygnb25TYXZlIG5vdCBpbXBsZW1lbnRlZCcpIH0sXG4gICAgZWRpdGFibGU6IHt0eXBlOiBCb29sZWFuLCBkZWZhdWx0OiB0cnVlfVxuICB9LFxuICBkYXRhKCkge1xuICAgIHJldHVybiB7XG4gICAgICBwb3NpdGlvbjogMCxcbiAgICAgIHNlbGVjdGVkOiB1bmRlZmluZWQsXG4gICAgICBwbGF5aW5nOiBmYWxzZSxcbiAgICAgIGxvYWRlZDogZmFsc2UsXG4gICAgICBpc1ZpZGVvOiBmYWxzZSxcblxuICAgICAgX3VybDogdW5kZWZpbmVkLFxuICAgICAgX2R1cmF0aW9uOiB1bmRlZmluZWQsXG4gICAgICBfd2F2ZWZvcm06IHVuZGVmaW5lZCxcbiAgICAgIHBlbmRpbmdfd2F2ZWZvcm06IHVuZGVmaW5lZCxcbiAgICAgIHBlbmRpbmdfZHVyYXRpb246IHVuZGVmaW5lZCxcbiAgICAgIHZpZGVvX2R1cmF0aW9uOiB1bmRlZmluZWQsXG5cbiAgICAgIHNhdmluZzogZmFsc2UsXG4gICAgICB2ZXJzaW9uOiAwLFxuICAgICAgbGFzdFNhdmVkVmVyc2lvbjogMCxcbiAgICAgIGF1dG9TYXZlOiBmYWxzZSxcbiAgICAgIGF1dG9TYXZlSW50ZXJ2YWw6IG51bGwsXG5cbiAgICAgIGRlY29kZXJTdXNwZW5kZWQ6IGZhbHNlLFxuICAgICAgZGVjb2RpbmdBdWRpbzogZmFsc2UsXG4gICAgICBzaG93Q29uZmlkZW5jZTogZmFsc2VcbiAgICB9XG4gIH0sXG5cbiAgYXN5bmMgbW91bnRlZCgpIHtcbiAgICB0aGlzLiRvcHRpb25zLndhdGNoLndhdmVmb3JtLmNhbGwodGhpcywgdGhpcy53YXZlZm9ybSk7XG4gICAgdGhpcy5hdXRvU2F2ZUludGVydmFsID0gd2luZG93LnNldEludGVydmFsKHRoaXMuc2F2ZUF1dG8sIDUwMDApO1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5vbkdsb2JhbEtleWRvd24pO1xuXG4gICAgdGhpcy5kZWNvZGVyID0gbmV3IEF1ZGlvRmlsZURlY29kZXIoKGRlY29kZXIpID0+IHsgdGhpcy5kZWNvZGVyU3VzcGVuZGVkID0gdGhpcy5kZWNvZGVyLnN1c3BlbmRlZDsgaWYodGhpcy5kZWNvZGVyLnN1c3BlbmRlZCkgeyBjb25zb2xlLmxvZygnYXVkaW8gZGVjb2RlciBzdXNwZW5kZWQnKTsgfSB9KTtcbiAgICB0aGlzLmRlY29kZXJTdXNwZW5kZWQgPSB0aGlzLmRlY29kZXIuc3VzcGVuZGVkO1xuICAgIC8vIGNvbnNvbGUubG9nKCdkZWNvZGVyIHN1c3BlbmRlZCBhZnRlciBpbml0OicsIHRoaXMuZGVjb2RlclN1c3BlbmRlZCk7XG4gIH0sXG5cbiAgYmVmb3JlVW5tb3VudCgpIHtcbiAgICBpZiAodGhpcy5hdXRvU2F2ZUludGVydmFsKSB3aW5kb3cuY2xlYXJJbnRlcnZhbCh0aGlzLmF1dG9TYXZlSW50ZXJ2YWwpO1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5vbkdsb2JhbEtleWRvd24pO1xuICB9LFxuXG4gIHdhdGNoOiB7XG4gICAgcG9zaXRpb24odmFsdWUpIHtcbiAgICAgIC8vIGNvbnNvbGUubG9nKCdwb3NpdGlvbiBjaGFuZ2VkOicsIHZhbHVlKTtcbiAgICB9LFxuICAgIHRyYW5zY3JpcHQ6IHtcbiAgICAgIGhhbmRsZXIodmFsdWUsIG9sZFZhbHVlKSB7XG4gICAgICAgIC8vIGlmICh0aGlzLnZlcnNpb24gPT0gMCAmJiAoIW9sZFZhbHVlIHx8IE9iamVjdC5rZXlzKG9sZFZhbHVlKS5sZW5ndGggPT09IDApKSB7XG4gICAgICAgIC8vICAgLy8gaWdub3JlIGluaXRpYWwgc2V0dXBcbiAgICAgICAgLy8gICByZXR1cm47XG4gICAgICAgIC8vIH1cbiAgICAgICAgLy8gdGhpcy52ZXJzaW9uICs9IDE7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCduZXcnLCBKU09OLnN0cmluZ2lmeSh2YWx1ZSkpXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCdvbGQnLCBKU09OLnN0cmluZ2lmeShvbGRWYWx1ZSkpXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCd0cmFuc2NyaXB0IHVwZGF0ZWQnLCB0aGlzLnZlcnNpb24sIHZhbHVlKVxuICAgICAgICAvLyBjb25zb2xlLmxvZygndHJhbnNjcmlwdCB1cGRhdGVkJywgdGhpcy50cmFuc2NyaXB0KVxuICAgICAgfSxcbiAgICAgIGRlZXA6IHRydWUsXG4gICAgfSxcbiAgICBkdXJhdGlvbih2YWx1ZSkge1xuICAgICAgdGhpcy5fZHVyYXRpb24gPSB2YWx1ZTtcbiAgICB9LFxuICAgIHVybCh2YWx1ZSkge1xuICAgICAgdGhpcy5fdXJsID0gdmFsdWU7XG4gICAgfSxcbiAgICBhc3luYyB3YXZlZm9ybSh2YWx1ZSkge1xuICAgICAgaWYodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykge1xuICAgICAgICBjb25zdCB7IGRhdGEsIGR1cmF0aW9uIH0gPSBhd2FpdCB0aGlzLmRlY29kZUF1ZGlvV2F2ZWZvcm0odmFsdWUpO1xuICAgICAgICB0aGlzLl93YXZlZm9ybSA9IGRhdGE7XG4gICAgICB9IGVsc2UgaWYodmFsdWUgaW5zdGFuY2VvZiBGaWxlKSB7XG4gICAgICAgIGNvbnN0IHsgZGF0YSwgZHVyYXRpb24gfSA9IGF3YWl0IHRoaXMuZGVjb2Rlci5kZWNvZGVBdWRpb0ZpbGVEYXRhKGF3YWl0IHZhbHVlLmFycmF5QnVmZmVyKCkpO1xuICAgICAgICB0aGlzLl93YXZlZm9ybSA9IGRhdGE7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLl93YXZlZm9ybSA9IHZhbHVlO1xuICAgICAgfVxuICAgIH0sXG4gIH0sXG5cbiAgY29tcHV0ZWQ6IHtcbiAgICBzeW5jZWQoKSB7XG4gICAgICByZXR1cm4gdGhpcy5sYXN0U2F2ZWRWZXJzaW9uID09PSB0aGlzLnZlcnNpb247XG4gICAgfVxuICB9LFxuXG4gIG1ldGhvZHM6IHtcbiAgICBtc1RvVGltZSxcblxuICAgIHRvZ2dsZUF1dG9TYXZlKCkge1xuICAgICAgdGhpcy5hdXRvU2F2ZSA9ICF0aGlzLmF1dG9TYXZlO1xuICAgIH0sXG5cbiAgICBhc3luYyBzYXZlKCkge1xuICAgICAgaWYgKHRoaXMub25TYXZlICYmIHRoaXMuZWRpdGFibGUpIHtcbiAgICAgICAgY29uc3QgdmVyc2lvbiA9IHRoaXMudmVyc2lvbjtcbiAgICAgICAgdGhpcy5zYXZpbmcgPSB0cnVlO1xuICAgICAgICBjb25zdCByID0gYXdhaXQgdGhpcy5vblNhdmUodGhpcy50cmFuc2NyaXB0KTtcbiAgICAgICAgY29uc29sZS5sb2coJ3NhdmVkJywgdGhpcy50cmFuc2NyaXB0KVxuICAgICAgICB0aGlzLmxhc3RTYXZlZFZlcnNpb24gPSB2ZXJzaW9uO1xuICAgICAgICB0aGlzLnNhdmluZyA9IGZhbHNlO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICBzYXZlQXV0bygpIHtcbiAgICAgIGlmICh0aGlzLmF1dG9TYXZlKSB7XG4gICAgICAgIHRoaXMuc2F2ZSgpO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICBhc3luYyBkZWNvZGVBdWRpb1dhdmVmb3JtKHVybCkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgdGhpcy5kZWNvZGluZ0F1ZGlvID0gdHJ1ZTtcbiAgICAgICAgaWYodGhpcy5kZWNvZGVyLnN1c3BlbmRlZCkge1xuICAgICAgICAgIGF3YWl0IHRoaXMuZGVjb2Rlci5yZXN1bWUoKTtcbiAgICAgICAgfVxuICAgICAgICBpZih1cmwgaW5zdGFuY2VvZiBGaWxlKSB7XG4gICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZGVjb2Rlci5kZWNvZGVBdWRpb0ZpbGVEYXRhKGF3YWl0IHVybC5hcnJheUJ1ZmZlcigpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kZWNvZGVyLmZldGNoQW5kRGVjb2RlQXVkaW9GaWxlKHVybCk7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2goZSkge1xuICAgICAgICB0aHJvdyBlO1xuICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgdGhpcy5kZWNvZGluZ0F1ZGlvID0gZmFsc2U7XG4gICAgICB9XG4gICAgfSxcblxuICAgIC8vIHNldCBldmVyeXRoaW5nIGluIG9uZSBzaG90IGZvciB0aGUgYmVzdCB1c2VyIGV4cGVyaWVuY2VcbiAgICBhc3luYyBsb2FkKHsgdXJsLCB3YXZlZm9ybSwgZHVyYXRpb24gfSkge1xuICAgICAgaWYodHlwZW9mIHdhdmVmb3JtID09PSAnc3RyaW5nJyB8fCB3YXZlZm9ybSBpbnN0YW5jZW9mIEZpbGUpIHtcbiAgICAgICAgdGhpcy5wZW5kaW5nX3dhdmVmb3JtID0gKGFzeW5jICgpID0+IHsgY29uc3QgeyBkYXRhLCBkdXJhdGlvbiB9ID0gYXdhaXQgdGhpcy5kZWNvZGVBdWRpb1dhdmVmb3JtKHdhdmVmb3JtKTsgcmV0dXJuIGRhdGE7IH0pKCk7XG4gICAgICB9IGVsc2UgaWYod2F2ZWZvcm0gPT09IG51bGwpIHtcbiAgICAgICAgdGhpcy5fd2F2ZWZvcm0gPSBbXTtcbiAgICAgIH0gZWxzZSBpZih3YXZlZm9ybSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHRoaXMucGVuZGluZ193YXZlZm9ybSA9IChhc3luYyAoKSA9PiB3YXZlZm9ybSkoKTtcbiAgICAgIH1cbiAgICAgIGlmKGR1cmF0aW9uKSB7XG4gICAgICAgIHRoaXMucGVuZGluZ19kdXJhdGlvbiA9IGR1cmF0aW9uO1xuICAgICAgfVxuICAgICAgaWYodXJsICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdGhpcy5fdXJsID0gdXJsO1xuICAgICAgICBpZighdXJsIHx8IHVybC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICB0aGlzLnZpZGVvX2R1cmF0aW9uID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYodGhpcy5wZW5kaW5nX3dhdmVmb3JtKSB7XG4gICAgICAgIHRoaXMuX3dhdmVmb3JtID0gYXdhaXQgdGhpcy5wZW5kaW5nX3dhdmVmb3JtO1xuICAgICAgICB0aGlzLnBlbmRpbmdfd2F2ZWZvcm0gPSB1bmRlZmluZWQ7XG4gICAgICB9XG4gICAgfSxcblxuICAgIHdhdmVmb3JtTG9hZGluZygpIHtcbiAgICAgIHRoaXMuX3dhdmVmb3JtID0gdW5kZWZpbmVkO1xuICAgICAgdGhpcy5sb2FkZWQgPSBmYWxzZTtcbiAgICB9LFxuXG4gICAgb25QbGF5KCkge1xuICAgICAgLy8gdGhpcy5zdGVwID0gdGhpcy5kdXJhdGlvbiAvIHRoaXMuJHJlZnMud2F2ZWZvcm0uJGVsLnBhcmVudE5vZGUuY2xpZW50V2lkdGg7XG4gICAgICAvLyB0aGlzLm5leHRDaGVja3BvaW50ID0gdGhpcy5wb3NpdGlvbjtcbiAgICAgIHRoaXMucGxheWluZyA9IHRydWU7XG4gICAgICB0aGlzLmFuaW1hdGlvbkZyYW1lSUQgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy51cGRhdGVQb3NpdGlvbik7XG4gICAgfSxcblxuICAgIG9uUGF1c2UoKSB7XG4gICAgICB0aGlzLnBsYXlpbmcgPSBmYWxzZTtcbiAgICAgIGlmKHRoaXMuYW5pbWF0aW9uRnJhbWVJRCkge1xuICAgICAgICBjYW5jZWxBbmltYXRpb25GcmFtZSh0aGlzLmFuaW1hdGlvbkZyYW1lSUQpO1xuICAgICAgICB0aGlzLmFuaW1hdGlvbkZyYW1lSUQgPSB1bmRlZmluZWQ7XG4gICAgICB9XG4gICAgfSxcblxuICAgIG9uRW5kZWQoKSB7XG4gICAgICB0aGlzLm9uUGF1c2UoKTtcbiAgICB9LFxuXG4gICAgdXBkYXRlUG9zaXRpb24odGltZXN0YW1wKSB7XG4gICAgICB0aGlzLnBvc2l0aW9uID0gdGhpcy4kcmVmcy52aWRlby5jdXJyZW50VGltZSAqIDEwMDA7XG4gICAgICAvLyBOT1RFOiBpbnN0ZWFkIHRoZSBmb2xsb3dpbmcgYXBwcm9hY2ggbWF5IGhhdmUgc29tZSBlZmZlY3Qgb24gbGFyZ2VyIGlucHV0IG1lZGlhXG4gICAgICAvLyBjb25zdCBwb3NpdGlvbiA9IHRoaXMuJHJlZnMudmlkZW8uY3VycmVudFRpbWUgKiAxMDAwO1xuICAgICAgLy8gaWYocG9zaXRpb24gPj0gdGhpcy5uZXh0Q2hlY2twb2ludCkge1xuICAgICAgLy8gICB0aGlzLnBvc2l0aW9uID0gcG9zaXRpb247XG4gICAgICAvLyAgIHRoaXMubmV4dENoZWNrcG9pbnQgPSBwb3NpdGlvbiArIHRoaXMuc3RlcDtcbiAgICAgIC8vIH1cblxuICAgICAgdGhpcy5hbmltYXRpb25GcmFtZUlEID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRoaXMudXBkYXRlUG9zaXRpb24pO1xuICAgIH0sXG5cbiAgICBkdXJhdGlvbkNoYW5nZWQoKSB7XG4gICAgICBjb25zdCB2aWRlbyA9IHRoaXMuJHJlZnMudmlkZW87XG4gICAgICB0aGlzLl9kdXJhdGlvbiA9IHZpZGVvLmR1cmF0aW9uICogMTAwMDtcbiAgICAgIHRoaXMudmlkZW9fZHVyYXRpb24gPSB2aWRlby5kdXJhdGlvbiAqIDEwMDA7XG4gICAgfSxcblxuICAgIGFzeW5jIG9uRGF0YUxvYWRlZCgpIHtcbiAgICAgIGNvbnN0IHZpZGVvID0gdGhpcy4kcmVmcy52aWRlbztcbiAgICAgIGlmKHZpZGVvKSB7XG4gICAgICAgIHRoaXMuaXNWaWRlbyA9IHZpZGVvLnZpZGVvV2lkdGggPiAwICYmIHZpZGVvLnZpZGVvSGVpZ2h0ID4gMDtcbiAgICAgIH1cbiAgICAgIGlmKHRoaXMucGVuZGluZ19kdXJhdGlvbikge1xuICAgICAgICAvLyB0aGlzLl9kdXJhdGlvbiA9IHRoaXMucGVuZGluZ19kdXJhdGlvbjtcbiAgICAgICAgdGhpcy5wZW5kaW5nX2R1cmF0aW9uID0gdW5kZWZpbmVkO1xuICAgICAgfVxuICAgICAgaWYodGhpcy5wZW5kaW5nX3dhdmVmb3JtKSB7XG4gICAgICAgIHRoaXMuX3dhdmVmb3JtID0gYXdhaXQgdGhpcy5wZW5kaW5nX3dhdmVmb3JtO1xuICAgICAgICB0aGlzLnBlbmRpbmdfd2F2ZWZvcm0gPSB1bmRlZmluZWQ7XG4gICAgICB9XG4gICAgICB0aGlzLmxvYWRlZCA9IHRydWU7XG4gICAgfSxcblxuICAgIG9uRW1wdHkoKSB7XG4gICAgICB0aGlzLmxvYWRlZCA9IGZhbHNlO1xuICAgICAgdGhpcy5pc1ZpZGVvID0gZmFsc2U7XG4gICAgfSxcblxuICAgIG9uR2xvYmFsS2V5ZG93bihlKSB7XG4gICAgICAvLyBjdHJsL2NtZCArIHNcbiAgICAgIGlmIChlLmtleSA9PT0gJ3MnICYmIChlLmN0cmxLZXkgPT09IHRydWUgfHwgZS5tZXRhS2V5ID09PSB0cnVlKSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KClcbiAgICAgICAgdGhpcy5zYXZlKCk7XG4gICAgICB9XG5cbiAgICAgIGlmKGUuY29kZSA9PT0gJ1NwYWNlJyAmJiBlLmN0cmxLZXkgPT09IHRydWUgfHwgZS5jb2RlID09ICdFc2NhcGUnKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKVxuICAgICAgICBpZighdGhpcy4kcmVmcy52aWRlby5wYXVzZWQpIHtcbiAgICAgICAgICB0aGlzLiRyZWZzLnZpZGVvLnBhdXNlKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy4kcmVmcy52aWRlby5wbGF5KCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuXG4gICAgdHJhbnNjcmlwdFVwZGF0ZWQodmFsdWUpIHtcbiAgICAgIC8vIGNvbnNvbGUubG9nKCd0cmFuc2NyaXB0IFVQREFURUQnLCB0aGlzLnRyYW5zY3JpcHQsIHZhbHVlKVxuICAgICAgdGhpcy52ZXJzaW9uICs9IDE7XG4gICAgfSxcblxuICAgIHNldFBvc2l0aW9uKGV2ZW50KSB7XG4gICAgICAvLyBjb25zb2xlLmxvZygnc2V0IHBvc2l0aW9uJywgZXZlbnQpO1xuICAgICAgaWYoZXZlbnQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICAvLyB0aGlzLnBvc2l0aW9uID0gZXZlbnQ7XG4gICAgICB0aGlzLiRyZWZzLnZpZGVvLmN1cnJlbnRUaW1lID0gZXZlbnQgLyAxMDAwO1xuICAgICAgdGhpcy4kZW1pdCgnc2V0UG9zaXRpb24nLCBldmVudCk7XG4gICAgfSxcblxuICAgIHRpbWVVcGRhdGUoZXZlbnQpIHtcbiAgICAgIC8vIGNvbnNvbGUubG9nKCd0aW1lIHVwZGF0ZWQnLCBldmVudCwgZXZlbnQudGltZVN0YW1wLCB0aGlzLiRyZWZzLnZpZGVvLmN1cnJlbnRUaW1lKTtcbiAgICAgIC8vIGNvbnNvbGUuZGlyKHRoaXMuJHJlZnMudmlkZW8pXG4gICAgICAvLyB0aGlzLnBvc2l0aW9uID0gZXZlbnQudGltZVN0YW1wO1xuICAgICAgdGhpcy5wb3NpdGlvbiA9IHRoaXMuJHJlZnMudmlkZW8uY3VycmVudFRpbWUgKiAxMDAwO1xuICAgIH0sXG5cbiAgICB0b2dnbGVTaG93Q29uZmlkZW5jZSgpIHtcbiAgICAgIHRoaXMuc2hvd0NvbmZpZGVuY2UgPSAhdGhpcy5zaG93Q29uZmlkZW5jZTtcbiAgICB9LFxuICB9LFxufTtcblxuPC9zY3JpcHQ+XG5cbjxzdHlsZSBzY29wZWQ+XG4uZWRpdG9yLXdyYXBwZXIge1xuICBkaXNwbGF5OiBmbGV4O1xuICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICAvKnRvcDogMTAwcHg7Ki9cbiAgcG9zaXRpb246IHJlbGF0aXZlO1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIHRvcDogMHB4O1xuICBib3R0b206IDBweDtcbiAgbGVmdDogMHB4O1xuICByaWdodDogMHB4O1xufVxuXG4uaGVhZGVyIHtcbn1cblxuLm1haW4ge1xuICBwYWRkaW5nOiAxMHB4O1xuICBiYWNrZ3JvdW5kOiAjZmZmO1xuICBmbGV4OiAxIDEgYXV0bztcbiAgb3ZlcmZsb3cteTogc2Nyb2xsO1xuICBtYXJnaW46IDVweCAwO1xufVxuXG4uZm9vdGVyIHtcbiAgYm90dG9tOiAwO1xuICBoZWlnaHQ6IDkwcHg7XG59XG5cbi5mb290ZXIgLmNvbnRyb2xzIHtcbiAgbWFyZ2luOiAzcHggMDtcbn1cbi5tZWRpYS1wYW5lbCB7XG4gIGRpc3BsYXk6IGZsZXg7XG4gIGZsZXgtZGlyZWN0aW9uOiByb3c7XG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgZmxleDogMSAxIGF1dG87XG59XG4ubWVkaWEtcGFuZWwgdmlkZW8ge1xuICBkaXNwbGF5OiBub25lO1xufVxuLm1lZGlhLXBhbmVsLnZpZGVvIHZpZGVvIHtcbiAgLypoZWlnaHQ6IDcwcHg7Ki9cbiAgaGVpZ2h0OiA5MHB4O1xuICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XG4gIG1hcmdpbi1yaWdodDogNnB4O1xufVxuLm1lZGlhLXBhbmVsIC53YXZlZm9ybS1hbmQtYnV0dG9ucyB7XG4gIGZsZXg6IDEgMSBhdXRvO1xufVxuLm1lZGlhLXBhbmVsIC53YXZlZm9ybSB7XG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgaGVpZ2h0OiA1MHB4O1xuICB3aWR0aDogMTAwJTtcbn1cbi5tZWRpYS1wYW5lbCAud2F2ZWZvcm0tbG9hZGluZyB7XG4gIGhlaWdodDogNTBweDtcbiAgd2lkdGg6IDEwMCU7XG59XG48L3N0eWxlPlxuIiwiZXhwb3J0IGZ1bmN0aW9uIG1zVG9UaW1lKHMsIHttcz1mYWxzZSwgaG91cnM9dHJ1ZX09e30pIHtcbiAgaWYocyA9PSB1bmRlZmluZWQgfHwgaXNOYU4ocykpIHtcbiAgICByZXR1cm4gYCR7aG91cnMgPyAnLS06JyA6ICcnfS0tOi0tJHttcyA/ICcuLS0tJyA6ICcnfWA7XG4gIH1cbiAgZnVuY3Rpb24gcGFkKG4sIHopIHtcbiAgICB6ID0geiB8fCAyO1xuICAgIHJldHVybiAoJzAwJyArIG4pLnNsaWNlKC16KTtcbiAgfVxuICB2YXIgX21zID0gcyAlIDEwMDA7XG4gIHMgPSAocyAtIF9tcykgLyAxMDAwO1xuICB2YXIgc2VjcyA9IHMgJSA2MDtcbiAgcyA9IChzIC0gc2VjcykgLyA2MDtcbiAgdmFyIG1pbnMgPSBzICUgNjA7XG4gIHZhciBocnMgPSAocyAtIG1pbnMpIC8gNjA7XG4gIHJldHVybiAoKGhycyB8fCBob3VycykgPyAocGFkKGhycykgKyAnOicpIDogJycpICsgcGFkKG1pbnMpICsgJzonICsgcGFkKHNlY3MpICsgKG1zID8gJy4nICsgcGFkKF9tcywgMykgOiAnJyk7XG59XG4iLCJcblxuYXN5bmMgZnVuY3Rpb24gZmV0Y2hBdWRpb0ZpbGVBbmREZWNvZGUodXJsKSB7XG5cbiAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwpO1xuXG4gIGNvbnN0IGJ1ZmZlciA9IGF3YWl0IGRlY29kZUF1ZGlvRmlsZUJ1ZmZlcihhd2FpdCByZXNwb25zZS5hcnJheUJ1ZmZlcigpKTtcblxuICByZXR1cm4gYnVmZmVyO1xufVxuXG5hc3luYyBmdW5jdGlvbiBkZWNvZGVBdWRpb0ZpbGVCdWZmZXIoYXJyYXlCdWZmZXIpIHtcblxuICBjb25zdCBjb250ZXh0ID0gbmV3IEF1ZGlvQ29udGV4dCgpO1xuXG4gIC8vIFRPRE86IGFkZCB0cnkge30gY2F0Y2gge31cblxuICBjb25zdCBidWZmZXIgPSBhd2FpdCBjb250ZXh0LmRlY29kZUF1ZGlvRGF0YShhcnJheUJ1ZmZlcik7XG5cbiAgY29udGV4dC5jbG9zZSgpO1xuXG4gIHJldHVybiBidWZmZXI7XG59XG5cbmZ1bmN0aW9uIEZsb2F0MzJBcnJheVRvSW50MTZBcnJheShmbG9hdEFycmF5KSB7XG4gIHJldHVybiBJbnQxNkFycmF5LmZyb20oZmxvYXRBcnJheS5tYXAoc2FtcGxlID0+IHNhbXBsZSAqIDB4ODAwMCkpO1xufVxuXG5mdW5jdGlvbiBidWZmZXJEYXRhKGJ1ZmZlciwgeyBjaGFubmVsID0gMCB9ID0ge30pIHtcbiAgY29uc3QgZGF0YSA9IGJ1ZmZlci5nZXRDaGFubmVsRGF0YShjaGFubmVsKTtcbiAgLy8gcmV0dXJuIEZsb2F0MzJBcnJheVRvSW50MTZBcnJheShkYXRhKTtcbiAgcmV0dXJuIGRhdGE7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHJlc2NhbGVBdWRpb0J1ZmZlcihpbnB1dEJ1ZmZlciwgeyBudW1iZXJPZkNoYW5uZWxzID0gMSwgbGVuZ3RoLCBzYW1wbGVSYXRlID0gMTYwMDAgfSA9IHt9KSB7XG5cbiAgaWYobGVuZ3RoID09PSB1bmRlZmluZWQpIHtcbiAgICBsZW5ndGggPSBpbnB1dEJ1ZmZlci5kdXJhdGlvbiAqIHNhbXBsZVJhdGU7XG4gIH1cblxuICBjb25zdCBjb250ZXh0ID0gbmV3IE9mZmxpbmVBdWRpb0NvbnRleHQobnVtYmVyT2ZDaGFubmVscywgbGVuZ3RoLCBzYW1wbGVSYXRlKTtcblxuICBjb25zdCBzb3VyY2UgPSBjb250ZXh0LmNyZWF0ZUJ1ZmZlclNvdXJjZSgpO1xuICBzb3VyY2UuY29ubmVjdChjb250ZXh0LmRlc3RpbmF0aW9uKTtcbiAgc291cmNlLmJ1ZmZlciA9IGlucHV0QnVmZmVyO1xuICBzb3VyY2Uuc3RhcnQoKTsgLy8gQXVkaW9CdWZmZXJTb3VyY2VOb2RlLnN0YXJ0KFt3aGVuXVssIG9mZnNldF1bLCBkdXJhdGlvbl0pXG4gIGNvbnN0IGJ1ZmZlciA9IGF3YWl0IGNvbnRleHQuc3RhcnRSZW5kZXJpbmcoKTtcbiAgY29udGV4dC5jbG9zZSgpO1xuICByZXR1cm4gYnVmZmVyO1xufVxuXG5cbmFzeW5jIGZ1bmN0aW9uIHNhbXBsZVByb2Nlc3NBdWRpb0J1ZmZlcihidWZmZXIpIHtcbiAgLy8gY29uc3Qgc2FtcGxlUmF0ZSA9IGJ1ZmZlci5zYW1wbGVSYXRlO1xuICBjaHVua3MucHVzaChGbG9hdDMyQXJyYXkuZnJvbShidWZmZXIuZ2V0Q2hhbm5lbERhdGEoMCkpKTtcblxuICBjb25zdCBvdXB1dEJ1ZmZlciA9IGF3YWl0IHJlc2NhbGVBdWRpb0J1ZmZlcihidWZmZXIsIHt9KTtcblxuICBjb25zdCBkYXRhID0gYnVmZmVyRGF0YShvdXRwdXRCdWZmZXIpO1xuXG4gIHRvdGFsU2FtcGxlcyArPSBkYXRhLmxlbmd0aDtcbiAgcmVjb3JkZWRDaHVua3MucHVzaChkYXRhKTtcblxuICAvKlxuICBpZih0b3RhbFNhbXBsZXMgPj0gMTYwMDAgKiAxMCkgeyAvLyAxMHNcbiAgICAvLyBUT0RPOiBhc3luY1xuXG4gICAgY29uc3QgZGF0YSA9IFtdO1xuICAgIGZvcihjb25zdCBjaHVuayBvZiByZWNvcmRlZENodW5rcykge1xuICAgICAgZGF0YS5wdXNoKEludDE2QXJyYXkuZnJvbShjaHVuay5tYXAoc2FtcGxlID0+IHNhbXBsZSAqIDB4ODAwMCkpKTtcbiAgICAgIC8vIHNhbXBsZUNvdW50ICs9IGNodW5rLmxlbmd0aDtcbiAgICB9XG4gICAgY29uc29sZS5sb2coZGF0YSlcbiAgICBjb25zdCBibG9iID0gbmV3IEJsb2IoZGF0YSlcblxuICAgIHRvdGFsU2FtcGxlcyA9IDA7XG4gICAgcmVjb3JkZWRDaHVua3MgPSBbXTtcblxuICAgIC8vIGNvbnNvbGUubG9nKCdjYWxsaW5nIEFTUicpXG4gICAgLy8gLy8gY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBheGlvcy5wb3N0KCdodHRwOi8vdGVuc29yOjkwMDAvZGF0YScsIGJsb2IpXG4gICAgLy8gLy8gY29uc29sZS5sb2cocmVzcG9uc2Uuc3RhdHVzLCBhd2FpdCByZXNwb25zZS5kYXRhKTtcbiAgICAvLyBhc3JTb2NrZXQuc2VuZChibG9iKTtcbiAgfVxuICAqL1xufVxuXG5cbmZ1bmN0aW9uIHByb2Nlc3NBdWRpb1N0cmVhbShzdHJlYW0sIGNhbGxiYWNrLCB7IGJ1ZmZlclNpemUgPSAxMDI0LCBudW1iZXJPZklucHV0Q2hhbm5lbHMgPSAxLCBudW1iZXJPZk91dHB1dENoYW5uZWxzID0gMSwgY29udGV4dCB9ID0ge30pIHtcblxuICAvLyBUaGUgYnVmZmVyIHNpemUgaW4gdW5pdHMgb2Ygc2FtcGxlLWZyYW1lcy4gSWYgc3BlY2lmaWVkLCB0aGUgYnVmZmVyU2l6ZSBtdXN0IGJlIG9uZSBvZiB0aGUgZm9sbG93aW5nIHZhbHVlczogMjU2LCA1MTIsIDEwMjQsIDIwNDgsIDQwOTYsIDgxOTIsIDE2Mzg0LlxuICAvLyBJZiBpdCdzIG5vdCBwYXNzZWQgaW4sIG9yIGlmIHRoZSB2YWx1ZSBpcyAwLCB0aGVuIHRoZSBpbXBsZW1lbnRhdGlvbiB3aWxsIGNob29zZSB0aGUgYmVzdCBidWZmZXIgc2l6ZSBmb3IgdGhlIGdpdmVuIGVudmlyb25tZW50LFxuICAvLyB3aGljaCB3aWxsIGJlIGEgY29uc3RhbnQgcG93ZXIgb2YgMiB0aHJvdWdob3V0IHRoZSBsaWZldGltZSBvZiB0aGUgbm9kZS5cblxuICAvLyBjb25zdCBjb250ZXh0ID0gbmV3IEF1ZGlvQ29udGV4dCgpO1xuICBpZihjb250ZXh0ID09PSB1bmRlZmluZWQpIHtcbiAgICBjb250ZXh0ID0gbmV3IEF1ZGlvQ29udGV4dCgpO1xuICB9XG5cbiAgY29uc3Qgc291cmNlID0gY29udGV4dC5jcmVhdGVNZWRpYVN0cmVhbVNvdXJjZShzdHJlYW0pO1xuICBjb25zdCBwcm9jZXNzb3IgPSBjb250ZXh0LmNyZWF0ZVNjcmlwdFByb2Nlc3NvcihidWZmZXJTaXplLCBudW1iZXJPZklucHV0Q2hhbm5lbHMsIG51bWJlck9mT3V0cHV0Q2hhbm5lbHMpO1xuXG4gIHNvdXJjZS5jb25uZWN0KHByb2Nlc3Nvcik7XG4gIHByb2Nlc3Nvci5jb25uZWN0KGNvbnRleHQuZGVzdGluYXRpb24pO1xuXG4gIHByb2Nlc3Nvci5vbmF1ZGlvcHJvY2VzcyA9IGZ1bmN0aW9uKGUpIHtcbiAgICBjb25zdCBidWZmZXIgPSBlLmlucHV0QnVmZmVyO1xuICAgIGlmKGNhbGxiYWNrKSB7XG4gICAgICBjYWxsYmFjayhlLmlucHV0QnVmZmVyKTtcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIGNvbnRleHQ7XG5cbiAgLy8gaWYoY29udGV4dC5zdGF0ZSA9PT0gJ3N1c3BlbmRlZCcpXG4gIC8vICAgY29uc29sZS5sb2coJ3Jlc3VtaW5nJylcbiAgLy8gICBjb250ZXh0LnJlc3VtZSgpO1xuICAvLyBpZihjb250ZXh0LnN0YXRlID09PSAncnVubmluZycpXG4gIC8vICAgY29uc29sZS5sb2coJ3N1c3BlbmRpbmcnKVxuXG59XG5cbi8vIGZ1bmN0aW9uIGxvYWRSYXdBdWRpb0RhdGEoKSB7XG4vLyB9XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWNvZGVBdWRpb0ZpbGVEYXRhKGFycmF5QnVmZmVyKSB7XG5cbiAgY29uc3QgYnVmZmVyID0gYXdhaXQgZGVjb2RlQXVkaW9GaWxlQnVmZmVyKGFycmF5QnVmZmVyKTtcblxuICBjb25zdCBkYXRhID0gYnVmZmVyRGF0YShidWZmZXIpO1xuXG4gIHJldHVybiB7IGRhdGE6IEZsb2F0MzJBcnJheVRvSW50MTZBcnJheShkYXRhKSwgc2FtcGxlUmF0ZTogYnVmZmVyLnNhbXBsZVJhdGUsIGxlbmd0aDogYnVmZmVyLmxlbmd0aCwgZHVyYXRpb246IGJ1ZmZlci5kdXJhdGlvbiwgbnVtYmVyT2ZDaGFubmVsczogYnVmZmVyLm51bWJlck9mQ2hhbm5lbHMgfTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZldGNoQW5kRGVjb2RlQXVkaW9GaWxlKHVybCkge1xuXG4gIGNvbnN0IGJ1ZmZlciA9IGF3YWl0IGZldGNoQXVkaW9GaWxlQW5kRGVjb2RlKHVybCk7XG5cbiAgY29uc3QgZGF0YSA9IGJ1ZmZlckRhdGEoYnVmZmVyKTtcblxuICByZXR1cm4geyBkYXRhOiBGbG9hdDMyQXJyYXlUb0ludDE2QXJyYXkoZGF0YSksIHNhbXBsZVJhdGU6IGJ1ZmZlci5zYW1wbGVSYXRlLCBsZW5ndGg6IGJ1ZmZlci5sZW5ndGgsIGR1cmF0aW9uOiBidWZmZXIuZHVyYXRpb24sIG51bWJlck9mQ2hhbm5lbHM6IGJ1ZmZlci5udW1iZXJPZkNoYW5uZWxzIH07XG59XG4iLCI8dGVtcGxhdGU+XG4gIDxFZGl0b3IgY2xhc3M9XCJcIiA6dHJhbnNjcmlwdD1cInRyYW5zY3JpcHRcIiA6d2F2ZWZvcm09XCJ3YXZlZm9ybVwiIDpkdXJhdGlvbj1cImR1cmF0aW9uXCIgOnVybD1cInVybFwiIDpvblNhdmU9XCJvblNhdmVcIiBAc2V0LXBvc2l0aW9uPVwib25TZXRQb3NpdGlvblwiIHJlZj1cImVkaXRvclwiPjwvRWRpdG9yPlxuPC90ZW1wbGF0ZT5cblxuXG48c2NyaXB0IGxhbmc9XCJ0c1wiPlxuLy8gaW1wb3J0IGJvb3RzdHJhcCBjc3Ncbi8vIGltcG9ydCAnYm9vdHN0cmFwL2Rpc3QvY3NzL2Jvb3RzdHJhcC5taW4uY3NzJztcbi8vIGltcG9ydCAnYm9vdHN0cmFwLWljb25zL2ZvbnQvYm9vdHN0cmFwLWljb25zLmNzcyc7XG5cbmltcG9ydCBFZGl0b3IgZnJvbSAnLi9jb21wb25lbnRzL0VkaXRvci52dWUnO1xuXG5pbXBvcnQgeyBkZWNvZGVBdWRpb0ZpbGVEYXRhLCBmZXRjaEFuZERlY29kZUF1ZGlvRmlsZSB9IGZyb20gJy4vYXVkaW8uanMnO1xuXG5leHBvcnQgZGVmYXVsdCB7XG4gIGNvbXBvbmVudHM6IHtcbiAgICBFZGl0b3IsXG4gIH0sXG4gIHByb3BzOiB7XG4gIH0sXG4gIGRhdGEoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHRyYW5zY3JpcHQ6IHt9LFxuICAgICAgd2F2ZWZvcm06IFtdLCAgLy8gcmF3IGF1ZGlvIGRhdGFcbiAgICAgIGR1cmF0aW9uOiAwLFxuICAgICAgdXJsOiB1bmRlZmluZWQsXG4gICAgfVxuICB9LFxuICBhc3luYyBtb3VudGVkKCkge1xuICB9LFxuXG4gIHVubW91bnRlZCgpIHtcbiAgICBpZih0aGlzLnVybCAmJiB0aGlzLnVybC5sZW5ndGggPiAwICYmIHRoaXMudXJsLnN0YXJ0c1dpdGgoJ2Jsb2I6JykpIHtcbiAgICAgIFVSTC5yZXZva2VPYmplY3RVUkwodGhpcy51cmwpO1xuICAgIH1cbiAgfSxcblxuICB3YXRjaDoge1xuICB9LFxuXG4gIG1ldGhvZHM6IHtcblxuICAgIGFzeW5jIGxvYWQoeyBhdWRpbywgdHJhbnNjcmlwdCwgZmlsZSwgd2F2ZWZvcm0gfSkge1xuICAgICAgaWYod2F2ZWZvcm0gIT09IHVuZGVmaW5lZCAmJiB3YXZlZm9ybSAhPT0gbnVsbCkge1xuICAgICAgICBpZih3YXZlZm9ybSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7XG4gICAgICAgICAgY29uc3QgYXVkaW9EYXRhID0gYXdhaXQgZGVjb2RlQXVkaW9GaWxlRGF0YSh3YXZlZm9ybSk7XG4gICAgICAgICAgd2F2ZWZvcm0gPSBhdWRpb0RhdGEuZGF0YTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYodHlwZW9mKGF1ZGlvKSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgdGhpcy4kcmVmcy5lZGl0b3Iud2F2ZWZvcm1Mb2FkaW5nKCk7XG4gICAgICAgIGlmKHRoaXMudXJsICYmIHRoaXMudXJsLmxlbmd0aCA+IDAgJiYgdGhpcy51cmwuc3RhcnRzV2l0aCgnYmxvYjonKSkge1xuICAgICAgICAgIFVSTC5yZXZva2VPYmplY3RVUkwodGhpcy51cmwpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHVybCA9IGF1ZGlvO1xuICAgICAgICBpZih3YXZlZm9ybSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgd2F2ZWZvcm0gPSBhdWRpbztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLiRyZWZzLmVkaXRvci5sb2FkKHsgdXJsLCB3YXZlZm9ybSB9KTtcbiAgICAgICAgLypcbiAgICAgICAgLy8gdGhpcy51cmwgPSB1cmw7XG4gICAgICAgIGNvbnN0IGF1ZGlvRGF0YSA9IGF3YWl0IGZldGNoQW5kRGVjb2RlQXVkaW9GaWxlKGF1ZGlvKTtcbiAgICAgICAgLy8gdGhpcy53YXZlZm9ybSA9IGF1ZGlvRGF0YS5kYXRhO1xuICAgICAgICAvLyB0aGlzLmR1cmF0aW9uID0gYXVkaW9EYXRhLmR1cmF0aW9uICogMTAwMDtcbiAgICAgICAgdGhpcy4kcmVmcy5lZGl0b3IubG9hZCh7IHVybCwgd2F2ZWZvcm06IGF1ZGlvRGF0YS5kYXRhLCBkdXJhdGlvbjogYXVkaW9EYXRhLmR1cmF0aW9uICogMTAwMCB9KTtcbiAgICAgICAgKi9cbiAgICAgIH0gZWxzZSBpZihhdWRpbyBpbnN0YW5jZW9mIEZpbGUpIHtcbiAgICAgICAgdGhpcy4kcmVmcy5lZGl0b3Iud2F2ZWZvcm1Mb2FkaW5nKCk7XG4gICAgICAgIC8vIHRoaXMud2F2ZWZvcm0gPSB1bmRlZmluZWQ7XG4gICAgICAgIGlmKHRoaXMudXJsICYmIHRoaXMudXJsLmxlbmd0aCA+IDAgJiYgdGhpcy51cmwuc3RhcnRzV2l0aCgnYmxvYjonKSkge1xuICAgICAgICAgIFVSTC5yZXZva2VPYmplY3RVUkwodGhpcy51cmwpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHVybCA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYXVkaW8pO1xuICAgICAgICBpZih3YXZlZm9ybSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgd2F2ZWZvcm0gPSBhdWRpbztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLiRyZWZzLmVkaXRvci5sb2FkKHsgdXJsLCB3YXZlZm9ybSB9KTtcbiAgICAgICAgLypcbiAgICAgICAgLy8gdGhpcy51cmwgPSB1cmw7XG4gICAgICAgIGNvbnN0IGF1ZGlvRGF0YSA9IGF3YWl0IGRlY29kZUF1ZGlvRmlsZURhdGEoYXdhaXQgYXVkaW8uYXJyYXlCdWZmZXIoKSk7XG4gICAgICAgIC8vIHRoaXMud2F2ZWZvcm0gPSBhdWRpb0RhdGEuZGF0YTtcbiAgICAgICAgLy8gdGhpcy5kdXJhdGlvbiA9IGF1ZGlvRGF0YS5kdXJhdGlvbiAqIDEwMDA7XG4gICAgICAgIHRoaXMuJHJlZnMuZWRpdG9yLmxvYWQoeyB1cmwsIHdhdmVmb3JtOiBhdWRpb0RhdGEuZGF0YSwgZHVyYXRpb246IGF1ZGlvRGF0YS5kdXJhdGlvbiAqIDEwMDAgfSk7XG4gICAgICAgICovXG4gICAgICB9IGVsc2UgaWYoYXVkaW8gaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikge1xuICAgICAgICB0aGlzLiRyZWZzLmVkaXRvci53YXZlZm9ybUxvYWRpbmcoKTtcbiAgICAgICAgY29uc3QgdXJsID0gVVJMLmNyZWF0ZU9iamVjdFVSTChmaWxlIHx8IG5ldyBCbG9iKFthdWRpb10pKTtcbiAgICAgICAgLy8gdGhpcy51cmwgPSB1cmw7XG4gICAgICAgIGNvbnN0IGF1ZGlvRGF0YSA9IGF3YWl0IGRlY29kZUF1ZGlvRmlsZURhdGEoYXVkaW8pO1xuICAgICAgICAvLyB0aGlzLndhdmVmb3JtID0gYXVkaW9EYXRhLmRhdGE7XG4gICAgICAgIC8vIHRoaXMuZHVyYXRpb24gPSBhdWRpb0RhdGEuZHVyYXRpb24gKiAxMDAwO1xuICAgICAgICBpZih3YXZlZm9ybSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgd2F2ZWZvcm0gPSBhdWRpb0RhdGEuZGF0YTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLiRyZWZzLmVkaXRvci5sb2FkKHsgdXJsLCB3YXZlZm9ybSwgZHVyYXRpb246IGF1ZGlvRGF0YS5kdXJhdGlvbiAqIDEwMDAgfSk7XG4gICAgICB9IGVsc2UgaWYoYXVkaW8gPT09IG51bGwpIHtcbiAgICAgICAgaWYodGhpcy51cmwgJiYgdGhpcy51cmwubGVuZ3RoID4gMCAmJiB0aGlzLnVybC5zdGFydHNXaXRoKCdibG9iOicpKSB7XG4gICAgICAgICAgVVJMLnJldm9rZU9iamVjdFVSTCh0aGlzLnVybCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYod2F2ZWZvcm0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIHdhdmVmb3JtID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLiRyZWZzLmVkaXRvci5sb2FkKHsgdXJsOiAnJywgd2F2ZWZvcm0sIGR1cmF0aW9uOiAwIH0pO1xuICAgICAgfSBlbHNlIGlmKHdhdmVmb3JtKSB7XG4gICAgICAgIC8vIHRoaXMuJHJlZnMuZWRpdG9yLndhdmVmb3JtTG9hZGluZygpO1xuICAgICAgICB0aGlzLiRyZWZzLmVkaXRvci5sb2FkKHsgd2F2ZWZvcm0gfSk7XG4gICAgICB9XG4gICAgICBpZih0cmFuc2NyaXB0KSB7XG4gICAgICAgIGlmKHR5cGVvZiB0cmFuc2NyaXB0ID09PSAnc3RyaW5nJykge1xuICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godHJhbnNjcmlwdCk7XG4gICAgICAgICAgdGhpcy50cmFuc2NyaXB0ID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICB9IGVsc2UgaWYodHJhbnNjcmlwdCBpbnN0YW5jZW9mIEZpbGUpIHtcbiAgICAgICAgICB0aGlzLnRyYW5zY3JpcHQgPSBKU09OLnBhcnNlKGF3YWl0IHRyYW5zY3JpcHQudGV4dCgpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLnRyYW5zY3JpcHQgPSB0cmFuc2NyaXB0O1xuICAgICAgICB9XG4gICAgICAvLyB9IGVsc2UgaWYodGhpcy5hdWRpb0RhdGEpIHtcbiAgICAgICAgLy8gVE9ETzogY2FsbCBBU1JcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgYXN5bmMgb25TZXRQb3NpdGlvbihwb3NpdGlvbikge1xuICAgICAgICBjb25zb2xlLmRlYnVnKCdvbiBzZXQgcG9zaXRpb246JywgcG9zaXRpb24pO1xuICAgIH0sXG5cbiAgICBhc3luYyBvblNhdmUodHJhbnNjcmlwdCkge1xuICAgICAgICBjb25zb2xlLmxvZygnb24gc2F2ZSB0cmFuc2NyaXB0OicsIHRyYW5zY3JpcHQpO1xuICAgIH0sXG5cbiAgICBhc3luYyBzYXZlKHRyYW5zY3JpcHQpIHtcbiAgICAgIGNvbnNvbGUubG9nKCdzYXZlIHRyYW5zY3JpcHQgbm90IGltcGxlbWVudGVkLCB0cmFuc2NyaXB0OicsIHRyYW5zY3JpcHQpO1xuICAgIH0sXG4gIH0sXG59O1xuXG48L3NjcmlwdD5cblxuPHN0eWxlIHNjb3BlZD5cbjwvc3R5bGU+XG4iLCJpbXBvcnQgeyBjcmVhdGVBcHAgfSBmcm9tICd2dWUnXG5pbXBvcnQgRWRpdG9yV2l0aE1lZGlhTG9hZGVyIGZyb20gJy4vRWRpdG9yV2l0aE1lZGlhTG9hZGVyLnZ1ZSdcblxuLy8gaW1wb3J0IGJvb3RzdHJhcCBjc3NcbmltcG9ydCAnYm9vdHN0cmFwL2Rpc3QvY3NzL2Jvb3RzdHJhcC5taW4uY3NzJztcbmltcG9ydCAnYm9vdHN0cmFwLWljb25zL2ZvbnQvYm9vdHN0cmFwLWljb25zLmNzcyc7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGluaXQoc2VsZWN0b3IgPSAnI2FwcCcpIHtcbiAgcmV0dXJuIGNyZWF0ZUFwcChFZGl0b3JXaXRoTWVkaWFMb2FkZXIpLm1vdW50KHNlbGVjdG9yKTtcbn1cbiJdLCJuYW1lcyI6WyJzdHIiLCJleHBlY3RzTG93ZXJDYXNlIiwibWFwIiwiT2JqZWN0IiwiY3JlYXRlIiwibGlzdCIsInNwbGl0IiwiaSIsImxlbmd0aCIsInZhbCIsInRvTG93ZXJDYXNlIiwiaXNTcGVjaWFsQm9vbGVhbkF0dHIiLCJ2YWx1ZSIsImlzQXJyYXkiLCJyZXMiLCJpdGVtIiwibm9ybWFsaXplZCIsImlzU3RyaW5nIiwicGFyc2VTdHJpbmdTdHlsZSIsIm5vcm1hbGl6ZVN0eWxlIiwia2V5IiwiaXNPYmplY3QiLCJsaXN0RGVsaW1pdGVyUkUiLCJwcm9wZXJ0eURlbGltaXRlclJFIiwiY3NzVGV4dCIsInJldCIsImZvckVhY2giLCJ0bXAiLCJ0cmltIiwibm9ybWFsaXplQ2xhc3MiLCJuYW1lIiwidG9EaXNwbGF5U3RyaW5nIiwidG9TdHJpbmciLCJvYmplY3RUb1N0cmluZyIsImlzRnVuY3Rpb24iLCJKU09OIiwic3RyaW5naWZ5IiwicmVwbGFjZXIiLCJTdHJpbmciLCJfa2V5IiwiX192X2lzUmVmIiwiaXNNYXAiLCJzaXplIiwiZW50cmllcyIsInJlZHVjZSIsInZhbDIiLCJpc1NldCIsInZhbHVlcyIsImlzUGxhaW5PYmplY3QiLCJFTVBUWV9PQkoiLCJFTVBUWV9BUlIiLCJOT09QIiwiTk8iLCJvblJFIiwiaXNPbiIsInRlc3QiLCJpc01vZGVsTGlzdGVuZXIiLCJzdGFydHNXaXRoIiwiZXh0ZW5kIiwiYXNzaWduIiwicmVtb3ZlIiwiYXJyIiwiZWwiLCJpbmRleE9mIiwic3BsaWNlIiwiaGFzT3duUHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd24iLCJjYWxsIiwiQXJyYXkiLCJ0b1R5cGVTdHJpbmciLCJpc1N5bWJvbCIsImlzUHJvbWlzZSIsInRoZW4iLCJjYXRjaCIsImlzSW50ZWdlcktleSIsInBhcnNlSW50IiwiaXNSZXNlcnZlZFByb3AiLCJjYWNoZVN0cmluZ0Z1bmN0aW9uIiwiZm4iLCJjYWNoZSIsImNhbWVsaXplUkUiLCJjYW1lbGl6ZSIsInJlcGxhY2UiLCJfIiwiYyIsInRvVXBwZXJDYXNlIiwiaHlwaGVuYXRlUkUiLCJoeXBoZW5hdGUiLCJjYXBpdGFsaXplIiwiY2hhckF0Iiwic2xpY2UiLCJ0b0hhbmRsZXJLZXkiLCJoYXNDaGFuZ2VkIiwib2xkVmFsdWUiLCJpcyIsImludm9rZUFycmF5Rm5zIiwiZm5zIiwiYXJnIiwiZGVmIiwib2JqIiwiZGVmaW5lUHJvcGVydHkiLCJjb25maWd1cmFibGUiLCJlbnVtZXJhYmxlIiwidG9OdW1iZXIiLCJuIiwicGFyc2VGbG9hdCIsImlzTmFOIiwiX2dsb2JhbFRoaXMiLCJhY3RpdmVFZmZlY3RTY29wZSIsImNvbnN0cnVjdG9yIiwiZGV0YWNoZWQiLCJhY3RpdmUiLCJlZmZlY3RzIiwiY2xlYW51cHMiLCJwYXJlbnQiLCJpbmRleCIsInNjb3BlcyIsInB1c2giLCJ0aGlzIiwicnVuIiwib24iLCJvZmYiLCJzdG9wIiwiZnJvbVBhcmVudCIsImwiLCJsYXN0MiIsInBvcCIsImNyZWF0ZURlcCIsImRlcCIsIlNldCIsInciLCJ3YXNUcmFja2VkIiwidHJhY2tPcEJpdCIsIm5ld1RyYWNrZWQiLCJ0YXJnZXRNYXAiLCJXZWFrTWFwIiwiZWZmZWN0VHJhY2tEZXB0aCIsImFjdGl2ZUVmZmVjdCIsIklURVJBVEVfS0VZIiwiU3ltYm9sIiwiTUFQX0tFWV9JVEVSQVRFX0tFWSIsInNjaGVkdWxlciIsInNjb3BlIiwiZGVwcyIsImVmZmVjdCIsImxhc3RTaG91bGRUcmFjayIsInNob3VsZFRyYWNrIiwicHRyIiwiZGVsZXRlIiwib25TdG9wIiwidHJhY2tTdGFjayIsInRhcmdldCIsInR5cGUiLCJkZXBzTWFwIiwiZ2V0Iiwic2V0IiwiTWFwIiwiZGVidWdnZXJFdmVudEV4dHJhSW5mbyIsInNob3VsZFRyYWNrMiIsImhhcyIsImFkZCIsIm5ld1ZhbHVlIiwib2xkVGFyZ2V0Iiwia2V5MiIsImFsbG93UmVjdXJzZSIsImlzTm9uVHJhY2thYmxlS2V5cyIsImJ1aWx0SW5TeW1ib2xzIiwiZ2V0T3duUHJvcGVydHlOYW1lcyIsImZpbHRlciIsInNoYWxsb3dHZXQiLCJyZWFkb25seUdldCIsImFycmF5SW5zdHJ1bWVudGF0aW9ucyIsImluc3RydW1lbnRhdGlvbnMiLCJhcmdzIiwidG9SYXciLCJhcHBseSIsImlzUmVhZG9ubHkyIiwic2hhbGxvdyIsInJlY2VpdmVyIiwic2hhbGxvd1JlYWRvbmx5TWFwIiwicmVhZG9ubHlNYXAiLCJzaGFsbG93UmVhY3RpdmVNYXAiLCJyZWFjdGl2ZU1hcCIsInRhcmdldElzQXJyYXkiLCJSZWZsZWN0IiwiaXNSZWYiLCJyZWFkb25seSIsInJlYWN0aXZlIiwiaXNSZWFkb25seSIsImlzU2hhbGxvdyIsImhhZEtleSIsIk51bWJlciIsInJlc3VsdCIsIm11dGFibGVIYW5kbGVycyIsImRlbGV0ZVByb3BlcnR5Iiwib3duS2V5cyIsInJlYWRvbmx5SGFuZGxlcnMiLCJzaGFsbG93UmVhY3RpdmVIYW5kbGVycyIsInRvU2hhbGxvdyIsImdldFByb3RvIiwidiIsImdldFByb3RvdHlwZU9mIiwiaXNTaGFsbG93MiIsInJhd1RhcmdldCIsInJhd0tleSIsInRyYWNrIiwid3JhcCIsInRvUmVhZG9ubHkiLCJ0b1JlYWN0aXZlIiwiaGFzMiIsImdldDIiLCJoYWRJdGVtcyIsImNsZWFyIiwiY2FsbGJhY2siLCJ0aGlzQXJnIiwib2JzZXJ2ZWQiLCJtZXRob2QiLCJ0YXJnZXRJc01hcCIsImlzUGFpciIsIml0ZXJhdG9yIiwiaXNLZXlPbmx5IiwiaW5uZXJJdGVyYXRvciIsIm5leHQiLCJkb25lIiwibXV0YWJsZUluc3RydW1lbnRhdGlvbnMyIiwiZ2V0JDEiLCJoYXMkMSIsInNldCQxIiwiZGVsZXRlRW50cnkiLCJjcmVhdGVGb3JFYWNoIiwic2hhbGxvd0luc3RydW1lbnRhdGlvbnMyIiwicmVhZG9ubHlJbnN0cnVtZW50YXRpb25zMiIsImNyZWF0ZVJlYWRvbmx5TWV0aG9kIiwic2hhbGxvd1JlYWRvbmx5SW5zdHJ1bWVudGF0aW9uczIiLCJjcmVhdGVJdGVyYWJsZU1ldGhvZCIsIm11dGFibGVJbnN0cnVtZW50YXRpb25zIiwicmVhZG9ubHlJbnN0cnVtZW50YXRpb25zIiwic2hhbGxvd0luc3RydW1lbnRhdGlvbnMiLCJzaGFsbG93UmVhZG9ubHlJbnN0cnVtZW50YXRpb25zIiwibXV0YWJsZUNvbGxlY3Rpb25IYW5kbGVycyIsInNoYWxsb3dDb2xsZWN0aW9uSGFuZGxlcnMiLCJyZWFkb25seUNvbGxlY3Rpb25IYW5kbGVycyIsImlzRXh0ZW5zaWJsZSIsInJhd1R5cGUiLCJ0YXJnZXRUeXBlTWFwIiwidG9SYXdUeXBlIiwiY3JlYXRlUmVhY3RpdmVPYmplY3QiLCJiYXNlSGFuZGxlcnMiLCJjb2xsZWN0aW9uSGFuZGxlcnMiLCJwcm94eU1hcCIsImV4aXN0aW5nUHJveHkiLCJ0YXJnZXRUeXBlIiwiZ2V0VGFyZ2V0VHlwZSIsInByb3h5IiwiUHJveHkiLCJpc1JlYWN0aXZlIiwicmF3IiwiciIsInNoYWxsb3dVbndyYXBIYW5kbGVycyIsInVucmVmIiwicmVmIiwib2JqZWN0V2l0aFJlZnMiLCJnZXR0ZXIiLCJfc2V0dGVyIiwiaXNTU1IiLCJfZGlydHkiLCJSZWFjdGl2ZUVmZmVjdCIsImNvbXB1dGVkIiwiX2NhY2hlYWJsZSIsInNlbGYyIiwiX3ZhbHVlIiwiaW5zdGFuY2UiLCJlcnIiLCJjYWxsV2l0aEVycm9ySGFuZGxpbmciLCJjYWxsV2l0aEFzeW5jRXJyb3JIYW5kbGluZyIsInRocm93SW5EZXYiLCJ2bm9kZSIsImN1ciIsImV4cG9zZWRJbnN0YW5jZSIsImVycm9ySW5mbyIsImVycm9yQ2FwdHVyZWRIb29rcyIsImVjIiwiYXBwRXJyb3JIYW5kbGVyIiwiYXBwQ29udGV4dCIsImNvbmZpZyIsImVycm9ySGFuZGxlciIsImNvbnRleHRWTm9kZSIsImVycm9yIiwiUHJvbWlzZSIsInJlc29sdmUiLCJpc0ZsdXNoaW5nIiwiaXNGbHVzaFBlbmRpbmciLCJxdWV1ZSIsImZsdXNoSW5kZXgiLCJwZW5kaW5nUHJlRmx1c2hDYnMiLCJhY3RpdmVQcmVGbHVzaENicyIsInByZUZsdXNoSW5kZXgiLCJwZW5kaW5nUG9zdEZsdXNoQ2JzIiwiYWN0aXZlUG9zdEZsdXNoQ2JzIiwicG9zdEZsdXNoSW5kZXgiLCJyZXNvbHZlZFByb21pc2UiLCJjdXJyZW50Rmx1c2hQcm9taXNlIiwiY3VycmVudFByZUZsdXNoUGFyZW50Sm9iIiwicDIiLCJiaW5kIiwiam9iIiwiaW5jbHVkZXMiLCJpZCIsImlkMiIsInN0YXJ0MiIsImVuZCIsIm1pZGRsZSIsImdldElkIiwiZmluZEluc2VydGlvbkluZGV4IiwiZmx1c2hKb2JzIiwiY2IiLCJhY3RpdmVRdWV1ZSIsInBlbmRpbmdRdWV1ZSIsInNlZW4iLCJwYXJlbnRKb2IiLCJkZWR1cGVkIiwic29ydCIsImEiLCJiIiwiSW5maW5pdHkiLCJldmVudCIsInJhd0FyZ3MiLCJwcm9wcyIsImlzTW9kZWxMaXN0ZW5lcjIiLCJtb2RlbEFyZyIsIm1vZGlmaWVyc0tleSIsIm51bWJlciIsImhhbmRsZXJOYW1lIiwiaGFuZGxlciIsIm9uY2VIYW5kbGVyIiwiZW1pdHRlZCIsImNvbXAiLCJhc01peGluIiwiZW1pdHNDYWNoZSIsImNhY2hlZCIsImVtaXRzIiwiaGFzRXh0ZW5kcyIsImV4dGVuZEVtaXRzIiwicmF3MiIsIm5vcm1hbGl6ZWRGcm9tRXh0ZW5kIiwibm9ybWFsaXplRW1pdHNPcHRpb25zIiwibWl4aW5zIiwiZXh0ZW5kcyIsIm9wdGlvbnMiLCJjdXJyZW50UmVuZGVyaW5nSW5zdGFuY2UiLCJjdXJyZW50U2NvcGVJZCIsInByZXYiLCJfX3Njb3BlSWQiLCJDb21wb25lbnQiLCJ3aXRoUHJveHkiLCJwcm9wc09wdGlvbnMiLCJzbG90cyIsImF0dHJzIiwiZW1pdCIsInJlbmRlciIsInJlbmRlckNhY2hlIiwiZGF0YSIsInNldHVwU3RhdGUiLCJjdHgiLCJpbmhlcml0QXR0cnMiLCJmYWxsdGhyb3VnaEF0dHJzIiwic2V0Q3VycmVudFJlbmRlcmluZ0luc3RhbmNlIiwic2hhcGVGbGFnIiwicHJveHlUb1VzZSIsIm5vcm1hbGl6ZVZOb2RlIiwicmVuZGVyMiIsImdldEZ1bmN0aW9uYWxGYWxsdGhyb3VnaCIsImNyZWF0ZVZOb2RlIiwiQ29tbWVudCIsInJvb3QyIiwia2V5cyIsInNvbWUiLCJmaWx0ZXJNb2RlbExpc3RlbmVycyIsImNsb25lVk5vZGUiLCJkaXJzIiwiY29uY2F0IiwidHJhbnNpdGlvbiIsInByZXZQcm9wcyIsIm5leHRQcm9wcyIsImVtaXRzT3B0aW9ucyIsIm5leHRLZXlzIiwiaXNFbWl0TGlzdGVuZXIiLCJkZWZhdWx0VmFsdWUiLCJ0cmVhdERlZmF1bHRBc0ZhY3RvcnkiLCJjdXJyZW50SW5zdGFuY2UiLCJwcm92aWRlcyIsImFyZ3VtZW50cyIsIklOSVRJQUxfV0FUQ0hFUl9WQUxVRSIsInNvdXJjZSIsImRvV2F0Y2giLCJpbW1lZGlhdGUiLCJkZWVwIiwiZmx1c2giLCJvblRyYWNrIiwib25UcmlnZ2VyIiwiY2xlYW51cCIsImZvcmNlVHJpZ2dlciIsImlzTXVsdGlTb3VyY2UiLCJpc1NoYWxsb3ckMSIsInMiLCJ0cmF2ZXJzZSIsImlzVW5tb3VudGVkIiwib25DbGVhbnVwIiwiYmFzZUdldHRlciIsImlzSW5TU1JDb21wb25lbnRTZXR1cCIsInF1ZXVlUG9zdFJlbmRlckVmZmVjdCIsInN1c3BlbnNlIiwiaXNNb3VudGVkIiwicHVibGljVGhpcyIsImNyZWF0ZVBhdGhHZXR0ZXIiLCJwYXRoIiwic2VnbWVudHMiLCJpc0FzeW5jV3JhcHBlciIsIl9fYXN5bmNMb2FkZXIiLCJpc0tlZXBBbGl2ZSIsIl9faXNLZWVwQWxpdmUiLCJob29rIiwid3JhcHBlZEhvb2siLCJfX3dkYyIsImN1cnJlbnQiLCJpc0RlYWN0aXZhdGVkIiwia2VlcEFsaXZlUm9vdCIsImluamVjdGVkIiwiaW5qZWN0SG9vayIsInByZXBlbmQiLCJob29rcyIsIl9fd2VoIiwidW5zaGlmdCIsImNyZWF0ZUhvb2siLCJsaWZlY3ljbGUiLCJvbkJlZm9yZU1vdW50Iiwib25Nb3VudGVkIiwib25CZWZvcmVVcGRhdGUiLCJvblVwZGF0ZWQiLCJvbkJlZm9yZVVubW91bnQiLCJvblVubW91bnRlZCIsIm9uU2VydmVyUHJlZmV0Y2giLCJvblJlbmRlclRyaWdnZXJlZCIsIm9uUmVuZGVyVHJhY2tlZCIsInNob3VsZENhY2hlQWNjZXNzIiwicmVzb2x2ZU1lcmdlZE9wdGlvbnMiLCJiZWZvcmVDcmVhdGUiLCJkYXRhT3B0aW9ucyIsImNvbXB1dGVkT3B0aW9ucyIsIm1ldGhvZHMiLCJ3YXRjaCIsIndhdGNoT3B0aW9ucyIsInByb3ZpZGUiLCJwcm92aWRlT3B0aW9ucyIsImluamVjdCIsImluamVjdE9wdGlvbnMiLCJjcmVhdGVkIiwiYmVmb3JlTW91bnQiLCJtb3VudGVkIiwiYmVmb3JlVXBkYXRlIiwidXBkYXRlZCIsImFjdGl2YXRlZCIsImRlYWN0aXZhdGVkIiwiYmVmb3JlRGVzdHJveSIsImJlZm9yZVVubW91bnQiLCJkZXN0cm95ZWQiLCJ1bm1vdW50ZWQiLCJyZW5kZXJUcmFja2VkIiwicmVuZGVyVHJpZ2dlcmVkIiwiZXJyb3JDYXB0dXJlZCIsInNlcnZlclByZWZldGNoIiwiZXhwb3NlIiwiY29tcG9uZW50cyIsImRpcmVjdGl2ZXMiLCJmaWx0ZXJzIiwiY2hlY2tEdXBsaWNhdGVQcm9wZXJ0aWVzIiwidW53cmFwUmVmIiwibm9ybWFsaXplSW5qZWN0Iiwib3B0IiwiZnJvbSIsImRlZmF1bHQiLCJ1bndyYXBJbmplY3RlZFJlZiIsIm1ldGhvZEhhbmRsZXIiLCJzZXQyIiwicGFyZW50UHJvdmlkZXMiLCJyZWdpc3RlciIsIl9ob29rIiwib25BY3RpdmF0ZWQiLCJvbkRlYWN0aXZhdGVkIiwib25FcnJvckNhcHR1cmVkIiwiZXhwb3NlZCIsImgiLCJjcmVhdGVXYXRjaGVyIiwiYmFzZSIsImV4dGVuZHNPcHRpb25zIiwiZ2xvYmFsTWl4aW5zIiwib3B0aW9uc0NhY2hlIiwib3B0aW9uTWVyZ2VTdHJhdGVnaWVzIiwicmVzb2x2ZWQiLCJtZXJnZU9wdGlvbnMiLCJtIiwidG8iLCJzdHJhdHMiLCJzdHJhdCIsImludGVybmFsT3B0aW9uTWVyZ2VTdHJhdHMiLCJtZXJnZURhdGFGbiIsIm1lcmdlT2JqZWN0T3B0aW9ucyIsIm1lcmdlQXNBcnJheSIsIm1lcmdlZCIsInJhd1Byb3BzIiwiaXNTdGF0ZWZ1bCIsIkludGVybmFsT2JqZWN0S2V5IiwicHJvcHNEZWZhdWx0cyIsIm5lZWRDYXN0S2V5cyIsInJhd0Nhc3RWYWx1ZXMiLCJoYXNBdHRyc0NoYW5nZWQiLCJjYW1lbEtleSIsInJhd0N1cnJlbnRQcm9wcyIsImNhc3RWYWx1ZXMiLCJyZXNvbHZlUHJvcFZhbHVlIiwiaXNBYnNlbnQiLCJoYXNEZWZhdWx0IiwiRnVuY3Rpb24iLCJwcm9wc0NhY2hlIiwiZXh0ZW5kUHJvcHMiLCJub3JtYWxpemVQcm9wc09wdGlvbnMiLCJub3JtYWxpemVkS2V5IiwidmFsaWRhdGVQcm9wTmFtZSIsInByb3AiLCJib29sZWFuSW5kZXgiLCJnZXRUeXBlSW5kZXgiLCJCb29sZWFuIiwic3RyaW5nSW5kZXgiLCJjdG9yIiwibWF0Y2giLCJnZXRUeXBlIiwiZXhwZWN0ZWRUeXBlcyIsImZpbmRJbmRleCIsImlzU2FtZVR5cGUiLCJ0IiwiaXNJbnRlcm5hbEtleSIsIm5vcm1hbGl6ZVNsb3RWYWx1ZSIsIm5vcm1hbGl6ZVNsb3QiLCJyYXdTbG90IiwiaXNOb25TY29wZWRTbG90IiwiX24iLCJyZW5kZXJGbldpdGhDb250ZXh0IiwiX2QiLCJwcmV2SW5zdGFuY2UiLCJfYyIsIndpdGhDdHgiLCJub3JtYWxpemVPYmplY3RTbG90cyIsInJhd1Nsb3RzIiwiX2N0eCIsIm5vcm1hbGl6ZVZOb2RlU2xvdHMiLCJjaGlsZHJlbjIiLCJwcmV2Vk5vZGUiLCJiaW5kaW5ncyIsIm9sZEJpbmRpbmdzIiwiYmluZGluZyIsImRpciIsImFwcCIsImlzTmF0aXZlVGFnIiwicGVyZm9ybWFuY2UiLCJnbG9iYWxQcm9wZXJ0aWVzIiwid2FybkhhbmRsZXIiLCJjb21waWxlck9wdGlvbnMiLCJ1aWQiLCJoeWRyYXRlIiwicm9vdENvbXBvbmVudCIsInJvb3RQcm9wcyIsImNvbnRleHQiLCJjcmVhdGVBcHBDb250ZXh0IiwiaW5zdGFsbGVkUGx1Z2lucyIsIl91aWQiLCJfY29tcG9uZW50IiwiX3Byb3BzIiwiX2NvbnRhaW5lciIsIl9jb250ZXh0IiwiX2luc3RhbmNlIiwidmVyc2lvbiIsInVzZSIsInBsdWdpbiIsImluc3RhbGwiLCJtaXhpbiIsImNvbXBvbmVudCIsImRpcmVjdGl2ZSIsIm1vdW50Iiwicm9vdENvbnRhaW5lciIsImlzSHlkcmF0ZSIsImlzU1ZHIiwiX192dWVfYXBwX18iLCJnZXRFeHBvc2VQcm94eSIsInVubW91bnQiLCJyYXdSZWYiLCJvbGRSYXdSZWYiLCJwYXJlbnRTdXNwZW5zZSIsImlzVW5tb3VudCIsInNldFJlZiIsInJlZlZhbHVlIiwib3duZXIiLCJvbGRSZWYiLCJyZWZzIiwiX2lzU3RyaW5nIiwiX2lzUmVmIiwiZG9TZXQiLCJmIiwiZXhpc3RpbmciLCJrIiwicGVuZGluZ0JyYW5jaCIsImNyZWF0ZUh5ZHJhdGlvbkZucyIsImdsb2JhbFRoaXMiLCJzZWxmIiwid2luZG93IiwiZ2xvYmFsIiwiX19WVUVfXyIsImluc2VydCIsImhvc3RJbnNlcnQiLCJob3N0UmVtb3ZlIiwicGF0Y2hQcm9wIiwiaG9zdFBhdGNoUHJvcCIsImNyZWF0ZUVsZW1lbnQiLCJob3N0Q3JlYXRlRWxlbWVudCIsImNyZWF0ZVRleHQiLCJob3N0Q3JlYXRlVGV4dCIsImNyZWF0ZUNvbW1lbnQiLCJob3N0Q3JlYXRlQ29tbWVudCIsInNldFRleHQiLCJob3N0U2V0VGV4dCIsInNldEVsZW1lbnRUZXh0IiwiaG9zdFNldEVsZW1lbnRUZXh0IiwicGFyZW50Tm9kZSIsImhvc3RQYXJlbnROb2RlIiwibmV4dFNpYmxpbmciLCJob3N0TmV4dFNpYmxpbmciLCJzZXRTY29wZUlkIiwiaG9zdFNldFNjb3BlSWQiLCJjbG9uZU5vZGUiLCJob3N0Q2xvbmVOb2RlIiwiaW5zZXJ0U3RhdGljQ29udGVudCIsImhvc3RJbnNlcnRTdGF0aWNDb250ZW50IiwicGF0Y2giLCJuMSIsIm4yIiwiY29udGFpbmVyIiwiYW5jaG9yIiwicGFyZW50Q29tcG9uZW50Iiwic2xvdFNjb3BlSWRzIiwib3B0aW1pemVkIiwiZHluYW1pY0NoaWxkcmVuIiwiaXNTYW1lVk5vZGVUeXBlIiwiZ2V0TmV4dEhvc3ROb2RlIiwicGF0Y2hGbGFnIiwiVGV4dCIsIlN0YXRpYyIsIkZyYWdtZW50IiwicHJvY2VzcyIsImludGVybmFscyIsInByb2Nlc3NUZXh0IiwiY2hpbGRyZW4iLCJwcm9jZXNzQ29tbWVudE5vZGUiLCJtb3VudFN0YXRpY05vZGUiLCJtb3ZlU3RhdGljTm9kZSIsInJlbW92ZVN0YXRpY05vZGUiLCJwcm9jZXNzRWxlbWVudCIsIm1vdW50RWxlbWVudCIsInZub2RlSG9vayIsInVubW91bnRDaGlsZHJlbiIsIm9uVm5vZGVCZWZvcmVNb3VudCIsInNjb3BlSWQiLCJuZWVkQ2FsbFRyYW5zaXRpb25Ib29rcyIsInBlcnNpc3RlZCIsImJlZm9yZUVudGVyIiwib25Wbm9kZU1vdW50ZWQiLCJpbnZva2VWTm9kZUhvb2siLCJlbnRlciIsImludm9rZURpcmVjdGl2ZUhvb2siLCJzdWJUcmVlIiwicGFyZW50Vk5vZGUiLCJtb3VudENoaWxkcmVuIiwiY2hpbGQiLCJjbG9uZUlmTW91bnRlZCIsInBhdGNoRWxlbWVudCIsIm9sZFByb3BzIiwibmV3UHJvcHMiLCJ0b2dnbGVSZWN1cnNlIiwib25Wbm9kZUJlZm9yZVVwZGF0ZSIsImFyZUNoaWxkcmVuU1ZHIiwiY2xhc3MiLCJzdHlsZSIsInByb3BzVG9VcGRhdGUiLCJkeW5hbWljUHJvcHMiLCJvblZub2RlVXBkYXRlZCIsInBhdGNoQmxvY2tDaGlsZHJlbiIsIm9sZENoaWxkcmVuIiwibmV3Q2hpbGRyZW4iLCJmYWxsYmFja0NvbnRhaW5lciIsIm9sZFZOb2RlIiwibmV3Vk5vZGUiLCJwYXRjaFByb3BzIiwicHJvY2Vzc0ZyYWdtZW50IiwiZnJhZ21lbnRTdGFydEFuY2hvciIsImZyYWdtZW50RW5kQW5jaG9yIiwiZnJhZ21lbnRTbG90U2NvcGVJZHMiLCJwcm9jZXNzQ29tcG9uZW50IiwiYWN0aXZhdGUiLCJtb3VudENvbXBvbmVudCIsImluaXRpYWxWTm9kZSIsImVtcHR5QXBwQ29udGV4dCIsInVpZCQxIiwicm9vdCIsInVwZGF0ZSIsIkVmZmVjdFNjb3BlIiwiZXhwb3NlUHJveHkiLCJhY2Nlc3NDYWNoZSIsInNldHVwQ29udGV4dCIsInN1c3BlbnNlSWQiLCJwZW5kaW5nSWQiLCJhc3luY0RlcCIsImFzeW5jUmVzb2x2ZWQiLCJiYyIsImJtIiwiYnUiLCJ1IiwidW0iLCJidW0iLCJkYSIsInJ0ZyIsInJ0YyIsInNwIiwiZW1pdCQxIiwiY2UiLCJjcmVhdGVDb21wb25lbnRJbnN0YW5jZSIsInJlbmRlcmVyIiwiaXNTdGF0ZWZ1bENvbXBvbmVudCIsInNldHVwUmVzdWx0IiwibWFya1JhdyIsIlB1YmxpY0luc3RhbmNlUHJveHlIYW5kbGVycyIsInNldHVwIiwiY3JlYXRlQXR0cnNQcm94eSIsImNyZWF0ZVNldHVwQ29udGV4dCIsInVuc2V0Q3VycmVudEluc3RhbmNlIiwicmVzb2x2ZWRSZXN1bHQiLCJlIiwic2V0dXBTdGF0ZWZ1bENvbXBvbmVudCIsInJlZ2lzdGVyRGVwIiwic2V0dXBSZW5kZXJFZmZlY3QiLCJwbGFjZWhvbGRlciIsInVwZGF0ZUNvbXBvbmVudCIsIm5leHRWTm9kZSIsInByZXZDaGlsZHJlbiIsIm5leHRDaGlsZHJlbiIsIiRzdGFibGUiLCJoYXNQcm9wc0NoYW5nZWQiLCJzaG91bGRVcGRhdGVDb21wb25lbnQiLCJjb21wb25lbnRVcGRhdGVGbiIsIm9yaWdpbk5leHQiLCJuZXh0VHJlZSIsInJlbmRlckNvbXBvbmVudFJvb3QiLCJwcmV2VHJlZSIsImlzQXN5bmNXcmFwcGVyVk5vZGUiLCJoeWRyYXRlTm9kZSIsImh5ZHJhdGVTdWJUcmVlIiwic2NvcGVkSW5pdGlhbFZOb2RlIiwicXVldWVKb2IiLCJ1cGRhdGVDb21wb25lbnRQcmVSZW5kZXIiLCJyYXdQcmV2UHJvcHMiLCJrZWJhYktleSIsInNldEZ1bGxQcm9wcyIsImNhbWVsaXplZEtleSIsIm5lZWREZWxldGlvbkNoZWNrIiwiZGVsZXRpb25Db21wYXJpc29uVGFyZ2V0IiwicGF0Y2hDaGlsZHJlbiIsImMxIiwicHJldlNoYXBlRmxhZyIsImMyIiwicGF0Y2hVbmtleWVkQ2hpbGRyZW4iLCJvbGRMZW5ndGgiLCJuZXdMZW5ndGgiLCJjb21tb25MZW5ndGgiLCJNYXRoIiwibWluIiwibmV4dENoaWxkIiwicGF0Y2hLZXllZENoaWxkcmVuIiwicGFyZW50QW5jaG9yIiwibDIiLCJlMSIsImUyIiwibmV4dFBvcyIsInMxIiwiczIiLCJrZXlUb05ld0luZGV4TWFwIiwiaiIsInBhdGNoZWQiLCJ0b0JlUGF0Y2hlZCIsIm1vdmVkIiwibWF4TmV3SW5kZXhTb0ZhciIsIm5ld0luZGV4VG9PbGRJbmRleE1hcCIsInByZXZDaGlsZCIsIm5ld0luZGV4IiwiaW5jcmVhc2luZ05ld0luZGV4U2VxdWVuY2UiLCJsZW4iLCJhcnJJIiwiZ2V0U2VxdWVuY2UiLCJuZXh0SW5kZXgiLCJtb3ZlIiwibW92ZVR5cGUiLCJsZWF2ZSIsImRlbGF5TGVhdmUiLCJhZnRlckxlYXZlIiwicmVtb3ZlMyIsInBlcmZvcm1MZWF2ZSIsImRvUmVtb3ZlIiwiZGVhY3RpdmF0ZSIsInNob3VsZEludm9rZURpcnMiLCJzaG91bGRJbnZva2VWbm9kZUhvb2siLCJvblZub2RlQmVmb3JlVW5tb3VudCIsIm9uVm5vZGVVbm1vdW50ZWQiLCJyZW1vdmUyIiwicGVyZm9ybVJlbW92ZSIsInJlbW92ZUZyYWdtZW50IiwidW5tb3VudENvbXBvbmVudCIsIl92bm9kZSIsInAiLCJtdCIsIm1jIiwicGMiLCJwYmMiLCJvIiwiY3JlYXRlQXBwIiwiY3JlYXRlQXBwQVBJIiwiYmFzZUNyZWF0ZVJlbmRlcmVyIiwiYWxsb3dlZCIsImNoMSIsImNoMiIsIm1heWJlU2VsZlJlZmVyZW5jZSIsIndhcm5NaXNzaW5nIiwic2VsZk5hbWUiLCJkaXNwbGF5TmFtZSIsImdldENvbXBvbmVudE5hbWUiLCJyZXNvbHZlQXNzZXQiLCJOVUxMX0RZTkFNSUNfQ09NUE9ORU5UIiwicmVnaXN0cnkiLCJibG9ja1N0YWNrIiwiY3VycmVudEJsb2NrIiwiZGlzYWJsZVRyYWNraW5nIiwiaXNCbG9ja1RyZWVFbmFibGVkIiwic2V0dXBCbG9jayIsImNyZWF0ZUJhc2VWTm9kZSIsIl9fdl9pc1ZOb2RlIiwibm9ybWFsaXplS2V5Iiwibm9ybWFsaXplUmVmIiwicmVmX2tleSIsInJlZl9mb3IiLCJpc0Jsb2NrTm9kZSIsIm5lZWRGdWxsQ2hpbGRyZW5Ob3JtYWxpemF0aW9uIiwiX192X3NraXAiLCJzc0NvbnRlbnQiLCJzc0ZhbGxiYWNrIiwidGFyZ2V0QW5jaG9yIiwic3RhdGljQ291bnQiLCJub3JtYWxpemUiLCJpc1ZOb2RlIiwiY2xvbmVkIiwiX192Y2NPcHRzIiwiaXNQcm94eSIsImd1YXJkUmVhY3RpdmVQcm9wcyIsImtsYXNzIiwiX19pc1N1c3BlbnNlIiwiaXNTdXNwZW5zZSIsIl9faXNUZWxlcG9ydCIsImlzVGVsZXBvcnQiLCJleHRyYVByb3BzIiwibWVyZ2VSZWYiLCJtZXJnZWRQcm9wcyIsInRvTWVyZ2UiLCJpbmNvbWluZyIsIm1lcmdlUHJvcHMiLCJ0ZXh0IiwiZmxhZyIsImFzQmxvY2siLCJjcmVhdGVCbG9jayIsIm1lbW8iLCJzbG90Iiwic2xvdEZsYWciLCJjcmVhdGVUZXh0Vk5vZGUiLCJyZW5kZXJJdGVtIiwiZmFsbGJhY2siLCJub1Nsb3R0ZWQiLCJpc0NFIiwidmFsaWRTbG90Q29udGVudCIsImVuc3VyZVZhbGlkVk5vZGUiLCJyZW5kZXJlZCIsInZub2RlcyIsImdldFB1YmxpY0luc3RhbmNlIiwicHVibGljUHJvcGVydGllc01hcCIsIiQiLCIkZWwiLCIkZGF0YSIsIiRwcm9wcyIsIiRhdHRycyIsIiRzbG90cyIsIiRyZWZzIiwiJHBhcmVudCIsIiRyb290IiwiJGVtaXQiLCIkb3B0aW9ucyIsIiRmb3JjZVVwZGF0ZSIsIiRuZXh0VGljayIsIm5leHRUaWNrIiwiJHdhdGNoIiwiaW5zdGFuY2VXYXRjaCIsIm5vcm1hbGl6ZWRQcm9wcyIsInB1YmxpY0dldHRlciIsImNzc01vZHVsZSIsIl9fY3NzTW9kdWxlcyIsImRlc2NyaXB0b3IiLCJzZXRDdXJyZW50SW5zdGFuY2UiLCJfX3NzcklubGluZVJlbmRlciIsInNzclJlbmRlciIsInByb3h5UmVmcyIsInNraXBPcHRpb25zIiwiZ2V0dGVyT3JPcHRpb25zIiwiZGVidWdPcHRpb25zIiwic2V0dGVyIiwib25seUdldHRlciIsIkNvbXB1dGVkUmVmSW1wbCIsImNvbXB1dGVkJDEiLCJkb2MiLCJkb2N1bWVudCIsInRlbXBsYXRlQ29udGFpbmVyIiwibm9kZU9wcyIsImluc2VydEJlZm9yZSIsInJlbW92ZUNoaWxkIiwidGFnIiwiY3JlYXRlRWxlbWVudE5TIiwibXVsdGlwbGUiLCJzZXRBdHRyaWJ1dGUiLCJjcmVhdGVUZXh0Tm9kZSIsIm5vZGUiLCJub2RlVmFsdWUiLCJ0ZXh0Q29udGVudCIsInF1ZXJ5U2VsZWN0b3IiLCJzZWxlY3RvcjIiLCJjb250ZW50IiwiYmVmb3JlIiwicHJldmlvdXNTaWJsaW5nIiwibGFzdENoaWxkIiwiaW5uZXJIVE1MIiwidGVtcGxhdGUiLCJ3cmFwcGVyIiwiZmlyc3RDaGlsZCIsImFwcGVuZENoaWxkIiwiaW1wb3J0YW50UkUiLCJzZXRTdHlsZSIsInNldFByb3BlcnR5IiwicHJlZml4ZWQiLCJyYXdOYW1lIiwicHJlZml4Q2FjaGUiLCJwcmVmaXhlcyIsImF1dG9QcmVmaXgiLCJ4bGlua05TIiwiX2dldE5vdyIsIkRhdGUiLCJub3ciLCJza2lwVGltZXN0YW1wQ2hlY2siLCJjcmVhdGVFdmVudCIsInRpbWVTdGFtcCIsImZmTWF0Y2giLCJuYXZpZ2F0b3IiLCJ1c2VyQWdlbnQiLCJjYWNoZWROb3ciLCJyZXNldCIsInByZXZWYWx1ZSIsIm5leHRWYWx1ZSIsImludm9rZXJzIiwiX3ZlaSIsImV4aXN0aW5nSW52b2tlciIsIm9wdGlvbnNNb2RpZmllclJFIiwicGFyc2VOYW1lIiwiYWRkRXZlbnRMaXN0ZW5lciIsImluaXRpYWxWYWx1ZSIsImludm9rZXIiLCJhdHRhY2hlZCIsIm9yaWdpbmFsU3RvcCIsInN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbiIsIl9zdG9wcGVkIiwicGF0Y2hTdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24iLCJnZXROb3ciLCJjcmVhdGVJbnZva2VyIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIm5hdGl2ZU9uUkUiLCJyZW5kZXJlck9wdGlvbnMiLCJ0cmFuc2l0aW9uQ2xhc3NlcyIsIl92dGMiLCJqb2luIiwicmVtb3ZlQXR0cmlidXRlIiwiY2xhc3NOYW1lIiwiaXNDc3NTdHJpbmciLCJjdXJyZW50RGlzcGxheSIsImRpc3BsYXkiLCJ0YWdOYW1lIiwic2hvdWxkU2V0QXNQcm9wIiwiaW5jbHVkZUJvb2xlYW5BdHRyIiwiX2EiLCJfdHJ1ZVZhbHVlIiwiX2ZhbHNlVmFsdWUiLCJyZW1vdmVBdHRyaWJ1dGVOUyIsInNldEF0dHJpYnV0ZU5TIiwiaXNCb29sZWFuIiwiY3JlYXRlUmVuZGVyZXIiLCJjb250YWluZXJPclNlbGVjdG9yIiwibm9ybWFsaXplQ29udGFpbmVyIiwiU1ZHRWxlbWVudCIsIkVsZW1lbnQiLCJjb25zb2xlIiwiYXNzZXJ0IiwiY29uZGl0aW9uIiwibXNnIiwibG9nIiwiRXJyb3IiLCJzeW1ib2xzIiwicGFyZW50SUQiLCJwb3ciLCJmbG9vciIsInJhbmRvbSIsInJhbmRvbUlEIiwic2VsZWN0aW9uMiIsImdldFNlbGVjdGlvbiIsIlNlbGVjdGlvbiIsImlzQ29sbGFwc2VkIiwiYW5jaG9yTm9kZSIsIm9mZnNldCIsImFuY2hvck9mZnNldCIsInN0YXJ0IiwiYmFja3dhcmRzIiwiY29sbGFwc2VkIiwic2VsZWN0aW9uIiwiZm9jdXNOb2RlIiwiZm9jdXNPZmZzZXQiLCJwYXJlbnROb2RlcyIsImJvZHkiLCJjaGlsZE5vZGUiLCJjaGlsZE5vZGVzIiwiaXNET01TZWxlY3Rpb25CYWNrd2FyZHMiLCJyZXNvbHZlQXR0cnMiLCJub2RlVHlwZSIsIk5vZGUiLCJURVhUX05PREUiLCJFTEVNRU5UX05PREUiLCJub2RlTmFtZSIsImF0dHIiLCJhdHRyaWJ1dGVzIiwicG9pbnRlciIsImNvbnRhaW5lck5vZGUiLCJwYXJhZ3JhcGhJRCIsInNwYW5JRCIsInN0YXJ0Tm9kZSIsInRleHROb2RlIiwiZGF0YVBvaW50ZXJET01Ob2RlIiwiZW5kTm9kZSIsImVtcHR5IiwicmFuZ2UiLCJSYW5nZSIsInNldFN0YXJ0Iiwic2V0RW5kIiwiY29sbGFwc2UiLCJhZGRSYW5nZSIsInBhcmFncmFwaCIsInNwYW5zIiwibmV3SUQiLCJmb3JtYXQiLCJuZXdTcGFuIiwic3BhbiIsIm5ld2lkIiwic3BsaXRUaW1lIiwibGVmdCIsInN1YnN0ciIsInJpZ2h0IiwidG90YWwiLCJkdXJhdGlvbiIsInRpbWUiLCJncm91cCIsIm5vcm1JbmRleCIsInBhcmFncmFwaHMiLCJwYXJhZ3JhcGhJbmRleCIsInBhcmFncmFwaDIiLCJzcGFuSW5kZXgiLCJwYXJhZ3JhcGhTcGFucyIsInNwYW4yIiwic3BhbkF0dHJzIiwicGFyYWdyYXBoQXR0cnMiLCJzcGFuTm9kZSIsInBhcmFncmFwaE5vZGUiLCJpbnB1dE5vZGUiLCJnZXRET01FbGVtZW50RGF0YUF0dHJpYnV0ZXMiLCJub2RlMiIsImRhdGFET01Ob2Rlc0F0Tm9kZSIsImlkVG9JbmRleCIsImxlZnRTcGFuSUQiLCJsZWZ0UGFyYWdyYXBoSUQiLCJ0ZXh0Q29uZW50IiwiZGF0YVBvaW50ZXJGcm9tRE9NUG9pbnRlciIsImRhdGFBdEluZGV4IiwiZGF0YVBvaW50ZXIiLCJTcGxpY2VNb2RlIiwiZnJlZXplIiwiUmVtb3ZlIiwiSW5QbGFjZSIsIkNvcHkiLCJzdGFydEluZGV4Iiwic3RhcnRPZmZzZXQiLCJlbmRJbmRleCIsImVuZE9mZnNldCIsIm1vZGUiLCJlbmRTcGFuTGVuZ3RoIiwicmVtb3ZlZFNwYW5UZXh0Iiwic3Vic3RyaW5nIiwicmVtb3ZlZFNwYW5zIiwiY29weVNwYW4iLCJzcGxpdEluZGV4Iiwic3BsaXRPZmZzZXQiLCJzcGxpdFNwYW4iLCJsZWZ0MiIsInJpZ2h0MiIsIm1pZDIiLCJtaWRyaWdodCIsIm1pZCIsImNvcGllZFNwYW5zIiwic3BsaWNlU3RhcnQiLCJzcGxpY2VFbmQiLCJzbGljZWRTcGFucyIsInJlbW92ZWQiLCJzdGFydFBhcmFncmFwaCIsInNwbGljZVNwYW5zIiwicGFydGlhbCIsImxhc3QiLCJuZXdEYXRhIiwibmV3UGFyYWdyYXBocyIsImxhc3RQYXJhZ3JhcGgyIiwibmV3U3BhbnMyIiwiaW5zZXJ0ZWRTdGFydDIiLCJpbnNlcnRlZEVuZDIiLCJsYXN0UGFyYWdyYXBoIiwibmV3UGFyYWdyYXBoIiwiaW5zZXJ0ZWRTdGFydCIsImluc2VydGVkRW5kIiwicmlnaHRTcGFucyIsInNvdXJjZVNwYW5zIiwic291cmNlU3BhbiIsImZvdW5kIiwic3RhcnRJRCIsImVuZElEIiwic3RhcnRlZCIsIm1vZGVsVmFsdWUiLCJlZGl0YWJsZSIsInNob3dDb25maWRlbmNlIiwiZGQiLCJmdW5jIiwid2FpdCIsInRpbWVvdXQyIiwiZGVib3VuY2VkIiwiY2FsbE5vdyIsInNldFRpbWVvdXQiLCJhcHBseVZpZXdDaGFuZ2VzTm93IiwiYXBwbHlWaWV3Q2hhbmdlcyIsImRlYnVnIiwic2F2ZSIsImRvd25sb2FkIiwiZmlsZW5hbWUiLCJlbGVtZW50IiwiZW5jb2RlVVJJQ29tcG9uZW50IiwiY2xpY2siLCJhc0hUTUwiLCJzZW50ZW5jZSIsImJvbGQiLCJpdGFsaWMiLCJ1bmRlcmxpbmUiLCJzdWJzY3JpcHQiLCJzdXBlcnNjcmlwdCIsImJ1bGxldCIsImV4cG9ydFdvcmQiLCJodG1sIiwic3BhblNlbGVjdGVkIiwic2VsZWN0U3RhcnQiLCJzZWxlY3RFbmQiLCJub3JtYWxpemVkRE9NU2VsZWN0aW9uIiwic3RhcnQzIiwiZW5kMiIsImdldFNwYW5TZWxlY3Rpb24iLCJwYXJhZ3JhcGhTcGFuSXRlcmF0b3IiLCJkYXRhSXRlcmF0b3IiLCJ0b2dnbGVTdHlsZVgiLCJub2ZvY3VzIiwib2Zmc2V0TGVmdCIsImxlZnRTcGFuSW5kZXgiLCJvZmZzZXRSaWdodCIsInJpZ2h0U3BhbkluZGV4IiwicmlnaHRTcGFuSUQiLCJ0b2dnbGVTdHlsZSIsImZvY3VzIiwiZGF0YVNwbGljZSIsIm5hbWUyIiwidmFsdWUyIiwidG9nZ2xlQnVsbGV0Iiwic3BhblNlbGVjdGlvbiIsIm1hcENvbnRhaW5lck9mZnNldFBvaW50ZXJUb0RhdGEiLCJwYXJzZURPTSIsInJlc3RvcmVTZWxlY3Rpb24iLCJwYXJzZWQiLCJyb290Tm9kZSIsImF0dHJWYWx1ZSIsInRyYW5zZm9ybSIsImxhc3RQbGFpbnRleHRQYXJhIiwicHJlcGVuZFRleHQiLCJpZDMiLCJpbm5lclRleHQiLCJjb25maWRlbmNlIiwic291cmNlUGFyYWdyYXBocyIsInNvdXJjZVBhcmFncmFwaCIsImRhdGFNZXJnZVBhcmFncmFwaHMiLCJvbklucHV0Iiwidm0iLCJpbmZvIiwibWV0YUtleSIsImN0cmxLZXkiLCJzaGlmdEtleSIsImFsdEtleSIsImNvZGUiLCJzdG9wUHJvcGFnYXRpb24iLCJwcmV2ZW50RGVmYXVsdCIsImRhdGFQb2ludGVyTmV4dCIsInNlbGVjdGlvbjMiLCJzdGFydE9mUGFyYWdyYXBoIiwiZGF0YTIiLCJwcCIsImRhdGFQb2ludGVyUHJldiIsInN0YXJ0UGFyYWdyYXBoU3BhbnMiLCJlbmRPZlBhcmFncmFwaCIsInNlbGVjdGVkU3BhbnMiLCJoaWdobGlnaHRlZCIsIm9uRHJhZ1N0YXJ0Iiwib25QYXN0ZSIsIm5hdGl2ZURhdGEiLCJjbGlwYm9hcmREYXRhIiwiZ2V0RGF0YSIsImh0bWxEYXRhIiwidGV4dERhdGEiLCJwYXJzZSIsImRhdGFJbnNlcnQiLCJpbXBsZW1lbnRhdGlvbiIsImNyZWF0ZUhUTUxEb2N1bWVudCIsImNzc1J1bGVzIiwidW5kZXJsaW5lQ2xhc3NlcyIsInJ1bGUiLCJzZWxlY3RvclRleHQiLCJzZWFyY2giLCJ0ZXh0RGVjb3JhdGlvbkxpbmUiLCJzZWxlY3RvcnMiLCJwYXJ0cyIsInNoaWZ0Iiwic3RhY2siLCJmbXQiLCJub2RlRm10IiwiY2xzIiwiY2xhc3NMaXN0IiwicGFyc2VWYW5pbGxhRE9NIiwic2hlZXQiLCJsaW5lcyIsImxpbmUiLCJvbkN1dCIsIm9uQ29weSIsInNldERhdGEiLCJjb250ZW50ZWRpdGFibGUiLCJzcGVsbGNoZWNrIiwiX2NhY2hlIiwib25LZXlkb3duIiwib25TZWxlY3RzdGFydCIsIm9uTW91c2V1cCIsIm9uRHJhZ3N0YXJ0IiwiX2NyZWF0ZUVsZW1lbnRCbG9jayIsIm9uQ2xpY2siLCJfbm9ybWFsaXplU3R5bGUiLCJub29wIiwiRGlzcGF0Y2giLCJ0eXBlbmFtZXMiLCJ0eXBlcyIsImRpc3BhdGNoIiwidHlwZW5hbWUiLCJUIiwicGFyc2VUeXBlbmFtZXMiLCJjb3B5IiwidGhhdCIsInhodG1sIiwic3ZnIiwieGxpbmsiLCJ4bWwiLCJ4bWxucyIsInByZWZpeCIsIm5hbWVzcGFjZXMiLCJzcGFjZSIsImxvY2FsIiwiZG9jdW1lbnQyIiwib3duZXJEb2N1bWVudCIsInVyaSIsIm5hbWVzcGFjZVVSSSIsImRvY3VtZW50RWxlbWVudCIsImZ1bGxuYW1lIiwibmFtZXNwYWNlIiwiY3JlYXRvckZpeGVkIiwiY3JlYXRvckluaGVyaXQiLCJub25lIiwieCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJtYXRjaGVzIiwiZmluZCIsImZpcnN0RWxlbWVudENoaWxkIiwiZGF0dW0yIiwiX25leHQiLCJfcGFyZW50IiwiX19kYXRhX18iLCJleGl0IiwiZ3JvdXBMZW5ndGgiLCJkYXRhTGVuZ3RoIiwiRW50ZXJOb2RlIiwia2V5VmFsdWUiLCJub2RlQnlLZXlWYWx1ZSIsImtleVZhbHVlcyIsIk5hTiIsImRlZmF1bHRWaWV3IiwicmVtb3ZlUHJvcGVydHkiLCJwcmlvcml0eSIsImdldFByb3BlcnR5VmFsdWUiLCJnZXRDb21wdXRlZFN0eWxlIiwic3RyaW5nIiwiQ2xhc3NMaXN0IiwiX25vZGUiLCJfbmFtZXMiLCJjbGFzc0FycmF5IiwiZ2V0QXR0cmlidXRlIiwibmFtZXMiLCJjbGFzc2VkQWRkIiwiY2xhc3NlZFJlbW92ZSIsImNsb25lIiwiX19vbiIsImxpc3RlbmVyIiwiY29udGV4dExpc3RlbmVyIiwicGFyYW1zIiwid2luZG93MiIsIkN1c3RvbUV2ZW50IiwiaW5pdEV2ZW50IiwiYnViYmxlcyIsImNhbmNlbGFibGUiLCJkZXRhaWwiLCJkaXNwYXRjaEV2ZW50IiwiY29udGFpbnMiLCJncm91cHMiLCJwYXJlbnRzIiwiX2dyb3VwcyIsIl9wYXJlbnRzIiwiZmFjdG9yeSIsImRlZmluaXRpb24iLCJzZWxlY3QiLCJzZWxlY3QyIiwic2VsZWN0b3IiLCJzdWJncm91cHMiLCJzdWJub2RlIiwic3ViZ3JvdXAiLCJzZWxlY3RBbGwiLCJhcnJheSIsImFycmF5QWxsIiwic2VsZWN0b3JBbGwiLCJzZWxlY3RDaGlsZCIsImNoaWxkRmlyc3QiLCJjaGlsZEZpbmQiLCJjaGlsZE1hdGNoZXIiLCJzZWxlY3RDaGlsZHJlbiIsImNoaWxkcmVuRmlsdGVyIiwibWF0Y2hlciIsImRhdHVtIiwiYmluZEtleSIsImJpbmRJbmRleCIsImNvbnN0YW50IiwiYXJyYXlsaWtlIiwiZW50ZXJHcm91cCIsInVwZGF0ZUdyb3VwIiwiZXhpdEdyb3VwIiwicHJldmlvdXMiLCJpMCIsImkxIiwiX2VudGVyIiwiX2V4aXQiLCJzcGFyc2UiLCJvbmVudGVyIiwib251cGRhdGUiLCJvbmV4aXQiLCJhcHBlbmQiLCJtZXJnZSIsIm9yZGVyIiwiZ3JvdXBzMCIsImdyb3VwczEiLCJtMCIsIm0xIiwibWVyZ2VzIiwiZ3JvdXAwIiwiZ3JvdXAxIiwiY29tcGFyZURvY3VtZW50UG9zaXRpb24iLCJjb21wYXJlIiwiYXNjZW5kaW5nIiwic29ydGdyb3VwcyIsInNvcnRncm91cCIsImNvbXBhcmVOb2RlIiwibm9kZXMiLCJzaXplMiIsImVhY2giLCJnZXRBdHRyaWJ1dGVOUyIsImF0dHJSZW1vdmVOUyIsImF0dHJSZW1vdmUiLCJhdHRyRnVuY3Rpb25OUyIsImF0dHJGdW5jdGlvbiIsImF0dHJDb25zdGFudE5TIiwiYXR0ckNvbnN0YW50Iiwic3R5bGVSZW1vdmUiLCJzdHlsZUZ1bmN0aW9uIiwic3R5bGVDb25zdGFudCIsInN0eWxlVmFsdWUiLCJwcm9wZXJ0eSIsInByb3BlcnR5UmVtb3ZlIiwicHJvcGVydHlGdW5jdGlvbiIsInByb3BlcnR5Q29uc3RhbnQiLCJjbGFzc2VkIiwiY2xhc3NlZEZ1bmN0aW9uIiwiY2xhc3NlZFRydWUiLCJjbGFzc2VkRmFsc2UiLCJ0ZXh0UmVtb3ZlIiwidGV4dEZ1bmN0aW9uIiwidGV4dENvbnN0YW50IiwiaHRtbFJlbW92ZSIsImh0bWxGdW5jdGlvbiIsImh0bWxDb25zdGFudCIsInJhaXNlIiwibG93ZXIiLCJjcmVhdGUyIiwiY3JlYXRvciIsImNvbnN0YW50TnVsbCIsInNlbGVjdGlvbl9jbG9uZURlZXAiLCJzZWxlY3Rpb25fY2xvbmVTaGFsbG93Iiwib25BZGQiLCJvblJlbW92ZSIsImRpc3BhdGNoRnVuY3Rpb24iLCJkaXNwYXRjaENvbnN0YW50IiwiYnJpZ2h0ZXIiLCJyZUkiLCJyZU4iLCJyZVAiLCJyZUhleCIsInJlUmdiSW50ZWdlciIsIlJlZ0V4cCIsInJlUmdiUGVyY2VudCIsInJlUmdiYUludGVnZXIiLCJyZVJnYmFQZXJjZW50IiwicmVIc2xQZXJjZW50IiwicmVIc2xhUGVyY2VudCIsIm5hbWVkIiwiYWxpY2VibHVlIiwiYW50aXF1ZXdoaXRlIiwiYXF1YSIsImFxdWFtYXJpbmUiLCJhenVyZSIsImJlaWdlIiwiYmlzcXVlIiwiYmxhY2siLCJibGFuY2hlZGFsbW9uZCIsImJsdWUiLCJibHVldmlvbGV0IiwiYnJvd24iLCJidXJseXdvb2QiLCJjYWRldGJsdWUiLCJjaGFydHJldXNlIiwiY2hvY29sYXRlIiwiY29yYWwiLCJjb3JuZmxvd2VyYmx1ZSIsImNvcm5zaWxrIiwiY3JpbXNvbiIsImN5YW4iLCJkYXJrYmx1ZSIsImRhcmtjeWFuIiwiZGFya2dvbGRlbnJvZCIsImRhcmtncmF5IiwiZGFya2dyZWVuIiwiZGFya2dyZXkiLCJkYXJra2hha2kiLCJkYXJrbWFnZW50YSIsImRhcmtvbGl2ZWdyZWVuIiwiZGFya29yYW5nZSIsImRhcmtvcmNoaWQiLCJkYXJrcmVkIiwiZGFya3NhbG1vbiIsImRhcmtzZWFncmVlbiIsImRhcmtzbGF0ZWJsdWUiLCJkYXJrc2xhdGVncmF5IiwiZGFya3NsYXRlZ3JleSIsImRhcmt0dXJxdW9pc2UiLCJkYXJrdmlvbGV0IiwiZGVlcHBpbmsiLCJkZWVwc2t5Ymx1ZSIsImRpbWdyYXkiLCJkaW1ncmV5IiwiZG9kZ2VyYmx1ZSIsImZpcmVicmljayIsImZsb3JhbHdoaXRlIiwiZm9yZXN0Z3JlZW4iLCJmdWNoc2lhIiwiZ2FpbnNib3JvIiwiZ2hvc3R3aGl0ZSIsImdvbGQiLCJnb2xkZW5yb2QiLCJncmF5IiwiZ3JlZW4iLCJncmVlbnllbGxvdyIsImdyZXkiLCJob25leWRldyIsImhvdHBpbmsiLCJpbmRpYW5yZWQiLCJpbmRpZ28iLCJpdm9yeSIsImtoYWtpIiwibGF2ZW5kZXIiLCJsYXZlbmRlcmJsdXNoIiwibGF3bmdyZWVuIiwibGVtb25jaGlmZm9uIiwibGlnaHRibHVlIiwibGlnaHRjb3JhbCIsImxpZ2h0Y3lhbiIsImxpZ2h0Z29sZGVucm9keWVsbG93IiwibGlnaHRncmF5IiwibGlnaHRncmVlbiIsImxpZ2h0Z3JleSIsImxpZ2h0cGluayIsImxpZ2h0c2FsbW9uIiwibGlnaHRzZWFncmVlbiIsImxpZ2h0c2t5Ymx1ZSIsImxpZ2h0c2xhdGVncmF5IiwibGlnaHRzbGF0ZWdyZXkiLCJsaWdodHN0ZWVsYmx1ZSIsImxpZ2h0eWVsbG93IiwibGltZSIsImxpbWVncmVlbiIsImxpbmVuIiwibWFnZW50YSIsIm1hcm9vbiIsIm1lZGl1bWFxdWFtYXJpbmUiLCJtZWRpdW1ibHVlIiwibWVkaXVtb3JjaGlkIiwibWVkaXVtcHVycGxlIiwibWVkaXVtc2VhZ3JlZW4iLCJtZWRpdW1zbGF0ZWJsdWUiLCJtZWRpdW1zcHJpbmdncmVlbiIsIm1lZGl1bXR1cnF1b2lzZSIsIm1lZGl1bXZpb2xldHJlZCIsIm1pZG5pZ2h0Ymx1ZSIsIm1pbnRjcmVhbSIsIm1pc3R5cm9zZSIsIm1vY2Nhc2luIiwibmF2YWpvd2hpdGUiLCJuYXZ5Iiwib2xkbGFjZSIsIm9saXZlIiwib2xpdmVkcmFiIiwib3JhbmdlIiwib3JhbmdlcmVkIiwib3JjaGlkIiwicGFsZWdvbGRlbnJvZCIsInBhbGVncmVlbiIsInBhbGV0dXJxdW9pc2UiLCJwYWxldmlvbGV0cmVkIiwicGFwYXlhd2hpcCIsInBlYWNocHVmZiIsInBlcnUiLCJwaW5rIiwicGx1bSIsInBvd2RlcmJsdWUiLCJwdXJwbGUiLCJyZWJlY2NhcHVycGxlIiwicmVkIiwicm9zeWJyb3duIiwicm95YWxibHVlIiwic2FkZGxlYnJvd24iLCJzYWxtb24iLCJzYW5keWJyb3duIiwic2VhZ3JlZW4iLCJzZWFzaGVsbCIsInNpZW5uYSIsInNpbHZlciIsInNreWJsdWUiLCJzbGF0ZWJsdWUiLCJzbGF0ZWdyYXkiLCJzbGF0ZWdyZXkiLCJzbm93Iiwic3ByaW5nZ3JlZW4iLCJzdGVlbGJsdWUiLCJ0YW4iLCJ0ZWFsIiwidGhpc3RsZSIsInRvbWF0byIsInR1cnF1b2lzZSIsInZpb2xldCIsIndoZWF0Iiwid2hpdGUiLCJ3aGl0ZXNtb2tlIiwieWVsbG93IiwieWVsbG93Z3JlZW4iLCJyZ2IiLCJmb3JtYXRIZXgiLCJmb3JtYXRSZ2IiLCJleGVjIiwicmdibiIsIlJnYiIsInJnYmEiLCJoc2xhIiwiZyIsIkNvbG9yIiwiY29sb3IiLCJvcGFjaXR5IiwicmdiQ29udmVydCIsImhleCIsIm1heCIsInJvdW5kIiwiSHNsIiwibTIiLCJkZWZpbmUiLCJjaGFubmVscyIsImRpc3BsYXlhYmxlIiwiY29sb3JfZm9ybWF0SGV4IiwiZm9ybWF0SHNsIiwiaHNsQ29udmVydCIsImNvbG9yX2Zvcm1hdFJnYiIsImRhcmtlciIsInJnYl9mb3JtYXRIZXgiLCJyZ2JfZm9ybWF0UmdiIiwiaHNsMnJnYiIsInkiLCJub2dhbW1hIiwiZXhwb25lbnRpYWwiLCJkIiwibGluZWFyIiwiY29sb3IyIiwiZ2FtbWEiLCJjb2xvclJnYiIsInJnYkdhbW1hIiwicmVBIiwicmVCIiwiYW0iLCJicyIsImJpIiwibGFzdEluZGV4IiwicSIsIm9uZSIsInplcm8iLCJpMiIsInN2Z05vZGUiLCJkZWdyZWVzIiwiUEkiLCJpZGVudGl0eSIsInRyYW5zbGF0ZVgiLCJ0cmFuc2xhdGVZIiwicm90YXRlIiwic2tld1giLCJzY2FsZVgiLCJzY2FsZVkiLCJzcXJ0IiwiYXRhbjIiLCJhdGFuIiwicHhDb21tYSIsInB4UGFyZW4iLCJkZWdQYXJlbiIsInhhIiwieWEiLCJ4YiIsInliIiwidGFza0hlYWQiLCJ0YXNrVGFpbCIsImludGVycG9sYXRlVHJhbnNmb3JtQ3NzIiwiaW50ZXJwb2xhdGVUcmFuc2Zvcm0iLCJET01NYXRyaXgiLCJXZWJLaXRDU1NNYXRyaXgiLCJpc0lkZW50aXR5IiwiZGVjb21wb3NlIiwiaW50ZXJwb2xhdGVUcmFuc2Zvcm1TdmciLCJiYXNlVmFsIiwiY29uc29saWRhdGUiLCJtYXRyaXgiLCJmcmFtZSIsInRpbWVvdXQiLCJpbnRlcnZhbCIsImNsb2NrTGFzdCIsImNsb2NrTm93IiwiY2xvY2tTa2V3IiwiY2xvY2siLCJzZXRGcmFtZSIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsImNsZWFyTm93IiwiX2NhbGwiLCJfdGltZSIsImRlbGF5IiwiVGltZXIiLCJyZXN0YXJ0IiwidDAiLCJ0MiIsInQxIiwibm93MiIsImNsZWFyVGltZW91dCIsIndha2UiLCJjbGVhckludGVydmFsIiwic2V0SW50ZXJ2YWwiLCJwb2tlIiwiZWxhcHNlZCIsInRpbWVyIiwiVHlwZUVycm9yIiwiZW1wdHlPbiIsImVtcHR5VHdlZW4iLCJ0aW1pbmciLCJzY2hlZHVsZXMiLCJfX3RyYW5zaXRpb24iLCJ0d2VlbiIsInN0YXRlIiwidGljayIsImVhc2UiLCJzY2hlZHVsZTIiLCJ0d2VlbjAiLCJ0d2VlbjEiLCJfaWQiLCJpbnRlcnBvbGF0ZU51bWJlciIsImludGVycG9sYXRlUmdiIiwiaW50ZXJwb2xhdGVTdHJpbmciLCJpbnRlcnBvbGF0ZTIiLCJ2YWx1ZTEiLCJzdHJpbmcwMCIsImludGVycG9sYXRlMCIsInN0cmluZzEiLCJzdHJpbmcwIiwic3RyaW5nMTAiLCJhdHRySW50ZXJwb2xhdGVOUyIsImF0dHJJbnRlcnBvbGF0ZSIsIm9uMCIsIm9uMSIsInNpdCIsImV2ZXJ5IiwiaW5pdCIsInN0eWxlSW50ZXJwb2xhdGUiLCJ0ZXh0SW50ZXJwb2xhdGUiLCJfbmFtZSIsInNlbGVjdGlvbl9wcm90b3R5cGUiLCJUcmFuc2l0aW9uIiwiaW5oZXJpdDIiLCJpZDAiLCJpZDEiLCJuZXdJZCIsIm9uRnVuY3Rpb24iLCJpbnRlcnBvbGF0ZSIsImF0dHJUd2VlbiIsInR3ZWVuVmFsdWUiLCJhdHRyVHdlZW5OUyIsInN0eWxlVHdlZW4iLCJzdHlsZU51bGwiLCJsaXN0ZW5lcjAiLCJzdHlsZU1heWJlUmVtb3ZlIiwidGV4dFR3ZWVuIiwidHdlZW5SZW1vdmUiLCJ0d2VlbkZ1bmN0aW9uIiwiZGVsYXlGdW5jdGlvbiIsImRlbGF5Q29uc3RhbnQiLCJkdXJhdGlvbkZ1bmN0aW9uIiwiZHVyYXRpb25Db25zdGFudCIsImVhc2VDb25zdGFudCIsImVhc2VWYXJ5aW5nIiwicmVzb2x2ZTIiLCJyZWplY3QiLCJjYW5jZWwiLCJpbnRlcnJ1cHQiLCJkZWZhdWx0VGltaW5nIiwiZW1wdHkyIiwiaW5oZXJpdCIsIkludDE2QXJyYXkiLCJJbnQzMkFycmF5Iiwid2F2ZWZvcm0iLCJyZXNpemVDaGVja0ludGVydmFsIiwiY3VycmVudFdpZHRoIiwiY3VycmVudEhlaWdodCIsImNsaWVudFdpZHRoIiwiY2xpZW50SGVpZ2h0IiwiZHJhdyIsIkZsb2F0MzJBcnJheSIsIm9mZnNldFgiLCJ3aWR0aCIsImhlaWdodCIsInN1bW1hcnkiLCJwaXhlbHMiLCJwaXhlbExlbmd0aCIsInZhbHMiLCJzYW1wbGVTaXplIiwicG9zU3VtIiwibmVnU3VtIiwic3VtbWFyaXplRmFzdGVyIiwibWVhbiIsIm11bHRpcGxpZXIiLCJjbG9zZSIsIkF1ZGlvQ29udGV4dCIsIm9uc3RhdGVjaGFuZ2UiLCJyZXN1bWUiLCJkZWNvZGVyIiwiYXJyYXlCdWZmZXIiLCJidWZmZXIiLCJkZWNvZGVBdWRpb0ZpbGVCdWZmZXIiLCJidWZmZXJEYXRhIiwiRmxvYXQzMkFycmF5VG9JbnQxNkFycmF5Iiwic2FtcGxlUmF0ZSIsIm51bWJlck9mQ2hhbm5lbHMiLCJ1cmwiLCJmZXRjaEF1ZGlvRmlsZUFuZERlY29kZSIsInJlc3BvbnNlIiwiZmV0Y2giLCJkZWNvZGVBdWRpb0RhdGEiLCJmbG9hdEFycmF5Iiwic2FtcGxlIiwiY2hhbm5lbCIsImdldENoYW5uZWxEYXRhIiwiVHJhbnNjcmlwdEVkaXRvciIsIldhdmVmb3JtIiwidHJhbnNjcmlwdCIsInByZXZpZXdWaWRlbyIsIm9uU2F2ZSIsImFzeW5jIiwicG9zaXRpb24iLCJzZWxlY3RlZCIsInBsYXlpbmciLCJsb2FkZWQiLCJpc1ZpZGVvIiwiX3VybCIsIl9kdXJhdGlvbiIsIl93YXZlZm9ybSIsInBlbmRpbmdfd2F2ZWZvcm0iLCJwZW5kaW5nX2R1cmF0aW9uIiwidmlkZW9fZHVyYXRpb24iLCJzYXZpbmciLCJsYXN0U2F2ZWRWZXJzaW9uIiwiYXV0b1NhdmUiLCJhdXRvU2F2ZUludGVydmFsIiwiZGVjb2RlclN1c3BlbmRlZCIsImRlY29kaW5nQXVkaW8iLCJzYXZlQXV0byIsIm9uR2xvYmFsS2V5ZG93biIsIkF1ZGlvRmlsZURlY29kZXIiLCJzdXNwZW5kZWQiLCJkZWNvZGVBdWRpb1dhdmVmb3JtIiwiRmlsZSIsImRlY29kZUF1ZGlvRmlsZURhdGEiLCJzeW5jZWQiLCJtc1RvVGltZSIsIm1zIiwiaG91cnMiLCJ6IiwiX21zIiwic2VjcyIsIm1pbnMiLCJocnMiLCJwYWQiLCJ0b2dnbGVBdXRvU2F2ZSIsInZlcnNpb24yIiwiZmV0Y2hBbmREZWNvZGVBdWRpb0ZpbGUiLCJ3YXZlZm9ybUxvYWRpbmciLCJvblBsYXkiLCJhbmltYXRpb25GcmFtZUlEIiwidXBkYXRlUG9zaXRpb24iLCJvblBhdXNlIiwib25FbmRlZCIsInRpbWVzdGFtcCIsInZpZGVvIiwiY3VycmVudFRpbWUiLCJkdXJhdGlvbkNoYW5nZWQiLCJ2aWRlb1dpZHRoIiwidmlkZW9IZWlnaHQiLCJvbkVtcHR5IiwicGF1c2VkIiwicGxheSIsInBhdXNlIiwidHJhbnNjcmlwdFVwZGF0ZWQiLCJzZXRQb3NpdGlvbiIsInRpbWVVcGRhdGUiLCJ0b2dnbGVTaG93Q29uZmlkZW5jZSIsIkVkaXRvciIsInJldm9rZU9iamVjdFVSTCIsImF1ZGlvIiwiZmlsZSIsIkFycmF5QnVmZmVyIiwiZWRpdG9yIiwibG9hZCIsIlVSTCIsImNyZWF0ZU9iamVjdFVSTCIsIkJsb2IiLCJhdWRpb0RhdGEiLCJqc29uIiwiRWRpdG9yV2l0aE1lZGlhTG9hZGVyIl0sIm1hcHBpbmdzIjoiQUFPQSxXQUFpQkEsRUFBS0MsU0FDWkMsRUFBTUMsT0FB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
